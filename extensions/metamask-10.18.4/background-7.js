LavaPack.loadBundle([[4765,{buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e){(function(){!function(e,n){"object"==typeof r&&void 0!==t?t.exports=n():"function"==typeof define&&define.amd?define(n):function(){const t=e.Base64,r=n();r.noConflict=()=>(e.Base64=t,r),e.Meteor&&(Base64=r),e.Base64=r}()}("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:this,(function(){const t="3.6.1",r="function"==typeof atob,n="function"==typeof btoa,i="function"==typeof e,s="function"==typeof TextDecoder?new TextDecoder:undefined,o="function"==typeof TextEncoder?new TextEncoder:undefined,a=[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],c=(e=>{let t={};return e.forEach(((e,r)=>t[e]=r)),t})(a),u=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,l=String.fromCharCode.bind(String),h="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):(e,t=(e=>e))=>new Uint8Array(Array.prototype.slice.call(e,0).map(t)),f=e=>e.replace(/[+\/]/g,(e=>"+"==e?"-":"_")).replace(/=+$/m,""),p=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),d=e=>{let t,r,n,i,s="";const o=e.length%3;for(let o=0;o<e.length;){if((r=e.charCodeAt(o++))>255||(n=e.charCodeAt(o++))>255||(i=e.charCodeAt(o++))>255)throw new TypeError("invalid character found");t=r<<16|n<<8|i,s+=a[t>>18&63]+a[t>>12&63]+a[t>>6&63]+a[63&t]}return o?s.slice(0,o-3)+"===".substring(o):s},b=n?e=>btoa(e):i?t=>e.from(t,"binary").toString("base64"):d,m=i?t=>e.from(t).toString("base64"):e=>{let t=[];for(let r=0,n=e.length;r<n;r+=4096)t.push(l.apply(null,e.subarray(r,r+4096)));return b(t.join(""))},g=(e,t=!1)=>t?f(m(e)):m(e),y=e=>{if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?l(192|t>>>6)+l(128|63&t):l(224|t>>>12&15)+l(128|t>>>6&63)+l(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return l(240|t>>>18&7)+l(128|t>>>12&63)+l(128|t>>>6&63)+l(128|63&t)},k=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,_=e=>e.replace(k,y),E=i?t=>e.from(t,"utf8").toString("base64"):o?e=>m(o.encode(e)):e=>b(_(e)),S=(e,t=!1)=>t?f(E(e)):E(e),w=e=>S(e,!0),v=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,x=e=>{switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return l(55296+(t>>>10))+l(56320+(1023&t));case 3:return l((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return l((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},I=e=>e.replace(v,x),A=e=>{if(e=e.replace(/\s+/g,""),!u.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(3&e.length));let t,r,n,i="";for(let s=0;s<e.length;)t=c[e.charAt(s++)]<<18|c[e.charAt(s++)]<<12|(r=c[e.charAt(s++)])<<6|(n=c[e.charAt(s++)]),i+=64===r?l(t>>16&255):64===n?l(t>>16&255,t>>8&255):l(t>>16&255,t>>8&255,255&t);return i},T=r?e=>atob(p(e)):i?t=>e.from(t,"base64").toString("binary"):A,R=i?t=>h(e.from(t,"base64")):e=>h(T(e),(e=>e.charCodeAt(0))),N=e=>R(O(e)),P=i?t=>e.from(t,"base64").toString("utf8"):s?e=>s.decode(R(e)):e=>I(T(e)),O=e=>p(e.replace(/[-_]/g,(e=>"-"==e?"+":"/"))),B=e=>P(O(e)),C=e=>({value:e,enumerable:!1,writable:!0,configurable:!0}),D=function(){const e=(e,t)=>Object.defineProperty(String.prototype,e,C(t));e("fromBase64",(function(){return B(this)})),e("toBase64",(function(e){return S(this,e)})),e("toBase64URI",(function(){return S(this,!0)})),e("toBase64URL",(function(){return S(this,!0)})),e("toUint8Array",(function(){return N(this)}))},L=function(){const e=(e,t)=>Object.defineProperty(Uint8Array.prototype,e,C(t));e("toBase64",(function(e){return g(this,e)})),e("toBase64URI",(function(){return g(this,!0)})),e("toBase64URL",(function(){return g(this,!0)}))},M={version:t,VERSION:"3.6.1",atob:T,atobPolyfill:A,btoa:b,btoaPolyfill:d,fromBase64:B,toBase64:S,encode:S,encodeURI:w,encodeURL:w,utob:_,btou:I,decode:B,isValid:e=>{if("string"!=typeof e)return!1;const t=e.replace(/\s+/g,"").replace(/=+$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(t)||!/[^\s0-9a-zA-Z\-_]/.test(t)},fromUint8Array:g,toUint8Array:N,extendString:D,extendUint8Array:L,extendBuiltins:()=>{D(),L()},Base64:{}};return Object.keys(M).forEach((e=>M.Base64[e]=M[e])),M}))}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@ensdomains/content-hash>js-base64"}],[4766,{_process:5430},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e){(function(){
/**
 * [js-sha256]{@link https://github.com/emn178/js-sha256}
 *
 * @version 0.9.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */
!function(){var r="input is invalid type",n="object"==typeof window,i=n?window:{};i.JS_SHA256_NO_WINDOW&&(n=!1);var s=!n&&"object"==typeof self,o=!i.JS_SHA256_NO_NODE_JS&&"object"==typeof e&&e.versions&&e.versions.node;o?i=global:s&&(i=self);var a=!i.JS_SHA256_NO_COMMON_JS&&"object"==typeof t&&t.exports,c="function"==typeof define&&define.amd,u=!i.JS_SHA256_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,l="0123456789abcdef".split(""),h=[-2147483648,8388608,32768,128],f=[24,16,8,0],p=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],d=["hex","array","digest","arrayBuffer"],b=[];!i.JS_SHA256_NO_NODE_JS&&Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),!u||!i.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return"object"==typeof e&&e.buffer&&e.buffer.constructor===ArrayBuffer});var m=function(e,t){return function(r){return new E(t,!0).update(r)[e]()}},g=function(e){var t=m("hex",e);o&&(t=y(t,e)),t.create=function(){return new E(e)},t.update=function(e){return t.create().update(e)};for(var r=0;r<d.length;++r){var n=d[r];t[n]=m(n,e)}return t},y=function(e,t){var n=(0,eval)("require('crypto')"),i=(0,eval)("require('buffer').Buffer"),s=t?"sha224":"sha256";return function(t){if("string"==typeof t)return n.createHash(s).update(t,"utf8").digest("hex");if(null===t||t===undefined)throw new Error(r);return t.constructor===ArrayBuffer&&(t=new Uint8Array(t)),Array.isArray(t)||ArrayBuffer.isView(t)||t.constructor===i?n.createHash(s).update(new i(t)).digest("hex"):e(t)}},k=function(e,t){return function(r,n){return new S(r,t,!0).update(n)[e]()}},_=function(e){var t=k("hex",e);t.create=function(t){return new S(t,e)},t.update=function(e,r){return t.create(e).update(r)};for(var r=0;r<d.length;++r){var n=d[r];t[n]=k(n,e)}return t};function E(e,t){t?(b[0]=b[16]=b[1]=b[2]=b[3]=b[4]=b[5]=b[6]=b[7]=b[8]=b[9]=b[10]=b[11]=b[12]=b[13]=b[14]=b[15]=0,this.blocks=b):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=e}function S(e,t,n){var i,s=typeof e;if("string"===s){var o,a=[],c=e.length,l=0;for(i=0;i<c;++i)(o=e.charCodeAt(i))<128?a[l++]=o:o<2048?(a[l++]=192|o>>6,a[l++]=128|63&o):o<55296||o>=57344?(a[l++]=224|o>>12,a[l++]=128|o>>6&63,a[l++]=128|63&o):(o=65536+((1023&o)<<10|1023&e.charCodeAt(++i)),a[l++]=240|o>>18,a[l++]=128|o>>12&63,a[l++]=128|o>>6&63,a[l++]=128|63&o);e=a}else{if("object"!==s)throw new Error(r);if(null===e)throw new Error(r);if(u&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||u&&ArrayBuffer.isView(e)))throw new Error(r)}e.length>64&&(e=new E(t,!0).update(e).array());var h=[],f=[];for(i=0;i<64;++i){var p=e[i]||0;h[i]=92^p,f[i]=54^p}E.call(this,t,n),this.update(f),this.oKeyPad=h,this.inner=!0,this.sharedMemory=n}E.prototype.update=function(e){if(!this.finalized){var t,n=typeof e;if("string"!==n){if("object"!==n)throw new Error(r);if(null===e)throw new Error(r);if(u&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||u&&ArrayBuffer.isView(e)))throw new Error(r);t=!0}for(var i,s,o=0,a=e.length,c=this.blocks;o<a;){if(this.hashed&&(this.hashed=!1,c[0]=this.block,c[16]=c[1]=c[2]=c[3]=c[4]=c[5]=c[6]=c[7]=c[8]=c[9]=c[10]=c[11]=c[12]=c[13]=c[14]=c[15]=0),t)for(s=this.start;o<a&&s<64;++o)c[s>>2]|=e[o]<<f[3&s++];else for(s=this.start;o<a&&s<64;++o)(i=e.charCodeAt(o))<128?c[s>>2]|=i<<f[3&s++]:i<2048?(c[s>>2]|=(192|i>>6)<<f[3&s++],c[s>>2]|=(128|63&i)<<f[3&s++]):i<55296||i>=57344?(c[s>>2]|=(224|i>>12)<<f[3&s++],c[s>>2]|=(128|i>>6&63)<<f[3&s++],c[s>>2]|=(128|63&i)<<f[3&s++]):(i=65536+((1023&i)<<10|1023&e.charCodeAt(++o)),c[s>>2]|=(240|i>>18)<<f[3&s++],c[s>>2]|=(128|i>>12&63)<<f[3&s++],c[s>>2]|=(128|i>>6&63)<<f[3&s++],c[s>>2]|=(128|63&i)<<f[3&s++]);this.lastByteIndex=s,this.bytes+=s-this.start,s>=64?(this.block=c[16],this.start=s-64,this.hash(),this.hashed=!0):this.start=s}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},E.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>2]|=h[3&t],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},E.prototype.hash=function(){var e,t,r,n,i,s,o,a,c,u=this.h0,l=this.h1,h=this.h2,f=this.h3,d=this.h4,b=this.h5,m=this.h6,g=this.h7,y=this.blocks;for(e=16;e<64;++e)t=((i=y[e-15])>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,r=((i=y[e-2])>>>17|i<<15)^(i>>>19|i<<13)^i>>>10,y[e]=y[e-16]+t+y[e-7]+r<<0;for(c=l&h,e=0;e<64;e+=4)this.first?(this.is224?(s=300032,g=(i=y[0]-1413257819)-150054599<<0,f=i+24177077<<0):(s=704751109,g=(i=y[0]-210244248)-1521486534<<0,f=i+143694565<<0),this.first=!1):(t=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),n=(s=u&l)^u&h^c,g=f+(i=g+(r=(d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7))+(d&b^~d&m)+p[e]+y[e])<<0,f=i+(t+n)<<0),t=(f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10),n=(o=f&u)^f&l^s,m=h+(i=m+(r=(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7))+(g&d^~g&b)+p[e+1]+y[e+1])<<0,t=((h=i+(t+n)<<0)>>>2|h<<30)^(h>>>13|h<<19)^(h>>>22|h<<10),n=(a=h&f)^h&u^o,b=l+(i=b+(r=(m>>>6|m<<26)^(m>>>11|m<<21)^(m>>>25|m<<7))+(m&g^~m&d)+p[e+2]+y[e+2])<<0,t=((l=i+(t+n)<<0)>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),n=(c=l&h)^l&f^a,d=u+(i=d+(r=(b>>>6|b<<26)^(b>>>11|b<<21)^(b>>>25|b<<7))+(b&m^~b&g)+p[e+3]+y[e+3])<<0,u=i+(t+n)<<0;this.h0=this.h0+u<<0,this.h1=this.h1+l<<0,this.h2=this.h2+h<<0,this.h3=this.h3+f<<0,this.h4=this.h4+d<<0,this.h5=this.h5+b<<0,this.h6=this.h6+m<<0,this.h7=this.h7+g<<0},E.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,n=this.h3,i=this.h4,s=this.h5,o=this.h6,a=this.h7,c=l[e>>28&15]+l[e>>24&15]+l[e>>20&15]+l[e>>16&15]+l[e>>12&15]+l[e>>8&15]+l[e>>4&15]+l[15&e]+l[t>>28&15]+l[t>>24&15]+l[t>>20&15]+l[t>>16&15]+l[t>>12&15]+l[t>>8&15]+l[t>>4&15]+l[15&t]+l[r>>28&15]+l[r>>24&15]+l[r>>20&15]+l[r>>16&15]+l[r>>12&15]+l[r>>8&15]+l[r>>4&15]+l[15&r]+l[n>>28&15]+l[n>>24&15]+l[n>>20&15]+l[n>>16&15]+l[n>>12&15]+l[n>>8&15]+l[n>>4&15]+l[15&n]+l[i>>28&15]+l[i>>24&15]+l[i>>20&15]+l[i>>16&15]+l[i>>12&15]+l[i>>8&15]+l[i>>4&15]+l[15&i]+l[s>>28&15]+l[s>>24&15]+l[s>>20&15]+l[s>>16&15]+l[s>>12&15]+l[s>>8&15]+l[s>>4&15]+l[15&s]+l[o>>28&15]+l[o>>24&15]+l[o>>20&15]+l[o>>16&15]+l[o>>12&15]+l[o>>8&15]+l[o>>4&15]+l[15&o];return this.is224||(c+=l[a>>28&15]+l[a>>24&15]+l[a>>20&15]+l[a>>16&15]+l[a>>12&15]+l[a>>8&15]+l[a>>4&15]+l[15&a]),c},E.prototype.toString=E.prototype.hex,E.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,n=this.h3,i=this.h4,s=this.h5,o=this.h6,a=this.h7,c=[e>>24&255,e>>16&255,e>>8&255,255&e,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24&255,r>>16&255,r>>8&255,255&r,n>>24&255,n>>16&255,n>>8&255,255&n,i>>24&255,i>>16&255,i>>8&255,255&i,s>>24&255,s>>16&255,s>>8&255,255&s,o>>24&255,o>>16&255,o>>8&255,255&o];return this.is224||c.push(a>>24&255,a>>16&255,a>>8&255,255&a),c},E.prototype.array=E.prototype.digest,E.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(this.is224?28:32),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),t.setUint32(20,this.h5),t.setUint32(24,this.h6),this.is224||t.setUint32(28,this.h7),e},S.prototype=new E,S.prototype.finalize=function(){if(E.prototype.finalize.call(this),this.inner){this.inner=!1;var e=this.array();E.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(e),E.prototype.finalize.call(this)}};var w=g();w.sha256=w,w.sha224=g(!0),w.sha256.hmac=_(),w.sha224.hmac=_(!0),a?t.exports=w:(i.sha256=w.sha256,i.sha224=w.sha224,c&&define((function(){return w})))}()}).call(this)}).call(this,e("_process"))}}},{package:"3box>js-sha256"}],[4777,{"readable-stream":5710},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("readable-stream").Duplex;t.exports=function({engine:e}){if(!e)throw new Error("Missing engine parameter!");const t=new n({objectMode:!0,read:function(){return!1},write:function(t,r,n){e.handle(t,((e,t)=>{this.push(t)})),n()}});e.on&&e.on("notification",(e=>{t.push(e)}));return t}}}},{package:"json-rpc-middleware-stream"}],[4780,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={space:"",cycles:!1,replacer:(e,t)=>t,stringify:JSON.stringify}}}},{package:"3box>3box-orbitdb-plugins>ipfs-log>json-stringify-deterministic"}],[4781,{"./defaults":4780,"./util":4782},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("./defaults"),i=e("./util").isFunction,s=e("./util").isBoolean,o=e("./util").isObject,a=e("./util").isArray,c=e("./util").isRegex,u=e("./util").assign,l=e("./util").keys;t.exports=function(e,t){t=t||u({},n),i(t)&&(t={compare:t});const r=t.space||n.space,h=s(t.cycles)?t.cycles:n.cycles,f=t.replacer||n.replacer,p=t.stringify||n.stringify,d=t.compare&&(b=t.compare,function(e){return function(t,r){const n={key:t,value:e[t]},i={key:r,value:e[r]};return b(n,i)}});var b;h||p(e);const m=[];return function e(t,n,i,s){const u=r?"\n"+new Array(s+1).join(r):"",b=r?": ":":";if(i=function(e){return null===e||e===undefined?e:c(e)?e.toString():e.toJSON?e.toJSON():e}(i),(i=f.call(t,n,i))!==undefined){if(!o(i)||null===i)return p(i);if(a(i)){const t=[];for(let n=0;n<i.length;n++){const o=e(i,n,i[n],s+1)||p(null);t.push(u+r+o)}return"["+t.join(",")+u+"]"}{if(h){if(-1!==m.indexOf(i))return p("[Circular]");m.push(i)}const t=l(i).sort(d&&d(i)),n=[];for(let o=0;o<t.length;o++){const a=t[o],c=e(i,a,i[a],s+1);if(!c)continue;const l=p(a)+b+c;n.push(u+r+l)}return m.splice(m.indexOf(i),1),"{"+n.join(",")+u+"}"}}}({"":e},"",e,0)}}}},{package:"3box>3box-orbitdb-plugins>ipfs-log>json-stringify-deterministic"}],[4782,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={isArray:Array.isArray,assign:Object.assign,isObject:e=>"object"==typeof e,isFunction:e=>"function"==typeof e,isBoolean:e=>"boolean"==typeof e,isRegex:e=>e instanceof RegExp,keys:Object.keys}}}},{package:"3box>3box-orbitdb-plugins>ipfs-log>json-stringify-deterministic"}],[4799,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e,t,r){var n;return function(){if(!t)return e.apply(this,arguments);var i=this,s=arguments,o=r&&!n;return clearTimeout(n),n=setTimeout((function(){if(n=null,!o)return e.apply(i,s)}),t),o?e.apply(this,arguments):void 0}}}}},{package:"3box>ipfs>ipfs-bitswap>just-debounce-it"}],[48,{"../../../shared/constants/app":6186,"../../../shared/constants/metametrics":6190,"../../../shared/constants/time":6195},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function({trackEvent:e,getMetricsState:t,rateLimitSeconds:r=60}){return function(c,f,p){var d;const{origin:b,method:m}=c,g=null!==(d=u[m])&&void 0!==d?d:o,y=g===o&&void 0!==h[m],k=!0===t().participateInMetaMetrics,_=l[m],E=b!==n.ORIGIN_METAMASK&&g!==a&&!1===y&&!0===k;if(E){const t=_?_.REQUESTED:i.EVENT_NAMES.PROVIDER_METHOD_CALLED,n={};t===i.EVENT_NAMES.SIGNATURE_REQUESTED?n.signature_type=m:n.method=m,e({event:t,category:i.EVENT.CATEGORIES.INPAGE_PROVIDER,referrer:{url:b},properties:n}),h[m]=setTimeout((()=>{delete h[m]}),s.SECOND*r)}p((t=>{var r;if(!1===E||void 0===_)return t();const n=4001===(null===(r=f.error)||void 0===r?void 0:r.code)?_.REJECTED:_.APPROVED,s={};return _.REQUESTED===i.EVENT_NAMES.SIGNATURE_REQUESTED?s.signature_type=m:s.method=m,e({event:n,category:i.EVENT.CATEGORIES.INPAGE_PROVIDER,referrer:{url:b},properties:s}),t()}))}};var n=e("../../../shared/constants/app"),i=e("../../../shared/constants/metametrics"),s=e("../../../shared/constants/time");const o="rate_limited",a="blocked",c="non_rate_limited",u={[n.MESSAGE_TYPE.ETH_SIGN]:c,[n.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA]:c,[n.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V3]:c,[n.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V4]:c,[n.MESSAGE_TYPE.PERSONAL_SIGN]:c,[n.MESSAGE_TYPE.ETH_DECRYPT]:c,[n.MESSAGE_TYPE.ETH_GET_ENCRYPTION_PUBLIC_KEY]:c,[n.MESSAGE_TYPE.ETH_REQUEST_ACCOUNTS]:o,[n.MESSAGE_TYPE.WALLET_REQUEST_PERMISSIONS]:o,[n.MESSAGE_TYPE.SEND_METADATA]:a,[n.MESSAGE_TYPE.GET_PROVIDER_STATE]:a},l={[n.MESSAGE_TYPE.ETH_SIGN]:{APPROVED:i.EVENT_NAMES.SIGNATURE_APPROVED,REJECTED:i.EVENT_NAMES.SIGNATURE_REJECTED,REQUESTED:i.EVENT_NAMES.SIGNATURE_REQUESTED},[n.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA]:{APPROVED:i.EVENT_NAMES.SIGNATURE_APPROVED,REJECTED:i.EVENT_NAMES.SIGNATURE_REJECTED,REQUESTED:i.EVENT_NAMES.SIGNATURE_REQUESTED},[n.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V3]:{APPROVED:i.EVENT_NAMES.SIGNATURE_APPROVED,REJECTED:i.EVENT_NAMES.SIGNATURE_REJECTED,REQUESTED:i.EVENT_NAMES.SIGNATURE_REQUESTED},[n.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA_V4]:{APPROVED:i.EVENT_NAMES.SIGNATURE_APPROVED,REJECTED:i.EVENT_NAMES.SIGNATURE_REJECTED,REQUESTED:i.EVENT_NAMES.SIGNATURE_REQUESTED},[n.MESSAGE_TYPE.PERSONAL_SIGN]:{APPROVED:i.EVENT_NAMES.SIGNATURE_APPROVED,REJECTED:i.EVENT_NAMES.SIGNATURE_REJECTED,REQUESTED:i.EVENT_NAMES.SIGNATURE_REQUESTED},[n.MESSAGE_TYPE.ETH_DECRYPT]:{APPROVED:i.EVENT_NAMES.DECRYPTION_APPROVED,REJECTED:i.EVENT_NAMES.DECRYPTION_REJECTED,REQUESTED:i.EVENT_NAMES.DECRYPTION_REQUESTED},[n.MESSAGE_TYPE.ETH_GET_ENCRYPTION_PUBLIC_KEY]:{APPROVED:i.EVENT_NAMES.ENCRYPTION_PUBLIC_KEY_APPROVED,REJECTED:i.EVENT_NAMES.ENCRYPTION_PUBLIC_KEY_REJECTED,REQUESTED:i.EVENT_NAMES.ENCRYPTION_PUBLIC_KEY_REQUESTED},[n.MESSAGE_TYPE.ETH_REQUEST_ACCOUNTS]:{APPROVED:i.EVENT_NAMES.PERMISSIONS_APPROVED,REJECTED:i.EVENT_NAMES.PERMISSIONS_REJECTED,REQUESTED:i.EVENT_NAMES.PERMISSIONS_REQUESTED},[n.MESSAGE_TYPE.WALLET_REQUEST_PERMISSIONS]:{APPROVED:i.EVENT_NAMES.PERMISSIONS_APPROVED,REJECTED:i.EVENT_NAMES.PERMISSIONS_REJECTED,REQUESTED:i.EVENT_NAMES.PERMISSIONS_REQUESTED}},h={}}}},{package:"$root$"}],[4800,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function e(t){if(!Array.isArray(t))throw new Error("expected an array");for(var r=[],n=t.length,i=0;i<n;i++){var s=t[i];Array.isArray(s)?r.push.apply(r,e(s)):r.push(s)}return r}}}},{package:"3box>ipfs>just-flatten-it"}],[4801,{},function(){with(this)return function(){"use strict";return function(e,t,r){function n(e){if("__proto__"===e||"constructor"===e||"prototype"===e)throw new Error("setting of prototype values not supported")}t.exports=function(e,t,r){var i,s,o;Array.isArray(t)&&(i=t.slice(0));"string"==typeof t&&(i=t.split("."));"symbol"==typeof t&&(i=[t]);if(!Array.isArray(i))throw new Error("props arg must be an array, a string or a symbol");if(!(s=i.pop()))return!1;n(s);for(;o=i.shift();)if(n(o),void 0===e[o]&&(e[o]={}),!(e=e[o])||"object"!=typeof e)return!1;return e[s]=r,!0}}}},{package:"3box>ipfs>just-safe-set"}],[4802,{events:2133,randombytes:5564},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("randombytes"),{EventEmitter:i}=e("events");function s(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0,n=e.length;r<n;++r)if(e[r]!==t[r])return!1;return!0}function o(e,t){if(!(t instanceof Uint8Array))throw new TypeError(e+" is not a Uint8Array")}class a extends i{constructor(e={}){super(),this.localNodeId=e.localNodeId||n(20),this.numberOfNodesPerKBucket=e.numberOfNodesPerKBucket||20,this.numberOfNodesToPing=e.numberOfNodesToPing||3,this.distance=e.distance||a.distance,this.arbiter=e.arbiter||a.arbiter,this.metadata=Object.assign({},e.metadata),o("option.localNodeId as parameter 1",this.localNodeId),this.root={contacts:[],dontSplit:!1,left:null,right:null}}static arbiter(e,t){return e.vectorClock>t.vectorClock?e:t}static distance(e,t){let r=0,n=0;const i=Math.min(e.length,t.length),s=Math.max(e.length,t.length);for(;n<i;++n)r=256*r+(e[n]^t[n]);for(;n<s;++n)r=256*r+255;return r}add(e){o("contact.id",(e||{}).id);let t=0,r=this.root;for(;null===r.contacts;)r=this._determineNode(r,e.id,t++);const n=this._indexOf(r,e.id);return n>=0?(this._update(r,n,e),this):r.contacts.length<this.numberOfNodesPerKBucket?(r.contacts.push(e),this.emit("added",e),this):r.dontSplit?(this.emit("ping",r.contacts.slice(0,this.numberOfNodesToPing),e),this):(this._split(r,t),this.add(e))}closest(e,t=Infinity){if(o("id",e),!Number.isInteger(t)&&t!==Infinity||t<=0)throw new TypeError("n is not positive number");let r=[];for(let n=[this.root],i=0;n.length>0&&r.length<t;){const t=n.pop();if(null===t.contacts){const r=this._determineNode(t,e,i++);n.push(t.left===r?t.right:t.left),n.push(r)}else r=r.concat(t.contacts)}return r.map((t=>[this.distance(t.id,e),t])).sort(((e,t)=>e[0]-t[0])).slice(0,t).map((e=>e[1]))}count(){let e=0;for(const t=[this.root];t.length>0;){const r=t.pop();null===r.contacts?t.push(r.right,r.left):e+=r.contacts.length}return e}_determineNode(e,t,r){const n=r>>3,i=r%8;if(t.length<=n&&0!==i)return e.left;return t[n]&1<<7-i?e.right:e.left}get(e){o("id",e);let t=0,r=this.root;for(;null===r.contacts;)r=this._determineNode(r,e,t++);const n=this._indexOf(r,e);return n>=0?r.contacts[n]:null}_indexOf(e,t){for(let r=0;r<e.contacts.length;++r)if(s(e.contacts[r].id,t))return r;return-1}remove(e){o("the id as parameter 1",e);let t=0,r=this.root;for(;null===r.contacts;)r=this._determineNode(r,e,t++);const n=this._indexOf(r,e);if(n>=0){const e=r.contacts.splice(n,1)[0];this.emit("removed",e)}return this}_split(e,t){e.left={contacts:[],dontSplit:!1,left:null,right:null},e.right={contacts:[],dontSplit:!1,left:null,right:null};for(const r of e.contacts)this._determineNode(e,r.id,t).contacts.push(r);e.contacts=null;const r=this._determineNode(e,this.localNodeId,t);(e.left===r?e.right:e.left).dontSplit=!0}toArray(){let e=[];for(const t=[this.root];t.length>0;){const r=t.pop();null===r.contacts?t.push(r.right,r.left):e=e.concat(r.contacts)}return e}_update(e,t,r){if(!s(e.contacts[t].id,r.id))throw new Error("wrong index for _update");const n=e.contacts[t],i=this.arbiter(n,r);i===n&&n!==r||(e.contacts.splice(t,1),e.contacts.push(i),this.emit("updated",n,i))}}t.exports=a}}},{package:"3box>ipfs>libp2p-kad-dht>k-bucket"}],[4803,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n=Object.prototype.toString;function i(e){return"function"==typeof e.constructor?e.constructor.name:null}t.exports=function(e){if(void 0===e)return"undefined";if(null===e)return"null";var t,r=typeof e;if("boolean"===r)return"boolean";if("string"===r)return"string";if("number"===r)return"number";if("symbol"===r)return"symbol";if("function"===r)return t=e,"GeneratorFunction"===i(t)?"generatorfunction":"function";if(function(e){return Array.isArray?Array.isArray(e):e instanceof Array}(e))return"array";if(function(e){if(e.constructor&&"function"==typeof e.constructor.isBuffer)return e.constructor.isBuffer(e);return!1}(e))return"buffer";if(function(e){try{if("number"==typeof e.length&&"function"==typeof e.callee)return!0}catch(e){if(-1!==e.message.indexOf("callee"))return!0}return!1}(e))return"arguments";if(function(e){return e instanceof Date||"function"==typeof e.toDateString&&"function"==typeof e.getDate&&"function"==typeof e.setDate}(e))return"date";if(function(e){return e instanceof Error||"string"==typeof e.message&&e.constructor&&"number"==typeof e.constructor.stackTraceLimit}(e))return"error";if(function(e){return e instanceof RegExp||"string"==typeof e.flags&&"boolean"==typeof e.ignoreCase&&"boolean"==typeof e.multiline&&"boolean"==typeof e.global}(e))return"regexp";switch(i(e)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(function(e){return"function"==typeof e.throw&&"function"==typeof e.return&&"function"==typeof e.next}(e))return"generator";switch(r=n.call(e)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return r.slice(8,-1).toLowerCase().replace(/\s/g,"")}}}},{package:"3box>ipfs>kind-of"}],[4804,{"./VisibilityChangeEmitter":4805,_process:5430,debug:4807,events:2133,"lodash/get":5167,"lodash/isFunction":5177},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=c(e("events")),s=c(e("lodash/get")),o=c(e("lodash/isFunction")),a=c(e("./VisibilityChangeEmitter"));function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var h=e("debug")("latency-monitor:LatencyMonitor"),f=function(e){function r(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},n=e.latencyCheckIntervalMs,i=e.dataEmitIntervalMs,o=e.asyncTestFn,c=e.latencyRandomPercentage;u(this,r);var f=l(this,(r.__proto__||Object.getPrototypeOf(r)).call(this)),d=f;return d.latencyCheckIntervalMs=n||500,d.latencyRandomPercentage=c||10,d._latecyCheckMultiply=d.latencyRandomPercentage/100*2*d.latencyCheckIntervalMs,d._latecyCheckSubtract=d._latecyCheckMultiply/2,d.dataEmitIntervalMs=null===i||0===i?undefined:i||5e3,h("latencyCheckIntervalMs: %s dataEmitIntervalMs: %s",d.latencyCheckIntervalMs,d.dataEmitIntervalMs),d.dataEmitIntervalMs?h("Expecting ~%s events per summary",d.latencyCheckIntervalMs/d.dataEmitIntervalMs):h("Not emitting summaries"),d.asyncTestFn=o,t&&t.hrtime?(h("Using process.hrtime for timing"),d.now=t.hrtime,d.getDeltaMS=function(e){var t=d.now(e);return 1e3*t[0]+t[1]/1e6}):"undefined"!=typeof window&&(0,s.default)(window,"performance.now")?(h("Using performance.now for timing"),d.now=window.performance.now.bind(window.performance),d.getDeltaMS=function(e){return Math.round(d.now()-e)}):(h("Using Date.now for timing"),d.now=Date.now,d.getDeltaMS=function(e){return d.now()-e}),d._latencyData=d._initLatencyData(),p()&&(d._visibilityChangeEmitter=new a.default,d._visibilityChangeEmitter.on("visibilityChange",(function(e){e?d._startTimers():(d._emitSummary(),d._stopTimers())}))),d._visibilityChangeEmitter&&!d._visibilityChangeEmitter.isVisible()||d._startTimers(),f}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(r,e),n(r,[{key:"_startTimers",value:function(){var e=this;this._checkLatencyID||(this._checkLatency(),this.dataEmitIntervalMs&&(this._emitIntervalID=setInterval((function(){return e._emitSummary()}),this.dataEmitIntervalMs),(0,o.default)(this._emitIntervalID.unref)&&this._emitIntervalID.unref()))}},{key:"_stopTimers",value:function(){this._checkLatencyID&&(clearTimeout(this._checkLatencyID),this._checkLatencyID=undefined),this._emitIntervalID&&(clearInterval(this._emitIntervalID),this._emitIntervalID=undefined)}},{key:"_emitSummary",value:function(){var e=this.getSummary();e.events>0&&this.emit("data",e)}},{key:"getSummary",value:function(){var e={events:this._latencyData.events,minMs:this._latencyData.minMs,maxMs:this._latencyData.maxMs,avgMs:this._latencyData.events?this._latencyData.totalMs/this._latencyData.events:Number.POSITIVE_INFINITY,lengthMs:this.getDeltaMS(this._latencyData.startTime)};return this._latencyData=this._initLatencyData(),h("Summary: %O",e),e}},{key:"_checkLatency",value:function(){var e=this,t=this,r=Math.random()*t._latecyCheckMultiply-t._latecyCheckSubtract,n={deltaOffset:Math.ceil(t.latencyCheckIntervalMs+r),startTime:t.now()},i=function(){if(e._checkLatencyID){var r=t.getDeltaMS(n.startTime)-n.deltaOffset;t._checkLatency(),t._latencyData.events++,t._latencyData.minMs=Math.min(t._latencyData.minMs,r),t._latencyData.maxMs=Math.max(t._latencyData.maxMs,r),t._latencyData.totalMs+=r,h("MS: %s Data: %O",r,t._latencyData)}};h("localData: %O",n),this._checkLatencyID=setTimeout((function(){t.asyncTestFn?(n.deltaOffset=0,n.startTime=t.now(),t.asyncTestFn(i)):(n.deltaOffset-=1,i())}),n.deltaOffset),(0,o.default)(this._checkLatencyID.unref)&&this._checkLatencyID.unref()}},{key:"_initLatencyData",value:function(){return{startTime:this.now(),minMs:Number.POSITIVE_INFINITY,maxMs:Number.NEGATIVE_INFINITY,events:0,totalMs:0}}}]),r}(i.default);function p(){return"undefined"!=typeof window}r.default=f}).call(this)}).call(this,e("_process"))}}},{package:"3box>ipfs>libp2p>libp2p-connection-manager>latency-monitor"}],[4805,{debug:4807,events:2133},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("events"),o=(n=s)&&n.__esModule?n:{default:n};function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var c=e("debug")("latency-monitor:VisibilityChangeEmitter"),u=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return"undefined"==typeof document?(c('This is not a browser, no "document" found. Stopping.'),a(e)):(e._initializeVisibilityVarNames(),e._addVisibilityChangeListener(),e)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"_initializeVisibilityVarNames",value:function(){var e=void 0,t=void 0;void 0!==document.hidden?(e="hidden",t="visibilitychange"):void 0!==document.mozHidden?(e="mozHidden",t="mozvisibilitychange"):void 0!==document.msHidden?(e="msHidden",t="msvisibilitychange"):void 0!==document.webkitHidden&&(e="webkitHidden",t="webkitvisibilitychange"),this._hidden=e,this._visibilityChange=t}},{key:"_addVisibilityChangeListener",value:function(){void 0===document.addEventListener||void 0===document[this._hidden]?c("Checking page visibility requires a browser that supports the Page Visibility API."):document.addEventListener(this._visibilityChange,this._handleVisibilityChange.bind(this),!1)}},{key:"isVisible",value:function(){return this._hidden===undefined||document[this._hidden]===undefined?undefined:!document[this._hidden]}},{key:"_handleVisibilityChange",value:function(){var e=!document[this._hidden];c(e?"Page Visible":"Page Hidden"),this.emit("visibilityChange",e)}}]),t}(o.default);r.default=u}}},{package:"3box>ipfs>libp2p>libp2p-connection-manager>latency-monitor"}],[4806,{"./dist/LatencyMonitor":4804},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=e("./dist/LatencyMonitor").default}}},{package:"3box>ipfs>libp2p>libp2p-connection-manager>latency-monitor"}],[4807,{"./debug":4808,_process:5430},function(){with(this)return function(){"use strict";return function(e,t,r){(function(n){(function(){function i(){var e;try{e=r.storage.debug}catch(e){}return!e&&void 0!==n&&"env"in n&&(e=n.env.DEBUG),e}(r=t.exports=e("./debug")).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},r.formatArgs=function(e){var t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+r.humanize(this.diff),!t)return;var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var i=0,s=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(i++,"%c"===e&&(s=i))})),e.splice(s,0,n)},r.save=function(e){try{null==e?r.storage.removeItem("debug"):r.storage.debug=e}catch(e){}},r.load=i,r.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},r.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),r.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],r.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},r.enable(i())}).call(this)}).call(this,e("_process"))}}},{package:"3box>ipfs>libp2p>libp2p-connection-manager>latency-monitor>debug"}],[4808,{ms:4809},function(){with(this)return function(){"use strict";return function(e,t,r){var n;function i(e){function t(){if(t.enabled){var e=t,i=+new Date,s=i-(n||i);e.diff=s,e.prev=n,e.curr=i,n=i;for(var o=new Array(arguments.length),a=0;a<o.length;a++)o[a]=arguments[a];o[0]=r.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var c=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,(function(t,n){if("%%"===t)return t;c++;var i=r.formatters[n];if("function"==typeof i){var s=o[c];t=i.call(e,s),o.splice(c,1),c--}return t})),r.formatArgs.call(e,o);var u=t.log||r.log||console.log.bind(console);u.apply(e,o)}}return t.namespace=e,t.enabled=r.enabled(e),t.useColors=r.useColors(),t.color=function(e){var t,n=0;for(t in e)n=(n<<5)-n+e.charCodeAt(t),n|=0;return r.colors[Math.abs(n)%r.colors.length]}(e),"function"==typeof r.init&&r.init(t),t}(r=t.exports=i.debug=i.default=i).coerce=function(e){return e instanceof Error?e.stack||e.message:e},r.disable=function(){r.enable("")},r.enable=function(e){r.save(e),r.names=[],r.skips=[];for(var t=("string"==typeof e?e:"").split(/[\s,]+/),n=t.length,i=0;i<n;i++)t[i]&&("-"===(e=t[i].replace(/\*/g,".*?"))[0]?r.skips.push(new RegExp("^"+e.substr(1)+"$")):r.names.push(new RegExp("^"+e+"$")))},r.enabled=function(e){var t,n;for(t=0,n=r.skips.length;t<n;t++)if(r.skips[t].test(e))return!1;for(t=0,n=r.names.length;t<n;t++)if(r.names[t].test(e))return!0;return!1},r.humanize=e("ms"),r.names=[],r.skips=[],r.formatters={}}}},{package:"3box>ipfs>libp2p>libp2p-connection-manager>latency-monitor>debug"}],[4809,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n=1e3,i=60*n,s=60*i,o=24*s,a=365.25*o;function c(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}t.exports=function(e,t){t=t||{};var r,u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var r=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return r*a;case"days":case"day":case"d":return r*o;case"hours":case"hour":case"hrs":case"hr":case"h":return r*s;case"minutes":case"minute":case"mins":case"min":case"m":return r*i;case"seconds":case"second":case"secs":case"sec":case"s":return r*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return undefined}}(e);if("number"===u&&!1===isNaN(e))return t.long?c(r=e,o,"day")||c(r,s,"hour")||c(r,i,"minute")||c(r,n,"second")||r+" ms":function(e){if(e>=o)return Math.round(e/o)+"d";if(e>=s)return Math.round(e/s)+"h";if(e>=i)return Math.round(e/i)+"m";if(e>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}}}},{package:"3box>ipfs>libp2p>libp2p-connection-manager>latency-monitor>debug>ms"}],[4810,{"./lib/encodings":4811},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./lib/encodings");function i(e){if(!(this instanceof i))return new i(e);this.opts=e||{},this.encodings=n}t.exports=i,i.prototype._encoding=function(e){return"string"==typeof e&&(e=n[e]),e||(e=n.id),e},i.prototype._keyEncoding=function(e,t){return this._encoding(t&&t.keyEncoding||e&&e.keyEncoding||this.opts.keyEncoding)},i.prototype._valueEncoding=function(e,t){return this._encoding(t&&(t.valueEncoding||t.encoding)||e&&(e.valueEncoding||e.encoding)||this.opts.valueEncoding||this.opts.encoding)},i.prototype.encodeKey=function(e,t,r){return this._keyEncoding(t,r).encode(e)},i.prototype.encodeValue=function(e,t,r){return this._valueEncoding(t,r).encode(e)},i.prototype.decodeKey=function(e,t){return this._keyEncoding(t).decode(e)},i.prototype.decodeValue=function(e,t){return this._valueEncoding(t).decode(e)},i.prototype.encodeBatch=function(e,t){var r=this;return e.map((function(e){var n={type:e.type,key:r.encodeKey(e.key,t,e)};return r.keyAsBuffer(t,e)&&(n.keyEncoding="binary"),e.prefix&&(n.prefix=e.prefix),"value"in e&&(n.value=r.encodeValue(e.value,t,e),r.valueAsBuffer(t,e)&&(n.valueEncoding="binary")),n}))};var s=["lt","gt","lte","gte","start","end"];i.prototype.encodeLtgt=function(e){var t=this,r={};return Object.keys(e).forEach((function(n){r[n]=s.indexOf(n)>-1?t.encodeKey(e[n],e):e[n]})),r},i.prototype.createStreamDecoder=function(e){var t=this;return e.keys&&e.values?function(r,n){return{key:t.decodeKey(r,e),value:t.decodeValue(n,e)}}:e.keys?function(r){return t.decodeKey(r,e)}:e.values?function(r,n){return t.decodeValue(n,e)}:function(){}},i.prototype.keyAsBuffer=function(e){return this._keyEncoding(e).buffer},i.prototype.valueAsBuffer=function(e){return this._valueEncoding(e).buffer}}}},{package:"3box>ipfs>ipfs-repo>datastore-level>encoding-down>level-codec"}],[4811,{buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e){(function(){r.utf8=r["utf-8"]={encode:function(e){return n(e)?e:String(e)},decode:t,buffer:!1,type:"utf8"},r.json={encode:JSON.stringify,decode:JSON.parse,buffer:!1,type:"json"},r.binary={encode:function(t){return n(t)?t:e.from(t)},decode:t,buffer:!0,type:"binary"},r.none={encode:t,decode:t,buffer:!1,type:"id"},r.id=r.none;function t(e){return e}function n(t){return t===undefined||null===t||e.isBuffer(t)}["hex","ascii","base64","ucs2","ucs-2","utf16le","utf-16le"].forEach((function(t){r[t]={encode:function(r){return n(r)?r:e.from(r,t)},decode:function(e){return e.toString(t)},buffer:!0,type:t}}))}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>ipfs-repo>datastore-level>encoding-down>level-codec"}],[4812,{errno:2408},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("errno").create,i=n("LevelUPError"),s=n("NotFoundError",i);s.prototype.notFound=!0,s.prototype.status=404,t.exports={LevelUPError:i,InitializationError:n("InitializationError",i),OpenError:n("OpenError",i),ReadError:n("ReadError",i),WriteError:n("WriteError",i),NotFoundError:s,EncodingError:n("EncodingError",i)}}}},{package:"3box>orbit-db>orbit-db-keystore>levelup>level-errors"}],[4813,{inherits:4453,"readable-stream":4828,xtend:6173},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("inherits"),i=e("readable-stream").Readable,s=e("xtend");function o(e,t){if(!(this instanceof o))return new o(e,t);t=t||{},i.call(this,s(t,{objectMode:!0})),this._iterator=e,this._options=t,this.on("end",this.destroy.bind(this,null,null))}t.exports=o,n(o,i),o.prototype._read=function(){var e=this,t=this._options;this.destroyed||this._iterator.next((function(r,n,i){if(!e.destroyed)return r?e.destroy(r):void(n===undefined&&i===undefined?e.push(null):!1!==t.keys&&!1===t.values?e.push(n):!1===t.keys&&!1!==t.values?e.push(i):e.push({key:n,value:i}))}))},o.prototype._destroy=function(e,t){this._iterator.end((function(r){t(e||r)}))}}}},{package:"3box>orbit-db>orbit-db-keystore>levelup>level-iterator-stream"}],[4814,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n={};function i(e,t,r){r||(r=Error);var i=function(e){var r,n;function i(r,n,i){return e.call(this,function(e,r,n){return"string"==typeof t?t:t(e,r,n)}(r,n,i))||this}return n=e,(r=i).prototype=Object.create(n.prototype),r.prototype.constructor=r,r.__proto__=n,i}(r);i.prototype.name=r.name,i.prototype.code=e,n[e]=i}function s(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map((function(e){return String(e)})),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}i("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),i("ERR_INVALID_ARG_TYPE",(function(e,t,r){var n,i,o,a;if("string"==typeof t&&(i="not ",t.substr(!o||o<0?0:+o,i.length)===i)?(n="must not be",t=t.replace(/^not /,"")):n="must be",function(e,t,r){return(r===undefined||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}(e," argument"))a="The ".concat(e," ").concat(n," ").concat(s(t,"type"));else{var c=function(e,t,r){return"number"!=typeof r&&(r=0),!(r+t.length>e.length)&&-1!==e.indexOf(t,r)}(e,".")?"property":"argument";a='The "'.concat(e,'" ').concat(c," ").concat(n," ").concat(s(t,"type"))}return a+=". Received type ".concat(typeof r)}),TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.codes=n}}},{package:"3box>orbit-db>orbit-db-keystore>levelup>level-iterator-stream>readable-stream"}],[4815,{"./_stream_readable":4817,"./_stream_writable":4819,_process:5430,inherits:4453},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};t.exports=u;var i=e("./_stream_readable"),s=e("./_stream_writable");e("inherits")(u,i);for(var o=n(s.prototype),a=0;a<o.length;a++){var c=o[a];u.prototype[c]||(u.prototype[c]=s.prototype[c])}function u(e){if(!(this instanceof u))return new u(e);i.call(this,e),s.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",l)))}function l(){this._writableState.ended||r.nextTick(h,this)}function h(e){e.end()}Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(u.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(u.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(u.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==undefined&&this._writableState!==undefined&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){this._readableState!==undefined&&this._writableState!==undefined&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this)}).call(this,e("_process"))}}},{package:"3box>orbit-db>orbit-db-keystore>levelup>level-iterator-stream>readable-stream"}],[4816,{"./_stream_transform":4818,inherits:4453},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=i;var n=e("./_stream_transform");function i(e){if(!(this instanceof i))return new i(e);n.call(this,e)}e("inherits")(i,n),i.prototype._transform=function(e,t,r){r(null,e)}}}},{package:"3box>orbit-db>orbit-db-keystore>levelup>level-iterator-stream>readable-stream"}],[4817,{"../errors":4814,"./_stream_duplex":4815,"./internal/streams/async_iterator":4820,"./internal/streams/buffer_list":4821,"./internal/streams/destroy":4822,"./internal/streams/from":4824,"./internal/streams/state":4826,"./internal/streams/stream":4827,_process:5430,buffer:2132,events:2133,inherits:4453,"string_decoder/":5916,util:2131},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n;t.exports=v,v.ReadableState=w;e("events").EventEmitter;var i=function(e,t){return e.listeners(t).length},s=e("./internal/streams/stream"),o=e("buffer").Buffer,a=global.Uint8Array||function(){};var c,u=e("util");c=u&&u.debuglog?u.debuglog("stream"):function(){};var l,h,f,p=e("./internal/streams/buffer_list"),d=e("./internal/streams/destroy"),b=e("./internal/streams/state").getHighWaterMark,m=e("../errors").codes,g=m.ERR_INVALID_ARG_TYPE,y=m.ERR_STREAM_PUSH_AFTER_EOF,k=m.ERR_METHOD_NOT_IMPLEMENTED,_=m.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;e("inherits")(v,s);var E=d.errorOrDestroy,S=["error","close","destroy","pause","resume"];function w(t,r,i){n=n||e("./_stream_duplex"),t=t||{},"boolean"!=typeof i&&(i=r instanceof n),this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=b(this,t,"readableHighWaterMark",i),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(l||(l=e("string_decoder/").StringDecoder),this.decoder=new l(t.encoding),this.encoding=t.encoding)}function v(t){if(n=n||e("./_stream_duplex"),!(this instanceof v))return new v(t);var r=this instanceof n;this._readableState=new w(t,this,r),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),s.call(this)}function x(e,t,r,n,i){c("readableAddChunk",t);var s,u=e._readableState;if(null===t)u.reading=!1,function(e,t){if(c("onEofChunk"),t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?R(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,N(e)))}(e,u);else if(i||(s=function(e,t){var r;n=t,o.isBuffer(n)||n instanceof a||"string"==typeof t||t===undefined||e.objectMode||(r=new g("chunk",["string","Buffer","Uint8Array"],t));var n;return r}(u,t)),s)E(e,s);else if(u.objectMode||t&&t.length>0)if("string"==typeof t||u.objectMode||Object.getPrototypeOf(t)===o.prototype||(t=function(e){return o.from(e)}(t)),n)u.endEmitted?E(e,new _):I(e,u,t,!0);else if(u.ended)E(e,new y);else{if(u.destroyed)return!1;u.reading=!1,u.decoder&&!r?(t=u.decoder.write(t),u.objectMode||0!==t.length?I(e,u,t,!1):P(e,u)):I(e,u,t,!1)}else n||(u.reading=!1,P(e,u));return!u.ended&&(u.length<u.highWaterMark||0===u.length)}function I(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&R(e)),P(e,t)}Object.defineProperty(v.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==undefined&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),v.prototype.destroy=d.destroy,v.prototype._undestroy=d.undestroy,v.prototype._destroy=function(e,t){t(e)},v.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=o.from(e,t),t=""),r=!0),x(this,e,t,!1,r)},v.prototype.unshift=function(e){return x(this,e,null,!0,!1)},v.prototype.isPaused=function(){return!1===this._readableState.flowing},v.prototype.setEncoding=function(t){l||(l=e("string_decoder/").StringDecoder);var r=new l(t);this._readableState.decoder=r,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,i="";null!==n;)i+=r.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var A=1073741824;function T(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=A?e=A:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function R(e){var t=e._readableState;c("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(c("emitReadable",t.flowing),t.emittedReadable=!0,r.nextTick(N,e))}function N(e){var t=e._readableState;c("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,L(e)}function P(e,t){t.readingMore||(t.readingMore=!0,r.nextTick(O,e,t))}function O(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(c("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function B(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function C(e){c("readable nexttick read 0"),e.read(0)}function D(e,t){c("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),L(e),t.flowing&&!t.reading&&e.read(0)}function L(e){var t=e._readableState;for(c("flow",t.flowing);t.flowing&&null!==e.read(););}function M(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function K(e){var t=e._readableState;c("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,r.nextTick(j,t,e))}function j(e,t){if(c("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}function U(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}v.prototype.read=function(e){c("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return c("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?K(this):R(this),null;if(0===(e=T(e,t))&&t.ended)return 0===t.length&&K(this),null;var n,i=t.needReadable;return c("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&c("length less than watermark",i=!0),t.ended||t.reading?c("reading or ended",i=!1):i&&(c("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=T(r,t))),null===(n=e>0?M(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&K(this)),null!==n&&this.emit("data",n),n},v.prototype._read=function(e){E(this,new k("_read()"))},v.prototype.pipe=function(e,t){var n=this,s=this._readableState;switch(s.pipesCount){case 0:s.pipes=e;break;case 1:s.pipes=[s.pipes,e];break;default:s.pipes.push(e)}s.pipesCount+=1,c("pipe count=%d opts=%j",s.pipesCount,t);var o=(!t||!1!==t.end)&&e!==r.stdout&&e!==r.stderr?u:m;function a(t,r){c("onunpipe"),t===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,c("cleanup"),e.removeListener("close",d),e.removeListener("finish",b),e.removeListener("drain",l),e.removeListener("error",p),e.removeListener("unpipe",a),n.removeListener("end",u),n.removeListener("end",m),n.removeListener("data",f),h=!0,!s.awaitDrain||e._writableState&&!e._writableState.needDrain||l())}function u(){c("onend"),e.end()}s.endEmitted?r.nextTick(o):n.once("end",o),e.on("unpipe",a);var l=function(e){return function(){var t=e._readableState;c("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&i(e,"data")&&(t.flowing=!0,L(e))}}(n);e.on("drain",l);var h=!1;function f(t){c("ondata");var r=e.write(t);c("dest.write",r),!1===r&&((1===s.pipesCount&&s.pipes===e||s.pipesCount>1&&-1!==U(s.pipes,e))&&!h&&(c("false write response, pause",s.awaitDrain),s.awaitDrain++),n.pause())}function p(t){c("onerror",t),m(),e.removeListener("error",p),0===i(e,"error")&&E(e,t)}function d(){e.removeListener("finish",b),m()}function b(){c("onfinish"),e.removeListener("close",d),m()}function m(){c("unpipe"),n.unpipe(e)}return n.on("data",f),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",p),e.once("close",d),e.once("finish",b),e.emit("pipe",n),s.flowing||(c("pipe resume"),n.resume()),e},v.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var s=0;s<i;s++)n[s].emit("unpipe",this,{hasUnpiped:!1});return this}var o=U(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},v.prototype.on=function(e,t){var n=s.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===e&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,c("on readable",i.length,i.reading),i.length?R(this):i.reading||r.nextTick(C,this))),n},v.prototype.addListener=v.prototype.on,v.prototype.removeListener=function(e,t){var n=s.prototype.removeListener.call(this,e,t);return"readable"===e&&r.nextTick(B,this),n},v.prototype.removeAllListeners=function(e){var t=s.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&e!==undefined||r.nextTick(B,this),t},v.prototype.resume=function(){var e=this._readableState;return e.flowing||(c("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,r.nextTick(D,e,t))}(this,e)),e.paused=!1,this},v.prototype.pause=function(){return c("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(c("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},v.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",(function(){if(c("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(c("wrapped data"),r.decoder&&(i=r.decoder.write(i)),!r.objectMode||null!==i&&i!==undefined)&&((r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause())))})),e)this[i]===undefined&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var s=0;s<S.length;s++)e.on(S[s],this.emit.bind(this,S[s]));return this._read=function(t){c("wrapped _read",t),n&&(n=!1,e.resume())},this},"function"==typeof Symbol&&(v.prototype[Symbol.asyncIterator]=function(){return h===undefined&&(h=e("./internal/streams/async_iterator")),h(this)}),Object.defineProperty(v.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(v.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(v.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),v._fromList=M,Object.defineProperty(v.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(v.from=function(t,r){return f===undefined&&(f=e("./internal/streams/from")),f(v,t,r)})}).call(this)}).call(this,e("_process"))}}},{package:"3box>orbit-db>orbit-db-keystore>levelup>level-iterator-stream>readable-stream"}],[4818,{"../errors":4814,"./_stream_duplex":4815,inherits:4453},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=l;var n=e("../errors").codes,i=n.ERR_METHOD_NOT_IMPLEMENTED,s=n.ERR_MULTIPLE_CALLBACK,o=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=n.ERR_TRANSFORM_WITH_LENGTH_0,c=e("./_stream_duplex");function u(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(null===n)return this.emit("error",new s);r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function l(e){if(!(this instanceof l))return new l(e);c.call(this,e),this._transformState={afterTransform:u.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",h)}function h(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?f(this,null,null):this._flush((function(t,r){f(e,t,r)}))}function f(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new a;if(e._transformState.transforming)throw new o;return e.push(null)}e("inherits")(l,c),l.prototype.push=function(e,t){return this._transformState.needTransform=!1,c.prototype.push.call(this,e,t)},l.prototype._transform=function(e,t,r){r(new i("_transform()"))},l.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},l.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},l.prototype._destroy=function(e,t){c.prototype._destroy.call(this,e,(function(e){t(e)}))}}}},{package:"3box>orbit-db>orbit-db-keystore>levelup>level-iterator-stream>readable-stream"}],[4819,{"../errors":4814,"./_stream_duplex":4815,"./internal/streams/destroy":4822,"./internal/streams/state":4826,"./internal/streams/stream":4827,_process:5430,buffer:2132,inherits:4453,"util-deprecate":6019},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){function n(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;e.entry=null;for(;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree.next=e}(t,e)}}var i;t.exports=v,v.WritableState=w;var s={deprecate:e("util-deprecate")},o=e("./internal/streams/stream"),a=e("buffer").Buffer,c=global.Uint8Array||function(){};var u,l=e("./internal/streams/destroy"),h=e("./internal/streams/state").getHighWaterMark,f=e("../errors").codes,p=f.ERR_INVALID_ARG_TYPE,d=f.ERR_METHOD_NOT_IMPLEMENTED,b=f.ERR_MULTIPLE_CALLBACK,m=f.ERR_STREAM_CANNOT_PIPE,g=f.ERR_STREAM_DESTROYED,y=f.ERR_STREAM_NULL_VALUES,k=f.ERR_STREAM_WRITE_AFTER_END,_=f.ERR_UNKNOWN_ENCODING,E=l.errorOrDestroy;function S(){}function w(t,s,o){i=i||e("./_stream_duplex"),t=t||{},"boolean"!=typeof o&&(o=s instanceof i),this.objectMode=!!t.objectMode,o&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=h(this,t,"writableHighWaterMark",o),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=!1===t.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,i=n.sync,s=n.writecb;if("function"!=typeof s)throw new b;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,i,s){--t.pendingcb,n?(r.nextTick(s,i),r.nextTick(N,e,t),e._writableState.errorEmitted=!0,E(e,i)):(s(i),e._writableState.errorEmitted=!0,E(e,i),N(e,t))}(e,n,i,t,s);else{var o=T(n)||e.destroyed;o||n.corked||n.bufferProcessing||!n.bufferedRequest||A(e,n),i?r.nextTick(I,e,n,o,s):I(e,n,o,s)}}(s,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new n(this)}function v(t){var r=this instanceof(i=i||e("./_stream_duplex"));if(!r&&!u.call(v,this))return new v(t);this._writableState=new w(t,this,r),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),o.call(this)}function x(e,t,r,n,i,s,o){t.writelen=n,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new g("write")):r?e._writev(i,t.onwrite):e._write(i,s,t.onwrite),t.sync=!1}function I(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),N(e,t)}function A(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var i=t.bufferedRequestCount,s=new Array(i),o=t.corkedRequestsFree;o.entry=r;for(var a=0,c=!0;r;)s[a]=r,r.isBuf||(c=!1),r=r.next,a+=1;s.allBuffers=c,x(e,t,!0,t.length,s,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new n(t),t.bufferedRequestCount=0}else{for(;r;){var u=r.chunk,l=r.encoding,h=r.callback;if(x(e,t,!1,t.objectMode?1:u.length,u,l,h),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function T(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function R(e,t){e._final((function(r){t.pendingcb--,r&&E(e,r),t.prefinished=!0,e.emit("prefinish"),N(e,t)}))}function N(e,t){var n=T(t);if(n&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,r.nextTick(R,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var i=e._readableState;(!i||i.autoDestroy&&i.endEmitted)&&e.destroy()}return n}e("inherits")(v,o),w.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(w.prototype,"buffer",{get:s.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer "+"instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(u=Function.prototype[Symbol.hasInstance],Object.defineProperty(v,Symbol.hasInstance,{value:function(e){return!!u.call(this,e)||this===v&&(e&&e._writableState instanceof w)}})):u=function(e){return e instanceof this},v.prototype.pipe=function(){E(this,new m)},v.prototype.write=function(e,t,n){var i,s=this._writableState,o=!1,u=!s.objectMode&&(i=e,a.isBuffer(i)||i instanceof c);return u&&!a.isBuffer(e)&&(e=function(e){return a.from(e)}(e)),"function"==typeof t&&(n=t,t=null),u?t="buffer":t||(t=s.defaultEncoding),"function"!=typeof n&&(n=S),s.ending?function(e,t){var n=new k;E(e,n),r.nextTick(t,n)}(this,n):(u||function(e,t,n,i){var s;return null===n?s=new y:"string"==typeof n||t.objectMode||(s=new p("chunk",["string","Buffer"],n)),!s||(E(e,s),r.nextTick(i,s),!1)}(this,s,e,n))&&(s.pendingcb++,o=function(e,t,r,n,i,s){if(!r){var o=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=a.from(t,r));return t}(t,n,i);n!==o&&(r=!0,i="buffer",n=o)}var c=t.objectMode?1:n.length;t.length+=c;var u=t.length<t.highWaterMark;u||(t.needDrain=!0);if(t.writing||t.corked){var l=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:s,next:null},l?l.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else x(e,t,!1,c,n,i,s);return u}(this,s,u,e,t,n)),o},v.prototype.cork=function(){this._writableState.corked++},v.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||A(this,e))},v.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new _(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(v.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(v.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),v.prototype._write=function(e,t,r){r(new d("_write()"))},v.prototype._writev=null,v.prototype.end=function(e,t,n){var i=this._writableState;return"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!==e&&e!==undefined&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||function(e,t,n){t.ending=!0,N(e,t),n&&(t.finished?r.nextTick(n):e.once("finish",n));t.ended=!0,e.writable=!1}(this,i,n),this},Object.defineProperty(v.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(v.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==undefined&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),v.prototype.destroy=l.destroy,v.prototype._undestroy=l.undestroy,v.prototype._destroy=function(e,t){t(e)}}).call(this)}).call(this,e("_process"))}}},{package:"3box>orbit-db>orbit-db-keystore>levelup>level-iterator-stream>readable-stream"}],[4820,{"./end-of-stream":4823,_process:5430},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n;function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=e("./end-of-stream"),o=Symbol("lastResolve"),a=Symbol("lastReject"),c=Symbol("error"),u=Symbol("ended"),l=Symbol("lastPromise"),h=Symbol("handlePromise"),f=Symbol("stream");function p(e,t){return{value:e,done:t}}function d(e){var t=e[o];if(null!==t){var r=e[f].read();null!==r&&(e[l]=null,e[o]=null,e[a]=null,t(p(r,!1)))}}function b(e){r.nextTick(d,e)}var m=Object.getPrototypeOf((function(){})),g=Object.setPrototypeOf((i(n={get stream(){return this[f]},next:function(){var e=this,t=this[c];if(null!==t)return Promise.reject(t);if(this[u])return Promise.resolve(p(undefined,!0));if(this[f].destroyed)return new Promise((function(t,n){r.nextTick((function(){e[c]?n(e[c]):t(p(undefined,!0))}))}));var n,i=this[l];if(i)n=new Promise(function(e,t){return function(r,n){e.then((function(){t[u]?r(p(undefined,!0)):t[h](r,n)}),n)}}(i,this));else{var s=this[f].read();if(null!==s)return Promise.resolve(p(s,!1));n=new Promise(this[h])}return this[l]=n,n}},Symbol.asyncIterator,(function(){return this})),i(n,"return",(function(){var e=this;return new Promise((function(t,r){e[f].destroy(null,(function(e){e?r(e):t(p(undefined,!0))}))}))})),n),m);t.exports=function(e){var t,r=Object.create(g,(i(t={},f,{value:e,writable:!0}),i(t,o,{value:null,writable:!0}),i(t,a,{value:null,writable:!0}),i(t,c,{value:null,writable:!0}),i(t,u,{value:e._readableState.endEmitted,writable:!0}),i(t,h,{value:function(e,t){var n=r[f].read();n?(r[l]=null,r[o]=null,r[a]=null,e(p(n,!1))):(r[o]=e,r[a]=t)},writable:!0}),t));return r[l]=null,s(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=r[a];return null!==t&&(r[l]=null,r[o]=null,r[a]=null,t(e)),void(r[c]=e)}var n=r[o];null!==n&&(r[l]=null,r[o]=null,r[a]=null,n(p(undefined,!0))),r[u]=!0})),e.on("readable",b.bind(null,r)),r}}).call(this)}).call(this,e("_process"))}}},{package:"3box>orbit-db>orbit-db-keystore>levelup>level-iterator-stream>readable-stream"}],[4821,{buffer:2132,util:2131},function(){with(this)return function(){"use strict";return function(e,t,r){function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=e("buffer").Buffer,a=e("util").inspect,c=a&&a.custom||"inspect";t.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,r,u;return t=e,r=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return o.alloc(0);for(var t,r,n,i=o.allocUnsafe(e>>>0),s=this.head,a=0;s;)t=s.data,r=i,n=a,o.prototype.copy.call(t,r,n),a+=s.data.length,s=s.next;return i}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,n=t.data;for(e-=n.length;t=t.next;){var i=t.data,s=e>i.length?i.length:e;if(s===i.length?n+=i:n+=i.slice(0,e),0==(e-=s)){s===i.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(s));break}++r}return this.length-=r,n}},{key:"_getBuffer",value:function(e){var t=o.allocUnsafe(e),r=this.head,n=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var i=r.data,s=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,s),0==(e-=s)){s===i.length?(++n,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=i.slice(s));break}++n}return this.length-=n,t}},{key:c,value:function(e,t){return a(this,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}],r&&s(t.prototype,r),u&&s(t,u),e}()}}},{package:"3box>orbit-db>orbit-db-keystore>levelup>level-iterator-stream>readable-stream"}],[4822,{_process:5430},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e){(function(){function r(e,t){i(e,t),n(e)}function n(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function i(e,t){e.emit("error",t)}t.exports={destroy:function(t,s){var o=this,a=this._readableState&&this._readableState.destroyed,c=this._writableState&&this._writableState.destroyed;return a||c?(s?s(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,e.nextTick(i,this,t)):e.nextTick(i,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!s&&t?o._writableState?o._writableState.errorEmitted?e.nextTick(n,o):(o._writableState.errorEmitted=!0,e.nextTick(r,o,t)):e.nextTick(r,o,t):s?(e.nextTick(n,o),s(t)):e.nextTick(n,o)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var r=e._readableState,n=e._writableState;r&&r.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this)}).call(this,e("_process"))}}},{package:"3box>orbit-db>orbit-db-keystore>levelup>level-iterator-stream>readable-stream"}],[4823,{"../../../errors":4814},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function i(){}t.exports=function e(t,r,s){if("function"==typeof r)return e(t,null,r);r||(r={}),s=function(e){var t=!1;return function(){if(!t){t=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];e.apply(this,n)}}}(s||i);var o=r.readable||!1!==r.readable&&t.readable,a=r.writable||!1!==r.writable&&t.writable,c=function(){t.writable||l()},u=t._writableState&&t._writableState.finished,l=function(){a=!1,u=!0,o||s.call(t)},h=t._readableState&&t._readableState.endEmitted,f=function(){o=!1,h=!0,a||s.call(t)},p=function(e){s.call(t,e)},d=function(){var e;return o&&!h?(t._readableState&&t._readableState.ended||(e=new n),s.call(t,e)):a&&!u?(t._writableState&&t._writableState.ended||(e=new n),s.call(t,e)):void 0},b=function(){t.req.on("finish",l)};return!function(e){return e.setHeader&&"function"==typeof e.abort}(t)?a&&!t._writableState&&(t.on("end",c),t.on("close",c)):(t.on("complete",l),t.on("abort",d),t.req?b():t.on("request",b)),t.on("end",f),t.on("finish",l),!1!==r.error&&t.on("error",p),t.on("close",d),function(){t.removeListener("complete",l),t.removeListener("abort",d),t.removeListener("request",b),t.req&&t.req.removeListener("finish",l),t.removeListener("end",c),t.removeListener("close",c),t.removeListener("finish",l),t.removeListener("end",f),t.removeListener("error",p),t.removeListener("close",d)}}}}},{package:"3box>orbit-db>orbit-db-keystore>levelup>level-iterator-stream>readable-stream"}],[4824,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(){throw new Error("Readable.from is not available in the browser")}}}},{package:"3box>orbit-db>orbit-db-keystore>levelup>level-iterator-stream>readable-stream"}],[4825,{"../../../errors":4814,"./end-of-stream":4823},function(){with(this)return function(){"use strict";return function(e,t,r){var n;var i=e("../../../errors").codes,s=i.ERR_MISSING_ARGS,o=i.ERR_STREAM_DESTROYED;function a(e){if(e)throw e}function c(t,r,i,s){s=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(s);var a=!1;t.on("close",(function(){a=!0})),n===undefined&&(n=e("./end-of-stream")),n(t,{readable:r,writable:i},(function(e){if(e)return s(e);a=!0,s()}));var c=!1;return function(e){if(!a&&!c)return c=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(t)?t.abort():"function"==typeof t.destroy?t.destroy():void s(e||new o("pipe"))}}function u(e){e()}function l(e,t){return e.pipe(t)}function h(e){return e.length?"function"!=typeof e[e.length-1]?a:e.pop():a}t.exports=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,i=h(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new s("streams");var o=t.map((function(e,r){var s=r<t.length-1;return c(e,s,r>0,(function(e){n||(n=e),e&&o.forEach(u),s||(o.forEach(u),i(n))}))}));return t.reduce(l)}}}},{package:"3box>orbit-db>orbit-db-keystore>levelup>level-iterator-stream>readable-stream"}],[4826,{"../../../errors":4814},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;t.exports={getHighWaterMark:function(e,t,r,i){var s=function(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}(t,i,r);if(null!=s){if(!isFinite(s)||Math.floor(s)!==s||s<0)throw new n(i?r:"highWaterMark",s);return Math.floor(s)}return e.objectMode?16:16384}}}}},{package:"3box>orbit-db>orbit-db-keystore>levelup>level-iterator-stream>readable-stream"}],[4827,{events:2133},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e("events").EventEmitter}}},{package:"3box>orbit-db>orbit-db-keystore>levelup>level-iterator-stream>readable-stream"}],[4828,{"./lib/_stream_duplex.js":4815,"./lib/_stream_passthrough.js":4816,"./lib/_stream_readable.js":4817,"./lib/_stream_transform.js":4818,"./lib/_stream_writable.js":4819,"./lib/internal/streams/end-of-stream.js":4823,"./lib/internal/streams/pipeline.js":4825},function(){with(this)return function(){"use strict";return function(e,t,r){(r=t.exports=e("./lib/_stream_readable.js")).Stream=r,r.Readable=r,r.Writable=e("./lib/_stream_writable.js"),r.Duplex=e("./lib/_stream_duplex.js"),r.Transform=e("./lib/_stream_transform.js"),r.PassThrough=e("./lib/_stream_passthrough.js"),r.finished=e("./lib/internal/streams/end-of-stream.js"),r.pipeline=e("./lib/internal/streams/pipeline.js")}}},{package:"3box>orbit-db>orbit-db-keystore>levelup>level-iterator-stream>readable-stream"}],[4829,{"../is-buffer/index.js":4735,"./iterator":4830,"./util/immediate":4831,"./util/mixed-to-buffer":4832,"./util/support":4833,"abstract-leveldown":1778,inherits:4453},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){t.exports=l;var n=e("abstract-leveldown").AbstractLevelDOWN,i=e("inherits"),s=e("./iterator"),o=e("./util/mixed-to-buffer"),a=e("./util/immediate"),c=e("./util/support"),u="level-js-";function l(e,t){if(!(this instanceof l))return new l(e,t);if(n.call(this),t=t||{},"string"!=typeof e)throw new Error("constructor requires a location string argument");this.location=e,this.prefix=t.prefix||u,this.version=parseInt(t.version||1,10)}i(l,n),l.binaryKeys=c.binaryKeys(indexedDB),l.arrayKeys=c.arrayKeys(indexedDB),l.prototype._open=function(e,t){var r=indexedDB.open(this.prefix+this.location,this.version),n=this;r.onerror=function(){t(r.error||new Error("unknown error"))},r.onsuccess=function(){n.db=r.result,t()},r.onupgradeneeded=function(e){var t=e.target.result;t.objectStoreNames.contains(n.location)||t.createObjectStore(n.location)}},l.prototype.store=function(e){return this.db.transaction([this.location],e).objectStore(this.location)},l.prototype.await=function(e,t){var r=e.transaction;r.onabort=function(){t(r.error||new Error("aborted by user"))},r.oncomplete=function(){t(null,e.result)}},l.prototype._get=function(e,t,r){var n=this.store("readonly");try{var i=n.get(e)}catch(e){return a((function(){r(e)}))}this.await(i,(function(e,n){return e?r(e):n===undefined?r(new Error("NotFound")):(t.asBuffer&&(n=o(n)),void r(null,n))}))},l.prototype._del=function(e,t,r){var n=this.store("readwrite");try{var i=n.delete(e)}catch(e){return a((function(){r(e)}))}this.await(i,r)},l.prototype._put=function(e,t,r,n){var i=this.store("readwrite");try{var s=i.put(t,e)}catch(e){return a((function(){n(e)}))}this.await(s,n)},l.prototype._serializeKey=function(e){return r.isBuffer(e)?l.binaryKeys?e:e.toString():Array.isArray(e)?l.arrayKeys?e.map(this._serializeKey,this):String(e):e},l.prototype._serializeValue=function(e){return e},l.prototype._iterator=function(e){return new s(this,this.location,e)},l.prototype._batch=function(e,t,r){if(0===e.length)return a(r);var n,i=this.store("readwrite"),s=i.transaction,o=0;s.onabort=function(){r(n||s.error||new Error("aborted by user"))},s.oncomplete=function(){r()},function t(){var r=e[o++],a=r.key;try{var c="del"===r.type?i.delete(a):i.put(r.value,a)}catch(e){return n=e,void s.abort()}o<e.length&&(c.onsuccess=t)}()},l.prototype._close=function(e){this.db.close(),a(e)},l.destroy=function(e,t,r){"function"==typeof t&&(r=t,t=u);var n=indexedDB.deleteDatabase(t+e);n.onsuccess=function(){r()},n.onerror=function(e){r(e)}}}).call(this)}).call(this,{isBuffer:e("../is-buffer/index.js")})}}},{package:"3box>orbit-db>orbit-db-cache>level-js"}],[4830,{"./util/immediate":4831,"./util/mixed-to-buffer":4832,"abstract-leveldown":1778,inherits:4453,ltgt:5204},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("inherits"),i=e("abstract-leveldown").AbstractIterator,s=e("ltgt"),o=e("./util/mixed-to-buffer"),a=e("./util/immediate"),c=function(){};function u(e,t,r){if(i.call(this,e),this._limit=r.limit,this._count=0,this._callback=null,this._cache=[],this._completed=!1,this._aborted=!1,this._error=null,this._transaction=null,this._keyAsBuffer=r.keyAsBuffer,this._valueAsBuffer=r.valueAsBuffer,0!==this._limit){try{var n=this.createKeyRange(r)}catch(e){return void(this._completed=!0)}this.createIterator(t,n,r.reverse)}else this._completed=!0}t.exports=u,n(u,i),u.prototype.createKeyRange=function(e){var t=s.lowerBound(e),r=s.upperBound(e),n=s.lowerBoundExclusive(e),i=s.upperBoundExclusive(e);return t!==undefined&&r!==undefined?IDBKeyRange.bound(t,r,n,i):t!==undefined?IDBKeyRange.lowerBound(t,n):r!==undefined?IDBKeyRange.upperBound(r,i):null},u.prototype.createIterator=function(e,t,r){var n=this,i=this.db.db.transaction([e],"readonly");i.objectStore(e).openCursor(t,r?"prev":"next").onsuccess=function(e){var t=e.target.result;t&&n.onItem(t)},this._transaction=i,i.onabort=function(){n.onAbort(n._transaction.error||new Error("aborted by user"))},i.oncomplete=function(){n.onComplete()}},u.prototype.onItem=function(e){this._cache.push(e.key,e.value),(this._limit<=0||++this._count<this._limit)&&e.continue(),this.maybeNext()},u.prototype.onAbort=function(e){this._aborted=!0,this._error=e,this.maybeNext()},u.prototype.onComplete=function(){this._completed=!0,this.maybeNext()},u.prototype.maybeNext=function(){this._callback&&(this._next(this._callback),this._callback=null)},u.prototype._next=function(e){if(this._aborted){var t=this._error;this._error=null,a((function(){e(t)}))}else if(this._cache.length>0){var r=this._cache.shift(),n=this._cache.shift();this._keyAsBuffer&&(r=o(r)),this._valueAsBuffer&&(n=o(n)),a((function(){e(null,r,n)}))}else this._completed?a(e):this._callback=e},u.prototype._end=function(e){if(this._aborted||this._completed){var t=this._error;a((function(){e(t)}))}else this.onItem=c,this.onAbort=e,this.onComplete=e}}}},{package:"3box>orbit-db>orbit-db-cache>level-js"}],[4831,{immediate:4443},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e("immediate")}}},{package:"3box>orbit-db>orbit-db-cache>level-js"}],[4832,{buffer:2132,"typedarray-to-buffer":6005},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("typedarray-to-buffer");t.exports=function(e){return e instanceof Uint8Array?n(e):e instanceof ArrayBuffer?r.from(e):r.from(String(e))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>orbit-db>orbit-db-cache>level-js"}],[4833,{},function(){with(this)return function(){"use strict";return function(e,t,r){r.test=function(e){return function(t){try{return t.cmp(e,0),!0}catch(e){return!1}}},r.binaryKeys=r.test(new Uint8Array(0)),r.arrayKeys=r.test([1])}}},{package:"3box>orbit-db>orbit-db-cache>level-js"}],[4834,{"./common":4835,"./promisify":4837,"level-errors":4812},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("level-errors").WriteError,i=e("./promisify"),s=e("./common").getCallback,o=e("./common").getOptions;function a(e){this._levelup=e,this.batch=e.db.batch(),this.ops=[],this.length=0}a.prototype.put=function(e,t){try{this.batch.put(e,t)}catch(e){throw new n(e)}return this.ops.push({type:"put",key:e,value:t}),this.length++,this},a.prototype.del=function(e){try{this.batch.del(e)}catch(e){throw new n(e)}return this.ops.push({type:"del",key:e}),this.length++,this},a.prototype.clear=function(){try{this.batch.clear()}catch(e){throw new n(e)}return this.ops=[],this.length=0,this},a.prototype.write=function(e,t){var r,a=this._levelup,c=this.ops;(t=s(e,t))||(r=(t=i()).promise),e=o(e);try{this.batch.write(e,(function(e){if(e)return t(new n(e));a.emit("batch",c),t()}))}catch(e){throw new n(e)}return r},t.exports=a}}},{package:"3box>orbit-db>orbit-db-keystore>levelup"}],[4835,{},function(){with(this)return function(){"use strict";return function(e,t,r){r.getCallback=function(e,t){return"function"==typeof e?e:t},r.getOptions=function(e){return"object"==typeof e&&null!==e?e:{}}}}},{package:"3box>orbit-db>orbit-db-keystore>levelup"}],[4836,{"./batch":4834,"./common":4835,"./promisify":4837,_process:5430,assert:1805,"deferred-leveldown":2310,events:2133,"level-errors":4812,"level-iterator-stream":4813,util:2138,xtend:6173},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("events").EventEmitter,i=e("util").inherits,s=e("xtend"),o=e("deferred-leveldown"),a=e("level-iterator-stream"),c=e("./batch"),u=e("level-errors"),l=e("assert"),h=e("./promisify"),f=e("./common").getCallback,p=e("./common").getOptions,d=u.WriteError,b=u.ReadError,m=u.NotFoundError,g=u.OpenError,y=u.InitializationError;function k(e,t,i){if(!(this instanceof k))return new k(e,t,i);var s;if(n.call(this),this.setMaxListeners(Infinity),"function"==typeof t&&(i=t,t={}),t=t||{},!e||"object"!=typeof e){if(s=new y("First argument must be an abstract-leveldown compliant store"),"function"==typeof i)return r.nextTick(i,s);throw s}l.strictEqual(typeof e.status,"string",".status required, old abstract-leveldown"),this.options=p(t),this._db=e,this.db=new o(e),this.open(i)}function _(e,t){if(!e._isOpening()&&!e.isOpen())return r.nextTick(t,new b("Database is not open")),!0}k.prototype.emit=n.prototype.emit,k.prototype.once=n.prototype.once,i(k,n),k.prototype.open=function(e,t){var n,i=this;return"function"==typeof e&&(t=e,e=null),t||(n=(t=h()).promise),e||(e=this.options),this.isOpen()?(r.nextTick(t,null,i),n):this._isOpening()?(this.once("open",(function(){t(null,i)})),n):(this.emit("opening"),this.db.open(e,(function(e){if(e)return t(new g(e));i.db=i._db,t(null,i),i.emit("open"),i.emit("ready")})),n)},k.prototype.close=function(e){var t,n=this;return e||(t=(e=h()).promise),this.isOpen()?(this.db.close((function(){n.emit("closed"),e.apply(null,arguments)})),this.emit("closing"),this.db=new o(this._db)):this.isClosed()?r.nextTick(e):"closing"===this.db.status?this.once("closed",e):this._isOpening()&&this.once("open",(function(){n.close(e)})),t},k.prototype.isOpen=function(){return"open"===this.db.status},k.prototype._isOpening=function(){return"opening"===this.db.status},k.prototype.isClosed=function(){return/^clos|new/.test(this.db.status)},k.prototype.get=function(e,t,r){if(null===e||e===undefined)throw new b("get() requires a key argument");var n;return(r=f(t,r))||(n=(r=h()).promise),_(this,r)||(t=p(t),this.db.get(e,t,(function(t,n){if(t)return t=/notfound/i.test(t)||t.notFound?new m("Key not found in database ["+e+"]",t):new b(t),r(t);r(null,n)}))),n},k.prototype.put=function(e,t,r,n){if(null===e||e===undefined)throw new d("put() requires a key argument");var i,s=this;return(n=f(r,n))||(i=(n=h()).promise),_(this,n)||(r=p(r),this.db.put(e,t,r,(function(r){if(r)return n(new d(r));s.emit("put",e,t),n()}))),i},k.prototype.del=function(e,t,r){if(null===e||e===undefined)throw new d("del() requires a key argument");var n,i=this;return(r=f(t,r))||(n=(r=h()).promise),_(this,r)||(t=p(t),this.db.del(e,t,(function(t){if(t)return r(new d(t));i.emit("del",e),r()}))),n},k.prototype.batch=function(e,t,r){if(!arguments.length)return new c(this);if(!Array.isArray(e))throw new d("batch() requires an array argument");var n,i=this;return(r=f(t,r))||(n=(r=h()).promise),_(this,r)||(t=p(t),this.db.batch(e,t,(function(t){if(t)return r(new d(t));i.emit("batch",e),r()}))),n},k.prototype.iterator=function(e){return this.db.iterator(e)},k.prototype.readStream=k.prototype.createReadStream=function(e){return"number"!=typeof(e=s({keys:!0,values:!0},e)).limit&&(e.limit=-1),new a(this.db.iterator(e),e)},k.prototype.keyStream=k.prototype.createKeyStream=function(e){return this.createReadStream(s(e,{keys:!0,values:!1}))},k.prototype.valueStream=k.prototype.createValueStream=function(e){return this.createReadStream(s(e,{keys:!1,values:!0}))},k.prototype.toString=function(){return"LevelUP"},k.errors=u,t.exports=k.default=k}).call(this)}).call(this,e("_process"))}}},{package:"3box>orbit-db>orbit-db-keystore>levelup"}],[4837,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(){var e,t=new Promise((function(t,r){e=function(e,n){e?r(e):t(n)}}));return e.promise=t,e}}}},{package:"3box>orbit-db>orbit-db-keystore>levelup"}],[4838,{"async/nextTick":1872,debug:2304,events:2133,mafmt:5206,multiaddr:5224,"peer-id":5420,"peer-info":5421},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("peer-id"),i=e("peer-info"),s=e("multiaddr"),o=e("mafmt"),a=e("events").EventEmitter,c=e("debug"),u=e("async/nextTick"),l=c("libp2p:bootstrap");l.error=c("libp2p:bootstrap:error");(t.exports=class extends a{constructor(e){super(),this._list=e.list,this._interval=e.interval||1e4,this._timer=null}start(e){if(this._timer)return u((()=>e()));this._timer=setInterval((()=>this._discoverBootstrapPeers()),this._interval),u((()=>{e(),this._discoverBootstrapPeers()}))}_discoverBootstrapPeers(){this._list.forEach((e=>{if(!function(e){try{return o.IPFS.matches(e)}catch(e){return!1}}(e))return l.error("Invalid multiaddr");const t=s(e),r=n.createFromB58String(t.getPeerId());i.create(r,((e,r)=>{if(e)return l.error("Invalid bootstrap peer id",e);r.multiaddrs.add(t),this.emit("peer",r)}))}))}stop(e){u(e),this._timer&&(clearInterval(this._timer),this._timer=null)}}).tag="bootstrap"}}},{package:"3box>ipfs>libp2p-bootstrap"}],[4839,{"./circuit/dialer":4840,"./circuit/utils":4844,"./listener":4846,debug:2304,mafmt:5206,multiaddr:5224},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("mafmt"),i=e("multiaddr"),s=e("./circuit/dialer"),o=e("./circuit/utils"),a=e("debug");a("libp2p:circuit:transportdialer").err=a("libp2p:circuit:error:transportdialer");const c=e("./listener");t.exports=class{static get tag(){return"Circuit"}constructor(e,t){this.options=t||{},this.swarm=e,this.dialer=null,this.utils=o(e),this.peerInfo=this.swarm._peerInfo,this.relays=this.filter(this.peerInfo.multiaddrs.toArray()),0===this.relays.length&&this.peerInfo.multiaddrs.add(`/p2p-circuit/ipfs/${this.peerInfo.id.toB58String()}`),this.dialer=new s(e,t),this.swarm.on("peer-mux-established",(e=>{this.dialer.canHop(e)})),this.swarm.on("peer-mux-closed",(e=>{this.dialer.relayPeers.delete(e.id.toB58String())}))}_dialSwarmRelays(){this.relays.forEach((e=>{e.toString().split("/p2p-circuit").filter((e=>e.length)).forEach((e=>{const t=this.utils.peerInfoFromMa(i(e));this.dialer._dialRelay(t)}))}))}dial(e,t,r){return this.dialer.dial(e,t,r)}createListener(e,t){"function"==typeof e&&(t=e,e=this.options||{});const r=c(this.swarm,e,t);return r.on("listen",this._dialSwarmRelays.bind(this)),r}filter(e){return Array.isArray(e)||(e=[e]),e.filter((e=>n.Circuit.matches(e)))}}}}},{package:"3box>ipfs>libp2p>libp2p-switch>libp2p-circuit"}],[4840,{"../multicodec":4847,"../protocol":4848,"./stream-handler":4843,"./utils":4844,"async/setImmediate":1878,"async/waterfall":1884,debug:2304,"interface-connection":4455,multiaddr:5224,once:5323,"peer-id":5420},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("once"),i=e("peer-id"),s=e("async/waterfall"),o=e("async/setImmediate"),a=e("multiaddr"),c=e("interface-connection").Connection,u=e("./utils"),l=e("./stream-handler"),h=e("debug"),f=h("libp2p:circuit:dialer");f.err=h("libp2p:circuit:error:dialer");const p=e("../multicodec"),d=e("../protocol");t.exports=class{constructor(e,t){this.swarm=e,this.relayPeers=new Map,this.relayConns=new Map,this.options=t,this.utils=u(e)}_dialRelayHelper(e,t){return this.relayConns.has(e.id.toB58String())?t(null,this.relayConns.get(e.id.toB58String())):this._dialRelay(e,t)}dial(e,t){t=t||(()=>{});const r=e.toString();if(!r.includes("/p2p-circuit"))return f.err("invalid circuit address"),t(new Error("invalid circuit address"));const n=r.split("p2p-circuit"),i="/"===n[0]?null:a(n[0]),s=a(n[1]||n[0]),u=new c;return o(this._dialPeer.bind(this),s,i,((e,r)=>{if(e)return f.err(e),t(e);u.setInnerConn(r),t(null,u)})),u}canHop(e,t){t=n(t||(()=>{})),this._dialRelayHelper(e,((r,n)=>{if(r)return t(r);const i=new l(n);s([e=>i.write(d.CircuitRelay.encode({type:d.CircuitRelay.Type.CAN_HOP}),e),e=>i.read(e)],((r,n)=>{if(r)return t(r);if(d.CircuitRelay.decode(n).code!==d.CircuitRelay.Status.SUCCESS){const r=new Error(`HOP not supported, skipping - ${this.utils.getB58String(e)}`);return f(r),t(r)}f("HOP supported adding as relay - %s",this.utils.getB58String(e)),this.relayPeers.set(this.utils.getB58String(e),e),i.close(),t()}))}))}_dialPeer(e,t,r){if("function"==typeof t&&(r=t,t=null),r||(r=()=>{}),e=a(e),t)return this._negotiateRelay(t,e,((e,t)=>e?(f.err("An error has occurred negotiating the relay connection",e),r(e)):r(null,t)));{const t=Array.from(this.relayPeers.values());let n=i=>{if(!i){let e="no relay peers were found or all relays failed to dial";return f.err(e),r(e)}return this._negotiateRelay(i,e,((e,i)=>{if(e)return f.err(e),n(t.shift());r(null,i)}))};n(t.shift())}}_negotiateRelay(e,t,r){t=a(t),e=this.utils.peerInfoFromMa(e);const n=this.swarm._peerInfo.multiaddrs.toArray();this._dialRelayHelper(e,((e,o)=>{if(e)return f.err(e),r(e);let a=new l(o);s([e=>{let r;f("negotiating relay for peer %s",t.getPeerId());try{r=i.createFromB58String(t.getPeerId()).id}catch(t){return e(t)}a.write(d.CircuitRelay.encode({type:d.CircuitRelay.Type.HOP,srcPeer:{id:this.swarm._peerInfo.id.id,addrs:n.map((e=>e.buffer))},dstPeer:{id:r,addrs:[t.buffer]}}),e)},e=>a.read(e)],((e,t)=>{if(e)return r(e);const n=d.CircuitRelay.decode(t);return n.type!==d.CircuitRelay.Type.STATUS?r(new Error(`Got invalid message type - expected ${d.CircuitRelay.Type.STATUS} got ${n.type}`)):n.code!==d.CircuitRelay.Status.SUCCESS?r(new Error(`Got ${n.code} error code trying to dial over relay`)):void r(null,new c(a.rest()))}))}))}_dialRelay(e,t){t=n(t||(()=>{})),this.swarm.dial(e,p.relay,n(((e,r)=>{if(e)return f.err(e),t(e);t(null,r)})))}}}}},{package:"3box>ipfs>libp2p>libp2p-switch>libp2p-circuit"}],[4841,{"../protocol":4848,"./../multicodec":4847,"./stream-handler":4843,"./utils":4844,"async/series":1877,"async/setImmediate":1878,"async/waterfall":1884,debug:2304,events:2133,multiaddr:5224,once:5323,"peer-id":5420,"peer-info":5421,"pull-stream/pull":5488},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("pull-stream/pull"),i=e("debug"),s=e("peer-info"),o=e("peer-id"),a=e("events").EventEmitter,c=e("once"),u=e("./utils"),l=e("./stream-handler"),h=e("../protocol").CircuitRelay,f=e("multiaddr"),p=e("async/series"),d=e("async/waterfall"),b=e("async/setImmediate"),m=e("./../multicodec"),g=i("libp2p:circuit:relay");g.err=i("libp2p:circuit:error:relay");t.exports=class extends a{constructor(e,t){super(),this.swarm=e,this.peerInfo=this.swarm._peerInfo,this.utils=u(e),this.config=t||{active:!1,enabled:!1},this.active=this.config.active}handle(e,t){if(!this.config.enabled)return this.utils.writeResponse(t,h.Status.HOP_CANT_SPEAK_RELAY),t.close();if(e.type===h.Type.CAN_HOP)return this.utils.writeResponse(t,h.Status.SUCCESS),t.close();let r=null,n=null;try{r=o.createFromBytes(e.srcPeer.id).toB58String(),n=o.createFromBytes(e.dstPeer.id).toB58String()}catch(e){if(g.err(e),!r)return this.utils.writeResponse(t,h.Status.HOP_SRC_MULTIADDR_INVALID),t.close();if(!n)return this.utils.writeResponse(t,h.Status.HOP_DST_MULTIADDR_INVALID),t.close()}if(r===n)return this.utils.writeResponse(t,h.Status.HOP_CANT_RELAY_TO_SELF),t.close();if(!e.dstPeer.addrs.length){const t=f(`/p2p-circuit/ipfs/${n}`).buffer;e.dstPeer.addrs.push(t)}g("trying to establish a circuit: %s <-> %s",r,n);const i=()=>(this.utils.writeResponse(t,h.Status.HOP_NO_CONN_TO_DST),t.close()),s=e=>{let t;try{if(t=this.swarm._peerBook.get(n),!t.isConnected()&&!this.active){const t=new Error(`No Connection to peer ${n}`);return i(),e(t)}}catch(t){if(!this.active)return i(),e(t)}e()};p([r=>this.utils.validateAddrs(e,t,h.Type.HOP,r),e=>s(e),r=>this._circuit(t,e,r)],(e=>{if(e)return g.err(e),t.close(),b((()=>this.emit("circuit:error",e)));b((()=>this.emit("circuit:success")))}))}_connectToStop(e,t,r){this._dialPeer(e,((e,n)=>e?(this.utils.writeResponse(t,h.Status.HOP_CANT_DIAL_DST),g.err(e),r(e)):this.utils.writeResponse(t,h.Status.SUCCESS,(e=>e?(g.err(e),r(e)):r(null,n)))))}_negotiateStop(e,t,r,n){const i=Object.assign({},r,{type:h.Type.STOP});e.write(h.encode(i),(r=>{if(r)return this.utils.writeResponse(t,h.Status.HOP_CANT_OPEN_DST_STREAM),g.err(r),n(r);e.read(((e,t)=>{if(e)return g.err(e),n(e);return h.decode(t).code!==h.Status.SUCCESS?n(new Error("Unable to create circuit!")):n(null,t)}))}))}_circuit(e,t,r){let i=null;d([r=>this._connectToStop(t.dstPeer,e,r),(r,n)=>{i=new l(r),this._negotiateStop(i,e,t,n)}],(s=>{if(s)return e&&e.close(),i&&i.close(),r(s);const a=e.rest(),c=i.rest(),u=o.createFromBytes(t.srcPeer.id).toB58String(),l=o.createFromBytes(t.dstPeer.id).toB58String();n(a,c,a),g("circuit %s <-> %s established",u,l),r()}))}_dialPeer(e,t){const r=new s(o.createFromBytes(e.id));e.addrs.forEach((e=>r.multiaddrs.add(e))),this.swarm.dial(r,m.relay,c(((e,r)=>{if(e)return g.err(e),t(e);t(null,r)})))}}}}},{package:"3box>ipfs>libp2p>libp2p-switch>libp2p-circuit"}],[4842,{"../protocol":4848,"./utils":4844,"async/series":1877,"async/setImmediate":1878,debug:2304,events:2133,"interface-connection":4455,"peer-info":5421},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("async/setImmediate"),i=e("events").EventEmitter,s=e("interface-connection").Connection,o=e("./utils"),a=e("peer-info"),c=e("../protocol").CircuitRelay,u=e("async/series"),l=e("debug"),h=l("libp2p:circuit:stop");h.err=l("libp2p:circuit:error:stop");t.exports=class extends i{constructor(e){super(),this.swarm=e,this.utils=o(e)}handle(e,t,r){r=r||(()=>{}),u([r=>this.utils.validateAddrs(e,t,c.Type.STOP,r),e=>this.utils.writeResponse(t,c.Status.Success,e)],(i=>{if(i)return r(),h(i);const o=new a(this.utils.peerIdFromId(e.srcPeer.id));e.srcPeer.addrs.forEach((e=>o.multiaddrs.add(e)));const c=new s(t.rest());c.setPeerInfo(o),n((()=>this.emit("connection",c))),r(c)}))}}}}},{package:"3box>ipfs>libp2p>libp2p-switch>libp2p-circuit"}],[4843,{debug:2304,"pull-handshake":5466,"pull-length-prefixed":5469,"pull-stream/pull":5488,"pull-stream/sinks/collect":5489,"pull-stream/sources/empty":5498,"pull-stream/sources/values":5504},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("pull-stream/sources/values"),i=e("pull-stream/sinks/collect"),s=e("pull-stream/sources/empty"),o=e("pull-stream/pull"),a=e("pull-length-prefixed"),c=e("pull-handshake"),u=e("debug"),l=u("libp2p:circuit:stream-handler");l.err=u("libp2p:circuit:error:stream-handler");t.exports=class{constructor(e,t,r,n){this.conn=e,this.stream=null,this.shake=null,this.timeout=t||6e4,this.maxLength=n||4096,"function"==typeof t&&(this.timeout=r||6e4),this.stream=c({timeout:this.timeout},t),this.shake=this.stream.handshake,o(this.stream,e,this.stream)}isValid(){return this.conn&&this.shake&&this.stream}read(e){if(!this.isValid())return e(new Error("handler is not in a valid state"));a.decodeFromReader(this.shake,{maxLength:this.maxLength},((t,r)=>t?(l.err(t),e(t)):e(null,r)))}write(e,t){if(t=t||(()=>{}),!this.isValid())return t(new Error("handler is not in a valid state"));o(n([e]),a.encode(),i(((e,r)=>{if(e)return l.err(e),this.shake.abort(e),t(e);r.forEach((e=>this.shake.write(e))),t()})))}getRawConn(){return this.conn}rest(){const e=this.shake.rest();return this.conn=null,this.stream=null,this.shake=null,e}close(){this.isValid()&&o(s(),this.rest())}}}}},{package:"3box>ipfs>libp2p>libp2p-switch>libp2p-circuit"}],[4844,{"../protocol":4848,multiaddr:5224,"peer-id":5420,"peer-info":5421},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("multiaddr"),i=e("peer-info"),s=e("peer-id"),o=e("../protocol");t.exports=function(e){function t(e,t,r){return r=r||(()=>{}),e.write(o.CircuitRelay.encode({type:o.CircuitRelay.Type.STATUS,code:t})),r()}return{getB58String:function(e){let t=null;if(n.isMultiaddr(e)){t=n(e).getPeerId()}else i.isPeerInfo(e)&&(t=e.id.toB58String());return t},peerInfoFromMa:function(t){let r;if(i.isPeerInfo(t))r=t;else if(n.isMultiaddr(t)){const n=t.getPeerId();try{r=e._peerBook.get(n)}catch(e){r=new i(s.createFromB58String(n))}r.multiaddrs.add(t)}else if(s.isPeerId(t)){const n=t.toB58String();r=e._peerBook.has(n)?e._peerBook.get(n):t}return r},isPeerConnected:function(t){return e.muxedConns[t]||e.conns[t]},validateAddrs:function(e,r,i,s){try{e.dstPeer.addrs.forEach((e=>n(e)))}catch(e){return t(r,i===o.CircuitRelay.Type.HOP?o.CircuitRelay.Status.HOP_DST_MULTIADDR_INVALID:o.CircuitRelay.Status.STOP_DST_MULTIADDR_INVALID),s(e)}try{e.srcPeer.addrs.forEach((e=>n(e)))}catch(e){return t(r,i===o.CircuitRelay.Type.HOP?o.CircuitRelay.Status.HOP_SRC_MULTIADDR_INVALID:o.CircuitRelay.Status.STOP_SRC_MULTIADDR_INVALID),s(e)}return s(null)},writeResponse:t,peerIdFromId:function(e){return"string"==typeof e?s.createFromB58String(e):s.createFromBytes(e)}}}}}},{package:"3box>ipfs>libp2p>libp2p-switch>libp2p-circuit"}],[4845,{"./circuit":4839},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e("./circuit")}}},{package:"3box>ipfs>libp2p>libp2p-switch>libp2p-circuit"}],[4846,{"./circuit/hop":4841,"./circuit/stop":4842,"./circuit/stream-handler":4843,"./circuit/utils":4844,"./multicodec":4847,"./protocol":4848,"async/setImmediate":1878,debug:2304,events:2133,mafmt:5206,multiaddr:5224},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("async/setImmediate"),i=e("./multicodec"),s=e("events").EventEmitter,o=e("multiaddr"),a=e("mafmt"),c=e("./circuit/stop"),u=e("./circuit/hop"),l=e("./protocol"),h=e("./circuit/utils"),f=e("./circuit/stream-handler"),p=e("debug"),d=p("libp2p:circuit:listener");d.err=p("libp2p:circuit:error:listener"),t.exports=(e,t,r)=>{const p=new s,b=h(e);return p.stopHandler=new c(e),p.stopHandler.on("connection",(e=>p.emit("connection",e))),p.hopHandler=new u(e,t.hop),p.listen=(t,s)=>{s=s||(()=>{}),e.handle(i.relay,((e,t)=>{const n=new f(t);n.read(((e,t)=>{if(e)return void d.err(e);let i=null;try{i=l.CircuitRelay.decode(t)}catch(e){return b.writeResponse(n,l.CircuitRelay.Status.MALFORMED_MESSAGE)}switch(i.type){case l.CircuitRelay.Type.CAN_HOP:case l.CircuitRelay.Type.HOP:return p.hopHandler.handle(i,n);case l.CircuitRelay.Type.STOP:return p.stopHandler.handle(i,n,r);default:return b.writeResponse(n,l.CircuitRelay.Status.INVALID_MSG_TYPE),n.close()}}))})),n((()=>p.emit("listen"))),s()},p.close=t=>{e.unhandle(i.relay),n((()=>p.emit("close"))),t()},p.getAddrs=t=>{let r=e._peerInfo.multiaddrs.toArray(),n=r.filter((t=>a.Circuit.matches(t)&&!t.toString().includes(e._peerInfo.id.toB58String())));n.length&&(r=n);let i=[];r.forEach((t=>{const r=`/p2p-circuit/ipfs/${e._peerInfo.id.toB58String()}`;if(t.toString()!==r)if(a.Circuit.matches(t))i.push(t.encapsulate(`/ipfs/${e._peerInfo.id.toB58String()}`));else if(t.getPeerId())i.push(o("/p2p-circuit").encapsulate(t));else{const r=`${t}/ipfs/${e._peerInfo.id.toB58String()}`;i.push(o("/p2p-circuit").encapsulate(r))}else i.push(o(r))})),t(null,i)},p}}}},{package:"3box>ipfs>libp2p>libp2p-switch>libp2p-circuit"}],[4847,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={relay:"/libp2p/circuit/relay/0.1.0"}}}},{package:"3box>ipfs>libp2p>libp2p-switch>libp2p-circuit"}],[4848,{protons:5450},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("protons");t.exports=n("\nmessage CircuitRelay {\n\n  enum Status {\n    SUCCESS                    = 100;\n    HOP_SRC_ADDR_TOO_LONG      = 220;\n    HOP_DST_ADDR_TOO_LONG      = 221;\n    HOP_SRC_MULTIADDR_INVALID  = 250;\n    HOP_DST_MULTIADDR_INVALID  = 251;\n    HOP_NO_CONN_TO_DST         = 260;\n    HOP_CANT_DIAL_DST          = 261;\n    HOP_CANT_OPEN_DST_STREAM   = 262;\n    HOP_CANT_SPEAK_RELAY       = 270;\n    HOP_CANT_RELAY_TO_SELF     = 280;\n    STOP_SRC_ADDR_TOO_LONG     = 320;\n    STOP_DST_ADDR_TOO_LONG     = 321;\n    STOP_SRC_MULTIADDR_INVALID = 350;\n    STOP_DST_MULTIADDR_INVALID = 351;\n    STOP_RELAY_REFUSED         = 390;\n    MALFORMED_MESSAGE          = 400;\n  }\n\n  enum Type { // RPC identifier, either HOP, STOP or STATUS\n    HOP = 1;\n    STOP = 2;\n    STATUS = 3;\n    CAN_HOP = 4;\n  }\n\n  message Peer {\n    required bytes id = 1;    // peer id\n    repeated bytes addrs = 2; // peer's known addresses\n  }\n\n  optional Type type = 1;     // Type of the message\n\n  optional Peer srcPeer = 2;  // srcPeer and dstPeer are used when Type is HOP or STATUS\n  optional Peer dstPeer = 3;\n\n  optional Status code = 4;   // Status code, used when Type is STATUS\n}\n")}}},{package:"3box>ipfs>libp2p>libp2p-switch>libp2p-circuit"}],[4849,{debug:2304,events:2133,"latency-monitor":4806},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("events"),i=e("latency-monitor").default,s=e("debug")("libp2p:connection-manager"),o={maxPeers:Infinity,minPeers:0,maxData:Infinity,maxSentData:Infinity,maxReceivedData:Infinity,maxEventLoopDelay:Infinity,pollInterval:2e3,movingAverageInterval:6e4,defaultPeerValue:1};function a(e,t){return e[1]-t[1]}function c(e){return e.name.toLowerCase()}t.exports=class extends n{constructor(e,t){if(super(),this._libp2p=e,this._options=Object.assign({},o,t),this._options.maxPeersPerProtocol=function(e){e||(e={});return Object.keys(e).forEach((t=>{const r=e[t];delete e[t],e[t.toLowerCase()]=r})),e}(this._options.maxPeersPerProtocol),s("options: %j",this._options),this._stats=e.stats,t&&!this._stats)throw new Error("No libp2p.stats");this._peerValues=new Map,this._peers=new Map,this._peerProtocols=new Map,this._peerCountPerProtocol=new Map,this._onStatsUpdate=this._onStatsUpdate.bind(this),this._onPeerConnect=this._onPeerConnect.bind(this),this._onPeerDisconnect=this._onPeerDisconnect.bind(this),this._libp2p.isStarted()?this._onceStarted():this._libp2p.once("start",this._onceStarted.bind(this))}start(){this._stats.on("update",this._onStatsUpdate),this._libp2p.on("connection:start",this._onPeerConnect),this._libp2p.on("connection:end",this._onPeerDisconnect),this._latencyMonitor=new i({dataEmitIntervalMs:this._options.pollInterval}),this._onLatencyMeasure=this._onLatencyMeasure.bind(this),this._latencyMonitor.on("data",this._onLatencyMeasure)}stop(){this._stats.removeListener("update",this._onStatsUpdate),this._libp2p.removeListener("connection:start",this._onPeerConnect),this._libp2p.removeListener("connection:end",this._onPeerDisconnect),this._latencyMonitor.removeListener("data",this._onLatencyMeasure)}setPeerValue(e,t){if(t<0||t>1)throw new Error("value should be a number between 0 and 1");e.toB58String&&(e=e.toB58String()),this._peerValues.set(e,t)}_onceStarted(){this._peerId=this._libp2p.peerInfo.id.toB58String()}_onStatsUpdate(){const e=this._stats.global.movingAverages,t=e.dataReceived[this._options.movingAverageInterval].movingAverage();this._checkLimit("maxReceivedData",t);const r=e.dataSent[this._options.movingAverageInterval].movingAverage();this._checkLimit("maxSentData",r);const n=t+r;this._checkLimit("maxData",n),s("stats update",n)}_onPeerConnect(e){const t=e.id.toB58String();s("%s: connected to %s",this._peerId,t),this._peerValues.set(t,this._options.defaultPeerValue),this._peers.set(t,e),this.emit("connected",t),this._checkLimit("maxPeers",this._peers.size),function(e){const t=new Set;return e.multiaddrs.forEach((e=>{e.protos().map(c).forEach((e=>{t.add(e)}))})),Array.from(t)}(e).forEach((e=>{this._peerCountPerProtocol[e]||(this._peerCountPerProtocol[e]=0),this._peerCountPerProtocol[e]++;let r=this._peerProtocols[t];r||(r=this._peerProtocols[t]=new Set),r.add(e),this._checkProtocolMaxPeersLimit(e,this._peerCountPerProtocol[e])}))}_onPeerDisconnect(e){const t=e.id.toB58String();s("%s: disconnected from %s",this._peerId,t),this._peerValues.delete(t),this._peers.delete(t);const r=this._peerProtocols[t];r&&Array.from(r).forEach((e=>{this._peerCountPerProtocol[e]&&this._peerCountPerProtocol[e]--})),this.emit("disconnected",t)}_onLatencyMeasure(e){this._checkLimit("maxEventLoopDelay",e.avgMs)}_checkLimit(e,t){const r=this._options[e];s("checking limit of %s. current value: %d of %d",e,t,r),t>r&&(s("%s: limit exceeded: %s, %d",this._peerId,e,t),this.emit("limit:exceeded",e,t),this._maybeDisconnectOne())}_checkProtocolMaxPeersLimit(e,t){s("checking protocol limit. current value of %s is %d",e,t);t>this._options.maxPeersPerProtocol[e]&&(s("%s: protocol max peers limit exceeded: %s, %d",this._peerId,e,t),this.emit("limit:exceeded",e,t),this._maybeDisconnectOne())}_maybeDisconnectOne(){if(this._options.minPeers<this._peerValues.size){const e=Array.from(this._peerValues).sort(a);s("%s: sorted peer values: %j",this._peerId,e);const t=e[0];if(t){const e=t[0];s("%s: lowest value peer is %s",this._peerId,e),s("%s: forcing disconnection from %j",this._peerId,e),this._disconnectPeer(e)}}}_disconnectPeer(e){s("preemptively disconnecting peer",e),this.emit("%s: disconnect:preemptive",this._peerId,e);const t=this._peers.get(e);this._libp2p.hangUp(t,(e=>{e&&this.emit("error",e)}))}}}}},{package:"3box>ipfs>libp2p>libp2p-connection-manager"}],[4850,{"./utils":4854,blakejs:2085,buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("blakejs"),i=e("./utils").toCallback,s={init:n.blake2bInit,update:n.blake2bUpdate,digest:n.blake2bFinal},o={init:n.blake2sInit,update:n.blake2sUpdate,digest:n.blake2sFinal},a=(e,t)=>i((n=>{const i=t.init(e,null);return t.update(i,n),r.from(t.digest(i))}));t.exports=e=>{for(let t=0;t<64;t++)e[45569+t]=a(t+1,s);for(let t=0;t<32;t++)e[45633+t]=a(t+1,o)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-crypto>libp2p-crypto-secp256k1>multihashing-async"}],[4851,{buffer:2132,nodeify:5310},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("nodeify"),i=function(){if(self.crypto)return self.crypto.subtle||self.crypto.webkitSubtle;if(self.msCrypto)return self.msCrypto.subtle}();function s(e){if(!i)throw new Error("Please use a browser with webcrypto support and ensure the code has been delivered securely via HTTPS/TLS and run within a Secure Context");return(t,s)=>{const o=i.digest({name:e},t);if("function"!=typeof o.then)return o.onerror=()=>{s(new Error(`hashing data using ${e}`))},void(o.oncomplete=e=>{s(null,e.target.result)});n(o.then((e=>r.from(new Uint8Array(e)))),s)}}t.exports={sha1:function(e,t){s("SHA-1")(e,t)},sha2256:function(e,t){s("SHA-256")(e,t)},sha2512:function(e,t){s("SHA-512")(e,t)}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-crypto>libp2p-crypto-secp256k1>multihashing-async"}],[4852,{"./blake":4850,"./crypto-sha1-2":4851,"./utils":4854,buffer:2132,"js-sha3":4767,murmurhash3js:5270},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("js-sha3"),i=e("murmurhash3js"),s=e("./utils"),o=e("./crypto-sha1-2"),a=s.toCallback,c=s.toBuf,u=s.fromString,l=s.fromNumberTo32BitBuf;t.exports={sha1:o.sha1,sha2256:o.sha2256,sha2512:o.sha2512,sha3512:a(c(n.sha3_512)),sha3384:a(c(n.sha3_384)),sha3256:a(c(n.sha3_256)),sha3224:a(c(n.sha3_224)),shake128:a(c(n.shake_128,128)),shake256:a(c(n.shake_256,256)),keccak224:a(c(n.keccak_224)),keccak256:a(c(n.keccak_256)),keccak384:a(c(n.keccak_384)),keccak512:a(c(n.keccak_512)),murmur3128:a(c(u(i.x64.hash128))),murmur332:a(l(u(i.x86.hash32))),addBlake:e("./blake"),dblSha2256:(e,t)=>{o.sha2256(e,((e,n)=>{e&&t(e),o.sha2256(r.from(n),t)}))}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-crypto>libp2p-crypto-secp256k1>multihashing-async"}],[4853,{"./crypto":4852,buffer:2132,multihashes:5250},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("multihashes"),i=e("./crypto");function s(e,t,r,i){if("function"==typeof r&&(i=r,r=undefined),!i)throw new Error("Missing callback");s.digest(e,t,r,((e,s)=>{if(e)return i(e);i(null,n.encode(s,t,r))}))}t.exports=s,s.Buffer=r,s.multihash=n,s.digest=function(e,t,r,n){if("function"==typeof r&&(n=r,r=undefined),!n)throw new Error("Missing callback");let i,o=n;r&&(o=(e,t)=>{if(e)return n(e);n(null,t.slice(0,r))});try{i=s.createHash(t)}catch(e){return o(e)}i(e,o)},s.createHash=function(e){if(e=n.coerceCode(e),!s.functions[e])throw new Error("multihash function "+e+" not yet supported");return s.functions[e]},s.functions={17:i.sha1,18:i.sha2256,19:i.sha2512,20:i.sha3512,21:i.sha3384,22:i.sha3256,23:i.sha3224,24:i.shake128,25:i.shake256,26:i.keccak224,27:i.keccak256,28:i.keccak384,29:i.keccak512,34:i.murmur3128,35:i.murmur332,86:i.dblSha2256},i.addBlake(s.functions),s.validate=(e,t,i)=>{s(e,n.decode(t).name,((e,n)=>{if(e)return i(e);i(e,0===r.compare(t,n))}))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-crypto>libp2p-crypto-secp256k1>multihashing-async"}],[4854,{_process:5430,buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e,t){(function(){r.toCallback=t=>function(r,n){let i;try{i=t(r)}catch(t){return void e.nextTick(n,t)}e.nextTick(n,null,i)},r.toBuf=(e,r)=>n=>{let i=e(n,r);return t.from(i,"hex")},r.fromString=(e,r)=>n=>{const i=t.isBuffer(n)?n.toString():n;return e(i,r)},r.fromNumberTo32BitBuf=(e,r)=>n=>{let i=e(n,r);const s=new Array(4);for(let e=0;e<4;e++)s[e]=255&i,i>>=8;return t.from(s)}}).call(this)}).call(this,e("_process"),e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-crypto>libp2p-crypto-secp256k1>multihashing-async"}],[4855,{"async/setImmediate":1878,"multihashing-async":4853,secp256k1:5760},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("secp256k1"),i=e("multihashing-async"),s=e("async/setImmediate"),o="sha2-256";t.exports=e=>{function t(e){if(!n.privateKeyVerify(e))throw new Error("Invalid private key")}return{generateKey:function(t){let r;do{r=e(32)}while(!n.privateKeyVerify(r));var i,o;i=null,o=r,s((()=>t(i,o)))},privateKeyLength:32,hashAndSign:function(e,t,r){const a=(e,t)=>s((()=>r(e,t)));i.digest(t,o,((t,r)=>{if(t)return a(t);try{const t=n.sign(r,e),i=n.signatureExport(t.signature);return a(null,i)}catch(t){a(t)}}))},hashAndVerify:function(e,t,r,a){const c=(e,t)=>s((()=>a(e,t)));i.digest(r,o,((r,i)=>{if(r)return c(r);try{t=n.signatureImport(t);const r=n.verify(i,t,e);return c(null,r)}catch(r){c(r)}}))},compressPublicKey:function(e){if(!n.publicKeyVerify(e))throw new Error("Invalid public key");return n.publicKeyConvert(e,!0)},decompressPublicKey:function(e){return n.publicKeyConvert(e,!1)},validatePrivateKey:t,validatePublicKey:function(e){if(!n.publicKeyVerify(e))throw new Error("Invalid public key")},computePublicKey:function(e){return t(e),n.publicKeyCreate(e)}}}}}},{package:"3box>ipfs>libp2p-crypto>libp2p-crypto-secp256k1"}],[4856,{"./crypto":4855,bs58:2139,"multihashing-async":4853},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("bs58"),i=e("multihashing-async");t.exports=(t,r,s)=>{s=s||e("./crypto")(r);class o{constructor(e){s.validatePublicKey(e),this._key=e}verify(e,t,r){c(r),s.hashAndVerify(this._key,t,e,r)}marshal(){return s.compressPublicKey(this._key)}get bytes(){return t.PublicKey.encode({Type:t.KeyType.Secp256k1,Data:this.marshal()})}equals(e){return this.bytes.equals(e.bytes)}hash(e){c(e),i(this.bytes,"sha2-256",e)}}class a{constructor(e,t){this._key=e,this._publicKey=t||s.computePublicKey(e),s.validatePrivateKey(this._key),s.validatePublicKey(this._publicKey)}sign(e,t){c(t),s.hashAndSign(this._key,e,t)}get public(){return new o(this._publicKey)}marshal(){return this._key}get bytes(){return t.PrivateKey.encode({Type:t.KeyType.Secp256k1,Data:this.marshal()})}equals(e){return this.bytes.equals(e.bytes)}hash(e){c(e),i(this.bytes,"sha2-256",e)}id(e){this.public.hash(((t,r)=>{if(t)return e(t);e(null,n.encode(r))}))}}function c(e){if("function"!=typeof e)throw new Error("callback is required")}return{Secp256k1PublicKey:o,Secp256k1PrivateKey:a,unmarshalSecp256k1PrivateKey:function(e,t){t(null,new a(e))},unmarshalSecp256k1PublicKey:function(e){return new o(e)},generateKeyPair:function(e,t){t===undefined&&"function"==typeof e&&(t=e),c(t),s.generateKey(((e,r)=>{if(e)return t(e);let n;try{n=new a(r)}catch(e){return t(e)}t(null,n)}))}}}}}},{package:"3box>ipfs>libp2p-crypto>libp2p-crypto-secp256k1"}],[4857,{"./utils":4861,blakejs:2085,buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("blakejs"),i=e("./utils").toCallback,s={init:n.blake2bInit,update:n.blake2bUpdate,digest:n.blake2bFinal},o={init:n.blake2sInit,update:n.blake2sUpdate,digest:n.blake2sFinal},a=(e,t)=>i((n=>{const i=t.init(e,null);return t.update(i,n),r.from(t.digest(i))}));t.exports=e=>{for(let t=0;t<64;t++)e[45569+t]=a(t+1,s);for(let t=0;t<32;t++)e[45633+t]=a(t+1,o)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-crypto>multihashing-async"}],[4858,{buffer:2132,nodeify:5310},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("nodeify"),i=function(){if(self.crypto)return self.crypto.subtle||self.crypto.webkitSubtle;if(self.msCrypto)return self.msCrypto.subtle}();function s(e){if(!i)throw new Error("Please use a browser with webcrypto support and ensure the code has been delivered securely via HTTPS/TLS and run within a Secure Context");return(t,s)=>{const o=i.digest({name:e},t);if("function"!=typeof o.then)return o.onerror=()=>{s(new Error(`hashing data using ${e}`))},void(o.oncomplete=e=>{s(null,e.target.result)});n(o.then((e=>r.from(new Uint8Array(e)))),s)}}t.exports={sha1:function(e,t){s("SHA-1")(e,t)},sha2256:function(e,t){s("SHA-256")(e,t)},sha2512:function(e,t){s("SHA-512")(e,t)}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-crypto>multihashing-async"}],[4859,{"./blake":4857,"./crypto-sha1-2":4858,"./utils":4861,buffer:2132,"js-sha3":4767,murmurhash3js:5270},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("js-sha3"),i=e("murmurhash3js"),s=e("./utils"),o=e("./crypto-sha1-2"),a=s.toCallback,c=s.toBuf,u=s.fromString,l=s.fromNumberTo32BitBuf;t.exports={sha1:o.sha1,sha2256:o.sha2256,sha2512:o.sha2512,sha3512:a(c(n.sha3_512)),sha3384:a(c(n.sha3_384)),sha3256:a(c(n.sha3_256)),sha3224:a(c(n.sha3_224)),shake128:a(c(n.shake_128,128)),shake256:a(c(n.shake_256,256)),keccak224:a(c(n.keccak_224)),keccak256:a(c(n.keccak_256)),keccak384:a(c(n.keccak_384)),keccak512:a(c(n.keccak_512)),murmur3128:a(c(u(i.x64.hash128))),murmur332:a(l(u(i.x86.hash32))),addBlake:e("./blake"),dblSha2256:(e,t)=>{o.sha2256(e,((e,n)=>{e&&t(e),o.sha2256(r.from(n),t)}))}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-crypto>multihashing-async"}],[4860,{"./crypto":4859,buffer:2132,multihashes:5250},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("multihashes"),i=e("./crypto");function s(e,t,r,i){if("function"==typeof r&&(i=r,r=undefined),!i)throw new Error("Missing callback");s.digest(e,t,r,((e,s)=>{if(e)return i(e);i(null,n.encode(s,t,r))}))}t.exports=s,s.Buffer=r,s.multihash=n,s.digest=function(e,t,r,n){if("function"==typeof r&&(n=r,r=undefined),!n)throw new Error("Missing callback");let i,o=n;r&&(o=(e,t)=>{if(e)return n(e);n(null,t.slice(0,r))});try{i=s.createHash(t)}catch(e){return o(e)}i(e,o)},s.createHash=function(e){if(e=n.coerceCode(e),!s.functions[e])throw new Error("multihash function "+e+" not yet supported");return s.functions[e]},s.functions={17:i.sha1,18:i.sha2256,19:i.sha2512,20:i.sha3512,21:i.sha3384,22:i.sha3256,23:i.sha3224,24:i.shake128,25:i.shake256,26:i.keccak224,27:i.keccak256,28:i.keccak384,29:i.keccak512,34:i.murmur3128,35:i.murmur332,86:i.dblSha2256},i.addBlake(s.functions)}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-crypto>multihashing-async"}],[4861,{_process:5430,buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e,t){(function(){r.toCallback=t=>function(r,n){let i;try{i=t(r)}catch(t){return void e.nextTick(n,t)}e.nextTick(n,null,i)},r.toBuf=(e,r)=>n=>{let i=e(n,r);return t.from(i,"hex")},r.fromString=(e,r)=>n=>{const i=t.isBuffer(n)?n.toString():n;return e(i,r)},r.fromNumberTo32BitBuf=(e,r)=>n=>{let i=e(n,r);const s=new Array(4);for(let e=0;e<4;e++)s[e]=255&i,i>>=8;return t.from(s)}}).call(this)}).call(this,e("_process"),e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-crypto>multihashing-async"}],[4862,{"browserify-aes":2104},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("browserify-aes");t.exports={createCipheriv:n.createCipheriv,createDecipheriv:n.createDecipheriv}}}},{package:"3box>ipfs>libp2p-crypto"}],[4863,{"./ciphers":4862},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("./ciphers"),i={16:"aes-128-ctr",32:"aes-256-ctr"};r.create=function(e,t,r){const s=i[e.length];if(!s)return r(new Error("Invalid key length"));const o=n.createCipheriv(s,e,t),a=n.createDecipheriv(s,e,t);r(null,{encrypt(e,t){t(null,o.update(e))},decrypt(e,t){t(null,a.update(e))}})}}}},{package:"3box>ipfs>libp2p-crypto"}],[4864,{"../nodeify":4877,"../webcrypto":4881,"./lengths":4865,buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){const n=e("../nodeify"),i=e("../webcrypto"),s=e("./lengths"),o={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"};r.create=function(e,r,a){const c=o[e];n(i.subtle.importKey("raw",r,{name:"HMAC",hash:{name:c}},!1,["sign"]).then((r=>({digest(e,s){((e,r,s)=>{n(i.subtle.sign({name:"HMAC"},e,r).then((e=>t.from(e))),s)})(r,e,s)},length:s[e]}))),a)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-crypto"}],[4865,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={SHA1:20,SHA256:32,SHA512:64}}}},{package:"3box>ipfs>libp2p-crypto"}],[4866,{"./aes":4863,"./hmac":4864,"./keys":4871,"./pbkdf2":4878,"./random-bytes":4879},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("./hmac"),i=e("./aes"),s=e("./keys");(r=t.exports).aes=i,r.hmac=n,r.keys=s,r.randomBytes=e("./random-bytes"),r.pbkdf2=e("./pbkdf2")}}},{package:"3box>ipfs>libp2p-crypto"}],[4867,{"../nodeify":4877,"../util":4880,"../webcrypto":4881,"asn1.js":1790,buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){const n=e("../webcrypto"),i=e("../nodeify"),s=e("asn1.js").bignum,o=e("../util"),a=o.toBase64,c=o.toBn,u={"P-256":256,"P-384":384,"P-521":521};r.generateEphmeralKeyPair=function(e,r){i(n.subtle.generateKey({name:"ECDH",namedCurve:e},!0,["deriveBits"]).then((r=>{const o=(o,c,l)=>{let h;"function"==typeof c&&(l=c,c=undefined),h=c?n.subtle.importKey("jwk",function(e,t){const r=f(e,t.public);return r.d=a(new s(t.private)),r}(e,c),{name:"ECDH",namedCurve:e},!1,["deriveBits"]):Promise.resolve(r.privateKey);const p=Promise.all([n.subtle.importKey("jwk",f(e,o),{name:"ECDH",namedCurve:e},!1,[]),h]);i(p.then((t=>n.subtle.deriveBits({name:"ECDH",namedCurve:e,public:t[0]},t[1],u[e]))).then((e=>t.from(e))),l)};return n.subtle.exportKey("jwk",r.publicKey).then((e=>({key:h(e),genSharedKey:o})))})),r)};const l={"P-256":32,"P-384":48,"P-521":66};function h(e){const r=l[e.crv];return t.concat([t.from([4]),c(e.x).toArrayLike(t,"be",r),c(e.y).toArrayLike(t,"be",r)],1+2*r)}function f(e,r){const n=l[e];if(!r.slice(0,1).equals(t.from([4])))throw new Error("Invalid key format");const i=new s(r.slice(1,n+1)),o=new s(r.slice(1+n));return{kty:"EC",crv:e,x:a(i,n),y:a(o,n),ext:!0}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-crypto"}],[4868,{"./ed25519":4869,"./keys.proto":4873,bs58:2139,buffer:2132,"multihashing-async":4860,protons:5450},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("multihashing-async"),i=e("protons"),s=e("bs58"),o=e("./ed25519"),a=i(e("./keys.proto"));class c{constructor(e){this._key=h(e,o.publicKeyLength)}verify(e,t,r){l(r),o.hashAndVerify(this._key,t,e,r)}marshal(){return r.from(this._key)}get bytes(){return a.PublicKey.encode({Type:a.KeyType.Ed25519,Data:this.marshal()})}equals(e){return this.bytes.equals(e.bytes)}hash(e){l(e),n(this.bytes,"sha2-256",e)}}class u{constructor(e,t){this._key=h(e,o.privateKeyLength),this._publicKey=h(t,o.publicKeyLength)}sign(e,t){l(t),o.hashAndSign(this._key,e,t)}get public(){if(!this._publicKey)throw new Error("public key not provided");return new c(this._publicKey)}marshal(){return r.concat([r.from(this._key),r.from(this._publicKey)])}get bytes(){return a.PrivateKey.encode({Type:a.KeyType.Ed25519,Data:this.marshal()})}equals(e){return this.bytes.equals(e.bytes)}hash(e){l(e),n(this.bytes,"sha2-256",e)}id(e){this.public.hash(((t,r)=>{if(t)return e(t);e(null,s.encode(r))}))}}function l(e){if("function"!=typeof e)throw new Error("callback is required")}function h(e,t){if(r.isBuffer(e)&&(e=new Uint8Array(e)),!(e instanceof Uint8Array)||e.length!==t)throw new Error("Key must be a Uint8Array or Buffer of length "+t);return e}t.exports={Ed25519PublicKey:c,Ed25519PrivateKey:u,unmarshalEd25519PrivateKey:function(e,t){try{e=h(e,o.privateKeyLength+o.publicKeyLength)}catch(e){return t(e)}const r=e.slice(0,o.privateKeyLength),n=e.slice(o.privateKeyLength,e.length);t(null,new u(r,n))},unmarshalEd25519PublicKey:function(e){return e=h(e,o.publicKeyLength),new c(e)},generateKeyPair:function(e,t){t===undefined&&"function"==typeof e&&(t=e),o.generateKey(((e,r)=>{if(e)return t(e);let n;try{n=new u(r.secretKey,r.publicKey)}catch(e){return void t(e)}t(null,n)}))},generateKeyPairFromSeed:function(e,t,r){r===undefined&&"function"==typeof t&&(r=t),o.generateKeyFromSeed(e,((e,t)=>{if(e)return r(e);let n;try{n=new u(t.secretKey,t.publicKey)}catch(e){return void r(e)}r(null,n)}))}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-crypto"}],[4869,{"async/nextTick":1872,buffer:2132,tweetnacl:6004},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){const n=e("tweetnacl"),i=e("async/nextTick");r.publicKeyLength=n.sign.publicKeyLength,r.privateKeyLength=n.sign.secretKeyLength,r.generateKey=function(e){i((()=>{let t;try{t=n.sign.keyPair()}catch(t){return e(t)}e(null,t)}))},r.generateKeyFromSeed=function(e,t){i((()=>{let r;try{r=n.sign.keyPair.fromSeed(e)}catch(e){return t(e)}t(null,r)}))},r.hashAndSign=function(e,r,s){i((()=>{s(null,t.from(n.sign.detached(r,e)))}))},r.hashAndVerify=function(e,t,r,s){i((()=>{let i;try{i=n.sign.detached.verify(r,t,e)}catch(e){return s(e)}s(null,i)}))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-crypto"}],[4870,{"./ecdh":4867},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("./ecdh");t.exports=(e,t)=>{n.generateEphmeralKeyPair(e,t)}}}},{package:"3box>ipfs>libp2p-crypto"}],[4871,{"../random-bytes":4879,"./ed25519-class":4868,"./ephemeral-keys":4870,"./key-stretcher":4872,"./keys.proto":4873,"./rsa-class":4875,buffer:2132,"libp2p-crypto-secp256k1":4856,"node-forge/lib/asn1":5280,"node-forge/lib/forge":5285,"node-forge/lib/pbe":5292,"node-forge/lib/rsa":5303,protons:5450},function(){with(this)return function(){"use strict";return function(e,t,r){(function(n){(function(){const i=e("protons")(e("./keys.proto"));e("node-forge/lib/asn1"),e("node-forge/lib/rsa"),e("node-forge/lib/pbe");const s=e("node-forge/lib/forge");r=t.exports;const o={rsa:e("./rsa-class"),ed25519:e("./ed25519-class"),secp256k1:e("libp2p-crypto-secp256k1")(i,e("../random-bytes"))};function a(e){return o[e.toLowerCase()]!==undefined}r.supportedKeys=o,r.keysPBM=i,r.keyStretcher=e("./key-stretcher"),r.generateEphemeralKeyPair=e("./ephemeral-keys"),r.generateKeyPair=(e,t,r)=>{let n=o[e.toLowerCase()];if(!n)return r(new Error("invalid or unsupported key type"));n.generateKeyPair(t,r)},r.generateKeyPairFromSeed=(e,t,r,n)=>{let i=o[e.toLowerCase()];return i?"ed25519"!==e.toLowerCase()?n(new Error("Seed key derivation is unimplemented for RSA or secp256k1")):void i.generateKeyPairFromSeed(t,r,n):n(new Error("invalid or unsupported key type"))},r.unmarshalPublicKey=e=>{const t=i.PublicKey.decode(e),r=t.Data;switch(t.Type){case i.KeyType.RSA:return o.rsa.unmarshalRsaPublicKey(r);case i.KeyType.Ed25519:return o.ed25519.unmarshalEd25519PublicKey(r);case i.KeyType.Secp256k1:if(o.secp256k1)return o.secp256k1.unmarshalSecp256k1PublicKey(r);throw new Error("secp256k1 support requires libp2p-crypto-secp256k1 package");default:throw new Error("invalid or unsupported key type")}},r.marshalPublicKey=(e,t)=>{if(!a(t=(t||"rsa").toLowerCase()))throw new Error("invalid or unsupported key type");return e.bytes},r.unmarshalPrivateKey=(e,t)=>{let r;try{r=i.PrivateKey.decode(e)}catch(e){return t(e)}const n=r.Data;switch(r.Type){case i.KeyType.RSA:return o.rsa.unmarshalRsaPrivateKey(n,t);case i.KeyType.Ed25519:return o.ed25519.unmarshalEd25519PrivateKey(n,t);case i.KeyType.Secp256k1:return o.secp256k1?o.secp256k1.unmarshalSecp256k1PrivateKey(n,t):t(new Error("secp256k1 support requires libp2p-crypto-secp256k1 package"));default:t(new Error("invalid or unsupported key type"))}},r.marshalPrivateKey=(e,t)=>{if(!a(t=(t||"rsa").toLowerCase()))throw new Error("invalid or unsupported key type");return e.bytes},r.import=(e,t,r)=>{try{const i=s.pki.decryptRsaPrivateKey(e,t);if(null===i)throw new Error("Cannot read the key, most likely the password is wrong or not a RSA key");let a=s.asn1.toDer(s.pki.privateKeyToAsn1(i));return a=n.from(a.getBytes(),"binary"),o.rsa.unmarshalRsaPrivateKey(a,r)}catch(e){r(e)}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-crypto"}],[4872,{"../hmac":4864,"async/whilst":1885,buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("async/whilst"),i=e("../hmac"),s={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,cipherKeySize:32}};t.exports=(e,t,o,a)=>{const c=s[e];if(!c)return a(new Error("unkown cipherType passed"));if(!t)return a(new Error("unkown hashType passed"));const u=c.keySize,l=c.ivSize,h=r.from("key expansion"),f=2*(l+u+20);i.create(t,o,((e,t)=>{if(e)return a(e);t.digest(h,((e,i)=>{if(e)return a(e);let s=[],o=0;n((()=>o<f),(function(e){t.digest(r.concat([i,h]),((r,n)=>{if(r)return e(r);let a=n.length;o+a>f&&(a=f-o),s.push(n),o+=a,t.digest(i,((t,r)=>{if(t)return e(t);i=r,e()}))}))}),(function(e){if(e)return a(e);const t=f/2,n=r.concat(s),i=n.slice(0,t),o=n.slice(t,f),c=e=>({iv:e.slice(0,l),cipherKey:e.slice(l,l+u),macKey:e.slice(l+u)});a(null,{k1:c(i),k2:c(o)})}))}))}))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-crypto"}],[4873,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports="enum KeyType {\n  RSA = 0;\n  Ed25519 = 1;\n  Secp256k1 = 2;\n}\nmessage PublicKey {\n  required KeyType Type = 1;\n  required bytes Data = 2;\n}\nmessage PrivateKey {\n  required KeyType Type = 1;\n  required bytes Data = 2;\n}"}}},{package:"3box>ipfs>libp2p-crypto"}],[4874,{"../nodeify":4877,"../random-bytes":4879,"../webcrypto":4881,"./rsa-utils":4876,buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){const n=e("../nodeify"),i=e("../webcrypto"),s=e("../random-bytes");function o(e){return Promise.all([i.subtle.exportKey("jwk",e.privateKey),i.subtle.exportKey("jwk",e.publicKey)])}r.utils=e("./rsa-utils"),r.generateKey=function(e,t){n(i.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(o).then((e=>({privateKey:e[0],publicKey:e[1]}))),t)},r.unmarshalPrivateKey=function(e,t){const r=i.subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]);var s;n(Promise.all([r,(s=e,i.subtle.importKey("jwk",{kty:s.kty,n:s.n,e:s.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"]))]).then((e=>o({privateKey:e[0],publicKey:e[1]}))).then((e=>({privateKey:e[0],publicKey:e[1]}))),t)},r.getRandomValues=s,r.hashAndSign=function(e,r,s){n(i.subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]).then((e=>i.subtle.sign({name:"RSASSA-PKCS1-v1_5"},e,Uint8Array.from(r)))).then((e=>t.from(e))),s)},r.hashAndVerify=function(e,t,r,s){n(i.subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]).then((e=>i.subtle.verify({name:"RSASSA-PKCS1-v1_5"},e,t,r))),s)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-crypto"}],[4875,{"./keys.proto":4873,"./rsa":4874,"async/nextTick":1872,bs58:2139,"multihashing-async":4860,"node-forge/lib/forge":5285,"node-forge/lib/pbe":5292,"node-forge/lib/sha512":5306,protons:5450},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("multihashing-async"),i=e("protons"),s=e("bs58"),o=e("async/nextTick"),a=e("./rsa"),c=i(e("./keys.proto"));e("node-forge/lib/sha512"),e("node-forge/lib/pbe");const u=e("node-forge/lib/forge");class l{constructor(e){this._key=e}verify(e,t,r){f(r),a.hashAndVerify(this._key,t,e,r)}marshal(){return a.utils.jwkToPkix(this._key)}get bytes(){return c.PublicKey.encode({Type:c.KeyType.RSA,Data:this.marshal()})}encrypt(e){return this._key.encrypt(e,"RSAES-PKCS1-V1_5")}equals(e){return this.bytes.equals(e.bytes)}hash(e){f(e),n(this.bytes,"sha2-256",e)}}class h{constructor(e,t){this._key=e,this._publicKey=t}genSecret(){return a.getRandomValues(16)}sign(e,t){f(t),a.hashAndSign(this._key,e,t)}get public(){if(!this._publicKey)throw new Error("public key not provided");return new l(this._publicKey)}decrypt(e,t){a.decrypt(this._key,e,t)}marshal(){return a.utils.jwkToPkcs1(this._key)}get bytes(){return c.PrivateKey.encode({Type:c.KeyType.RSA,Data:this.marshal()})}equals(e){return this.bytes.equals(e.bytes)}hash(e){f(e),n(this.bytes,"sha2-256",e)}id(e){this.public.hash(((t,r)=>{if(t)return e(t);e(null,s.encode(r))}))}export(e,t,r){"function"==typeof t&&(r=t,t=e,e="pkcs-8"),f(r),o((()=>{let n=null,i=null;try{const r=new u.util.ByteBuffer(this.marshal()),s=u.asn1.fromDer(r),o=u.pki.privateKeyFromAsn1(s);if("pkcs-8"===e){const e={algorithm:"aes256",count:1e4,saltSize:16,prfAlgorithm:"sha512"};i=u.pki.encryptRsaPrivateKey(o,t,e)}else n=new Error(`Unknown export format '${e}'`)}catch(e){n=e}r(n,i)}))}}function f(e){if("function"!=typeof e)throw new Error("callback is required")}t.exports={RsaPublicKey:l,RsaPrivateKey:h,unmarshalRsaPublicKey:function(e){const t=a.utils.pkixToJwk(e);return new l(t)},unmarshalRsaPrivateKey:function(e,t){const r=a.utils.pkcs1ToJwk(e);a.unmarshalPrivateKey(r,((e,r)=>{if(e)return t(e);t(null,new h(r.privateKey,r.publicKey))}))},generateKeyPair:function(e,t){a.generateKey(e,((e,r)=>{if(e)return t(e);t(null,new h(r.privateKey,r.publicKey))}))},fromJwk:function(e,t){a.unmarshalPrivateKey(e,((e,r)=>{if(e)return t(e);t(null,new h(r.privateKey,r.publicKey))}))}}}}},{package:"3box>ipfs>libp2p-crypto"}],[4876,{"./../util":4880,"asn1.js":1790},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("asn1.js"),i=e("./../util"),s=i.toBase64,o=i.toBn,a=n.define("RSAPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())})),c=n.define("AlgorithmIdentifier",(function(){this.seq().obj(this.key("algorithm").objid({"1.2.840.113549.1.1.1":"rsa"}),this.key("none").optional().null_(),this.key("curve").optional().objid(),this.key("params").optional().seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()))})),u=n.define("RSAPublicKey",(function(){this.seq().obj(this.key("algorithm").use(c),this.key("subjectPublicKey").bitstr())})),l=n.define("RSAPublicKey",(function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())}));r.pkcs1ToJwk=function(e){const t=a.decode(e,"der");return{kty:"RSA",n:s(t.modulus),e:s(t.publicExponent),d:s(t.privateExponent),p:s(t.prime1),q:s(t.prime2),dp:s(t.exponent1),dq:s(t.exponent2),qi:s(t.coefficient),alg:"RS256",kid:"2011-04-29"}},r.jwkToPkcs1=function(e){return a.encode({version:0,modulus:o(e.n),publicExponent:o(e.e),privateExponent:o(e.d),prime1:o(e.p),prime2:o(e.q),exponent1:o(e.dp),exponent2:o(e.dq),coefficient:o(e.qi)},"der")},r.pkixToJwk=function(e){const t=u.decode(e,"der"),r=l.decode(t.subjectPublicKey.data,"der");return{kty:"RSA",n:s(r.modulus),e:s(r.publicExponent),alg:"RS256",kid:"2011-04-29"}},r.jwkToPkix=function(e){return u.encode({algorithm:{algorithm:"rsa",none:null},subjectPublicKey:{data:l.encode({modulus:o(e.n),publicExponent:o(e.e)},"der")}},"der")}}}},{package:"3box>ipfs>libp2p-crypto"}],[4877,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e,t){return e.then((e=>{t(null,e)}),(e=>{t(e)}))}}}},{package:"3box>ipfs>libp2p-crypto"}],[4878,{"node-forge/lib/pbkdf2":5293,"node-forge/lib/util":5307},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("node-forge/lib/pbkdf2"),i=e("node-forge/lib/util"),s={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};t.exports=function(e,t,r,o,a){const c=s[a];if(!c)throw new Error(`Hash '${a}' is unknown or not supported`);const u=n(e,t,r,o,c);return i.encode64(u)}}}},{package:"3box>ipfs>libp2p-crypto"}],[4879,{"iso-random-stream/src/random":4759},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("iso-random-stream/src/random");t.exports=function(e){if(!e||"number"!=typeof e)throw new Error("first argument must be a Number bigger than 0");return n(e)}}}},{package:"3box>ipfs>libp2p-crypto"}],[4880,{"asn1.js":1790,buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){const n=e("asn1.js").bignum;r.toBase64=function(e,r){return e.toArrayLike(t,"be",r).toString("base64").replace(/(=*)$/,"").replace(/\+/g,"-").replace(/\//g,"_")},r.toBn=function(e){return new n(t.from(e,"base64"))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-crypto"}],[4881,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=self.crypto||self.msCrypto}}},{package:"3box>ipfs>libp2p-crypto"}],[4882,{debug:2304},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("debug"),i=n("libp2p:floodsub");i.err=n("libp2p:floodsub:error"),t.exports={log:i,multicodec:"/floodsub/1.0.0"}}}},{package:"3box>ipfs>libp2p>libp2p-floodsub"}],[4883,{"./config":4882,assert:1805,"async/map":1869,"async/setImmediate":1878,"libp2p-pubsub":4929,"pull-length-prefixed":5469,"pull-stream":5487},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("pull-stream"),i=e("pull-length-prefixed"),s=e("assert"),o=e("libp2p-pubsub"),{message:a,utils:c}=e("libp2p-pubsub"),u=e("./config").multicodec,l=c.ensureArray,h=e("async/setImmediate"),f=e("async/map"),p=()=>{};t.exports=class extends o{constructor(e){super("libp2p:floodsub",u,e),this.subscriptions=new Set}_onDial(e,t,r){super._onDial(e,t,(t=>{if(t)return r(t);const n=e.id.toB58String(),i=this.peers.get(n);i&&i.isWritable&&i.sendSubscriptions(this.subscriptions),h((()=>r()))}))}_processConnection(e,t,r){n(t,i.decode(),n.map((e=>a.rpc.RPC.decode(e))),n.drain((t=>this._onRpc(e,t)),(t=>this._onConnectionEnd(e,r,t))))}_onRpc(e,t){if(!t)return;this.log("rpc from",e);const r=t.subscriptions,n=t.msgs;if(n&&n.length&&this._processRpcMessages(c.normalizeInRpcMessages(t.msgs)),r&&r.length){const t=this.peers.get(e);t&&(t.updateSubscriptions(r),this.emit("floodsub:subscription-change",t.info,t.topics,r))}}_processRpcMessages(e){e.forEach((e=>{const t=c.msgId(e.from,e.seqno);this.seenCache.has(t)||(this.seenCache.put(t),this._emitMessages(e.topicIDs,[e]),this._forwardMessages(e.topicIDs,[e]))}))}_emitMessages(e,t){e.forEach((e=>{this.subscriptions.has(e)&&t.forEach((t=>{this.emit(e,t)}))}))}_forwardMessages(e,t){this.peers.forEach((r=>{r.isWritable&&c.anyMatch(r.topics,e)&&(r.sendMessages(c.normalizeOutRpcMessages(t)),this.log("publish msgs on topics",e,r.info.id.toB58String()))}))}stop(e){super.stop((t=>{if(t)return e(t);this.subscriptions=new Set,e()}))}publish(e,t,r){s(this.started,"FloodSub is not started"),r=r||p,this.log("publish",e,t),e=l(e),t=l(t);const n=this.libp2p.peerInfo.id.toB58String();f(t,((t,r)=>{const i=c.randomSeqno();this.seenCache.put(c.msgId(n,i));const s={from:n,data:t,seqno:i,topicIDs:e};this._emitMessages(e,[s]),this._buildMessage(s,r)}),((t,n)=>{if(t)return r(t);this._forwardMessages(e,n),r(null)}))}subscribe(e){function t(r){if(r&&r.isWritable)return r.sendSubscriptions(e);const n=()=>{r.removeListener("connection",n),t(r)};r.on("connection",n),r.once("close",(()=>r.removeListener("connection",n)))}s(this.started,"FloodSub is not started"),(e=l(e)).forEach((e=>this.subscriptions.add(e))),this.peers.forEach((e=>t(e)))}unsubscribe(e){function t(r){r&&r.isWritable?r.sendUnsubscriptions(e):h(t.bind(r))}this.started&&((e=l(e)).forEach((e=>this.subscriptions.delete(e))),this.peers.forEach((e=>t(e))))}}}}},{package:"3box>ipfs>libp2p>libp2p-floodsub"}],[4884,{"./message":4887,multiaddr:5224,"peer-id":5420,"peer-info":5421,"pull-length-prefixed":5469,"pull-stream/pull":5488,"pull-stream/sinks/collect":5489,"pull-stream/throughs/take":5512},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("peer-info"),i=e("peer-id"),s=e("multiaddr"),o=e("pull-stream/pull"),a=e("pull-stream/throughs/take"),c=e("pull-stream/sinks/collect"),u=e("pull-length-prefixed"),l=e("./message");t.exports=(e,t,r)=>{"function"==typeof t&&(r=t,t=null,console.warn("WARNING: no expected peer info was given, identify will not be able to verify peer integrity")),o(e,u.decode(),a(1),c(((e,o)=>{if(e)return r(e);if(0===o.length)return r(new Error("conn was closed, did not receive data"));const a=l.decode(o[0]);i.createFromPubKey(a.publicKey,((e,i)=>{if(e)return r(e);const o=new n(i);if(t&&t.id.toB58String()!==i.toB58String())return r(new Error("invalid peer"));try{a.listenAddrs.map(s).forEach((e=>o.multiaddrs.add(e)))}catch(e){return r(e)}let c;try{c=function(e){if(!function(e){return e.observedAddr&&e.observedAddr.length>0}(e))return[];let t=e.observedAddr;Array.isArray(t)||(t=[t]);return t.map((e=>s(e)))}(a)}catch(e){return r(e)}o.protocols=new Set(a.protocols),r(null,o,c)}))})))}}}},{package:"3box>ipfs>libp2p>libp2p-switch>libp2p-identify"}],[4885,{"./dialer":4884,"./listener":4886,"./message":4887},function(){with(this)return function(){"use strict";return function(e,t,r){(r=t.exports).multicodec="/ipfs/id/1.0.0",r.listener=e("./listener"),r.dialer=e("./dialer"),r.message=e("./message")}}},{package:"3box>ipfs>libp2p>libp2p-switch>libp2p-identify"}],[4886,{"./message":4887,buffer:2132,"pull-length-prefixed":5469,"pull-stream/pull":5488,"pull-stream/sources/values":5504},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("pull-stream/pull"),i=e("pull-stream/sources/values"),s=e("pull-length-prefixed"),o=e("./message");t.exports=(e,t)=>{e.getObservedAddrs(((a,c)=>{if(a)return;c=c[0];let u=r.alloc(0);t.id.pubKey&&(u=t.id.pubKey.bytes);const l=o.encode({protocolVersion:"ipfs/0.1.0",agentVersion:"na",publicKey:u,listenAddrs:t.multiaddrs.toArray().map((e=>e.buffer)),observedAddr:c?c.buffer:r.from(""),protocols:Array.from(t.protocols)});n(i([l]),s.encode(),e)}))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p>libp2p-switch>libp2p-identify"}],[4887,{protons:5450},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("protons");t.exports=n("\nmessage Identify {\n  // protocolVersion determines compatibility between peers\n  optional string protocolVersion = 5; // e.g. ipfs/1.0.0\n\n  // agentVersion is like a UserAgent string in browsers, or client version in bittorrent\n  // includes the client name and client.\n  optional string agentVersion = 6; // e.g. go-ipfs/0.1.0\n\n  // publicKey is this node's public key (which also gives its node.ID)\n  // - may not need to be sent, as secure channel implies it has been sent.\n  // - then again, if we change / disable secure channel, may still want it.\n  optional bytes publicKey = 1;\n\n  // listenAddrs are the multiaddrs the sender node listens for open connections on\n  repeated bytes listenAddrs = 2;\n\n  // oservedAddr is the multiaddr of the remote endpoint that the sender node perceives\n  // this is useful information to convey to the other side, as it helps the remote endpoint\n  // determine whether its connection to the local peer goes through NAT.\n  optional bytes observedAddr = 4;\n\n  repeated string protocols = 3;\n}\n").Identify}}},{package:"3box>ipfs>libp2p>libp2p-switch>libp2p-identify"}],[4888,{"./utils":4892,blakejs:2085,buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("blakejs"),i=e("./utils").toCallback,s={init:n.blake2bInit,update:n.blake2bUpdate,digest:n.blake2bFinal},o={init:n.blake2sInit,update:n.blake2sUpdate,digest:n.blake2sFinal},a=(e,t)=>i((n=>{const i=t.init(e,null);return t.update(i,n),r.from(t.digest(i))}));t.exports=e=>{for(let t=0;t<64;t++)e[45569+t]=a(t+1,s);for(let t=0;t<32;t++)e[45633+t]=a(t+1,o)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-kad-dht>multihashing-async"}],[4889,{buffer:2132,nodeify:5310},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("nodeify"),i=function(){if(self.crypto)return self.crypto.subtle||self.crypto.webkitSubtle;if(self.msCrypto)return self.msCrypto.subtle}();function s(e){if(!i)throw new Error("Please use a browser with webcrypto support and ensure the code has been delivered securely via HTTPS/TLS and run within a Secure Context");return(t,s)=>{const o=i.digest({name:e},t);if("function"!=typeof o.then)return o.onerror=()=>{s(new Error(`hashing data using ${e}`))},void(o.oncomplete=e=>{s(null,e.target.result)});n(o.then((e=>r.from(new Uint8Array(e)))),s)}}t.exports={sha1:function(e,t){s("SHA-1")(e,t)},sha2256:function(e,t){s("SHA-256")(e,t)},sha2512:function(e,t){s("SHA-512")(e,t)}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-kad-dht>multihashing-async"}],[4890,{"./blake":4888,"./crypto-sha1-2":4889,"./utils":4892,buffer:2132,"js-sha3":4767,murmurhash3js:5270},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("js-sha3"),i=e("murmurhash3js"),s=e("./utils"),o=e("./crypto-sha1-2"),a=s.toCallback,c=s.toBuf,u=s.fromString,l=s.fromNumberTo32BitBuf;t.exports={sha1:o.sha1,sha2256:o.sha2256,sha2512:o.sha2512,sha3512:a(c(n.sha3_512)),sha3384:a(c(n.sha3_384)),sha3256:a(c(n.sha3_256)),sha3224:a(c(n.sha3_224)),shake128:a(c(n.shake_128,128)),shake256:a(c(n.shake_256,256)),keccak224:a(c(n.keccak_224)),keccak256:a(c(n.keccak_256)),keccak384:a(c(n.keccak_384)),keccak512:a(c(n.keccak_512)),murmur3128:a(c(u(i.x64.hash128))),murmur332:a(l(u(i.x86.hash32))),addBlake:e("./blake"),dblSha2256:(e,t)=>{o.sha2256(e,((e,n)=>{e&&t(e),o.sha2256(r.from(n),t)}))}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-kad-dht>multihashing-async"}],[4891,{"./crypto":4890,buffer:2132,multihashes:5250},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("multihashes"),i=e("./crypto");function s(e,t,r,i){if("function"==typeof r&&(i=r,r=undefined),!i)throw new Error("Missing callback");s.digest(e,t,r,((e,s)=>{if(e)return i(e);i(null,n.encode(s,t,r))}))}t.exports=s,s.Buffer=r,s.multihash=n,s.digest=function(e,t,r,n){if("function"==typeof r&&(n=r,r=undefined),!n)throw new Error("Missing callback");let i,o=n;r&&(o=(e,t)=>{if(e)return n(e);n(null,t.slice(0,r))});try{i=s.createHash(t)}catch(e){return o(e)}i(e,o)},s.createHash=function(e){if(e=n.coerceCode(e),!s.functions[e])throw new Error("multihash function "+e+" not yet supported");return s.functions[e]},s.functions={17:i.sha1,18:i.sha2256,19:i.sha2512,20:i.sha3512,21:i.sha3384,22:i.sha3256,23:i.sha3224,24:i.shake128,25:i.shake256,26:i.keccak224,27:i.keccak256,28:i.keccak384,29:i.keccak512,34:i.murmur3128,35:i.murmur332,86:i.dblSha2256},i.addBlake(s.functions)}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-kad-dht>multihashing-async"}],[4892,{_process:5430,buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e,t){(function(){r.toCallback=t=>function(r,n){let i;try{i=t(r)}catch(t){return void e.nextTick(n,t)}e.nextTick(n,null,i)},r.toBuf=(e,r)=>n=>{let i=e(n,r);return t.from(i,"hex")},r.fromString=(e,r)=>n=>{const i=t.isBuffer(n)?n.toString():n;return e(i,r)},r.fromNumberTo32BitBuf=(e,r)=>n=>{let i=e(n,r);const s=new Array(4);for(let e=0;e<4;e++)s[e]=255&i,i>>=8;return t.from(s)}}).call(this)}).call(this,e("_process"),e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-kad-dht>multihashing-async"}],[4893,{},function(){with(this)return function(){"use strict";return function(e,t,r){const n=r.second=1e3,i=r.minute=60*n,s=r.hour=60*i;r.MAX_RECORD_AGE=36*s,r.PROTOCOL_DHT="/ipfs/kad/1.0.0",r.PROVIDERS_KEY_PREFIX="/providers/",r.PROVIDERS_LRU_CACHE_SIZE=256,r.PROVIDERS_VALIDITY=24*s,r.PROVIDERS_CLEANUP_INTERVAL=s,r.READ_MESSAGE_TIMEOUT=10*n,r.GET_MANY_RECORD_COUNT=16,r.K=20,r.ALPHA=3,r.maxMessageSize=2<<22,r.defaultRandomWalk={enabled:!0,queriesPerPeriod:1,interval:5*i,timeout:10*n,delay:10*n}}}},{package:"3box>ipfs>libp2p-kad-dht"}],[4894,{"./constants":4893,"./message":4897,"./network":4898,"./private":4902,"./providers":4903,"./query":4905,"./query-manager":4904,"./random-walk":4909,"./routing":4910,"./utils":4919,assert:1805,"async/each":1838,"async/filter":1845,"async/timeout":1882,"async/waterfall":1884,"err-code":2406,events:2133,"interface-datastore":4460,"libp2p-crypto":4866,"libp2p-record":4941,"peer-id":5420,"peer-info":5421,"promise-to-callback":5432},function(){with(this)return function(){"use strict";return function(e,t,r){const{EventEmitter:n}=e("events"),i=e("libp2p-record"),s=e("interface-datastore").MemoryDatastore,o=e("async/waterfall"),a=e("async/each"),c=e("async/filter"),u=e("async/timeout"),l=e("peer-id"),h=e("peer-info"),f=e("libp2p-crypto"),p=e("promise-to-callback"),d=e("err-code"),b=e("./routing"),m=e("./utils"),g=e("./constants"),y=e("./query"),k=e("./network"),_=e("./private"),E=e("./providers"),S=e("./message"),w=e("./random-walk"),v=e("./query-manager"),x=e("assert");t.exports=class extends n{constructor(e,t){super(),x(e,"libp2p-kad-dht requires a instance of Switch"),(t=t||{}).validators=t.validators||{},t.selectors=t.selectors||{},this.switch=e,this.kBucketSize=t.kBucketSize||g.K,this.concurrency=t.concurrency||g.ALPHA,this.disjointPaths=Math.ceil(this.kBucketSize/2),this.routingTable=new b(this.peerInfo.id,this.kBucketSize),this.datastore=t.datastore||new s,this.providers=new E(this.datastore,this.peerInfo.id),this.validators={pk:i.validator.validators.pk,...t.validators},this.selectors={pk:i.selection.selectors.pk,...t.selectors},this.network=new k(this),this._log=m.logger(this.peerInfo.id);const r=_(this);Object.keys(r).forEach((e=>{this[e]=r[e]})),this.randomWalk=new w(this,t.randomWalk),this._queryManager=new v}get isStarted(){return this._running}start(e){this._running=!0,this._queryManager.start(),this.network.start((t=>{if(t)return e(t);this.randomWalk.start(),e()}))}stop(e){this._running=!1,this.randomWalk.stop(),this.providers.stop(),this._queryManager.stop(),this.network.stop(e)}get peerInfo(){return this.switch._peerInfo}get peerBook(){return this.switch._peerBook}put(e,t,r,n){"function"==typeof r?(n=r,r={}):r=r||{},this._log("PutValue %b",e),o([r=>m.createPutRecord(e,t,r),(t,n)=>o([r=>this._putLocal(e,t,r),t=>this.getClosestPeers(e,{shallow:!0},t),(n,i)=>{r.minPeers=r.minPeers||n.length,c(n,((r,n)=>{this._putValueToPeer(e,t,r,(e=>{if(e)return this._log.error("Failed to put to peer (%b): %s",r.id,e),n(null,!1);n(null,!0)}))}),((e,t)=>{if(e)return i(e);if(r.minPeers>t.length){const e=d(new Error("Failed to put value to enough peers"),"ERR_NOT_ENOUGH_PUT_PEERS");return this._log.error(e),i(e)}i()}))}],n)],n)}get(e,t,r){"function"==typeof t?(r=t,t={}):t=t||{},t.maxTimeout||t.timeout?t.maxTimeout&&!t.timeout&&(t.timeout=t.maxTimeout):t.timeout=g.minute,this._get(e,t,r)}getMany(e,t,r,n){"function"==typeof r?(n=r,r={}):r=r||{},r.maxTimeout||r.timeout?r.maxTimeout&&!r.timeout&&(r.timeout=r.maxTimeout):r.timeout=g.minute,this._log("getMany %b (%s)",e,t);let i=[];this._getLocal(e,((s,a)=>{if(s&&0===t)return n(s);if(null==s&&i.push({val:a.value,from:this.peerInfo.id}),i.length>=t)return n(null,i);const c=[];o([t=>m.convertBuffer(e,t),(n,s)=>{const o=this.routingTable.closestPeers(n,this.kBucketSize);if(this._log("peers in rt: %d",o.length),0===o.length){const e="Failed to lookup key! No peers from routing table!";return this._log.error(e),s(d(new Error(e),"ERR_NO_PEERS_IN_ROUTING_TABLE"))}const a=new y(this,e,((r,n)=>{const s=m.pathSize(t-i.length,n),o=[];return c.push(o),async t=>{let r,n,i;try{const i=await this._getValueOrPeersAsync(t,e);r=i.record,n=i.peers}catch(e){if("ERR_INVALID_RECORD"!==e.code)throw e;i=e}const a={closerPeers:n};return(r&&r.value||i)&&o.push({val:r&&r.value,from:t}),o.length>=s&&(a.pathComplete=!0),a}}));u((e=>{p(a.run(o))(e)}),r.timeout)(((e,t)=>{a.stop(),s(e,t)}))}],(e=>{if(i=[].concat.apply(i,c).slice(0,t),e&&0===i.length)return n(e);n(null,i)}))}))}getClosestPeers(e,t,r){this._log("getClosestPeers to %b",e),"function"==typeof t&&(r=t,t={shallow:!1}),m.convertBuffer(e,((n,i)=>{if(n)return r(n);const s=this.routingTable.closestPeers(i,this.kBucketSize),a=new y(this,e,(()=>async r=>({closerPeers:await this._closerPeersSingleAsync(e,r),pathComplete:!!t.shallow||undefined})));p(a.run(s))(((e,t)=>e?r(e):t&&t.finalSet?void o([e=>m.sortClosestPeers(Array.from(t.finalSet),i,e),(e,t)=>t(null,e.slice(0,this.kBucketSize))],r):r(null,[])))}))}getPublicKey(e,t){let r;if(this._log("getPublicKey %s",e.toB58String()),this.peerBook.has(e)){if(r=this.peerBook.get(e),r&&r.id.pubKey)return this._log("getPublicKey: found local copy"),t(null,r.id.pubKey)}else r=this.peerBook.put(new h(e));this._getPublicKeyFromNode(e,((n,i)=>{if(!n)return r.id=new l(e.id,null,i),this.peerBook.put(r),t(null,i);const s=m.keyForPublicKey(e);this.get(s,((n,i)=>{if(n)return t(n);const s=f.unmarshalPublicKey(i);r.id=new l(e,null,s),this.peerBook.put(r),t(null,s)}))}))}findPeerLocal(e,t){this._log("findPeerLocal %s",e.toB58String()),this.routingTable.find(e,((e,r)=>e?t(e):r&&this.peerBook.has(r)?void t(null,this.peerBook.get(r)):t()))}provide(e,t){this._log("provide: %s",e.toBaseEncodedString());const r=[];o([t=>p(this.providers.addProvider(e,this.peerInfo.id))((e=>t(e))),t=>this.getClosestPeers(e.buffer,t),(t,n)=>{const i=new S(S.TYPES.ADD_PROVIDER,e.buffer,0);i.providerPeers=[this.peerInfo],a(t,((t,n)=>{this._log("putProvider %s to %s",e.toBaseEncodedString(),t.toB58String()),this.network.sendMessage(t,i,(e=>{e&&r.push(e),n()}))}),n)}],(e=>{r.length&&(e=d(`Failed to provide to ${r.length} of ${this.kBucketSize} peers`,"ERR_SOME_PROVIDES_FAILED",{errors:r})),t(e)}))}findProviders(e,t,r){"function"==typeof t?(r=t,t={}):t=t||{},t.maxTimeout||t.timeout?t.maxTimeout&&!t.timeout&&(t.timeout=t.maxTimeout):t.timeout=g.minute,t.maxNumProviders=t.maxNumProviders||g.K,this._log("findProviders %s",e.toBaseEncodedString()),this._findNProviders(e,t.timeout,t.maxNumProviders,r)}findPeer(e,t,r){"function"==typeof t?(r=t,t={}):t=t||{},t.maxTimeout||t.timeout?t.maxTimeout&&!t.timeout&&(t.timeout=t.maxTimeout):t.timeout=g.minute,this._log("findPeer %s",e.toB58String()),this.findPeerLocal(e,((n,i)=>n?r(n):null!=i?(this._log("found local"),r(null,i)):void o([t=>m.convertPeerId(e,t),(r,n)=>{const i=this.routingTable.closestPeers(r,this.kBucketSize);if(0===i.length)return n(d(new Error("Peer lookup failed"),"ERR_LOOKUP_FAILED"));if(i.find((t=>t.isEqual(e)))&&this.peerBook.has(e))return this._log("found in peerbook"),n(null,this.peerBook.get(e));const s=new y(this,e.id,(()=>async t=>{const r=await this._findPeerSingleAsync(t,e),n=r.closerPeers.find((t=>t.id.isEqual(e)));return n?{peer:n,queryComplete:!0}:{closerPeers:r.closerPeers}}));u((e=>{p(s.run(i))(e)}),t.timeout)(((e,t)=>{s.stop(),n(e,t)}))},(t,r)=>{let n=!1;if(t.paths.forEach((e=>{e.success&&(n=!0,this.peerBook.put(e.peer))})),this._log("findPeer %s: %s",e.toB58String(),n),!n)return r(d(new Error("No peer found"),"ERR_NOT_FOUND"));r(null,this.peerBook.get(e))}],r)))}_peerDiscovered(e){this.emit("peer",e)}}}}},{package:"3box>ipfs>libp2p-kad-dht"}],[4895,{"./peer-list":4900},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("./peer-list");t.exports=class extends n{constructor(e){super(),this.limit=e}push(e){return this.length<this.limit&&super.push(e)}}}}},{package:"3box>ipfs>libp2p-kad-dht"}],[4896,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports='// can\'t use, because protocol-buffers doesn\'t support imports\n// so we have to duplicate for now :(\n// import "record.proto";\n\nmessage Record {\n  // adjusted for javascript\n  optional bytes key = 1;\n  optional bytes value = 2;\n  optional bytes author = 3;\n  optional bytes signature = 4;\n  optional string timeReceived = 5;\n}\n\nmessage Message {\n  enum MessageType {\n    PUT_VALUE = 0;\n    GET_VALUE = 1;\n    ADD_PROVIDER = 2;\n    GET_PROVIDERS = 3;\n    FIND_NODE = 4;\n    PING = 5;\n  }\n\n  enum ConnectionType {\n    // sender does not have a connection to peer, and no extra information (default)\n    NOT_CONNECTED = 0;\n\n    // sender has a live connection to peer\n    CONNECTED = 1;\n\n    // sender recently connected to peer\n    CAN_CONNECT = 2;\n\n    // sender recently tried to connect to peer repeatedly but failed to connect\n    // ("try" here is loose, but this should signal "made strong effort, failed")\n    CANNOT_CONNECT = 3;\n  }\n\n  message Peer {\n    // ID of a given peer.\n    optional bytes id = 1;\n\n    // multiaddrs for a given peer\n    repeated bytes addrs = 2;\n\n    // used to signal the sender\'s connection capabilities to the peer\n    optional ConnectionType connection = 3;\n  }\n\n  // defines what type of message it is.\n  optional MessageType type = 1;\n\n  // defines what coral cluster level this query/response belongs to.\n  // in case we want to implement coral\'s cluster rings in the future.\n  optional int32 clusterLevelRaw = 10;\n\n  // Used to specify the key associated with this message.\n  // PUT_VALUE, GET_VALUE, ADD_PROVIDER, GET_PROVIDERS\n  // adjusted for javascript\n  optional bytes key = 2;\n\n  // Used to return a value\n  // PUT_VALUE, GET_VALUE\n  // adjusted Record to bytes for js\n  optional bytes record = 3;\n\n  // Used to return peers closer to a key in a query\n  // GET_VALUE, GET_PROVIDERS, FIND_NODE\n  repeated Peer closerPeers = 8;\n\n  // Used to return Providers\n  // GET_VALUE, ADD_PROVIDER, GET_PROVIDERS\n  repeated Peer providerPeers = 9;\n}'}}},{package:"3box>ipfs>libp2p-kad-dht"}],[4897,{"../../../is-buffer/index.js":4735,"./dht.proto":4896,assert:1805,"libp2p-record":4941,"peer-id":5420,"peer-info":5421,protons:5450},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("assert"),i=e("peer-info"),s=e("peer-id"),o=e("protons"),a=e("libp2p-record").Record,c=o(e("./dht.proto")),u=c.Message.MessageType,l=c.Message.ConnectionType;class h{constructor(e,t,i){t&&n(r.isBuffer(t)),this.type=e,this.key=t,this._clusterLevelRaw=i,this.closerPeers=[],this.providerPeers=[],this.record=null}get clusterLevel(){const e=this._clusterLevelRaw-1;return e<0?0:e}set clusterLevel(e){this._clusterLevelRaw=e}serialize(){const e={key:this.key,type:this.type,clusterLevelRaw:this._clusterLevelRaw,closerPeers:this.closerPeers.map(f),providerPeers:this.providerPeers.map(f)};return this.record&&(r.isBuffer(this.record)?e.record=this.record:e.record=this.record.serialize()),c.Message.encode(e)}static deserialize(e){const t=c.Message.decode(e),r=new h(t.type,t.key,t.clusterLevelRaw);return r.closerPeers=t.closerPeers.map(p),r.providerPeers=t.providerPeers.map(p),t.record&&(r.record=a.deserialize(t.record)),r}}function f(e){const t={id:e.id.id,addrs:e.multiaddrs.toArray().map((e=>e.buffer))};return e.isConnected()?t.connection=l.CONNECTED:t.connection=l.NOT_CONNECTED,t}function p(e){const t=new i(new s(e.id));return e.addrs.forEach((e=>t.multiaddrs.add(e))),t}h.TYPES=u,h.CONNECTION_TYPES=l,t.exports=h}).call(this)}).call(this,{isBuffer:e("../../../is-buffer/index.js")})}}},{package:"3box>ipfs>libp2p-kad-dht"}],[4898,{"./constants":4893,"./message":4897,"./rpc":4918,"./utils":4919,"async/setImmediate":1878,"async/timeout":1882,"err-code":2406,"pull-length-prefixed":5469,"pull-stream":5487},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("pull-stream"),i=e("async/timeout"),s=e("pull-length-prefixed"),o=e("async/setImmediate"),a=e("err-code"),c=e("./rpc"),u=e("./constants"),l=e("./message"),h=e("./utils");function f(e,t,r){n(n.values([t]),s.encode(),e,n.filter((e=>e.length<u.maxMessageSize)),s.decode(),n.collect(((e,t)=>{if(e)return r(e);if(0===t.length)return r(a(new Error("No message received"),"ERR_NO_MESSAGE_RECEIVED"));let n;try{n=l.deserialize(t[0])}catch(e){return r(a(e,"ERR_FAILED_DESERIALIZE_RESPONSE"))}r(null,n)})))}t.exports=class{constructor(e){this.dht=e,this.readMessageTimeout=u.READ_MESSAGE_TIMEOUT,this._log=h.logger(this.dht.peerInfo.id,"net"),this._rpc=c(this.dht),this._onPeerConnected=this._onPeerConnected.bind(this),this._running=!1}start(e){const t=t=>o((()=>e(t)));return this._running?t(a(new Error("Network is already running"),"ERR_NETWORK_ALREADY_RUNNING")):this.dht.isStarted?(this._running=!0,this.dht.switch.handle(u.PROTOCOL_DHT,this._rpc),this.dht.switch.on("peer-mux-established",this._onPeerConnected),void t()):t(a(new Error("Can not start network"),"ERR_CANNOT_START_NETWORK"))}stop(e){const t=t=>o((()=>e(t)));if(!this.dht.isStarted&&!this.isStarted)return t(a(new Error("Network is already stopped"),"ERR_NETWORK_ALREADY_STOPPED"));this._running=!1,this.dht.switch.removeListener("peer-mux-established",this._onPeerConnected),this.dht.switch.unhandle(u.PROTOCOL_DHT),t()}get isStarted(){return this._running}get isConnected(){return this.dht.isStarted&&this.isStarted}_onPeerConnected(e){if(!this.isConnected)return this._log.error("Network is offline");this.dht.switch.dial(e,u.PROTOCOL_DHT,((t,r)=>{if(t)return this._log("%s does not support protocol: %s",e.id.toB58String(),u.PROTOCOL_DHT);n(n.empty(),r),this.dht._add(e,(t=>{if(t)return this._log.error("Failed to add to the routing table",t);this._log("added to the routing table: %s",e.id.toB58String())}))}))}sendRequest(e,t,r){if(!this.isConnected)return r(a(new Error("Network is offline"),"ERR_NETWORK_OFFLINE"));this._log("sending to: %s",e.toB58String()),this.dht.switch.dial(e,u.PROTOCOL_DHT,((e,n)=>{if(e)return r(e);this._writeReadMessage(n,t.serialize(),r)}))}sendMessage(e,t,r){if(!this.isConnected)return o((()=>r(a(new Error("Network is offline"),"ERR_NETWORK_OFFLINE"))));this._log("sending to: %s",e.toB58String()),this.dht.switch.dial(e,u.PROTOCOL_DHT,((e,n)=>{if(e)return r(e);this._writeMessage(n,t.serialize(),r)}))}_writeReadMessage(e,t,r){i(f,this.readMessageTimeout)(e,t,r)}_writeMessage(e,t,r){n(n.values([t]),s.encode(),e,n.onEnd(r))}}}}},{package:"3box>ipfs>libp2p-kad-dht"}],[4899,{"./utils":4919,"async/map":1869,"xor-distance":6172},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("xor-distance"),i=e("./utils"),s=e("async/map");t.exports=class{constructor(e,t){this.originDhtKey=e,this.capacity=t,this.peerDistances=[]}get length(){return this.peerDistances.length}get peers(){return this.peerDistances.map((e=>e.peerId))}add(e,t){if(this.peerDistances.find((t=>t.peerId.id.equals(e.id))))return t();i.convertPeerId(e,((r,i)=>{if(r)return t(r);const s={peerId:e,distance:n(this.originDhtKey,i)};this.peerDistances.push(s),this.peerDistances.sort(((e,t)=>n.compare(e.distance,t.distance))),this.peerDistances=this.peerDistances.slice(0,this.capacity),t()}))}anyCloser(e,t){return e.length?this.length?void s(e,((e,t)=>i.convertPeerId(e,t)),((e,r)=>{if(e)return t(e);const i=this.peerDistances[this.peerDistances.length-1].distance;for(const e of r){const r=n(this.originDhtKey,e);if(n.compare(r,i)<0)return t(null,!0)}return t(null,!1)})):t(null,!0):t(null,!1)}}}}},{package:"3box>ipfs>libp2p-kad-dht"}],[49,{"@babel/runtime/helpers/defineProperty":196,"@babel/runtime/helpers/interopRequireDefault":202,"promise-to-callback":5432,"readable-stream":5710},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){return new c(e,t)};var i=n(e("@babel/runtime/helpers/defineProperty")),s=e("readable-stream"),o=n(e("promise-to-callback"));function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}class c extends s.Writable{constructor(e,t){const r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({objectMode:!0},t);super(r),this._asyncWriteFn=e}_write(e,t,r){(0,o.default)(this._asyncWriteFn(e,t))(r)}}}}},{package:"$root$"}],[4900,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=class{constructor(){this.list=[]}push(e){return!this.has(e)&&(this.list.push(e),!0)}has(e){const t=this.list.find((t=>t.id.isEqual(e.id)));return Boolean(t)}toArray(){return this.list.slice()}pop(){return this.list.pop()}get length(){return this.list.length}}}}},{package:"3box>ipfs>libp2p-kad-dht"}],[4901,{"./utils":4919,debug:2304,heap:4427,"promisify-es6":5434,"xor-distance":6172},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("heap"),i=e("xor-distance"),s=e("debug"),o=e("promisify-es6"),a=e("./utils"),c=s("libp2p:dht:peer-queue");class u{static async fromPeerId(e){const t=await o((t=>a.convertPeerId(e,t)))();return new u(t)}static async fromKey(e){const t=await o((t=>a.convertBuffer(e,t)))();return new u(t)}constructor(e){c("create: %b",e),this.from=e,this.heap=new n(a.xorCompare)}async enqueue(e){c("enqueue %s",e.toB58String());const t=await o((t=>a.convertPeerId(e,t)))(),r={id:e,distance:i(this.from,t)};this.heap.push(r)}dequeue(){const e=this.heap.pop();return c("dequeue %s",e.id.toB58String()),e.id}get length(){return this.heap.size()}}t.exports=u}}},{package:"3box>ipfs>libp2p-kad-dht"}],[4902,{"./constants":4893,"./limited-peer-list":4895,"./message":4897,"./query":4905,"./utils":4919,"async/timeout":1882,"err-code":2406,"libp2p-record":4941,"peer-id":5420,"peer-info":5421,"promise-to-callback":5432,"promisify-es6":5434},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("peer-id"),i=e("libp2p-record"),s=e("async/timeout"),o=e("peer-info"),a=e("promisify-es6"),c=e("promise-to-callback"),u=e("err-code"),l=e("./utils"),h=e("./message"),f=e("./constants"),p=e("./query"),d=e("./limited-peer-list"),b=i.Record;t.exports=e=>({_nearestPeersToQuery(e,t){c(this._nearestPeersToQueryAsync(e))(t)},async _nearestPeersToQueryAsync(t){const r=await a(l.convertBuffer)(t.key);return e.routingTable.closestPeers(r,e.kBucketSize).map((t=>e.peerBook.has(t)?e.peerBook.get(t):e.peerBook.put(new o(t))))},_betterPeersToQuery(e,t,r){c(this._betterPeersToQueryAsync(e,t))(r)},async _betterPeersToQueryAsync(t,r){e._log("betterPeersToQuery");return(await e._nearestPeersToQueryAsync(t)).filter((t=>e._isSelf(t.id)?(e._log.error("trying to return self as closer"),!1):!t.id.isEqual(r.id)))},_checkLocalDatastore(e,t){c(this._checkLocalDatastoreAsync(e))(t)},async _checkLocalDatastoreAsync(t){e._log("checkLocalDatastore: %b",t);const r=l.bufferToKey(t);let n;try{n=await a((t=>e.datastore.get(r,t)))()}catch(e){if("ERR_NOT_FOUND"===e.code)return undefined;throw e}const i=b.deserialize(n);if(!i)throw u("Invalid record","ERR_INVALID_RECORD");return null==i.timeReceived||l.now()-i.timeReceived>f.MAX_RECORD_AGE?(await a((t=>e.datastore.delete(r,t)))(),undefined):i},_add(e,t){c(this._addAsync(e))((e=>t(e)))},_addAsync:async t=>(t=e.peerBook.put(t),await a((r=>e.routingTable.add(t.id,r)))(),undefined),_verifyRecordLocally(e,t){c(this._verifyRecordLocallyAsync(e))((e=>t(e)))},async _verifyRecordLocallyAsync(t){e._log("verifyRecordLocally"),await a((r=>i.validator.verifyRecord(e.validators,t,r)))()},_closerPeersSingle(e,t,r){c(this._closerPeersSingleAsync(e,t))(r)},async _closerPeersSingleAsync(t,r){e._log("_closerPeersSingle %b from %s",t,r.toB58String());return(await e._findPeerSingleAsync(r,new n(t))).closerPeers.filter((t=>!e._isSelf(t.id))).map((t=>e.peerBook.put(t)))},_isSelf:t=>t&&e.peerInfo.id.id.equals(t.id),_findPeerSingle(e,t,r){c(this._findPeerSingleAsync(e,t))(r)},async _findPeerSingleAsync(t,r){e._log("_findPeerSingle %s",t.toB58String());const n=new h(h.TYPES.FIND_NODE,r.id,0);return a((r=>e.network.sendRequest(t,n,r)))()},_putValueToPeer(e,t,r,n){c(this._putValueToPeerAsync(e,t,r))(n)},async _putValueToPeerAsync(t,r,n){const i=new h(h.TYPES.PUT_VALUE,t,0);i.record=r;if(!(await a((t=>e.network.sendRequest(n,i,t)))()).record.value.equals(b.deserialize(r).value))throw u(new Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")},_putLocal(e,t,r){c(this._putLocalAsync(e,t))((e=>r(e)))},_putLocalAsync:async(t,r)=>(await a((n=>e.datastore.put(l.bufferToKey(t),r,n)))(),undefined),_get(e,t,r){c(this._getAsync(e,t))(r)},async _getAsync(t,r){e._log("_get %b",t);const n=await a((n=>e.getMany(t,f.GET_MANY_RECORD_COUNT,r,n)))(),s=n.map((e=>e.val));let o=0;try{o=i.selection.bestRecord(e.selectors,t,s)}catch(e){if("ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY"!==e.code)throw e}const c=s[o];if(e._log("GetValue %b %s",t,c),!c)throw u(new Error("best value was not found"),"ERR_NOT_FOUND");return await this._sendCorrectionRecord(t,n,c),c},async _sendCorrectionRecord(t,r,n){const i=await a((e=>l.createPutRecord(t,n,e)))();return Promise.all(r.map((async r=>{if(!r.val.equals(n))if(e._isSelf(r.from))try{await e._putLocalAsync(t,i)}catch(t){e._log.error("Failed error correcting self",t)}else try{await e._putValueToPeerAsync(t,i,r.from)}catch(t){e._log.error("Failed error correcting entry",t)}})))},_getLocal(e,t){c(this._getLocalAsync(e))(t)},async _getLocalAsync(t){e._log("getLocal %b",t);const r=await a((r=>e.datastore.get(l.bufferToKey(t),r)))();e._log("found %b in local datastore",t);const n=b.deserialize(r);return await e._verifyRecordLocallyAsync(n),n},_getValueOrPeers(e,t,r){c(this._getValueOrPeersAsync(e,t))(((e,t)=>{if(e)return r(e);r(null,t.record,t.peers)}))},async _getValueOrPeersAsync(t,r){const n=await a((n=>e._getValueSingle(t,r,n)))(),i=n.closerPeers,s=n.record;if(s){try{await e._verifyRecordOnlineAsync(s)}catch(t){const r="invalid record received, discarded";throw e._log(r),u(new Error(r),"ERR_INVALID_RECORD")}return{record:s,peers:i}}if(i.length>0)return{peers:i};throw u(new Error("Not found"),"ERR_NOT_FOUND")},_getValueSingle(e,t,r){c(this._getValueSingleAsync(e,t))(r)},async _getValueSingleAsync(t,r){const n=new h(h.TYPES.GET_VALUE,r,0);return a((r=>e.network.sendRequest(t,n,r)))()},_verifyRecordOnline(e,t){c(this._verifyRecordOnlineAsync(e))((e=>t(e)))},async _verifyRecordOnlineAsync(t){await a((r=>i.validator.verifyRecord(e.validators,t,r)))()},_getPublicKeyFromNode(e,t){c(this._getPublicKeyFromNodeAsync(e))(t)},async _getPublicKeyFromNodeAsync(t){const r=l.keyForPublicKey(t),i=await a((n=>e._getValueSingle(t,r,n)))();if(!i.record||!i.record.value)throw u(`Node not responding with its public key: ${t.toB58String()}`,"ERR_INVALID_RECORD");const s=await a((e=>n.createFromPubKey(i.record.value,e)))();if(!s.isEqual(t))throw u("public key does not match id","ERR_PUBLIC_KEY_DOES_NOT_MATCH_ID");return s.pubKey},_findNProviders(e,t,r,n){c(this._findNProvidersAsync(e,t,r))(n)},async _findNProvidersAsync(t,r,n){const i=new d(n);if((await e.providers.getProviders(t)).forEach((t=>{let r;r=e.peerBook.has(t)?e.peerBook.get(t):e.peerBook.put(new o(t)),i.push(r)})),i.length>=n)return i.toArray();const h=[],f=new p(e,t.buffer,((r,s)=>{const o=l.pathSize(n-i.length,s),a=new d(o);return h.push(a),async r=>{const n=await e._findProvidersSingleAsync(r,t),i=n.providerPeers;return e._log("(%s) found %s provider entries",e.peerInfo.id.toB58String(),i.length),i.forEach((t=>{a.push(e.peerBook.put(t))})),a.length>=o?{pathComplete:!0}:{closerPeers:n.closerPeers}}})),b=e.routingTable.closestPeers(t.buffer,e.kBucketSize);try{await a((e=>s((e=>{c(f.run(b))(e)}),r)(e)))()}catch(e){if("ETIMEDOUT"!==e.code)throw e}finally{f.stop()}if(h.forEach((e=>{e.toArray().forEach((e=>{i.push(e)}))})),0===i.length)throw u(new Error("no providers found"),"ERR_NOT_FOUND");return i.toArray()},_findProvidersSingle(e,t,r){c(this._findProvidersSingleAsync(e,t))(r)},async _findProvidersSingleAsync(t,r){const n=new h(h.TYPES.GET_PROVIDERS,r.buffer,0);return a((r=>e.network.sendRequest(t,n,r)))()}})}}},{package:"3box>ipfs>libp2p-kad-dht"}],[4903,{"./constants":4893,"./utils":4919,buffer:2132,hashlru:4421,"interface-datastore":4460,"p-queue":5377,"peer-id":5420,"promisify-es6":5434,"pull-stream-to-async-iterator":5485,varint:6042},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("hashlru"),i=e("varint"),s=e("peer-id"),o=e("interface-datastore").Key,a=e("p-queue"),c=e("promisify-es6"),u=e("pull-stream-to-async-iterator"),l=e("./constants"),h=e("./utils");function f(e){return e="string"==typeof e?e:h.encodeBase32(e.buffer),l.PROVIDERS_KEY_PREFIX+e}function p(e){const t=e.toString().split("/");if(4!==t.length)throw new Error("incorrectly formatted provider entry key in datastore: "+e);return{cid:t[2],peerId:t[3]}}function d(e){return i.decode(e)}t.exports=class{constructor(e,t,r){this.datastore=e,this._log=h.logger(t,"providers"),this.cleanupInterval=l.PROVIDERS_CLEANUP_INTERVAL,this.provideValidity=l.PROVIDERS_VALIDITY,this.lruCacheSize=r||l.PROVIDERS_LRU_CACHE_SIZE,this.providers=n(this.lruCacheSize),this.syncQueue=new a({concurrency:1})}stop(){this._cleaner&&(clearInterval(this._cleaner),this._cleaner=null)}_cleanup(){return this.syncQueue.add((async()=>{this._log("start cleanup");const e=Date.now();let t=0,r=0;const n=new Map,i=this.datastore.batch(),s=this.datastore.query({prefix:l.PROVIDERS_KEY_PREFIX});for await(const e of u(s))try{const{cid:s,peerId:o}=p(e.key),a=d(e.value),c=Date.now(),u=c-a,l=u>this.provideValidity;if(this._log("comparing: %d - %d = %d > %d %s",c,a,u,this.provideValidity,l?"(expired)":""),l){r++,i.delete(e.key);const t=n.get(s)||new Set;t.add(o),n.set(s,t)}t++}catch(e){this._log.error(e.message)}this._log("deleting %d / %d entries",r,t),n.size&&await c((e=>i.commit(e)))();for(const[e,t]of n){const r=f(e),n=this.providers.get(r);if(n){for(const e of t)n.delete(e);0===n.size?this.providers.remove(r):this.providers.set(r,n)}}this._log("Cleanup successful (%dms)",Date.now()-e)}))}async _getProvidersMap(e){const t=f(e);let r=this.providers.get(t);return r||(r=await async function(e,t){const r=new Map,n=e.query({prefix:f(t)});for await(const e of u(n)){const{peerId:t}=p(e.key);r.set(t,d(e.value))}return r}(this.datastore,e),this.providers.set(t,r)),r}get cleanupInterval(){return this._cleanupInterval}set cleanupInterval(e){this._cleanupInterval=e,this._cleaner&&clearInterval(this._cleaner),this._cleaner=setInterval((()=>this._cleanup()),this.cleanupInterval)}async addProvider(e,t){return this.syncQueue.add((async()=>{this._log("addProvider %s",e.toBaseEncodedString());const n=await this._getProvidersMap(e);this._log("loaded %s provs",n.size);const s=Date.now();n.set(h.encodeBase32(t.id),s);const a=f(e);return this.providers.set(a,n),async function(e,t,n,s){const a=[f(t),"/",h.encodeBase32(n.id)].join(""),u=new o(a),l=r.from(i.encode(s));return c((t=>e.put(u,l,t)))()}(this.datastore,e,t,s)}))}async getProviders(e){return this.syncQueue.add((async()=>{this._log("getProviders %s",e.toBaseEncodedString());return[...(await this._getProvidersMap(e)).keys()].map((e=>new s(h.decodeBase32(e))))}))}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-kad-dht"}],[4904,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=class{constructor(){this.queries=new Set,this.running=!1}queryStarted(e){this.queries.add(e)}queryCompleted(e){this.queries.delete(e)}start(){this.running=!0}stop(){this.running=!1;for(const e of this.queries)e.stop();this.queries.clear()}}}}},{package:"3box>ipfs>libp2p-kad-dht"}],[4905,{"../utils":4919,"./run":4907,multihashes:5250},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("multihashes"),i=e("../utils"),s=e("./run");t.exports=class{constructor(e,t,r){this.dht=e,this.key=t,this.makePath=r,this._log=i.logger(this.dht.peerInfo.id,"query:"+n.toB58String(t)),this.running=!1,this._onStart=this._onStart.bind(this),this._onComplete=this._onComplete.bind(this)}async run(e){return this.dht._queryManager.running?0===e.length?(this._log.error("Running query with no peers"),{finalSet:new Set,paths:[]}):(this._run=new s(this),this._log(`query running with K=${this.dht.kBucketSize}, A=${this.dht.concurrency}, D=${Math.min(this.dht.disjointPaths,e.length)}`),this._run.once("start",this._onStart),this._run.once("complete",this._onComplete),this._run.execute(e)):(this._log.error("Attempt to run query after shutdown"),{finalSet:new Set,paths:[]})}_onStart(){this.running=!0,this._startTime=Date.now(),this._log("query:start"),this.dht._queryManager.queryStarted(this)}_onComplete(){this.stop()}stop(){this._log(`query:done in ${Date.now()-this._startTime}ms`),this._run&&this._log(`${this._run.errors.length} of ${this._run.peersSeen.size} peers errored (${this._run.errors.length/this._run.peersSeen.size*100}% fail rate)`),this.running&&(this._run.removeListener("start",this._onStart),this._run.removeListener("complete",this._onComplete),this.running=!1,this._run&&this._run.stop(),this.dht._queryManager.queryCompleted(this))}}}}},{package:"3box>ipfs>libp2p-kad-dht"}],[4906,{"../peer-queue":4901,"../utils":4919},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("../peer-queue"),i=e("../utils");t.exports=class{constructor(e,t){if(this.run=e,this.queryFunc=i.withTimeout(t,3e4),!this.queryFunc)throw new Error("Path requires a `queryFn` to be specified");if("function"!=typeof this.queryFunc)throw new Error("Path expected `queryFn` to be a function. Got "+typeof this.queryFunc);this.initialPeers=[],this.peersToQuery=null}addInitialPeer(e){this.initialPeers.push(e)}async execute(){const e=await n.fromKey(this.run.query.key);this.peersToQuery=e,await Promise.all(this.initialPeers.map((e=>this.addPeerToQuery(e)))),await this.run.workerQueue(this)}async addPeerToQuery(e){this.run.query.dht._isSelf(e)||this.run.peersSeen.has(e)||await this.peersToQuery.enqueue(e)}}}}},{package:"3box>ipfs>libp2p-kad-dht"}],[4907,{"../peer-distance-list":4899,"../utils":4919,"./path":4906,"./workerQueue":4908,events:2133,"promisify-es6":5434},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("../peer-distance-list"),i=e("events"),s=e("promisify-es6"),o=e("./path"),a=e("./workerQueue"),c=e("../utils");t.exports=class extends i{constructor(e){super(),this.query=e,this.running=!1,this.workers=[],this.peersSeen=new Set,this.errors=[],this.peersQueried=null}stop(){if(this.running){this.running=!1;for(const e of this.workers)e.stop()}}async execute(e){const t=[],r=Math.min(this.query.dht.disjointPaths,e.length);for(let e=0;e<r;e++)t.push(new o(this,this.query.makePath(e,r)));e.forEach(((e,n)=>{t[n%r].addInitialPeer(e)})),await this.executePaths(t);const n={finalSet:new Set(this.peersQueried.peers),paths:[]};for(const e of t)e.res&&(e.res.pathComplete||e.res.queryComplete)&&(e.res.success=!0,n.paths.push(e.res));return n}async executePaths(e){this.running=!0,this.emit("start");try{await Promise.all(e.map((e=>e.execute())))}finally{this.stop(),this.emit("complete")}if(this.errors.length===this.peersSeen.size)throw this.errors[0]}async workerQueue(e){await this.init(),await this.startWorker(e)}async startWorker(e){const t=new a(this.query.dht,this,e,this.query._log);this.workers.push(t),await t.execute()}async init(){this.peersQueried||(this.peersQueriedPromise?await this.peersQueriedPromise:(this.peersQueriedPromise=(async()=>{const e=await s((e=>c.convertBuffer(this.query.key,e)))();this.peersQueried=new n(e,this.query.dht.kBucketSize)})(),await this.peersQueriedPromise,delete this.peersQueriedPromise))}async continueQuerying(e){if(this.peersQueried.length<this.peersQueried.capacity)return!0;const t=e.queue.workersList().map((e=>e.data));return!!await s((e=>this.peersQueried.anyCloser(t,e)))()}}}}},{package:"3box>ipfs>libp2p-kad-dht"}],[4908,{"async/queue":1874,"promise-to-callback":5432,"promisify-es6":5434},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("async/queue"),i=e("promisify-es6"),s=e("promise-to-callback");t.exports=class{constructor(e,t,r,n){this.dht=e,this.run=t,this.path=r,this.log=n,this.concurrency=this.dht.concurrency,this.queue=this.setupQueue(),this.execution=null}setupQueue(){const e=n(((e,t)=>{s(this.processNext(e))(t)}),this.concurrency);return e.error=e=>{this.log.error("queue",e),this.stop(e)},e.drain=()=>{this.log("queue:drain"),this.stop()},e.unsaturated=()=>{this.running&&this.fill()},e.buffer=0,e}stop(e){this.running&&(this.running=!1,this.queue.kill(),this.log("worker:stop, %d workers still running",this.run.workers.filter((e=>e.running)).length),e?this.execution.reject(e):this.execution.resolve())}async execute(){this.running=!0,this.execution={};const e=new Promise(((e,t)=>Object.assign(this.execution,{resolve:e,reject:t})));this.fill(),await e}fill(){for(;this.queue.running()+this.queue.length()<this.concurrency&&this.path.peersToQuery.length>0;)this.queue.push(this.path.peersToQuery.dequeue())}async processNext(e){if(!this.running)return;if(this.run.peersSeen.has(e))return;let t,r,n,i;try{t=await this.run.continueQuerying(this)}catch(e){r=e}if(this.running){if(r)throw r;if(t){if(!this.run.peersSeen.has(e)){this.run.peersSeen.add(e),this.log("queue:work");try{n=await this.execQuery(e)}catch(e){i=e}if(this.running){if(this.log("queue:work:done",i,n),i)throw i;if(n&&n.queryComplete)return this.log("query:complete"),void this.run.stop();n&&n.pathComplete&&this.stop()}}}else this.stop()}}async execQuery(e){let t,r;try{t=await this.path.queryFunc(e)}catch(e){r=e}if(this.running)if(r)this.run.errors.push(r);else{if(await i((t=>this.run.peersQueried.add(e,t)))(),t.pathComplete||t.queryComplete)return this.path.res=t,{pathComplete:t.pathComplete,queryComplete:t.queryComplete};t.closerPeers&&t.closerPeers.length>0&&await Promise.all(t.closerPeers.map((async e=>{this.dht._isSelf(e.id)||(e=this.dht.peerBook.put(e),this.dht._peerDiscovered(e),await this.path.addPeerToQuery(e.id))})))}}}}}},{package:"3box>ipfs>libp2p-kad-dht"}],[4909,{"./constants":4893,"./utils":4919,"abort-controller":1774,assert:1805,"err-code":2406,"libp2p-crypto":4866,"multihashing-async":4891,"p-times":5381,"peer-id":5420,"promisify-es6":5434},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("promisify-es6"),i=e("libp2p-crypto"),s=n(e("multihashing-async")),o=e("peer-id"),a=e("assert"),c=e("abort-controller"),u=e("err-code"),l=e("p-times"),h=e("./constants"),{logger:f}=e("./utils");t.exports=class{constructor(e,t){a(e,"Random Walk needs an instance of the Kademlia DHT"),this._options={...h.defaultRandomWalk,...t},this._kadDHT=e,this.log=f(e.peerInfo.id,"random-walk"),this._timeoutId=undefined}start(){!this._timeoutId&&this._options.enabled&&(this._timeoutId=setTimeout((()=>{this._runPeriodically()}),this._options.delay))}stop(){this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=undefined),this._controller&&this._controller.abort()}async _runPeriodically(){for(;this._timeoutId;){try{await this._walk(this._options.queriesPerPeriod,this._options.timeout)}catch(e){this._kadDHT._log.error("random-walk:error",e)}await new Promise((e=>{this._timeoutId=setTimeout(e,this._options.interval)}))}}async _walk(e,t){this.log("start"),this._controller=new c;try{await l(e,(async e=>{this.log("running query %d",e);try{const e=await this._randomPeerId();if(!this._controller)return;await this._query(e,{timeout:t,signal:this._controller.signal})}catch(t){if(t&&"ETIMEDOUT"!==t.code)throw this.log.error("query %d finished with error",e,t),t}this.log("finished query %d",e)}))}finally{this._controller=null,this.log("finished queries")}}async _query(e,t){let r;this.log("query:%s",e.toB58String());try{r=await n((r=>this._kadDHT.findPeer(e,t,r)))()}catch(e){if(e&&"ERR_NOT_FOUND"===e.code)return;throw e}throw this.log("query:found",r),u(`random-walk: ACTUALLY FOUND PEER: ${r}, ${e.toB58String()}`,"ERR_FOUND_RANDOM_PEER")}async _randomPeerId(){const e=await s(i.randomBytes(16),"sha2-256");return new o(e)}}}}},{package:"3box>ipfs>libp2p-kad-dht"}],[4910,{"./utils":4919,"k-bucket":4802},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("k-bucket"),i=e("./utils");t.exports=class{constructor(e,t){this.self=e,this._onPing=this._onPing.bind(this),i.convertPeerId(e,((e,r)=>{if(e)throw e;this.kb=new n({localNodeId:r,numberOfNodesPerKBucket:t,numberOfNodesToPing:1}),this.kb.on("ping",this._onPing)}))}_onPing(e,t){const r=e[0];this.kb.remove(r.id),this.kb.add(t)}get size(){return this.kb.count()}find(e,t){i.convertPeerId(e,((r,n)=>{if(r)return t(r);const i=this.closestPeer(n);if(i&&i.isEqual(e))return t(null,i);t()}))}closestPeer(e,t){const r=this.closestPeers(e,1);if(r.length>0)return r[0]}closestPeers(e,t){return this.kb.closest(e,t).map((e=>e.peer))}add(e,t){i.convertPeerId(e,((r,n)=>{if(r)return t(r);this.kb.add({id:n,peer:e}),t()}))}remove(e,t){i.convertPeerId(e,((e,r)=>{if(e)return t(e);this.kb.remove(r),t()}))}}}}},{package:"3box>ipfs>libp2p-kad-dht"}],[4911,{"../../utils":4919,cids:2169,"err-code":2406,"promise-to-callback":5432},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("cids"),i=e("err-code"),s=e("promise-to-callback"),o=e("../../utils");t.exports=e=>{const t=o.logger(e.peerInfo.id,"rpc:add-provider");return function(r,o,a){if(t("start"),!o.key||0===o.key.length)return a(i(new Error("Missing key"),"ERR_MISSING_KEY"));let c;try{c=new n(o.key)}catch(e){const t=`Invalid CID: ${e.message}`;return a(i(new Error(t),"ERR_INVALID_CID"))}let u=!1;o.providerPeers.forEach((n=>{n.id.isEqual(r.id)?n.multiaddrs.size<1?t("no valid addresses for provider %s. Ignore",r.id.toB58String()):(t("received provider %s for %s (addrs %s)",r.id.toB58String(),c.toBaseEncodedString(),n.multiaddrs.toArray().map((e=>e.toString()))),e._isSelf(n.id)||(u=!0,e.peerBook.put(n),s(e.providers.addProvider(c,n.id))((e=>a(e))))):t("invalid provider peer %s from %s",n.id.toB58String(),r.id.toB58String())})),u||s(e.providers.addProvider(c,r.id))((e=>a(e)))}}}}},{package:"3box>ipfs>libp2p-kad-dht"}],[4912,{"../../message":4897,"../../utils":4919,"async/waterfall":1884,buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("async/waterfall"),i=e("../../message"),s=e("../../utils");t.exports=e=>{const t=s.logger(e.peerInfo.id,"rpc:find-node");return function(s,o,a){t("start"),n([t=>{if(o.key.equals(e.peerInfo.id.id))return t(null,[e.peerInfo]);e._betterPeersToQuery(o,s,t)},(e,n)=>{const a=new i(o.type,r.alloc(0),o.clusterLevel);e.length>0?a.closerPeers=e:t("handle FindNode %s: could not find anything",s.id.toB58String()),n(null,a)}],a)}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-kad-dht"}],[4913,{"../../message":4897,"../../utils":4919,"async/parallel":1873,cids:2169,"err-code":2406,"peer-info":5421,"promise-to-callback":5432},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("cids"),i=e("async/parallel"),s=e("peer-info"),o=e("promise-to-callback"),a=e("err-code"),c=e("../../message"),u=e("../../utils");t.exports=e=>{const t=u.logger(e.peerInfo.id,"rpc:get-providers");return function(r,l,h){let f;try{f=new n(l.key)}catch(e){return h(a(new Error(`Invalid CID: ${e.message}`),"ERR_INVALID_CID"))}t("%s",f.toBaseEncodedString());const p=u.bufferToKey(f.buffer);i([r=>e.datastore.has(p,((e,n)=>{if(e)return t.error("Failed to check datastore existence",e),r(null,!1);r(null,n)})),t=>o(e.providers.getProviders(f))(t),t=>e._betterPeersToQuery(l,r,t)],((r,n)=>{if(r)return h(r);const i=n[0],o=n[2],a=n[1].map((t=>e.peerBook.has(t)?e.peerBook.get(t):e.peerBook.put(new s(t))));i&&a.push(e.peerInfo);const u=new c(l.type,l.key,l.clusterLevel);a.length>0&&(u.providerPeers=a),o.length>0&&(u.closerPeers=o),t("got %s providers %s closerPeers",a.length,o.length),h(null,u)}))}}}}},{package:"3box>ipfs>libp2p-kad-dht"}],[4914,{"../../message":4897,"../../utils":4919,"async/parallel":1873,"err-code":2406,"libp2p-record":4941},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("async/parallel"),i=e("libp2p-record").Record,s=e("err-code"),o=e("../../message"),a=e("../../utils");t.exports=e=>{const t=a.logger(e.peerInfo.id,"rpc:get-value");return function(r,c,u){const l=c.key;if(t("key: %b",l),!l||0===l.length)return u(s(new Error("Invalid key"),"ERR_INVALID_KEY"));const h=new o(o.TYPES.GET_VALUE,l,c.clusterLevel);if(a.isPublicKeyKey(l)){t("is public key");const r=a.fromPublicKeyKey(l);let n;if(e._isSelf(r)?n=e.peerInfo:e.peerBook.has(r)&&(n=e.peerBook.get(r)),n&&n.id.pubKey)return t("returning found public key"),h.record=new i(l,n.id.pubKey.bytes),u(null,h)}n([t=>e._checkLocalDatastore(l,t),t=>e._betterPeersToQuery(c,r,t)],((e,r)=>{if(e)return u(e);const n=r[0],i=r[1];n&&(t("got record"),h.record=n),i.length>0&&(t("got closer %s",i.length),h.closerPeers=i),u(null,h)}))}}}}},{package:"3box>ipfs>libp2p-kad-dht"}],[4915,{"../../message":4897,"./add-provider":4911,"./find-node":4912,"./get-providers":4913,"./get-value":4914,"./ping":4916,"./put-value":4917},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("../../message").TYPES;t.exports=t=>{const r={[n.GET_VALUE]:e("./get-value")(t),[n.PUT_VALUE]:e("./put-value")(t),[n.FIND_NODE]:e("./find-node")(t),[n.ADD_PROVIDER]:e("./add-provider")(t),[n.GET_PROVIDERS]:e("./get-providers")(t),[n.PING]:e("./ping")(t)};return function(e){return r[e]}}}}},{package:"3box>ipfs>libp2p-kad-dht"}],[4916,{"../../utils":4919},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("../../utils");t.exports=e=>{const t=n.logger(e.peerInfo.id,"rpc:ping");return function(e,r,n){t("from %s",e.id.toB58String()),n(null,r)}}}}},{package:"3box>ipfs>libp2p-kad-dht"}],[4917,{"../../utils":4919,"err-code":2406},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("../../utils"),i=e("err-code");t.exports=e=>{const t=n.logger(e.peerInfo.id,"rpc:put-value");return function(r,s,o){const a=s.key;t("key: %b",a);const c=s.record;if(!c){const e=`Empty record from: ${r.id.toB58String()}`;return t.error(e),o(i(new Error(e),"ERR_EMPTY_RECORD"))}e._verifyRecordLocally(c,(r=>{if(r)return t.error(r.message),o(r);c.timeReceived=new Date;const i=n.bufferToKey(c.key);e.datastore.put(i,c.serialize(),(e=>{if(e)return o(e);o(null,s)}))}))}}}}},{package:"3box>ipfs>libp2p-kad-dht"}],[4918,{"../constants":4893,"../message":4897,"../utils":4919,"./handlers":4915,"pull-length-prefixed":5469,"pull-stream":5487},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("pull-stream"),i=e("pull-length-prefixed"),s=e("../message"),o=e("./handlers"),a=e("../utils"),c=e("../constants");t.exports=e=>{const t=a.logger(e.peerInfo.id,"rpc"),r=o(e);return function(o,a){a.getPeerInfo(((o,u)=>{if(o)return t.error("Failed to get peer info"),void t.error(o);t("from: %s",u.id.toB58String()),n(a,i.decode(),n.filter((e=>e.length<c.maxMessageSize)),n.map((e=>{let r;try{r=s.deserialize(e)}catch(e){return void t.error("failed to read incoming message",e)}return r})),n.filter(Boolean),n.asyncMap(((n,i)=>function(n,i,s){e._add(n,(e=>{e&&(t.error("Failed to update the kbucket store"),t.error(e));const o=r(i.type);if(!o)return t.error(`no handler found for message type: ${i.type}`),s();o(n,i,s)}))}(u,n,i))),n.filter(Boolean),n.map((e=>{let r;try{r=e.serialize()}catch(e){return void t.error("failed to send message",e)}return r})),n.filter(Boolean),i.encode(),a)}))}}}}},{package:"3box>ipfs>libp2p-kad-dht"}],[4919,{"async/map":1869,"async/setImmediate":1878,"base32.js":2057,buffer:2132,debug:2304,"err-code":2406,"interface-datastore":4460,"libp2p-record":4941,multihashes:5250,"multihashing-async":4891,"peer-id":5420,"xor-distance":6172},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){const n=e("debug"),i=e("multihashing-async"),s=e("multihashes"),o=e("interface-datastore").Key,a=e("base32.js"),c=e("xor-distance"),u=e("async/map"),l=e("libp2p-record").Record,h=e("async/setImmediate"),f=e("peer-id"),p=e("err-code");r.convertBuffer=(e,t)=>{i.digest(e,"sha2-256",t)},r.convertPeerId=(e,t)=>{i.digest(e.id,"sha2-256",t)},r.bufferToKey=e=>new o("/"+r.encodeBase32(e),!1),r.keyForPublicKey=e=>t.concat([t.from("/pk/"),e.id]),r.isPublicKeyKey=e=>"/pk/"===e.slice(0,4).toString(),r.fromPublicKeyKey=e=>new f(e.slice(4)),r.now=()=>Date.now(),r.encodeBase32=e=>(new a.Encoder).write(e).finalize(),r.decodeBase32=e=>{const r=new a.Decoder;return t.from(r.write(e).finalize())},r.sortClosestPeers=(e,t,n)=>{u(e,((e,n)=>{r.convertPeerId(e,((r,i)=>{if(r)return n(r);n(null,{peer:e,distance:c(i,t)})}))}),((e,t)=>{if(e)return n(e);n(null,t.sort(r.xorCompare).map((e=>e.peer)))}))},r.xorCompare=(e,t)=>c.compare(e.distance,t.distance),r.pathSize=(e,t)=>Math.ceil(e/t),r.createPutRecord=(e,t,r)=>{const n=new Date,i=new l(e,t,n);h((()=>{r(null,i.serialize())}))},r.logger=(e,t)=>{const r=["libp2p","dht"];t&&r.push(t),e&&r.push(`${e.toB58String().slice(0,8)}`),n.formatters.b=e=>s.toB58String(e);const i=n(r.join(":"));return i.error=n(r.concat(["error"]).join(":")),i},r.TimeoutError=class extends Error{get code(){return"ETIMEDOUT"}},r.withTimeout=(e,t)=>async(...r)=>Promise.race([e(...r),new Promise(((e,r)=>{setTimeout((()=>{r(p(new Error("Async function did not complete before timeout"),"ETIMEDOUT"))}),t)}))])}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-kad-dht"}],[4920,{"./util":4923,"async/detect":1836,"async/series":1877,"async/setImmediate":1878,"async/waterfall":1884,buffer:2132,"err-code":2406,"node-forge/lib/forge":5285,"node-forge/lib/pbe":5292,"node-forge/lib/pkcs7":5296},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("async/setImmediate"),i=e("async/series"),s=e("async/detect"),o=e("async/waterfall");e("node-forge/lib/pkcs7"),e("node-forge/lib/pbe");const a=e("node-forge/lib/forge"),c=e("./util"),u=e("err-code");t.exports=class{constructor(e){if(!e)throw u(new Error("keychain is required"),"ERR_KEYCHAIN_REQUIRED");this.keychain=e}encrypt(e,t,s){const o=this,l=(e,t)=>n((()=>s(e,t)));if(!r.isBuffer(t))return l(u(new Error("Plain data must be a Buffer"),"ERR_INVALID_PARAMS"));i([t=>o.keychain.findKeyByName(e,t),t=>o.keychain._getPrivateKey(e,t)],((e,n)=>{if(e)return l(e);let i=n[0],u=n[1];try{const e=a.pki.decryptRsaPrivateKey(u,o.keychain._());c.certificateForKey(i,e,((e,n)=>{if(e)return s(e);const i=a.pkcs7.createEnvelopedData();i.addRecipient(n),i.content=a.util.createBuffer(t),i.encrypt();const o=a.asn1.toDer(i.toAsn1()).getBytes();l(null,r.from(o,"binary"))}))}catch(e){l(e)}}))}decrypt(e,t){const i=(e,r)=>n((()=>t(e,r)));if(!r.isBuffer(e))return i(u(new Error("CMS data is required"),"ERR_INVALID_PARAMS"));const c=this;let l;try{const t=a.util.createBuffer(e.toString("binary")),r=a.asn1.fromDer(t);l=a.pkcs7.messageFromAsn1(r)}catch(e){return i(u(new Error("Invalid CMS: "+e.message),"ERR_INVALID_CMS"))}const h=l.recipients.filter((e=>e.issuer.find((e=>"O"===e.shortName&&"ipfs"===e.value)))).filter((e=>e.issuer.find((e=>"CN"===e.shortName)))).map((e=>({recipient:e,keyId:e.issuer.find((e=>"CN"===e.shortName)).value})));s(h,((e,t)=>c.keychain.findKeyById(e.keyId,((e,r)=>t(null,!e&&r)))),((e,t)=>{if(e)return i(e);if(!t){const t=h.map((e=>e.keyId));return e=u(new Error("Decryption needs one of the key(s): "+t.join(", ")),"ERR_MISSING_KEYS",{missingKeys:t}),i(e)}o([e=>c.keychain.findKeyById(t.keyId,e),(e,t)=>c.keychain._getPrivateKey(e.name,t)],((e,n)=>{if(e)return i(e);const s=a.pki.decryptRsaPrivateKey(n,c.keychain._());l.decrypt(t.recipient,s),i(null,r.from(l.content.getBytes(),"binary"))}))}))}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-keychain"}],[4921,{"./keychain":4922},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e("./keychain")}}},{package:"3box>ipfs>libp2p-keychain"}],[4922,{"./cms":4920,"err-code":2406,"interface-datastore":4460,"libp2p-crypto":4866,"merge-options":5209,"pull-stream/pull":5488,"pull-stream/sinks/collect":5489,"sanitize-filename":5750},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("sanitize-filename"),i=e("merge-options"),s=e("libp2p-crypto"),o=e("interface-datastore"),a=e("pull-stream/sinks/collect"),c=e("pull-stream/pull"),u=e("./cms"),l=e("err-code"),h="/info/",f=14,p=16,d=1e3,b={dek:{keyLength:64,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function m(e){return!!e&&("string"==typeof e&&e===n(e.trim()))}function g(e,t){const r=800*Math.random()+200;setTimeout(e,r,t,null)}function y(e){return new o.Key("/pkcs8/"+e)}function k(e){return new o.Key(h+e)}t.exports=class{constructor(e,t){if(!e)throw new Error("store is required");this.store=e;const r=i(b,t);if(!r.passPhrase||r.passPhrase.length<20)throw new Error("passPhrase must be least 20 characters");if(r.dek.keyLength<f)throw new Error(`dek.keyLength must be least ${f} bytes`);if(r.dek.salt.length<p)throw new Error(`dek.saltLength must be least ${p} bytes`);if(r.dek.iterationCount<d)throw new Error(`dek.iterationCount must be least ${d}`);const n=s.pbkdf2(r.passPhrase,r.dek.salt,r.dek.iterationCount,r.dek.keyLength,r.dek.hash);Object.defineProperty(this,"_",{value:()=>n})}get cms(){return new u(this)}static generateOptions(){const e=Object.assign({},b),t=3*Math.ceil(p/3);return e.dek.salt=s.randomBytes(t).toString("base64"),e}static get options(){return b}createKey(e,t,r,n){const i=this;if(!m(e)||"self"===e)return g(n,l(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if("string"!=typeof t)return g(n,l(new Error(`Invalid key type '${t}'`),"ERR_INVALID_KEY_TYPE"));if(!Number.isSafeInteger(r))return g(n,l(new Error(`Invalid key size '${r}'`),"ERR_INVALID_KEY_SIZE"));const o=y(e);i.store.has(o,((a,c)=>{if(a)return g(n,a);if(c)return g(n,l(new Error(`Key '${e}' already exists`),"ERR_KEY_ALREADY_EXISTS"));if("rsa"===t.toLowerCase())if(r<2048)return g(n,l(new Error(`Invalid RSA key size ${r}`),"ERR_INVALID_KEY_SIZE"));s.keys.generateKeyPair(t,r,((t,r)=>{if(t)return g(n,t);r.id(((t,s)=>{if(t)return g(n,t);r.export(this._(),((t,r)=>{if(t)return g(n,t);const a={name:e,id:s},c=i.store.batch();c.put(o,r),c.put(k(e),JSON.stringify(a)),c.commit((e=>{if(e)return g(n,e);n(null,a)}))}))}))}))}))}listKeys(e){const t={prefix:h};c(this.store.query(t),a(((t,r)=>{if(t)return g(e,t);const n=r.map((e=>JSON.parse(e.value)));e(null,n)})))}findKeyById(e,t){this.listKeys(((r,n)=>{if(r)return g(t,r);const i=n.find((t=>t.id===e));t(null,i)}))}findKeyByName(e,t){if(!m(e))return g(t,l(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));const r=k(e);this.store.get(r,((r,n)=>{if(r)return g(t,l(new Error(`Key '${e}' does not exist. ${r.message}`),"ERR_KEY_NOT_FOUND"));t(null,JSON.parse(n.toString()))}))}removeKey(e,t){const r=this;if(!m(e)||"self"===e)return g(t,l(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));const n=y(e);r.findKeyByName(e,((i,s)=>{if(i)return g(t,i);const o=r.store.batch();o.delete(n),o.delete(k(e)),o.commit((e=>{if(e)return g(t,e);t(null,s)}))}))}renameKey(e,t,r){const n=this;if(!m(e)||"self"===e)return g(r,l(new Error(`Invalid old key name '${e}'`),"ERR_OLD_KEY_NAME_INVALID"));if(!m(t)||"self"===t)return g(r,l(new Error(`Invalid new key name '${t}'`),"ERR_NEW_KEY_NAME_INVALID"));const i=y(e),s=y(t),o=k(e),a=k(t);this.store.get(i,((c,u)=>{if(c)return g(r,l(new Error(`Key '${e}' does not exist. ${c.message}`),"ERR_KEY_NOT_FOUND"));const h=u.toString();n.store.has(s,((e,c)=>e?g(r,e):c?g(r,l(new Error(`Key '${t}' already exists`),"ERR_KEY_ALREADY_EXISTS")):void n.store.get(o,((e,c)=>{if(e)return g(r,e);const u=JSON.parse(c.toString());u.name=t;const l=n.store.batch();l.put(s,h),l.put(a,JSON.stringify(u)),l.delete(i),l.delete(o),l.commit((e=>{if(e)return g(r,e);r(null,u)}))}))))}))}exportKey(e,t,r){if(!m(e))return g(r,l(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(!t)return g(r,l(new Error("Password is required"),"ERR_PASSWORD_REQUIRED"));const n=y(e);this.store.get(n,((n,i)=>{if(n)return g(r,l(new Error(`Key '${e}' does not exist. ${n.message}`),"ERR_KEY_NOT_FOUND"));const o=i.toString();s.keys.__import__(o,this._(),((e,n)=>{if(e)return g(r,e);n.export(t,r)}))}))}importKey(e,t,r,n){const i=this;if(!m(e)||"self"===e)return g(n,l(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(!t)return g(n,"PEM encoded key is required");const o=y(e);i.store.has(o,((a,c)=>a?g(n,a):c?g(n,l(new Error(`Key '${e}' already exists`),"ERR_KEY_ALREADY_EXISTS")):void s.keys.__import__(t,r,((t,r)=>{if(t)return g(n,l(new Error("Cannot read the key, most likely the password is wrong"),"ERR_CANNOT_READ_KEY"));r.id(((t,s)=>{if(t)return g(n,t);r.export(this._(),((t,r)=>{if(t)return g(n,t);const a={name:e,id:s},c=i.store.batch();c.put(o,r),c.put(k(e),JSON.stringify(a)),c.commit((e=>{if(e)return g(n,e);n(null,a)}))}))}))}))))}importPeer(e,t,r){const n=this;if(!m(e))return g(r,l(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(!t||!t.privKey)return g(r,l(new Error("Peer.privKey is required"),"ERR_MISSING_PRIVATE_KEY"));const i=t.privKey,s=y(e);n.store.has(s,((t,o)=>t?g(r,t):o?g(r,l(new Error(`Key '${e}' already exists`),"ERR_KEY_ALREADY_EXISTS")):void i.id(((t,o)=>{if(t)return g(r,t);i.export(this._(),((t,i)=>{if(t)return g(r,t);const a={name:e,id:o},c=n.store.batch();c.put(s,i),c.put(k(e),JSON.stringify(a)),c.commit((e=>{if(e)return g(r,e);r(null,a)}))}))}))))}_getPrivateKey(e,t){if(!m(e))return g(t,l(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));this.store.get(y(e),((r,n)=>{if(r)return g(t,l(new Error(`Key '${e}' does not exist. ${r.message}`),"ERR_KEY_NOT_FOUND"));t(null,n.toString())}))}}}}},{package:"3box>ipfs>libp2p-keychain"}],[4923,{"node-forge/lib/forge":5285,"node-forge/lib/x509":5308},function(){with(this)return function(){"use strict";return function(e,t,r){e("node-forge/lib/x509");const n=e("node-forge/lib/forge").pki;t.exports.certificateForKey=(e,t,r)=>{const i=n.setRsaPublicKey(t.n,t.e),s=n.createCertificate();s.publicKey=i,s.serialNumber="01",s.validity.notBefore=new Date,s.validity.notAfter=new Date,s.validity.notAfter.setFullYear(s.validity.notBefore.getFullYear()+10);const o=[{name:"organizationName",value:"ipfs"},{shortName:"OU",value:"keystore"},{name:"commonName",value:e.id}];return s.setSubject(o),s.setIssuer(o),s.setExtensions([{name:"basicConstraints",cA:!0},{name:"keyUsage",keyCertSign:!0,digitalSignature:!0,nonRepudiation:!0,keyEncipherment:!0,dataEncipherment:!0},{name:"extKeyUsage",serverAuth:!0,clientAuth:!0,codeSigning:!0,emailProtection:!0,timeStamping:!0},{name:"nsCertType",client:!0,server:!0,email:!0,objsign:!0,sslCA:!0,emailCA:!0,objCA:!0}]),s.sign(t),r(null,s)}}}},{package:"3box>ipfs>libp2p-keychain"}],[4924,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={PROTOCOL:"/ipfs/ping/1.0.0",PING_LENGTH:32}}}},{package:"3box>ipfs>libp2p>libp2p-ping"}],[4925,{"./constants":4924,debug:2304,"pull-handshake":5466,"pull-stream/pull":5488},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("pull-stream/pull"),i=e("pull-handshake"),s=e("./constants"),o=s.PROTOCOL,a=s.PING_LENGTH,c=e("debug"),u=c("libp2p-ping");u.error=c("libp2p-ping:error"),(r=t.exports).mount=function(e){e.handle(o,((e,t)=>{const r=i({timeout:0}),s=r.handshake;n(t,r,t),function e(){s.read(a,((t,r)=>{if(!0!==t)return t?u.error(t):(s.write(r),e())}))}()}))},r.unmount=function(e){e.unhandle(o)}}}},{package:"3box>ipfs>libp2p>libp2p-ping"}],[4926,{"./handler":4925,"./ping":4927},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("./handler");(r=t.exports=e("./ping")).mount=n.mount,r.unmount=n.unmount}}},{package:"3box>ipfs>libp2p>libp2p-ping"}],[4927,{"./constants":4924,"./util":4928,debug:2304,events:2133,"pull-handshake":5466,"pull-stream/pull":5488,"pull-stream/sources/empty":5498},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("events").EventEmitter,i=e("pull-stream/pull"),s=e("pull-stream/sources/empty"),o=e("pull-handshake"),a=e("./constants"),c=e("./util").rnd,u=e("debug"),l=u("libp2p-ping");l.error=u("libp2p-ping:error");const h=a.PROTOCOL,f=a.PING_LENGTH;t.exports=class extends n{constructor(e,t){super(),this._stopped=!1,this.peer=t,this.swarm=e}start(){l("dialing %s to %s",h,this.peer.id.toB58String()),this.swarm.dial(this.peer,h,((e,t)=>{if(e)return this.emit("error",e);const r=o({timeout:0});this.shake=r.handshake,i(r,t,r);const n=this;!function e(){let t=new Date,r=c(f);n.shake.write(r),n.shake.read(f,((i,s)=>{let o=new Date;if(i||!r.equals(s)){const e=new Error("Received wrong ping ack");return n.emit("error",e)}n.emit("ping",o-t),n._stopped||e()}))}()}))}stop(){!this._stopped&&this.shake&&(this._stopped=!0,i(s(),this.shake.rest()))}}}}},{package:"3box>ipfs>libp2p>libp2p-ping"}],[4928,{"./constants":4924,"libp2p-crypto":4866},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("libp2p-crypto"),i=e("./constants");t.exports.rnd=e=>(e||(e=i.PING_LENGTH),n.randomBytes(e))}}},{package:"3box>ipfs>libp2p>libp2p-ping"}],[4929,{"./message":4930,"./message/sign":4932,"./peer":4934,"./utils":4935,"async/each":1838,"async/nextTick":1872,debug:2304,"err-code":2406,events:2133,"pull-stream/pull":5488,"pull-stream/sources/empty":5498,"time-cache":5946},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("events"),i=e("pull-stream/pull"),s=e("pull-stream/sources/empty"),o=e("async/each"),a=e("time-cache"),c=e("debug"),u=e("err-code"),l=e("./peer"),h=e("./message"),{signMessage:f}=e("./message/sign"),p=e("./utils"),d=e("async/nextTick");t.exports=class extends n{constructor(e,t,r,n){super(),n={signMessages:!0,...n},this.log=c(e),this.log.err=c(`${e}:error`),this.multicodec=t,this.libp2p=r,this.started=!1,n.signMessages&&(this.peerId=this.libp2p.peerInfo.id),this.topics=new Map,this.seenCache=new a,this.peers=new Map,this._dials=new Set,this._onConnection=this._onConnection.bind(this),this._dialPeer=this._dialPeer.bind(this)}_addPeer(e){const t=e.info.id.toB58String();let r=this.peers.get(t);return r||(this.log("new peer",t),this.peers.set(t,e),r=e,e.once("close",(()=>this._removePeer(e)))),++r._references,r}_removePeer(e){const t=e.info.id.toB58String();return this.log("remove",t,e._references),0==--e._references&&(this.log("delete peer",t),this.peers.delete(t)),e}_dialPeer(e,t){t=t||function(){};const r=e.id.toB58String(),n=this.peers.get(r);return n&&n.isConnected?d((()=>t())):this._dials.has(r)?(this.log("already dialing %s, ignoring dial attempt",r),d((()=>t()))):(this._dials.add(r),this.log("dialing %s",r),void this.libp2p.dialProtocol(e,this.multicodec,((n,i)=>{this.log("dial to %s complete",r);const s=!this._dials.has(r);return this._dials.delete(r),n?(this.log.err(n),t()):s?(this.log("pubsub was stopped, not processing dial to %s",r),t()):void this._onDial(e,i,t)})))}_onDial(e,t,r){const n=e.id.toB58String();this.log("connected",n);this._addPeer(new l(e)).attachConnection(t),d((()=>r()))}_onConnection(e,t){t.getPeerInfo(((e,r)=>{if(e)return this.log.err("Failed to identify incomming conn",e),i(s(),t);const n=r.id.toB58String(),o=this._addPeer(new l(r));this._processConnection(n,t,o)}))}_processConnection(e,t,r){throw u("_processConnection must be implemented by the subclass","ERR_NOT_IMPLEMENTED")}_onConnectionEnd(e,t,r){r&&"socket hang up"!==r.message&&this.log.err(r),this.log("connection ended",e,r?r.message:""),this._removePeer(t)}_buildMessage(e,t){const r=p.normalizeOutRpcMessage(e);this.peerId?f(this.peerId,r,t):d(t,null,r)}publish(e,t,r){throw u("publish must be implemented by the subclass","ERR_NOT_IMPLEMENTED")}subscribe(e){throw u("subscribe must be implemented by the subclass","ERR_NOT_IMPLEMENTED")}unsubscribe(e){throw u("unsubscribe must be implemented by the subclass","ERR_NOT_IMPLEMENTED")}start(e){if(this.started)return d((()=>e(new Error("already started"))));this.log("starting"),this.libp2p.handle(this.multicodec,this._onConnection),this.libp2p.on("peer:connect",this._dialPeer);const t=Object.values(this.libp2p.peerBook.getAll());o(t,((e,t)=>this._dialPeer(e,t)),(t=>{d((()=>{this.log("started"),this.started=!0,e(t)}))}))}stop(e){if(!this.started)return d((()=>e(new Error("not started yet"))));this.libp2p.unhandle(this.multicodec),this.libp2p.removeListener("peer:connect",this._dialPeer),this._dials=new Set,this.log("stopping"),o(this.peers.values(),((e,t)=>e.close(t)),(t=>{if(t)return e(t);this.log("stopped"),this.peers=new Map,this.started=!1,e()}))}},t.exports.message=h,t.exports.utils=p}}},{package:"3box>ipfs>libp2p>libp2p-floodsub>libp2p-pubsub"}],[4930,{"./rpc.proto.js":4931,"./topic-descriptor.proto.js":4933,protons:5450},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("protons"),i=n(e("./rpc.proto.js")),s=i.RPC,o=n(e("./topic-descriptor.proto.js"));(r=t.exports).rpc=i,r.td=o,r.RPC=s,r.Message=s.Message,r.SubOpts=s.SubOpts}}},{package:"3box>ipfs>libp2p>libp2p-floodsub>libp2p-pubsub"}],[4931,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports="\nmessage RPC {\n  repeated SubOpts subscriptions = 1;\n  repeated Message msgs = 2;\n\n  message SubOpts {\n    optional bool subscribe = 1; // subscribe or unsubcribe\n    optional string topicID = 2;\n  }\n\n  message Message {\n    optional bytes from = 1;\n    optional bytes data = 2;\n    optional bytes seqno = 3;\n    repeated string topicIDs = 4;\n    optional bytes signature = 5;\n    optional bytes key = 6;\n  }\n}"}}},{package:"3box>ipfs>libp2p>libp2p-floodsub>libp2p-pubsub"}],[4932,{"./index":4930,buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const{Message:n}=e("./index"),i=r.from("libp2p-pubsub:");t.exports.SignPrefix=i,t.exports.signMessage=function(e,t,s){const o=r.concat([i,n.encode(t)]);e.privKey.sign(o,((r,n)=>{if(r)return s(r);s(null,{...t,signature:n,key:e.pubKey.bytes})}))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p>libp2p-floodsub>libp2p-pubsub"}],[4933,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports="\n// topicCID = cid(merkledag_protobuf(topicDescriptor)); (not the topic.name)\nmessage TopicDescriptor {\n  optional string name = 1;\n  optional AuthOpts auth = 2;\n  optional EncOpts enc = 2;\n\n  message AuthOpts {\n    optional AuthMode mode = 1;\n    repeated bytes keys = 2; // root keys to trust\n\n    enum AuthMode {\n      NONE = 0; // no authentication, anyone can publish\n      KEY = 1; // only messages signed by keys in the topic descriptor are accepted\n      WOT = 2; // web of trust, certificates can allow publisher set to grow\n    }\n  }\n\n  message EncOpts {\n    optional EncMode mode = 1;\n    repeated bytes keyHashes = 2; // the hashes of the shared keys used (salted)\n\n    enum EncMode {\n      NONE = 0; // no encryption, anyone can read\n      SHAREDKEY = 1; // messages are encrypted with shared key\n      WOT = 2; // web of trust, certificates can allow publisher set to grow\n    }\n  }\n}"}}},{package:"3box>ipfs>libp2p>libp2p-floodsub>libp2p-pubsub"}],[4934,{"./message":4930,"async/setImmediate":1878,events:2133,"pull-length-prefixed":5469,"pull-pushable":5481,"pull-stream":5487},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("pull-length-prefixed"),i=e("pull-pushable"),s=e("pull-stream"),o=e("async/setImmediate"),a=e("events"),{RPC:c}=e("./message");t.exports=class extends a{constructor(e){super(),this.info=e,this.conn=null,this.topics=new Set,this.stream=null,this._references=0}get isConnected(){return Boolean(this.conn)}get isWritable(){return Boolean(this.stream)}write(e){if(!this.isWritable){const e=this.info.id.toB58String();throw new Error("No writable connection to "+e)}this.stream.push(e)}attachConnection(e){this.conn=e,this.stream=new i,s(this.stream,n.encode(),e,s.onEnd((()=>{this.conn=null,this.stream=null,this.emit("close")}))),this.emit("connection")}_sendRawSubscriptions(e,t){if(0===e.size)return;const r=[];e.forEach((e=>{r.push({subscribe:t,topicID:e})})),this.write(c.encode({subscriptions:r}))}sendSubscriptions(e){this._sendRawSubscriptions(e,!0)}sendUnsubscriptions(e){this._sendRawSubscriptions(e,!1)}sendMessages(e){this.write(c.encode({msgs:e}))}updateSubscriptions(e){e.forEach((e=>{e.subscribe?this.topics.add(e.topicID):this.topics.delete(e.topicID)}))}close(e){this._references=1,this.stream&&this.stream.end(),o((()=>{this.conn=null,this.stream=null,this.emit("close"),e()}))}}}}},{package:"3box>ipfs>libp2p>libp2p-floodsub>libp2p-pubsub"}],[4935,{"../../is-buffer/index.js":4735,bs58:2139,"libp2p-crypto":4866},function(){with(this)return function(){"use strict";return function(e,t,r){(function(n){(function(){const i=e("libp2p-crypto"),s=e("bs58");(r=t.exports).randomSeqno=()=>i.randomBytes(20),r.msgId=(e,t)=>e+t.toString("hex"),r.anyMatch=(e,t)=>{let r;r=Array.isArray(t)?e=>t.indexOf(e)>-1:e=>t.has(e);for(let t of e)if(r(t))return!0;return!1},r.ensureArray=e=>Array.isArray(e)?e:[e],r.normalizeInRpcMessages=e=>e?e.map((e=>{const t=Object.assign({},e);return n.isBuffer(e.from)&&(t.from=s.encode(e.from)),t})):e,r.normalizeOutRpcMessage=e=>{const t=Object.assign({},e);return("string"==typeof e.from||e.from instanceof String)&&(t.from=s.decode(e.from)),t},r.normalizeOutRpcMessages=e=>e?e.map(r.normalizeOutRpcMessage):e}).call(this)}).call(this,{isBuffer:e("../../is-buffer/index.js")})}}},{package:"3box>ipfs>libp2p>libp2p-floodsub>libp2p-pubsub"}],[4936,{"./utils":4940,blakejs:2085,buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("blakejs"),i=e("./utils").toCallback,s={init:n.blake2bInit,update:n.blake2bUpdate,digest:n.blake2bFinal},o={init:n.blake2sInit,update:n.blake2sUpdate,digest:n.blake2sFinal},a=(e,t)=>i((n=>{const i=t.init(e,null);return t.update(i,n),r.from(t.digest(i))}));t.exports=e=>{for(let t=0;t<64;t++)e[45569+t]=a(t+1,s);for(let t=0;t<32;t++)e[45633+t]=a(t+1,o)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-record>multihashing-async"}],[4937,{buffer:2132,nodeify:5310},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("nodeify"),i=function(){if(self.crypto)return self.crypto.subtle||self.crypto.webkitSubtle;if(self.msCrypto)return self.msCrypto.subtle}();function s(e){if(!i)throw new Error("Please use a browser with webcrypto support and ensure the code has been delivered securely via HTTPS/TLS and run within a Secure Context");return(t,s)=>{const o=i.digest({name:e},t);if("function"!=typeof o.then)return o.onerror=()=>{s(new Error(`hashing data using ${e}`))},void(o.oncomplete=e=>{s(null,e.target.result)});n(o.then((e=>r.from(new Uint8Array(e)))),s)}}t.exports={sha1:function(e,t){s("SHA-1")(e,t)},sha2256:function(e,t){s("SHA-256")(e,t)},sha2512:function(e,t){s("SHA-512")(e,t)}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-record>multihashing-async"}],[4938,{"./blake":4936,"./crypto-sha1-2":4937,"./utils":4940,buffer:2132,"js-sha3":4767,murmurhash3js:5270},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("js-sha3"),i=e("murmurhash3js"),s=e("./utils"),o=e("./crypto-sha1-2"),a=s.toCallback,c=s.toBuf,u=s.fromString,l=s.fromNumberTo32BitBuf;t.exports={sha1:o.sha1,sha2256:o.sha2256,sha2512:o.sha2512,sha3512:a(c(n.sha3_512)),sha3384:a(c(n.sha3_384)),sha3256:a(c(n.sha3_256)),sha3224:a(c(n.sha3_224)),shake128:a(c(n.shake_128,128)),shake256:a(c(n.shake_256,256)),keccak224:a(c(n.keccak_224)),keccak256:a(c(n.keccak_256)),keccak384:a(c(n.keccak_384)),keccak512:a(c(n.keccak_512)),murmur3128:a(c(u(i.x64.hash128))),murmur332:a(l(u(i.x86.hash32))),addBlake:e("./blake"),dblSha2256:(e,t)=>{o.sha2256(e,((e,n)=>{e&&t(e),o.sha2256(r.from(n),t)}))}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-record>multihashing-async"}],[4939,{"./crypto":4938,buffer:2132,multihashes:5250},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("multihashes"),i=e("./crypto");function s(e,t,r,i){if("function"==typeof r&&(i=r,r=undefined),!i)throw new Error("Missing callback");s.digest(e,t,r,((e,s)=>{if(e)return i(e);i(null,n.encode(s,t,r))}))}t.exports=s,s.Buffer=r,s.multihash=n,s.digest=function(e,t,r,n){if("function"==typeof r&&(n=r,r=undefined),!n)throw new Error("Missing callback");let i,o=n;r&&(o=(e,t)=>{if(e)return n(e);n(null,t.slice(0,r))});try{i=s.createHash(t)}catch(e){return o(e)}i(e,o)},s.createHash=function(e){if(e=n.coerceCode(e),!s.functions[e])throw new Error("multihash function "+e+" not yet supported");return s.functions[e]},s.functions={17:i.sha1,18:i.sha2256,19:i.sha2512,20:i.sha3512,21:i.sha3384,22:i.sha3256,23:i.sha3224,24:i.shake128,25:i.shake256,26:i.keccak224,27:i.keccak256,28:i.keccak384,29:i.keccak512,34:i.murmur3128,35:i.murmur332,86:i.dblSha2256},i.addBlake(s.functions),s.validate=(e,t,i)=>{s(e,n.decode(t).name,((e,n)=>{if(e)return i(e);i(e,0===r.compare(t,n))}))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-record>multihashing-async"}],[4940,{_process:5430,buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e,t){(function(){r.toCallback=t=>function(r,n){let i;try{i=t(r)}catch(t){return void e.nextTick(n,t)}e.nextTick(n,null,i)},r.toBuf=(e,r)=>n=>{let i=e(n,r);return t.from(i,"hex")},r.fromString=(e,r)=>n=>{const i=t.isBuffer(n)?n.toString():n;return e(i,r)},r.fromNumberTo32BitBuf=(e,r)=>n=>{let i=e(n,r);const s=new Array(4);for(let e=0;e<4;e++)s[e]=255&i,i>>=8;return t.from(s)}}).call(this)}).call(this,e("_process"),e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-record>multihashing-async"}],[4941,{"./record":4942,"./selection":4944,"./validator":4948},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={Record:e("./record"),validator:e("./validator"),selection:e("./selection")}}}},{package:"3box>ipfs>libp2p-record"}],[4942,{"../../is-buffer/index.js":4735,"./record.proto":4943,"./utils":4947,assert:1805,protons:5450},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("protons"),i=e("assert"),s=n(e("./record.proto")).Record,o=e("./utils");class a{constructor(e,t,n){e&&i(r.isBuffer(e),"key must be a Buffer"),t&&i(r.isBuffer(t),"value must be a buffer"),this.key=e,this.value=t,this.timeReceived=n}serialize(){return s.encode(this.prepareSerialize())}prepareSerialize(){return{key:this.key,value:this.value,timeReceived:this.timeReceived&&o.toRFC3339(this.timeReceived)}}static deserialize(e){const t=s.decode(e);return a.fromDeserialized(t)}static fromDeserialized(e){let t;e.timeReceived&&(t=o.parseRFC3339(e.timeReceived));return new a(e.key,e.value,t)}}t.exports=a}).call(this)}).call(this,{isBuffer:e("../../is-buffer/index.js")})}}},{package:"3box>ipfs>libp2p-record"}],[4943,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports="// Record represents a dht record that contains a value\n// for a key value pair\nmessage Record {\n  // The key that references this record\n  bytes key = 1;\n\n  // The actual value this record is storing\n  bytes value = 2;\n\n  // Note: These fields were removed from the Record message\n  // hash of the authors public key\n  // optional bytes author = 3;\n  // A PKI signature for the key+value+author\n  // optional bytes signature = 4;\n\n  // Time the record was received, set by receiver\n  optional string timeReceived = 5;\n}"}}},{package:"3box>ipfs>libp2p-record"}],[4944,{"./selectors":4945,buffer:2132,"buffer-split":2145,"err-code":2406},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("buffer-split"),i=e("err-code");t.exports={bestRecord:(e,t,s)=>{if(0===s.length){throw i(new Error("No records given"),"ERR_NO_RECORDS_RECEIVED")}const o=n(t,r.from("/"));if(o.length<3){throw i(new Error("Record key does not have a selector function"),"ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")}const a=e[o[1].toString()];if(!a){const e=`Unrecognized key prefix: ${o[1]}`;throw i(new Error(e),"ERR_UNRECOGNIZED_KEY_PREFIX")}return a(t,s)},selectors:e("./selectors")}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-record"}],[4945,{"./public-key":4946},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={pk:e("./public-key")}}}},{package:"3box>ipfs>libp2p-record"}],[4946,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=(e,t)=>0}}},{package:"3box>ipfs>libp2p-record"}],[4947,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports.toRFC3339=e=>`${e.getUTCFullYear()}-${String(e.getUTCMonth()+1).padStart(2,"0")}-${String(e.getUTCDate()).padStart(2,"0")}T${String(e.getUTCHours()).padStart(2,"0")}:${String(e.getUTCMinutes()).padStart(2,"0")}:${String(e.getUTCSeconds()).padStart(2,"0")}.${1e3*e.getUTCMilliseconds()*1e3}Z`,t.exports.parseRFC3339=e=>{const t=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T"+"(\\d{2}):(\\d{2}):(\\d{2})"+"\\.(\\d+)Z"),r=String(e).trim().match(t);if(!r)throw new Error("Invalid format");const n=parseInt(r[1],10),i=parseInt(r[2],10)-1,s=parseInt(r[3],10),o=parseInt(r[4],10),a=parseInt(r[5],10),c=parseInt(r[6],10),u=parseInt(r[7].slice(0,-6),10);return new Date(Date.UTC(n,i,s,o,a,c,u))}}}},{package:"3box>ipfs>libp2p-record"}],[4948,{"./validators":4949,buffer:2132,"buffer-split":2145,"err-code":2406},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("buffer-split"),i=e("err-code");t.exports={verifyRecord:(e,t,s)=>{const o=t.key,a=n(o,r.from("/"));if(a.length<3)return s();const c=e[a[1].toString()];if(!c){return s(i(new Error("Invalid record keytype"),"ERR_INVALID_RECORD_KEY_TYPE"))}c.func(o,t.value,s)},validators:e("./validators")}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-record"}],[4949,{"./public-key":4950},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={pk:e("./public-key")}}}},{package:"3box>ipfs>libp2p-record"}],[4950,{"../../../is-buffer/index.js":4735,"async/setImmediate":1878,"multihashing-async":4939},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("async/setImmediate"),i=e("multihashing-async");t.exports={func:(e,t,s)=>{const o=e=>n((()=>s(e)));if(!r.isBuffer(e))return o(new Error('"key" must be a Buffer'));if(e.length<3)return o(new Error("invalid public key record"));if("/pk/"!==e.slice(0,4).toString())return o(new Error("key was not prefixed with /pk/"));const a=e.slice(4);i(t,"sha2-256",((e,t)=>e?o(e):a.equals(t)?void o():o(new Error("public key does not match passed in key"))))},sign:!1}}).call(this)}).call(this,{isBuffer:e("../../../is-buffer/index.js")})}}},{package:"3box>ipfs>libp2p-record"}],[4951,{"./utils":4955,blakejs:2085,buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("blakejs"),i=e("./utils").toCallback,s={init:n.blake2bInit,update:n.blake2bUpdate,digest:n.blake2bFinal},o={init:n.blake2sInit,update:n.blake2sUpdate,digest:n.blake2sFinal},a=(e,t)=>i((n=>{const i=t.init(e,null);return t.update(i,n),r.from(t.digest(i))}));t.exports=e=>{for(let t=0;t<64;t++)e[45569+t]=a(t+1,s);for(let t=0;t<32;t++)e[45633+t]=a(t+1,o)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-secio>multihashing-async"}],[4952,{buffer:2132,nodeify:5310},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("nodeify"),i=function(){if(self.crypto)return self.crypto.subtle||self.crypto.webkitSubtle;if(self.msCrypto)return self.msCrypto.subtle}();function s(e){if(!i)throw new Error("Please use a browser with webcrypto support and ensure the code has been delivered securely via HTTPS/TLS and run within a Secure Context");return(t,s)=>{const o=i.digest({name:e},t);if("function"!=typeof o.then)return o.onerror=()=>{s(new Error(`hashing data using ${e}`))},void(o.oncomplete=e=>{s(null,e.target.result)});n(o.then((e=>r.from(new Uint8Array(e)))),s)}}t.exports={sha1:function(e,t){s("SHA-1")(e,t)},sha2256:function(e,t){s("SHA-256")(e,t)},sha2512:function(e,t){s("SHA-512")(e,t)}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-secio>multihashing-async"}],[4953,{"./blake":4951,"./crypto-sha1-2":4952,"./utils":4955,buffer:2132,"js-sha3":4767,murmurhash3js:5270},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("js-sha3"),i=e("murmurhash3js"),s=e("./utils"),o=e("./crypto-sha1-2"),a=s.toCallback,c=s.toBuf,u=s.fromString,l=s.fromNumberTo32BitBuf;t.exports={sha1:o.sha1,sha2256:o.sha2256,sha2512:o.sha2512,sha3512:a(c(n.sha3_512)),sha3384:a(c(n.sha3_384)),sha3256:a(c(n.sha3_256)),sha3224:a(c(n.sha3_224)),shake128:a(c(n.shake_128,128)),shake256:a(c(n.shake_256,256)),keccak224:a(c(n.keccak_224)),keccak256:a(c(n.keccak_256)),keccak384:a(c(n.keccak_384)),keccak512:a(c(n.keccak_512)),murmur3128:a(c(u(i.x64.hash128))),murmur332:a(l(u(i.x86.hash32))),addBlake:e("./blake"),dblSha2256:(e,t)=>{o.sha2256(e,((e,n)=>{e&&t(e),o.sha2256(r.from(n),t)}))}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-secio>multihashing-async"}],[4954,{"./crypto":4953,buffer:2132,multihashes:5250},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("multihashes"),i=e("./crypto");function s(e,t,r,i){if("function"==typeof r&&(i=r,r=undefined),!i)throw new Error("Missing callback");s.digest(e,t,r,((e,s)=>{if(e)return i(e);i(null,n.encode(s,t,r))}))}t.exports=s,s.Buffer=r,s.multihash=n,s.digest=function(e,t,r,n){if("function"==typeof r&&(n=r,r=undefined),!n)throw new Error("Missing callback");let i,o=n;r&&(o=(e,t)=>{if(e)return n(e);n(null,t.slice(0,r))});try{i=s.createHash(t)}catch(e){return o(e)}i(e,o)},s.createHash=function(e){if(e=n.coerceCode(e),!s.functions[e])throw new Error("multihash function "+e+" not yet supported");return s.functions[e]},s.functions={17:i.sha1,18:i.sha2256,19:i.sha2512,20:i.sha3512,21:i.sha3384,22:i.sha3256,23:i.sha3224,24:i.shake128,25:i.shake256,26:i.keccak224,27:i.keccak256,28:i.keccak384,29:i.keccak512,34:i.murmur3128,35:i.murmur332,86:i.dblSha2256},i.addBlake(s.functions)}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-secio>multihashing-async"}],[4955,{_process:5430,buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e,t){(function(){r.toCallback=t=>function(r,n){let i;try{i=t(r)}catch(t){return void e.nextTick(n,t)}e.nextTick(n,null,i)},r.toBuf=(e,r)=>n=>{let i=e(n,r);return t.from(i,"hex")},r.fromString=(e,r)=>n=>{const i=t.isBuffer(n)?n.toString():n;return e(i,r)},r.fromNumberTo32BitBuf=(e,r)=>n=>{let i=e(n,r);const s=new Array(4);for(let e=0;e<4;e++)s[e]=255&i,i>>=8;return t.from(s)}}).call(this)}).call(this,e("_process"),e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-secio>multihashing-async"}],[4956,{buffer:2132,"pull-length-prefixed":5469,"pull-stream/pull":5488,"pull-stream/throughs/async-map":5505,"pull-stream/throughs/map":5510},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){const n=e("pull-stream/pull"),i=e("pull-stream/throughs/map"),s=e("pull-stream/throughs/async-map"),o=e("pull-length-prefixed"),a={fixed:!0,bytes:4};function c(){return i((e=>"string"==typeof e?t.from(e,"utf-8"):e))}r.createBoxStream=(e,r)=>n(c(),s(((n,i)=>{e.encrypt(n,((e,n)=>{if(e)return i(e);r.digest(n,((e,r)=>{if(e)return i(e);i(null,t.concat([n,r]))}))}))})),o.encode(a)),r.createUnboxStream=(e,t)=>n(c(),o.decode(a),s(((r,n)=>{const i=r.length,s=t.length;if(i<s)return n(new Error(`buffer (${i}) shorter than MAC size (${s})`));const o=i-s,a=r.slice(0,o),c=r.slice(o);t.digest(a,((t,r)=>t?n(t):c.equals(r)?void e.decrypt(a,((e,t)=>{if(e)return n(e);n(null,t)})):n(new Error(`MAC Invalid: ${c.toString("hex")} != ${r.toString("hex")}`))))})))}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-secio"}],[4957,{"../support":4965,"./secio.proto":4962,"async/parallel":1873,"async/waterfall":1884,buffer:2132,debug:2304,"libp2p-crypto":4866,"peer-id":5420,protons:5450},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){const n=e("protons"),i=e("peer-id"),s=e("libp2p-crypto"),o=e("async/parallel"),a=e("async/waterfall"),c=e("debug"),u=c("libp2p:secio");u.error=c("libp2p:secio:error");const l=n(e("./secio.proto")),h=e("../support");r.createProposal=e=>(e.proposal.out={rand:s.randomBytes(16),pubkey:e.key.local.public.bytes,exchanges:h.exchanges.join(","),ciphers:h.ciphers.join(","),hashes:h.hashes.join(",")},e.proposalEncoded.out=l.Propose.encode(e.proposal.out),e.proposalEncoded.out),r.createExchange=(e,r)=>{s.keys.generateEphemeralKeyPair(e.protocols.local.curveT,((n,i)=>{if(n)return r(n);e.ephemeralKey.local=i.key,e.shared.generate=i.genSharedKey;const s=t.concat([e.proposalEncoded.out,e.proposalEncoded.in,e.ephemeralKey.local]);e.key.local.sign(s,((t,n)=>{if(t)return r(t);e.exchange.out={epubkey:e.ephemeralKey.local,signature:n},r(null,l.Exchange.encode(e.exchange.out))}))}))},r.identify=(e,t,r)=>{u("1.1 identify"),e.proposalEncoded.in=t,e.proposal.in=l.Propose.decode(t);const n=e.proposal.in.pubkey;e.key.remote=s.keys.unmarshalPublicKey(n),i.createFromPubKey(n.toString("base64"),((t,n)=>{if(t)return r(t);if(e.id.remote){if(e.id.remote.toB58String()!==n.toB58String())return r(new Error("dialed to the wrong peer, Ids do not match"))}else e.id.remote=n;u("1.1 identify - %s - identified remote peer as %s",e.id.local.toB58String(),e.id.remote.toB58String()),r()}))},r.selectProtocols=(e,t)=>{u("1.2 selection");const r={pubKeyBytes:e.key.local.public.bytes,exchanges:h.exchanges,hashes:h.hashes,ciphers:h.ciphers,nonce:e.proposal.out.rand},n={pubKeyBytes:e.proposal.in.pubkey,exchanges:e.proposal.in.exchanges.split(","),hashes:e.proposal.in.hashes.split(","),ciphers:e.proposal.in.ciphers.split(","),nonce:e.proposal.in.rand};h.selectBest(r,n,((r,n)=>{if(r)return t(r);e.protocols.remote={order:n.order,curveT:n.curveT,cipherT:n.cipherT,hashT:n.hashT},e.protocols.local={order:n.order,curveT:n.curveT,cipherT:n.cipherT,hashT:n.hashT},t()}))},r.verify=(e,r,n)=>{u("2.1. verify"),e.exchange.in=l.Exchange.decode(r),e.ephemeralKey.remote=e.exchange.in.epubkey;const i=t.concat([e.proposalEncoded.in,e.proposalEncoded.out,e.ephemeralKey.remote]);e.key.remote.verify(i,e.exchange.in.signature,((e,t)=>e?n(e):t?(u("2.1. verify - signature verified"),void n()):n(new Error("Bad signature"))))},r.generateKeys=(e,t)=>{u("2.2. keys"),a([t=>e.shared.generate(e.exchange.in.epubkey,t),(t,r)=>{e.shared.secret=t,s.keys.keyStretcher(e.protocols.local.cipherT,e.protocols.local.hashT,e.shared.secret,r)},(t,r)=>{if(e.protocols.local.order>0)e.protocols.local.keys=t.k1,e.protocols.remote.keys=t.k2;else{if(!(e.protocols.local.order<0))return r(new Error("you are trying to talk to yourself"));e.protocols.local.keys=t.k2,e.protocols.remote.keys=t.k1}u("2.3. mac + cipher"),o([t=>h.makeMacAndCipher(e.protocols.local,t),t=>h.makeMacAndCipher(e.protocols.remote,t)],r)}],t)},r.verifyNonce=(e,t)=>{const r=e.proposal.out.rand;if(!r.equals(t))throw new Error(`Failed to read our encrypted nonce: ${r.toString("hex")} != ${t.toString("hex")}`)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-secio"}],[4958,{"../support":4965,"./crypto":4957,"async/waterfall":1884,debug:2304},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("debug"),i=e("async/waterfall"),s=e("../support"),o=e("./crypto"),a=n("libp2p:secio");a.error=n("libp2p:secio:error"),t.exports=function(e,t){a("2. exchange - start"),a("2. exchange - writing exchange"),i([t=>o.createExchange(e,t),(t,r)=>{s.write(e,t),s.read(e.shake,r)},(t,r)=>{a("2. exchange - reading exchange"),o.verify(e,t,r)},t=>o.generateKeys(e,t)],(e=>{if(e)return t(e);a("2. exchange - finish"),t()}))}}}},{package:"3box>ipfs>libp2p-secio"}],[4959,{"../etm":4956,"./crypto":4957,debug:2304,"pull-handshake":5466,"pull-stream/pull":5488,"pull-stream/sources/error":5499},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("pull-stream/pull"),i=e("pull-stream/sources/error"),s=e("pull-handshake"),o=e("debug"),a=o("libp2p:secio");a.error=o("libp2p:secio:error");const c=e("../etm"),u=e("./crypto");t.exports=function(e,t){a("3. finish - start");const r=e.protocols,o=e.shake.rest(),l=s({timeout:e.timeout},(e=>{if(e)throw e}));n(o,c.createUnboxStream(r.remote.cipher,r.remote.mac),l,c.createBoxStream(r.local.cipher,r.local.mac),o),l.handshake.write(e.proposal.in.rand),l.handshake.read(e.proposal.in.rand.length,((r,n)=>{const s=r=>{a.error(r),e.secure.resolve({source:i(r),sink(e){}}),t(r)};if(r)return s(r);try{u.verifyNonce(e,n)}catch(r){return s(r)}a("3. finish - finish"),e.secure.resolve(l.handshake.rest()),t()}))}}}},{package:"3box>ipfs>libp2p-secio"}],[4960,{"./exchange":4958,"./finish":4959,"./propose":4961,"async/series":1877},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("async/series"),i=e("./propose"),s=e("./exchange"),o=e("./finish");t.exports=function(e,t){return n([t=>i(e,t),t=>s(e,t),t=>o(e,t)],(r=>{e.cleanSecrets(),r&&(!0===r&&(r=new Error("Stream ended prematurely")),e.shake.abort(r)),t(r)})),e.stream}}}},{package:"3box>ipfs>libp2p-secio"}],[4961,{"../support":4965,"./crypto":4957,"async/waterfall":1884,debug:2304},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("debug"),i=e("async/waterfall"),s=e("../support"),o=e("./crypto"),a=n("libp2p:secio");a.error=n("libp2p:secio:error"),t.exports=function(e,t){a("1. propose - start"),a("1. propose - writing proposal"),s.write(e,o.createProposal(e)),i([t=>s.read(e.shake,t),(t,r)=>{a("1. propose - reading proposal",t),o.identify(e,t,r)},t=>o.selectProtocols(e,t)],(e=>{if(e)return t(e);a("1. propose - finish"),t()}))}}}},{package:"3box>ipfs>libp2p-secio"}],[4962,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports="message Propose {\n  optional bytes rand = 1;\n  optional bytes pubkey = 2;\n  optional string exchanges = 3;\n  optional string ciphers = 4;\n  optional string hashes = 5;\n}\n\nmessage Exchange {\n  optional bytes epubkey = 1;\n  optional bytes signature = 2;\n}"}}},{package:"3box>ipfs>libp2p-secio"}],[4963,{"./handshake":4960,"./state":4964,assert:1805,debug:2304,"interface-connection":4455,once:5323,"peer-info":5421,"pull-stream/pull":5488},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("pull-stream/pull"),i=e("interface-connection").Connection,s=e("assert"),o=e("peer-info"),a=e("debug"),c=e("once"),u=a("libp2p:secio");u.error=a("libp2p:secio:error");const l=e("./handshake"),h=e("./state");t.exports={tag:"/secio/1.0.0",encrypt(e,t,r,a){s(e,"no local private key provided"),s(t,"no connection for the handshake  provided"),"function"==typeof r&&(a=r,r=undefined),a=c(a||function(e){e&&u.error(e)});const f=new h(e,r,3e5,a);const p=new i(undefined,t);return n(t,l(f,(function(e){if(e)return a(e);t.getPeerInfo(((e,r)=>{p.setInnerConn(new i(f.secure,t)),e&&p.setPeerInfo(new o(f.id.remote)),a()}))})),t),p}}}}},{package:"3box>ipfs>libp2p-secio"}],[4964,{"pull-defer":5462,"pull-handshake":5466},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("pull-handshake"),i=e("pull-defer");t.exports=class{constructor(e,t,r,s){"function"==typeof r&&(s=r,r=undefined),this.setup(),this.id.local=e,this.id.remote=t,this.key.local=e.privKey,this.timeout=r||6e4,s=s||(()=>{}),this.secure=i.duplex(),this.stream=n({timeout:this.timeout},s),this.shake=this.stream.handshake,delete this.stream.handshake}setup(){this.id={local:null,remote:null},this.key={local:null,remote:null},this.shake=null,this.cleanSecrets()}cleanSecrets(){this.shared={},this.ephemeralKey={local:null,remote:null},this.proposal={in:null,out:null},this.proposalEncoded={in:null,out:null},this.protocols={local:null,remote:null},this.exchange={in:null,out:null}}}}}},{package:"3box>ipfs>libp2p-secio"}],[4965,{"async/parallel":1873,buffer:2132,"libp2p-crypto":4866,"multihashing-async":4954,"pull-length-prefixed":5469,"pull-stream/pull":5488,"pull-stream/sinks/collect":5489,"pull-stream/sources/values":5504},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){const n=e("multihashing-async"),i=e("pull-length-prefixed"),s=e("pull-stream/pull"),o=e("pull-stream/sources/values"),a=e("pull-stream/sinks/collect"),c=e("libp2p-crypto"),u=e("async/parallel");r.exchanges=["P-256","P-384","P-521"],r.ciphers=["AES-256","AES-128"],r.hashes=["SHA256","SHA512"],r.theBest=(e,t,r)=>{let n,i;if(e<0)n=r,i=t;else{if(!(e>0))return t[0];n=t,i=r}for(let e of n)for(let t of i)if(e===t)return e;throw new Error("No algorithms in common!")},r.makeMacAndCipher=(e,t)=>{u([t=>function(e,t,r){c.hmac.create(e,t,r)}(e.hashT,e.keys.macKey,t),t=>function(e,t,r,n){if("AES-128"===e||"AES-256"===e)return c.aes.create(r,t,n);n(new Error(`unrecognized cipher type: ${e}`))}(e.cipherT,e.keys.iv,e.keys.cipherKey,t)],((r,n)=>{if(r)return t(r);e.mac=n[0],e.cipher=n[1],t()}))},r.selectBest=(e,n,i)=>{r.digest(t.concat([n.pubKeyBytes,e.nonce]),((s,o)=>{if(s)return i(s);r.digest(t.concat([e.pubKeyBytes,n.nonce]),((s,a)=>{if(s)return i(s);const c=t.compare(o,a);if(0===c)return i(new Error("you are trying to talk to yourself"));i(null,{curveT:r.theBest(c,e.exchanges,n.exchanges),cipherT:r.theBest(c,e.ciphers,n.ciphers),hashT:r.theBest(c,e.hashes,n.hashes),order:c})}))}))},r.digest=(e,t)=>{n.digest(e,"sha2-256",e.length,t)},r.write=function(e,t,r){r=r||(()=>{}),s(o([t]),i.encode({fixed:!0,bytes:4}),a(((t,n)=>{if(t)return r(t);e.shake.write(n[0]),r()})))},r.read=function(e,t){i.decodeFromReader(e,{fixed:!0,bytes:4},t)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-secio"}],[4966,{},function(){with(this)return function(){"use strict";return function(e,t,r){!function(e){var r,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator,s=Math.ceil,o=Math.floor,a="[BigNumber Error] ",c=a+"Number primitive has more than 15 significant digits: ",u=1e14,l=14,h=9007199254740991,f=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],p=1e7,d=1e9;function b(e){var t=0|e;return e>0||e===t?t:t-1}function m(e){for(var t,r,n=1,i=e.length,s=e[0]+"";n<i;){for(t=e[n++]+"",r=l-t.length;r--;t="0"+t);s+=t}for(i=s.length;48===s.charCodeAt(--i););return s.slice(0,i+1||1)}function g(e,t){var r,n,i=e.c,s=t.c,o=e.s,a=t.s,c=e.e,u=t.e;if(!o||!a)return null;if(r=i&&!i[0],n=s&&!s[0],r||n)return r?n?0:-a:o;if(o!=a)return o;if(r=o<0,n=c==u,!i||!s)return n?0:!i^r?1:-1;if(!n)return c>u^r?1:-1;for(a=(c=i.length)<(u=s.length)?c:u,o=0;o<a;o++)if(i[o]!=s[o])return i[o]>s[o]^r?1:-1;return c==u?0:c>u^r?1:-1}function y(e,t,r,n){if(e<t||e>r||e!==o(e))throw Error(a+(n||"Argument")+("number"==typeof e?e<t||e>r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function k(e){var t=e.c.length-1;return b(e.e/l)==t&&e.c[t]%2!=0}function _(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function E(e,t,r){var n,i;if(t<0){for(i=r+".";++t;i+=r);e=i+e}else if(++t>(n=e.length)){for(i=r,t-=n;--t;i+=r);e+=i}else t<n&&(e=e.slice(0,t)+"."+e.slice(t));return e}r=function e(t){var r,S,w,v,x,I,A,T,R,N,P=G.prototype={constructor:G,toString:null,valueOf:null},O=new G(1),B=20,C=4,D=-7,L=21,M=-1e7,K=1e7,j=!1,U=1,F=0,V={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},q="0123456789abcdefghijklmnopqrstuvwxyz";function G(e,t){var r,i,s,a,u,f,p,d,b=this;if(!(b instanceof G))return new G(e,t);if(null==t){if(e&&!0===e._isBigNumber)return b.s=e.s,void(!e.c||e.e>K?b.c=b.e=null:e.e<M?b.c=[b.e=0]:(b.e=e.e,b.c=e.c.slice()));if((f="number"==typeof e)&&0*e==0){if(b.s=1/e<0?(e=-e,-1):1,e===~~e){for(a=0,u=e;u>=10;u/=10,a++);return void(a>K?b.c=b.e=null:(b.e=a,b.c=[e]))}d=String(e)}else{if(!n.test(d=String(e)))return w(b,d,f);b.s=45==d.charCodeAt(0)?(d=d.slice(1),-1):1}(a=d.indexOf("."))>-1&&(d=d.replace(".","")),(u=d.search(/e/i))>0?(a<0&&(a=u),a+=+d.slice(u+1),d=d.substring(0,u)):a<0&&(a=d.length)}else{if(y(t,2,q.length,"Base"),10==t)return W(b=new G(e),B+b.e+1,C);if(d=String(e),f="number"==typeof e){if(0*e!=0)return w(b,d,f,t);if(b.s=1/e<0?(d=d.slice(1),-1):1,G.DEBUG&&d.replace(/^0\.0*|\./,"").length>15)throw Error(c+e)}else b.s=45===d.charCodeAt(0)?(d=d.slice(1),-1):1;for(r=q.slice(0,t),a=u=0,p=d.length;u<p;u++)if(r.indexOf(i=d.charAt(u))<0){if("."==i){if(u>a){a=p;continue}}else if(!s&&(d==d.toUpperCase()&&(d=d.toLowerCase())||d==d.toLowerCase()&&(d=d.toUpperCase()))){s=!0,u=-1,a=0;continue}return w(b,String(e),f,t)}f=!1,(a=(d=S(d,t,10,b.s)).indexOf("."))>-1?d=d.replace(".",""):a=d.length}for(u=0;48===d.charCodeAt(u);u++);for(p=d.length;48===d.charCodeAt(--p););if(d=d.slice(u,++p)){if(p-=u,f&&G.DEBUG&&p>15&&(e>h||e!==o(e)))throw Error(c+b.s*e);if((a=a-u-1)>K)b.c=b.e=null;else if(a<M)b.c=[b.e=0];else{if(b.e=a,b.c=[],u=(a+1)%l,a<0&&(u+=l),u<p){for(u&&b.c.push(+d.slice(0,u)),p-=l;u<p;)b.c.push(+d.slice(u,u+=l));u=l-(d=d.slice(u)).length}else u-=p;for(;u--;d+="0");b.c.push(+d)}}else b.c=[b.e=0]}function H(e,t,r,n){var i,s,o,a,c;if(null==r?r=C:y(r,0,8),!e.c)return e.toString();if(i=e.c[0],o=e.e,null==t)c=m(e.c),c=1==n||2==n&&(o<=D||o>=L)?_(c,o):E(c,o,"0");else if(s=(e=W(new G(e),t,r)).e,a=(c=m(e.c)).length,1==n||2==n&&(t<=s||s<=D)){for(;a<t;c+="0",a++);c=_(c,s)}else if(t-=o,c=E(c,s,"0"),s+1>a){if(--t>0)for(c+=".";t--;c+="0");}else if((t+=s-a)>0)for(s+1==a&&(c+=".");t--;c+="0");return e.s<0&&i?"-"+c:c}function z(e,t){for(var r,n=1,i=new G(e[0]);n<e.length;n++){if(!(r=new G(e[n])).s){i=r;break}t.call(i,r)&&(i=r)}return i}function $(e,t,r){for(var n=1,i=t.length;!t[--i];t.pop());for(i=t[0];i>=10;i/=10,n++);return(r=n+r*l-1)>K?e.c=e.e=null:r<M?e.c=[e.e=0]:(e.e=r,e.c=t),e}function W(e,t,r,n){var i,a,c,h,p,d,b,m=e.c,g=f;if(m){e:{for(i=1,h=m[0];h>=10;h/=10,i++);if((a=t-i)<0)a+=l,c=t,b=(p=m[d=0])/g[i-c-1]%10|0;else if((d=s((a+1)/l))>=m.length){if(!n)break e;for(;m.length<=d;m.push(0));p=b=0,i=1,c=(a%=l)-l+1}else{for(p=h=m[d],i=1;h>=10;h/=10,i++);b=(c=(a%=l)-l+i)<0?0:p/g[i-c-1]%10|0}if(n=n||t<0||null!=m[d+1]||(c<0?p:p%g[i-c-1]),n=r<4?(b||n)&&(0==r||r==(e.s<0?3:2)):b>5||5==b&&(4==r||n||6==r&&(a>0?c>0?p/g[i-c]:0:m[d-1])%10&1||r==(e.s<0?8:7)),t<1||!m[0])return m.length=0,n?(t-=e.e+1,m[0]=g[(l-t%l)%l],e.e=-t||0):m[0]=e.e=0,e;if(0==a?(m.length=d,h=1,d--):(m.length=d+1,h=g[l-a],m[d]=c>0?o(p/g[i-c]%g[c])*h:0),n)for(;;){if(0==d){for(a=1,c=m[0];c>=10;c/=10,a++);for(c=m[0]+=h,h=1;c>=10;c/=10,h++);a!=h&&(e.e++,m[0]==u&&(m[0]=1));break}if(m[d]+=h,m[d]!=u)break;m[d--]=0,h=1}for(a=m.length;0===m[--a];m.pop());}e.e>K?e.c=e.e=null:e.e<M&&(e.c=[e.e=0])}return e}function Y(e){var t,r=e.e;return null===r?e.toString():(t=m(e.c),t=r<=D||r>=L?_(t,r):E(t,r,"0"),e.s<0?"-"+t:t)}return G.clone=e,G.ROUND_UP=0,G.ROUND_DOWN=1,G.ROUND_CEIL=2,G.ROUND_FLOOR=3,G.ROUND_HALF_UP=4,G.ROUND_HALF_DOWN=5,G.ROUND_HALF_EVEN=6,G.ROUND_HALF_CEIL=7,G.ROUND_HALF_FLOOR=8,G.EUCLID=9,G.config=G.set=function(e){var t,r;if(null!=e){if("object"!=typeof e)throw Error(a+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(y(r=e[t],0,d,t),B=r),e.hasOwnProperty(t="ROUNDING_MODE")&&(y(r=e[t],0,8,t),C=r),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((r=e[t])&&r.pop?(y(r[0],-d,0,t),y(r[1],0,d,t),D=r[0],L=r[1]):(y(r,-d,d,t),D=-(L=r<0?-r:r))),e.hasOwnProperty(t="RANGE"))if((r=e[t])&&r.pop)y(r[0],-d,-1,t),y(r[1],1,d,t),M=r[0],K=r[1];else{if(y(r,-d,d,t),!r)throw Error(a+t+" cannot be zero: "+r);M=-(K=r<0?-r:r)}if(e.hasOwnProperty(t="CRYPTO")){if((r=e[t])!==!!r)throw Error(a+t+" not true or false: "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw j=!r,Error(a+"crypto unavailable");j=r}else j=r}if(e.hasOwnProperty(t="MODULO_MODE")&&(y(r=e[t],0,9,t),U=r),e.hasOwnProperty(t="POW_PRECISION")&&(y(r=e[t],0,d,t),F=r),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(r=e[t]))throw Error(a+t+" not an object: "+r);V=r}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(r=e[t])||/^.$|[+-.\s]|(.).*\1/.test(r))throw Error(a+t+" invalid: "+r);q=r}}return{DECIMAL_PLACES:B,ROUNDING_MODE:C,EXPONENTIAL_AT:[D,L],RANGE:[M,K],CRYPTO:j,MODULO_MODE:U,POW_PRECISION:F,FORMAT:V,ALPHABET:q}},G.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!G.DEBUG)return!0;var t,r,n=e.c,i=e.e,s=e.s;e:if("[object Array]"=={}.toString.call(n)){if((1===s||-1===s)&&i>=-d&&i<=d&&i===o(i)){if(0===n[0]){if(0===i&&1===n.length)return!0;break e}if((t=(i+1)%l)<1&&(t+=l),String(n[0]).length==t){for(t=0;t<n.length;t++)if((r=n[t])<0||r>=u||r!==o(r))break e;if(0!==r)return!0}}}else if(null===n&&null===i&&(null===s||1===s||-1===s))return!0;throw Error(a+"Invalid BigNumber: "+e)},G.maximum=G.max=function(){return z(arguments,P.lt)},G.minimum=G.min=function(){return z(arguments,P.gt)},G.random=(v=9007199254740992,x=Math.random()*v&2097151?function(){return o(Math.random()*v)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,r,n,i,c,u=0,h=[],p=new G(O);if(null==e?e=B:y(e,0,d),i=s(e/l),j)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(i*=2));u<i;)(c=131072*t[u]+(t[u+1]>>>11))>=9e15?(r=crypto.getRandomValues(new Uint32Array(2)),t[u]=r[0],t[u+1]=r[1]):(h.push(c%1e14),u+=2);u=i/2}else{if(!crypto.randomBytes)throw j=!1,Error(a+"crypto unavailable");for(t=crypto.randomBytes(i*=7);u<i;)(c=281474976710656*(31&t[u])+1099511627776*t[u+1]+4294967296*t[u+2]+16777216*t[u+3]+(t[u+4]<<16)+(t[u+5]<<8)+t[u+6])>=9e15?crypto.randomBytes(7).copy(t,u):(h.push(c%1e14),u+=7);u=i/7}if(!j)for(;u<i;)(c=x())<9e15&&(h[u++]=c%1e14);for(i=h[--u],e%=l,i&&e&&(c=f[l-e],h[u]=o(i/c)*c);0===h[u];h.pop(),u--);if(u<0)h=[n=0];else{for(n=-1;0===h[0];h.splice(0,1),n-=l);for(u=1,c=h[0];c>=10;c/=10,u++);u<l&&(n-=l-u)}return p.e=n,p.c=h,p}),G.sum=function(){for(var e=1,t=arguments,r=new G(t[0]);e<t.length;)r=r.plus(t[e++]);return r},S=function(){var e="0123456789";function t(e,t,r,n){for(var i,s,o=[0],a=0,c=e.length;a<c;){for(s=o.length;s--;o[s]*=t);for(o[0]+=n.indexOf(e.charAt(a++)),i=0;i<o.length;i++)o[i]>r-1&&(null==o[i+1]&&(o[i+1]=0),o[i+1]+=o[i]/r|0,o[i]%=r)}return o.reverse()}return function(n,i,s,o,a){var c,u,l,h,f,p,d,b,g=n.indexOf("."),y=B,k=C;for(g>=0&&(h=F,F=0,n=n.replace(".",""),p=(b=new G(i)).pow(n.length-g),F=h,b.c=t(E(m(p.c),p.e,"0"),10,s,e),b.e=b.c.length),l=h=(d=t(n,i,s,a?(c=q,e):(c=e,q))).length;0==d[--h];d.pop());if(!d[0])return c.charAt(0);if(g<0?--l:(p.c=d,p.e=l,p.s=o,d=(p=r(p,b,y,k,s)).c,f=p.r,l=p.e),g=d[u=l+y+1],h=s/2,f=f||u<0||null!=d[u+1],f=k<4?(null!=g||f)&&(0==k||k==(p.s<0?3:2)):g>h||g==h&&(4==k||f||6==k&&1&d[u-1]||k==(p.s<0?8:7)),u<1||!d[0])n=f?E(c.charAt(1),-y,c.charAt(0)):c.charAt(0);else{if(d.length=u,f)for(--s;++d[--u]>s;)d[u]=0,u||(++l,d=[1].concat(d));for(h=d.length;!d[--h];);for(g=0,n="";g<=h;n+=c.charAt(d[g++]));n=E(n,l,c.charAt(0))}return n}}(),r=function(){function e(e,t,r){var n,i,s,o,a=0,c=e.length,u=t%p,l=t/p|0;for(e=e.slice();c--;)a=((i=u*(s=e[c]%p)+(n=l*s+(o=e[c]/p|0)*u)%p*p+a)/r|0)+(n/p|0)+l*o,e[c]=i%r;return a&&(e=[a].concat(e)),e}function t(e,t,r,n){var i,s;if(r!=n)s=r>n?1:-1;else for(i=s=0;i<r;i++)if(e[i]!=t[i]){s=e[i]>t[i]?1:-1;break}return s}function r(e,t,r,n){for(var i=0;r--;)e[r]-=i,i=e[r]<t[r]?1:0,e[r]=i*n+e[r]-t[r];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(n,i,s,a,c){var h,f,p,d,m,g,y,k,_,E,S,w,v,x,I,A,T,R=n.s==i.s?1:-1,N=n.c,P=i.c;if(!(N&&N[0]&&P&&P[0]))return new G(n.s&&i.s&&(N?!P||N[0]!=P[0]:P)?N&&0==N[0]||!P?0*R:R/0:NaN);for(_=(k=new G(R)).c=[],R=s+(f=n.e-i.e)+1,c||(c=u,f=b(n.e/l)-b(i.e/l),R=R/l|0),p=0;P[p]==(N[p]||0);p++);if(P[p]>(N[p]||0)&&f--,R<0)_.push(1),d=!0;else{for(x=N.length,A=P.length,p=0,R+=2,(m=o(c/(P[0]+1)))>1&&(P=e(P,m,c),N=e(N,m,c),A=P.length,x=N.length),v=A,S=(E=N.slice(0,A)).length;S<A;E[S++]=0);T=P.slice(),T=[0].concat(T),I=P[0],P[1]>=c/2&&I++;do{if(m=0,(h=t(P,E,A,S))<0){if(w=E[0],A!=S&&(w=w*c+(E[1]||0)),(m=o(w/I))>1)for(m>=c&&(m=c-1),y=(g=e(P,m,c)).length,S=E.length;1==t(g,E,y,S);)m--,r(g,A<y?T:P,y,c),y=g.length,h=1;else 0==m&&(h=m=1),y=(g=P.slice()).length;if(y<S&&(g=[0].concat(g)),r(E,g,S,c),S=E.length,-1==h)for(;t(P,E,A,S)<1;)m++,r(E,A<S?T:P,S,c),S=E.length}else 0===h&&(m++,E=[0]);_[p++]=m,E[0]?E[S++]=N[v]||0:(E=[N[v]],S=1)}while((v++<x||null!=E[0])&&R--);d=null!=E[0],_[0]||_.splice(0,1)}if(c==u){for(p=1,R=_[0];R>=10;R/=10,p++);W(k,s+(k.e=p+f*l-1)+1,a,d)}else k.e=f,k.r=+d;return k}}(),I=/^(-?)0([xbo])(?=\w[\w.]*$)/i,A=/^([^.]+)\.$/,T=/^\.([^.]+)$/,R=/^-?(Infinity|NaN)$/,N=/^\s*\+(?=[\w.])|^\s+|\s+$/g,w=function(e,t,r,n){var i,s=r?t:t.replace(N,"");if(R.test(s))e.s=isNaN(s)?null:s<0?-1:1;else{if(!r&&(s=s.replace(I,(function(e,t,r){return i="x"==(r=r.toLowerCase())?16:"b"==r?2:8,n&&n!=i?e:t})),n&&(i=n,s=s.replace(A,"$1").replace(T,"0.$1")),t!=s))return new G(s,i);if(G.DEBUG)throw Error(a+"Not a"+(n?" base "+n:"")+" number: "+t);e.s=null}e.c=e.e=null},P.absoluteValue=P.abs=function(){var e=new G(this);return e.s<0&&(e.s=1),e},P.comparedTo=function(e,t){return g(this,new G(e,t))},P.decimalPlaces=P.dp=function(e,t){var r,n,i,s=this;if(null!=e)return y(e,0,d),null==t?t=C:y(t,0,8),W(new G(s),e+s.e+1,t);if(!(r=s.c))return null;if(n=((i=r.length-1)-b(this.e/l))*l,i=r[i])for(;i%10==0;i/=10,n--);return n<0&&(n=0),n},P.dividedBy=P.div=function(e,t){return r(this,new G(e,t),B,C)},P.dividedToIntegerBy=P.idiv=function(e,t){return r(this,new G(e,t),0,1)},P.exponentiatedBy=P.pow=function(e,t){var r,n,i,c,u,h,f,p,d=this;if((e=new G(e)).c&&!e.isInteger())throw Error(a+"Exponent not an integer: "+Y(e));if(null!=t&&(t=new G(t)),u=e.e>14,!d.c||!d.c[0]||1==d.c[0]&&!d.e&&1==d.c.length||!e.c||!e.c[0])return p=new G(Math.pow(+Y(d),u?2-k(e):+Y(e))),t?p.mod(t):p;if(h=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new G(NaN);(n=!h&&d.isInteger()&&t.isInteger())&&(d=d.mod(t))}else{if(e.e>9&&(d.e>0||d.e<-1||(0==d.e?d.c[0]>1||u&&d.c[1]>=24e7:d.c[0]<8e13||u&&d.c[0]<=9999975e7)))return c=d.s<0&&k(e)?-0:0,d.e>-1&&(c=1/c),new G(h?1/c:c);F&&(c=s(F/l+2))}for(u?(r=new G(.5),h&&(e.s=1),f=k(e)):f=(i=Math.abs(+Y(e)))%2,p=new G(O);;){if(f){if(!(p=p.times(d)).c)break;c?p.c.length>c&&(p.c.length=c):n&&(p=p.mod(t))}if(i){if(0===(i=o(i/2)))break;f=i%2}else if(W(e=e.times(r),e.e+1,1),e.e>14)f=k(e);else{if(0===(i=+Y(e)))break;f=i%2}d=d.times(d),c?d.c&&d.c.length>c&&(d.c.length=c):n&&(d=d.mod(t))}return n?p:(h&&(p=O.div(p)),t?p.mod(t):c?W(p,F,C,undefined):p)},P.integerValue=function(e){var t=new G(this);return null==e?e=C:y(e,0,8),W(t,t.e+1,e)},P.isEqualTo=P.eq=function(e,t){return 0===g(this,new G(e,t))},P.isFinite=function(){return!!this.c},P.isGreaterThan=P.gt=function(e,t){return g(this,new G(e,t))>0},P.isGreaterThanOrEqualTo=P.gte=function(e,t){return 1===(t=g(this,new G(e,t)))||0===t},P.isInteger=function(){return!!this.c&&b(this.e/l)>this.c.length-2},P.isLessThan=P.lt=function(e,t){return g(this,new G(e,t))<0},P.isLessThanOrEqualTo=P.lte=function(e,t){return-1===(t=g(this,new G(e,t)))||0===t},P.isNaN=function(){return!this.s},P.isNegative=function(){return this.s<0},P.isPositive=function(){return this.s>0},P.isZero=function(){return!!this.c&&0==this.c[0]},P.minus=function(e,t){var r,n,i,s,o=this,a=o.s;if(t=(e=new G(e,t)).s,!a||!t)return new G(NaN);if(a!=t)return e.s=-t,o.plus(e);var c=o.e/l,h=e.e/l,f=o.c,p=e.c;if(!c||!h){if(!f||!p)return f?(e.s=-t,e):new G(p?o:NaN);if(!f[0]||!p[0])return p[0]?(e.s=-t,e):new G(f[0]?o:3==C?-0:0)}if(c=b(c),h=b(h),f=f.slice(),a=c-h){for((s=a<0)?(a=-a,i=f):(h=c,i=p),i.reverse(),t=a;t--;i.push(0));i.reverse()}else for(n=(s=(a=f.length)<(t=p.length))?a:t,a=t=0;t<n;t++)if(f[t]!=p[t]){s=f[t]<p[t];break}if(s&&(i=f,f=p,p=i,e.s=-e.s),(t=(n=p.length)-(r=f.length))>0)for(;t--;f[r++]=0);for(t=u-1;n>a;){if(f[--n]<p[n]){for(r=n;r&&!f[--r];f[r]=t);--f[r],f[n]+=u}f[n]-=p[n]}for(;0==f[0];f.splice(0,1),--h);return f[0]?$(e,f,h):(e.s=3==C?-1:1,e.c=[e.e=0],e)},P.modulo=P.mod=function(e,t){var n,i,s=this;return e=new G(e,t),!s.c||!e.s||e.c&&!e.c[0]?new G(NaN):!e.c||s.c&&!s.c[0]?new G(s):(9==U?(i=e.s,e.s=1,n=r(s,e,0,3),e.s=i,n.s*=i):n=r(s,e,0,U),(e=s.minus(n.times(e))).c[0]||1!=U||(e.s=s.s),e)},P.multipliedBy=P.times=function(e,t){var r,n,i,s,o,a,c,h,f,d,m,g,y,k,_,E=this,S=E.c,w=(e=new G(e,t)).c;if(!(S&&w&&S[0]&&w[0]))return!E.s||!e.s||S&&!S[0]&&!w||w&&!w[0]&&!S?e.c=e.e=e.s=null:(e.s*=E.s,S&&w?(e.c=[0],e.e=0):e.c=e.e=null),e;for(n=b(E.e/l)+b(e.e/l),e.s*=E.s,(c=S.length)<(d=w.length)&&(y=S,S=w,w=y,i=c,c=d,d=i),i=c+d,y=[];i--;y.push(0));for(k=u,_=p,i=d;--i>=0;){for(r=0,m=w[i]%_,g=w[i]/_|0,s=i+(o=c);s>i;)r=((h=m*(h=S[--o]%_)+(a=g*h+(f=S[o]/_|0)*m)%_*_+y[s]+r)/k|0)+(a/_|0)+g*f,y[s--]=h%k;y[s]=r}return r?++n:y.splice(0,1),$(e,y,n)},P.negated=function(){var e=new G(this);return e.s=-e.s||null,e},P.plus=function(e,t){var r,n=this,i=n.s;if(t=(e=new G(e,t)).s,!i||!t)return new G(NaN);if(i!=t)return e.s=-t,n.minus(e);var s=n.e/l,o=e.e/l,a=n.c,c=e.c;if(!s||!o){if(!a||!c)return new G(i/0);if(!a[0]||!c[0])return c[0]?e:new G(a[0]?n:0*i)}if(s=b(s),o=b(o),a=a.slice(),i=s-o){for(i>0?(o=s,r=c):(i=-i,r=a),r.reverse();i--;r.push(0));r.reverse()}for((i=a.length)-(t=c.length)<0&&(r=c,c=a,a=r,t=i),i=0;t;)i=(a[--t]=a[t]+c[t]+i)/u|0,a[t]=u===a[t]?0:a[t]%u;return i&&(a=[i].concat(a),++o),$(e,a,o)},P.precision=P.sd=function(e,t){var r,n,i,s=this;if(null!=e&&e!==!!e)return y(e,1,d),null==t?t=C:y(t,0,8),W(new G(s),e,t);if(!(r=s.c))return null;if(n=(i=r.length-1)*l+1,i=r[i]){for(;i%10==0;i/=10,n--);for(i=r[0];i>=10;i/=10,n++);}return e&&s.e+1>n&&(n=s.e+1),n},P.shiftedBy=function(e){return y(e,-9007199254740991,h),this.times("1e"+e)},P.squareRoot=P.sqrt=function(){var e,t,n,i,s,o=this,a=o.c,c=o.s,u=o.e,l=B+4,h=new G("0.5");if(1!==c||!a||!a[0])return new G(!c||c<0&&(!a||a[0])?NaN:a?o:1/0);if(0==(c=Math.sqrt(+Y(o)))||c==1/0?(((t=m(a)).length+u)%2==0&&(t+="0"),c=Math.sqrt(+t),u=b((u+1)/2)-(u<0||u%2),n=new G(t=c==1/0?"1e"+u:(t=c.toExponential()).slice(0,t.indexOf("e")+1)+u)):n=new G(c+""),n.c[0])for((c=(u=n.e)+l)<3&&(c=0);;)if(s=n,n=h.times(s.plus(r(o,s,l,1))),m(s.c).slice(0,c)===(t=m(n.c)).slice(0,c)){if(n.e<u&&--c,"9999"!=(t=t.slice(c-3,c+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(W(n,n.e+B+2,1),e=!n.times(n).eq(o));break}if(!i&&(W(s,s.e+B+2,0),s.times(s).eq(o))){n=s;break}l+=4,c+=4,i=1}return W(n,n.e+B+1,C,e)},P.toExponential=function(e,t){return null!=e&&(y(e,0,d),e++),H(this,e,t,1)},P.toFixed=function(e,t){return null!=e&&(y(e,0,d),e=e+this.e+1),H(this,e,t)},P.toFormat=function(e,t,r){var n,i=this;if(null==r)null!=e&&t&&"object"==typeof t?(r=t,t=null):e&&"object"==typeof e?(r=e,e=t=null):r=V;else if("object"!=typeof r)throw Error(a+"Argument not an object: "+r);if(n=i.toFixed(e,t),i.c){var s,o=n.split("."),c=+r.groupSize,u=+r.secondaryGroupSize,l=r.groupSeparator||"",h=o[0],f=o[1],p=i.s<0,d=p?h.slice(1):h,b=d.length;if(u&&(s=c,c=u,u=s,b-=s),c>0&&b>0){for(s=b%c||c,h=d.substr(0,s);s<b;s+=c)h+=l+d.substr(s,c);u>0&&(h+=l+d.slice(s)),p&&(h="-"+h)}n=f?h+(r.decimalSeparator||"")+((u=+r.fractionGroupSize)?f.replace(new RegExp("\\d{"+u+"}\\B","g"),"$&"+(r.fractionGroupSeparator||"")):f):h}return(r.prefix||"")+n+(r.suffix||"")},P.toFraction=function(e){var t,n,i,s,o,c,u,h,p,d,b,g,y=this,k=y.c;if(null!=e&&(!(u=new G(e)).isInteger()&&(u.c||1!==u.s)||u.lt(O)))throw Error(a+"Argument "+(u.isInteger()?"out of range: ":"not an integer: ")+Y(u));if(!k)return new G(y);for(t=new G(O),p=n=new G(O),i=h=new G(O),g=m(k),o=t.e=g.length-y.e-1,t.c[0]=f[(c=o%l)<0?l+c:c],e=!e||u.comparedTo(t)>0?o>0?t:p:u,c=K,K=1/0,u=new G(g),h.c[0]=0;d=r(u,t,0,1),1!=(s=n.plus(d.times(i))).comparedTo(e);)n=i,i=s,p=h.plus(d.times(s=p)),h=s,t=u.minus(d.times(s=t)),u=s;return s=r(e.minus(n),i,0,1),h=h.plus(s.times(p)),n=n.plus(s.times(i)),h.s=p.s=y.s,b=r(p,i,o*=2,C).minus(y).abs().comparedTo(r(h,n,o,C).minus(y).abs())<1?[p,i]:[h,n],K=c,b},P.toNumber=function(){return+Y(this)},P.toPrecision=function(e,t){return null!=e&&y(e,1,d),H(this,e,t,2)},P.toString=function(e){var t,r=this,n=r.s,i=r.e;return null===i?n?(t="Infinity",n<0&&(t="-"+t)):t="NaN":(null==e?t=i<=D||i>=L?_(m(r.c),i):E(m(r.c),i,"0"):10===e?t=E(m((r=W(new G(r),B+i+1,C)).c),r.e,"0"):(y(e,2,q.length,"Base"),t=S(E(m(r.c),i,"0"),10,e,n,!0)),n<0&&r.c[0]&&(t="-"+t)),t},P.valueOf=P.toJSON=function(){return Y(this)},P._isBigNumber=!0,i&&(P[Symbol.toStringTag]="BigNumber",P[Symbol.for("nodejs.util.inspect.custom")]=P.valueOf),null!=t&&G.set(t),G}(),r.default=r.BigNumber=r,"function"==typeof define&&define.amd?define((function(){return r})):void 0!==t&&t.exports?t.exports=r:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=r)}(this)}}},{package:"3box>ipfs>libp2p>libp2p-switch>bignumber.js"}],[4967,{"class-is":2171,debug:2304,events:2133},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("events").EventEmitter,i=e("debug"),s=e("class-is");t.exports=s(class extends n{constructor({_switch:e,name:t}){super(),this.switch=e,this.ourPeerInfo=this.switch._peerInfo,this.log=i(`libp2p:conn:${t}`),this.log.error=i(`libp2p:conn:${t}:error`)}close(e){"DISCONNECTING"!==this._state._state&&(this.log("closing connection to %s",this.theirB58Id),e&&this._events.error&&this.emit("error",e),this._state("disconnect"))}emit(e,...t){"error"!==e||this._events.error?super.emit(e,...t):this.log.error(...t)}getState(){return this._state._state}encrypt(){this._state("encrypt")}protect(){this._state("privatize")}upgrade(){this._state("upgrade")}_onDisconnected(){this.switch.connection.remove(this),this.log("disconnected from %s",this.theirB58Id),this.emit("close"),this.removeAllListeners()}_onPrivatized(){this.emit("private",this.conn)}_onPrivatizing(){if(!this.switch.protector)return this._state("done");this.conn=this.switch.protector.protect(this.conn,(e=>{if(e)return this.close(e);this.log("successfully privatized conn to %s",this.theirB58Id),this.conn.setPeerInfo(this.theirPeerInfo),this._state("done")}))}},{className:"BaseConnection",symbolName:"libp2p-switch/BaseConnection"})}}},{package:"3box>ipfs>libp2p>libp2p-switch"}],[4968,{"../observe-connection":4981,"./incoming":4969,debug:2304},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("debug"),i=e("./incoming"),s=e("../observe-connection");t.exports=function(e){const t=n("libp2p:switch:listener");return function(r,n){return function(o){t("received incoming connection for transport %s",r),o.getPeerInfo(((a,c)=>{const u=r?s(r,null,o,e.observer):o,l=new i({connection:u,_switch:e,transportKey:r,peerInfo:c});l.once("error",(e=>t(e))),l.once("private",(e=>{if(n)return n(e);l.encrypt()})),l.once("encrypted",(()=>l.upgrade())),l.protect()}))}}}}}},{package:"3box>ipfs>libp2p>libp2p-switch"}],[4969,{"./base":4967,"class-is":2171,"fsm-event":4346,"multistream-select":5259},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("fsm-event"),i=e("multistream-select"),s=e("class-is"),o=e("./base");t.exports=s(class extends o{constructor({connection:e,_switch:t,transportKey:r,peerInfo:s}){super({_switch:t,name:`inc:${t._peerInfo.id.toB58String().slice(0,8)}`}),this.conn=e,this.theirPeerInfo=s||null,this.theirB58Id=this.theirPeerInfo?this.theirPeerInfo.id.toB58String():null,this.ourPeerInfo=this.switch._peerInfo,this.transportKey=r,this.protocolMuxer=this.switch.protocolMuxer(this.transportKey),this.msListener=new i.Listener,this._state=n("DIALED",{DISCONNECTED:{disconnect:"DISCONNECTED"},DIALED:{privatize:"PRIVATIZING",encrypt:"ENCRYPTING"},PRIVATIZING:{done:"PRIVATIZED",disconnect:"DISCONNECTING"},PRIVATIZED:{encrypt:"ENCRYPTING"},ENCRYPTING:{done:"ENCRYPTED",disconnect:"DISCONNECTING"},ENCRYPTED:{upgrade:"UPGRADING",disconnect:"DISCONNECTING"},UPGRADING:{done:"MUXED"},MUXED:{disconnect:"DISCONNECTING"},DISCONNECTING:{done:"DISCONNECTED"}}),this._state.on("DISCONNECTED",(()=>this._onDisconnected())),this._state.on("PRIVATIZING",(()=>this._onPrivatizing())),this._state.on("PRIVATIZED",(()=>this._onPrivatized())),this._state.on("ENCRYPTING",(()=>this._onEncrypting())),this._state.on("ENCRYPTED",(()=>{this.log("successfully encrypted connection to %s",this.theirB58Id||"unknown peer"),this.emit("encrypted",this.conn)})),this._state.on("UPGRADING",(()=>this._onUpgrading())),this._state.on("MUXED",(()=>{this.log("successfully muxed connection to %s",this.theirB58Id||"unknown peer"),this.emit("muxed",this.conn)})),this._state.on("DISCONNECTING",(()=>{this._state("done")}))}_onEncrypting(){this.log("encrypting connection via %s",this.switch.crypto.tag),this.msListener.addHandler(this.switch.crypto.tag,((e,t)=>{this.conn=this.switch.crypto.encrypt(this.ourPeerInfo.id,t,undefined,(e=>{if(e)return this.close(e);this.conn.getPeerInfo(((e,t)=>{this.theirPeerInfo=t,this._state("done")}))}))}),null),this.msListener.handle(this.conn,(e=>{e&&this.emit("crypto handshaking failed",e)}))}_onUpgrading(){this.log("adding the protocol muxer to the connection"),this.protocolMuxer(this.conn,this.msListener),this._state("done")}},{className:"IncomingConnectionFSM",symbolName:"libp2p-switch/IncomingConnectionFSM"})}}},{package:"3box>ipfs>libp2p>libp2p-switch"}],[4970,{"../errors":4976,"../observe-connection":4981,"../utils":4989,"./base":4967,"async/nextTick":1872,"async/parallel":1873,"class-is":2171,"err-code":2406,"fsm-event":4346,"libp2p-circuit":4845,"libp2p-identify":4885,"multistream-select":5259},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("fsm-event"),i=e("libp2p-circuit"),s=e("multistream-select"),o=e("class-is"),a=e("./base"),c=e("async/parallel"),u=e("async/nextTick"),l=e("libp2p-identify"),h=e("err-code"),{msHandle:f,msSelect:p,identifyDialer:d}=e("../utils"),b=e("../observe-connection"),{CONNECTION_FAILED:m,DIAL_SELF:g,INVALID_STATE_TRANSITION:y,NO_TRANSPORTS_REGISTERED:k,maybeUnexpectedEnd:_}=e("../errors");t.exports=o(class extends a{constructor({_switch:e,peerInfo:t,muxer:r,conn:i,type:s="out"}){super({_switch:e,name:`${s}:${e._peerInfo.id.toB58String().slice(0,8)}`}),this.theirPeerInfo=t,this.theirB58Id=this.theirPeerInfo.id.toB58String(),this.conn=i,this.muxer=r;let o="DISCONNECTED";this.muxer&&(o="MUXED"),this._state=n(o,{DISCONNECTED:{dial:"DIALING",disconnect:"DISCONNECTED",done:"DISCONNECTED"},DIALING:{abort:"ABORTED",done:"DIALED",error:"ERRORED",disconnect:"DISCONNECTING"},DIALED:{encrypt:"ENCRYPTING",privatize:"PRIVATIZING"},PRIVATIZING:{done:"PRIVATIZED",abort:"ABORTED",disconnect:"DISCONNECTING"},PRIVATIZED:{encrypt:"ENCRYPTING"},ENCRYPTING:{done:"ENCRYPTED",error:"ERRORED",disconnect:"DISCONNECTING"},ENCRYPTED:{upgrade:"UPGRADING",disconnect:"DISCONNECTING"},UPGRADING:{stop:"CONNECTED",done:"MUXED",error:"ERRORED",disconnect:"DISCONNECTING"},MUXED:{disconnect:"DISCONNECTING"},CONNECTED:{disconnect:"DISCONNECTING"},DISCONNECTING:{done:"DISCONNECTED",disconnect:"DISCONNECTING"},ABORTED:{},ERRORED:{disconnect:"DISCONNECTING"}}),this._state.on("DISCONNECTED",(()=>this._onDisconnected())),this._state.on("DIALING",(()=>this._onDialing())),this._state.on("DIALED",(()=>this._onDialed())),this._state.on("PRIVATIZING",(()=>this._onPrivatizing())),this._state.on("PRIVATIZED",(()=>this._onPrivatized())),this._state.on("ENCRYPTING",(()=>this._onEncrypting())),this._state.on("ENCRYPTED",(()=>{this.log("successfully encrypted connection to %s",this.theirB58Id),this.emit("encrypted",this.conn)})),this._state.on("UPGRADING",(()=>this._onUpgrading())),this._state.on("MUXED",(()=>{this.log("successfully muxed connection to %s",this.theirB58Id),delete this.switch.conns[this.theirB58Id],this.emit("muxed",this.muxer)})),this._state.on("CONNECTED",(()=>{this.log("unmuxed connection opened to %s",this.theirB58Id),this.emit("unmuxed",this.conn)})),this._state.on("DISCONNECTING",(()=>this._onDisconnecting())),this._state.on("ABORTED",(()=>this._onAborted())),this._state.on("ERRORED",(()=>this._onErrored())),this._state.on("error",(e=>this._onStateError(e)))}dial(){return this.theirB58Id===this.ourPeerInfo.id.toB58String()?this.emit("error",g()):"DIALING"===this.getState()?this.log("attempted to dial while already dialing, ignoring"):void this._state("dial")}shake(e,t){return e?this.muxer&&this.muxer.newStream?this.muxer.newStream(((r,n)=>{if(r)return t(r,null);this.log("created new stream to %s",this.theirB58Id),this._protocolHandshake(e,n,t)})):void this._protocolHandshake(e,this.conn,t):t(null,null)}upgrade(){this._state("upgrade")}_onDialing(){if(this.log("dialing %s",this.theirB58Id),!this.switch.hasTransports())return this.close(k());const e=this.switch.availableTransports(this.theirPeerInfo),t=Boolean(this.switch.transports[i.tag]);t&&!e.includes(i.tag)&&e.push(i.tag);const r=n=>{let s=n;if(!s)return t?this.close(m(`No available transports to dial peer ${this.theirB58Id}!`)):this.close(m(`Circuit not enabled and all transports failed to dial peer ${this.theirB58Id}!`));s===i.tag&&this.theirPeerInfo.multiaddrs.add(`/p2p-circuit/p2p/${this.theirB58Id}`),this.log("dialing transport %s",s),this.switch.transport.dial(s,this.theirPeerInfo,((t,n)=>{if(t)return this.emit("error:connection_attempt_failed",t),this.log(t),r(e.shift());this.conn=b(s,null,n,this.switch.observer),this._state("done")}))};r(e.shift())}_onDialed(){this.log("successfully dialed %s",this.theirB58Id),this.emit("connected",this.conn)}_onDisconnecting(){this.log("disconnecting from %s",this.theirB58Id,Boolean(this.muxer)),delete this.switch.conns[this.theirB58Id];let e=[];if(this.muxer&&e.push((e=>{this.muxer.end((()=>{delete this.muxer,e()}))})),this.conn){try{this.conn.source.abort()}catch(e){}delete this.conn}c(e,(()=>{this._state("done")}))}_onEncrypting(){const e=new s.Dialer;e.handle(this.conn,(t=>{if(t)return this.close(_(t));this.log("selecting crypto %s to %s",this.switch.crypto.tag,this.theirB58Id),e.select(this.switch.crypto.tag,((e,t)=>{if(e)return this.close(_(e));const r=b(null,this.switch.crypto.tag,t,this.switch.observer),n=this.switch.crypto.encrypt(this.ourPeerInfo.id,r,this.theirPeerInfo.id,(e=>{if(e)return this.close(e);this.conn=n,this.conn.setPeerInfo(this.theirPeerInfo),this._state("done")}))}))}))}_onUpgrading(){const e=Object.keys(this.switch.muxers);if(this.log("upgrading connection to %s",this.theirB58Id),0===e.length)return this._state("stop");const t=new s.Dialer;t.handle(this.conn,(r=>{if(r)return this._didUpgrade(r);const n=r=>{this.log("selecting %s",r),t.select(r,((t,i)=>{if(t)return 0===e.length?this._didUpgrade(t):n(e.shift());const s=b(null,r,i,this.switch.observer);this.muxer=this.switch.muxers[r].dialer(s),this.muxer.once("close",(()=>{this.close()})),this.muxer.on("stream",(e=>{this.log("new stream created via muxer to %s",this.theirB58Id),e.setPeerInfo(this.theirPeerInfo),this.switch.protocolMuxer(null)(e)})),this._didUpgrade(null),this.switch.identify&&this._identify(((e,t)=>{if(e)return this.close(e);this.theirPeerInfo=this.switch._peerBook.put(t.peerInfo)}))}))};n(e.shift())}))}_identify(e){if(!this.muxer)return u(e,h("The connection was already closed","ERR_CONNECTION_CLOSED"));this.muxer.newStream((async(t,r)=>{if(t)return e(t);const n=new s.Dialer;let i;try{await f(n,r);const e=await p(n,l.multicodec);i=await d(e,this.theirPeerInfo)}catch(t){return e(t)}e(null,i)}))}_didUpgrade(e){if(e)return this.log("Error upgrading connection:",e),this.switch.conns[this.theirB58Id]=this,this.emit("error:upgrade_failed",e),this._state("stop");this._state("done")}_protocolHandshake(e,t,r){const n=new s.Dialer;n.handle(t,(t=>{if(t)return r(t,null);n.select(e,((t,n)=>{if(t)return this.log("could not perform protocol handshake:",t),r(t,null);const i=b(null,e,n,this.switch.observer);this.log("successfully performed handshake of %s to %s",e,this.theirB58Id),this.emit("connection",i),r(null,i)}))}))}_onStateError(e){this.emit("error",y(e)),this.log(e)}},{className:"ConnectionFSM",symbolName:"libp2p-switch/ConnectionFSM"})}}},{package:"3box>ipfs>libp2p>libp2p-switch"}],[4971,{"../connection":4970,"../plaintext":4983,"../utils":4989,debug:2304,"libp2p-circuit":4845,"libp2p-identify":4885,"multistream-select":5259,once:5323},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("libp2p-identify"),i=e("multistream-select"),s=e("debug")("libp2p:switch:conn-manager"),o=e("once"),a=e("../connection"),{msHandle:c,msSelect:u,identifyDialer:l}=e("../utils"),h=e("libp2p-circuit"),f=e("../plaintext");t.exports=class{constructor(e){this.switch=e,this.connections={}}add(e){this.connections[e.theirB58Id]=this.connections[e.theirB58Id]||[],this.get(e)||(this.connections[e.theirB58Id].push(e),this.switch.emit("connection:start",e.theirPeerInfo),"MUXED"===e.getState()?(this.switch.emit("peer-mux-established",e.theirPeerInfo),this.switch.dialer.clearBlacklist(e.theirPeerInfo)):e.once("muxed",(()=>{this.switch.emit("peer-mux-established",e.theirPeerInfo),this.switch.dialer.clearBlacklist(e.theirPeerInfo)})))}get(e){if(!this.connections[e.theirB58Id])return null;for(let t=0;t<this.connections[e.theirB58Id].length;t++)if(this.connections[e.theirB58Id][t]===e)return this.connections[e.theirB58Id][t];return null}getOne(e){if(this.connections[e])for(var t=0;t<this.connections[e].length;t++)if("MUXED"===this.connections[e][t].getState())return this.connections[e][t];return null}remove(e){if(this.connections[e.theirB58Id]){for(let t=0;t<this.connections[e.theirB58Id].length;t++)if(this.connections[e.theirB58Id][t]===e){this.connections[e.theirB58Id].splice(t,1);break}0===this.connections[e.theirB58Id].length&&(delete this.connections[e.theirB58Id],e.theirPeerInfo.disconnect(),this.switch.emit("peer-mux-closed",e.theirPeerInfo)),this.switch.emit("connection:end",e.theirPeerInfo)}else e.theirPeerInfo&&(e.theirPeerInfo.disconnect(),this.switch.emit("peer-mux-closed",e.theirPeerInfo))}getAll(){let e=[];for(const t of Object.values(this.connections))e=[...e,...t];return e}getAllById(e){return this.connections[e]||[]}addStreamMuxer(e){this.switch.muxers[e.multicodec]=e,this.switch.handle(e.multicodec,((t,r)=>{const h=e.listener(r);return h.on("stream",this.switch.protocolMuxer(null)),this.switch.identify&&r.getPeerInfo(((e,t)=>{!e&&t||s("crypto peerInfo wasnt found"),r.getPeerInfo=async e=>{const r=h.newStream(),s=new i.Dialer;let a;e=o(e);try{await c(s,r);const e=await u(s,n.multicodec);a=await l(e,t)}catch(t){return h.end((()=>{e(t,null)}))}const{peerInfo:f}=a;f&&r.setPeerInfo(f),e(null,f)},r.getPeerInfo(((e,t)=>{if(e)return s("identify not successful");const n=t.id.toB58String();t=this.switch._peerBook.put(t);const i=new a({_switch:this.switch,peerInfo:t,muxer:h,conn:r,type:"inc"});this.switch.connection.add(i),t.isConnected()||(t.multiaddrs.size>0?t.connect(t.multiaddrs.toArray()[0]):t.connect(`/ipfs/${n}`)),h.once("close",(()=>{i.close()}))}))})),r}))}crypto(e,t){e||t||(e=f.tag,t=f.encrypt),this.switch.crypto={tag:e,encrypt:t}}enableCircuitRelay(e){(e=e||{}).enabled&&(e.hop||Object.assign(e,{hop:{enabled:!1,active:!1}}),this.switch.transport.add(h.tag,new h(this.switch,e)))}reuse(){this.switch.identify=!0,this.switch.handle(n.multicodec,((e,t)=>{n.listener(t,this.switch._peerInfo)}))}}}}},{package:"3box>ipfs>libp2p>libp2p-switch"}],[4972,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={BLACK_LIST_TTL:3e5,BLACK_LIST_ATTEMPTS:5,DIAL_TIMEOUT:3e4,MAX_COLD_CALLS:50,MAX_PARALLEL_DIALS:100,QUARTER_HOUR:9e5,PRIORITY_HIGH:10,PRIORITY_LOW:20}}}},{package:"3box>ipfs>libp2p>libp2p-switch"}],[4973,{"../constants":4972,"../get-peer-info":4977,"./queueManager":4975},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("./queueManager"),i=e("../get-peer-info"),{BLACK_LIST_ATTEMPTS:s,BLACK_LIST_TTL:o,MAX_COLD_CALLS:a,MAX_PARALLEL_DIALS:c,PRIORITY_HIGH:u,PRIORITY_LOW:l}=e("../constants");t.exports=function(e){const t=new n(e);function r({peerInfo:r,protocol:n,options:s,callback:o}){"function"==typeof n&&(o=n,n=null);try{r=i(r,e._peerBook)}catch(e){return o(e)}t.add({peerInfo:r,protocol:n,options:s,callback:o})}return e.state.on("STARTED:enter",(function(e){t.start(),e()})),e.state.on("STOPPING:enter",(function(e){t.stop(),e()})),{connect:function(e,t,n){"function"==typeof t&&(n=t,t=null),r({peerInfo:e,protocol:null,options:t={useFSM:!1,priority:l,...t},callback:n})},dial:function(e,t,n){r({peerInfo:e,protocol:t,options:{useFSM:!1,priority:u},callback:n})},dialFSM:function(e,t,n){r({peerInfo:e,protocol:t,options:{useFSM:!0,priority:u},callback:n})},clearBlacklist:function(e){t.clearBlacklist(e)},BLACK_LIST_ATTEMPTS:isNaN(e._options.blackListAttempts)?s:e._options.blackListAttempts,BLACK_LIST_TTL:isNaN(e._options.blacklistTTL)?o:e._options.blacklistTTL,MAX_COLD_CALLS:isNaN(e._options.maxColdCalls)?a:e._options.maxColdCalls,MAX_PARALLEL_DIALS:isNaN(e._options.maxParallelDials)?c:e._options.maxParallelDials}}}}},{package:"3box>ipfs>libp2p>libp2p-switch"}],[4974,{"../connection":4970,"../errors":4976,"async/nextTick":1872,debug:2304,once:5323},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("../connection"),{DIAL_ABORTED:i,ERR_BLACKLISTED:s}=e("../errors"),o=e("async/nextTick"),a=e("once"),c=e("debug"),u=c("libp2p:switch:dial");function l({protocol:e,connection:t,callback:r}){if(!e)return r();t.shake(e,((e,n)=>{if(!n)return r(e);n.setPeerInfo(t.theirPeerInfo),r(null,n)}))}u.error=c("libp2p:switch:dial:error");t.exports=class{constructor(e,t,r){this.id=e,this.switch=t,this._queue=[],this.blackListed=null,this.blackListCount=0,this.isRunning=!1,this.onStopped=r}get length(){return this._queue.length}add(e,t,r){if(!this.isDialAllowed())return o(r,s());this._queue.push({protocol:e,useFSM:t,callback:r})}isDialAllowed(){return!this.blackListed||Date.now()>this.blackListed&&(this.blackListed=null,!0)}start(){return!this.isRunning&&(u("starting dial queue to %s",this.id),this.isRunning=!0,this._run(),!0)}stop(){this.isRunning&&(u("stopping dial queue to %s",this.id),this.isRunning=!1,this.onStopped(this.id))}abort(){for(;this.length>0;){this._queue.shift().callback(i())}this.stop()}blacklist(){if(this.blackListCount++,this.blackListCount>=this.switch.dialer.BLACK_LIST_ATTEMPTS)return void(this.blackListed=Infinity);let e=this.switch.dialer.BLACK_LIST_TTL*Math.pow(this.blackListCount,3);const t=.9*e,r=1.1*e;e=Math.floor(Math.random()*(r-t)+t),this.blackListed=Date.now()+e,this.abort()}_getOrCreateConnection(e){let t=this.switch.connection.getOne(this.id),r=!1;return t||(t=new n({_switch:this.switch,peerInfo:e,muxer:null,conn:null}),this.switch.connection.add(t),t.once("connected",(()=>t.protect())),t.once("private",(()=>t.encrypt())),t.once("encrypted",(()=>t.upgrade())),r=!0),{connectionFSM:t,didCreate:r}}_run(){if(this.length<1||!this.isRunning)return u("stopping the queue for %s",this.id),this.stop();const e=a((()=>{u("starting next dial to %s",this.id),this._run()})),t=this.switch._peerBook.get(this.id);let r=this._queue.shift(),{connectionFSM:n,didCreate:i}=this._getOrCreateConnection(t);if(r.useFSM&&o(r.callback,null,n),["MUXED","CONNECTED"].includes(n.getState()))return r.connection=n,l(r),void e();n.once("error",(e=>{r.callback(e),t.protocols.size>0&&t.isConnected()||this.blacklist()})),n.once("close",(()=>{e()})),n.once("muxed",(()=>{this.blackListCount=0,r.connection=n,l(r),e()})),n.once("unmuxed",(()=>{this.blackListCount=0,r.connection=n,l(r),e()})),i&&n.dial()}}}}},{package:"3box>ipfs>libp2p>libp2p-switch"}],[4975,{"../constants":4972,"../errors":4976,"./queue":4974,"async/nextTick":1872,debug:2304,once:5323,retimer:5743},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("once"),i=e("./queue"),{DIAL_ABORTED:s}=e("../errors"),o=e("async/nextTick"),a=e("retimer"),{QUARTER_HOUR:c,PRIORITY_HIGH:u}=e("../constants"),l=e("debug")("libp2p:switch:dial:manager"),h=()=>{};t.exports=class{constructor(e){this._queue=new Set,this._coldCallQueue=new Set,this._dialingQueues=new Set,this._queues={},this.switch=e,this._cleanInterval=a(this._clean.bind(this),c),this.start()}_clean(){Object.values(this._queues).forEach((e=>{if(e.blackListed===Infinity)return e.abort(),void delete this._queues[e.id];if(!e.blackListed&&!e.isRunning&&e.length<1){let t=!1;try{const r=this.switch._peerBook.get(e.id);t=Boolean(r.isConnected())}catch(e){}t||(e.abort(),delete this._queues[e.id])}})),this._cleanInterval.reschedule(c)}start(){this.isRunning=!0}stop(){this.isRunning=!1,this._queue.clear(),this._coldCallQueue.clear(),this._cleanInterval.clear();Object.values(this._queues).forEach((e=>{e.abort(),delete this._queues[e.id]}))}add({peerInfo:e,protocol:t,options:r,callback:i}){i=i?n(i):h;const a=this.getQueue(e);if(r.priority>u){if(this._coldCallQueue.size>=this.switch.dialer.MAX_COLD_CALLS)return o(i,s());if(this._queue.has(a.id))return o(i,s())}a.add(t,r.useFSM,i),e.isConnected()?a.start():a.isDialAllowed()&&(a.isRunning||(r.priority<=u?(this._queue.add(a.id),this._coldCallQueue.delete(a.id)):this._coldCallQueue.add(a.id)),this.run())}run(){if(this.isRunning&&this._dialingQueues.size<this.switch.dialer.MAX_PARALLEL_DIALS){let e={done:!0};if(this._queue.size>0?(e=this._queue.values().next(),this._queue.delete(e.value)):this._coldCallQueue.size>0&&(e=this._coldCallQueue.values().next(),this._coldCallQueue.delete(e.value)),e.done)return;let t=this._queues[e.value];if(!t)return void l("missing queue %s, maybe it was aborted?",e.value);this._dialingQueues.add(t.id),t.start()}}clearBlacklist(e){const t=this.getQueue(e);t.blackListed=null,t.blackListCount=0}_onQueueStopped(e){this._dialingQueues.delete(e),this.run()}getQueue(e){const t=e.id.toB58String();return this._queues[t]=this._queues[t]||new i(t,this.switch,this._onQueueStopped.bind(this)),this._queues[t]}}}}},{package:"3box>ipfs>libp2p>libp2p-switch"}],[4976,{"err-code":2406},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("err-code");t.exports={CONNECTION_FAILED:e=>n(e,"CONNECTION_FAILED"),DIAL_ABORTED:()=>n("Dial was aborted","DIAL_ABORTED"),ERR_BLACKLISTED:()=>n("Dial is currently blacklisted for this peer","ERR_BLACKLISTED"),DIAL_SELF:()=>n("A node cannot dial itself","DIAL_SELF"),INVALID_STATE_TRANSITION:e=>n(e,"INVALID_STATE_TRANSITION"),NO_TRANSPORTS_REGISTERED:()=>n("No transports registered, dial not possible","NO_TRANSPORTS_REGISTERED"),PROTECTOR_REQUIRED:()=>n("No protector provided with private network enforced","PROTECTOR_REQUIRED"),UNEXPECTED_END:()=>n("Unexpected end of input from reader.","UNEXPECTED_END"),maybeUnexpectedEnd:e=>!0===e?t.exports.UNEXPECTED_END():e}}}},{package:"3box>ipfs>libp2p>libp2p-switch"}],[4977,{multiaddr:5224,"peer-id":5420,"peer-info":5421},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("peer-id"),i=e("peer-info"),s=e("multiaddr");t.exports=function(e,t){let r;if(i.isPeerInfo(e))return t.put(e);if(s.isMultiaddr(e)){const s=e.getPeerId();try{r=t.get(s)}catch(e){r=new i(n.createFromB58String(s))}return r.multiaddrs.add(e),r}if(n.isPeerId(e)){const r=e.toB58String();try{return t.get(r)}catch(e){throw new Error(`Couldnt get PeerInfo for ${r}`)}}throw new Error("peer type not recognized")}}}},{package:"3box>ipfs>libp2p>libp2p-switch"}],[4978,{"./connection/handler":4968,"./connection/manager":4971,"./dialer":4973,"./errors":4976,"./get-peer-info":4977,"./observer":4982,"./plaintext":4983,"./protocol-muxer":4984,"./stats":4985,"./transport":4988,assert:1805,"async/each":1838,"async/eachSeries":1843,"async/series":1877,debug:2304,events:2133,"fsm-event":4346,"libp2p-circuit":4845},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("fsm-event"),i=e("events").EventEmitter,s=e("async/each"),o=e("async/eachSeries"),a=e("async/series"),c=e("libp2p-circuit"),u=e("./transport"),l=e("./connection/manager"),h=e("./get-peer-info"),f=e("./dialer"),p=e("./connection/handler"),d=e("./protocol-muxer"),b=e("./plaintext"),m=e("./observer"),g=e("./stats"),y=e("assert"),k=e("./errors"),_=e("debug"),E=_("libp2p:switch");E.error=_("libp2p:switch:error");t.exports=class extends i{constructor(e,t,r){super(),y(e,"You must provide a `peerInfo`"),y(t,"You must provide a `peerBook`"),this._peerInfo=e,this._peerBook=t,this._options=r||{},this.setMaxListeners(Infinity),this.transports={},this.conns={},this.protocols={},this.muxers={},this.identify=!1,this.crypto=b,this.protector=this._options.protector||null,this.transport=new u(this),this.connection=new l(this),this.observer=m(this),this.stats=g(this.observer,this._options.stats),this.protocolMuxer=d(this.protocols,this.observer),this._connectionHandler=p(this),this.state=new n("STOPPED",{STOPPED:{start:"STARTING",stop:"STOPPING"},STARTING:{done:"STARTED",stop:"STOPPING"},STARTED:{stop:"STOPPING",start:"STARTED"},STOPPING:{stop:"STOPPING",done:"STOPPED"}}),this.state.on("STARTING",(()=>{E("The switch is starting"),this._onStarting()})),this.state.on("STOPPING",(()=>{E("The switch is stopping"),this._onStopping()})),this.state.on("STARTED",(()=>{E("The switch has started"),this.emit("start")})),this.state.on("STOPPED",(()=>{E("The switch has stopped"),this.emit("stop")})),this.state.on("error",(e=>{E.error(e),this.emit("error",e)})),this.dialer=f(this),this.dial=this.dialer.dial,this.dialFSM=this.dialer.dialFSM}availableTransports(e){const t=e.multiaddrs.toArray();return Object.keys(this.transports).filter((e=>this.transports[e].filter(t).length>0)).sort(((e,t)=>e===c.tag?1:t===c.tag||e<t?-1:1))}handle(e,t,r){this.protocols[e]={handlerFunc:t,matchFunc:r},this._peerInfo.protocols.add(e)}unhandle(e){this.protocols[e]&&delete this.protocols[e],this._peerInfo.protocols.delete(e)}hangUp(e,t){const r=h(e,this._peerBook).id.toB58String(),n=[...this.connection.getAllById(r)];s(n,((e,t)=>{e.once("close",t),e.close()}),t)}hasTransports(){const e=Object.keys(this.transports).filter((e=>e!==c.tag));return e&&e.length>0}start(e=(()=>{})){this.once("start",e),this.state("start")}stop(e=(()=>{})){this.once("stop",e),this.state("stop")}_onStarting(){this.stats.start(),o(this.availableTransports(this._peerInfo),((e,t)=>{this.transport.listen(e,{},null,t)}),(e=>{if(e)return E.error(e),this.emit("error",e),this.state("stop");this.state("done")}))}_onStopping(){this.stats.stop(),a([e=>{s(this.transports,((e,t)=>{s(e.listeners,((e,t)=>{e.close((e=>{e&&E.error(e),t()}))}),t)}),e)},e=>s(this.connection.getAll(),((e,t)=>{e.once("close",t),e.close()}),e)],(e=>{this.state("done")}))}},t.exports.errors=k}}},{package:"3box>ipfs>libp2p>libp2p-switch"}],[4979,{"./queue":4980,"async/tryEach":1883,debug:2304},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("async/tryEach"),i=e("debug")("libp2p:switch:dialer"),s=e("./queue");t.exports=class{constructor(e,t){i("create: %s peer limit, %s dial timeout",e,t),this.perPeerLimit=e,this.dialTimeout=t,this.queues=new Map}dialMany(e,t,r,s){i("dialMany:start");const o={cancel:!1};let a=[];const c=r.map((r=>n=>this.dialSingle(e,t,r,o,((e,t)=>e?(a.push(e),n(e)):n(null,t)))));n(c,((e,t)=>{if(t&&t.conn)return i("dialMany:success"),s(null,t);i("dialMany:error"),s(a)}))}dialSingle(e,t,r,n,o){const a=e.toB58String();let c;i("dialSingle: %s:%s",a,r.toString()),this.queues.has(a)?c=this.queues.get(a):(c=new s(this.perPeerLimit,this.dialTimeout),this.queues.set(a,c)),c.push(t,r,n,o)}}}}},{package:"3box>ipfs>libp2p>libp2p-switch"}],[4980,{"async/queue":1874,"async/timeout":1882,debug:2304,"interface-connection":4455,once:5323,"pull-stream/pull":5488,"pull-stream/sources/empty":5498},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("interface-connection").Connection,i=e("pull-stream/pull"),s=e("pull-stream/sources/empty"),o=e("async/timeout"),a=e("async/queue"),c=e("debug"),u=e("once"),l=c("libp2p:switch:dialer:queue");l.error=c("libp2p:switch:dialer:queue:error");t.exports=class{constructor(e,t){this.dialTimeout=t,this.queue=a(((e,t)=>{this._doWork(e.transport,e.addr,e.token,t)}),e)}_doWork(e,t,r,o){o=u(o),l("work:start"),this._dialWithTimeout(e,t,((a,c)=>{if(a)return l.error(`${e.constructor.name}:work`,a),o(a);if(r.cancel)return l("work:cancel"),i(s(),c),"function"==typeof c.close?c.close((e=>o(null))):o(null);r.cancel=!0,l("work:success");(new n).setInnerConn(c),o(null,{multiaddr:t,conn:c})}))}_dialWithTimeout(e,t,r){o((r=>{const n=e.dial(t,(e=>{if(e)return r(e);r(null,n)}))}),this.dialTimeout)(r)}push(e,t,r,n){this.queue.push({transport:e,addr:t,token:r},n)}}}}},{package:"3box>ipfs>libp2p>libp2p-switch"}],[4981,{"interface-connection":4455,"pull-stream/pull":5488},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("interface-connection").Connection,i=e("pull-stream/pull");t.exports=(e,t,r,s)=>{const o=new Promise(((e,t)=>{r.getPeerInfo(((t,n)=>{if(!t&&n)return void e(n);const i=r.setPeerInfo;r.setPeerInfo=t=>{i.call(r,t),e(t)}}))})),a={source:i(r,s.incoming(e,t,o)),sink:i(s.outgoing(e,t,o),r)};return new n(a,r)}}}},{package:"3box>ipfs>libp2p>libp2p-switch"}],[4982,{events:2133,"pull-stream/throughs/map":5510},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("pull-stream/throughs/map"),i=e("events");t.exports=e=>{const t=Object.assign(new i,{incoming:r("in"),outgoing:r("out")});return e.on("peer-mux-established",(e=>{t.emit("peer:connected",e.id.toB58String())})),e.on("peer-mux-closed",(e=>{t.emit("peer:closed",e.id.toB58String())})),t;function r(e){return(r,i,s)=>n((n=>(function(e,r,n,i,s){e.then((e=>{if(e){const o=e.id.toB58String();t.emit("message",o,r,n,i,s)}}))}(s,r,i,e,n.length),n)))}}}}},{package:"3box>ipfs>libp2p>libp2p-switch"}],[4983,{"async/setImmediate":1878},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("async/setImmediate");t.exports={tag:"/plaintext/1.0.0",encrypt:(e,t,r,i)=>("function"==typeof r&&(i=r,r=undefined),n((()=>i())),t)}}}},{package:"3box>ipfs>libp2p>libp2p-switch"}],[4984,{"./observe-connection":4981,debug:2304,"multistream-select":5259},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("multistream-select"),i=e("./observe-connection"),s=e("debug"),o=s("libp2p:switch:protocol-muxer");o.error=s("libp2p:switch:protocol-muxer:error"),t.exports=function(e,t){return r=>(s,a)=>{const c=a||new n.Listener;let u;u=r&&!a?i(r,null,s,t):s,Object.keys(e).forEach((r=>{if(!r)return;c.addHandler(r,((r,n)=>{o("registering handler with protocol %s",r);const s=e[r];if(s){const e=s&&s.handlerFunc;if(e){e(s,i(null,r,n,t))}}}),e[r].matchFunc)})),c.handle(u,(e=>{e&&o.error("multistream handshake failed",e)}))}}}}},{package:"3box>ipfs>libp2p>libp2p-switch"}],[4985,{"./old-peers":4986,"./stat":4987,events:2133},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("events"),i=e("./stat"),s=e("./old-peers"),o={computeThrottleMaxQueueSize:1e3,computeThrottleTimeout:2e3,movingAverageIntervals:[6e4,3e5,9e5],maxOldPeersRetention:50},a=["dataReceived","dataSent"],c={in:"dataReceived",out:"dataSent"};t.exports=(e,t)=>{const r=Object.assign({},o,t),u=new i(a,r),l=Object.assign(new n,{start:function(){e.on("message",b),u.start();for(let e of f.values())e.start();for(let e of p.values())e.start()},stop:function(){e.removeListener("message",b),u.stop();for(let e of f.values())e.stop();for(let e of p.values())e.stop()},global:u,peers:()=>Array.from(f.keys()),forPeer:e=>f.get(e)||h.get(e),transports:()=>Array.from(p.keys()),forTransport:e=>p.get(e),protocols:()=>Array.from(d.keys()),forProtocol:e=>d.get(e)});u.on("update",m);const h=s(r.maxOldPeersRetention),f=new Map,p=new Map,d=new Map;return e.on("peer:closed",(e=>{const t=f.get(e);t&&(t.removeListener("update",m),t.stop(),f.delete(e),h.set(e,t))})),l;function b(e,t,n,s,o){const l=c[s];if(t){u.push(l,o);let t=f.get(e);t||(t=h.get(e),t?h.delete(e):t=new i(a,r),t.on("update",m),t.start(),f.set(e,t)),t.push(l,o)}if(t){let e=p.get(t);e||(e=new i(a,r),e.on("update",m),p.set(t,e)),e.push(l,o)}if(n){let e=d.get(n);e||(e=new i(a,r),e.on("update",m),d.set(n,e)),e.push(l,o)}}function m(){l.emit("update")}}}}},{package:"3box>ipfs>libp2p>libp2p-switch"}],[4986,{hashlru:4421},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("hashlru");t.exports=e=>{const t=n(e);return t.delete=t.remove,t}}}},{package:"3box>ipfs>libp2p>libp2p-switch"}],[4987,{"bignumber.js":4966,events:2133,"moving-average":5219,retimer:5743},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("events"),i=e("bignumber.js"),s=e("moving-average"),o=e("retimer");t.exports=class extends n{constructor(e,t){super(),this._options=t,this._queue=[],this._stats={},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this);const r=this._options.movingAverageIntervals;for(var n=0;n<e.length;n++){var o=e[n];this._stats[o]=i(0),this._movingAverages[o]={};for(var a=0;a<r.length;a++){var c=r[a];(this._movingAverages[o][c]=s(c)).push(this._frequencyLastTime,0)}}}start(){this._queue.length&&this._resetComputeTimeout()}stop(){this._timeout&&(this._timeout.clear(),this._timeout=null)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}push(e,t){this._queue.push([e,t,Date.now()]),this._resetComputeTimeout()}_resetComputeTimeout(){this._timeout?this._timeout.reschedule(this._nextTimeout()):this._timeout=o(this._update,this._nextTimeout())}_nextTimeout(){const e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;for(;this._queue.length;){const t=e=this._queue.shift();this._applyOp(t)}this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){const t=e-this._frequencyLastTime;Object.keys(this._stats).forEach((r=>{this._updateFrequencyFor(r,t,e)})),this._frequencyLastTime=e}_updateFrequencyFor(e,t,r){const n=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;const i=n/(t||1)*1e3;let o=this._movingAverages[e];o||(o=this._movingAverages[e]={});const a=this._options.movingAverageIntervals;for(var c=0;c<a.length;c++){var u=a[c],l=o[u];l||(l=o[u]=s(u)),l.push(r,i)}}_applyOp(e){const t=e[0],r=e[1];if("number"!=typeof r)throw new Error("invalid increment number:",r);let n;n=this._stats.hasOwnProperty(t)?this._stats[t]:this._stats[t]=i(0),this._stats[t]=n.plus(r),this._frequencyAccumulators[t]||(this._frequencyAccumulators[t]=0),this._frequencyAccumulators[t]+=r}}}}},{package:"3box>ipfs>libp2p>libp2p-switch"}],[4988,{"./constants":4972,"./limit-dialer":4979,"./utils":4989,"async/parallel":1873,debug:2304,once:5323},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("async/parallel"),i=e("once"),s=e("debug")("libp2p:switch:transport"),o=e("./limit-dialer"),{DIAL_TIMEOUT:a}=e("./constants"),{uniqueBy:c}=e("./utils");class u{constructor(e){this.switch=e,this.dialer=new o(8,this.switch._options.dialTimeout||a)}add(e,t){if(s("adding %s",e),this.switch.transports[e])throw new Error("There is already a transport with this key");this.switch.transports[e]=t,this.switch.transports[e].listeners||(this.switch.transports[e].listeners=[])}remove(e,t){if(t=t||function(){},!this.switch.transports[e])return t();this.close(e,(r=>{delete this.switch.transports[e],t(r)}))}removeAll(e){const t=Object.keys(this.switch.transports).map((e=>t=>{this.remove(e,t)}));n(t,e)}dial(e,t,r){const n=this.switch.transports[e];let i=t.multiaddrs.toArray();Array.isArray(i)||(i=[i]),i=u.dialables(n,i,this.switch._peerInfo),s("dialing %s",e,i.map((e=>e.toString()))),this.dialer.dialMany(t.id,n,i,((e,n)=>{if(e)return r(e);t.connect(n.multiaddr),r(null,n.conn)}))}listen(e,t,r,s){r=this.switch._connectionHandler(e,r);const o=this.switch.transports[e];let a=this.switch._peerInfo.multiaddrs.toArray();a=c(a,(e=>{const t=Number(e.toOptions().port);return isNaN(t)||0===t?e.toString():t}));const l=u.dialables(o,a);o.listeners||(o.listeners=[]);let h=[];const f=l.map((e=>t=>{const n=i(t),s=o.createListener(r);s.once("error",n),s.listen(e,(e=>{if(e)return n(e);s.removeListener("error",n),s.getAddrs(((e,t)=>{if(e)return n(e);h=h.concat(t),o.listeners.push(s),n()}))}))}));n(f,(e=>{if(e)return s(e);this.switch._peerInfo.multiaddrs.replace(l,h),s()}))}close(e,t){const r=this.switch.transports[e];if(!r)return t(new Error(`Trying to close non existing transport: ${e}`));n(r.listeners.map((e=>t=>{e.close(t)})),t)}static dialables(e,t,r){if(!e||!e.filter)return[];const n=e.filter(t);if(!r||!n.length)return n;const i=function(e){const t=e.id.toB58String();return e.multiaddrs.toArray().reduce(((e,r)=>{const n=r.getPeerId();r=r.toString();const i=n?r.slice(0,r.lastIndexOf(`/ipfs/${n}`)):`${r}/ipfs/${t}`;return e.concat([r,i])}),[]).filter((e=>Boolean(e))).concat(`/ipfs/${t}`)}(r);return n.filter((e=>!i.some((t=>function(e){const t=e.protoNames().reverse().find((e=>l.includes(e)));return e=e.toString(),t?e.slice(e.lastIndexOf(t)+t.length):e}(e).startsWith(t)))))}}const l=["p2p-circuit","p2p-websocket-star","p2p-webrtc-star","p2p-stardust"];t.exports=u}}},{package:"3box>ipfs>libp2p>libp2p-switch"}],[4989,{"libp2p-identify":4885},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("libp2p-identify");t.exports.msHandle=(e,t)=>new Promise(((r,n)=>{e.handle(t,(e=>{if(e)return n(e);r()}))})),t.exports.msSelect=(e,t)=>new Promise(((r,n)=>{e.select(t,((e,t)=>{if(e)return n(e);r(t)}))})),t.exports.identifyDialer=(e,t)=>new Promise(((r,i)=>{n.dialer(e,t,((e,t,n)=>{if(e)return i(e);r({peerInfo:t,observedAddrs:n})}))})),t.exports.uniqueBy=(e,t)=>[...new Map(e.map((e=>[t(e),e]))).values()]}}},{package:"3box>ipfs>libp2p>libp2p-switch"}],[4990,{"./utils":4991,"async/setImmediate":1878,"class-is":2171,debug:2304,events:2133,"interface-connection":4455,mafmt:5206,multiaddr:5224,once:5323,"peer-id":5420,"peer-info":5421,"simple-peer":5839,"socket.io-client":5857,"stream-to-pull-stream":5915,webrtcsupport:6162},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("debug")("libp2p:webrtc-star"),i=e("multiaddr"),s=e("mafmt"),o=e("class-is"),a=e("socket.io-client"),c=e("events").EventEmitter,u=e("simple-peer"),l=e("peer-id"),h=e("peer-info"),f=e("interface-connection").Connection,p=e("stream-to-pull-stream"),d=e("once"),b=e("async/setImmediate"),m=e("webrtcsupport"),g=e("./utils"),y=g.cleanUrlSIO,k=g.cleanMultiaddr,_=d((()=>{})),E={transports:["websocket"],"force new connection":!0};t.exports=o(class{constructor(e){e=e||{},this.maSelf=undefined,this.sioOptions={transports:["websocket"],"force new connection":!0},e.wrtc&&(this.wrtc=e.wrtc),this.discovery=new c,this.discovery.tag="webRTCStar",this.discovery._isStarted=!1,this.discovery.start=e=>{this.discovery._isStarted=!0,b(e)},this.discovery.stop=e=>{this.discovery._isStarted=!1,b(e)},this.listenersRefs={},this._peerDiscovered=this._peerDiscovered.bind(this)}dial(e,t,r){"function"==typeof t&&(r=t,t={}),r=r?d(r):_;const i=(~~(1e9*Math.random())).toString(36)+Date.now(),s=this.listenersRefs[Object.keys(this.listenersRefs)[0]].io,o={initiator:!0,trickle:!1};let a;this.wrtc&&(o.wrtc=this.wrtc);try{a=new u(o)}catch(e){return n("Could not create connection:",e),r(e)}const c=new f(p.duplex(a));let l=!1;return a.on("signal",(t=>{s.emit("ss-handshake",{intentId:i,srcMultiaddr:this.maSelf.toString(),dstMultiaddr:e.toString(),signal:t})})),a.once("timeout",(()=>r(new Error("timeout")))),a.once("error",(e=>{l||r(e)})),s.on("ws-handshake",(t=>{if(t.intentId===i&&t.err)return r(new Error(t.err));t.intentId===i&&t.answer&&(a.once("connect",(()=>{l=!0,c.destroy=a.destroy.bind(a),a.once("close",(()=>c.destroy())),c.getObservedAddrs=t=>t(null,[e]),r(null,c)})),a.signal(t.signal))})),c}createListener(e,t){"function"==typeof e&&(t=e,e={});const r=new c;return r.listen=(e,i)=>{if(i=i?d(i):_,!m.support&&!this.wrtc)return b((()=>i(new Error("no WebRTC support"))));this.maSelf=e;const s=y(e);n("Dialing to Signalling Server on: "+s),r.io=a.connect(s,E),r.io.once("connect_error",i),r.io.once("error",(e=>{r.emit("error",e),r.emit("close")})),r.io.on("ws-handshake",(function(e){if(e.answer||e.err)return;const s={trickle:!1};o.wrtc&&(s.wrtc=o.wrtc);let a;try{a=new u(s)}catch(e){return n("Could not create incoming connection:",e),i(e)}const c=new f(p.duplex(a));a.once("connect",(()=>{c.getObservedAddrs=t=>t(null,[e.srcMultiaddr]),r.emit("connection",c),t(c)})),a.once("signal",(t=>{e.signal=t,e.answer=!0,r.io.emit("ss-handshake",e)})),a.signal(e.signal)})),r.io.on("ws-peer",this._peerDiscovered),r.io.on("connect",(()=>{r.io.emit("ss-join",e.toString())})),r.io.once("connect",(()=>{r.emit("listening"),i()}));const o=this},r.close=e=>{e=e?d(e):_,r.io.emit("ss-leave"),b((()=>{r.emit("close"),e()}))},r.getAddrs=e=>{b((()=>e(null,[this.maSelf])))},this.listenersRefs[i.toString()]=r,r}filter(e){return Array.isArray(e)||(e=[e]),e.filter((e=>!(e.protoNames().indexOf("p2p-circuit")>-1)&&s.WebRTCStar.matches(e)))}_peerDiscovered(e){if(!this.discovery._isStarted)return;n("Peer Discovered:",e);const t=(e=k(e)).split("/ipfs/"),r=t[t.length-1],s=l.createFromB58String(r),o=new h(s);o.multiaddrs.add(i(e)),this.discovery.emit("peer",o)}},{className:"WebRTCStar",symbolName:"@libp2p/js-libp2p-webrtc-star/webrtcstar"})}}},{package:"3box>ipfs>libp2p-webrtc-star"}],[4991,{multiaddr:5224},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("multiaddr");(r=t.exports).cleanUrlSIO=function(e){const t=e.toString().split("/"),r=e.protos()[1].name,i=e.protos()[2].name,s=e.stringTuples()[1][1];if("tcp"!==r||"ws"!==i&&"wss"!==i)throw new Error("invalid multiaddr: "+e.toString());return n.isName(e)?"ws"===i?"http://"+t[2]+(80===s?"":":"+s):"wss"===i?"https://"+t[2]+(443===s?"":":"+s):void 0:"http://"+t[2]+":"+t[4]},r.cleanMultiaddr=function(e){const t="/libp2p-webrtc-star";if(-1!==e.indexOf(t)){e=e.substring(t.length,e.length);let r=n(e);const i=r.stringTuples().filter((e=>421===e[0]))[0];r=r.decapsulate("ipfs"),r=r.encapsulate("/p2p-webrtc-star"),r=r.encapsulate(`/ipfs/${i[1]}`),e=r.toString()}return e}}}},{package:"3box>ipfs>libp2p-webrtc-star"}],[4992,{"async/map":1869,"async/parallel":1873,debug:2304,events:2133,"libp2p-websocket-star":4994,mafmt:5206,multiaddr:5224,once:5323},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("debug")("libp2p:websocket-star:multi"),i=e("once"),s=e("events").EventEmitter,o=e("async/map"),a=e("async/parallel"),c=e("multiaddr"),u=e("mafmt"),l=e("libp2p-websocket-star");t.exports=class{constructor(e){this.opt=e||{},this.servers=e.servers||[],this.ws=new l(this.opt),this.discovery=this.ws.discovery}dial(e,t,r){return n("dial",e),this.ws.dial(e,t,r)}createListener(e,t){"function"==typeof e&&(t=e,e={});const r=new s;return r.servers={},r.online=[],this.servers.forEach((n=>{const i=this.ws.createListener(e,t);i.once("error",(()=>{})),i.url=n,r.servers[n]=i})),r.listen=(e,t)=>{const s=e.toString().split("ipfs/").pop();n("listen on %s server(s) with id %s",this.servers.length,s),a(this.servers.map((e=>r.servers[e])).map((e=>t=>{n("listen %s",e.url);const o=i((i=>(n("listen %s ok %s",e.url,!i),i?t(n(i)):(r.online.push(e),t()))));setTimeout(o,this.opt.timeout||5e3,new Error("Timeout")),e.listen(c(e.url).encapsulate("/ipfs/"+s),o)})),(()=>{if(r.online.length||this.opt.ignore_no_online)r.emit("listening"),t();else{const e=new Error("Couldn't listen on any of the servers");r.emit("error",e),t(e)}}))},r.close=e=>a(r.online.map((e=>t=>e.close(t))),(t=>e(t,r.online=[]))),r.getAddrs=e=>o(r.online,((e,t)=>e.getAddrs(t)),((t,r)=>t?e(t):e(null,r.reduce(((e,t)=>e.concat(t)),[])))),r}filter(e){return Array.isArray(e)||(e=[e]),e.filter((e=>e.toString().startsWith("/p2p-websocket-star")||u.WebSocketStar.matches(e)))}}}}},{package:"3box>ipfs>libp2p-websocket-star-multi"}],[4993,{},function(){with(this)return function(){"use strict";return function(e,t,r){r.ERR_WS_STAR_WEBSOCKET_CONNECTION="ERR_WS_STAR_WEBSOCKET_CONNECTION"}}},{package:"3box>ipfs>libp2p-websocket-star-multi>libp2p-websocket-star"}],[4994,{"./listener":4995,"./utils":4996,"async/setImmediate":1878,"class-is":2171,debug:2304,events:2133,"interface-connection":4455,mafmt:5206,multiaddr:5224,"peer-id":5420,"peer-info":5421},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("debug")("libp2p:websocket-star"),i=e("multiaddr"),s=e("events").EventEmitter,o=e("peer-id"),a=e("peer-info"),c=e("interface-connection").Connection,u=e("async/setImmediate"),l=e("./utils"),h=e("./listener"),f=l.cleanUrlSIO,p=e("mafmt"),d=e("class-is");t.exports=d(class{constructor(e){e=e||{},this.id=e.id,this.flag=e.allowJoinWithDisabledChallenge,this.discovery=new s,this.discovery.tag="websocketStar",this.discovery.start=e=>{u(e)},this.discovery.stop=e=>{u(e)},this.listeners_list={},this._peerDiscovered=this._peerDiscovered.bind(this)}lazySetId(e){e&&(this.id=e,this.canCrypto=!0)}dial(e,t,r){let n;"function"==typeof t&&(r=t,t={});try{n=f(e)}catch(e){return r(e)}const i=this.listeners_list[n];return i?i.dial(e,t,r):(r(new Error("No listener for this server")),new c)}createListener(e,t){"function"==typeof e&&(t=e,e={});const r=new h({id:this.id,handler:t,listeners:this.listeners_list,flag:this.flag});return r.on("peer",this._peerDiscovered),r}filter(e){return Array.isArray(e)||(e=[e]),e.filter((e=>p.WebSocketStar.matches(e)))}_peerDiscovered(e){n("Peer Discovered:",e);const t=e.split("/ipfs/").pop(),r=o.createFromB58String(t),s=new a(r);s.multiaddrs.add(i(e)),this.discovery.emit("peer",s)}},{className:"WebsocketStar",symbolName:"@libp2p/js-libp2p-websocket-star/websocketstar"})}}},{package:"3box>ipfs>libp2p-websocket-star-multi>libp2p-websocket-star"}],[4995,{"./errors":4993,"./utils":4996,"async/series":1877,"async/setImmediate":1878,buffer:2132,debug:2304,events:2133,"interface-connection":4455,"libp2p-crypto":4866,multiaddr:5224,once:5323,"pull-stream/pull":5488,"pull-stream/throughs/through":5513,"socket.io-client":5857,"socket.io-pull-stream":5879,uuid:6020},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("debug")("libp2p:websocket-star:listener"),i=e("multiaddr"),s=e("socket.io-client"),o=e("socket.io-pull-stream"),a=e("uuid"),c=e("async/series"),u=e("events").EventEmitter,l=e("interface-connection").Connection,h=e("once"),f=e("async/setImmediate"),p=e("./utils"),d=p.cleanUrlSIO,b=e("libp2p-crypto"),m=e("pull-stream/pull"),g=e("pull-stream/throughs/through"),y=e("./errors"),k=h((()=>{})),_={transports:["websocket"],"force new connection":!0};t.exports=class extends u{constructor(e){super(),this.id=e.id,this.log=n.bind(n,"listener#offline"),this.canCrypto=Boolean(e.id),this._handler=e.handler||k,this.listeners_list=e.listeners||{},this.flag=e.flag,this.conns=[],this.connected=!1}_up(e){if(e=e?h(e):k,this.io)return e();this.log=n.bind(n,"listener#"+this.server),this.log("dialing to signalling server");const t=this.io=s.connect(this.server,_);o(t,{codec:"buffer"}),t.once("error",e),t.once("connect_error",e),t.once("connect",e);const r=new p.Protocol(this.log);r.addRequest("ws-peer",["multiaddr"],((e,t)=>this.emit("peer",t))),r.addRequest("ss-incomming",["string","multiaddr","function"],this._incommingDial.bind(this)),r.handleSocket(t)}_down(){this.io&&(this.io.disconnect(),this.emit("close"),delete this.io)}_cryptoChallenge(e){if(!this.io)return e(new Error("Not connected"));const t=this.canCrypto?b.keys.marshalPublicKey(this.id.pubKey).toString("hex"):"",n=this.ma.toString();this.io.emit("ss-join",n,t,((t,n,i)=>{if(t)return e(t);if(n){if(!this.canCrypto)return this._down(),e(new Error("Can't sign cryptoChallenge: No id provided"));this.log("performing cryptoChallenge"),this.id.privKey.sign(r.from(n),((t,r)=>{if(t)return e(t);this.signature=r.toString("hex"),this._join(e)}))}else{if(!this.flag)return this._down(),e(new Error('Tried to listen on a server with crypto challenge disabled!\n    This is prohibited by default and can lead to security issues!\n    Please set "allowJoinWithDisabledChallenge" to true in the constructor options (but only if you know what you are doing)!'));this.signature="_",e(null,null,i)}}))}_crypto(e){if(e=e?h(e):k,this.log("joining"),!this.io)return e(new Error("Not connected"));this.signature?this._join(e):this._cryptoChallenge(e)}_join(e){this.io.emit("ss-join",this.ma.toString(),this.signature,e)}_incommingDial(e,t,r,n){this.log("dial#"+t+" incomming from",r);const s=i(r),o=this.io.createSource(t+".dialer"),a=this.io.createSink(t+".listener");n();const c=new l({sink:a,source:o},{getObservedAddrs:e=>e(null,[s])});this.emit("connection",c),this._handler(c)}listen(e,t){if(this.ma=e,this.server=d(e),this.listeners_list[this.server]=this,t=t?h(t):k,this.connected)return this.closing=!1,f((()=>t()));c([e=>this._up(e),e=>this._crypto(((t,r,n)=>e(t,n)))],((e,[r,n])=>{if(e){if(e.description&&"ENOTFOUND"===e.description.code){const t=e.description.hostname;e=Object.assign(new Error(`WebSocket connection failed on ${t}`),{code:y.ERR_WS_STAR_WEBSOCKET_CONNECTION})}return this.log("error",e),e instanceof Error||(e=new Error(e)),this._down(),this.emit("error",e),this.emit("close"),t(e)}this.log("success"),this.connected=!0,this.io.on("reconnect",(()=>{this.signature=null,this._crypto(((e,t,r)=>{if(e)this.log("reconnect error",e),this.emit("error",e);else{this.log("reconnected");for(const e of r||[])this.emit("peer",e)}}))})),this.emit("listening");for(const e of n||[])this.emit("peer",e);t()}))}getAddrs(e){f((()=>e(null,this.ma?[this.ma]:[])))}get activeConnections(){return this.conns=this.conns.filter((e=>e.sink||e.source)),Boolean(this.conns.length)}maybeClose(){!this.activeConnections&&this.closing&&(this.connected=!1,this.closing=!1,this.log("no more connections and listener is offline - closing"),this._down())}close(e){e=e?h(e):k,this.closing=!0,this.maybeClose(),e()}stateWatch(e,t){let r={sink:!0,source:!0};const n=e=>g((e=>e),(t=>{r[e]=!1,r.sink||r.source||this.maybeClose()}));return this.conns.push(r),{sink:m(n("sink"),e),source:m(t,n("source"))}}dial(e,t,r){"function"==typeof t&&(r=t,t={});const s=i(e),o=new l(null),c=a(),u=this.log.bind(n,"dial#"+c);r=r?h(r):k;let f=this.io;if(!f)return r(new Error("Not listening"));const p=f.createSink(c+".dialer");return u("dialing",e.toString()),f.emit("ss-dial",this.ma.toString(),e.toString(),c,(e=>{if(e)return r(e instanceof Error?e:new Error(e));u(e?"error: "+e.toString():"success");const t=f.createSource(c+".listener");o.setInnerConn(this.stateWatch(p,t),{getObservedAddrs:e=>e(null,[s])}),r(null,o)})),o}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-websocket-star-multi>libp2p-websocket-star"}],[4996,{buffer:2132,"libp2p-crypto":4866,mafmt:5206,multiaddr:5224,"peer-id":5420},function(){with(this)return function(){"use strict";return function(e,t,r){(function(n){(function(){const i=e("multiaddr"),s=e("peer-id"),o=e("libp2p-crypto"),a=e("mafmt");const c={string:e=>"string"==typeof e,object:e=>"object"==typeof e,multiaddr:e=>{if(c.string(e))try{return i(e),!0}catch(e){return!1}},function:e=>"function"==typeof e};function u(e,t){if(!Array.isArray(t))throw new Error("Data is not an array");e.forEach(((e,r)=>{if(!c[e])throw console.error("Type %s does not exist",e),new Error("Type "+e+" does not exist");if(!c[e](t[r]))throw new Error("Data at index "+r+" is invalid for type "+e)}))}(r=t.exports).cleanUrlSIO=function(e){const t=e.protos(),r=t[0].name,n=t[1].name,i=t[2].name,s=e.stringTuples(),o=s[1][1];if("tcp"!==n||"ws"!==i&&"wss"!==i)throw new Error("invalid multiaddr: "+e.toString());let a=s[0][1];"ip6"===r&&(a="["+a+"]");let c="ws"===i&&80===o||"wss"===i&&443===o?"":o;return("wss"===i?"https":"http")+"://"+a+(c?":"+c:"")},r.validate=u,r.Protocol=function(e){e||(e=()=>{});const t=this;t.requests={},t.addRequest=(e,r,n)=>{t.requests[e]={def:r,handle:n}},t.handleSocket=r=>{r.r={},Object.keys(t.requests).forEach((n=>{const i=t.requests[n];r.on(n,(function(){const t=[...arguments];try{u(i.def,t),t.unshift(r),i.handle.apply(null,t)}catch(i){e(i),e("peer %s has sent invalid data for request %s",r.id||"<server>",n,t)}}))}))}},r.getIdAndValidate=function(e,t,r){s.createFromPubKey(n.from(e,"hex"),((i,s)=>i?r(new Error("Crypto error")):s.toB58String()!==t?r(new Error("Id is not matching")):r(null,o.keys.unmarshalPublicKey(n.from(e,"hex")))))},r.validateMa=e=>a.WebSocketStar.matches(i(e))}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-websocket-star-multi>libp2p-websocket-star"}],[4997,{"./listener":4998,"class-is":2171,debug:2304,"interface-connection":4455,mafmt:5206,"multiaddr-to-uri":5221,"pull-ws/client":5520},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("pull-ws/client"),i=e("mafmt"),s=e("class-is"),o=e("interface-connection").Connection,a=e("multiaddr-to-uri"),c=e("debug")("libp2p:websockets:dialer"),u=e("./listener");t.exports=s(class{dial(e,t,r){"function"==typeof t&&(r=t,t={}),r=r||function(){};const i=a(e);c("dialing %s",i);const s=n(i,{binary:!0,onConnect:e=>{r(e)}}),u=new o(s);return u.getObservedAddrs=t=>t(null,[e]),u.close=e=>s.close(e),u}createListener(e,t){return"function"==typeof e&&(t=e,e={}),u(e,t)}filter(e){return Array.isArray(e)||(e=[e]),e.filter((e=>!e.protoNames().includes("p2p-circuit")&&(e.protoNames().includes("ipfs")&&(e=e.decapsulate("ipfs")),i.WebSockets.matches(e)||i.WebSocketsSecure.matches(e))))}},{className:"WebSockets",symbolName:"@libp2p/js-libp2p-websockets/websockets"})}}},{package:"3box>ipfs>libp2p-websockets"}],[4998,{"interface-connection":4455,multiaddr:5224,os:5373,"pull-ws/server":5524},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("interface-connection").Connection,i=e("multiaddr"),s=e("os");function o(){}const a=e("pull-ws/server")||o;t.exports=(e,t)=>{const r=a(e,(e=>{e.getObservedAddrs=e=>e(null,[]),t(new n(e))}));let c;return r._listen=r.listen,r.listen=(e,t)=>{t=t||o,c=e,e.protoNames().includes("ipfs")&&(e=e.decapsulate("ipfs")),r._listen(e.toOptions(),t)},r.getAddrs=e=>{const t=[],n=r.address();if(!n)return e(new Error("Listener is not ready yet"));let o=c.getPeerId();if(-1!==c.toString().indexOf("ip4")){let e=c.decapsulate("tcp");if(e=e.encapsulate("/tcp/"+n.port+"/ws"),c.getPeerId()&&(e=e.encapsulate("/ipfs/"+o)),-1!==e.toString().indexOf("0.0.0.0")){const r=s.networkInterfaces();Object.keys(r).forEach((n=>{r[n].forEach((r=>{"IPv4"===r.family&&t.push(i(e.toString().replace("0.0.0.0",r.address)))}))}))}else t.push(e)}e(null,t)},r}}}},{package:"3box>ipfs>libp2p-websockets"}],[4999,{superstruct:5918},function(){with(this)return function(){"use strict";return function(e,t,r){const{struct:n,superstruct:i}=e("superstruct"),{optional:s,list:o}=n,a=i(),c=a.union([a.interface({createListener:"function",dial:"function"}),"function"]),u=a({connEncryption:s(o([a("object|function")])),connProtector:a.union(["undefined",a.interface({protect:"function"})]),contentRouting:s(o(["object"])),dht:s(a("null|function|object")),peerDiscovery:s(o([a("object|function")])),peerRouting:s(o(["object"])),streamMuxer:s(o([a("object|function")])),transport:a.intersection([[c],a.interface({length:e=>e>0||"ERROR_EMPTY"})])}),l=a({peerDiscovery:a("object",{autoDial:!0}),relay:a({enabled:"boolean",hop:s(a({enabled:"boolean",active:"boolean"},{enabled:!1,active:!1}))},{enabled:!0}),dht:a("object?",{enabled:!1,kBucketSize:20,randomWalk:{enabled:!1,queriesPerPeriod:1,interval:3e5,timeout:1e4}}),EXPERIMENTAL:a({pubsub:"boolean"},{pubsub:!1})},{}),h=a({switch:"object?",connectionManager:a("object",{minPeers:25}),datastore:"object?",peerInfo:"object",peerBook:"object?",modules:u,config:l});t.exports.validate=e=>{const[t,r]=h.validate(e);if(t)throw new Error(`${t.message}${t.reason?" - "+t.reason:""}`);return r.config.dht.enabled&&a("function|object")(r.modules.dht),r.config.peerDiscovery.autoDial===undefined&&(r.config.peerDiscovery.autoDial=!0),r}}}},{package:"3box>ipfs>libp2p"}],[50,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return function(t,r,n){t.tabId=e.tabId,n()}}}}},{package:"$root$"}],[5e3,{"async/parallel":1873,"async/tryEach":1883,"err-code":2406},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("async/tryEach"),i=e("async/parallel"),s=e("err-code");t.exports=e=>{const t=e._modules.contentRouting||[];return e._dht&&t.unshift(e._dht),{findProviders:(e,r,i)=>{if("function"==typeof r?(i=r,r={}):"number"==typeof r&&(r={maxTimeout:r}),!t.length)return i(s(new Error("No content routers available"),"NO_ROUTERS_AVAILABLE"));const o=t.map((t=>n=>t.findProviders(e,r,((e,t)=>e?n(e):t&&0!==Object.keys(t).length?void n(null,t):n(s(new Error("not found"),"NOT_FOUND"),null)))));n(o,((e,t)=>{if(e&&"NOT_FOUND"!==e.code)return i(e);i(null,t=t||[])}))},provide:(e,r)=>{if(!t.length)return r(s(new Error("No content routers available"),"NO_ROUTERS_AVAILABLE"));i(t.map((t=>r=>t.provide(e,r))),r)}}}}}},{package:"3box>ipfs>libp2p"}],[5001,{"./errors":5002,"async/nextTick":1872,"err-code":2406},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("async/nextTick"),i=e("err-code"),{messages:s,codes:o}=e("./errors");t.exports=e=>({put:(t,r,a)=>{if(!e._dht)return n(a,i(new Error(s.DHT_DISABLED),o.DHT_DISABLED));e._dht.put(t,r,a)},get:(t,r,a)=>{if("function"==typeof r&&(a=r,r={}),!e._dht)return n(a,i(new Error(s.DHT_DISABLED),o.DHT_DISABLED));e._dht.get(t,r,a)},getMany:(t,r,a,c)=>{if("function"==typeof a&&(c=a,a={}),!e._dht)return n(c,i(new Error(s.DHT_DISABLED),o.DHT_DISABLED));e._dht.getMany(t,r,a,c)}})}}},{package:"3box>ipfs>libp2p"}],[5002,{},function(){with(this)return function(){"use strict";return function(e,t,r){r.messages={NOT_STARTED_YET:"The libp2p node is not started yet",DHT_DISABLED:"DHT is not available"},r.codes={DHT_DISABLED:"ERR_DHT_DISABLED",PUBSUB_NOT_STARTED:"ERR_PUBSUB_NOT_STARTED",ERR_NODE_NOT_STARTED:"ERR_NODE_NOT_STARTED",ERR_DISCOVERED_SELF:"ERR_DISCOVERED_SELF"}}}},{package:"3box>ipfs>libp2p"}],[5003,{"err-code":2406,multiaddr:5224,"peer-id":5420,"peer-info":5421},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("peer-id"),i=e("peer-info"),s=e("multiaddr"),o=e("err-code");t.exports=e=>function(t,r){let a;if(i.isPeerInfo(t))a=t;else if(s.isMultiaddr(t)||"string"==typeof t){if("string"==typeof t)try{t=s(t)}catch(e){return r(o(e,"ERR_INVALID_MULTIADDR"))}const c=t.getPeerId();if(!c)return r(o(new Error("peer multiaddr instance or string must include peerId"),"ERR_INVALID_MULTIADDR"));try{a=e.peerBook.get(c)}catch(e){a=new i(n.createFromB58String(c))}a.multiaddrs.add(t)}else{if(!n.isPeerId(t))return r(o(new Error(`${a} is not a valid peer type`),"ERR_INVALID_PEER_TYPE"));{const n=t.toB58String();try{a=e.peerBook.get(n)}catch(n){return e.peerRouting.findPeer(t,r)}}}r(null,a)}}}},{package:"3box>ipfs>libp2p"}],[5004,{"./config":4999,"./content-routing":5e3,"./dht":5001,"./errors":5002,"./get-peer-info":5003,"./peer-routing":5005,"./pubsub":5006,"./util":5007,_process:5430,"async/each":1838,"async/nextTick":1872,"async/parallel":1873,"async/series":1877,debug:2304,"err-code":2406,events:2133,"fsm-event":4346,"libp2p-connection-manager":4849,"libp2p-ping":4926,"libp2p-switch":4978,"libp2p-websockets":4997,"peer-book":5419,"peer-info":5421},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("fsm-event"),i=e("events").EventEmitter,s=e("debug"),o=s("libp2p");o.error=s("libp2p:error");const a=e("err-code"),c=e("async/each"),u=e("async/series"),l=e("async/parallel"),h=e("async/nextTick"),f=e("peer-book"),p=e("peer-info"),d=e("libp2p-switch"),b=e("libp2p-ping"),m=e("libp2p-websockets"),g=e("libp2p-connection-manager"),{emitFirst:y}=e("./util"),k=e("./peer-routing"),_=e("./content-routing"),E=e("./dht"),S=e("./pubsub"),w=e("./get-peer-info"),v=e("./config").validate,{codes:x}=e("./errors"),I=(e,t)=>a(new Error(`libp2p cannot ${e} when not started; state is ${t}`),x.ERR_NODE_NOT_STARTED);class A extends i{constructor(e){if(super(),this._options=v(e),this.datastore=this._options.datastore,this.peerInfo=this._options.peerInfo,this.peerBook=this._options.peerBook||new f,this._modules=this._options.modules,this._config=this._options.config,this._transport=[],this._discovery=[],this._switch=new d(this.peerInfo,this.peerBook,this._options.switch),this._switch.on("error",((...e)=>this.emit("error",...e))),this.stats=this._switch.stats,this.connectionManager=new g(this,this._options.connectionManager),this._modules.streamMuxer){this._modules.streamMuxer.forEach((e=>this._switch.connection.addStreamMuxer(e))),this._switch.connection.reuse(),this._switch.connection.enableCircuitRelay(this._config.relay),this._switch.on("peer-mux-established",(e=>{this.emit("peer:connect",e)})),this._switch.on("peer-mux-closed",(e=>{this.emit("peer:disconnect",e)}))}if(this._switch.on("connection:start",(e=>{this.emit("connection:start",e)})),this._switch.on("connection:end",(e=>{this.emit("connection:end",e)})),this._modules.connEncryption){this._modules.connEncryption.forEach((e=>{this._switch.connection.crypto(e.tag,e.encrypt)}))}if(this._modules.connProtector)this._switch.protector=this._modules.connProtector;else if(r.env.LIBP2P_FORCE_PNET)throw new Error("Private network is enforced, but no protector was provided");if(this._config.dht.enabled){const e=this._modules.dht;this._dht=new e(this._switch,{datastore:this.datastore,...this._config.dht})}this._config.EXPERIMENTAL.pubsub&&(this.pubsub=S(this)),this.peerRouting=k(this),this.contentRouting=_(this),this.dht=E(this),this._getPeerInfo=w(this),b.mount(this._switch),this.state=new n("STOPPED",{STOPPED:{start:"STARTING",stop:"STOPPED"},STARTING:{done:"STARTED",abort:"STOPPED",stop:"STOPPING"},STARTED:{stop:"STOPPING",start:"STARTED"},STOPPING:{stop:"STOPPING",done:"STOPPED"}}),this.state.on("STARTING",(()=>{o("libp2p is starting"),this._onStarting()})),this.state.on("STOPPING",(()=>{o("libp2p is stopping"),this._onStopping()})),this.state.on("STARTED",(()=>{o("libp2p has started"),this.emit("start")})),this.state.on("STOPPED",(()=>{o("libp2p has stopped"),this.emit("stop")})),this.state.on("error",(e=>{o.error(e),this.emit("error",e)})),this.state.on("STARTED",(()=>{this.peerBook.getAllArray().forEach((e=>{this.emit("peer:discovery",e),this._maybeConnect(e)}))})),this._peerDiscovered=this._peerDiscovered.bind(this)}emit(e,...t){"error"!==e||this._events.error?super.emit(e,...t):o.error(...t)}start(e=(()=>{})){y(this,["error","start"],e),this.state("start")}stop(e=(()=>{})){y(this,["error","stop"],e),this.state("stop")}isStarted(){return!!this.state&&"STARTED"===this.state._state}dial(e,t){this.dialProtocol(e,null,t)}dialProtocol(e,t,r){if(!this.isStarted())return r(I("dial",this.state._state));"function"==typeof t&&(r=t,t=undefined),this._getPeerInfo(e,((e,n)=>{if(e)return r(e);this._switch.dial(n,t,r)}))}dialFSM(e,t,r){if(!this.isStarted())return r(I("dial",this.state._state));"function"==typeof t&&(r=t,t=undefined),this._getPeerInfo(e,((e,n)=>{if(e)return r(e);this._switch.dialFSM(n,t,r)}))}hangUp(e,t){this._getPeerInfo(e,((e,r)=>{if(e)return t(e);this._switch.hangUp(r,t)}))}ping(e,t){if(!this.isStarted())return t(I("ping",this.state._state));this._getPeerInfo(e,((e,r)=>{if(e)return t(e);t(null,new b(this._switch,r))}))}handle(e,t,r){this._switch.handle(e,t,r)}unhandle(e){this._switch.unhandle(e)}_onStarting(){if(!this._modules.transport)return this.emit("error",new Error("no transports were present")),this.state("abort");let e;const t=[],r=[];this.peerInfo.multiaddrs.toArray().forEach((e=>{e.getPeerId()||(t.push(e),r.push(e.encapsulate("/p2p/"+this.peerInfo.id.toB58String())))})),this.peerInfo.multiaddrs.replace(t,r);const n=this.peerInfo.multiaddrs.toArray();this._modules.transport.forEach((t=>{let r;r="function"==typeof t?new t({libp2p:this}):t,r.filter(n).length>0?this._switch.transport.add(r.tag||r[Symbol.toStringTag],r):m.isWebSockets(r)&&(e=r),this._transport.push(r)})),u([e=>{this.connectionManager.start(),this._switch.start(e)},t=>{e&&this._switch.transport.add(e.tag||e.constructor.name,e);this.peerInfo.multiaddrs.toArray().forEach((e=>{e.toString().match(/\/p2p-circuit($|\/)/)||this._transport.find((t=>t.filter(e).length>0))||this.peerInfo.multiaddrs.delete(e)})),t()},e=>{this._dht?this._dht.start((()=>{this._dht.on("peer",this._peerDiscovered),e()})):e()},e=>{if(this._floodSub)return this._floodSub.start(e);e()},e=>{this._modules.peerDiscovery?this._setupPeerDiscovery(e):e()}],(e=>{if(e)return o.error(e),this.emit("error",e),this.state("stop");this.state("done")}))}_onStopping(){u([e=>{l(this._discovery.map((e=>(e.removeListener("peer",this._peerDiscovered),t=>e.stop((e=>{o.error("an error occurred stopping the discovery service",e),t()}))))),e)},e=>{if(this._floodSub)return this._floodSub.stop(e);e()},e=>{if(this._dht)return this._dht.removeListener("peer",this._peerDiscovered),this._dht.stop(e);e()},e=>{this.connectionManager.stop(),this._switch.stop(e)},e=>{this._switch.transport.removeAll((()=>e()))}],(e=>{e&&(o.error(e),this.emit("error",e)),this.state("done")}))}_peerDiscovered(e){e.id.toB58String()!==this.peerInfo.id.toB58String()?(e=this.peerBook.put(e),this.isStarted()&&(this.emit("peer:discovery",e),this._maybeConnect(e))):o.error(new Error(x.ERR_DISCOVERED_SELF))}_maybeConnect(e){if(!0===this._config.peerDiscovery.autoDial&&!e.isConnected()){(this._options.connectionManager.minPeers||0)>Object.keys(this._switch.connection.connections).length&&(o("connecting to discovered peer"),this._switch.dialer.connect(e,(e=>{e&&o.error("could not connect to discovered peer",e)})))}}_setupPeerDiscovery(e){for(const e of this._modules.peerDiscovery){let t={enabled:!0};if(e.tag&&this._config.peerDiscovery&&this._config.peerDiscovery[e.tag]&&(t={...t,...this._config.peerDiscovery[e.tag]}),t.enabled){let r;r="function"==typeof e?new e(Object.assign({},t,{peerInfo:this.peerInfo})):e,r.on("peer",this._peerDiscovered),this._discovery.push(r)}}c(this._discovery,((e,t)=>{e.start(t)}),e)}}t.exports=A,t.exports.createLibp2p=(e,t)=>{if(e.peerInfo)return h(t,null,new A(e));p.create(((r,n)=>{if(r)return t(r);e.peerInfo=n,t(null,new A(e))}))}}).call(this)}).call(this,e("_process"))}}},{package:"3box>ipfs>libp2p"}],[5005,{"async/tryEach":1883,"err-code":2406},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("async/tryEach"),i=e("err-code");t.exports=e=>{const t=e._modules.peerRouting||[];return e._dht&&t.unshift(e._dht),{findPeer:(e,r,s)=>{"function"==typeof r&&(s=r,r={}),t.length||s(i(new Error("No peer routers available"),"NO_ROUTERS_AVAILABLE"));const o=t.map((t=>n=>t.findPeer(e,r,((e,t)=>e?n(e):t&&0!==Object.keys(t).length?void n(null,t):n(i(new Error("not found"),"NOT_FOUND"),null)))));n(o,((e,t)=>{if(e)return s(e);s(null,t=t||[])}))}}}}}},{package:"3box>ipfs>libp2p"}],[5006,{"../../is-buffer/index.js":4735,"./errors":5002,"async/nextTick":1872,"err-code":2406,"libp2p-floodsub":4883},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("async/nextTick"),{messages:i,codes:s}=e("./errors"),o=e("libp2p-floodsub"),a=e("err-code");t.exports=e=>{const t=new o(e);return e._floodSub=t,{subscribe:(r,o,c,u)=>{if("function"==typeof o&&(u=c,c=o,o={}),!e.isStarted()&&!t.started)return n(u,a(new Error(i.NOT_STARTED_YET),s.PUBSUB_NOT_STARTED));var l;l=u,0===t.listenerCount(r)&&t.subscribe(r),t.on(r,c),n(l)},unsubscribe:(r,o,c)=>{if(!e.isStarted()&&!t.started)return n(c,a(new Error(i.NOT_STARTED_YET),s.PUBSUB_NOT_STARTED));o||c?t.removeListener(r,o):t.removeAllListeners(r),0===t.listenerCount(r)&&t.unsubscribe(r),"function"==typeof c&&n((()=>c()))},publish:(o,c,u)=>e.isStarted()||t.started?r.isBuffer(c)?void t.publish(o,c,u):n(u,a(new Error("data must be a Buffer"),"ERR_DATA_IS_NOT_A_BUFFER")):n(u,a(new Error(i.NOT_STARTED_YET),s.PUBSUB_NOT_STARTED)),ls:r=>{if(!e.isStarted()&&!t.started)return n(r,a(new Error(i.NOT_STARTED_YET),s.PUBSUB_NOT_STARTED));const o=Array.from(t.subscriptions);n((()=>r(null,o)))},peers:(r,o)=>{if(!e.isStarted()&&!t.started)return n(o,a(new Error(i.NOT_STARTED_YET),s.PUBSUB_NOT_STARTED));"function"==typeof r&&(o=r,r=null);const c=Array.from(t.peers.values()).filter((e=>!r||e.topics.has(r))).map((e=>e.info.id.toB58String()));n((()=>o(null,c)))},setMaxListeners:e=>t.setMaxListeners(e)}}}).call(this)}).call(this,{isBuffer:e("../../is-buffer/index.js")})}}},{package:"3box>ipfs>libp2p"}],[5007,{once:5323},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("once");t.exports.emitFirst=function(e,t,r){r=n(r),t.forEach((n=>{e.once(n,((...n)=>{t.forEach((t=>{e.removeListener(t,r)})),r.apply(e,n)}))}))}}}},{package:"3box>ipfs>libp2p"}],[5014,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n="__lodash_hash_undefined__",i=9007199254740991,s="[object Arguments]",o="[object Array]",a="[object Boolean]",c="[object Date]",u="[object Error]",l="[object Function]",h="[object Map]",f="[object Number]",p="[object Object]",d="[object Promise]",b="[object RegExp]",m="[object Set]",g="[object String]",y="[object Symbol]",k="[object WeakMap]",_="[object ArrayBuffer]",E="[object DataView]",S=/^\[object .+?Constructor\]$/,w=/^(?:0|[1-9]\d*)$/,v={};v["[object Float32Array]"]=v["[object Float64Array]"]=v["[object Int8Array]"]=v["[object Int16Array]"]=v["[object Int32Array]"]=v["[object Uint8Array]"]=v["[object Uint8ClampedArray]"]=v["[object Uint16Array]"]=v["[object Uint32Array]"]=!0,v[s]=v[o]=v[_]=v[a]=v[E]=v[c]=v[u]=v[l]=v[h]=v[f]=v[p]=v[b]=v[m]=v[g]=v[k]=!1;var x="object"==typeof global&&global&&global.Object===Object&&global,I="object"==typeof self&&self&&self.Object===Object&&self,A=x||I||Function("return this")(),T="object"==typeof r&&r&&!r.nodeType&&r,R=T&&"object"==typeof t&&t&&!t.nodeType&&t,N=R&&R.exports===T&&x.process,P=function(){try{return N&&N.binding("util")}catch(e){}}(),O=P&&P.isTypedArray;function B(e,t){for(var r=-1,n=e?e.length:0;++r<n;)if(t(e[r],r,e))return!0;return!1}function C(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function D(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function L(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var M,K,j,U=Array.prototype,F=Function.prototype,V=Object.prototype,q=A["__core-js_shared__"],G=(M=/[^.]+$/.exec(q&&q.keys&&q.keys.IE_PROTO||""))?"Symbol(src)_1."+M:"",H=F.toString,z=V.hasOwnProperty,$=V.toString,W=RegExp("^"+H.call(z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Y=A.Symbol,Q=A.Uint8Array,X=V.propertyIsEnumerable,J=U.splice,Z=(K=Object.keys,j=Object,function(e){return K(j(e))}),ee=xe(A,"DataView"),te=xe(A,"Map"),re=xe(A,"Promise"),ne=xe(A,"Set"),ie=xe(A,"WeakMap"),se=xe(Object,"create"),oe=Te(ee),ae=Te(te),ce=Te(re),ue=Te(ne),le=Te(ie),he=Y?Y.prototype:undefined,fe=he?he.valueOf:undefined;function pe(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function de(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function be(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function me(e){var t=-1,r=e?e.length:0;for(this.__data__=new be;++t<r;)this.add(e[t])}function ge(e){this.__data__=new de(e)}function ye(e,t){var r=Ne(e)||function(e){return function(e){return De(e)&&Pe(e)}(e)&&z.call(e,"callee")&&(!X.call(e,"callee")||$.call(e)==s)}(e)?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],n=r.length,i=!!n;for(var o in e)!t&&!z.call(e,o)||i&&("length"==o||Ae(o,n))||r.push(o);return r}function ke(e,t){for(var r=e.length;r--;)if(Re(e[r][0],t))return r;return-1}function _e(e,t,r,n,i){return e===t||(null==e||null==t||!Ce(e)&&!De(t)?e!=e&&t!=t:function(e,t,r,n,i,l){var d=Ne(e),k=Ne(t),S=o,w=o;d||(S=(S=Ie(e))==s?p:S);k||(w=(w=Ie(t))==s?p:w);var v=S==p&&!C(e),x=w==p&&!C(t),I=S==w;if(I&&!v)return l||(l=new ge),d||Le(e)?we(e,t,r,n,i,l):function(e,t,r,n,i,s,o){switch(r){case E:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case _:return!(e.byteLength!=t.byteLength||!n(new Q(e),new Q(t)));case a:case c:case f:return Re(+e,+t);case u:return e.name==t.name&&e.message==t.message;case b:case g:return e==t+"";case h:var l=D;case m:var p=2&s;if(l||(l=L),e.size!=t.size&&!p)return!1;var d=o.get(e);if(d)return d==t;s|=1,o.set(e,t);var k=we(l(e),l(t),n,i,s,o);return o.delete(e),k;case y:if(fe)return fe.call(e)==fe.call(t)}return!1}(e,t,S,r,n,i,l);if(!(2&i)){var A=v&&z.call(e,"__wrapped__"),T=x&&z.call(t,"__wrapped__");if(A||T){var R=A?e.value():e,N=T?t.value():t;return l||(l=new ge),r(R,N,n,i,l)}}if(!I)return!1;return l||(l=new ge),function(e,t,r,n,i,s){var o=2&i,a=Me(e),c=a.length,u=Me(t).length;if(c!=u&&!o)return!1;var l=c;for(;l--;){var h=a[l];if(!(o?h in t:z.call(t,h)))return!1}var f=s.get(e);if(f&&s.get(t))return f==t;var p=!0;s.set(e,t),s.set(t,e);var d=o;for(;++l<c;){var b=e[h=a[l]],m=t[h];if(n)var g=o?n(m,b,h,t,e,s):n(b,m,h,e,t,s);if(!(g===undefined?b===m||r(b,m,n,i,s):g)){p=!1;break}d||(d="constructor"==h)}if(p&&!d){var y=e.constructor,k=t.constructor;y==k||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof k&&k instanceof k||(p=!1)}return s.delete(e),s.delete(t),p}(e,t,r,n,i,l)}(e,t,_e,r,n,i))}function Ee(e){return!(!Ce(e)||function(e){return!!G&&G in e}(e))&&(Oe(e)||C(e)?W:S).test(Te(e))}function Se(e){if(r=(t=e)&&t.constructor,n="function"==typeof r&&r.prototype||V,t!==n)return Z(e);var t,r,n,i=[];for(var s in Object(e))z.call(e,s)&&"constructor"!=s&&i.push(s);return i}function we(e,t,r,n,i,s){var o=2&i,a=e.length,c=t.length;if(a!=c&&!(o&&c>a))return!1;var u=s.get(e);if(u&&s.get(t))return u==t;var l=-1,h=!0,f=1&i?new me:undefined;for(s.set(e,t),s.set(t,e);++l<a;){var p=e[l],d=t[l];if(n)var b=o?n(d,p,l,t,e,s):n(p,d,l,e,t,s);if(b!==undefined){if(b)continue;h=!1;break}if(f){if(!B(t,(function(e,t){if(!f.has(t)&&(p===e||r(p,e,n,i,s)))return f.add(t)}))){h=!1;break}}else if(p!==d&&!r(p,d,n,i,s)){h=!1;break}}return s.delete(e),s.delete(t),h}function ve(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function xe(e,t){var r=function(e,t){return null==e?undefined:e[t]}(e,t);return Ee(r)?r:undefined}pe.prototype.clear=function(){this.__data__=se?se(null):{}},pe.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},pe.prototype.get=function(e){var t=this.__data__;if(se){var r=t[e];return r===n?undefined:r}return z.call(t,e)?t[e]:undefined},pe.prototype.has=function(e){var t=this.__data__;return se?t[e]!==undefined:z.call(t,e)},pe.prototype.set=function(e,t){return this.__data__[e]=se&&t===undefined?n:t,this},de.prototype.clear=function(){this.__data__=[]},de.prototype.delete=function(e){var t=this.__data__,r=ke(t,e);return!(r<0)&&(r==t.length-1?t.pop():J.call(t,r,1),!0)},de.prototype.get=function(e){var t=this.__data__,r=ke(t,e);return r<0?undefined:t[r][1]},de.prototype.has=function(e){return ke(this.__data__,e)>-1},de.prototype.set=function(e,t){var r=this.__data__,n=ke(r,e);return n<0?r.push([e,t]):r[n][1]=t,this},be.prototype.clear=function(){this.__data__={hash:new pe,map:new(te||de),string:new pe}},be.prototype.delete=function(e){return ve(this,e).delete(e)},be.prototype.get=function(e){return ve(this,e).get(e)},be.prototype.has=function(e){return ve(this,e).has(e)},be.prototype.set=function(e,t){return ve(this,e).set(e,t),this},me.prototype.add=me.prototype.push=function(e){return this.__data__.set(e,n),this},me.prototype.has=function(e){return this.__data__.has(e)},ge.prototype.clear=function(){this.__data__=new de},ge.prototype.delete=function(e){return this.__data__.delete(e)},ge.prototype.get=function(e){return this.__data__.get(e)},ge.prototype.has=function(e){return this.__data__.has(e)},ge.prototype.set=function(e,t){var r=this.__data__;if(r instanceof de){var n=r.__data__;if(!te||n.length<199)return n.push([e,t]),this;r=this.__data__=new be(n)}return r.set(e,t),this};var Ie=function(e){return $.call(e)};function Ae(e,t){return!!(t=null==t?i:t)&&("number"==typeof e||w.test(e))&&e>-1&&e%1==0&&e<t}function Te(e){if(null!=e){try{return H.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Re(e,t){return e===t||e!=e&&t!=t}(ee&&Ie(new ee(new ArrayBuffer(1)))!=E||te&&Ie(new te)!=h||re&&Ie(re.resolve())!=d||ne&&Ie(new ne)!=m||ie&&Ie(new ie)!=k)&&(Ie=function(e){var t=$.call(e),r=t==p?e.constructor:undefined,n=r?Te(r):undefined;if(n)switch(n){case oe:return E;case ae:return h;case ce:return d;case ue:return m;case le:return k}return t});var Ne=Array.isArray;function Pe(e){return null!=e&&Be(e.length)&&!Oe(e)}function Oe(e){var t=Ce(e)?$.call(e):"";return t==l||"[object GeneratorFunction]"==t}function Be(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=i}function Ce(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function De(e){return!!e&&"object"==typeof e}var Le=O?function(e){return function(t){return e(t)}}(O):function(e){return De(e)&&Be(e.length)&&!!v[$.call(e)]};function Me(e){return Pe(e)?ye(e):Se(e)}t.exports=function(e,t,r){var n=(r="function"==typeof r?r:undefined)?r(e,t):undefined;return n===undefined?_e(e,t,r):!!n}}}},{package:"3box>ipfs>ipfs-bitswap>lodash.isequalwith"}],[5015,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n=Object.prototype.toString,i=Array.isArray;t.exports=function(e){return"string"==typeof e||!i(e)&&function(e){return!!e&&"object"==typeof e}(e)&&"[object String]"==n.call(e)}}}},{package:"analytics-node>lodash.isstring"}],[5018,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n="Expected a function",i=0/0,s=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,c=/^0o[0-7]+$/i,u=parseInt,l="object"==typeof global&&global&&global.Object===Object&&global,h="object"==typeof self&&self&&self.Object===Object&&self,f=l||h||Function("return this")(),p=Object.prototype.toString,d=Math.max,b=Math.min,m=function(){return f.Date.now()};function g(e,t,r){var i,s,o,a,c,u,l=0,h=!1,f=!1,p=!0;if("function"!=typeof e)throw new TypeError(n);function g(t){var r=i,n=s;return i=s=undefined,l=t,a=e.apply(n,r)}function _(e){return l=e,c=setTimeout(S,t),h?g(e):a}function E(e){var r=e-u;return u===undefined||r>=t||r<0||f&&e-l>=o}function S(){var e=m();if(E(e))return w(e);c=setTimeout(S,function(e){var r=t-(e-u);return f?b(r,o-(e-l)):r}(e))}function w(e){return c=undefined,p&&i?g(e):(i=s=undefined,a)}function v(){var e=m(),r=E(e);if(i=arguments,s=this,u=e,r){if(c===undefined)return _(u);if(f)return c=setTimeout(S,t),g(u)}return c===undefined&&(c=setTimeout(S,t)),a}return t=k(t)||0,y(r)&&(h=!!r.leading,o=(f="maxWait"in r)?d(k(r.maxWait)||0,t):o,p="trailing"in r?!!r.trailing:p),v.cancel=function(){c!==undefined&&clearTimeout(c),l=0,i=u=s=c=undefined},v.flush=function(){return c===undefined?a:w(m())},v}function y(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function k(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==p.call(e)}(e))return i;if(y(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=y(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(s,"");var r=a.test(e);return r||c.test(e)?u(e.slice(2),r?2:8):o.test(e)?i:+e}t.exports=function(e,t,r){var i=!0,s=!0;if("function"!=typeof e)throw new TypeError(n);return y(r)&&(i="leading"in r?!!r.leading:i,s="trailing"in r?!!r.trailing:s),g(e,t,{leading:i,maxWait:t,trailing:s})}}}},{package:"3box>ipfs>libp2p>libp2p-floodsub>libp2p-pubsub>time-cache>lodash.throttle"}],[5032,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}}}},{package:"lodash"}],[5040,{"./_baseAssignValue":5044,"./eq":5166},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_baseAssignValue"),i=e("./eq"),s=Object.prototype.hasOwnProperty;t.exports=function(e,t,r){var o=e[t];s.call(e,t)&&i(o,r)&&(r!==undefined||t in e)||n(e,t,r)}}}},{package:"lodash"}],[5042,{"./_copyObject":5091,"./keys":5186},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_copyObject"),i=e("./keys");t.exports=function(e,t){return e&&n(t,i(t),e)}}}},{package:"lodash"}],[5043,{"./_copyObject":5091,"./keysIn":5187},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_copyObject"),i=e("./keysIn");t.exports=function(e,t){return e&&n(t,i(t),e)}}}},{package:"lodash"}],[5044,{"./_defineProperty":5097},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_defineProperty");t.exports=function(e,t,r){"__proto__"==t&&n?n(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}}}},{package:"lodash"}],[5045,{"./_Stack":5027,"./_arrayEach":5032,"./_assignValue":5040,"./_baseAssign":5042,"./_baseAssignIn":5043,"./_cloneBuffer":5085,"./_copyArray":5090,"./_copySymbols":5092,"./_copySymbolsIn":5093,"./_getAllKeys":5102,"./_getAllKeysIn":5103,"./_getTag":5111,"./_initCloneArray":5119,"./_initCloneByTag":5120,"./_initCloneObject":5121,"./isArray":5172,"./isBuffer":5175,"./isMap":5179,"./isObject":5180,"./isSet":5183,"./keys":5186,"./keysIn":5187},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_Stack"),i=e("./_arrayEach"),s=e("./_assignValue"),o=e("./_baseAssign"),a=e("./_baseAssignIn"),c=e("./_cloneBuffer"),u=e("./_copyArray"),l=e("./_copySymbols"),h=e("./_copySymbolsIn"),f=e("./_getAllKeys"),p=e("./_getAllKeysIn"),d=e("./_getTag"),b=e("./_initCloneArray"),m=e("./_initCloneByTag"),g=e("./_initCloneObject"),y=e("./isArray"),k=e("./isBuffer"),_=e("./isMap"),E=e("./isObject"),S=e("./isSet"),w=e("./keys"),v=e("./keysIn"),x="[object Arguments]",I="[object Function]",A="[object Object]",T={};T[x]=T["[object Array]"]=T["[object ArrayBuffer]"]=T["[object DataView]"]=T["[object Boolean]"]=T["[object Date]"]=T["[object Float32Array]"]=T["[object Float64Array]"]=T["[object Int8Array]"]=T["[object Int16Array]"]=T["[object Int32Array]"]=T["[object Map]"]=T["[object Number]"]=T[A]=T["[object RegExp]"]=T["[object Set]"]=T["[object String]"]=T["[object Symbol]"]=T["[object Uint8Array]"]=T["[object Uint8ClampedArray]"]=T["[object Uint16Array]"]=T["[object Uint32Array]"]=!0,T["[object Error]"]=T[I]=T["[object WeakMap]"]=!1,t.exports=function e(t,r,R,N,P,O){var B,C=1&r,D=2&r,L=4&r;if(R&&(B=P?R(t,N,P,O):R(t)),B!==undefined)return B;if(!E(t))return t;var M=y(t);if(M){if(B=b(t),!C)return u(t,B)}else{var K=d(t),j=K==I||"[object GeneratorFunction]"==K;if(k(t))return c(t,C);if(K==A||K==x||j&&!P){if(B=D||j?{}:g(t),!C)return D?h(t,a(B,t)):l(t,o(B,t))}else{if(!T[K])return P?t:{};B=m(t,K,C)}}O||(O=new n);var U=O.get(t);if(U)return U;O.set(t,B),S(t)?t.forEach((function(n){B.add(e(n,r,R,n,t,O))})):_(t)&&t.forEach((function(n,i){B.set(i,e(n,r,R,i,t,O))}));var F=M?undefined:(L?D?p:f:D?v:w)(t);return i(F||t,(function(n,i){F&&(n=t[i=n]),s(B,i,e(n,r,R,i,t,O))})),B}}}},{package:"lodash"}],[5046,{"./isObject":5180},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./isObject"),i=Object.create,s=function(){function e(){}return function(t){if(!n(t))return{};if(i)return i(t);e.prototype=t;var r=new e;return e.prototype=undefined,r}}();t.exports=s}}},{package:"lodash"}],[5050,{"./_createBaseFor":5095},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_createBaseFor")();t.exports=n}}},{package:"lodash"}],[5051,{"./_baseFor":5050,"./keys":5186},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_baseFor"),i=e("./keys");t.exports=function(e,t){return e&&n(e,t,i)}}}},{package:"lodash"}],[5055,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e,t){return null!=e&&t in Object(e)}}}},{package:"lodash"}],[5061,{"./_getTag":5111,"./isObjectLike":5181},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_getTag"),i=e("./isObjectLike");t.exports=function(e){return i(e)&&"[object Map]"==n(e)}}}},{package:"lodash"}],[5062,{"./_Stack":5027,"./_baseIsEqual":5059},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_Stack"),i=e("./_baseIsEqual");t.exports=function(e,t,r,s){var o=r.length,a=o,c=!s;if(null==e)return!a;for(e=Object(e);o--;){var u=r[o];if(c&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++o<a;){var l=(u=r[o])[0],h=e[l],f=u[1];if(c&&u[2]){if(h===undefined&&!(l in e))return!1}else{var p=new n;if(s)var d=s(h,f,l,e,t,p);if(!(d===undefined?i(f,h,3,s,p):d))return!1}}return!0}}}},{package:"lodash"}],[5065,{"./_getTag":5111,"./isObjectLike":5181},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_getTag"),i=e("./isObjectLike");t.exports=function(e){return i(e)&&"[object Set]"==n(e)}}}},{package:"lodash"}],[5067,{"./_baseMatches":5070,"./_baseMatchesProperty":5071,"./identity":5169,"./isArray":5172,"./property":5192},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_baseMatches"),i=e("./_baseMatchesProperty"),s=e("./identity"),o=e("./isArray"),a=e("./property");t.exports=function(e){return"function"==typeof e?e:null==e?s:"object"==typeof e?o(e)?i(e[0],e[1]):n(e):a(e)}}}},{package:"lodash"}],[5069,{"./_isPrototype":5127,"./_nativeKeysIn":5144,"./isObject":5180},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./isObject"),i=e("./_isPrototype"),s=e("./_nativeKeysIn"),o=Object.prototype.hasOwnProperty;t.exports=function(e){if(!n(e))return s(e);var t=i(e),r=[];for(var a in e)("constructor"!=a||!t&&o.call(e,a))&&r.push(a);return r}}}},{package:"lodash"}],[5070,{"./_baseIsMatch":5062,"./_getMatchData":5105,"./_matchesStrictComparable":5140},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_baseIsMatch"),i=e("./_getMatchData"),s=e("./_matchesStrictComparable");t.exports=function(e){var t=i(e);return 1==t.length&&t[0][2]?s(t[0][0],t[0][1]):function(r){return r===e||n(r,e,t)}}}}},{package:"lodash"}],[5071,{"./_baseIsEqual":5059,"./_isKey":5124,"./_isStrictComparable":5128,"./_matchesStrictComparable":5140,"./_toKey":5162,"./get":5167,"./hasIn":5168},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_baseIsEqual"),i=e("./get"),s=e("./hasIn"),o=e("./_isKey"),a=e("./_isStrictComparable"),c=e("./_matchesStrictComparable"),u=e("./_toKey");t.exports=function(e,t){return o(e)&&a(t)?c(u(e),t):function(r){var o=i(r,e);return o===undefined&&o===t?s(r,e):n(t,o,3)}}}}},{package:"lodash"}],[5072,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e){return function(t){return null==t?undefined:t[e]}}}}},{package:"lodash"}],[5073,{"./_baseGet":5052},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_baseGet");t.exports=function(e){return function(t){return n(t,e)}}}}},{package:"lodash"}],[5084,{"./_Uint8Array":5029},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_Uint8Array");t.exports=function(e){var t=new e.constructor(e.byteLength);return new n(t).set(new n(e)),t}}}},{package:"lodash"}],[5085,{"./_root":5149},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_root"),i="object"==typeof r&&r&&!r.nodeType&&r,s=i&&"object"==typeof t&&t&&!t.nodeType&&t,o=s&&s.exports===i?n.Buffer:undefined,a=o?o.allocUnsafe:undefined;t.exports=function(e,t){if(t)return e.slice();var r=e.length,n=a?a(r):new e.constructor(r);return e.copy(n),n}}}},{package:"lodash"}],[5086,{"./_cloneArrayBuffer":5084},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_cloneArrayBuffer");t.exports=function(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}}}},{package:"lodash"}],[5087,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n=/\w*$/;t.exports=function(e){var t=new e.constructor(e.source,n.exec(e));return t.lastIndex=e.lastIndex,t}}}},{package:"lodash"}],[5088,{"./_Symbol":5028},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_Symbol"),i=n?n.prototype:undefined,s=i?i.valueOf:undefined;t.exports=function(e){return s?Object(s.call(e)):{}}}}},{package:"lodash"}],[5089,{"./_cloneArrayBuffer":5084},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_cloneArrayBuffer");t.exports=function(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}}}},{package:"lodash"}],[5090,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}}}},{package:"lodash"}],[5091,{"./_assignValue":5040,"./_baseAssignValue":5044},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_assignValue"),i=e("./_baseAssignValue");t.exports=function(e,t,r,s){var o=!r;r||(r={});for(var a=-1,c=t.length;++a<c;){var u=t[a],l=s?s(r[u],e[u],u,r,e):undefined;l===undefined&&(l=e[u]),o?i(r,u,l):n(r,u,l)}return r}}}},{package:"lodash"}],[5092,{"./_copyObject":5091,"./_getSymbols":5109},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_copyObject"),i=e("./_getSymbols");t.exports=function(e,t){return n(e,i(e),t)}}}},{package:"lodash"}],[5093,{"./_copyObject":5091,"./_getSymbolsIn":5110},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_copyObject"),i=e("./_getSymbolsIn");t.exports=function(e,t){return n(e,i(e),t)}}}},{package:"lodash"}],[5095,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e){return function(t,r,n){for(var i=-1,s=Object(t),o=n(t),a=o.length;a--;){var c=o[e?a:++i];if(!1===r(s[c],c,s))break}return t}}}}},{package:"lodash"}],[51,{"../../../shared/constants/app":6186,"../../../shared/constants/metametrics":6190,"../../../shared/modules/random-id":6206,"../metamask-controller":85,"./util":84,"@babel/runtime/helpers/interopRequireDefault":202,"@metamask/obs-store":1206,buffer:2132,"eth-rpc-errors":2489,"ethereumjs-util":2564,events:2133,loglevel:5198},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("events")),s=e("@metamask/obs-store"),o=e("ethereumjs-util"),a=e("eth-rpc-errors"),c=n(e("loglevel")),u=e("../../../shared/constants/app"),l=e("../../../shared/constants/metametrics"),h=e("../metamask-controller"),f=n(e("../../../shared/modules/random-id")),p=e("./util");const d=/^[0-9A-Fa-f]+$/gu;class b extends i.default{constructor(e){super(),this.memStore=new s.ObservableStore({unapprovedDecryptMsgs:{},unapprovedDecryptMsgCount:0}),this.messages=[],this.metricsEvent=e.metricsEvent}get unapprovedDecryptMsgCount(){return Object.keys(this.getUnapprovedMsgs()).length}getUnapprovedMsgs(){return this.messages.filter((e=>"unapproved"===e.status)).reduce(((e,t)=>(e[t.id]=t,e)),{})}addUnapprovedMessageAsync(e,t){return new Promise(((r,n)=>{if(!e.from)return void n(new Error("MetaMask Decryption: from field is required."));const i=this.addUnapprovedMessage(e,t);this.once(`${i}:finished`,(t=>{switch(t.status){case"decrypted":return void r(t.rawData);case"rejected":return void n(a.ethErrors.provider.userRejectedRequest("MetaMask Decryption: User denied message decryption."));case"errored":return void n(new Error("This message cannot be decrypted"));default:n(new Error(`MetaMask Decryption: Unknown problem: ${JSON.stringify(e)}`))}}))}))}addUnapprovedMessage(e,t){c.default.debug(`DecryptMessageManager addUnapprovedMessage: ${JSON.stringify(e)}`),t&&(e.origin=t.origin),e.data=this.normalizeMsgData(e.data);const r=(new Date).getTime(),n=(0,f.default)(),i={id:n,msgParams:e,time:r,status:"unapproved",type:u.MESSAGE_TYPE.ETH_DECRYPT};return this.addMsg(i),this.emit("update"),n}addMsg(e){this.messages.push(e),this._saveMsgList()}getMsg(e){return this.messages.find((t=>t.id===e))}approveMessage(e){return this.setMsgStatusApproved(e.metamaskId),this.prepMsgForDecryption(e)}setMsgStatusApproved(e){this._setMsgStatus(e,"approved")}setMsgStatusDecrypted(e,t){const r=this.getMsg(e);r.rawData=t,this._updateMsg(r),this._setMsgStatus(e,"decrypted")}prepMsgForDecryption(e){return delete e.metamaskId,Promise.resolve(e)}rejectMsg(e,t=undefined){t&&this.metricsEvent({event:t,category:l.EVENT.CATEGORIES.MESSAGES,properties:{action:"Decrypt Message Request"}}),this._setMsgStatus(e,"rejected")}errorMessage(e,t){const r=this.getMsg(e);r.error=t,this._updateMsg(r),this._setMsgStatus(e,"errored")}clearUnapproved(){this.messages=this.messages.filter((e=>"unapproved"!==e.status)),this._saveMsgList()}_setMsgStatus(e,t){const r=this.getMsg(e);if(!r)throw new Error(`DecryptMessageManager - Message not found for id: "${e}".`);r.status=t,this._updateMsg(r),this.emit(`${e}:${t}`,r),"rejected"!==t&&"decrypted"!==t&&"errored"!==t||this.emit(`${e}:finished`,r)}_updateMsg(e){const t=this.messages.findIndex((t=>t.id===e.id));-1!==t&&(this.messages[t]=e),this._saveMsgList()}_saveMsgList(){const e=this.getUnapprovedMsgs(),t=Object.keys(e).length;this.memStore.updateState({unapprovedDecryptMsgs:e,unapprovedDecryptMsgCount:t}),this.emit(h.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE)}normalizeMsgData(e){try{const t=(0,o.stripHexPrefix)(e);if(t.match(d))return(0,p.addHexPrefix)(t)}catch(e){c.default.debug("Message was not hex encoded, interpreting as utf8.")}return(0,o.bufferToHex)(t.from(e,"utf8"))}}r.default=b}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"$root$"}],[5103,{"./_baseGetAllKeys":5053,"./_getSymbolsIn":5110,"./keysIn":5187},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_baseGetAllKeys"),i=e("./_getSymbolsIn"),s=e("./keysIn");t.exports=function(e){return n(e,s,i)}}}},{package:"lodash"}],[5105,{"./_isStrictComparable":5128,"./keys":5186},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_isStrictComparable"),i=e("./keys");t.exports=function(e){for(var t=i(e),r=t.length;r--;){var s=t[r],o=e[s];t[r]=[s,o,n(o)]}return t}}}},{package:"lodash"}],[5110,{"./_arrayPush":5038,"./_getPrototype":5107,"./_getSymbols":5109,"./stubArray":5193},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_arrayPush"),i=e("./_getPrototype"),s=e("./_getSymbols"),o=e("./stubArray"),a=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)n(t,s(e)),e=i(e);return t}:o;t.exports=a}}},{package:"lodash"}],[5113,{"./_castPath":5083,"./_isIndex":5123,"./_toKey":5162,"./isArguments":5171,"./isArray":5172,"./isLength":5178},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_castPath"),i=e("./isArguments"),s=e("./isArray"),o=e("./_isIndex"),a=e("./isLength"),c=e("./_toKey");t.exports=function(e,t,r){for(var u=-1,l=(t=n(t,e)).length,h=!1;++u<l;){var f=c(t[u]);if(!(h=null!=e&&r(e,f)))break;e=e[f]}return h||++u!=l?h:!!(l=null==e?0:e.length)&&a(l)&&o(f,l)&&(s(e)||i(e))}}}},{package:"lodash"}],[5119,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n=Object.prototype.hasOwnProperty;t.exports=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&n.call(e,"index")&&(r.index=e.index,r.input=e.input),r}}}},{package:"lodash"}],[5120,{"./_cloneArrayBuffer":5084,"./_cloneDataView":5086,"./_cloneRegExp":5087,"./_cloneSymbol":5088,"./_cloneTypedArray":5089},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_cloneArrayBuffer"),i=e("./_cloneDataView"),s=e("./_cloneRegExp"),o=e("./_cloneSymbol"),a=e("./_cloneTypedArray");t.exports=function(e,t,r){var c=e.constructor;switch(t){case"[object ArrayBuffer]":return n(e);case"[object Boolean]":case"[object Date]":return new c(+e);case"[object DataView]":return i(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return a(e,r);case"[object Map]":case"[object Set]":return new c;case"[object Number]":case"[object String]":return new c(e);case"[object RegExp]":return s(e);case"[object Symbol]":return o(e)}}}}},{package:"lodash"}],[5121,{"./_baseCreate":5046,"./_getPrototype":5107,"./_isPrototype":5127},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_baseCreate"),i=e("./_getPrototype"),s=e("./_isPrototype");t.exports=function(e){return"function"!=typeof e.constructor||s(e)?{}:n(i(e))}}}},{package:"lodash"}],[5128,{"./isObject":5180},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./isObject");t.exports=function(e){return e==e&&!n(e)}}}},{package:"lodash"}],[5140,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e,t){return function(r){return null!=r&&(r[e]===t&&(t!==undefined||e in Object(r)))}}}}},{package:"lodash"}],[5144,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}}}},{package:"lodash"}],[5164,{"./_baseClone":5045},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_baseClone");t.exports=function(e){return n(e,5)}}}},{package:"lodash"}],[5168,{"./_baseHasIn":5055,"./_hasPath":5113},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_baseHasIn"),i=e("./_hasPath");t.exports=function(e,t){return null!=e&&i(e,t,n)}}}},{package:"lodash"}],[5179,{"./_baseIsMap":5061,"./_baseUnary":5078,"./_nodeUtil":5145},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_baseIsMap"),i=e("./_baseUnary"),s=e("./_nodeUtil"),o=s&&s.isMap,a=o?i(o):n;t.exports=a}}},{package:"lodash"}],[5183,{"./_baseIsSet":5065,"./_baseUnary":5078,"./_nodeUtil":5145},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_baseIsSet"),i=e("./_baseUnary"),s=e("./_nodeUtil"),o=s&&s.isSet,a=o?i(o):n;t.exports=a}}},{package:"lodash"}],[5187,{"./_arrayLikeKeys":5036,"./_baseKeysIn":5069,"./isArrayLike":5173},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_arrayLikeKeys"),i=e("./_baseKeysIn"),s=e("./isArrayLike");t.exports=function(e){return s(e)?n(e,!0):i(e)}}}},{package:"lodash"}],[5189,{"./_baseAssignValue":5044,"./_baseForOwn":5051,"./_baseIteratee":5067},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_baseAssignValue"),i=e("./_baseForOwn"),s=e("./_baseIteratee");t.exports=function(e,t){var r={};return t=s(t,3),i(e,(function(e,i,s){n(r,i,t(e,i,s))})),r}}}},{package:"lodash"}],[5192,{"./_baseProperty":5072,"./_basePropertyDeep":5073,"./_isKey":5124,"./_toKey":5162},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./_baseProperty"),i=e("./_basePropertyDeep"),s=e("./_isKey"),o=e("./_toKey");t.exports=function(e){return s(e)?n(o(e)):i(e)}}}},{package:"lodash"}],[5199,{_process:5430,events:2133,fs:2131,util:2138},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("fs"),i=e("util").format,s=e("events").EventEmitter;let o=!(r.type&&"renderer"===r.type||!r.version);const a={DEBUG:"DEBUG",INFO:"INFO",WARN:"WARN",ERROR:"ERROR",NONE:"NONE"};let c=a.DEBUG,u=null,l=new s,h={Black:0,Red:1,Green:2,Yellow:3,Blue:4,Magenta:5,Cyan:6,Grey:7,White:9,Default:9};o||(h={Black:"Black",Red:"IndianRed",Green:"LimeGreen",Yellow:"Orange",Blue:"RoyalBlue",Magenta:"Orchid",Cyan:"SkyBlue",Grey:"DimGrey",White:"White",Default:"Black"});const f=[h.Cyan,h.Green,h.Yellow,h.Red,h.Default],p={useColors:!0,color:h.Default,showTimestamp:!0,useLocalTime:!1,showLevel:!0,filename:u,appendFile:!0};class d{constructor(e,t){this.category=e;let r={};Object.assign(r,p),Object.assign(r,t),this.options=r,this.debug=this.debug.bind(this),this.log=this.log.bind(this),this.info=this.info.bind(this),this.warn=this.warn.bind(this),this.error=this.error.bind(this)}debug(){this._shouldLog(a.DEBUG)&&this._write(a.DEBUG,i.apply(null,arguments))}log(){this._shouldLog(a.DEBUG)&&this.debug.apply(this,arguments)}info(){this._shouldLog(a.INFO)&&this._write(a.INFO,i.apply(null,arguments))}warn(){this._shouldLog(a.WARN)&&this._write(a.WARN,i.apply(null,arguments))}error(){this._shouldLog(a.ERROR)&&this._write(a.ERROR,i.apply(null,arguments))}_write(e,t){(this.options.filename||u)&&!this.fileWriter&&o&&(this.fileWriter=n.openSync(this.options.filename||u,this.options.appendFile?"a+":"w+"));let r=this._format(e,t),i=this._createLogMessage(e,t),s=this._createLogMessage(e,t,r.timestamp,r.level,r.category,r.text);this.fileWriter&&o&&n.writeSync(this.fileWriter,i+"\n",null,"utf-8"),o||!this.options.useColors?(console.log(s),l.emit("data",this.category,e,t)):e===a.ERROR?this.options.showTimestamp&&this.options.showLevel?console.error(s,r.timestamp,r.level,r.category,r.text):this.options.showTimestamp&&!this.options.showLevel?console.error(s,r.timestamp,r.category,r.text):!this.options.showTimestamp&&this.options.showLevel?console.error(s,r.level,r.category,r.text):console.error(s,r.category,r.text):this.options.showTimestamp&&this.options.showLevel?console.log(s,r.timestamp,r.level,r.category,r.text):this.options.showTimestamp&&!this.options.showLevel?console.log(s,r.timestamp,r.category,r.text):!this.options.showTimestamp&&this.options.showLevel?console.log(s,r.level,r.category,r.text):console.log(s,r.category,r.text)}_format(e,t){let r="",n="",i="",s=": ";if(this.options.useColors){const t=Object.keys(a).map((e=>a[e])).indexOf(e),c=this.options.color;o?(this.options.showTimestamp&&(r="[3"+h.Grey+"m"),this.options.showLevel&&(n="[3"+f[t]+";22m"),i="[3"+c+";1m",s="[0m: "):(this.options.showTimestamp&&(r="color:"+h.Grey),this.options.showLevel&&(n="color:"+f[t]),i="color:"+c+"; font-weight: bold")}return{timestamp:r,level:n,category:i,text:s}}_createLogMessage(e,t,r,n,i,s){r=r||"",n=n||"",i=i||"",s=s||": ",!o&&this.options.useColors&&(this.options.showTimestamp&&(r="%c"),this.options.showLevel&&(n="%c"),i="%c",s=": %c");let c="";return this.options.showTimestamp&&!this.options.useLocalTime&&(c+=(new Date).toISOString()+" "),this.options.showTimestamp&&this.options.useLocalTime&&(c+=(new Date).toLocaleString()+" "),c=r+c,this.options.showLevel&&(c+=n+"["+e+"]"+(e===a.INFO||e===a.WARN?" ":"")+" "),c+=i+this.category,c+=s+t,c}_shouldLog(e){let t=void 0!==r&&r.env!==undefined&&r.env.LOG!==undefined?r.env.LOG.toUpperCase():null;t="undefined"!=typeof window&&window.LOG?window.LOG.toUpperCase():t;const n=t||c,i=Object.keys(a).map((e=>a[e]));return i.indexOf(e)>=i.indexOf(n)}}t.exports={Colors:h,LogLevels:a,setLogLevel:e=>{c=e},setLogfile:e=>{u=e},create:(e,t)=>new d(e,t),forceBrowserMode:e=>o=!e,events:l}}).call(this)}).call(this,e("_process"))}}},{package:"3box>orbit-db>logplease"}],[52,{"../../../shared/constants/app":6186,"../../../shared/constants/metametrics":6190,"../../../shared/modules/random-id":6206,"../metamask-controller":85,"@babel/runtime/helpers/interopRequireDefault":202,"@metamask/obs-store":1206,"eth-rpc-errors":2489,events:2133,loglevel:5198},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("events")),s=e("@metamask/obs-store"),o=e("eth-rpc-errors"),a=n(e("loglevel")),c=e("../../../shared/constants/app"),u=e("../../../shared/constants/metametrics"),l=e("../metamask-controller"),h=n(e("../../../shared/modules/random-id"));class f extends i.default{constructor(e){super(),this.memStore=new s.ObservableStore({unapprovedEncryptionPublicKeyMsgs:{},unapprovedEncryptionPublicKeyMsgCount:0}),this.messages=[],this.metricsEvent=e.metricsEvent}get unapprovedEncryptionPublicKeyMsgCount(){return Object.keys(this.getUnapprovedMsgs()).length}getUnapprovedMsgs(){return this.messages.filter((e=>"unapproved"===e.status)).reduce(((e,t)=>(e[t.id]=t,e)),{})}addUnapprovedMessageAsync(e,t){return new Promise(((r,n)=>{if(!e)return void n(new Error("MetaMask Message: address field is required."));const i=this.addUnapprovedMessage(e,t);this.once(`${i}:finished`,(t=>{switch(t.status){case"received":return void r(t.rawData);case"rejected":return void n(o.ethErrors.provider.userRejectedRequest("MetaMask EncryptionPublicKey: User denied message EncryptionPublicKey."));default:n(new Error(`MetaMask EncryptionPublicKey: Unknown problem: ${JSON.stringify(e)}`))}}))}))}addUnapprovedMessage(e,t){a.default.debug("EncryptionPublicKeyManager addUnapprovedMessage: address");const r=(new Date).getTime(),n=(0,h.default)(),i={id:n,msgParams:e,time:r,status:"unapproved",type:c.MESSAGE_TYPE.ETH_GET_ENCRYPTION_PUBLIC_KEY};return t&&(i.origin=t.origin),this.addMsg(i),this.emit("update"),n}addMsg(e){this.messages.push(e),this._saveMsgList()}getMsg(e){return this.messages.find((t=>t.id===e))}approveMessage(e){return this.setMsgStatusApproved(e.metamaskId),this.prepMsgForEncryptionPublicKey(e)}setMsgStatusApproved(e){this._setMsgStatus(e,"approved")}setMsgStatusReceived(e,t){const r=this.getMsg(e);r.rawData=t,this._updateMsg(r),this._setMsgStatus(e,"received")}prepMsgForEncryptionPublicKey(e){return delete e.metamaskId,Promise.resolve(e)}rejectMsg(e,t=undefined){t&&this.metricsEvent({event:t,category:u.EVENT.CATEGORIES.MESSAGES,properties:{action:"Encryption public key Request"}}),this._setMsgStatus(e,"rejected")}errorMessage(e,t){const r=this.getMsg(e);r.error=t,this._updateMsg(r),this._setMsgStatus(e,"errored")}clearUnapproved(){this.messages=this.messages.filter((e=>"unapproved"!==e.status)),this._saveMsgList()}_setMsgStatus(e,t){const r=this.getMsg(e);if(!r)throw new Error(`EncryptionPublicKeyManager - Message not found for id: "${e}".`);r.status=t,this._updateMsg(r),this.emit(`${e}:${t}`,r),"rejected"!==t&&"received"!==t||this.emit(`${e}:finished`,r)}_updateMsg(e){const t=this.messages.findIndex((t=>t.id===e.id));-1!==t&&(this.messages[t]=e),this._saveMsgList()}_saveMsgList(){const e=this.getUnapprovedMsgs(),t=Object.keys(e).length;this.memStore.updateState({unapprovedEncryptionPublicKeyMsgs:e,unapprovedEncryptionPublicKeyMsgCount:t}),this.emit(l.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE)}}r.default=f}}},{package:"$root$"}],[5200,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e){!function t(){var r=!0,n=!1;do{n=!0,r=!1,e.call(this,(function(){n?r=!0:t()})),n=!1}while(r)}()}}}},{package:"3box>ipfs>stream-to-pull-stream>looper"}],[5203,{events:2133,inherits:4453},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("events"),i=e("inherits");function s(e){if(!(this instanceof s))return new s(e);"number"==typeof e&&(e={max:e}),e||(e={}),n.EventEmitter.call(this),this.cache={},this.head=this.tail=null,this.length=0,this.max=e.max||1e3,this.maxAge=e.maxAge||0}t.exports=s,i(s,n.EventEmitter),Object.defineProperty(s.prototype,"keys",{get:function(){return Object.keys(this.cache)}}),s.prototype.clear=function(){this.cache={},this.head=this.tail=null,this.length=0},s.prototype.remove=function(e){if("string"!=typeof e&&(e=""+e),this.cache.hasOwnProperty(e)){var t=this.cache[e];return delete this.cache[e],this._unlink(e,t.prev,t.next),t.value}},s.prototype._unlink=function(e,t,r){this.length--,0===this.length?this.head=this.tail=null:this.head===e?(this.head=t,this.cache[this.head].next=null):this.tail===e?(this.tail=r,this.cache[this.tail].prev=null):(this.cache[t].next=r,this.cache[r].prev=t)},s.prototype.peek=function(e){if(this.cache.hasOwnProperty(e)){var t=this.cache[e];if(this._checkAge(e,t))return t.value}},s.prototype.set=function(e,t){var r;if("string"!=typeof e&&(e=""+e),this.cache.hasOwnProperty(e)){if((r=this.cache[e]).value=t,this.maxAge&&(r.modified=Date.now()),e===this.head)return t;this._unlink(e,r.prev,r.next)}else r={value:t,modified:0,next:null,prev:null},this.maxAge&&(r.modified=Date.now()),this.cache[e]=r,this.length===this.max&&this.evict();return this.length++,r.next=null,r.prev=this.head,this.head&&(this.cache[this.head].next=e),this.head=e,this.tail||(this.tail=e),t},s.prototype._checkAge=function(e,t){return!(this.maxAge&&Date.now()-t.modified>this.maxAge)||(this.remove(e),this.emit("evict",{key:e,value:t.value}),!1)},s.prototype.get=function(e){if("string"!=typeof e&&(e=""+e),this.cache.hasOwnProperty(e)){var t=this.cache[e];if(this._checkAge(e,t))return this.head!==e&&(e===this.tail?(this.tail=t.next,this.cache[this.tail].prev=null):this.cache[t.prev].next=t.next,this.cache[t.next].prev=t.prev,this.cache[this.head].next=e,t.prev=this.head,t.next=null,this.head=e),t.value}},s.prototype.evict=function(){if(this.tail){var e=this.tail,t=this.remove(this.tail);this.emit("evict",{key:e,value:t})}}}}},{package:"3box>orbit-db>orbit-db-keystore>lru"}],[5204,{"../is-buffer/index.js":4735},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e){(function(){function t(e){return e!==undefined&&""!==e}function n(e,t){return Object.hasOwnProperty.call(e,t)}function i(e,t){return Object.hasOwnProperty.call(e,t)&&t}r.compare=function(t,r){if(e.isBuffer(t)){for(var n=Math.min(t.length,r.length),i=0;i<n;i++){var s=t[i]-r[i];if(s)return s}return t.length-r.length}return t<r?-1:t>r?1:0};var s=r.lowerBoundKey=function(e){return i(e,"gt")||i(e,"gte")||i(e,"min")||(e.reverse?i(e,"end"):i(e,"start"))||undefined},o=r.lowerBound=function(e,t){var r=s(e);return r?e[r]:t},a=r.lowerBoundInclusive=function(e){return!n(e,"gt")},c=r.upperBoundInclusive=function(e){return!n(e,"lt")},u=r.lowerBoundExclusive=function(e){return!a(e)},l=r.upperBoundExclusive=function(e){return!c(e)},h=r.upperBoundKey=function(e){return i(e,"lt")||i(e,"lte")||i(e,"max")||(e.reverse?i(e,"start"):i(e,"end"))||undefined},f=r.upperBound=function(e,t){var r=h(e);return r?e[r]:t};function p(e){return e}r.start=function(e,t){return e.reverse?f(e,t):o(e,t)},r.end=function(e,t){return e.reverse?o(e,t):f(e,t)},r.startInclusive=function(e){return e.reverse?c(e):a(e)},r.endInclusive=function(e){return e.reverse?a(e):c(e)},r.toLtgt=function(e,t,i,s,o){t=t||{},i=i||p;var a=arguments.length>3,c=r.lowerBoundKey(e),u=r.upperBoundKey(e);return c?"gt"===c?t.gt=i(e.gt,!1):t.gte=i(e[c],!1):a&&(t.gte=i(s,!1)),u?"lt"===u?t.lt=i(e.lt,!0):t.lte=i(e[u],!0):a&&(t.lte=i(o,!0)),null!=e.reverse&&(t.reverse=!!e.reverse),n(t,"max")&&delete t.max,n(t,"min")&&delete t.min,n(t,"start")&&delete t.start,n(t,"end")&&delete t.end,t},r.contains=function(e,n,i){i=i||r.compare;var s=o(e);if(t(s)&&((a=i(n,s))<0||0===a&&u(e)))return!1;var a,c=f(e);if(t(c)&&((a=i(n,c))>0||0===a&&l(e)))return!1;return!0},r.filter=function(e,t){return function(n){return r.contains(e,n,t)}}}).call(this)}).call(this,{isBuffer:e("../is-buffer/index.js")})}}},{package:"3box>orbit-db>orbit-db-cache>level-js>ltgt"}],[5206,{multiaddr:5224},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("multiaddr"),i=R("dns4"),s=R("dns6"),o=T(R("dnsaddr"),i,s),a=T(R("ip4"),R("ip6")),c=T(A(a,R("tcp")),A(o,R("tcp"))),u=A(a,R("udp")),l=A(u,R("utp")),h=T(A(o,R("tcp")),o),f=T(A(c,R("ws")),A(h,R("ws"))),p=T(A(c,R("wss")),A(h,R("wss"))),d=T(A(c,R("http")),A(a,R("http")),A(h,R("http")),A(h)),b=T(A(c,R("https")),A(a,R("https")),A(h,R("https"))),m=T(A(f,R("p2p-webrtc-star"),R("ipfs")),A(p,R("p2p-webrtc-star"),R("ipfs"))),g=T(A(f,R("p2p-websocket-star"),R("ipfs")),A(p,R("p2p-websocket-star"),R("ipfs")),A(f,R("p2p-websocket-star")),A(p,R("p2p-websocket-star"))),y=T(A(d,R("p2p-webrtc-direct")),A(b,R("p2p-webrtc-direct"))),k=T(f,p,d,b,m,y,c,l),_=T(A(k,R("p2p-stardust"),R("ipfs")),A(k,R("p2p-stardust")));let E=T(A(k,R("ipfs")),m,R("ipfs"));const S=T(A(E,R("p2p-circuit"),E),A(E,R("p2p-circuit")),A(R("p2p-circuit"),E),A(k,R("p2p-circuit")),A(R("p2p-circuit"),k),R("p2p-circuit")),w=()=>T(A(S,w),S),v=w(),x=T(A(v,E,v),A(E,v),A(v,E),v,E);function I(e){return function(t){if(!n.isMultiaddr(t))try{t=n(t)}catch(e){return!1}let r=e(t.protoNames());return null!==r&&0===r.length}}function A(){const e=Array.from(arguments);function t(t){return t.length<e.length?null:(e.some((e=>{if(null===(t="function"==typeof e?e().partialMatch(t):e.partialMatch(t)))return!0})),t)}return{toString:function(){return"{ "+e.join(" ")+" }"},input:e,matches:I(t),partialMatch:t}}function T(){const e=Array.from(arguments);function t(t){let r=null;return e.some((e=>{const n="function"==typeof e?e().partialMatch(t):e.partialMatch(t);if(n)return r=n,!0})),r}const r={toString:function(){return"{ "+e.join(" ")+" }"},input:e,matches:I(t),partialMatch:t};return r}function R(e){const t=e;return{toString:function(){return t},matches:function(e){if("string"==typeof e)try{e=n(e)}catch(e){return!1}const r=e.protoNames();return 1===r.length&&r[0]===t},partialMatch:function(e){return 0===e.length?null:e[0]===t?e.slice(1):null}}}r.DNS=h,r.DNS4=i,r.DNS6=s,r.IP=a,r.TCP=c,r.UDP=u,r.UTP=l,r.HTTP=d,r.HTTPS=b,r.WebSockets=f,r.WebSocketsSecure=p,r.WebSocketStar=g,r.WebRTCStar=m,r.WebRTCDirect=y,r.Reliable=k,r.Stardust=_,r.Circuit=v,r.IPFS=x}}},{package:"3box>ipfs>mafmt"}],[5208,{charenc:2167,crypt:2241,"is-buffer":4735},function(){with(this)return function(){"use strict";return function(e,t,r){var n,i,s,o,a;n=e("crypt"),i=e("charenc").utf8,s=e("is-buffer"),o=e("charenc").bin,(a=function(e,t){e.constructor==String?e=t&&"binary"===t.encoding?o.stringToBytes(e):i.stringToBytes(e):s(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||e.constructor===Uint8Array||(e=e.toString());for(var r=n.bytesToWords(e),c=8*e.length,u=1732584193,l=-271733879,h=-1732584194,f=271733878,p=0;p<r.length;p++)r[p]=16711935&(r[p]<<8|r[p]>>>24)|4278255360&(r[p]<<24|r[p]>>>8);r[c>>>5]|=128<<c%32,r[14+(c+64>>>9<<4)]=c;var d=a._ff,b=a._gg,m=a._hh,g=a._ii;for(p=0;p<r.length;p+=16){var y=u,k=l,_=h,E=f;u=d(u,l,h,f,r[p+0],7,-680876936),f=d(f,u,l,h,r[p+1],12,-389564586),h=d(h,f,u,l,r[p+2],17,606105819),l=d(l,h,f,u,r[p+3],22,-1044525330),u=d(u,l,h,f,r[p+4],7,-176418897),f=d(f,u,l,h,r[p+5],12,1200080426),h=d(h,f,u,l,r[p+6],17,-1473231341),l=d(l,h,f,u,r[p+7],22,-45705983),u=d(u,l,h,f,r[p+8],7,1770035416),f=d(f,u,l,h,r[p+9],12,-1958414417),h=d(h,f,u,l,r[p+10],17,-42063),l=d(l,h,f,u,r[p+11],22,-1990404162),u=d(u,l,h,f,r[p+12],7,1804603682),f=d(f,u,l,h,r[p+13],12,-40341101),h=d(h,f,u,l,r[p+14],17,-1502002290),u=b(u,l=d(l,h,f,u,r[p+15],22,1236535329),h,f,r[p+1],5,-165796510),f=b(f,u,l,h,r[p+6],9,-1069501632),h=b(h,f,u,l,r[p+11],14,643717713),l=b(l,h,f,u,r[p+0],20,-373897302),u=b(u,l,h,f,r[p+5],5,-701558691),f=b(f,u,l,h,r[p+10],9,38016083),h=b(h,f,u,l,r[p+15],14,-660478335),l=b(l,h,f,u,r[p+4],20,-405537848),u=b(u,l,h,f,r[p+9],5,568446438),f=b(f,u,l,h,r[p+14],9,-1019803690),h=b(h,f,u,l,r[p+3],14,-187363961),l=b(l,h,f,u,r[p+8],20,1163531501),u=b(u,l,h,f,r[p+13],5,-1444681467),f=b(f,u,l,h,r[p+2],9,-51403784),h=b(h,f,u,l,r[p+7],14,1735328473),u=m(u,l=b(l,h,f,u,r[p+12],20,-1926607734),h,f,r[p+5],4,-378558),f=m(f,u,l,h,r[p+8],11,-2022574463),h=m(h,f,u,l,r[p+11],16,1839030562),l=m(l,h,f,u,r[p+14],23,-35309556),u=m(u,l,h,f,r[p+1],4,-1530992060),f=m(f,u,l,h,r[p+4],11,1272893353),h=m(h,f,u,l,r[p+7],16,-155497632),l=m(l,h,f,u,r[p+10],23,-1094730640),u=m(u,l,h,f,r[p+13],4,681279174),f=m(f,u,l,h,r[p+0],11,-358537222),h=m(h,f,u,l,r[p+3],16,-722521979),l=m(l,h,f,u,r[p+6],23,76029189),u=m(u,l,h,f,r[p+9],4,-640364487),f=m(f,u,l,h,r[p+12],11,-421815835),h=m(h,f,u,l,r[p+15],16,530742520),u=g(u,l=m(l,h,f,u,r[p+2],23,-995338651),h,f,r[p+0],6,-198630844),f=g(f,u,l,h,r[p+7],10,1126891415),h=g(h,f,u,l,r[p+14],15,-1416354905),l=g(l,h,f,u,r[p+5],21,-57434055),u=g(u,l,h,f,r[p+12],6,1700485571),f=g(f,u,l,h,r[p+3],10,-1894986606),h=g(h,f,u,l,r[p+10],15,-1051523),l=g(l,h,f,u,r[p+1],21,-2054922799),u=g(u,l,h,f,r[p+8],6,1873313359),f=g(f,u,l,h,r[p+15],10,-30611744),h=g(h,f,u,l,r[p+6],15,-1560198380),l=g(l,h,f,u,r[p+13],21,1309151649),u=g(u,l,h,f,r[p+4],6,-145523070),f=g(f,u,l,h,r[p+11],10,-1120210379),h=g(h,f,u,l,r[p+2],15,718787259),l=g(l,h,f,u,r[p+9],21,-343485551),u=u+y>>>0,l=l+k>>>0,h=h+_>>>0,f=f+E>>>0}return n.endian([u,l,h,f])})._ff=function(e,t,r,n,i,s,o){var a=e+(t&r|~t&n)+(i>>>0)+o;return(a<<s|a>>>32-s)+t},a._gg=function(e,t,r,n,i,s,o){var a=e+(t&n|r&~n)+(i>>>0)+o;return(a<<s|a>>>32-s)+t},a._hh=function(e,t,r,n,i,s,o){var a=e+(t^r^n)+(i>>>0)+o;return(a<<s|a>>>32-s)+t},a._ii=function(e,t,r,n,i,s,o){var a=e+(r^(t|~n))+(i>>>0)+o;return(a<<s|a>>>32-s)+t},a._blocksize=16,a._digestsize=16,t.exports=function(e,t){if(e===undefined||null===e)throw new Error("Illegal argument "+e);var r=n.wordsToBytes(a(e,t));return t&&t.asBytes?r:t&&t.asString?o.bytesToString(r):n.bytesToHex(r)}}}},{package:"analytics-node>md5"}],[5209,{"is-plain-obj":4749},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("is-plain-obj"),i=Object.prototype.hasOwnProperty,s=Object.propertyIsEnumerable,o=(e,t,r)=>Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0}),a=this,c={concatArrays:!1},u=e=>{const t=[];for(const r in e)i.call(e,r)&&t.push(r);if(Object.getOwnPropertySymbols){const r=Object.getOwnPropertySymbols(e);for(let n=0;n<r.length;n++)s.call(e,r[n])&&t.push(r[n])}return t};function l(e){return Array.isArray(e)?function(e){const t=e.slice(0,0);return u(e).forEach((r=>{o(t,r,l(e[r]))})),t}(e):n(e)?function(e){const t=null===Object.getPrototypeOf(e)?Object.create(null):{};return u(e).forEach((r=>{o(t,r,l(e[r]))})),t}(e):e}const h=(e,t,r,n)=>(r.forEach((r=>{r in e&&e[r]!==Object.getPrototypeOf(e)?o(e,r,f(e[r],t[r],n)):o(e,r,l(t[r]))})),e);function f(e,t,r){return r.concatArrays&&Array.isArray(e)&&Array.isArray(t)?((e,t,r)=>{let n=e.slice(0,0),s=0;return[e,t].forEach((t=>{const a=[];for(let r=0;r<t.length;r++)i.call(t,r)&&(a.push(String(r)),o(n,s++,t===e?t[r]:l(t[r])));n=h(n,t,u(t).filter((e=>-1===a.indexOf(e))),r)})),n})(e,t,r):n(t)&&n(e)?h(e,t,u(t),r):l(t)}t.exports=function(){const e=f(l(c),this!==a&&this||{},c);let t={foobar:{}};for(let r=0;r<arguments.length;r++){const i=arguments[r];if(i!==undefined){if(!n(i))throw new TypeError("`"+i+"` is not an Option Object");t=f(t,{foobar:i},e)}}return t.foobar}}}},{package:"3box>ipfs>merge-options"}],[5215,{"./constants":5216,events:2133,"observable-webworkers":5322,shortid:5829},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("events").EventEmitter,i=e("shortid"),{WORKER_REQUEST_READ_LOCK:s,WORKER_RELEASE_READ_LOCK:o,MASTER_GRANT_READ_LOCK:a,WORKER_REQUEST_WRITE_LOCK:c,WORKER_RELEASE_WRITE_LOCK:u,MASTER_GRANT_WRITE_LOCK:l}=e("./constants"),h=e("observable-webworkers"),f=(e,t,r,n,i)=>(s,o)=>{if(!o||!o.data||o.data.type!==r)return;const a={type:o.data.type,name:o.data.name,identifier:o.data.identifier};e.emit(t,a.name,(()=>(s.postMessage({type:i,name:a.name,identifier:a.identifier}),new Promise((e=>{const t=r=>{if(!r||!r.data)return;const i={type:r.data.type,name:r.data.name,identifier:r.data.identifier};i&&i.type===n&&i.identifier===a.identifier&&(s.removeEventListener("message",t),e())};s.addEventListener("message",t)})))))},p=(e,t,r,n,s)=>o=>{const a=i.generate();return e.postMessage({type:r,identifier:a,name:t}),new Promise(((r,i)=>{const c=u=>{if(!u||!u.data)return;const l={type:u.data.type,identifier:u.data.identifier};if(l&&l.type===n&&l.identifier===a){let n;e.removeEventListener("message",c),o().catch((e=>{n=e})).then((o=>(e.postMessage({type:s,identifier:a,name:t}),n?i(n):r(o))))}};e.addEventListener("message",c)}))},d={global:global,singleProcess:!1};t.exports=e=>{if(!!(e=Object.assign({},d,e)).global.document||e.singleProcess){const e=new n;return h.addEventListener("message",f(e,"requestReadLock",s,o,a)),h.addEventListener("message",f(e,"requestWriteLock",c,u,l)),e}return{isWorker:!0,readLock:(e,t)=>p(t.global,e,s,a,o),writeLock:(e,t)=>p(t.global,e,c,l,u)}}}}},{package:"3box>ipfs>ipfs-mfs>mortice"}],[5216,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={WORKER_REQUEST_READ_LOCK:"lock:worker:request-read",WORKER_RELEASE_READ_LOCK:"lock:worker:release-read",MASTER_GRANT_READ_LOCK:"lock:master:grant-read",WORKER_REQUEST_WRITE_LOCK:"lock:worker:request-write",WORKER_RELEASE_WRITE_LOCK:"lock:worker:release-write",MASTER_GRANT_WRITE_LOCK:"lock:master:grant-write"}}}},{package:"3box>ipfs>ipfs-mfs>mortice"}],[5217,{"./browser":5215,"./node":5218,"observable-webworkers":5322,"p-queue":5377,"promise-timeout":5431},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("./node"),i=e("./browser"),s=e("p-queue"),{timeout:o}=e("promise-timeout"),a=e("observable-webworkers"),c={};let u;const l={concurrency:Infinity,timeout:846e5,global:global,singleProcess:!1};t.exports=(e,t)=>(t||(t={}),"object"==typeof e&&(t=e,e="lock"),e||(e="lock"),t=Object.assign({},l,t),u||(u=n(t)||i(t),u.isWorker||(u.on("requestReadLock",((e,t)=>{c[e]&&c[e].readLock(t)})),u.on("requestWriteLock",((e,t)=>{c[e]&&c[e].writeLock(t)})))),c[e]||(c[e]=((e,t)=>{if(u.isWorker)return{readLock:u.readLock(e,t),writeLock:u.writeLock(e,t)};const r=new s({concurrency:1});let n=null;return{readLock:e=>{if(n)return n.add((()=>o(e(),t.timeout)));n=new s({concurrency:t.concurrency,autoStart:!1});const i=n,a=n.add((()=>o(e(),t.timeout)));return r.add((()=>(i.start(),i.onIdle().then((()=>{n===i&&(n=null)}))))),a},writeLock:e=>(n=null,r.add((()=>o(e(),t.timeout))))}})(e,t)),c[e]),t.exports.Worker=function(e,t){let r;t=t||global.Worker;try{r=new t(e)}catch(n){n.message.includes("not a constructor")&&(r=t(e))}if(!r)throw new Error("Could not create Worker from",t);return a(r),r}}}},{package:"3box>ipfs>ipfs-mfs>mortice"}],[5218,{"./constants":5216,_process:5430,cluster:2131,events:2133,shortid:5829},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("events").EventEmitter,i=e("shortid"),{WORKER_REQUEST_READ_LOCK:s,WORKER_RELEASE_READ_LOCK:o,MASTER_GRANT_READ_LOCK:a,WORKER_REQUEST_WRITE_LOCK:c,WORKER_RELEASE_WRITE_LOCK:u,MASTER_GRANT_WRITE_LOCK:l}=e("./constants");let h;const f=(e,t,r,n,i)=>(s,o)=>{o&&o.type===r&&e.emit(t,o.name,(()=>(s.send({type:i,name:o.name,identifier:o.identifier}),new Promise((e=>{const t=r=>{r&&r.type===n&&r.identifier===o.identifier&&(s.removeListener("message",t),e())};s.on("message",t)})))))},p=(e,t,n,s)=>o=>{const a=i.generate();return r.send({type:t,identifier:a,name:e}),new Promise(((t,i)=>{const c=u=>{if(u&&u.type===n&&u.identifier===a){r.removeListener("message",c);let n=null;o().catch((e=>{n=e})).then((o=>{if(r.send({type:s,identifier:a,name:e}),n)return i(n);t(o)}))}};r.on("message",c)}))};t.exports=t=>{try{if(h=e("cluster"),!Object.keys(h).length)return}catch(e){return}if(h.isMaster||t.singleProcess){const e=new n;return h.on("message",f(e,"requestReadLock",s,o,a)),h.on("message",f(e,"requestWriteLock",c,u,l)),e}return{isWorker:!0,readLock:(e,t)=>p(e,s,a,o),writeLock:(e,t)=>p(e,c,l,u)}}}).call(this)}).call(this,e("_process"))}}},{package:"3box>ipfs>ipfs-mfs>mortice"}],[5219,{},function(){with(this)return function(){"use strict";return function(e,t,r){const n=Math.exp;t.exports=function(e){if("number"!=typeof e)throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let t,r,i=0,s=0,o=0,a={};return a.push=function(a,c){if(r){const u=1-n(-(a-r)/e),l=c-t;t=u*c+(1-u)*t,i=(1-u)*(i+l*(u*l)),s=Math.sqrt(i),o=t+u*l}else t=c;r=a},a.movingAverage=function(){return t},a.variance=function(){return i},a.deviation=function(){return s},a.forecast=function(){return o},a}}}},{package:"3box>ipfs>ipfs-bitswap>moving-average"}],[5220,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n=1e3,i=60*n,s=60*i,o=24*s,a=7*o,c=365.25*o;function u(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}t.exports=function(e,t){t=t||{};var r=typeof e;if("string"===r&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var r=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return r*c;case"weeks":case"week":case"w":return r*a;case"days":case"day":case"d":return r*o;case"hours":case"hour":case"hrs":case"hr":case"h":return r*s;case"minutes":case"minute":case"mins":case"min":case"m":return r*i;case"seconds":case"second":case"secs":case"sec":case"s":return r*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return undefined}}(e);if("number"===r&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=o)return u(e,t,o,"day");if(t>=s)return u(e,t,s,"hour");if(t>=i)return u(e,t,i,"minute");if(t>=n)return u(e,t,n,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=o)return Math.round(e/o)+"d";if(t>=s)return Math.round(e/s)+"h";if(t>=i)return Math.round(e/i)+"m";if(t>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}}}},{package:"analytics-node>ms"}],[5221,{multiaddr:5224},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("multiaddr"),i=(e,t)=>t,s={ip4:i,ip6:(e,t,r,n)=>1===n.length&&"ip6"===n[0].protocol?t:`[${t}]`,tcp:(e,t,r,n)=>n.some((e=>["http","https","ws","wss"].includes(e.protocol)))?`${e}:${t}`:`tcp://${e}:${t}`,udp:(e,t)=>`udp://${e}:${t}`,dnsaddr:i,dns4:i,dns6:i,ipfs:(e,t)=>`${e}/ipfs/${t}`,p2p:(e,t)=>`${e}/p2p/${t}`,http:e=>`http://${e}`,https:e=>`https://${e}`,ws:e=>`ws://${e}`,wss:e=>`wss://${e}`,"p2p-websocket-star":e=>`${e}/p2p-websocket-star`,"p2p-webrtc-star":e=>`${e}/p2p-webrtc-star`,"p2p-webrtc-direct":e=>`${e}/p2p-webrtc-direct`};t.exports=e=>n(e).stringTuples().map((e=>({protocol:n.protocols.codes[e[0]].name,content:e[1]}))).reduce(((e,t,r,n)=>{const i=s[t.protocol];if(!i)throw new Error(`Unsupported protocol ${t.protocol}`);return i(e,t.content,r,n)}),"")}}},{package:"3box>ipfs>multiaddr-to-uri"}],[5222,{"./convert":5223,"./protocols-table":5225,buffer:2132,varint:6042},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("./convert"),i=e("./protocols-table"),s=e("varint");function o(e){const t=[],r=e.split("/").slice(1);if(1===r.length&&""===r[0])return[];for(let n=0;n<r.length;n++){const s=r[n],o=i(s);if(0!==o.size){if(n++,n>=r.length)throw g("invalid address: "+e);if(o.path){t.push([s,m(r.slice(n).join("/"))]);break}t.push([s,r[n]])}else t.push([s])}return t}function a(e){const t=[];return e.map((e=>{const r=y(e);t.push(r.name),e.length>1&&t.push(e[1])})),m(t.join("/"))}function c(e){return e.map((e=>{Array.isArray(e)||(e=[e]);const t=y(e);return e.length>1?[t.code,n.toBuffer(t.code,e[1])]:[t.code]}))}function u(e){return e.map((e=>{const t=y(e);return e.length>1?[t.code,n.toString(t.code,e[1])]:[t.code]}))}function l(e){return d(r.concat(e.map((e=>{const t=y(e);let n=r.from(s.encode(t.code));return e.length>1&&(n=r.concat([n,e[1]])),n}))))}function h(e,t){if(e.size>0)return e.size/8;if(0===e.size)return 0;return s.decode(t)+s.decode.bytes}function f(e){const t=[];let r=0;for(;r<e.length;){const n=s.decode(e,r),o=s.decode.bytes,a=h(i(n),e.slice(r+o));if(0===a){t.push([n]),r+=o;continue}const c=e.slice(r+o,r+o+a);if(r+=a+o,r>e.length)throw g("Invalid address buffer: "+e.toString("hex"));t.push([n,c])}return t}function p(e){return l(c(o(e=m(e))))}function d(e){const t=b(e);if(t)throw t;return r.from(e)}function b(e){try{f(e)}catch(e){return e}}function m(e){return"/"+e.trim().split("/").filter((e=>e)).join("/")}function g(e){return new Error("Error parsing address: "+e)}function y(e){return i(e[0])}t.exports={stringToStringTuples:o,stringTuplesToString:a,tuplesToStringTuples:u,stringTuplesToTuples:c,bufferToTuples:f,tuplesToBuffer:l,bufferToString:function(e){const t=f(e);return a(u(t))},stringToBuffer:p,fromString:function(e){return p(e)},fromBuffer:d,validateBuffer:b,isValidBuffer:function(e){return b(e)===undefined},cleanPath:m,ParseError:g,protoFromTuple:y,sizeForAddr:h}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>multiaddr"}],[5223,{"./protocols-table":5225,bs58:2139,buffer:2132,"hi-base32":4429,ip:4466,"is-ip":4745,varint:6042},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("ip"),i=e("is-ip"),s=e("./protocols-table"),o=e("bs58"),a=e("hi-base32"),c=e("varint");function u(e,t){return t instanceof r?u.toString(e,t):u.toBuffer(e,t)}function l(e){if(!i(e))throw new Error("invalid ip address");return n.toBuffer(e)}function h(e){const t=r.alloc(2);return t.writeUInt16BE(e,0),t}function f(e){return e.readUInt16BE(0)}function p(e){const t=e.slice(0,e.length-2),r=e.slice(e.length-2);return a.encode(t).toString("ascii").toLowerCase()+":"+f(r)}t.exports=u,u.toString=function(e,t){switch((e=s(e)).code){case 4:case 41:return function(e){const t=n.toString(e);if(!i(t))throw new Error("invalid ip address");return t}(t);case 6:case 273:case 33:case 132:return f(t);case 53:case 54:case 55:case 56:case 400:return function(e){const t=c.decode(e);if((e=e.slice(c.decode.bytes)).length!==t)throw new Error("inconsistent lengths");return e.toString()}(t);case 421:return function(e){const t=c.decode(e),r=e.slice(c.decode.bytes);if(r.length!==t)throw new Error("inconsistent lengths");return o.encode(r)}(t);case 444:case 445:return p(t);default:return t.toString("hex")}},u.toBuffer=function(e,t){switch((e=s(e)).code){case 4:case 41:return l(t);case 6:case 273:case 33:case 132:return h(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:return function(e){const t=r.from(e),n=r.from(c.encode(t.length));return r.concat([n,t])}(t);case 421:return function(e){const t=r.from(o.decode(e)),n=r.from(c.encode(t.length));return r.concat([n,t])}(t);case 444:return function(e){const t=e.split(":");if(2!==t.length)throw new Error("failed to parse onion addr: "+t+" does not contain a port number");if(16!==t[0].length)throw new Error("failed to parse onion addr: "+t[0]+" not a Tor onion address.");const n=r.from(a.decode.asBytes(t[0].toUpperCase())),i=parseInt(t[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");const s=h(i);return r.concat([n,s])}(t);case 445:return function(e){const t=e.split(":");if(2!==t.length)throw new Error("failed to parse onion addr: "+t+" does not contain a port number");if(56!==t[0].length)throw new Error("failed to parse onion addr: "+t[0]+" not a Tor onion3 address.");const n=r.from(a.decode.asBytes(t[0].toUpperCase())),i=parseInt(t[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");const s=h(i);return r.concat([n,s])}(t);default:return r.from(t,"hex")}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>multiaddr"}],[5224,{"./codec":5222,"./protocols-table":5225,bs58:2139,buffer:2132,"class-is":2171,varint:6042},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("./codec"),i=e("./protocols-table"),s=e("varint"),o=e("bs58"),a=e("class-is").proto((function(e){if(!(this instanceof a))return new a(e);if(null==e&&(e=""),e instanceof r)this.buffer=n.fromBuffer(e);else if("string"==typeof e||e instanceof String){if(e.length>0&&"/"!==e.charAt(0))throw new Error(`multiaddr "${e}" must start with a "/"`);this.buffer=n.fromString(e)}else{if(!(e.buffer&&e.protos&&e.protoCodes))throw new Error("addr must be a string, Buffer, or another Multiaddr");this.buffer=n.fromBuffer(e.buffer)}}),{className:"Multiaddr",symbolName:"@multiformats/js-multiaddr/multiaddr"});a.prototype.toString=function(){return n.bufferToString(this.buffer)},a.prototype.toJSON=a.prototype.toString,a.prototype.toOptions=function(){const e={},t=this.toString().split("/");return e.family="ip4"===t[1]?"ipv4":"ipv6",e.host=t[2],e.transport=t[3],e.port=t[4],e},a.prototype.inspect=function(){return"<Multiaddr "+this.buffer.toString("hex")+" - "+n.bufferToString(this.buffer)+">"},a.prototype.protos=function(){return this.protoCodes().map((e=>Object.assign({},i(e))))},a.prototype.protoCodes=function(){const e=[],t=this.buffer;let r=0;for(;r<t.length;){const o=s.decode(t,r),a=s.decode.bytes,c=i(o);r+=n.sizeForAddr(c,t.slice(r+a))+a,e.push(o)}return e},a.prototype.protoNames=function(){return this.protos().map((e=>e.name))},a.prototype.tuples=function(){return n.bufferToTuples(this.buffer)},a.prototype.stringTuples=function(){const e=n.bufferToTuples(this.buffer);return n.tuplesToStringTuples(e)},a.prototype.encapsulate=function(e){return e=a(e),a(this.toString()+e.toString())},a.prototype.decapsulate=function(e){e=e.toString();const t=this.toString(),r=t.lastIndexOf(e);if(r<0)throw new Error("Address "+this+" does not contain subaddress: "+e);return a(t.slice(0,r))},a.prototype.getPeerId=function(){let e=null;try{e=this.stringTuples().filter((e=>{if(e[0]===i.names.ipfs.code)return!0}))[0][1],o.decode(e)}catch(t){e=null}return e},a.prototype.getPath=function(){let e=null;try{e=this.stringTuples().filter((e=>{if(i(e[0]).path)return!0}))[0][1]}catch(t){e=null}return e},a.prototype.equals=function(e){return this.buffer.equals(e.buffer)},a.prototype.nodeAddress=function(){const e=this.protoCodes(),t=this.protoNames(),r=this.toString().split("/").slice(1);if(r.length<4)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6}/{address}/{tcp, udp}/{port}".');if(4!==e[0]&&41!==e[0]&&54!==e[0]&&55!==e[0])throw new Error(`no protocol with name: "'${t[0]}'". Must have a valid family name: "{ip4, ip6, dns4, dns6}".`);if("tcp"!==r[2]&&"udp"!==r[2])throw new Error(`no protocol with name: "'${t[1]}'". Must have a valid transport protocol: "{tcp, udp}".`);return{family:41===e[0]||55===e[0]?6:4,address:r[1],port:r[3]}},a.fromNodeAddress=function(e,t){if(!e)throw new Error("requires node address object");if(!t)throw new Error("requires transport protocol");const r="IPv6"===e.family?"ip6":"ip4";return a("/"+[r,e.address,t,e.port].join("/"))},a.prototype.isThinWaistAddress=function(e){const t=(e||this).protos();return 2===t.length&&((4===t[0].code||41===t[0].code)&&(6===t[1].code||273===t[1].code))},a.protocols=i,a.isName=function(e){return!!a.isMultiaddr(e)&&e.protos().some((e=>e.resolvable))},a.resolve=function(e,t){return a.isMultiaddr(e)&&a.isName(e)?t(new Error("not implemented yet")):t(new Error("not a valid name"))},t.exports=a}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>multiaddr"}],[5225,{},function(){with(this)return function(){"use strict";return function(e,t,r){function n(e){if("number"==typeof e){if(n.codes[e])return n.codes[e];throw new Error("no protocol with code: "+e)}if("string"==typeof e||e instanceof String){if(n.names[e])return n.names[e];throw new Error("no protocol with name: "+e)}throw new Error("invalid protocol id type: "+e)}const i=-1;function s(e,t,r,n,i){return{code:e,size:t,name:r,resolvable:Boolean(n),path:Boolean(i)}}n.lengthPrefixedVarSize=i,n.V=i,n.table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,i,"ip6zone"],[53,i,"dns","resolvable"],[54,i,"dns4","resolvable"],[55,i,"dns6","resolvable"],[56,i,"dnsaddr","resolvable"],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,i,"unix",!1,"path"],[421,i,"p2p"],[421,i,"ipfs"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,i,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"]],n.names={},n.codes={},n.table.map((e=>{const t=s.apply(null,e);n.codes[t.code]=t,n.names[t.name]=t})),n.object=s,t.exports=n}}},{package:"3box>ipfs>multiaddr"}],[5226,{"safe-buffer":5748},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("safe-buffer").Buffer;t.exports=function(e){for(var t={},r=e.length,i=e.charAt(0),s=0;s<e.length;s++){var o=e.charAt(s);if(t[o]!==undefined)throw new TypeError(o+" is ambiguous");t[o]=s}function a(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return n.allocUnsafe(0);for(var s=[0],o=0;o<e.length;o++){var a=t[e[o]];if(a===undefined)return;for(var c=0,u=a;c<s.length;++c)u+=s[c]*r,s[c]=255&u,u>>=8;for(;u>0;)s.push(255&u),u>>=8}for(var l=0;e[l]===i&&l<e.length-1;++l)s.push(0);return n.from(s.reverse())}return{encode:function(t){if(0===t.length)return"";for(var n=[0],s=0;s<t.length;++s){for(var o=0,a=t[s];o<n.length;++o)a+=n[o]<<8,n[o]=a%r,a=a/r|0;for(;a>0;)n.push(a%r),a=a/r|0}for(var c="",u=0;0===t[u]&&u<t.length-1;++u)c+=i;for(var l=n.length-1;l>=0;--l)c+=e[n[l]];return c},decodeUnsafe:a,decode:function(e){var t=a(e);if(t)return t;throw new Error("Non-base"+r+" character")}}}}}},{package:"3box>ipfs>multibase>base-x"}],[5227,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=class{constructor(e,t,r,n){this.name=e,this.code=t,this.alphabet=n,r&&n&&(this.engine=r(n))}encode(e){return this.engine.encode(e)}decode(e){return this.engine.decode(e)}isImplemented(){return this.engine}}}}},{package:"3box>ipfs>multibase"}],[5228,{buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e){(function(){t.exports=function(t){return{encode:t=>"string"==typeof t?e.from(t).toString("hex"):t.toString("hex"),decode(r){for(let e of r)if(t.indexOf(e)<0)throw new Error("invalid base16 character");return e.from(r,"hex")}}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>multibase"}],[5229,{buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e){(function(){function r(e,t){let r=e.byteLength,n=new Uint8Array(e),i=t.indexOf("=")===t.length-1;i&&(t=t.substring(0,t.length-2));let s=0,o=0,a="";for(let e=0;e<r;e++)for(o=o<<8|n[e],s+=8;s>=5;)a+=t[o>>>s-5&31],s-=5;if(s>0&&(a+=t[o<<5-s&31]),i)for(;a.length%8!=0;)a+="=";return a}t.exports=function(t){return{encode:n=>r("string"==typeof n?e.from(n):n,t),decode(e){for(let r of e)if(t.indexOf(r)<0)throw new Error("invalid base32 character");return function(e,t){let r=(e=e.replace(new RegExp("=","g"),"")).length,n=0,i=0,s=0,o=new Uint8Array(5*r/8|0);for(let a=0;a<r;a++)i=i<<5|t.indexOf(e[a]),n+=5,n>=8&&(o[s++]=i>>>n-8&255,n-=8);return o.buffer}(e,t)}}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>multibase"}],[5230,{buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e){(function(){t.exports=function(t){const r=t.indexOf("=")>-1,n=t.indexOf("-")>-1&&t.indexOf("_")>-1;return{encode(t){let i="";i="string"==typeof t?e.from(t).toString("base64"):t.toString("base64"),n&&(i=i.replace(/\+/g,"-").replace(/\//g,"_"));const s=i.indexOf("=");return s>0&&!r&&(i=i.substring(0,s)),i},decode(r){for(let e of r)if(t.indexOf(e)<0)throw new Error("invalid base64 character");return e.from(r,"base64")}}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>multibase"}],[5231,{"./base.js":5227,"./base16":5228,"./base32":5229,"./base64":5230,"base-x":5226},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("./base.js"),i=e("base-x"),s=e("./base16"),o=e("./base32"),a=e("./base64"),c=[["base1","1","","1"],["base2","0",i,"01"],["base8","7",i,"01234567"],["base10","9",i,"0123456789"],["base16","f",s,"0123456789abcdef"],["base32","b",o,"abcdefghijklmnopqrstuvwxyz234567"],["base32pad","c",o,"abcdefghijklmnopqrstuvwxyz234567="],["base32hex","v",o,"0123456789abcdefghijklmnopqrstuv"],["base32hexpad","t",o,"0123456789abcdefghijklmnopqrstuv="],["base32z","h",o,"ybndrfg8ejkmcpqxot1uwisza345h769"],["base58flickr","Z",i,"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"],["base58btc","z",i,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"],["base64","m",a,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],["base64pad","M",a,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],["base64url","u",a,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"],["base64urlpad","U",a,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="]],u=c.reduce(((e,t)=>(e[t[0]]=new n(t[0],t[1],t[2],t[3]),e)),{}),l=c.reduce(((e,t)=>(e[t[1]]=u[t[0]],e)),{});t.exports={names:u,codes:l}}}},{package:"3box>ipfs>multibase"}],[5232,{"./constants":5231,buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){(function(n){(function(){const i=e("./constants");(r=t.exports=o).encode=function(e,t){const r=a(e);return o(r.name,n.from(r.encode(t)))},r.decode=function(e){n.isBuffer(e)&&(e=e.toString());const t=e.substring(0,1);"string"==typeof(e=e.substring(1,e.length))&&(e=n.from(e));const r=a(t);return n.from(r.decode(e.toString()))},r.isEncoded=function(e){n.isBuffer(e)&&(e=e.toString());if("[object String]"!==Object.prototype.toString.call(e))return!1;const t=e.substring(0,1);try{return a(t).name}catch(e){return!1}},r.names=Object.freeze(Object.keys(i.names)),r.codes=Object.freeze(Object.keys(i.codes));const s=new Error("Unsupported encoding");function o(e,t){if(!t)throw new Error("requires an encoded buffer");const r=a(e),i=n.from(r.code);return function(e,t){a(e).decode(t.toString())}(r.name,t),n.concat([i,t])}function a(e){let t;if(i.names[e])t=i.names[e];else{if(!i.codes[e])throw s;t=i.codes[e]}if(!t.isImplemented())throw new Error("Base "+e+" is not implemented yet");return t}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>multibase"}],[5233,{buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e){(function(){r.protobuf=e.from("50","hex"),r.cbor=e.from("51","hex"),r.rlp=e.from("60","hex"),r.bencode=e.from("63","hex"),r.json=e.from("0200","hex"),r.messagepack=e.from("0201","hex"),r.multicodec=e.from("30","hex"),r.multihash=e.from("31","hex"),r.multiaddr=e.from("32","hex"),r.multibase=e.from("33","hex"),r.identity=e.from("00","hex"),r.sha1=e.from("11","hex"),r["sha2-256"]=e.from("12","hex"),r["sha2-512"]=e.from("13","hex"),r["sha3-512"]=e.from("14","hex"),r["sha3-384"]=e.from("15","hex"),r["sha3-256"]=e.from("16","hex"),r["sha3-224"]=e.from("17","hex"),r["shake-128"]=e.from("18","hex"),r["shake-256"]=e.from("19","hex"),r["keccak-224"]=e.from("1a","hex"),r["keccak-256"]=e.from("1b","hex"),r["keccak-384"]=e.from("1c","hex"),r["keccak-512"]=e.from("1d","hex"),r["murmur3-128"]=e.from("22","hex"),r["murmur3-32"]=e.from("23","hex"),r["dbl-sha2-256"]=e.from("56","hex"),r.md4=e.from("d4","hex"),r.md5=e.from("d5","hex"),r.bmt=e.from("d6","hex"),r.x11=e.from("1100","hex"),r["blake2b-8"]=e.from("b201","hex"),r["blake2b-16"]=e.from("b202","hex"),r["blake2b-24"]=e.from("b203","hex"),r["blake2b-32"]=e.from("b204","hex"),r["blake2b-40"]=e.from("b205","hex"),r["blake2b-48"]=e.from("b206","hex"),r["blake2b-56"]=e.from("b207","hex"),r["blake2b-64"]=e.from("b208","hex"),r["blake2b-72"]=e.from("b209","hex"),r["blake2b-80"]=e.from("b20a","hex"),r["blake2b-88"]=e.from("b20b","hex"),r["blake2b-96"]=e.from("b20c","hex"),r["blake2b-104"]=e.from("b20d","hex"),r["blake2b-112"]=e.from("b20e","hex"),r["blake2b-120"]=e.from("b20f","hex"),r["blake2b-128"]=e.from("b210","hex"),r["blake2b-136"]=e.from("b211","hex"),r["blake2b-144"]=e.from("b212","hex"),r["blake2b-152"]=e.from("b213","hex"),r["blake2b-160"]=e.from("b214","hex"),r["blake2b-168"]=e.from("b215","hex"),r["blake2b-176"]=e.from("b216","hex"),r["blake2b-184"]=e.from("b217","hex"),r["blake2b-192"]=e.from("b218","hex"),r["blake2b-200"]=e.from("b219","hex"),r["blake2b-208"]=e.from("b21a","hex"),r["blake2b-216"]=e.from("b21b","hex"),r["blake2b-224"]=e.from("b21c","hex"),r["blake2b-232"]=e.from("b21d","hex"),r["blake2b-240"]=e.from("b21e","hex"),r["blake2b-248"]=e.from("b21f","hex"),r["blake2b-256"]=e.from("b220","hex"),r["blake2b-264"]=e.from("b221","hex"),r["blake2b-272"]=e.from("b222","hex"),r["blake2b-280"]=e.from("b223","hex"),r["blake2b-288"]=e.from("b224","hex"),r["blake2b-296"]=e.from("b225","hex"),r["blake2b-304"]=e.from("b226","hex"),r["blake2b-312"]=e.from("b227","hex"),r["blake2b-320"]=e.from("b228","hex"),r["blake2b-328"]=e.from("b229","hex"),r["blake2b-336"]=e.from("b22a","hex"),r["blake2b-344"]=e.from("b22b","hex"),r["blake2b-352"]=e.from("b22c","hex"),r["blake2b-360"]=e.from("b22d","hex"),r["blake2b-368"]=e.from("b22e","hex"),r["blake2b-376"]=e.from("b22f","hex"),r["blake2b-384"]=e.from("b230","hex"),r["blake2b-392"]=e.from("b231","hex"),r["blake2b-400"]=e.from("b232","hex"),r["blake2b-408"]=e.from("b233","hex"),r["blake2b-416"]=e.from("b234","hex"),r["blake2b-424"]=e.from("b235","hex"),r["blake2b-432"]=e.from("b236","hex"),r["blake2b-440"]=e.from("b237","hex"),r["blake2b-448"]=e.from("b238","hex"),r["blake2b-456"]=e.from("b239","hex"),r["blake2b-464"]=e.from("b23a","hex"),r["blake2b-472"]=e.from("b23b","hex"),r["blake2b-480"]=e.from("b23c","hex"),r["blake2b-488"]=e.from("b23d","hex"),r["blake2b-496"]=e.from("b23e","hex"),r["blake2b-504"]=e.from("b23f","hex"),r["blake2b-512"]=e.from("b240","hex"),r["blake2s-8"]=e.from("b241","hex"),r["blake2s-16"]=e.from("b242","hex"),r["blake2s-24"]=e.from("b243","hex"),r["blake2s-32"]=e.from("b244","hex"),r["blake2s-40"]=e.from("b245","hex"),r["blake2s-48"]=e.from("b246","hex"),r["blake2s-56"]=e.from("b247","hex"),r["blake2s-64"]=e.from("b248","hex"),r["blake2s-72"]=e.from("b249","hex"),r["blake2s-80"]=e.from("b24a","hex"),r["blake2s-88"]=e.from("b24b","hex"),r["blake2s-96"]=e.from("b24c","hex"),r["blake2s-104"]=e.from("b24d","hex"),r["blake2s-112"]=e.from("b24e","hex"),r["blake2s-120"]=e.from("b24f","hex"),r["blake2s-128"]=e.from("b250","hex"),r["blake2s-136"]=e.from("b251","hex"),r["blake2s-144"]=e.from("b252","hex"),r["blake2s-152"]=e.from("b253","hex"),r["blake2s-160"]=e.from("b254","hex"),r["blake2s-168"]=e.from("b255","hex"),r["blake2s-176"]=e.from("b256","hex"),r["blake2s-184"]=e.from("b257","hex"),r["blake2s-192"]=e.from("b258","hex"),r["blake2s-200"]=e.from("b259","hex"),r["blake2s-208"]=e.from("b25a","hex"),r["blake2s-216"]=e.from("b25b","hex"),r["blake2s-224"]=e.from("b25c","hex"),r["blake2s-232"]=e.from("b25d","hex"),r["blake2s-240"]=e.from("b25e","hex"),r["blake2s-248"]=e.from("b25f","hex"),r["blake2s-256"]=e.from("b260","hex"),r["skein256-8"]=e.from("b301","hex"),r["skein256-16"]=e.from("b302","hex"),r["skein256-24"]=e.from("b303","hex"),r["skein256-32"]=e.from("b304","hex"),r["skein256-40"]=e.from("b305","hex"),r["skein256-48"]=e.from("b306","hex"),r["skein256-56"]=e.from("b307","hex"),r["skein256-64"]=e.from("b308","hex"),r["skein256-72"]=e.from("b309","hex"),r["skein256-80"]=e.from("b30a","hex"),r["skein256-88"]=e.from("b30b","hex"),r["skein256-96"]=e.from("b30c","hex"),r["skein256-104"]=e.from("b30d","hex"),r["skein256-112"]=e.from("b30e","hex"),r["skein256-120"]=e.from("b30f","hex"),r["skein256-128"]=e.from("b310","hex"),r["skein256-136"]=e.from("b311","hex"),r["skein256-144"]=e.from("b312","hex"),r["skein256-152"]=e.from("b313","hex"),r["skein256-160"]=e.from("b314","hex"),r["skein256-168"]=e.from("b315","hex"),r["skein256-176"]=e.from("b316","hex"),r["skein256-184"]=e.from("b317","hex"),r["skein256-192"]=e.from("b318","hex"),r["skein256-200"]=e.from("b319","hex"),r["skein256-208"]=e.from("b31a","hex"),r["skein256-216"]=e.from("b31b","hex"),r["skein256-224"]=e.from("b31c","hex"),r["skein256-232"]=e.from("b31d","hex"),r["skein256-240"]=e.from("b31e","hex"),r["skein256-248"]=e.from("b31f","hex"),r["skein256-256"]=e.from("b320","hex"),r["skein512-8"]=e.from("b321","hex"),r["skein512-16"]=e.from("b322","hex"),r["skein512-24"]=e.from("b323","hex"),r["skein512-32"]=e.from("b324","hex"),r["skein512-40"]=e.from("b325","hex"),r["skein512-48"]=e.from("b326","hex"),r["skein512-56"]=e.from("b327","hex"),r["skein512-64"]=e.from("b328","hex"),r["skein512-72"]=e.from("b329","hex"),r["skein512-80"]=e.from("b32a","hex"),r["skein512-88"]=e.from("b32b","hex"),r["skein512-96"]=e.from("b32c","hex"),r["skein512-104"]=e.from("b32d","hex"),r["skein512-112"]=e.from("b32e","hex"),r["skein512-120"]=e.from("b32f","hex"),r["skein512-128"]=e.from("b330","hex"),r["skein512-136"]=e.from("b331","hex"),r["skein512-144"]=e.from("b332","hex"),r["skein512-152"]=e.from("b333","hex"),r["skein512-160"]=e.from("b334","hex"),r["skein512-168"]=e.from("b335","hex"),r["skein512-176"]=e.from("b336","hex"),r["skein512-184"]=e.from("b337","hex"),r["skein512-192"]=e.from("b338","hex"),r["skein512-200"]=e.from("b339","hex"),r["skein512-208"]=e.from("b33a","hex"),r["skein512-216"]=e.from("b33b","hex"),r["skein512-224"]=e.from("b33c","hex"),r["skein512-232"]=e.from("b33d","hex"),r["skein512-240"]=e.from("b33e","hex"),r["skein512-248"]=e.from("b33f","hex"),r["skein512-256"]=e.from("b340","hex"),r["skein512-264"]=e.from("b341","hex"),r["skein512-272"]=e.from("b342","hex"),r["skein512-280"]=e.from("b343","hex"),r["skein512-288"]=e.from("b344","hex"),r["skein512-296"]=e.from("b345","hex"),r["skein512-304"]=e.from("b346","hex"),r["skein512-312"]=e.from("b347","hex"),r["skein512-320"]=e.from("b348","hex"),r["skein512-328"]=e.from("b349","hex"),r["skein512-336"]=e.from("b34a","hex"),r["skein512-344"]=e.from("b34b","hex"),r["skein512-352"]=e.from("b34c","hex"),r["skein512-360"]=e.from("b34d","hex"),r["skein512-368"]=e.from("b34e","hex"),r["skein512-376"]=e.from("b34f","hex"),r["skein512-384"]=e.from("b350","hex"),r["skein512-392"]=e.from("b351","hex"),r["skein512-400"]=e.from("b352","hex"),r["skein512-408"]=e.from("b353","hex"),r["skein512-416"]=e.from("b354","hex"),r["skein512-424"]=e.from("b355","hex"),r["skein512-432"]=e.from("b356","hex"),r["skein512-440"]=e.from("b357","hex"),r["skein512-448"]=e.from("b358","hex"),r["skein512-456"]=e.from("b359","hex"),r["skein512-464"]=e.from("b35a","hex"),r["skein512-472"]=e.from("b35b","hex"),r["skein512-480"]=e.from("b35c","hex"),r["skein512-488"]=e.from("b35d","hex"),r["skein512-496"]=e.from("b35e","hex"),r["skein512-504"]=e.from("b35f","hex"),r["skein512-512"]=e.from("b360","hex"),r["skein1024-8"]=e.from("b361","hex"),r["skein1024-16"]=e.from("b362","hex"),r["skein1024-24"]=e.from("b363","hex"),r["skein1024-32"]=e.from("b364","hex"),r["skein1024-40"]=e.from("b365","hex"),r["skein1024-48"]=e.from("b366","hex"),r["skein1024-56"]=e.from("b367","hex"),r["skein1024-64"]=e.from("b368","hex"),r["skein1024-72"]=e.from("b369","hex"),r["skein1024-80"]=e.from("b36a","hex"),r["skein1024-88"]=e.from("b36b","hex"),r["skein1024-96"]=e.from("b36c","hex"),r["skein1024-104"]=e.from("b36d","hex"),r["skein1024-112"]=e.from("b36e","hex"),r["skein1024-120"]=e.from("b36f","hex"),r["skein1024-128"]=e.from("b370","hex"),r["skein1024-136"]=e.from("b371","hex"),r["skein1024-144"]=e.from("b372","hex"),r["skein1024-152"]=e.from("b373","hex"),r["skein1024-160"]=e.from("b374","hex"),r["skein1024-168"]=e.from("b375","hex"),r["skein1024-176"]=e.from("b376","hex"),r["skein1024-184"]=e.from("b377","hex"),r["skein1024-192"]=e.from("b378","hex"),r["skein1024-200"]=e.from("b379","hex"),r["skein1024-208"]=e.from("b37a","hex"),r["skein1024-216"]=e.from("b37b","hex"),r["skein1024-224"]=e.from("b37c","hex"),r["skein1024-232"]=e.from("b37d","hex"),r["skein1024-240"]=e.from("b37e","hex"),r["skein1024-248"]=e.from("b37f","hex"),r["skein1024-256"]=e.from("b380","hex"),r["skein1024-264"]=e.from("b381","hex"),r["skein1024-272"]=e.from("b382","hex"),r["skein1024-280"]=e.from("b383","hex"),r["skein1024-288"]=e.from("b384","hex"),r["skein1024-296"]=e.from("b385","hex"),r["skein1024-304"]=e.from("b386","hex"),r["skein1024-312"]=e.from("b387","hex"),r["skein1024-320"]=e.from("b388","hex"),r["skein1024-328"]=e.from("b389","hex"),r["skein1024-336"]=e.from("b38a","hex"),r["skein1024-344"]=e.from("b38b","hex"),r["skein1024-352"]=e.from("b38c","hex"),r["skein1024-360"]=e.from("b38d","hex"),r["skein1024-368"]=e.from("b38e","hex"),r["skein1024-376"]=e.from("b38f","hex"),r["skein1024-384"]=e.from("b390","hex"),r["skein1024-392"]=e.from("b391","hex"),r["skein1024-400"]=e.from("b392","hex"),r["skein1024-408"]=e.from("b393","hex"),r["skein1024-416"]=e.from("b394","hex"),r["skein1024-424"]=e.from("b395","hex"),r["skein1024-432"]=e.from("b396","hex"),r["skein1024-440"]=e.from("b397","hex"),r["skein1024-448"]=e.from("b398","hex"),r["skein1024-456"]=e.from("b399","hex"),r["skein1024-464"]=e.from("b39a","hex"),r["skein1024-472"]=e.from("b39b","hex"),r["skein1024-480"]=e.from("b39c","hex"),r["skein1024-488"]=e.from("b39d","hex"),r["skein1024-496"]=e.from("b39e","hex"),r["skein1024-504"]=e.from("b39f","hex"),r["skein1024-512"]=e.from("b3a0","hex"),r["skein1024-520"]=e.from("b3a1","hex"),r["skein1024-528"]=e.from("b3a2","hex"),r["skein1024-536"]=e.from("b3a3","hex"),r["skein1024-544"]=e.from("b3a4","hex"),r["skein1024-552"]=e.from("b3a5","hex"),r["skein1024-560"]=e.from("b3a6","hex"),r["skein1024-568"]=e.from("b3a7","hex"),r["skein1024-576"]=e.from("b3a8","hex"),r["skein1024-584"]=e.from("b3a9","hex"),r["skein1024-592"]=e.from("b3aa","hex"),r["skein1024-600"]=e.from("b3ab","hex"),r["skein1024-608"]=e.from("b3ac","hex"),r["skein1024-616"]=e.from("b3ad","hex"),r["skein1024-624"]=e.from("b3ae","hex"),r["skein1024-632"]=e.from("b3af","hex"),r["skein1024-640"]=e.from("b3b0","hex"),r["skein1024-648"]=e.from("b3b1","hex"),r["skein1024-656"]=e.from("b3b2","hex"),r["skein1024-664"]=e.from("b3b3","hex"),r["skein1024-672"]=e.from("b3b4","hex"),r["skein1024-680"]=e.from("b3b5","hex"),r["skein1024-688"]=e.from("b3b6","hex"),r["skein1024-696"]=e.from("b3b7","hex"),r["skein1024-704"]=e.from("b3b8","hex"),r["skein1024-712"]=e.from("b3b9","hex"),r["skein1024-720"]=e.from("b3ba","hex"),r["skein1024-728"]=e.from("b3bb","hex"),r["skein1024-736"]=e.from("b3bc","hex"),r["skein1024-744"]=e.from("b3bd","hex"),r["skein1024-752"]=e.from("b3be","hex"),r["skein1024-760"]=e.from("b3bf","hex"),r["skein1024-768"]=e.from("b3c0","hex"),r["skein1024-776"]=e.from("b3c1","hex"),r["skein1024-784"]=e.from("b3c2","hex"),r["skein1024-792"]=e.from("b3c3","hex"),r["skein1024-800"]=e.from("b3c4","hex"),r["skein1024-808"]=e.from("b3c5","hex"),r["skein1024-816"]=e.from("b3c6","hex"),r["skein1024-824"]=e.from("b3c7","hex"),r["skein1024-832"]=e.from("b3c8","hex"),r["skein1024-840"]=e.from("b3c9","hex"),r["skein1024-848"]=e.from("b3ca","hex"),r["skein1024-856"]=e.from("b3cb","hex"),r["skein1024-864"]=e.from("b3cc","hex"),r["skein1024-872"]=e.from("b3cd","hex"),r["skein1024-880"]=e.from("b3ce","hex"),r["skein1024-888"]=e.from("b3cf","hex"),r["skein1024-896"]=e.from("b3d0","hex"),r["skein1024-904"]=e.from("b3d1","hex"),r["skein1024-912"]=e.from("b3d2","hex"),r["skein1024-920"]=e.from("b3d3","hex"),r["skein1024-928"]=e.from("b3d4","hex"),r["skein1024-936"]=e.from("b3d5","hex"),r["skein1024-944"]=e.from("b3d6","hex"),r["skein1024-952"]=e.from("b3d7","hex"),r["skein1024-960"]=e.from("b3d8","hex"),r["skein1024-968"]=e.from("b3d9","hex"),r["skein1024-976"]=e.from("b3da","hex"),r["skein1024-984"]=e.from("b3db","hex"),r["skein1024-992"]=e.from("b3dc","hex"),r["skein1024-1000"]=e.from("b3dd","hex"),r["skein1024-1008"]=e.from("b3de","hex"),r["skein1024-1016"]=e.from("b3df","hex"),r["skein1024-1024"]=e.from("b3e0","hex"),r.ip4=e.from("04","hex"),r.tcp=e.from("06","hex"),r.dccp=e.from("21","hex"),r.ip6=e.from("29","hex"),r.ip6zone=e.from("2a","hex"),r.dns=e.from("35","hex"),r.dns4=e.from("36","hex"),r.dns6=e.from("37","hex"),r.dnsaddr=e.from("38","hex"),r.sctp=e.from("84","hex"),r.udp=e.from("0111","hex"),r["p2p-webrtc-star"]=e.from("0113","hex"),r["p2p-webrtc-direct"]=e.from("0114","hex"),r["p2p-stardust"]=e.from("0115","hex"),r["p2p-circuit"]=e.from("0122","hex"),r.udt=e.from("012d","hex"),r.utp=e.from("012e","hex"),r.unix=e.from("0190","hex"),r.p2p=e.from("01a5","hex"),r.ipfs=e.from("01a5","hex"),r.https=e.from("01bb","hex"),r.onion=e.from("01bc","hex"),r.onion3=e.from("01bd","hex"),r.garlic64=e.from("01be","hex"),r.garlic32=e.from("01bf","hex"),r.quic=e.from("01cc","hex"),r.ws=e.from("01dd","hex"),r.wss=e.from("01de","hex"),r["p2p-websocket-star"]=e.from("01df","hex"),r.http=e.from("01e0","hex"),r.raw=e.from("55","hex"),r["dag-pb"]=e.from("70","hex"),r["dag-cbor"]=e.from("71","hex"),r["libp2p-key"]=e.from("72","hex"),r["git-raw"]=e.from("78","hex"),r["torrent-info"]=e.from("7b","hex"),r["torrent-file"]=e.from("7c","hex"),r["leofcoin-block"]=e.from("81","hex"),r["leofcoin-tx"]=e.from("82","hex"),r["leofcoin-pr"]=e.from("83","hex"),r["eth-block"]=e.from("90","hex"),r["eth-block-list"]=e.from("91","hex"),r["eth-tx-trie"]=e.from("92","hex"),r["eth-tx"]=e.from("93","hex"),r["eth-tx-receipt-trie"]=e.from("94","hex"),r["eth-tx-receipt"]=e.from("95","hex"),r["eth-state-trie"]=e.from("96","hex"),r["eth-account-snapshot"]=e.from("97","hex"),r["eth-storage-trie"]=e.from("98","hex"),r["bitcoin-block"]=e.from("b0","hex"),r["bitcoin-tx"]=e.from("b1","hex"),r["zcash-block"]=e.from("c0","hex"),r["zcash-tx"]=e.from("c1","hex"),r["stellar-block"]=e.from("d0","hex"),r["stellar-tx"]=e.from("d1","hex"),r["decred-block"]=e.from("e0","hex"),r["decred-tx"]=e.from("e1","hex"),r["dash-block"]=e.from("f0","hex"),r["dash-tx"]=e.from("f1","hex"),r["swarm-manifest"]=e.from("fa","hex"),r["swarm-feed"]=e.from("fb","hex"),r["dag-json"]=e.from("0129","hex"),r.path=e.from("2f","hex"),r["ipld-ns"]=e.from("e2","hex"),r["ipfs-ns"]=e.from("e3","hex"),r["swarm-ns"]=e.from("e4","hex"),r["ipns-ns"]=e.from("e5","hex"),r.zeronet=e.from("e6","hex"),r["ed25519-pub"]=e.from("ed","hex"),r["holochain-adr-v0"]=e.from("807124","hex"),r["holochain-adr-v1"]=e.from("817124","hex"),r["holochain-key-v0"]=e.from("947124","hex"),r["holochain-key-v1"]=e.from("957124","hex"),r["holochain-sig-v0"]=e.from("a27124","hex"),r["holochain-sig-v1"]=e.from("a37124","hex")}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>multicodec"}],[5234,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=Object.freeze({PROTOBUF:80,CBOR:81,RLP:96,BENCODE:99,JSON:512,MESSAGEPACK:513,MULTICODEC:48,MULTIHASH:49,MULTIADDR:50,MULTIBASE:51,IDENTITY:0,SHA1:17,SHA2_256:18,SHA2_512:19,SHA3_512:20,SHA3_384:21,SHA3_256:22,SHA3_224:23,SHAKE_128:24,SHAKE_256:25,KECCAK_224:26,KECCAK_256:27,KECCAK_384:28,KECCAK_512:29,MURMUR3_128:34,MURMUR3_32:35,DBL_SHA2_256:86,MD4:212,MD5:213,BMT:214,X11:4352,BLAKE2B_8:45569,BLAKE2B_16:45570,BLAKE2B_24:45571,BLAKE2B_32:45572,BLAKE2B_40:45573,BLAKE2B_48:45574,BLAKE2B_56:45575,BLAKE2B_64:45576,BLAKE2B_72:45577,BLAKE2B_80:45578,BLAKE2B_88:45579,BLAKE2B_96:45580,BLAKE2B_104:45581,BLAKE2B_112:45582,BLAKE2B_120:45583,BLAKE2B_128:45584,BLAKE2B_136:45585,BLAKE2B_144:45586,BLAKE2B_152:45587,BLAKE2B_160:45588,BLAKE2B_168:45589,BLAKE2B_176:45590,BLAKE2B_184:45591,BLAKE2B_192:45592,BLAKE2B_200:45593,BLAKE2B_208:45594,BLAKE2B_216:45595,BLAKE2B_224:45596,BLAKE2B_232:45597,BLAKE2B_240:45598,BLAKE2B_248:45599,BLAKE2B_256:45600,BLAKE2B_264:45601,BLAKE2B_272:45602,BLAKE2B_280:45603,BLAKE2B_288:45604,BLAKE2B_296:45605,BLAKE2B_304:45606,BLAKE2B_312:45607,BLAKE2B_320:45608,BLAKE2B_328:45609,BLAKE2B_336:45610,BLAKE2B_344:45611,BLAKE2B_352:45612,BLAKE2B_360:45613,BLAKE2B_368:45614,BLAKE2B_376:45615,BLAKE2B_384:45616,BLAKE2B_392:45617,BLAKE2B_400:45618,BLAKE2B_408:45619,BLAKE2B_416:45620,BLAKE2B_424:45621,BLAKE2B_432:45622,BLAKE2B_440:45623,BLAKE2B_448:45624,BLAKE2B_456:45625,BLAKE2B_464:45626,BLAKE2B_472:45627,BLAKE2B_480:45628,BLAKE2B_488:45629,BLAKE2B_496:45630,BLAKE2B_504:45631,BLAKE2B_512:45632,BLAKE2S_8:45633,BLAKE2S_16:45634,BLAKE2S_24:45635,BLAKE2S_32:45636,BLAKE2S_40:45637,BLAKE2S_48:45638,BLAKE2S_56:45639,BLAKE2S_64:45640,BLAKE2S_72:45641,BLAKE2S_80:45642,BLAKE2S_88:45643,BLAKE2S_96:45644,BLAKE2S_104:45645,BLAKE2S_112:45646,BLAKE2S_120:45647,BLAKE2S_128:45648,BLAKE2S_136:45649,BLAKE2S_144:45650,BLAKE2S_152:45651,BLAKE2S_160:45652,BLAKE2S_168:45653,BLAKE2S_176:45654,BLAKE2S_184:45655,BLAKE2S_192:45656,BLAKE2S_200:45657,BLAKE2S_208:45658,BLAKE2S_216:45659,BLAKE2S_224:45660,BLAKE2S_232:45661,BLAKE2S_240:45662,BLAKE2S_248:45663,BLAKE2S_256:45664,SKEIN256_8:45825,SKEIN256_16:45826,SKEIN256_24:45827,SKEIN256_32:45828,SKEIN256_40:45829,SKEIN256_48:45830,SKEIN256_56:45831,SKEIN256_64:45832,SKEIN256_72:45833,SKEIN256_80:45834,SKEIN256_88:45835,SKEIN256_96:45836,SKEIN256_104:45837,SKEIN256_112:45838,SKEIN256_120:45839,SKEIN256_128:45840,SKEIN256_136:45841,SKEIN256_144:45842,SKEIN256_152:45843,SKEIN256_160:45844,SKEIN256_168:45845,SKEIN256_176:45846,SKEIN256_184:45847,SKEIN256_192:45848,SKEIN256_200:45849,SKEIN256_208:45850,SKEIN256_216:45851,SKEIN256_224:45852,SKEIN256_232:45853,SKEIN256_240:45854,SKEIN256_248:45855,SKEIN256_256:45856,SKEIN512_8:45857,SKEIN512_16:45858,SKEIN512_24:45859,SKEIN512_32:45860,SKEIN512_40:45861,SKEIN512_48:45862,SKEIN512_56:45863,SKEIN512_64:45864,SKEIN512_72:45865,SKEIN512_80:45866,SKEIN512_88:45867,SKEIN512_96:45868,SKEIN512_104:45869,SKEIN512_112:45870,SKEIN512_120:45871,SKEIN512_128:45872,SKEIN512_136:45873,SKEIN512_144:45874,SKEIN512_152:45875,SKEIN512_160:45876,SKEIN512_168:45877,SKEIN512_176:45878,SKEIN512_184:45879,SKEIN512_192:45880,SKEIN512_200:45881,SKEIN512_208:45882,SKEIN512_216:45883,SKEIN512_224:45884,SKEIN512_232:45885,SKEIN512_240:45886,SKEIN512_248:45887,SKEIN512_256:45888,SKEIN512_264:45889,SKEIN512_272:45890,SKEIN512_280:45891,SKEIN512_288:45892,SKEIN512_296:45893,SKEIN512_304:45894,SKEIN512_312:45895,SKEIN512_320:45896,SKEIN512_328:45897,SKEIN512_336:45898,SKEIN512_344:45899,SKEIN512_352:45900,SKEIN512_360:45901,SKEIN512_368:45902,SKEIN512_376:45903,SKEIN512_384:45904,SKEIN512_392:45905,SKEIN512_400:45906,SKEIN512_408:45907,SKEIN512_416:45908,SKEIN512_424:45909,SKEIN512_432:45910,SKEIN512_440:45911,SKEIN512_448:45912,SKEIN512_456:45913,SKEIN512_464:45914,SKEIN512_472:45915,SKEIN512_480:45916,SKEIN512_488:45917,SKEIN512_496:45918,SKEIN512_504:45919,SKEIN512_512:45920,SKEIN1024_8:45921,SKEIN1024_16:45922,SKEIN1024_24:45923,SKEIN1024_32:45924,SKEIN1024_40:45925,SKEIN1024_48:45926,SKEIN1024_56:45927,SKEIN1024_64:45928,SKEIN1024_72:45929,SKEIN1024_80:45930,SKEIN1024_88:45931,SKEIN1024_96:45932,SKEIN1024_104:45933,SKEIN1024_112:45934,SKEIN1024_120:45935,SKEIN1024_128:45936,SKEIN1024_136:45937,SKEIN1024_144:45938,SKEIN1024_152:45939,SKEIN1024_160:45940,SKEIN1024_168:45941,SKEIN1024_176:45942,SKEIN1024_184:45943,SKEIN1024_192:45944,SKEIN1024_200:45945,SKEIN1024_208:45946,SKEIN1024_216:45947,SKEIN1024_224:45948,SKEIN1024_232:45949,SKEIN1024_240:45950,SKEIN1024_248:45951,SKEIN1024_256:45952,SKEIN1024_264:45953,SKEIN1024_272:45954,SKEIN1024_280:45955,SKEIN1024_288:45956,SKEIN1024_296:45957,SKEIN1024_304:45958,SKEIN1024_312:45959,SKEIN1024_320:45960,SKEIN1024_328:45961,SKEIN1024_336:45962,SKEIN1024_344:45963,SKEIN1024_352:45964,SKEIN1024_360:45965,SKEIN1024_368:45966,SKEIN1024_376:45967,SKEIN1024_384:45968,SKEIN1024_392:45969,SKEIN1024_400:45970,SKEIN1024_408:45971,SKEIN1024_416:45972,SKEIN1024_424:45973,SKEIN1024_432:45974,SKEIN1024_440:45975,SKEIN1024_448:45976,SKEIN1024_456:45977,SKEIN1024_464:45978,SKEIN1024_472:45979,SKEIN1024_480:45980,SKEIN1024_488:45981,SKEIN1024_496:45982,SKEIN1024_504:45983,SKEIN1024_512:45984,SKEIN1024_520:45985,SKEIN1024_528:45986,SKEIN1024_536:45987,SKEIN1024_544:45988,SKEIN1024_552:45989,SKEIN1024_560:45990,SKEIN1024_568:45991,SKEIN1024_576:45992,SKEIN1024_584:45993,SKEIN1024_592:45994,SKEIN1024_600:45995,SKEIN1024_608:45996,SKEIN1024_616:45997,SKEIN1024_624:45998,SKEIN1024_632:45999,SKEIN1024_640:46e3,SKEIN1024_648:46001,SKEIN1024_656:46002,SKEIN1024_664:46003,SKEIN1024_672:46004,SKEIN1024_680:46005,SKEIN1024_688:46006,SKEIN1024_696:46007,SKEIN1024_704:46008,SKEIN1024_712:46009,SKEIN1024_720:46010,SKEIN1024_728:46011,SKEIN1024_736:46012,SKEIN1024_744:46013,SKEIN1024_752:46014,SKEIN1024_760:46015,SKEIN1024_768:46016,SKEIN1024_776:46017,SKEIN1024_784:46018,SKEIN1024_792:46019,SKEIN1024_800:46020,SKEIN1024_808:46021,SKEIN1024_816:46022,SKEIN1024_824:46023,SKEIN1024_832:46024,SKEIN1024_840:46025,SKEIN1024_848:46026,SKEIN1024_856:46027,SKEIN1024_864:46028,SKEIN1024_872:46029,SKEIN1024_880:46030,SKEIN1024_888:46031,SKEIN1024_896:46032,SKEIN1024_904:46033,SKEIN1024_912:46034,SKEIN1024_920:46035,SKEIN1024_928:46036,SKEIN1024_936:46037,SKEIN1024_944:46038,SKEIN1024_952:46039,SKEIN1024_960:46040,SKEIN1024_968:46041,SKEIN1024_976:46042,SKEIN1024_984:46043,SKEIN1024_992:46044,SKEIN1024_1000:46045,SKEIN1024_1008:46046,SKEIN1024_1016:46047,SKEIN1024_1024:46048,IP4:4,TCP:6,DCCP:33,IP6:41,IP6ZONE:42,DNS:53,DNS4:54,DNS6:55,DNSADDR:56,SCTP:132,UDP:273,P2P_WEBRTC_STAR:275,P2P_WEBRTC_DIRECT:276,P2P_STARDUST:277,P2P_CIRCUIT:290,UDT:301,UTP:302,UNIX:400,P2P:421,IPFS:421,HTTPS:443,ONION:444,ONION3:445,GARLIC64:446,GARLIC32:447,QUIC:460,WS:477,WSS:478,P2P_WEBSOCKET_STAR:479,HTTP:480,RAW:85,DAG_PB:112,DAG_CBOR:113,LIBP2P_KEY:114,GIT_RAW:120,TORRENT_INFO:123,TORRENT_FILE:124,LEOFCOIN_BLOCK:129,LEOFCOIN_TX:130,LEOFCOIN_PR:131,ETH_BLOCK:144,ETH_BLOCK_LIST:145,ETH_TX_TRIE:146,ETH_TX:147,ETH_TX_RECEIPT_TRIE:148,ETH_TX_RECEIPT:149,ETH_STATE_TRIE:150,ETH_ACCOUNT_SNAPSHOT:151,ETH_STORAGE_TRIE:152,BITCOIN_BLOCK:176,BITCOIN_TX:177,ZCASH_BLOCK:192,ZCASH_TX:193,STELLAR_BLOCK:208,STELLAR_TX:209,DECRED_BLOCK:224,DECRED_TX:225,DASH_BLOCK:240,DASH_TX:241,SWARM_MANIFEST:250,SWARM_FEED:251,DAG_JSON:297,PATH:47,IPLD_NS:226,IPFS_NS:227,SWARM_NS:228,IPNS_NS:229,ZERONET:230,ED25519_PUB:237,HOLOCHAIN_ADR_V0:8417572,HOLOCHAIN_ADR_V1:8483108,HOLOCHAIN_KEY_V0:9728292,HOLOCHAIN_KEY_V1:9793828,HOLOCHAIN_SIG_V0:10645796,HOLOCHAIN_SIG_V1:10711332})}}},{package:"3box>ipfs>multicodec"}],[5235,{"./constants":5234,"./name-table":5236,"./print":5237,"./util":5238,"./varint-table":5239,buffer:2132,varint:6042},function(){with(this)return function(){"use strict";return function(e,t,r){(function(n){(function(){const i=e("varint"),s=e("./varint-table"),o=e("./name-table"),a=e("./util");(r=t.exports).addPrefix=(e,t)=>{let r;if(n.isBuffer(e))r=a.varintBufferEncode(e);else{if(!s[e])throw new Error("multicodec not recognized");r=s[e]}return n.concat([r,t])},r.rmPrefix=e=>(i.decode(e),e.slice(i.decode.bytes)),r.getCodec=e=>{const t=a.varintBufferDecode(e),r=o[t.toString("hex")];if(r===undefined)throw new Error("Code `0x"+t.toString("hex")+"` not found");return r},r.getName=e=>o[e.toString(16)],r.getNumber=e=>{const t=s[e];if(t===undefined)throw new Error("Codec `"+e+"` not found");return a.varintBufferDecode(t)[0]},r.getCode=e=>i.decode(e),r.getCodeVarint=e=>{const t=s[e];if(t===undefined)throw new Error("Codec `"+e+"` not found");return t},r.getVarint=e=>i.encode(e);const c=e("./constants");Object.assign(r,c),r.print=e("./print")}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>multicodec"}],[5236,{"./base-table":5233},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("./base-table"),i={};t.exports=i;for(let e in n){i[n[e].toString("hex")]=e}}}},{package:"3box>ipfs>multicodec"}],[5237,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=Object.freeze({80:"protobuf",81:"cbor",96:"rlp",99:"bencode",512:"json",513:"messagepack",48:"multicodec",49:"multihash",50:"multiaddr",51:"multibase",0:"identity",17:"sha1",18:"sha2-256",19:"sha2-512",20:"sha3-512",21:"sha3-384",22:"sha3-256",23:"sha3-224",24:"shake-128",25:"shake-256",26:"keccak-224",27:"keccak-256",28:"keccak-384",29:"keccak-512",34:"murmur3-128",35:"murmur3-32",86:"dbl-sha2-256",212:"md4",213:"md5",214:"bmt",4352:"x11",45569:"blake2b-8",45570:"blake2b-16",45571:"blake2b-24",45572:"blake2b-32",45573:"blake2b-40",45574:"blake2b-48",45575:"blake2b-56",45576:"blake2b-64",45577:"blake2b-72",45578:"blake2b-80",45579:"blake2b-88",45580:"blake2b-96",45581:"blake2b-104",45582:"blake2b-112",45583:"blake2b-120",45584:"blake2b-128",45585:"blake2b-136",45586:"blake2b-144",45587:"blake2b-152",45588:"blake2b-160",45589:"blake2b-168",45590:"blake2b-176",45591:"blake2b-184",45592:"blake2b-192",45593:"blake2b-200",45594:"blake2b-208",45595:"blake2b-216",45596:"blake2b-224",45597:"blake2b-232",45598:"blake2b-240",45599:"blake2b-248",45600:"blake2b-256",45601:"blake2b-264",45602:"blake2b-272",45603:"blake2b-280",45604:"blake2b-288",45605:"blake2b-296",45606:"blake2b-304",45607:"blake2b-312",45608:"blake2b-320",45609:"blake2b-328",45610:"blake2b-336",45611:"blake2b-344",45612:"blake2b-352",45613:"blake2b-360",45614:"blake2b-368",45615:"blake2b-376",45616:"blake2b-384",45617:"blake2b-392",45618:"blake2b-400",45619:"blake2b-408",45620:"blake2b-416",45621:"blake2b-424",45622:"blake2b-432",45623:"blake2b-440",45624:"blake2b-448",45625:"blake2b-456",45626:"blake2b-464",45627:"blake2b-472",45628:"blake2b-480",45629:"blake2b-488",45630:"blake2b-496",45631:"blake2b-504",45632:"blake2b-512",45633:"blake2s-8",45634:"blake2s-16",45635:"blake2s-24",45636:"blake2s-32",45637:"blake2s-40",45638:"blake2s-48",45639:"blake2s-56",45640:"blake2s-64",45641:"blake2s-72",45642:"blake2s-80",45643:"blake2s-88",45644:"blake2s-96",45645:"blake2s-104",45646:"blake2s-112",45647:"blake2s-120",45648:"blake2s-128",45649:"blake2s-136",45650:"blake2s-144",45651:"blake2s-152",45652:"blake2s-160",45653:"blake2s-168",45654:"blake2s-176",45655:"blake2s-184",45656:"blake2s-192",45657:"blake2s-200",45658:"blake2s-208",45659:"blake2s-216",45660:"blake2s-224",45661:"blake2s-232",45662:"blake2s-240",45663:"blake2s-248",45664:"blake2s-256",45825:"skein256-8",45826:"skein256-16",45827:"skein256-24",45828:"skein256-32",45829:"skein256-40",45830:"skein256-48",45831:"skein256-56",45832:"skein256-64",45833:"skein256-72",45834:"skein256-80",45835:"skein256-88",45836:"skein256-96",45837:"skein256-104",45838:"skein256-112",45839:"skein256-120",45840:"skein256-128",45841:"skein256-136",45842:"skein256-144",45843:"skein256-152",45844:"skein256-160",45845:"skein256-168",45846:"skein256-176",45847:"skein256-184",45848:"skein256-192",45849:"skein256-200",45850:"skein256-208",45851:"skein256-216",45852:"skein256-224",45853:"skein256-232",45854:"skein256-240",45855:"skein256-248",45856:"skein256-256",45857:"skein512-8",45858:"skein512-16",45859:"skein512-24",45860:"skein512-32",45861:"skein512-40",45862:"skein512-48",45863:"skein512-56",45864:"skein512-64",45865:"skein512-72",45866:"skein512-80",45867:"skein512-88",45868:"skein512-96",45869:"skein512-104",45870:"skein512-112",45871:"skein512-120",45872:"skein512-128",45873:"skein512-136",45874:"skein512-144",45875:"skein512-152",45876:"skein512-160",45877:"skein512-168",45878:"skein512-176",45879:"skein512-184",45880:"skein512-192",45881:"skein512-200",45882:"skein512-208",45883:"skein512-216",45884:"skein512-224",45885:"skein512-232",45886:"skein512-240",45887:"skein512-248",45888:"skein512-256",45889:"skein512-264",45890:"skein512-272",45891:"skein512-280",45892:"skein512-288",45893:"skein512-296",45894:"skein512-304",45895:"skein512-312",45896:"skein512-320",45897:"skein512-328",45898:"skein512-336",45899:"skein512-344",45900:"skein512-352",45901:"skein512-360",45902:"skein512-368",45903:"skein512-376",45904:"skein512-384",45905:"skein512-392",45906:"skein512-400",45907:"skein512-408",45908:"skein512-416",45909:"skein512-424",45910:"skein512-432",45911:"skein512-440",45912:"skein512-448",45913:"skein512-456",45914:"skein512-464",45915:"skein512-472",45916:"skein512-480",45917:"skein512-488",45918:"skein512-496",45919:"skein512-504",45920:"skein512-512",45921:"skein1024-8",45922:"skein1024-16",45923:"skein1024-24",45924:"skein1024-32",45925:"skein1024-40",45926:"skein1024-48",45927:"skein1024-56",45928:"skein1024-64",45929:"skein1024-72",45930:"skein1024-80",45931:"skein1024-88",45932:"skein1024-96",45933:"skein1024-104",45934:"skein1024-112",45935:"skein1024-120",45936:"skein1024-128",45937:"skein1024-136",45938:"skein1024-144",45939:"skein1024-152",45940:"skein1024-160",45941:"skein1024-168",45942:"skein1024-176",45943:"skein1024-184",45944:"skein1024-192",45945:"skein1024-200",45946:"skein1024-208",45947:"skein1024-216",45948:"skein1024-224",45949:"skein1024-232",45950:"skein1024-240",45951:"skein1024-248",45952:"skein1024-256",45953:"skein1024-264",45954:"skein1024-272",45955:"skein1024-280",45956:"skein1024-288",45957:"skein1024-296",45958:"skein1024-304",45959:"skein1024-312",45960:"skein1024-320",45961:"skein1024-328",45962:"skein1024-336",45963:"skein1024-344",45964:"skein1024-352",45965:"skein1024-360",45966:"skein1024-368",45967:"skein1024-376",45968:"skein1024-384",45969:"skein1024-392",45970:"skein1024-400",45971:"skein1024-408",45972:"skein1024-416",45973:"skein1024-424",45974:"skein1024-432",45975:"skein1024-440",45976:"skein1024-448",45977:"skein1024-456",45978:"skein1024-464",45979:"skein1024-472",45980:"skein1024-480",45981:"skein1024-488",45982:"skein1024-496",45983:"skein1024-504",45984:"skein1024-512",45985:"skein1024-520",45986:"skein1024-528",45987:"skein1024-536",45988:"skein1024-544",45989:"skein1024-552",45990:"skein1024-560",45991:"skein1024-568",45992:"skein1024-576",45993:"skein1024-584",45994:"skein1024-592",45995:"skein1024-600",45996:"skein1024-608",45997:"skein1024-616",45998:"skein1024-624",45999:"skein1024-632",46e3:"skein1024-640",46001:"skein1024-648",46002:"skein1024-656",46003:"skein1024-664",46004:"skein1024-672",46005:"skein1024-680",46006:"skein1024-688",46007:"skein1024-696",46008:"skein1024-704",46009:"skein1024-712",46010:"skein1024-720",46011:"skein1024-728",46012:"skein1024-736",46013:"skein1024-744",46014:"skein1024-752",46015:"skein1024-760",46016:"skein1024-768",46017:"skein1024-776",46018:"skein1024-784",46019:"skein1024-792",46020:"skein1024-800",46021:"skein1024-808",46022:"skein1024-816",46023:"skein1024-824",46024:"skein1024-832",46025:"skein1024-840",46026:"skein1024-848",46027:"skein1024-856",46028:"skein1024-864",46029:"skein1024-872",46030:"skein1024-880",46031:"skein1024-888",46032:"skein1024-896",46033:"skein1024-904",46034:"skein1024-912",46035:"skein1024-920",46036:"skein1024-928",46037:"skein1024-936",46038:"skein1024-944",46039:"skein1024-952",46040:"skein1024-960",46041:"skein1024-968",46042:"skein1024-976",46043:"skein1024-984",46044:"skein1024-992",46045:"skein1024-1000",46046:"skein1024-1008",46047:"skein1024-1016",46048:"skein1024-1024",4:"ip4",6:"tcp",33:"dccp",41:"ip6",42:"ip6zone",53:"dns",54:"dns4",55:"dns6",56:"dnsaddr",132:"sctp",273:"udp",275:"p2p-webrtc-star",276:"p2p-webrtc-direct",277:"p2p-stardust",290:"p2p-circuit",301:"udt",302:"utp",400:"unix",421:"p2p",443:"https",444:"onion",445:"onion3",446:"garlic64",447:"garlic32",460:"quic",477:"ws",478:"wss",479:"p2p-websocket-star",480:"http",85:"raw",112:"dag-pb",113:"dag-cbor",114:"libp2p-key",120:"git-raw",123:"torrent-info",124:"torrent-file",129:"leofcoin-block",130:"leofcoin-tx",131:"leofcoin-pr",144:"eth-block",145:"eth-block-list",146:"eth-tx-trie",147:"eth-tx",148:"eth-tx-receipt-trie",149:"eth-tx-receipt",150:"eth-state-trie",151:"eth-account-snapshot",152:"eth-storage-trie",176:"bitcoin-block",177:"bitcoin-tx",192:"zcash-block",193:"zcash-tx",208:"stellar-block",209:"stellar-tx",224:"decred-block",225:"decred-tx",240:"dash-block",241:"dash-tx",250:"swarm-manifest",251:"swarm-feed",297:"dag-json",47:"path",226:"ipld-ns",227:"ipfs-ns",228:"swarm-ns",229:"ipns-ns",230:"zeronet",237:"ed25519-pub",8417572:"holochain-adr-v0",8483108:"holochain-adr-v1",9728292:"holochain-key-v0",9793828:"holochain-key-v1",10645796:"holochain-sig-v0",10711332:"holochain-sig-v1"})}}},{package:"3box>ipfs>multicodec"}],[5238,{buffer:2132,varint:6042},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("varint");function i(e){return parseInt(e.toString("hex"),16)}function s(e){let t=e.toString(16);return t.length%2==1&&(t="0"+t),r.from(t,"hex")}t.exports={numberToBuffer:s,bufferToNumber:i,varintBufferEncode:function(e){return r.from(n.encode(i(e)))},varintBufferDecode:function(e){return s(n.decode(e))}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>multicodec"}],[5239,{"./base-table":5233,"./util":5238},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("./base-table"),i=e("./util").varintBufferEncode,s={};t.exports=s;for(let e in n){let t=n[e];s[e]=i(t)}}}},{package:"3box>ipfs>multicodec"}],[5249,{},function(){with(this)return function(){"use strict";return function(e,t,r){r.names=Object.freeze({identity:0,sha1:17,"sha2-256":18,"sha2-512":19,"dbl-sha2-256":86,"sha3-224":23,"sha3-256":22,"sha3-384":21,"sha3-512":20,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,"murmur3-128":34,"murmur3-32":35,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"Skein256-8":45825,"Skein256-16":45826,"Skein256-24":45827,"Skein256-32":45828,"Skein256-40":45829,"Skein256-48":45830,"Skein256-56":45831,"Skein256-64":45832,"Skein256-72":45833,"Skein256-80":45834,"Skein256-88":45835,"Skein256-96":45836,"Skein256-104":45837,"Skein256-112":45838,"Skein256-120":45839,"Skein256-128":45840,"Skein256-136":45841,"Skein256-144":45842,"Skein256-152":45843,"Skein256-160":45844,"Skein256-168":45845,"Skein256-176":45846,"Skein256-184":45847,"Skein256-192":45848,"Skein256-200":45849,"Skein256-208":45850,"Skein256-216":45851,"Skein256-224":45852,"Skein256-232":45853,"Skein256-240":45854,"Skein256-248":45855,"Skein256-256":45856,"Skein512-8":45857,"Skein512-16":45858,"Skein512-24":45859,"Skein512-32":45860,"Skein512-40":45861,"Skein512-48":45862,"Skein512-56":45863,"Skein512-64":45864,"Skein512-72":45865,"Skein512-80":45866,"Skein512-88":45867,"Skein512-96":45868,"Skein512-104":45869,"Skein512-112":45870,"Skein512-120":45871,"Skein512-128":45872,"Skein512-136":45873,"Skein512-144":45874,"Skein512-152":45875,"Skein512-160":45876,"Skein512-168":45877,"Skein512-176":45878,"Skein512-184":45879,"Skein512-192":45880,"Skein512-200":45881,"Skein512-208":45882,"Skein512-216":45883,"Skein512-224":45884,"Skein512-232":45885,"Skein512-240":45886,"Skein512-248":45887,"Skein512-256":45888,"Skein512-264":45889,"Skein512-272":45890,"Skein512-280":45891,"Skein512-288":45892,"Skein512-296":45893,"Skein512-304":45894,"Skein512-312":45895,"Skein512-320":45896,"Skein512-328":45897,"Skein512-336":45898,"Skein512-344":45899,"Skein512-352":45900,"Skein512-360":45901,"Skein512-368":45902,"Skein512-376":45903,"Skein512-384":45904,"Skein512-392":45905,"Skein512-400":45906,"Skein512-408":45907,"Skein512-416":45908,"Skein512-424":45909,"Skein512-432":45910,"Skein512-440":45911,"Skein512-448":45912,"Skein512-456":45913,"Skein512-464":45914,"Skein512-472":45915,"Skein512-480":45916,"Skein512-488":45917,"Skein512-496":45918,"Skein512-504":45919,"Skein512-512":45920,"Skein1024-8":45921,"Skein1024-16":45922,"Skein1024-24":45923,"Skein1024-32":45924,"Skein1024-40":45925,"Skein1024-48":45926,"Skein1024-56":45927,"Skein1024-64":45928,"Skein1024-72":45929,"Skein1024-80":45930,"Skein1024-88":45931,"Skein1024-96":45932,"Skein1024-104":45933,"Skein1024-112":45934,"Skein1024-120":45935,"Skein1024-128":45936,"Skein1024-136":45937,"Skein1024-144":45938,"Skein1024-152":45939,"Skein1024-160":45940,"Skein1024-168":45941,"Skein1024-176":45942,"Skein1024-184":45943,"Skein1024-192":45944,"Skein1024-200":45945,"Skein1024-208":45946,"Skein1024-216":45947,"Skein1024-224":45948,"Skein1024-232":45949,"Skein1024-240":45950,"Skein1024-248":45951,"Skein1024-256":45952,"Skein1024-264":45953,"Skein1024-272":45954,"Skein1024-280":45955,"Skein1024-288":45956,"Skein1024-296":45957,"Skein1024-304":45958,"Skein1024-312":45959,"Skein1024-320":45960,"Skein1024-328":45961,"Skein1024-336":45962,"Skein1024-344":45963,"Skein1024-352":45964,"Skein1024-360":45965,"Skein1024-368":45966,"Skein1024-376":45967,"Skein1024-384":45968,"Skein1024-392":45969,"Skein1024-400":45970,"Skein1024-408":45971,"Skein1024-416":45972,"Skein1024-424":45973,"Skein1024-432":45974,"Skein1024-440":45975,"Skein1024-448":45976,"Skein1024-456":45977,"Skein1024-464":45978,"Skein1024-472":45979,"Skein1024-480":45980,"Skein1024-488":45981,"Skein1024-496":45982,"Skein1024-504":45983,"Skein1024-512":45984,"Skein1024-520":45985,"Skein1024-528":45986,"Skein1024-536":45987,"Skein1024-544":45988,"Skein1024-552":45989,"Skein1024-560":45990,"Skein1024-568":45991,"Skein1024-576":45992,"Skein1024-584":45993,"Skein1024-592":45994,"Skein1024-600":45995,"Skein1024-608":45996,"Skein1024-616":45997,"Skein1024-624":45998,"Skein1024-632":45999,"Skein1024-640":46e3,"Skein1024-648":46001,"Skein1024-656":46002,"Skein1024-664":46003,"Skein1024-672":46004,"Skein1024-680":46005,"Skein1024-688":46006,"Skein1024-696":46007,"Skein1024-704":46008,"Skein1024-712":46009,"Skein1024-720":46010,"Skein1024-728":46011,"Skein1024-736":46012,"Skein1024-744":46013,"Skein1024-752":46014,"Skein1024-760":46015,"Skein1024-768":46016,"Skein1024-776":46017,"Skein1024-784":46018,"Skein1024-792":46019,"Skein1024-800":46020,"Skein1024-808":46021,"Skein1024-816":46022,"Skein1024-824":46023,"Skein1024-832":46024,"Skein1024-840":46025,"Skein1024-848":46026,"Skein1024-856":46027,"Skein1024-864":46028,"Skein1024-872":46029,"Skein1024-880":46030,"Skein1024-888":46031,"Skein1024-896":46032,"Skein1024-904":46033,"Skein1024-912":46034,"Skein1024-920":46035,"Skein1024-928":46036,"Skein1024-936":46037,"Skein1024-944":46038,"Skein1024-952":46039,"Skein1024-960":46040,"Skein1024-968":46041,"Skein1024-976":46042,"Skein1024-984":46043,"Skein1024-992":46044,"Skein1024-1000":46045,"Skein1024-1008":46046,"Skein1024-1016":46047,"Skein1024-1024":46048}),r.codes=Object.freeze({0:"identity",17:"sha1",18:"sha2-256",19:"sha2-512",86:"dbl-sha2-256",23:"sha3-224",22:"sha3-256",21:"sha3-384",20:"sha3-512",24:"shake-128",25:"shake-256",26:"keccak-224",27:"keccak-256",28:"keccak-384",29:"keccak-512",34:"murmur3-128",35:"murmur3-32",45569:"blake2b-8",45570:"blake2b-16",45571:"blake2b-24",45572:"blake2b-32",45573:"blake2b-40",45574:"blake2b-48",45575:"blake2b-56",45576:"blake2b-64",45577:"blake2b-72",45578:"blake2b-80",45579:"blake2b-88",45580:"blake2b-96",45581:"blake2b-104",45582:"blake2b-112",45583:"blake2b-120",45584:"blake2b-128",45585:"blake2b-136",45586:"blake2b-144",45587:"blake2b-152",45588:"blake2b-160",45589:"blake2b-168",45590:"blake2b-176",45591:"blake2b-184",45592:"blake2b-192",45593:"blake2b-200",45594:"blake2b-208",45595:"blake2b-216",45596:"blake2b-224",45597:"blake2b-232",45598:"blake2b-240",45599:"blake2b-248",45600:"blake2b-256",45601:"blake2b-264",45602:"blake2b-272",45603:"blake2b-280",45604:"blake2b-288",45605:"blake2b-296",45606:"blake2b-304",45607:"blake2b-312",45608:"blake2b-320",45609:"blake2b-328",45610:"blake2b-336",45611:"blake2b-344",45612:"blake2b-352",45613:"blake2b-360",45614:"blake2b-368",45615:"blake2b-376",45616:"blake2b-384",45617:"blake2b-392",45618:"blake2b-400",45619:"blake2b-408",45620:"blake2b-416",45621:"blake2b-424",45622:"blake2b-432",45623:"blake2b-440",45624:"blake2b-448",45625:"blake2b-456",45626:"blake2b-464",45627:"blake2b-472",45628:"blake2b-480",45629:"blake2b-488",45630:"blake2b-496",45631:"blake2b-504",45632:"blake2b-512",45633:"blake2s-8",45634:"blake2s-16",45635:"blake2s-24",45636:"blake2s-32",45637:"blake2s-40",45638:"blake2s-48",45639:"blake2s-56",45640:"blake2s-64",45641:"blake2s-72",45642:"blake2s-80",45643:"blake2s-88",45644:"blake2s-96",45645:"blake2s-104",45646:"blake2s-112",45647:"blake2s-120",45648:"blake2s-128",45649:"blake2s-136",45650:"blake2s-144",45651:"blake2s-152",45652:"blake2s-160",45653:"blake2s-168",45654:"blake2s-176",45655:"blake2s-184",45656:"blake2s-192",45657:"blake2s-200",45658:"blake2s-208",45659:"blake2s-216",45660:"blake2s-224",45661:"blake2s-232",45662:"blake2s-240",45663:"blake2s-248",45664:"blake2s-256",45825:"Skein256-8",45826:"Skein256-16",45827:"Skein256-24",45828:"Skein256-32",45829:"Skein256-40",45830:"Skein256-48",45831:"Skein256-56",45832:"Skein256-64",45833:"Skein256-72",45834:"Skein256-80",45835:"Skein256-88",45836:"Skein256-96",45837:"Skein256-104",45838:"Skein256-112",45839:"Skein256-120",45840:"Skein256-128",45841:"Skein256-136",45842:"Skein256-144",45843:"Skein256-152",45844:"Skein256-160",45845:"Skein256-168",45846:"Skein256-176",45847:"Skein256-184",45848:"Skein256-192",45849:"Skein256-200",45850:"Skein256-208",45851:"Skein256-216",45852:"Skein256-224",45853:"Skein256-232",45854:"Skein256-240",45855:"Skein256-248",45856:"Skein256-256",45857:"Skein512-8",45858:"Skein512-16",45859:"Skein512-24",45860:"Skein512-32",45861:"Skein512-40",45862:"Skein512-48",45863:"Skein512-56",45864:"Skein512-64",45865:"Skein512-72",45866:"Skein512-80",45867:"Skein512-88",45868:"Skein512-96",45869:"Skein512-104",45870:"Skein512-112",45871:"Skein512-120",45872:"Skein512-128",45873:"Skein512-136",45874:"Skein512-144",45875:"Skein512-152",45876:"Skein512-160",45877:"Skein512-168",45878:"Skein512-176",45879:"Skein512-184",45880:"Skein512-192",45881:"Skein512-200",45882:"Skein512-208",45883:"Skein512-216",45884:"Skein512-224",45885:"Skein512-232",45886:"Skein512-240",45887:"Skein512-248",45888:"Skein512-256",45889:"Skein512-264",45890:"Skein512-272",45891:"Skein512-280",45892:"Skein512-288",45893:"Skein512-296",45894:"Skein512-304",45895:"Skein512-312",45896:"Skein512-320",45897:"Skein512-328",45898:"Skein512-336",45899:"Skein512-344",45900:"Skein512-352",45901:"Skein512-360",45902:"Skein512-368",45903:"Skein512-376",45904:"Skein512-384",45905:"Skein512-392",45906:"Skein512-400",45907:"Skein512-408",45908:"Skein512-416",45909:"Skein512-424",45910:"Skein512-432",45911:"Skein512-440",45912:"Skein512-448",45913:"Skein512-456",45914:"Skein512-464",45915:"Skein512-472",45916:"Skein512-480",45917:"Skein512-488",45918:"Skein512-496",45919:"Skein512-504",45920:"Skein512-512",45921:"Skein1024-8",45922:"Skein1024-16",45923:"Skein1024-24",45924:"Skein1024-32",45925:"Skein1024-40",45926:"Skein1024-48",45927:"Skein1024-56",45928:"Skein1024-64",45929:"Skein1024-72",45930:"Skein1024-80",45931:"Skein1024-88",45932:"Skein1024-96",45933:"Skein1024-104",45934:"Skein1024-112",45935:"Skein1024-120",45936:"Skein1024-128",45937:"Skein1024-136",45938:"Skein1024-144",45939:"Skein1024-152",45940:"Skein1024-160",45941:"Skein1024-168",45942:"Skein1024-176",45943:"Skein1024-184",45944:"Skein1024-192",45945:"Skein1024-200",45946:"Skein1024-208",45947:"Skein1024-216",45948:"Skein1024-224",45949:"Skein1024-232",45950:"Skein1024-240",45951:"Skein1024-248",45952:"Skein1024-256",45953:"Skein1024-264",45954:"Skein1024-272",45955:"Skein1024-280",45956:"Skein1024-288",45957:"Skein1024-296",45958:"Skein1024-304",45959:"Skein1024-312",45960:"Skein1024-320",45961:"Skein1024-328",45962:"Skein1024-336",45963:"Skein1024-344",45964:"Skein1024-352",45965:"Skein1024-360",45966:"Skein1024-368",45967:"Skein1024-376",45968:"Skein1024-384",45969:"Skein1024-392",45970:"Skein1024-400",45971:"Skein1024-408",45972:"Skein1024-416",45973:"Skein1024-424",45974:"Skein1024-432",45975:"Skein1024-440",45976:"Skein1024-448",45977:"Skein1024-456",45978:"Skein1024-464",45979:"Skein1024-472",45980:"Skein1024-480",45981:"Skein1024-488",45982:"Skein1024-496",45983:"Skein1024-504",45984:"Skein1024-512",45985:"Skein1024-520",45986:"Skein1024-528",45987:"Skein1024-536",45988:"Skein1024-544",45989:"Skein1024-552",45990:"Skein1024-560",45991:"Skein1024-568",45992:"Skein1024-576",45993:"Skein1024-584",45994:"Skein1024-592",45995:"Skein1024-600",45996:"Skein1024-608",45997:"Skein1024-616",45998:"Skein1024-624",45999:"Skein1024-632",46e3:"Skein1024-640",46001:"Skein1024-648",46002:"Skein1024-656",46003:"Skein1024-664",46004:"Skein1024-672",46005:"Skein1024-680",46006:"Skein1024-688",46007:"Skein1024-696",46008:"Skein1024-704",46009:"Skein1024-712",46010:"Skein1024-720",46011:"Skein1024-728",46012:"Skein1024-736",46013:"Skein1024-744",46014:"Skein1024-752",46015:"Skein1024-760",46016:"Skein1024-768",46017:"Skein1024-776",46018:"Skein1024-784",46019:"Skein1024-792",46020:"Skein1024-800",46021:"Skein1024-808",46022:"Skein1024-816",46023:"Skein1024-824",46024:"Skein1024-832",46025:"Skein1024-840",46026:"Skein1024-848",46027:"Skein1024-856",46028:"Skein1024-864",46029:"Skein1024-872",46030:"Skein1024-880",46031:"Skein1024-888",46032:"Skein1024-896",46033:"Skein1024-904",46034:"Skein1024-912",46035:"Skein1024-920",46036:"Skein1024-928",46037:"Skein1024-936",46038:"Skein1024-944",46039:"Skein1024-952",46040:"Skein1024-960",46041:"Skein1024-968",46042:"Skein1024-976",46043:"Skein1024-984",46044:"Skein1024-992",46045:"Skein1024-1000",46046:"Skein1024-1008",46047:"Skein1024-1016",46048:"Skein1024-1024"}),r.defaultLengths=Object.freeze({17:20,18:32,19:64,86:32,23:28,22:32,21:48,20:64,24:32,25:64,26:28,27:32,28:48,29:64,34:32,45569:1,45570:2,45571:3,45572:4,45573:5,45574:6,45575:7,45576:8,45577:9,45578:10,45579:11,45580:12,45581:13,45582:14,45583:15,45584:16,45585:17,45586:18,45587:19,45588:20,45589:21,45590:22,45591:23,45592:24,45593:25,45594:26,45595:27,45596:28,45597:29,45598:30,45599:31,45600:32,45601:33,45602:34,45603:35,45604:36,45605:37,45606:38,45607:39,45608:40,45609:41,45610:42,45611:43,45612:44,45613:45,45614:46,45615:47,45616:48,45617:49,45618:50,45619:51,45620:52,45621:53,45622:54,45623:55,45624:56,45625:57,45626:58,45627:59,45628:60,45629:61,45630:62,45631:63,45632:64,45633:1,45634:2,45635:3,45636:4,45637:5,45638:6,45639:7,45640:8,45641:9,45642:10,45643:11,45644:12,45645:13,45646:14,45647:15,45648:16,45649:17,45650:18,45651:19,45652:20,45653:21,45654:22,45655:23,45656:24,45657:25,45658:26,45659:27,45660:28,45661:29,45662:30,45663:31,45664:32,45825:1,45826:2,45827:3,45828:4,45829:5,45830:6,45831:7,45832:8,45833:9,45834:10,45835:11,45836:12,45837:13,45838:14,45839:15,45840:16,45841:17,45842:18,45843:19,45844:20,45845:21,45846:22,45847:23,45848:24,45849:25,45850:26,45851:27,45852:28,45853:29,45854:30,45855:31,45856:32,45857:1,45858:2,45859:3,45860:4,45861:5,45862:6,45863:7,45864:8,45865:9,45866:10,45867:11,45868:12,45869:13,45870:14,45871:15,45872:16,45873:17,45874:18,45875:19,45876:20,45877:21,45878:22,45879:23,45880:24,45881:25,45882:26,45883:27,45884:28,45885:29,45886:30,45887:31,45888:32,45889:33,45890:34,45891:35,45892:36,45893:37,45894:38,45895:39,45896:40,45897:41,45898:42,45899:43,45900:44,45901:45,45902:46,45903:47,45904:48,45905:49,45906:50,45907:51,45908:52,45909:53,45910:54,45911:55,45912:56,45913:57,45914:58,45915:59,45916:60,45917:61,45918:62,45919:63,45920:64,45921:1,45922:2,45923:3,45924:4,45925:5,45926:6,45927:7,45928:8,45929:9,45930:10,45931:11,45932:12,45933:13,45934:14,45935:15,45936:16,45937:17,45938:18,45939:19,45940:20,45941:21,45942:22,45943:23,45944:24,45945:25,45946:26,45947:27,45948:28,45949:29,45950:30,45951:31,45952:32,45953:33,45954:34,45955:35,45956:36,45957:37,45958:38,45959:39,45960:40,45961:41,45962:42,45963:43,45964:44,45965:45,45966:46,45967:47,45968:48,45969:49,45970:50,45971:51,45972:52,45973:53,45974:54,45975:55,45976:56,45977:57,45978:58,45979:59,45980:60,45981:61,45982:62,45983:63,45984:64,45985:65,45986:66,45987:67,45988:68,45989:69,45990:70,45991:71,45992:72,45993:73,45994:74,45995:75,45996:76,45997:77,45998:78,45999:79,46e3:80,46001:81,46002:82,46003:83,46004:84,46005:85,46006:86,46007:87,46008:88,46009:89,46010:90,46011:91,46012:92,46013:93,46014:94,46015:95,46016:96,46017:97,46018:98,46019:99,46020:100,46021:101,46022:102,46023:103,46024:104,46025:105,46026:106,46027:107,46028:108,46029:109,46030:110,46031:111,46032:112,46033:113,46034:114,46035:115,46036:116,46037:117,46038:118,46039:119,46040:120,46041:121,46042:122,46043:123,46044:124,46045:125,46046:126,46047:127,46048:128})}}},{package:"3box>ipfs>multihashes"}],[5250,{"./constants":5249,bs58:2139,buffer:2132,varint:6042},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){const n=e("bs58"),i=e("./constants");r.names=i.names,r.codes=i.codes,r.defaultLengths=i.defaultLengths;const s=e("varint");function o(e){r.decode(e)}r.toHexString=function(e){if(!t.isBuffer(e))throw new Error("must be passed a buffer");return e.toString("hex")},r.fromHexString=function(e){return t.from(e,"hex")},r.toB58String=function(e){if(!t.isBuffer(e))throw new Error("must be passed a buffer");return n.encode(e)},r.fromB58String=function(e){let r=e;return t.isBuffer(e)&&(r=e.toString()),t.from(n.decode(r))},r.decode=function(e){if(!t.isBuffer(e))throw new Error("multihash must be a Buffer");if(e.length<3)throw new Error("multihash too short. must be > 3 bytes.");const n=s.decode(e);if(!r.isValidCode(n))throw new Error(`multihash unknown function code: 0x${n.toString(16)}`);e=e.slice(s.decode.bytes);const o=s.decode(e);if(o<1)throw new Error(`multihash invalid length: 0x${o.toString(16)}`);if((e=e.slice(s.decode.bytes)).length!==o)throw new Error(`multihash length inconsistent: 0x${e.toString("hex")}`);return{code:n,name:i.codes[n],length:o,digest:e}},r.encode=function(e,n,i){if(!e||n===undefined)throw new Error("multihash encode requires at least two args: digest, code");const o=r.coerceCode(n);if(!t.isBuffer(e))throw new Error("digest should be a Buffer");if(null==i&&(i=e.length),i&&e.length!==i)throw new Error("digest length should be equal to specified length.");return t.concat([t.from(s.encode(o)),t.from(s.encode(i)),e])},r.coerceCode=function(e){let t=e;if("string"==typeof e){if(i.names[e]===undefined)throw new Error(`Unrecognized hash function named: ${e}`);t=i.names[e]}if("number"!=typeof t)throw new Error(`Hash function code should be a number. Got: ${t}`);if(i.codes[t]===undefined&&!r.isAppCode(t))throw new Error(`Unrecognized function code: ${t}`);return t},r.isAppCode=function(e){return e>0&&e<16},r.isValidCode=function(e){return!!r.isAppCode(e)||!!i.codes[e]},r.validate=o,r.prefix=function(e){return o(e),e.slice(0,2)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>multihashes"}],[5251,{blakejs:2085,buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){const{Buffer:n}=e("buffer"),i=e("blakejs"),s={init:i.blake2bInit,update:i.blake2bUpdate,digest:i.blake2bFinal},o={init:i.blake2sInit,update:i.blake2sUpdate,digest:i.blake2sFinal},a=(e,t)=>async r=>{const i=t.init(e,null);return t.update(i,r),n.from(t.digest(i))};t.exports=e=>{for(let t=0;t<64;t++)e[45569+t]=a(t+1,s);for(let t=0;t<32;t++)e[45633+t]=a(t+1,o)}}}},{package:"3box>ipfs>ipld-raw>multihashing-async"}],[5252,{"./blake":5251,"./sha":5254,"./utils":5255,buffer:2132,"js-sha3":4767,"murmurhash3js-revisited":5268},function(){with(this)return function(){"use strict";return function(e,t,r){const{Buffer:n}=e("buffer"),i=e("js-sha3"),s=e("murmurhash3js-revisited"),o=e("./sha"),{fromNumberTo32BitBuf:a}=e("./utils"),c=e=>async t=>{switch(e){case"sha3-224":return n.from(i.sha3_224.arrayBuffer(t));case"sha3-256":return n.from(i.sha3_256.arrayBuffer(t));case"sha3-384":return n.from(i.sha3_384.arrayBuffer(t));case"sha3-512":return n.from(i.sha3_512.arrayBuffer(t));case"shake-128":return n.from(i.shake128.create(128).update(t).arrayBuffer());case"shake-256":return n.from(i.shake256.create(256).update(t).arrayBuffer());case"keccak-224":return n.from(i.keccak224.arrayBuffer(t));case"keccak-256":return n.from(i.keccak256.arrayBuffer(t));case"keccak-384":return n.from(i.keccak384.arrayBuffer(t));case"keccak-512":return n.from(i.keccak512.arrayBuffer(t));case"murmur3-128":return n.from(s.x64.hash128(t),"hex");case"murmur3-32":return a(s.x86.hash32(t));default:throw new TypeError(`${e} is not a supported algorithm`)}};t.exports={sha1:o("sha1"),sha2256:o("sha2-256"),sha2512:o("sha2-512"),dblSha2256:o("dbl-sha2-256"),sha3224:c("sha3-224"),sha3256:c("sha3-256"),sha3384:c("sha3-384"),sha3512:c("sha3-512"),shake128:c("shake-128"),shake256:c("shake-256"),keccak224:c("keccak-224"),keccak256:c("keccak-256"),keccak384:c("keccak-384"),keccak512:c("keccak-512"),murmur3128:c("murmur3-128"),murmur332:c("murmur3-32"),addBlake:e("./blake")}}}},{package:"3box>ipfs>ipld-raw>multihashing-async"}],[5253,{"./crypto":5252,buffer:2132,"err-code":2406,multihashes:5250},function(){with(this)return function(){"use strict";return function(e,t,r){const{Buffer:n}=e("buffer"),i=e("err-code"),s=e("multihashes"),o=e("./crypto");async function a(e,t,r){const n=await a.digest(e,t,r);return s.encode(n,t,r)}a.Buffer=n,a.multihash=s,a.digest=async(e,t,r)=>{const n=a.createHash(t),i=await n(e);return r?i.slice(0,r):i},a.createHash=function(e){if(!e)throw i("hash algorithm must be specified","ERR_HASH_ALGORITHM_NOT_SPECIFIED");if(e=s.coerceCode(e),!a.functions[e])throw i(`multihash function '${e}' not yet supported`,"ERR_HASH_ALGORITHM_NOT_SUPPORTED");return a.functions[e]},a.functions={17:o.sha1,18:o.sha2256,19:o.sha2512,20:o.sha3512,21:o.sha3384,22:o.sha3256,23:o.sha3224,24:o.shake128,25:o.shake256,26:o.keccak224,27:o.keccak256,28:o.keccak384,29:o.keccak512,34:o.murmur3128,35:o.murmur332,86:o.dblSha2256},o.addBlake(a.functions),a.validate=async(e,t)=>{const r=await a(e,s.decode(t).name);return 0===n.compare(t,r)},t.exports=a}}},{package:"3box>ipfs>ipld-raw>multihashing-async"}],[5254,{buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){const{Buffer:n}=e("buffer"),i=self.crypto||self.msCrypto;t.exports=e=>{if("undefined"==typeof self||!self.crypto&&!self.msCrypto)throw new Error("Please use a browser with webcrypto support and ensure the code has been delivered securely via HTTPS/TLS and run within a Secure Context");return async t=>{switch(e){case"sha1":return n.from(await i.subtle.digest({name:"SHA-1"},t));case"sha2-256":return n.from(await i.subtle.digest({name:"SHA-256"},t));case"sha2-512":return n.from(await i.subtle.digest({name:"SHA-512"},t));case"dbl-sha2-256":{const e=await i.subtle.digest({name:"SHA-256"},t);return n.from(await i.subtle.digest({name:"SHA-256"},e))}default:throw new Error(`${e} is not a supported algorithm`)}}}}}},{package:"3box>ipfs>ipld-raw>multihashing-async"}],[5255,{buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){const{Buffer:n}=e("buffer");t.exports={fromNumberTo32BitBuf:e=>{const t=new Array(4);for(let r=0;r<4;r++)t[r]=255&e,e>>=8;return n.from(t)}}}}},{package:"3box>ipfs>ipld-raw>multihashing-async"}],[5256,{_process:5430},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e){(function(){var n;r=t.exports=f,n="object"==typeof e&&e.env&&e.env.NODE_DEBUG&&/\bsemver\b/i.test(e.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:function(){},r.SEMVER_SPEC_VERSION="2.0.0";var i=Number.MAX_SAFE_INTEGER||9007199254740991,s=r.re=[],o=r.src=[],a=r.tokens={},c=0;function u(e){a[e]=c++}u("NUMERICIDENTIFIER"),o[a.NUMERICIDENTIFIER]="0|[1-9]\\d*",u("NUMERICIDENTIFIERLOOSE"),o[a.NUMERICIDENTIFIERLOOSE]="[0-9]+",u("NONNUMERICIDENTIFIER"),o[a.NONNUMERICIDENTIFIER]="\\d*[a-zA-Z-][a-zA-Z0-9-]*",u("MAINVERSION"),o[a.MAINVERSION]="("+o[a.NUMERICIDENTIFIER]+")\\."+"("+o[a.NUMERICIDENTIFIER]+")\\."+"("+o[a.NUMERICIDENTIFIER]+")",u("MAINVERSIONLOOSE"),o[a.MAINVERSIONLOOSE]="("+o[a.NUMERICIDENTIFIERLOOSE]+")\\."+"("+o[a.NUMERICIDENTIFIERLOOSE]+")\\."+"("+o[a.NUMERICIDENTIFIERLOOSE]+")",u("PRERELEASEIDENTIFIER"),o[a.PRERELEASEIDENTIFIER]="(?:"+o[a.NUMERICIDENTIFIER]+"|"+o[a.NONNUMERICIDENTIFIER]+")",u("PRERELEASEIDENTIFIERLOOSE"),o[a.PRERELEASEIDENTIFIERLOOSE]="(?:"+o[a.NUMERICIDENTIFIERLOOSE]+"|"+o[a.NONNUMERICIDENTIFIER]+")",u("PRERELEASE"),o[a.PRERELEASE]="(?:-("+o[a.PRERELEASEIDENTIFIER]+"(?:\\."+o[a.PRERELEASEIDENTIFIER]+")*))",u("PRERELEASELOOSE"),o[a.PRERELEASELOOSE]="(?:-?("+o[a.PRERELEASEIDENTIFIERLOOSE]+"(?:\\."+o[a.PRERELEASEIDENTIFIERLOOSE]+")*))",u("BUILDIDENTIFIER"),o[a.BUILDIDENTIFIER]="[0-9A-Za-z-]+",u("BUILD"),o[a.BUILD]="(?:\\+("+o[a.BUILDIDENTIFIER]+"(?:\\."+o[a.BUILDIDENTIFIER]+")*))",u("FULL"),u("FULLPLAIN"),o[a.FULLPLAIN]="v?"+o[a.MAINVERSION]+o[a.PRERELEASE]+"?"+o[a.BUILD]+"?",o[a.FULL]="^"+o[a.FULLPLAIN]+"$",u("LOOSEPLAIN"),o[a.LOOSEPLAIN]="[v=\\s]*"+o[a.MAINVERSIONLOOSE]+o[a.PRERELEASELOOSE]+"?"+o[a.BUILD]+"?",u("LOOSE"),o[a.LOOSE]="^"+o[a.LOOSEPLAIN]+"$",u("GTLT"),o[a.GTLT]="((?:<|>)?=?)",u("XRANGEIDENTIFIERLOOSE"),o[a.XRANGEIDENTIFIERLOOSE]=o[a.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*",u("XRANGEIDENTIFIER"),o[a.XRANGEIDENTIFIER]=o[a.NUMERICIDENTIFIER]+"|x|X|\\*",u("XRANGEPLAIN"),o[a.XRANGEPLAIN]="[v=\\s]*("+o[a.XRANGEIDENTIFIER]+")"+"(?:\\.("+o[a.XRANGEIDENTIFIER]+")"+"(?:\\.("+o[a.XRANGEIDENTIFIER]+")"+"(?:"+o[a.PRERELEASE]+")?"+o[a.BUILD]+"?"+")?)?",u("XRANGEPLAINLOOSE"),o[a.XRANGEPLAINLOOSE]="[v=\\s]*("+o[a.XRANGEIDENTIFIERLOOSE]+")"+"(?:\\.("+o[a.XRANGEIDENTIFIERLOOSE]+")"+"(?:\\.("+o[a.XRANGEIDENTIFIERLOOSE]+")"+"(?:"+o[a.PRERELEASELOOSE]+")?"+o[a.BUILD]+"?"+")?)?",u("XRANGE"),o[a.XRANGE]="^"+o[a.GTLT]+"\\s*"+o[a.XRANGEPLAIN]+"$",u("XRANGELOOSE"),o[a.XRANGELOOSE]="^"+o[a.GTLT]+"\\s*"+o[a.XRANGEPLAINLOOSE]+"$",u("COERCE"),o[a.COERCE]="(^|[^\\d])"+"(\\d{1,"+16+"})"+"(?:\\.(\\d{1,"+16+"}))?"+"(?:\\.(\\d{1,"+16+"}))?"+"(?:$|[^\\d])",u("COERCERTL"),s[a.COERCERTL]=new RegExp(o[a.COERCE],"g"),u("LONETILDE"),o[a.LONETILDE]="(?:~>?)",u("TILDETRIM"),o[a.TILDETRIM]="(\\s*)"+o[a.LONETILDE]+"\\s+",s[a.TILDETRIM]=new RegExp(o[a.TILDETRIM],"g");u("TILDE"),o[a.TILDE]="^"+o[a.LONETILDE]+o[a.XRANGEPLAIN]+"$",u("TILDELOOSE"),o[a.TILDELOOSE]="^"+o[a.LONETILDE]+o[a.XRANGEPLAINLOOSE]+"$",u("LONECARET"),o[a.LONECARET]="(?:\\^)",u("CARETTRIM"),o[a.CARETTRIM]="(\\s*)"+o[a.LONECARET]+"\\s+",s[a.CARETTRIM]=new RegExp(o[a.CARETTRIM],"g");u("CARET"),o[a.CARET]="^"+o[a.LONECARET]+o[a.XRANGEPLAIN]+"$",u("CARETLOOSE"),o[a.CARETLOOSE]="^"+o[a.LONECARET]+o[a.XRANGEPLAINLOOSE]+"$",u("COMPARATORLOOSE"),o[a.COMPARATORLOOSE]="^"+o[a.GTLT]+"\\s*("+o[a.LOOSEPLAIN]+")$|^$",u("COMPARATOR"),o[a.COMPARATOR]="^"+o[a.GTLT]+"\\s*("+o[a.FULLPLAIN]+")$|^$",u("COMPARATORTRIM"),o[a.COMPARATORTRIM]="(\\s*)"+o[a.GTLT]+"\\s*("+o[a.LOOSEPLAIN]+"|"+o[a.XRANGEPLAIN]+")",s[a.COMPARATORTRIM]=new RegExp(o[a.COMPARATORTRIM],"g");u("HYPHENRANGE"),o[a.HYPHENRANGE]="^\\s*("+o[a.XRANGEPLAIN]+")"+"\\s+-\\s+"+"("+o[a.XRANGEPLAIN]+")"+"\\s*$",u("HYPHENRANGELOOSE"),o[a.HYPHENRANGELOOSE]="^\\s*("+o[a.XRANGEPLAINLOOSE]+")"+"\\s+-\\s+"+"("+o[a.XRANGEPLAINLOOSE]+")"+"\\s*$",u("STAR"),o[a.STAR]="(<|>)?=?\\s*\\*";for(var l=0;l<c;l++)n(l,o[l]),s[l]||(s[l]=new RegExp(o[l]));function h(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof f)return e;if("string"!=typeof e)return null;if(e.length>256)return null;if(!(t.loose?s[a.LOOSE]:s[a.FULL]).test(e))return null;try{return new f(e,t)}catch(e){return null}}function f(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof f){if(e.loose===t.loose)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>256)throw new TypeError("version is longer than "+256+" characters");if(!(this instanceof f))return new f(e,t);n("SemVer",e,t),this.options=t,this.loose=!!t.loose;var r=e.trim().match(t.loose?s[a.LOOSE]:s[a.FULL]);if(!r)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>i||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<i)return t}return e})):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}r.parse=h,r.valid=function(e,t){var r=h(e,t);return r?r.version:null},r.clean=function(e,t){var r=h(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null},r.SemVer=f,f.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},f.prototype.toString=function(){return this.version},f.prototype.compare=function(e){return n("SemVer.compare",this.version,this.options,e),e instanceof f||(e=new f(e,this.options)),this.compareMain(e)||this.comparePre(e)},f.prototype.compareMain=function(e){return e instanceof f||(e=new f(e,this.options)),d(this.major,e.major)||d(this.minor,e.minor)||d(this.patch,e.patch)},f.prototype.comparePre=function(e){if(e instanceof f||(e=new f(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var r=this.prerelease[t],i=e.prerelease[t];if(n("prerelease compare",t,r,i),r===undefined&&i===undefined)return 0;if(i===undefined)return 1;if(r===undefined)return-1;if(r!==i)return d(r,i)}while(++t)},f.prototype.compareBuild=function(e){e instanceof f||(e=new f(e,this.options));var t=0;do{var r=this.build[t],i=e.build[t];if(n("prerelease compare",t,r,i),r===undefined&&i===undefined)return 0;if(i===undefined)return 1;if(r===undefined)return-1;if(r!==i)return d(r,i)}while(++t)},f.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);-1===r&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this},r.inc=function(e,t,r,n){"string"==typeof r&&(n=r,r=undefined);try{return new f(e,r).inc(t,n).version}catch(e){return null}},r.diff=function(e,t){if(y(e,t))return null;var r=h(e),n=h(t),i="";if(r.prerelease.length||n.prerelease.length){i="pre";var s="prerelease"}for(var o in r)if(("major"===o||"minor"===o||"patch"===o)&&r[o]!==n[o])return i+o;return s},r.compareIdentifiers=d;var p=/^[0-9]+$/;function d(e,t){var r=p.test(e),n=p.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1}function b(e,t,r){return new f(e,r).compare(new f(t,r))}function m(e,t,r){return b(e,t,r)>0}function g(e,t,r){return b(e,t,r)<0}function y(e,t,r){return 0===b(e,t,r)}function k(e,t,r){return 0!==b(e,t,r)}function _(e,t,r){return b(e,t,r)>=0}function E(e,t,r){return b(e,t,r)<=0}function S(e,t,r,n){switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return y(e,r,n);case"!=":return k(e,r,n);case">":return m(e,r,n);case">=":return _(e,r,n);case"<":return g(e,r,n);case"<=":return E(e,r,n);default:throw new TypeError("Invalid operator: "+t)}}function w(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof w){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof w))return new w(e,t);n("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===v?this.value="":this.value=this.operator+this.semver.version,n("comp",this)}r.rcompareIdentifiers=function(e,t){return d(t,e)},r.major=function(e,t){return new f(e,t).major},r.minor=function(e,t){return new f(e,t).minor},r.patch=function(e,t){return new f(e,t).patch},r.compare=b,r.compareLoose=function(e,t){return b(e,t,!0)},r.compareBuild=function(e,t,r){var n=new f(e,r),i=new f(t,r);return n.compare(i)||n.compareBuild(i)},r.rcompare=function(e,t,r){return b(t,e,r)},r.sort=function(e,t){return e.sort((function(e,n){return r.compareBuild(e,n,t)}))},r.rsort=function(e,t){return e.sort((function(e,n){return r.compareBuild(n,e,t)}))},r.gt=m,r.lt=g,r.eq=y,r.neq=k,r.gte=_,r.lte=E,r.cmp=S,r.Comparator=w;var v={};function x(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof x)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new x(e.raw,t);if(e instanceof w)return new x(e.value,t);if(!(this instanceof x))return new x(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map((function(e){return this.parseRange(e.trim())}),this).filter((function(e){return e.length})),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function I(e,t){for(var r=!0,n=e.slice(),i=n.pop();r&&n.length;)r=n.every((function(e){return i.intersects(e,t)})),i=n.pop();return r}function A(e){return!e||"x"===e.toLowerCase()||"*"===e}function T(e,t,r,n,i,s,o,a,c,u,l,h,f){return((t=A(r)?"":A(n)?">="+r+".0.0":A(i)?">="+r+"."+n+".0":">="+t)+" "+(a=A(c)?"":A(u)?"<"+(+c+1)+".0.0":A(l)?"<"+c+"."+(+u+1)+".0":h?"<="+c+"."+u+"."+l+"-"+h:"<="+a)).trim()}function R(e,t,r){for(var i=0;i<e.length;i++)if(!e[i].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(i=0;i<e.length;i++)if(n(e[i].semver),e[i].semver!==v&&e[i].semver.prerelease.length>0){var s=e[i].semver;if(s.major===t.major&&s.minor===t.minor&&s.patch===t.patch)return!0}return!1}return!0}function N(e,t,r){try{t=new x(t,r)}catch(e){return!1}return t.test(e)}function P(e,t,r,n){var i,s,o,a,c;switch(e=new f(e,n),t=new x(t,n),r){case">":i=m,s=E,o=g,a=">",c=">=";break;case"<":i=g,s=_,o=m,a="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(N(e,t,n))return!1;for(var u=0;u<t.set.length;++u){var l=t.set[u],h=null,p=null;if(l.forEach((function(e){e.semver===v&&(e=new w(">=0.0.0")),h=h||e,p=p||e,i(e.semver,h.semver,n)?h=e:o(e.semver,p.semver,n)&&(p=e)})),h.operator===a||h.operator===c)return!1;if((!p.operator||p.operator===a)&&s(e,p.semver))return!1;if(p.operator===c&&o(e,p.semver))return!1}return!0}w.prototype.parse=function(e){var t=this.options.loose?s[a.COMPARATORLOOSE]:s[a.COMPARATOR],r=e.match(t);if(!r)throw new TypeError("Invalid comparator: "+e);this.operator=r[1]!==undefined?r[1]:"","="===this.operator&&(this.operator=""),r[2]?this.semver=new f(r[2],this.options.loose):this.semver=v},w.prototype.toString=function(){return this.value},w.prototype.test=function(e){if(n("Comparator.test",e,this.options.loose),this.semver===v||e===v)return!0;if("string"==typeof e)try{e=new f(e,this.options)}catch(e){return!1}return S(e,this.operator,this.semver,this.options)},w.prototype.intersects=function(e,t){if(!(e instanceof w))throw new TypeError("a Comparator is required");var r;if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||(r=new x(e.value,t),N(this.value,r,t));if(""===e.operator)return""===e.value||(r=new x(this.value,t),N(e.semver,r,t));var n=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),i=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),s=this.semver.version===e.semver.version,o=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),a=S(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),c=S(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return n||i||s&&o||a||c},r.Range=x,x.prototype.format=function(){return this.range=this.set.map((function(e){return e.join(" ").trim()})).join("||").trim(),this.range},x.prototype.toString=function(){return this.range},x.prototype.parseRange=function(e){var t=this.options.loose;e=e.trim();var r=t?s[a.HYPHENRANGELOOSE]:s[a.HYPHENRANGE];e=e.replace(r,T),n("hyphen replace",e),e=e.replace(s[a.COMPARATORTRIM],"$1$2$3"),n("comparator trim",e,s[a.COMPARATORTRIM]),e=(e=(e=e.replace(s[a.TILDETRIM],"$1~")).replace(s[a.CARETTRIM],"$1^")).split(/\s+/).join(" ");var i=t?s[a.COMPARATORLOOSE]:s[a.COMPARATOR],o=e.split(" ").map((function(e){return function(e,t){return n("comp",e,t),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){n("caret",e,t);var r=t.loose?s[a.CARETLOOSE]:s[a.CARET];return e.replace(r,(function(t,r,i,s,o){var a;return n("caret",e,t,r,i,s,o),A(r)?a="":A(i)?a=">="+r+".0.0 <"+(+r+1)+".0.0":A(s)?a="0"===r?">="+r+"."+i+".0 <"+r+"."+(+i+1)+".0":">="+r+"."+i+".0 <"+(+r+1)+".0.0":o?(n("replaceCaret pr",o),a="0"===r?"0"===i?">="+r+"."+i+"."+s+"-"+o+" <"+r+"."+i+"."+(+s+1):">="+r+"."+i+"."+s+"-"+o+" <"+r+"."+(+i+1)+".0":">="+r+"."+i+"."+s+"-"+o+" <"+(+r+1)+".0.0"):(n("no pr"),a="0"===r?"0"===i?">="+r+"."+i+"."+s+" <"+r+"."+i+"."+(+s+1):">="+r+"."+i+"."+s+" <"+r+"."+(+i+1)+".0":">="+r+"."+i+"."+s+" <"+(+r+1)+".0.0"),n("caret return",a),a}))}(e,t)})).join(" ")}(e,t),n("caret",e),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){var r=t.loose?s[a.TILDELOOSE]:s[a.TILDE];return e.replace(r,(function(t,r,i,s,o){var a;return n("tilde",e,t,r,i,s,o),A(r)?a="":A(i)?a=">="+r+".0.0 <"+(+r+1)+".0.0":A(s)?a=">="+r+"."+i+".0 <"+r+"."+(+i+1)+".0":o?(n("replaceTilde pr",o),a=">="+r+"."+i+"."+s+"-"+o+" <"+r+"."+(+i+1)+".0"):a=">="+r+"."+i+"."+s+" <"+r+"."+(+i+1)+".0",n("tilde return",a),a}))}(e,t)})).join(" ")}(e,t),n("tildes",e),e=function(e,t){return n("replaceXRanges",e,t),e.split(/\s+/).map((function(e){return function(e,t){e=e.trim();var r=t.loose?s[a.XRANGELOOSE]:s[a.XRANGE];return e.replace(r,(function(r,i,s,o,a,c){n("xRange",e,r,i,s,o,a,c);var u=A(s),l=u||A(o),h=l||A(a),f=h;return"="===i&&f&&(i=""),c=t.includePrerelease?"-0":"",u?r=">"===i||"<"===i?"<0.0.0-0":"*":i&&f?(l&&(o=0),a=0,">"===i?(i=">=",l?(s=+s+1,o=0,a=0):(o=+o+1,a=0)):"<="===i&&(i="<",l?s=+s+1:o=+o+1),r=i+s+"."+o+"."+a+c):l?r=">="+s+".0.0"+c+" <"+(+s+1)+".0.0"+c:h&&(r=">="+s+"."+o+".0"+c+" <"+s+"."+(+o+1)+".0"+c),n("xRange return",r),r}))}(e,t)})).join(" ")}(e,t),n("xrange",e),e=function(e,t){return n("replaceStars",e,t),e.trim().replace(s[a.STAR],"")}(e,t),n("stars",e),e}(e,this.options)}),this).join(" ").split(/\s+/);return this.options.loose&&(o=o.filter((function(e){return!!e.match(i)}))),o=o.map((function(e){return new w(e,this.options)}),this)},x.prototype.intersects=function(e,t){if(!(e instanceof x))throw new TypeError("a Range is required");return this.set.some((function(r){return I(r,t)&&e.set.some((function(e){return I(e,t)&&r.every((function(r){return e.every((function(e){return r.intersects(e,t)}))}))}))}))},r.toComparators=function(e,t){return new x(e,t).set.map((function(e){return e.map((function(e){return e.value})).join(" ").trim().split(" ")}))},x.prototype.test=function(e){if(!e)return!1;if("string"==typeof e)try{e=new f(e,this.options)}catch(e){return!1}for(var t=0;t<this.set.length;t++)if(R(this.set[t],e,this.options))return!0;return!1},r.satisfies=N,r.maxSatisfying=function(e,t,r){var n=null,i=null;try{var s=new x(t,r)}catch(e){return null}return e.forEach((function(e){s.test(e)&&(n&&-1!==i.compare(e)||(i=new f(n=e,r)))})),n},r.minSatisfying=function(e,t,r){var n=null,i=null;try{var s=new x(t,r)}catch(e){return null}return e.forEach((function(e){s.test(e)&&(n&&1!==i.compare(e)||(i=new f(n=e,r)))})),n},r.minVersion=function(e,t){e=new x(e,t);var r=new f("0.0.0");if(e.test(r))return r;if(r=new f("0.0.0-0"),e.test(r))return r;r=null;for(var n=0;n<e.set.length;++n){e.set[n].forEach((function(e){var t=new f(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":r&&!m(r,t)||(r=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}}))}if(r&&e.test(r))return r;return null},r.validRange=function(e,t){try{return new x(e,t).range||"*"}catch(e){return null}},r.ltr=function(e,t,r){return P(e,t,"<",r)},r.gtr=function(e,t,r){return P(e,t,">",r)},r.outside=P,r.prerelease=function(e,t){var r=h(e,t);return r&&r.prerelease.length?r.prerelease:null},r.intersects=function(e,t,r){return e=new x(e,r),t=new x(t,r),e.intersects(t)},r.coerce=function(e,t){if(e instanceof f)return e;"number"==typeof e&&(e=String(e));if("string"!=typeof e)return null;var r=null;if((t=t||{}).rtl){for(var n;(n=s[a.COERCERTL].exec(e))&&(!r||r.index+r[0].length!==e.length);)r&&n.index+n[0].length===r.index+r[0].length||(r=n),s[a.COERCERTL].lastIndex=n.index+n[1].length+n[2].length;s[a.COERCERTL].lastIndex=-1}else r=e.match(s[a.COERCE]);if(null===r)return null;return h(r[2]+"."+(r[3]||"0")+"."+(r[4]||"0"),t)}}).call(this)}).call(this,e("_process"))}}},{package:"3box>ipfs>libp2p>libp2p-switch>multistream-select>semver"}],[5257,{},function(){with(this)return function(){"use strict";return function(e,t,r){(r=t.exports).PROTOCOL_ID="/multistream/1.0.0",r.errors={MULTICODEC_NOT_SUPPORTED:"ERR_MULTICODEC_NOT_SUPPORTED"}}}},{package:"3box>ipfs>libp2p>libp2p-switch>multistream-select"}],[5258,{"../select":5265,"../util":5266,"./../constants":5257,"interface-connection":4455,once:5323,"pull-length-prefixed":5469,"pull-stream/pull":5488,"pull-stream/sinks/collect":5489,"pull-stream/throughs/map":5510,"pull-stream/throughs/take":5512,varint:6042},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("varint"),i=e("pull-stream/pull"),s=e("pull-stream/throughs/map"),o=e("pull-stream/sinks/collect"),a=e("pull-stream/throughs/take"),c=e("pull-length-prefixed"),u=e("interface-connection").Connection,l=e("../util"),h=e("../select"),f=e("once"),p=e("./../constants").PROTOCOL_ID;function d(e){return e.toString().slice(0,-1)}t.exports=class{constructor(){this.conn=null,this.log=l.log.dialer()}handle(e,t){this.log("dialer handle conn"),t=f(t);const r=h(p,((r,n)=>{if(r)return t(r);this.log("handshake success"),this.conn=new u(n,e),t()}),this.log);try{i(e,r,e)}catch(e){this.log.error(e),t(e)}}select(e,t){if(this.log("dialer select "+e),t=f(t),!this.conn)return t(new Error("multistream handshake has not finalized yet"));const r=h(e,((e,r)=>{if(e)return this.conn=new u(r,this.conn),t(e);t(null,new u(r,this.conn))}),this.log);i(this.conn,r,this.conn)}ls(e){e=f(e);const t=h("ls",((t,r)=>{if(t)return e(t);i(r,c.decode(),function(e){let t=!0,r=0;return a((e=>t?(n.decode(e),r=n.decode(e,n.decode.bytes),!0):r-- >0))}(),s(d),o(((t,r)=>{if(t)return e(t);e(null,r.slice(1))})))}),this.log);i(this.conn,t,this.conn)}}}}},{package:"3box>ipfs>libp2p>libp2p-switch>multistream-select"}],[5259,{"./constants":5257,"./dialer":5258,"./listener":5260,"./listener/match-exact":5262,"./listener/match-semver":5263},function(){with(this)return function(){"use strict";return function(e,t,r){r.Listener=r.listener=e("./listener"),r.Dialer=r.dialer=e("./dialer"),r.matchSemver=e("./listener/match-semver"),r.matchExact=e("./listener/match-exact"),r.constants=e("./constants")}}},{package:"3box>ipfs>libp2p>libp2p-switch>multistream-select"}],[5260,{"../select":5265,"./../constants":5257,"./../util":5266,"./ls-handler":5261,"./match-exact":5262,"./select-handler":5264,assert:1805,"interface-connection":4455,"pull-stream/pull":5488},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("pull-stream/pull"),i=e("assert"),s=e("../select"),o=e("./select-handler"),a=e("./ls-handler"),c=e("./match-exact"),u=e("./../util"),l=e("interface-connection").Connection,h=e("./../constants").PROTOCOL_ID;t.exports=class{constructor(){this.handlers={ls:{handlerFunc:(e,t)=>a(this,t),matchFunc:c}},this.log=u.log.listener()}handle(e,t){this.log("listener handle conn");const r=s(h,((r,i)=>{if(r)return t(r);const s=new l(i,e),a=o(s,this.handlers,this.log);n(s,a,s),t()}),this.log);n(e,r,e)}addHandler(e,t,r){this.log("adding handler: "+e),i("function"==typeof t,"handler must be a function"),this.handlers[e]&&this.log("overwriting handler for "+e),r||(r=c),this.handlers[e]={handlerFunc:t,matchFunc:r}}}}}},{package:"3box>ipfs>libp2p>libp2p-switch>multistream-select"}],[5261,{buffer:2132,"pull-length-prefixed":5469,"pull-stream/pull":5488,"pull-stream/sources/values":5504,varint:6042},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("pull-stream/pull"),i=e("pull-stream/sources/values"),s=e("pull-length-prefixed"),o=e("varint");t.exports=function(e,t){const a=Object.keys(e.handlers).filter((e=>"ls"!==e)),c=a.length,u=a.reduce(((e,t)=>{const n=r.from(t+"\n");return e+o.encodingLength(n.length)}),0),l=r.concat([r.from(o.encode(c)),r.from(o.encode(u)),r.from("\n")]),h=a.map((e=>r.from(e+"\n")));n(i([l].concat(h)),s.encode(),t)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p>libp2p-switch>multistream-select"}],[5262,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e,t,r){r(null,e===t)}}}},{package:"3box>ipfs>libp2p>libp2p-switch>multistream-select"}],[5263,{semver:5256},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("semver");t.exports=function(e,t,r){const i=e.split("/"),s=t.split("/"),o=i[1],a=i[2],c=s[1],u=s[2];if(o!==c)return r(null,!1);r(null,n.satisfies(a,"~"+u))}}}},{package:"3box>ipfs>libp2p>libp2p-switch>multistream-select"}],[5264,{"../util.js":5266,"async/some":1879,buffer:2132,"interface-connection":4455,"pull-handshake":5466,"pull-length-prefixed":5469},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("pull-handshake"),i=e("pull-length-prefixed"),s=e("interface-connection").Connection,o=e("../util.js").writeEncoded,a=e("async/some");t.exports=function(e,t,c){const u=e=>{c.error(e)},l=n({timeout:6e4},u),h=l.handshake;return function n(){i.decodeFromReader(h,((i,l)=>{if(i)return u(i);c("received:",l.toString());const f=l.toString().slice(0,-1);!function(e,t,r){const n=Object.keys(t);let i=!1;a(n,((r,n)=>{t[r].matchFunc(r,e,((e,t)=>{if(e)return n(e);t&&(i=r),n()}))}),(e=>{if(e)return r(e);r(null,i)}))}(f,t,((i,a)=>{if(i)return u(i);const p=a;if(p){c("send ack back of: "+f),o(h,l,u);const r=new s(h.rest(),e);t[p].handlerFunc(f,r)}else c("not supported protocol: "+f),o(h,r.from("na\n")),n()}))}))}(),l}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p>libp2p-switch>multistream-select"}],[5265,{"./constants":5257,"./util":5266,buffer:2132,"err-code":2406,"pull-handshake":5466,"pull-length-prefixed":5469},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("pull-handshake"),i=e("pull-length-prefixed"),s=e("./util").writeEncoded,o=e("err-code"),{errors:a}=e("./constants");t.exports=function(e,t,c){const u=n({timeout:6e4},t),l=u.handshake;return c("writing multicodec: "+e),s(l,r.from(e+"\n"),t),i.decodeFromReader(l,((r,n)=>{if(r)return t(r);const i=n.toString().slice(0,-1);if(i!==e){const r=o(new Error(`"${e}" not supported`),a.MULTICODEC_NOT_SUPPORTED);return t(r,l.rest())}c("received ack: "+i),t(null,l.rest())})),u}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p>libp2p-switch>multistream-select"}],[5266,{buffer:2132,debug:2304,"pull-length-prefixed":5469,"pull-stream/pull":5488,"pull-stream/sinks/collect":5489,"pull-stream/sources/values":5504},function(){with(this)return function(){"use strict";return function(e,t,r){(function(n){(function(){const i=e("pull-stream/pull"),s=e("pull-stream/sources/values"),o=e("pull-stream/sinks/collect"),a=e("pull-length-prefixed"),c=e("debug");function u(e){const t=(~~(1e9*Math.random())).toString(36);function r(e){return r=>{Array.isArray(r)&&(r=r.join(" ")),e("(%s) %s",t,r)}}const n=r(c("mss:"+e));return n.error=r(c("mss:"+e+":error")),n}(r=t.exports).writeEncoded=(e,t,r)=>{!function(e,t){i(s(n.isBuffer(e)?[e]:[n.from(e)]),a.encode(),o(((e,r)=>{if(e)return t(e);t(null,r[0])})))}(t,((t,n)=>{if(t)return r(t);e.write(n)}))},r.log={},r.log.dialer=()=>u("dialer\t"),r.log.listener=()=>u("listener\t")}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p>libp2p-switch>multistream-select"}],[5267,{"@babel/runtime/helpers/asyncToGenerator":192,"@babel/runtime/helpers/interopRequireDefault":202,"@babel/runtime/regenerator":222,"did-resolver":2325,"node-fetch":5278},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault"),i=n(e("@babel/runtime/regenerator")),s=n(e("@babel/runtime/helpers/asyncToGenerator")),o=e("did-resolver"),a=n(e("node-fetch")),c="https://ipfs.infura.io/ipfs/";function u(e,t){return l.apply(this,arguments)}function l(){return(l=(0,s.default)(i.default.mark((function e(t,r){var n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=9;break}return e.t1=JSON,e.next=5,t.cat(r);case 5:e.t2=e.sent,e.t0=e.t1.parse.call(e.t1,e.t2),e.next=12;break;case 9:return e.next=11,h(r);case 11:e.t0=e.sent;case 12:n=e.t0,e.next=17;break;case 15:e.prev=15,e.t3=e.catch(0);case 17:if(n&&1===n.version&&n.signingKey&&n.managementKey&&n.asymEncryptionKey){e.next=20;break}try{t&&t.pin.rm(r)}catch(e){}throw new Error("Invalid muport did");case 20:return e.abrupt("return",n);case 21:case"end":return e.stop()}}),e,null,[[0,15]])})))).apply(this,arguments)}function h(e){return f.apply(this,arguments)}function f(){return(f=(0,s.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,a.default)(c+t);case 2:return e.abrupt("return",e.sent.json());case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e,t){var r={"@context":"https://w3id.org/did/v1",id:e,publicKey:[{id:e+"#signingKey",type:"Secp256k1VerificationKey2018",owner:e,publicKeyHex:t.signingKey},{id:e+"#managementKey",type:"Secp256k1VerificationKey2018",owner:e},{id:e+"#encryptionKey",type:"Curve25519EncryptionPublicKey",owner:e,publicKeyBase64:t.asymEncryptionKey}],authentication:[{type:"Secp256k1SignatureAuthentication2018",publicKey:e+"#signingKey"}],muportData:{}};return 42===t.managementKey.length?r.publicKey[1].ethereumAddress=t.managementKey:r.publicKey[1].publicKeyHex=t.managementKey,t.publicProfile&&(r.uportProfile=t.publicProfile),t.symEncryptedData&&(r.muportData.symEncryptedData=t.symEncryptedData),t.recoveryNetwork&&(r.muportData.recoveryNetwork=t.recoveryNetwork),r}t.exports=function(e){function t(e,t){return r.apply(this,arguments)}function r(){return(r=(0,s.default)(i.default.mark((function t(r,n){var s;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u(e,n.id);case 2:return s=t.sent,t.abrupt("return",p(r,s));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}arguments.length>1&&undefined,(0,o.registerMethod)("muport",t)}}}},{package:"3box>muport-did-resolver"}],[5268,{"./lib/murmurHash3js":5269},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e("./lib/murmurHash3js")}}},{package:"3box>ipfs>ipld-raw>multihashing-async>murmurhash3js-revisited"}],[5269,{},function(){with(this)return function(){"use strict";return function(e,t,r){!function(e,n){var i={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function s(e){if(!Array.isArray(e)&&!ArrayBuffer.isView(e))return!1;for(var t=0;t<e.length;t++)if(!Number.isInteger(e[t])||e[t]<0||e[t]>255)return!1;return!0}function o(e,t){return(65535&e)*t+(((e>>>16)*t&65535)<<16)}function a(e,t){return e<<t|e>>>32-t}function c(e){return e=o(e^=e>>>16,2246822507),e=o(e^=e>>>13,3266489909),e^=e>>>16}function u(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var r=[0,0,0,0];return r[3]+=e[3]+t[3],r[2]+=r[3]>>>16,r[3]&=65535,r[2]+=e[2]+t[2],r[1]+=r[2]>>>16,r[2]&=65535,r[1]+=e[1]+t[1],r[0]+=r[1]>>>16,r[1]&=65535,r[0]+=e[0]+t[0],r[0]&=65535,[r[0]<<16|r[1],r[2]<<16|r[3]]}function l(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var r=[0,0,0,0];return r[3]+=e[3]*t[3],r[2]+=r[3]>>>16,r[3]&=65535,r[2]+=e[2]*t[3],r[1]+=r[2]>>>16,r[2]&=65535,r[2]+=e[3]*t[2],r[1]+=r[2]>>>16,r[2]&=65535,r[1]+=e[1]*t[3],r[0]+=r[1]>>>16,r[1]&=65535,r[1]+=e[2]*t[2],r[0]+=r[1]>>>16,r[1]&=65535,r[1]+=e[3]*t[1],r[0]+=r[1]>>>16,r[1]&=65535,r[0]+=e[0]*t[3]+e[1]*t[2]+e[2]*t[1]+e[3]*t[0],r[0]&=65535,[r[0]<<16|r[1],r[2]<<16|r[3]]}function h(e,t){return 32===(t%=64)?[e[1],e[0]]:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t|e[0]>>>32-t]:(t-=32,[e[1]<<t|e[0]>>>32-t,e[0]<<t|e[1]>>>32-t])}function f(e,t){return 0===(t%=64)?e:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t]:[e[1]<<t-32,0]}function p(e,t){return[e[0]^t[0],e[1]^t[1]]}function d(e){return e=p(e,[0,e[0]>>>1]),e=p(e=l(e,[4283543511,3981806797]),[0,e[0]>>>1]),e=p(e=l(e,[3301882366,444984403]),[0,e[0]>>>1])}i.x86.hash32=function(e,t){if(i.inputValidation&&!s(e))return n;t=t||0;for(var r=e.length%4,u=e.length-r,l=t,h=0,f=3432918353,p=461845907,d=0;d<u;d+=4)h=o(h=e[d]|e[d+1]<<8|e[d+2]<<16|e[d+3]<<24,f),h=o(h=a(h,15),p),l=o(l=a(l^=h,13),5)+3864292196;switch(h=0,r){case 3:h^=e[d+2]<<16;case 2:h^=e[d+1]<<8;case 1:h=o(h^=e[d],f),l^=h=o(h=a(h,15),p)}return(l=c(l^=e.length))>>>0},i.x86.hash128=function(e,t){if(i.inputValidation&&!s(e))return n;t=t||0;for(var r=e.length%16,u=e.length-r,l=t,h=t,f=t,p=t,d=0,b=0,m=0,g=0,y=597399067,k=2869860233,_=951274213,E=2716044179,S=0;S<u;S+=16)d=e[S]|e[S+1]<<8|e[S+2]<<16|e[S+3]<<24,b=e[S+4]|e[S+5]<<8|e[S+6]<<16|e[S+7]<<24,m=e[S+8]|e[S+9]<<8|e[S+10]<<16|e[S+11]<<24,g=e[S+12]|e[S+13]<<8|e[S+14]<<16|e[S+15]<<24,d=a(d=o(d,y),15),l=a(l^=d=o(d,k),19),l=o(l+=h,5)+1444728091,b=a(b=o(b,k),16),h=a(h^=b=o(b,_),17),h=o(h+=f,5)+197830471,m=a(m=o(m,_),17),f=a(f^=m=o(m,E),15),f=o(f+=p,5)+2530024501,g=a(g=o(g,E),18),p=a(p^=g=o(g,y),13),p=o(p+=l,5)+850148119;switch(d=0,b=0,m=0,g=0,r){case 15:g^=e[S+14]<<16;case 14:g^=e[S+13]<<8;case 13:g=o(g^=e[S+12],E),p^=g=o(g=a(g,18),y);case 12:m^=e[S+11]<<24;case 11:m^=e[S+10]<<16;case 10:m^=e[S+9]<<8;case 9:m=o(m^=e[S+8],_),f^=m=o(m=a(m,17),E);case 8:b^=e[S+7]<<24;case 7:b^=e[S+6]<<16;case 6:b^=e[S+5]<<8;case 5:b=o(b^=e[S+4],k),h^=b=o(b=a(b,16),_);case 4:d^=e[S+3]<<24;case 3:d^=e[S+2]<<16;case 2:d^=e[S+1]<<8;case 1:d=o(d^=e[S],y),l^=d=o(d=a(d,15),k)}return l^=e.length,l+=h^=e.length,l+=f^=e.length,h+=l+=p^=e.length,f+=l,p+=l,l=c(l),l+=h=c(h),l+=f=c(f),h+=l+=p=c(p),f+=l,p+=l,("00000000"+(l>>>0).toString(16)).slice(-8)+("00000000"+(h>>>0).toString(16)).slice(-8)+("00000000"+(f>>>0).toString(16)).slice(-8)+("00000000"+(p>>>0).toString(16)).slice(-8)},i.x64.hash128=function(e,t){if(i.inputValidation&&!s(e))return n;t=t||0;for(var r=e.length%16,o=e.length-r,a=[0,t],c=[0,t],b=[0,0],m=[0,0],g=[2277735313,289559509],y=[1291169091,658871167],k=0;k<o;k+=16)b=[e[k+4]|e[k+5]<<8|e[k+6]<<16|e[k+7]<<24,e[k]|e[k+1]<<8|e[k+2]<<16|e[k+3]<<24],m=[e[k+12]|e[k+13]<<8|e[k+14]<<16|e[k+15]<<24,e[k+8]|e[k+9]<<8|e[k+10]<<16|e[k+11]<<24],b=h(b=l(b,g),31),a=u(a=h(a=p(a,b=l(b,y)),27),c),a=u(l(a,[0,5]),[0,1390208809]),m=h(m=l(m,y),33),c=u(c=h(c=p(c,m=l(m,g)),31),a),c=u(l(c,[0,5]),[0,944331445]);switch(b=[0,0],m=[0,0],r){case 15:m=p(m,f([0,e[k+14]],48));case 14:m=p(m,f([0,e[k+13]],40));case 13:m=p(m,f([0,e[k+12]],32));case 12:m=p(m,f([0,e[k+11]],24));case 11:m=p(m,f([0,e[k+10]],16));case 10:m=p(m,f([0,e[k+9]],8));case 9:m=l(m=p(m,[0,e[k+8]]),y),c=p(c,m=l(m=h(m,33),g));case 8:b=p(b,f([0,e[k+7]],56));case 7:b=p(b,f([0,e[k+6]],48));case 6:b=p(b,f([0,e[k+5]],40));case 5:b=p(b,f([0,e[k+4]],32));case 4:b=p(b,f([0,e[k+3]],24));case 3:b=p(b,f([0,e[k+2]],16));case 2:b=p(b,f([0,e[k+1]],8));case 1:b=l(b=p(b,[0,e[k]]),g),a=p(a,b=l(b=h(b,31),y))}return a=u(a=p(a,[0,e.length]),c=p(c,[0,e.length])),c=u(c,a),a=u(a=d(a),c=d(c)),c=u(c,a),("00000000"+(a[0]>>>0).toString(16)).slice(-8)+("00000000"+(a[1]>>>0).toString(16)).slice(-8)+("00000000"+(c[0]>>>0).toString(16)).slice(-8)+("00000000"+(c[1]>>>0).toString(16)).slice(-8)},void 0!==r?(void 0!==t&&t.exports&&(r=t.exports=i),r.murmurHash3=i):"function"==typeof define&&define.amd?define([],(function(){return i})):(i._murmurHash3=e.murmurHash3,i.noConflict=function(){return e.murmurHash3=i._murmurHash3,i._murmurHash3=n,i.noConflict=n,i},e.murmurHash3=i)}(this)}}},{package:"3box>ipfs>ipld-raw>multihashing-async>murmurhash3js-revisited"}],[5270,{"./lib/murmurHash3js":5271},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e("./lib/murmurHash3js")}}},{package:"3box>ipfs>multihashing-async>murmurhash3js"}],[5271,{},function(){with(this)return function(){"use strict";return function(e,t,r){!function(e,n){var i={version:"3.0.1",x86:{},x64:{}};function s(e,t){return(65535&e)*t+(((e>>>16)*t&65535)<<16)}function o(e,t){return e<<t|e>>>32-t}function a(e){return e=s(e^=e>>>16,2246822507),e=s(e^=e>>>13,3266489909),e^=e>>>16}function c(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var r=[0,0,0,0];return r[3]+=e[3]+t[3],r[2]+=r[3]>>>16,r[3]&=65535,r[2]+=e[2]+t[2],r[1]+=r[2]>>>16,r[2]&=65535,r[1]+=e[1]+t[1],r[0]+=r[1]>>>16,r[1]&=65535,r[0]+=e[0]+t[0],r[0]&=65535,[r[0]<<16|r[1],r[2]<<16|r[3]]}function u(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var r=[0,0,0,0];return r[3]+=e[3]*t[3],r[2]+=r[3]>>>16,r[3]&=65535,r[2]+=e[2]*t[3],r[1]+=r[2]>>>16,r[2]&=65535,r[2]+=e[3]*t[2],r[1]+=r[2]>>>16,r[2]&=65535,r[1]+=e[1]*t[3],r[0]+=r[1]>>>16,r[1]&=65535,r[1]+=e[2]*t[2],r[0]+=r[1]>>>16,r[1]&=65535,r[1]+=e[3]*t[1],r[0]+=r[1]>>>16,r[1]&=65535,r[0]+=e[0]*t[3]+e[1]*t[2]+e[2]*t[1]+e[3]*t[0],r[0]&=65535,[r[0]<<16|r[1],r[2]<<16|r[3]]}function l(e,t){return 32===(t%=64)?[e[1],e[0]]:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t|e[0]>>>32-t]:(t-=32,[e[1]<<t|e[0]>>>32-t,e[0]<<t|e[1]>>>32-t])}function h(e,t){return 0===(t%=64)?e:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t]:[e[1]<<t-32,0]}function f(e,t){return[e[0]^t[0],e[1]^t[1]]}function p(e){return e=f(e,[0,e[0]>>>1]),e=f(e=u(e,[4283543511,3981806797]),[0,e[0]>>>1]),e=f(e=u(e,[3301882366,444984403]),[0,e[0]>>>1])}i.x86.hash32=function(e,t){t=t||0;for(var r=(e=e||"").length%4,n=e.length-r,i=t,c=0,u=3432918353,l=461845907,h=0;h<n;h+=4)c=s(c=255&e.charCodeAt(h)|(255&e.charCodeAt(h+1))<<8|(255&e.charCodeAt(h+2))<<16|(255&e.charCodeAt(h+3))<<24,u),c=s(c=o(c,15),l),i=s(i=o(i^=c,13),5)+3864292196;switch(c=0,r){case 3:c^=(255&e.charCodeAt(h+2))<<16;case 2:c^=(255&e.charCodeAt(h+1))<<8;case 1:c=s(c^=255&e.charCodeAt(h),u),i^=c=s(c=o(c,15),l)}return(i=a(i^=e.length))>>>0},i.x86.hash128=function(e,t){t=t||0;for(var r=(e=e||"").length%16,n=e.length-r,i=t,c=t,u=t,l=t,h=0,f=0,p=0,d=0,b=597399067,m=2869860233,g=951274213,y=2716044179,k=0;k<n;k+=16)h=255&e.charCodeAt(k)|(255&e.charCodeAt(k+1))<<8|(255&e.charCodeAt(k+2))<<16|(255&e.charCodeAt(k+3))<<24,f=255&e.charCodeAt(k+4)|(255&e.charCodeAt(k+5))<<8|(255&e.charCodeAt(k+6))<<16|(255&e.charCodeAt(k+7))<<24,p=255&e.charCodeAt(k+8)|(255&e.charCodeAt(k+9))<<8|(255&e.charCodeAt(k+10))<<16|(255&e.charCodeAt(k+11))<<24,d=255&e.charCodeAt(k+12)|(255&e.charCodeAt(k+13))<<8|(255&e.charCodeAt(k+14))<<16|(255&e.charCodeAt(k+15))<<24,h=o(h=s(h,b),15),i=o(i^=h=s(h,m),19),i=s(i+=c,5)+1444728091,f=o(f=s(f,m),16),c=o(c^=f=s(f,g),17),c=s(c+=u,5)+197830471,p=o(p=s(p,g),17),u=o(u^=p=s(p,y),15),u=s(u+=l,5)+2530024501,d=o(d=s(d,y),18),l=o(l^=d=s(d,b),13),l=s(l+=i,5)+850148119;switch(h=0,f=0,p=0,d=0,r){case 15:d^=e.charCodeAt(k+14)<<16;case 14:d^=e.charCodeAt(k+13)<<8;case 13:d=s(d^=e.charCodeAt(k+12),y),l^=d=s(d=o(d,18),b);case 12:p^=e.charCodeAt(k+11)<<24;case 11:p^=e.charCodeAt(k+10)<<16;case 10:p^=e.charCodeAt(k+9)<<8;case 9:p=s(p^=e.charCodeAt(k+8),g),u^=p=s(p=o(p,17),y);case 8:f^=e.charCodeAt(k+7)<<24;case 7:f^=e.charCodeAt(k+6)<<16;case 6:f^=e.charCodeAt(k+5)<<8;case 5:f=s(f^=e.charCodeAt(k+4),m),c^=f=s(f=o(f,16),g);case 4:h^=e.charCodeAt(k+3)<<24;case 3:h^=e.charCodeAt(k+2)<<16;case 2:h^=e.charCodeAt(k+1)<<8;case 1:h=s(h^=e.charCodeAt(k),b),i^=h=s(h=o(h,15),m)}return i^=e.length,i+=c^=e.length,i+=u^=e.length,c+=i+=l^=e.length,u+=i,l+=i,i=a(i),i+=c=a(c),i+=u=a(u),c+=i+=l=a(l),u+=i,l+=i,("00000000"+(i>>>0).toString(16)).slice(-8)+("00000000"+(c>>>0).toString(16)).slice(-8)+("00000000"+(u>>>0).toString(16)).slice(-8)+("00000000"+(l>>>0).toString(16)).slice(-8)},i.x64.hash128=function(e,t){t=t||0;for(var r=(e=e||"").length%16,n=e.length-r,i=[0,t],s=[0,t],o=[0,0],a=[0,0],d=[2277735313,289559509],b=[1291169091,658871167],m=0;m<n;m+=16)o=[255&e.charCodeAt(m+4)|(255&e.charCodeAt(m+5))<<8|(255&e.charCodeAt(m+6))<<16|(255&e.charCodeAt(m+7))<<24,255&e.charCodeAt(m)|(255&e.charCodeAt(m+1))<<8|(255&e.charCodeAt(m+2))<<16|(255&e.charCodeAt(m+3))<<24],a=[255&e.charCodeAt(m+12)|(255&e.charCodeAt(m+13))<<8|(255&e.charCodeAt(m+14))<<16|(255&e.charCodeAt(m+15))<<24,255&e.charCodeAt(m+8)|(255&e.charCodeAt(m+9))<<8|(255&e.charCodeAt(m+10))<<16|(255&e.charCodeAt(m+11))<<24],o=l(o=u(o,d),31),i=c(i=l(i=f(i,o=u(o,b)),27),s),i=c(u(i,[0,5]),[0,1390208809]),a=l(a=u(a,b),33),s=c(s=l(s=f(s,a=u(a,d)),31),i),s=c(u(s,[0,5]),[0,944331445]);switch(o=[0,0],a=[0,0],r){case 15:a=f(a,h([0,e.charCodeAt(m+14)],48));case 14:a=f(a,h([0,e.charCodeAt(m+13)],40));case 13:a=f(a,h([0,e.charCodeAt(m+12)],32));case 12:a=f(a,h([0,e.charCodeAt(m+11)],24));case 11:a=f(a,h([0,e.charCodeAt(m+10)],16));case 10:a=f(a,h([0,e.charCodeAt(m+9)],8));case 9:a=u(a=f(a,[0,e.charCodeAt(m+8)]),b),s=f(s,a=u(a=l(a,33),d));case 8:o=f(o,h([0,e.charCodeAt(m+7)],56));case 7:o=f(o,h([0,e.charCodeAt(m+6)],48));case 6:o=f(o,h([0,e.charCodeAt(m+5)],40));case 5:o=f(o,h([0,e.charCodeAt(m+4)],32));case 4:o=f(o,h([0,e.charCodeAt(m+3)],24));case 3:o=f(o,h([0,e.charCodeAt(m+2)],16));case 2:o=f(o,h([0,e.charCodeAt(m+1)],8));case 1:o=u(o=f(o,[0,e.charCodeAt(m)]),d),i=f(i,o=u(o=l(o,31),b))}return i=c(i=f(i,[0,e.length]),s=f(s,[0,e.length])),s=c(s,i),i=c(i=p(i),s=p(s)),s=c(s,i),("00000000"+(i[0]>>>0).toString(16)).slice(-8)+("00000000"+(i[1]>>>0).toString(16)).slice(-8)+("00000000"+(s[0]>>>0).toString(16)).slice(-8)+("00000000"+(s[1]>>>0).toString(16)).slice(-8)},void 0!==r?(void 0!==t&&t.exports&&(r=t.exports=i),r.murmurHash3=i):"function"==typeof define&&define.amd?define([],(function(){return i})):(i._murmurHash3=e.murmurHash3,i.noConflict=function(){return e.murmurHash3=i._murmurHash3,i._murmurHash3=n,i.noConflict=n,i},e.murmurHash3=i)}(this)}}},{package:"3box>ipfs>multihashing-async>murmurhash3js"}],[5272,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e,t,r){for(var n=(2<<Math.log(t.length-1)/Math.LN2)-1,i=-~(1.6*n*r/t.length),s="";;)for(var o=e(i),a=i;a--;)if((s+=t[o[a]&n]||"").length===+r)return s}}}},{package:"nanoid"}],[5273,{},function(){with(this)return function(){"use strict";return function(e,t,r){for(var n=self.crypto||self.msCrypto,i="-_",s=36;s--;)i+=s.toString(36);for(s=36;s---10;)i+=s.toString(36).toUpperCase();t.exports=function(e){var t="",r=n.getRandomValues(new Uint8Array(e||21));for(s=e||21;s--;)t+=i[63&r[s]];return t}}}},{package:"nanoid"}],[5279,{"./cipher":5282,"./cipherModes":5283,"./forge":5285,"./util":5307},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./forge");function i(e,t){n.cipher.registerAlgorithm(e,(function(){return new n.aes.Algorithm(e,t)}))}e("./cipher"),e("./cipherModes"),e("./util"),t.exports=n.aes=n.aes||{},n.aes.startEncrypting=function(e,t,r,n){var i=d({key:e,output:r,decrypt:!1,mode:n});return i.start(t),i},n.aes.createEncryptionCipher=function(e,t){return d({key:e,output:null,decrypt:!1,mode:t})},n.aes.startDecrypting=function(e,t,r,n){var i=d({key:e,output:r,decrypt:!0,mode:n});return i.start(t),i},n.aes.createDecryptionCipher=function(e,t){return d({key:e,output:null,decrypt:!0,mode:t})},n.aes.Algorithm=function(e,t){l||h();var r=this;r.name=e,r.mode=new t({blockSize:16,cipher:{encrypt:function(e,t){return p(r._w,e,t,!1)},decrypt:function(e,t){return p(r._w,e,t,!0)}}}),r._init=!1},n.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t,r=e.key;if("string"!=typeof r||16!==r.length&&24!==r.length&&32!==r.length){if(n.util.isArray(r)&&(16===r.length||24===r.length||32===r.length)){t=r,r=n.util.createBuffer();for(var i=0;i<t.length;++i)r.putByte(t[i])}}else r=n.util.createBuffer(r);if(!n.util.isArray(r)){t=r,r=[];var s=t.length();if(16===s||24===s||32===s){s>>>=2;for(i=0;i<s;++i)r.push(t.getInt32())}}if(!n.util.isArray(r)||4!==r.length&&6!==r.length&&8!==r.length)throw new Error("Invalid key parameter.");var o=this.mode.name,a=-1!==["CFB","OFB","CTR","GCM"].indexOf(o);this._w=f(r,e.decrypt&&!a),this._init=!0}},n.aes._expandKey=function(e,t){return l||h(),f(e,t)},n.aes._updateBlock=p,i("AES-ECB",n.cipher.modes.ecb),i("AES-CBC",n.cipher.modes.cbc),i("AES-CFB",n.cipher.modes.cfb),i("AES-OFB",n.cipher.modes.ofb),i("AES-CTR",n.cipher.modes.ctr),i("AES-GCM",n.cipher.modes.gcm);var s,o,a,c,u,l=!1;function h(){l=!0,a=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;s=new Array(256),o=new Array(256),c=new Array(4),u=new Array(4);for(t=0;t<4;++t)c[t]=new Array(256),u[t]=new Array(256);var r,n,i,h,f,p,d,b=0,m=0;for(t=0;t<256;++t){h=(h=m^m<<1^m<<2^m<<3^m<<4)>>8^255&h^99,s[b]=h,o[h]=b,p=(f=e[h])<<24^h<<16^h<<8^h^f,d=((r=e[b])^(n=e[r])^(i=e[n]))<<24^(b^i)<<16^(b^n^i)<<8^b^r^i;for(var g=0;g<4;++g)c[g][b]=p,u[g][h]=d,p=p<<24|p>>>8,d=d<<24|d>>>8;0===b?b=m=1:(b=r^e[e[e[r^i]]],m^=e[e[m]])}}function f(e,t){for(var r,n=e.slice(0),i=1,o=n.length,c=4*(o+6+1),l=o;l<c;++l)r=n[l-1],l%o==0?(r=s[r>>>16&255]<<24^s[r>>>8&255]<<16^s[255&r]<<8^s[r>>>24]^a[i]<<24,i++):o>6&&l%o==4&&(r=s[r>>>24]<<24^s[r>>>16&255]<<16^s[r>>>8&255]<<8^s[255&r]),n[l]=n[l-o]^r;if(t){for(var h,f=u[0],p=u[1],d=u[2],b=u[3],m=n.slice(0),g=(l=0,(c=n.length)-4);l<c;l+=4,g-=4)if(0===l||l===c-4)m[l]=n[g],m[l+1]=n[g+3],m[l+2]=n[g+2],m[l+3]=n[g+1];else for(var y=0;y<4;++y)h=n[g+y],m[l+(3&-y)]=f[s[h>>>24]]^p[s[h>>>16&255]]^d[s[h>>>8&255]]^b[s[255&h]];n=m}return n}function p(e,t,r,n){var i,a,l,h,f,p,d,b,m,g,y,k,_=e.length/4-1;n?(i=u[0],a=u[1],l=u[2],h=u[3],f=o):(i=c[0],a=c[1],l=c[2],h=c[3],f=s),p=t[0]^e[0],d=t[n?3:1]^e[1],b=t[2]^e[2],m=t[n?1:3]^e[3];for(var E=3,S=1;S<_;++S)g=i[p>>>24]^a[d>>>16&255]^l[b>>>8&255]^h[255&m]^e[++E],y=i[d>>>24]^a[b>>>16&255]^l[m>>>8&255]^h[255&p]^e[++E],k=i[b>>>24]^a[m>>>16&255]^l[p>>>8&255]^h[255&d]^e[++E],m=i[m>>>24]^a[p>>>16&255]^l[d>>>8&255]^h[255&b]^e[++E],p=g,d=y,b=k;r[0]=f[p>>>24]<<24^f[d>>>16&255]<<16^f[b>>>8&255]<<8^f[255&m]^e[++E],r[n?3:1]=f[d>>>24]<<24^f[b>>>16&255]<<16^f[m>>>8&255]<<8^f[255&p]^e[++E],r[2]=f[b>>>24]<<24^f[m>>>16&255]<<16^f[p>>>8&255]<<8^f[255&d]^e[++E],r[n?1:3]=f[m>>>24]<<24^f[p>>>16&255]<<16^f[d>>>8&255]<<8^f[255&b]^e[++E]}function d(e){var t,r="AES-"+((e=e||{}).mode||"CBC").toUpperCase(),i=(t=e.decrypt?n.cipher.createDecipher(r,e.key):n.cipher.createCipher(r,e.key)).start;return t.start=function(e,r){var s=null;r instanceof n.util.ByteBuffer&&(s=r,r={}),(r=r||{}).output=s,r.iv=e,i.call(t,r)},t}}}},{package:"mockttp>node-forge"}],[5280,{"./forge":5285,"./oids":5291,"./util":5307},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./forge");e("./util"),e("./oids");var i=t.exports=n.asn1=n.asn1||{};function s(e,t,r){if(r>t){var n=new Error("Too few bytes to parse DER.");throw n.available=e.length(),n.remaining=t,n.requested=r,n}}i.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},i.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},i.create=function(e,t,r,s,o){if(n.util.isArray(s)){for(var a=[],c=0;c<s.length;++c)s[c]!==undefined&&a.push(s[c]);s=a}var u={tagClass:e,type:t,constructed:r,composed:r||n.util.isArray(s),value:s};return o&&"bitStringContents"in o&&(u.bitStringContents=o.bitStringContents,u.original=i.copy(u)),u},i.copy=function(e,t){var r;if(n.util.isArray(e)){r=[];for(var s=0;s<e.length;++s)r.push(i.copy(e[s],t));return r}return"string"==typeof e?e:(r={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:i.copy(e.value,t)},t&&!t.excludeBitStringContents&&(r.bitStringContents=e.bitStringContents),r)},i.equals=function(e,t,r){if(n.util.isArray(e)){if(!n.util.isArray(t))return!1;if(e.length!==t.length)return!1;for(var s=0;s<e.length;++s)if(!i.equals(e[s],t[s]))return!1;return!0}if(typeof e!=typeof t)return!1;if("string"==typeof e)return e===t;var o=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&i.equals(e.value,t.value);return r&&r.includeBitStringContents&&(o=o&&e.bitStringContents===t.bitStringContents),o},i.getBerValueLength=function(e){var t=e.getByte();return 128===t?undefined:128&t?e.getInt((127&t)<<3):t};function o(e,t,r,n){var a;s(e,t,2);var c=e.getByte();t--;var u=192&c,l=31&c;a=e.length();var h,f,p=function(e,t){var r,n=e.getByte();if(t--,128===n)return undefined;if(128&n){var i=127&n;s(e,t,i),r=e.getInt(i<<3)}else r=n;if(r<0)throw new Error("Negative length: "+r);return r}(e,t);if(t-=a-e.length(),p!==undefined&&p>t){if(n.strict){var d=new Error("Too few bytes to read ASN.1 value.");throw d.available=e.length(),d.remaining=t,d.requested=p,d}p=t}var b=32==(32&c);if(b)if(h=[],p===undefined)for(;;){if(s(e,t,2),e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2),t-=2;break}a=e.length(),h.push(o(e,t,r+1,n)),t-=a-e.length()}else for(;p>0;)a=e.length(),h.push(o(e,p,r+1,n)),t-=a-e.length(),p-=a-e.length();if(h===undefined&&u===i.Class.UNIVERSAL&&l===i.Type.BITSTRING&&(f=e.bytes(p)),h===undefined&&n.decodeBitStrings&&u===i.Class.UNIVERSAL&&l===i.Type.BITSTRING&&p>1){var m=e.read,g=t,y=0;if(l===i.Type.BITSTRING&&(s(e,t,1),y=e.getByte(),t--),0===y)try{a=e.length();var k=o(e,t,r+1,{strict:!0,decodeBitStrings:!0}),_=a-e.length();t-=_,l==i.Type.BITSTRING&&_++;var E=k.tagClass;_!==p||E!==i.Class.UNIVERSAL&&E!==i.Class.CONTEXT_SPECIFIC||(h=[k])}catch(e){}h===undefined&&(e.read=m,t=g)}if(h===undefined){if(p===undefined){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");p=t}if(l===i.Type.BMPSTRING)for(h="";p>0;p-=2)s(e,t,2),h+=String.fromCharCode(e.getInt16()),t-=2;else h=e.getBytes(p),t-=p}var S=f===undefined?null:{bitStringContents:f};return i.create(u,l,b,h,S)}i.fromDer=function(e,t){t===undefined&&(t={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),"boolean"==typeof t&&(t={strict:t,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"parseAllBytes"in t||(t.parseAllBytes=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),"string"==typeof e&&(e=n.util.createBuffer(e));var r=e.length(),i=o(e,e.length(),0,t);if(t.parseAllBytes&&0!==e.length()){var s=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw s.byteCount=r,s.remaining=e.length(),s}return i},i.toDer=function(e){var t=n.util.createBuffer(),r=e.tagClass|e.type,s=n.util.createBuffer(),o=!1;if("bitStringContents"in e&&(o=!0,e.original&&(o=i.equals(e,e.original))),o)s.putBytes(e.bitStringContents);else if(e.composed){e.constructed?r|=32:s.putByte(0);for(var a=0;a<e.value.length;++a)e.value[a]!==undefined&&s.putBuffer(i.toDer(e.value[a]))}else if(e.type===i.Type.BMPSTRING)for(a=0;a<e.value.length;++a)s.putInt16(e.value.charCodeAt(a));else e.type===i.Type.INTEGER&&e.value.length>1&&(0===e.value.charCodeAt(0)&&0==(128&e.value.charCodeAt(1))||255===e.value.charCodeAt(0)&&128==(128&e.value.charCodeAt(1)))?s.putBytes(e.value.substr(1)):s.putBytes(e.value);if(t.putByte(r),s.length()<=127)t.putByte(127&s.length());else{var c=s.length(),u="";do{u+=String.fromCharCode(255&c),c>>>=8}while(c>0);t.putByte(128|u.length);for(a=u.length-1;a>=0;--a)t.putByte(u.charCodeAt(a))}return t.putBuffer(s),t},i.oidToDer=function(e){var t,r,i,s,o=e.split("."),a=n.util.createBuffer();a.putByte(40*parseInt(o[0],10)+parseInt(o[1],10));for(var c=2;c<o.length;++c){t=!0,r=[],i=parseInt(o[c],10);do{s=127&i,i>>>=7,t||(s|=128),r.push(s),t=!1}while(i>0);for(var u=r.length-1;u>=0;--u)a.putByte(r[u])}return a},i.derToOid=function(e){var t;"string"==typeof e&&(e=n.util.createBuffer(e));var r=e.getByte();t=Math.floor(r/40)+"."+r%40;for(var i=0;e.length()>0;)i<<=7,128&(r=e.getByte())?i+=127&r:(t+="."+(i+r),i=0);return t},i.utcTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(e.substr(2,2),10)-1,i=parseInt(e.substr(4,2),10),s=parseInt(e.substr(6,2),10),o=parseInt(e.substr(8,2),10),a=0;if(e.length>11){var c=e.charAt(10),u=10;"+"!==c&&"-"!==c&&(a=parseInt(e.substr(10,2),10),u+=2)}if(t.setUTCFullYear(r,n,i),t.setUTCHours(s,o,a,0),u&&("+"===(c=e.charAt(u))||"-"===c)){var l=60*parseInt(e.substr(u+1,2),10)+parseInt(e.substr(u+4,2),10);l*=6e4,"+"===c?t.setTime(+t-l):t.setTime(+t+l)}return t},i.generalizedTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,4),10),n=parseInt(e.substr(4,2),10)-1,i=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),o=parseInt(e.substr(10,2),10),a=parseInt(e.substr(12,2),10),c=0,u=0,l=!1;"Z"===e.charAt(e.length-1)&&(l=!0);var h=e.length-5,f=e.charAt(h);"+"!==f&&"-"!==f||(u=60*parseInt(e.substr(h+1,2),10)+parseInt(e.substr(h+4,2),10),u*=6e4,"+"===f&&(u*=-1),l=!0);return"."===e.charAt(14)&&(c=1e3*parseFloat(e.substr(14),10)),l?(t.setUTCFullYear(r,n,i),t.setUTCHours(s,o,a,c),t.setTime(+t+u)):(t.setFullYear(r,n,i),t.setHours(s,o,a,c)),t},i.dateToUtcTime=function(e){if("string"==typeof e)return e;var t="",r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z"},i.dateToGeneralizedTime=function(e){if("string"==typeof e)return e;var t="",r=[];r.push(""+e.getUTCFullYear()),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z"},i.integerToDer=function(e){var t=n.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=e,r},i.derToInteger=function(e){"string"==typeof e&&(e=n.util.createBuffer(e));var t=8*e.length();if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)},i.validate=function(e,t,r,s){var o=!1;if(e.tagClass!==t.tagClass&&void 0!==t.tagClass||e.type!==t.type&&void 0!==t.type)s&&(e.tagClass!==t.tagClass&&s.push("["+t.name+"] "+'Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&s.push("["+t.name+"] "+'Expected type "'+t.type+'", got "'+e.type+'"'));else if(e.constructed===t.constructed||void 0===t.constructed){if(o=!0,t.value&&n.util.isArray(t.value))for(var a=0,c=0;o&&c<t.value.length;++c)o=t.value[c].optional||!1,e.value[a]&&((o=i.validate(e.value[a],t.value[c],r,s))?++a:t.value[c].optional&&(o=!0)),!o&&s&&s.push("["+t.name+"] "+'Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(o&&r)if(t.capture&&(r[t.capture]=e.value),t.captureAsn1&&(r[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(r[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e)if(e.bitStringContents.length<2)r[t.captureBitStringValue]="";else{if(0!==e.bitStringContents.charCodeAt(0))throw new Error("captureBitStringValue only supported for zero unused bits");r[t.captureBitStringValue]=e.bitStringContents.slice(1)}}else s&&s.push("["+t.name+"] "+'Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');return o};var a=/[^\\u0000-\\u00ff]/;i.prettyPrint=function(e,t,r){var s="";r=r||2,(t=t||0)>0&&(s+="\n");for(var o="",c=0;c<t*r;++c)o+=" ";switch(s+=o+"Tag: ",e.tagClass){case i.Class.UNIVERSAL:s+="Universal:";break;case i.Class.APPLICATION:s+="Application:";break;case i.Class.CONTEXT_SPECIFIC:s+="Context-Specific:";break;case i.Class.PRIVATE:s+="Private:"}if(e.tagClass===i.Class.UNIVERSAL)switch(s+=e.type,e.type){case i.Type.NONE:s+=" (None)";break;case i.Type.BOOLEAN:s+=" (Boolean)";break;case i.Type.INTEGER:s+=" (Integer)";break;case i.Type.BITSTRING:s+=" (Bit string)";break;case i.Type.OCTETSTRING:s+=" (Octet string)";break;case i.Type.NULL:s+=" (Null)";break;case i.Type.OID:s+=" (Object Identifier)";break;case i.Type.ODESC:s+=" (Object Descriptor)";break;case i.Type.EXTERNAL:s+=" (External or Instance of)";break;case i.Type.REAL:s+=" (Real)";break;case i.Type.ENUMERATED:s+=" (Enumerated)";break;case i.Type.EMBEDDED:s+=" (Embedded PDV)";break;case i.Type.UTF8:s+=" (UTF8)";break;case i.Type.ROID:s+=" (Relative Object Identifier)";break;case i.Type.SEQUENCE:s+=" (Sequence)";break;case i.Type.SET:s+=" (Set)";break;case i.Type.PRINTABLESTRING:s+=" (Printable String)";break;case i.Type.IA5String:s+=" (IA5String (ASCII))";break;case i.Type.UTCTIME:s+=" (UTC time)";break;case i.Type.GENERALIZEDTIME:s+=" (Generalized time)";break;case i.Type.BMPSTRING:s+=" (BMP String)"}else s+=e.type;if(s+="\n",s+=o+"Constructed: "+e.constructed+"\n",e.composed){var u=0,l="";for(c=0;c<e.value.length;++c)e.value[c]!==undefined&&(u+=1,l+=i.prettyPrint(e.value[c],t+1,r),c+1<e.value.length&&(l+=","));s+=o+"Sub values: "+u+l}else{if(s+=o+"Value: ",e.type===i.Type.OID){var h=i.derToOid(e.value);s+=h,n.pki&&n.pki.oids&&h in n.pki.oids&&(s+=" ("+n.pki.oids[h]+") ")}if(e.type===i.Type.INTEGER)try{s+=i.derToInteger(e.value)}catch(t){s+="0x"+n.util.bytesToHex(e.value)}else if(e.type===i.Type.BITSTRING){if(e.value.length>1?s+="0x"+n.util.bytesToHex(e.value.slice(1)):s+="(none)",e.value.length>0){var f=e.value.charCodeAt(0);1==f?s+=" (1 unused bit shown)":f>1&&(s+=" ("+f+" unused bits shown)")}}else if(e.type===i.Type.OCTETSTRING)a.test(e.value)||(s+="("+e.value+") "),s+="0x"+n.util.bytesToHex(e.value);else if(e.type===i.Type.UTF8)try{s+=n.util.decodeUtf8(e.value)}catch(t){if("URI malformed"!==t.message)throw t;s+="0x"+n.util.bytesToHex(e.value)+" (malformed UTF8)"}else e.type===i.Type.PRINTABLESTRING||e.type===i.Type.IA5String?s+=e.value:a.test(e.value)?s+="0x"+n.util.bytesToHex(e.value):0===e.value.length?s+="[null]":s+=e.value}return s}}}},{package:"mockttp>node-forge"}],[5281,{buffer:2131},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e){(function(){var r={};t.exports=r;var n={};r.encode=function(e,t,r){if("string"!=typeof t)throw new TypeError('"alphabet" must be a string.');if(r!==undefined&&"number"!=typeof r)throw new TypeError('"maxline" must be a number.');var n="";if(e instanceof Uint8Array){var i=0,s=t.length,o=t.charAt(0),a=[0];for(i=0;i<e.length;++i){for(var c=0,u=e[i];c<a.length;++c)u+=a[c]<<8,a[c]=u%s,u=u/s|0;for(;u>0;)a.push(u%s),u=u/s|0}for(i=0;0===e[i]&&i<e.length-1;++i)n+=o;for(i=a.length-1;i>=0;--i)n+=t[a[i]]}else n=function(e,t){var r=0,n=t.length,i=t.charAt(0),s=[0];for(r=0;r<e.length();++r){for(var o=0,a=e.at(r);o<s.length;++o)a+=s[o]<<8,s[o]=a%n,a=a/n|0;for(;a>0;)s.push(a%n),a=a/n|0}var c="";for(r=0;0===e.at(r)&&r<e.length()-1;++r)c+=i;for(r=s.length-1;r>=0;--r)c+=t[s[r]];return c}(e,t);if(r){var l=new RegExp(".{1,"+r+"}","g");n=n.match(l).join("\r\n")}return n},r.decode=function(t,r){if("string"!=typeof t)throw new TypeError('"input" must be a string.');if("string"!=typeof r)throw new TypeError('"alphabet" must be a string.');var i=n[r];if(!i){i=n[r]=[];for(var s=0;s<r.length;++s)i[r.charCodeAt(s)]=s}t=t.replace(/\s/g,"");var o=r.length,a=r.charAt(0),c=[0];for(s=0;s<t.length;s++){var u=i[t.charCodeAt(s)];if(u===undefined)return;for(var l=0,h=u;l<c.length;++l)h+=c[l]*o,c[l]=255&h,h>>=8;for(;h>0;)c.push(255&h),h>>=8}for(var f=0;t[f]===a&&f<t.length-1;++f)c.push(0);return void 0!==e?e.from(c.reverse()):new Uint8Array(c.reverse())}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"mockttp>node-forge"}],[5282,{"./forge":5285,"./util":5307},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./forge");e("./util"),t.exports=n.cipher=n.cipher||{},n.cipher.algorithms=n.cipher.algorithms||{},n.cipher.createCipher=function(e,t){var r=e;if("string"==typeof r&&(r=n.cipher.getAlgorithm(r))&&(r=r()),!r)throw new Error("Unsupported algorithm: "+e);return new n.cipher.BlockCipher({algorithm:r,key:t,decrypt:!1})},n.cipher.createDecipher=function(e,t){var r=e;if("string"==typeof r&&(r=n.cipher.getAlgorithm(r))&&(r=r()),!r)throw new Error("Unsupported algorithm: "+e);return new n.cipher.BlockCipher({algorithm:r,key:t,decrypt:!0})},n.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),n.cipher.algorithms[e]=t},n.cipher.getAlgorithm=function(e){return(e=e.toUpperCase())in n.cipher.algorithms?n.cipher.algorithms[e]:null};var i=n.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};i.prototype.start=function(e){e=e||{};var t={};for(var r in e)t[r]=e[r];t.decrypt=this._decrypt,this._finish=!1,this._input=n.util.createBuffer(),this.output=e.output||n.util.createBuffer(),this.mode.start(t)},i.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},i.prototype.finish=function(e){!e||"ECB"!==this.mode.name&&"CBC"!==this.mode.name||(this.mode.pad=function(t){return e(this.blockSize,t,!1)},this.mode.unpad=function(t){return e(this.blockSize,t,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t))&&(this._finish=!0,this.update(),!(this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))&&!(this.mode.afterFinish&&!this.mode.afterFinish(this.output,t)))}}}},{package:"mockttp>node-forge"}],[5283,{"./forge":5285,"./util":5307},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./forge");e("./util"),n.cipher=n.cipher||{};var i=t.exports=n.cipher.modes=n.cipher.modes||{};function s(e,t){if("string"==typeof e&&(e=n.util.createBuffer(e)),n.util.isArray(e)&&e.length>4){var r=e;e=n.util.createBuffer();for(var i=0;i<r.length;++i)e.putByte(r[i])}if(e.length()<t)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.");if(!n.util.isArray(e)){var s=[],o=t/4;for(i=0;i<o;++i)s.push(e.getInt32());e=s}return e}function o(e){e[e.length-1]=e[e.length-1]+1&4294967295}function a(e){return[e/4294967296|0,4294967295&e]}i.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},i.ecb.prototype.start=function(e){},i.ecb.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])},i.ecb.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])},i.ecb.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0},i.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return!(n>this.blockSize<<2)&&(e.truncate(n),!0)},i.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},i.cbc.prototype.start=function(e){if(null===e.iv){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else{if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=s(e.iv,this.blockSize),this._prev=this._iv.slice(0)}},i.cbc.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]);this._prev=this._outBlock},i.cbc.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)},i.cbc.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0},i.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return!(n>this.blockSize<<2)&&(e.truncate(n),!0)},i.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},i.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=s(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.cfb.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32()^this._outBlock[i],t.putInt32(this._inBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(s>0)e.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},i.cfb.prototype.decrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32(),t.putInt32(this._inBlock[i]^this._outBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(s>0)e.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},i.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},i.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=s(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.ofb.prototype.encrypt=function(e,t,r){var n=e.length();if(0===e.length())return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s>0)e.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},i.ofb.prototype.decrypt=i.ofb.prototype.encrypt,i.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},i.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=s(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.ctr.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}o(this._inBlock)},i.ctr.prototype.decrypt=i.ctr.prototype.encrypt,i.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0,this._R=3774873600},i.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t,r=n.util.createBuffer(e.iv);if(this._cipherLength=0,t="additionalData"in e?n.util.createBuffer(e.additionalData):n.util.createBuffer(),this._tagLength="tagLength"in e?e.tagLength:128,this._tag=null,e.decrypt&&(this._tag=n.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var i=r.length();if(12===i)this._j0=[r.getInt32(),r.getInt32(),r.getInt32(),1];else{for(this._j0=[0,0,0,0];r.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(a(8*i)))}this._inBlock=this._j0.slice(0),o(this._inBlock),this._partialBytes=0,t=n.util.createBuffer(t),this._aDataLength=a(8*t.length());var s=t.length()%this.blockSize;for(s&&t.fillWithByte(0,this.blockSize-s),this._s=[0,0,0,0];t.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()])},i.gcm.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^=e.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s<=0||r){if(r){var a=n%this.blockSize;this._cipherLength+=a,this._partialOutput.truncate(this.blockSize-a)}else this._cipherLength+=this.blockSize;for(i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),o(this._inBlock)},i.gcm.prototype.decrypt=function(e,t,r){var n=e.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),o(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize},i.gcm.prototype.afterFinish=function(e,t){var r=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=n.util.createBuffer();var i=this._aDataLength.concat(a(8*this._cipherLength));this._s=this.ghash(this._hashSubkey,this._s,i);var s=[];this.cipher.encrypt(this._j0,s);for(var o=0;o<this._ints;++o)this.tag.putInt32(this._s[o]^s[o]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r},i.gcm.prototype.multiply=function(e,t){for(var r=[0,0,0,0],n=t.slice(0),i=0;i<128;++i){e[i/32|0]&1<<31-i%32&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r},i.gcm.prototype.pow=function(e,t){for(var r=1&e[3],n=3;n>0;--n)t[n]=e[n]>>>1|(1&e[n-1])<<31;t[0]=e[0]>>>1,r&&(t[0]^=this._R)},i.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],r=0;r<32;++r){var n=e[r/8|0]>>>4*(7-r%8)&15,i=this._m[r][n];t[0]^=i[0],t[1]^=i[1],t[2]^=i[2],t[3]^=i[3]}return t},i.gcm.prototype.ghash=function(e,t,r){return t[0]^=r[0],t[1]^=r[1],t[2]^=r[2],t[3]^=r[3],this.tableMultiply(t)},i.gcm.prototype.generateHashTable=function(e,t){for(var r=8/t,n=4*r,i=16*r,s=new Array(i),o=0;o<i;++o){var a=[0,0,0,0],c=(n-1-o%n)*t;a[o/n|0]=1<<t-1<<c,s[o]=this.generateSubHashTable(this.multiply(a,e),t)}return s},i.gcm.prototype.generateSubHashTable=function(e,t){var r=1<<t,n=r>>>1,i=new Array(r);i[n]=e.slice(0);for(var s=n>>>1;s>0;)this.pow(i[2*s],i[s]=[]),s>>=1;for(s=2;s<n;){for(var o=1;o<s;++o){var a=i[s],c=i[o];i[s+o]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}s*=2}for(i[0]=[0,0,0,0],s=n+1;s<r;++s){var u=i[s^n];i[s]=[e[0]^u[0],e[1]^u[1],e[2]^u[2],e[3]^u[3]]}return i}}}},{package:"mockttp>node-forge"}],[5284,{"./cipher":5282,"./cipherModes":5283,"./forge":5285,"./util":5307},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./forge");function i(e,t){n.cipher.registerAlgorithm(e,(function(){return new n.des.Algorithm(e,t)}))}e("./cipher"),e("./cipherModes"),e("./util"),t.exports=n.des=n.des||{},n.des.startEncrypting=function(e,t,r,n){var i=d({key:e,output:r,decrypt:!1,mode:n||(null===t?"ECB":"CBC")});return i.start(t),i},n.des.createEncryptionCipher=function(e,t){return d({key:e,output:null,decrypt:!1,mode:t})},n.des.startDecrypting=function(e,t,r,n){var i=d({key:e,output:r,decrypt:!0,mode:n||(null===t?"ECB":"CBC")});return i.start(t),i},n.des.createDecryptionCipher=function(e,t){return d({key:e,output:null,decrypt:!0,mode:t})},n.des.Algorithm=function(e,t){var r=this;r.name=e,r.mode=new t({blockSize:8,cipher:{encrypt:function(e,t){return p(r._keys,e,t,!1)},decrypt:function(e,t){return p(r._keys,e,t,!0)}}}),r._init=!1},n.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=n.util.createBuffer(e.key);if(0===this.name.indexOf("3DES")&&24!==t.length())throw new Error("Invalid Triple-DES key size: "+8*t.length());this._keys=function(e){for(var t,r=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],n=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],i=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],s=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],o=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],c=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],u=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],l=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],h=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],f=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],p=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],d=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],b=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],m=e.length()>8?3:1,g=[],y=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],k=0,_=0;_<m;_++){var E=e.getInt32(),S=e.getInt32();E^=(t=252645135&(E>>>4^S))<<4,E^=t=65535&((S^=t)>>>-16^E),E^=(t=858993459&(E>>>2^(S^=t<<-16)))<<2,E^=t=65535&((S^=t)>>>-16^E),E^=(t=1431655765&(E>>>1^(S^=t<<-16)))<<1,E^=t=16711935&((S^=t)>>>8^E),t=(E^=(t=1431655765&(E>>>1^(S^=t<<8)))<<1)<<8|(S^=t)>>>20&240,E=S<<24|S<<8&16711680|S>>>8&65280|S>>>24&240,S=t;for(var w=0;w<y.length;++w){y[w]?(E=E<<2|E>>>26,S=S<<2|S>>>26):(E=E<<1|E>>>27,S=S<<1|S>>>27),S&=-15;var v=r[(E&=-15)>>>28]|n[E>>>24&15]|i[E>>>20&15]|s[E>>>16&15]|o[E>>>12&15]|a[E>>>8&15]|c[E>>>4&15],x=u[S>>>28]|l[S>>>24&15]|h[S>>>20&15]|f[S>>>16&15]|p[S>>>12&15]|d[S>>>8&15]|b[S>>>4&15];t=65535&(x>>>16^v),g[k++]=v^t,g[k++]=x^t<<16}}return g}(t),this._init=!0}},i("DES-ECB",n.cipher.modes.ecb),i("DES-CBC",n.cipher.modes.cbc),i("DES-CFB",n.cipher.modes.cfb),i("DES-OFB",n.cipher.modes.ofb),i("DES-CTR",n.cipher.modes.ctr),i("3DES-ECB",n.cipher.modes.ecb),i("3DES-CBC",n.cipher.modes.cbc),i("3DES-CFB",n.cipher.modes.cfb),i("3DES-OFB",n.cipher.modes.ofb),i("3DES-CTR",n.cipher.modes.ctr);var s=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],o=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],a=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],c=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],u=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],l=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],h=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],f=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function p(e,t,r,n){var i,p,d=32===e.length?3:9;i=3===d?n?[30,-2,-2]:[0,32,2]:n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var b=t[0],m=t[1];b^=(p=252645135&(b>>>4^m))<<4,b^=(p=65535&(b>>>16^(m^=p)))<<16,b^=p=858993459&((m^=p)>>>2^b),b^=p=16711935&((m^=p<<2)>>>8^b),b=(b^=(p=1431655765&(b>>>1^(m^=p<<8)))<<1)<<1|b>>>31,m=(m^=p)<<1|m>>>31;for(var g=0;g<d;g+=3){for(var y=i[g+1],k=i[g+2],_=i[g];_!=y;_+=k){var E=m^e[_],S=(m>>>4|m<<28)^e[_+1];p=b,b=m,m=p^(o[E>>>24&63]|c[E>>>16&63]|l[E>>>8&63]|f[63&E]|s[S>>>24&63]|a[S>>>16&63]|u[S>>>8&63]|h[63&S])}p=b,b=m,m=p}m=m>>>1|m<<31,m^=p=1431655765&((b=b>>>1|b<<31)>>>1^m),m^=(p=16711935&(m>>>8^(b^=p<<1)))<<8,m^=(p=858993459&(m>>>2^(b^=p)))<<2,m^=p=65535&((b^=p)>>>16^m),m^=p=252645135&((b^=p<<16)>>>4^m),b^=p<<4,r[0]=b,r[1]=m}function d(e){var t,r="DES-"+((e=e||{}).mode||"CBC").toUpperCase(),i=(t=e.decrypt?n.cipher.createDecipher(r,e.key):n.cipher.createCipher(r,e.key)).start;return t.start=function(e,r){var s=null;r instanceof n.util.ByteBuffer&&(s=r,r={}),(r=r||{}).output=s,r.iv=e,i.call(t,r)},t}}}},{package:"mockttp>node-forge"}],[5285,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={options:{usePureJavaScript:!1}}}}},{package:"mockttp>node-forge"}]],[],{});