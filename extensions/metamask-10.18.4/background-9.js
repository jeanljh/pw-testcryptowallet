LavaPack.loadBundle([[588,{stream:2135},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.storeAsStream=void 0;const n=e("stream");class i extends n.Duplex{constructor(e){super({objectMode:!0}),this.resume(),this.handler=e=>this.push(e),this.obsStore=e,this.obsStore.subscribe(this.handler)}pipe(e,t){const r=super.pipe(e,t);return e.write(this.obsStore.getState()),r}_write(e,t,r){this.obsStore.putState(e),r()}_read(e){return undefined}_destroy(e,t){this.obsStore.unsubscribe(this.handler),super._destroy(e,t)}}r.storeAsStream=function(e){return new i(e)}}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store"}],[5880,{"is-plain-obj":4749},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("is-plain-obj");t.exports=(e,t)=>{if(!n(e))throw new TypeError("Expected a plain object");if("function"==typeof(t=t||{}))throw new TypeError("Specify the compare function as an option instead");const r=t.deep,i=[],o=[],s=e=>{const a=i.indexOf(e);if(-1!==a)return o[a];const c={},l=Object.keys(e).sort(t.compare);i.push(e),o.push(c);for(let t=0;t<l.length;t++){const i=l[t],o=e[i];if(r&&Array.isArray(o)){const e=[];for(let t=0;t<o.length;t++)e[t]=n(o[t])?s(o[t]):o[t];c[i]=e}else c[i]=r&&n(o)?s(o):o}return c};return s(e)}}}},{package:"3box>ipfs>ipfs-repo>sort-keys"}],[5881,{},function(){with(this)return function(){"use strict";return function(e,t,r){function n(e,t){return e+i(t)}function i(e){let t=e;return t-=t>>1&1431655765,t=(858993459&t)+(t>>2&858993459),16843009*(t+(t>>4)&252645135)>>24}function o(e,t){return e[0]-t[0]}function s(e){return e[1]}t.exports=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(e,t){let r=this._internalPositionFor(e,!1);if(t===undefined)-1!==r&&(this._unsetInternalPos(r),this._unsetBit(e),this._changedLength=!0,this._changedData=!0);else{let n=!1;-1===r?(r=this._data.length,this._setBit(e),this._changedData=!0):n=!0,this._setInternalPos(r,e,t,n),this._changedLength=!0}}unset(e){this.set(e,undefined)}get(e){this._sortData();const t=this._internalPositionFor(e,!0);return-1===t?undefined:this._data[t][1]}push(e){return this.set(this.length,e),this.length}get length(){if(this._sortData(),this._changedLength){const e=this._data[this._data.length-1];this._length=e?e[0]+1:0,this._changedLength=!1}return this._length}forEach(e){let t=0;for(;t<this.length;)e(this.get(t),t,this),t++}map(e){let t=0,r=new Array(this.length);for(;t<this.length;)r[t]=e(this.get(t),t,this),t++;return r}reduce(e,t){let r=0,n=t;for(;r<this.length;){n=e(n,this.get(r),r),r++}return n}find(e){let t,r,n=0;for(;n<this.length&&!t;)r=this.get(n),t=e(r),n++;return t?r:undefined}_internalPositionFor(e,t){const r=this._bytePosFor(e,t);if(r>=this._bitArrays.length)return-1;const o=this._bitArrays[r],s=e-7*r;if(!((o&1<<s)>0))return-1;return this._bitArrays.slice(0,r).reduce(n,0)+i(o&~(4294967295<<s+1))-1}_bytePosFor(e,t){const r=Math.floor(e/7),n=r+1;for(;!t&&this._bitArrays.length<n;)this._bitArrays.push(0);return r}_setBit(e){const t=this._bytePosFor(e,!1);this._bitArrays[t]|=1<<e-7*t}_unsetBit(e){const t=this._bytePosFor(e,!1);this._bitArrays[t]&=~(1<<e-7*t)}_setInternalPos(e,t,r,n){const i=this._data,o=[t,r];if(n)this._sortData(),i[e]=o;else{if(i.length)if(i[i.length-1][0]>=t)i.push(o);else if(i[0][0]<=t)i.unshift(o);else{const e=Math.round(i.length/2);this._data=i.slice(0,e).concat(o).concat(i.slice(e))}else this._data.push(o);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(e){this._data.splice(e,1)}_sortData(){this._changedData&&this._data.sort(o),this._changedData=!1}bitField(){const e=[];let t,r=8,n=0,i=0;const o=this._bitArrays.slice();for(;o.length||n;){0===n&&(t=o.shift(),n=7);const s=Math.min(n,r);i|=(t&~(255<<s))<<8-r,t>>>=s,n-=s,r-=s,r&&(n||o.length)||(e.push(i),i=0,r=8)}for(var s=e.length-1;s>0;s--){if(0!==e[s])break;e.pop()}return e}compactArray(){return this._sortData(),this._data.map(s)}}}}},{package:"3box>ipfs>ipfs-mfs>hamt-sharding>sparse-array"}],[5882,{},function(){with(this)return function(){"use strict";return function(e,t,r){
//! stable.js 0.1.8, https://github.com/Two-Screen/stable
//! Â© 2018 Angry Bytes and contributors. MIT licensed.
!function(e,n){"object"==typeof r&&void 0!==t?t.exports=n():"function"==typeof define&&define.amd?define(n):e.stable=n()}(this,(function(){var e=function(e,r){return t(e.slice(),r)};function t(e,t){"function"!=typeof t&&(t=function(e,t){return String(e).localeCompare(t)});var n=e.length;if(n<=1)return e;for(var i=new Array(n),o=1;o<n;o*=2){r(e,t,o,i);var s=e;e=i,i=s}return e}e.inplace=function(e,n){var i=t(e,n);return i!==e&&r(i,null,e.length,e),e};var r=function(e,t,r,n){var i,o,s,a,c,l=e.length,u=0,d=2*r;for(i=0;i<l;i+=d)for(s=(o=i+r)+r,o>l&&(o=l),s>l&&(s=l),a=i,c=o;;)if(a<o&&c<s)t(e[a],e[c])<=0?n[u++]=e[a++]:n[u++]=e[c++];else if(a<o)n[u++]=e[a++];else{if(!(c<s))break;n[u++]=e[c++]}};return e}))}}},{package:"@storybook/client-api>stable"}],[5883,{"../plugins/json2":5884,"../src/store-engine":5886,"../storages/all":5888},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("../src/store-engine"),i=e("../storages/all"),o=[e("../plugins/json2")];t.exports=n.createStore(i,o)}}},{package:"3box>store"}],[5884,{"./lib/json2":5885},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(){return e("./lib/json2"),{}}}}},{package:"3box>store"}],[5885,{},function(){with(this)return function(){"use strict";return function(e,t,r){"object"!=typeof JSON&&(JSON={}),function(){var e,t,r,n,i=/^[\],:{}\s]*$/,o=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,s=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,a=/(?:^|:|,)(?:\s*\[)+/g,c=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,l=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;function u(e){return e<10?"0"+e:e}function d(){return this.valueOf()}function h(e){return c.lastIndex=0,c.test(e)?'"'+e.replace(c,(function(e){var t=r[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+e+'"'}function p(r,i){var o,s,a,c,l,u=e,d=i[r];switch(d&&"object"==typeof d&&"function"==typeof d.toJSON&&(d=d.toJSON(r)),"function"==typeof n&&(d=n.call(i,r,d)),typeof d){case"string":return h(d);case"number":return isFinite(d)?String(d):"null";case"boolean":case"null":return String(d);case"object":if(!d)return"null";if(e+=t,l=[],"[object Array]"===Object.prototype.toString.apply(d)){for(c=d.length,o=0;o<c;o+=1)l[o]=p(o,d)||"null";return a=0===l.length?"[]":e?"[\n"+e+l.join(",\n"+e)+"\n"+u+"]":"["+l.join(",")+"]",e=u,a}if(n&&"object"==typeof n)for(c=n.length,o=0;o<c;o+=1)"string"==typeof n[o]&&(a=p(s=n[o],d))&&l.push(h(s)+(e?": ":":")+a);else for(s in d)Object.prototype.hasOwnProperty.call(d,s)&&(a=p(s,d))&&l.push(h(s)+(e?": ":":")+a);return a=0===l.length?"{}":e?"{\n"+e+l.join(",\n"+e)+"\n"+u+"}":"{"+l.join(",")+"}",e=u,a}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+u(this.getUTCMonth()+1)+"-"+u(this.getUTCDate())+"T"+u(this.getUTCHours())+":"+u(this.getUTCMinutes())+":"+u(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=d,Number.prototype.toJSON=d,String.prototype.toJSON=d),"function"!=typeof JSON.stringify&&(r={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(r,i,o){var s;if(e="",t="","number"==typeof o)for(s=0;s<o;s+=1)t+=" ";else"string"==typeof o&&(t=o);if(n=i,i&&"function"!=typeof i&&("object"!=typeof i||"number"!=typeof i.length))throw new Error("JSON.stringify");return p("",{"":r})}),"function"!=typeof JSON.parse&&(JSON.parse=function(e,t){var r;if(e=String(e),l.lastIndex=0,l.test(e)&&(e=e.replace(l,(function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))),i.test(e.replace(o,"@").replace(s,"]").replace(a,"")))return r=(0,eval)("("+e+")"),"function"==typeof t?function e(r,n){var i,o,s=r[n];if(s&&"object"==typeof s)for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&((o=e(s,i))!==undefined?s[i]=o:delete s[i]);return t.call(r,n,s)}({"":r},""):r;throw new SyntaxError("JSON.parse")})}()}}},{package:"3box>store"}],[5886,{"./util":5887},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./util"),i=n.slice,o=n.pluck,s=n.each,a=n.bind,c=n.create,l=n.isList,u=n.isFunction,d=n.isObject;t.exports={createStore:p};var h={version:"2.0.12",enabled:!1,get:function(e,t){var r=this.storage.read(this._namespacePrefix+e);return this._deserialize(r,t)},set:function(e,t){return t===undefined?this.remove(e):(this.storage.write(this._namespacePrefix+e,this._serialize(t)),t)},remove:function(e){this.storage.remove(this._namespacePrefix+e)},each:function(e){var t=this;this.storage.each((function(r,n){e.call(t,t._deserialize(r),(n||"").replace(t._namespaceRegexp,""))}))},clearAll:function(){this.storage.clearAll()},hasNamespace:function(e){return this._namespacePrefix=="__storejs_"+e+"_"},createStore:function(){return p.apply(this,arguments)},addPlugin:function(e){this._addPlugin(e)},namespace:function(e){return p(this.storage,this.plugins,e)}};function p(e,t,r){r||(r=""),e&&!l(e)&&(e=[e]),t&&!l(t)&&(t=[t]);var n=r?"__storejs_"+r+"_":"",p=r?new RegExp("^"+n):null;if(!/^[a-zA-Z0-9_\-]*$/.test(r))throw new Error("store.js namespaces can only have alphanumerics + underscores and dashes");var f={_namespacePrefix:n,_namespaceRegexp:p,_testStorage:function(e){try{var t="__storejs__test__";e.write(t,t);var r=e.read(t)===t;return e.remove(t),r}catch(e){return!1}},_assignPluginFnProp:function(e,t){var r=this[t];this[t]=function(){var t=i(arguments,0),n=this;function o(){if(r)return s(arguments,(function(e,r){t[r]=e})),r.apply(n,t)}var a=[o].concat(t);return e.apply(n,a)}},_serialize:function(e){return JSON.stringify(e)},_deserialize:function(e,t){if(!e)return t;var r="";try{r=JSON.parse(e)}catch(t){r=e}return r!==undefined?r:t},_addStorage:function(e){this.enabled||this._testStorage(e)&&(this.storage=e,this.enabled=!0)},_addPlugin:function(e){var t=this;if(l(e))s(e,(function(e){t._addPlugin(e)}));else if(!o(this.plugins,(function(t){return e===t}))){if(this.plugins.push(e),!u(e))throw new Error("Plugins must be function values that return objects");var r=e.call(this);if(!d(r))throw new Error("Plugins must return an object of function properties");s(r,(function(r,n){if(!u(r))throw new Error("Bad plugin property: "+n+" from plugin "+e.name+". Plugins should only return functions.");t._assignPluginFnProp(r,n)}))}},addStorage:function(e){!function(){var e="undefined"==typeof console?null:console;if(e){(e.warn?e.warn:e.log).apply(e,arguments)}}("store.addStorage(storage) is deprecated. Use createStore([storages])"),this._addStorage(e)}},g=c(f,h,{plugins:[]});return g.raw={},s(g,(function(e,t){u(e)&&(g.raw[t]=a(g,e))})),s(e,(function(e){g._addStorage(e)})),s(t,(function(e){g._addPlugin(e)})),g}}}},{package:"3box>store"}],[5887,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n=Object.assign?Object.assign:function(e,t,r,n){for(var i=1;i<arguments.length;i++)c(Object(arguments[i]),(function(t,r){e[r]=t}));return e},i=function(){if(Object.create)return function(e,t,r,i){var o=a(arguments,1);return n.apply(this,[Object.create(e)].concat(o))};{function e(){}return function(t,r,i,o){var s=a(arguments,1);return e.prototype=t,n.apply(this,[new e].concat(s))}}}(),o=String.prototype.trim?function(e){return String.prototype.trim.call(e)}:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},s="undefined"!=typeof window?window:global;function a(e,t){return Array.prototype.slice.call(e,t||0)}function c(e,t){l(e,(function(e,r){return t(e,r),!1}))}function l(e,t){if(u(e)){for(var r=0;r<e.length;r++)if(t(e[r],r))return e[r]}else for(var n in e)if(e.hasOwnProperty(n)&&t(e[n],n))return e[n]}function u(e){return null!=e&&"function"!=typeof e&&"number"==typeof e.length}t.exports={assign:n,create:i,trim:o,bind:function(e,t){return function(){return t.apply(e,Array.prototype.slice.call(arguments,0))}},slice:a,each:c,map:function(e,t){var r=u(e)?[]:{};return l(e,(function(e,n){return r[n]=t(e,n),!1})),r},pluck:l,isList:u,isFunction:function(e){return e&&"[object Function]"==={}.toString.call(e)},isObject:function(e){return e&&"[object Object]"==={}.toString.call(e)},Global:s}}}},{package:"3box>store"}],[5888,{"./cookieStorage":5889,"./localStorage":5890,"./memoryStorage":5891,"./oldFF-globalStorage":5892,"./oldIE-userDataStorage":5893,"./sessionStorage":5894},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=[e("./localStorage"),e("./oldFF-globalStorage"),e("./oldIE-userDataStorage"),e("./cookieStorage"),e("./sessionStorage"),e("./memoryStorage")]}}},{package:"3box>store"}],[5889,{"../src/util":5887},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("../src/util"),i=n.Global,o=n.trim;t.exports={name:"cookieStorage",read:function(e){if(!e||!l(e))return null;var t="(?:^|.*;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*";return unescape(s.cookie.replace(new RegExp(t),"$1"))},write:function(e,t){if(!e)return;s.cookie=escape(e)+"="+escape(t)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/"},each:a,remove:c,clearAll:function(){a((function(e,t){c(t)}))}};var s=i.document;function a(e){for(var t=s.cookie.split(/; ?/g),r=t.length-1;r>=0;r--)if(o(t[r])){var n=t[r].split("="),i=unescape(n[0]);e(unescape(n[1]),i)}}function c(e){e&&l(e)&&(s.cookie=escape(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/")}function l(e){return new RegExp("(?:^|;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(s.cookie)}}}},{package:"3box>store"}],[589,{"./ComposedStore":585,"./MergedStore":586,"./ObservableStore":587,"./asStream":588,"./transform":590},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./asStream"),r),i(e("./ComposedStore"),r),i(e("./MergedStore"),r),i(e("./ObservableStore"),r),i(e("./transform"),r)}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store"}],[5890,{"../src/util":5887},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("../src/util").Global;function i(){return n.localStorage}function o(e){return i().getItem(e)}t.exports={name:"localStorage",read:o,write:function(e,t){return i().setItem(e,t)},each:function(e){for(var t=i().length-1;t>=0;t--){var r=i().key(t);e(o(r),r)}},remove:function(e){return i().removeItem(e)},clearAll:function(){return i().clear()}}}}},{package:"3box>store"}],[5891,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={name:"memoryStorage",read:function(e){return n[e]},write:function(e,t){n[e]=t},each:function(e){for(var t in n)n.hasOwnProperty(t)&&e(n[t],t)},remove:function(e){delete n[e]},clearAll:function(e){n={}}};var n={}}}},{package:"3box>store"}],[5892,{"../src/util":5887},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("../src/util").Global;t.exports={name:"oldFF-globalStorage",read:function(e){return i[e]},write:function(e,t){i[e]=t},each:o,remove:function(e){return i.removeItem(e)},clearAll:function(){o((function(e,t){delete i[e]}))}};var i=n.globalStorage;function o(e){for(var t=i.length-1;t>=0;t--){var r=i.key(t);e(i[r],r)}}}}},{package:"3box>store"}],[5893,{"../src/util":5887},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("../src/util").Global;t.exports={name:"oldIE-userDataStorage",write:function(e,t){if(a)return;var r=l(e);s((function(e){e.setAttribute(r,t),e.save(i)}))},read:function(e){if(a)return;var t=l(e),r=null;return s((function(e){r=e.getAttribute(t)})),r},each:function(e){s((function(t){for(var r=t.XMLDocument.documentElement.attributes,n=r.length-1;n>=0;n--){var i=r[n];e(t.getAttribute(i.name),i.name)}}))},remove:function(e){var t=l(e);s((function(e){e.removeAttribute(t),e.save(i)}))},clearAll:function(){s((function(e){var t=e.XMLDocument.documentElement.attributes;e.load(i);for(var r=t.length-1;r>=0;r--)e.removeAttribute(t[r].name);e.save(i)}))}};var i="storejs",o=n.document,s=function(){if(!o||!o.documentElement||!o.documentElement.addBehavior)return null;var e,t,r,n="script";try{(t=new ActiveXObject("htmlfile")).open(),t.write("<"+n+">document.w=window</"+n+'><iframe src="/favicon.ico"></iframe>'),t.close(),e=t.w.frames[0].document,r=e.createElement("div")}catch(t){r=o.createElement("div"),e=o.body}return function(t){var n=[].slice.call(arguments,0);n.unshift(r),e.appendChild(r),r.addBehavior("#default#userData"),r.load(i),t.apply(this,n),e.removeChild(r)}}(),a=(n.navigator?n.navigator.userAgent:"").match(/ (MSIE 8|MSIE 9|MSIE 10)\./);var c=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g");function l(e){return e.replace(/^\d/,"___$&").replace(c,"___")}}}},{package:"3box>store"}],[5894,{"../src/util":5887},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("../src/util").Global;function i(){return n.sessionStorage}function o(e){return i().getItem(e)}t.exports={name:"sessionStorage",read:o,write:function(e,t){return i().setItem(e,t)},each:function(e){for(var t=i().length-1;t>=0;t--){var r=i().key(t);e(o(r),r)}},remove:function(e){return i().removeItem(e)},clearAll:function(){return i().clear()}}}}},{package:"3box>store"}],[59,{lodash:5188},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return i((0,n.cloneDeep)(e),(e=>null===e?"null":typeof e))};var n=e("lodash");function i(e={},t){return Object.entries(e).forEach((([r,n])=>{e[r]="object"==typeof n&&null!==n?i(n,t):t(n)})),e}}}},{package:"$root$"}],[590,{through2:591},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.storeTransformStream=void 0;const n=e("through2");r.storeTransformStream=function(e){return n.obj(((t,r,n)=>{try{return n(null,e(t)),undefined}catch(e){return n(e),undefined}}))}}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store"}],[591,{_process:5430,"readable-stream":5710,util:2138,xtend:6173},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("readable-stream").Transform,i=e("util").inherits,o=e("xtend");function s(e){n.call(this,e),this._destroyed=!1}function a(e,t,r){r(null,e)}function c(e){return function(t,r,n){return"function"==typeof t&&(n=r,r=t,t={}),"function"!=typeof r&&(r=a),"function"!=typeof n&&(n=null),e(t,r,n)}}i(s,n),s.prototype.destroy=function(e){if(!this._destroyed){this._destroyed=!0;var t=this;r.nextTick((function(){e&&t.emit("error",e),t.emit("close")}))}},t.exports=c((function(e,t,r){var n=new s(e);return n._transform=t,r&&(n._flush=r),n})),t.exports.ctor=c((function(e,t,r){function n(t){if(!(this instanceof n))return new n(t);this.options=o(e,t),s.call(this,this.options)}return i(n,s),n.prototype._transform=t,r&&(n.prototype._flush=r),n})),t.exports.obj=c((function(e,t,r){var n=new s(o({objectMode:!0,highWaterMark:16},e));return n._transform=t,r&&(n._flush=r),n}))}).call(this)}).call(this,e("_process"))}}},{package:"@keystonehq/metamask-airgapped-keyring>@metamask/obs-store>through2"}],[5914,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e){var t=e._readableState;return t?t.objectMode?e.read():e.read(function(e){if(e.buffer.length)return e.buffer.head?e.buffer.head.data.length:e.buffer[0].length;return e.length}(t)):null}}}},{package:"duplexify>stream-shift"}],[5915,{_process:5430,looper:5200,"pull-stream/pull":5488},function(){with(this)return function(){"use strict";return function(e,t,r){(function(n){(function(){e("pull-stream/pull");var i=e("looper");function o(e){e.destroy?e.destroy():console.error("warning, stream-to-pull-stream: \n"+"the wrapped node-stream does not implement `destroy`, \n"+"this may cause resource leaks.")}function s(e,t,r){var s,a,c=!1;function l(){a||(a=!0,r&&r(!0===s?null:s))}function u(){c||(c=!0,h(),s?l():e(s=!0,l))}function d(t){h(),s||e(s=t,l)}function h(){t.on("finish",u),t.removeListener("close",u),t.removeListener("error",d)}t.on("close",u),t.on("finish",u),t.on("error",d),n.nextTick((function(){i((function(r){e(null,(function(e,n){if(s=s||e,!0===e)return t._isStdio?l():t.end();if(s=s||e)return o(t),l();t._isStdio?t.write(n,(function(){r()})):!1===t.write(n)?t.once("drain",r):r()}))}))}))}function a(e){var t,r=[],n=[],i=!1;function s(){for(;(r.length||t)&&n.length;)n.shift()(r.length?null:t,r.shift());!r.length&&i&&(i=!1,e.resume())}return e.on("data",(function(t){r.push(t),s(),r.length&&e.pause&&(i=!0,e.pause())})),e.on("end",(function(){t=!0,s()})),e.on("close",(function(){t=!0,s()})),e.on("error",(function(e){t=e,s()})),function(r,i){if(!i)throw new Error("*must* provide cb");if(r){function s(){for(;n.length;)n.shift()(r);i(r)}if(t)return s();e.once("close",s),o(e)}else n.push(i),s()}}var c=a,l=function(e,t){return function(r){return s(r,e,t)}},u=function(e){return a(e)};(r=t.exports=function(e,t){return e.writable&&e.write?e.readable?function(r){return s(r,e,t),a(e)}:l(e,t):u(e)}).sink=l,r.source=u,r.read=c,r.read1=a,r.read2=function(e){var t,r=!1,n=!1;function i(){var r=e.read();if(null!==r&&t){var n=t;t=null,n(null,r)}}return e.on("readable",(function(){n=!0,t&&i()})).on("end",(function(){r=!0,t&&t(r)})).on("error",(function(e){r=e,t&&t(r)})),function(e,o){t=o,r?o(r):n&&i()}},r.duplex=function(e,t){return{source:u(e),sink:l(e,t)}},r.transform=function(e){return function(t){var r=u(e);return l(e)(t),r}}}).call(this)}).call(this,e("_process"))}}},{package:"3box>ipfs>stream-to-pull-stream"}],[5918,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});class n extends TypeError{static format(e){const{type:t,path:r,value:n}=e;return`Expected a value of type \`${t}\`${r.length?` for \`${r.join(".")}\``:""} but received \`${JSON.stringify(n)}\`.`}constructor(e){super(n.format(e));const{data:t,path:r,value:i,reason:o,type:s,errors:a=[]}=e;this.data=t,this.path=r,this.value=i,this.reason=o,this.type=s,this.errors=a,a.length||a.push(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack}}var i=Object.prototype.toString,o=function(e){if(void 0===e)return"undefined";if(null===e)return"null";var t,r=typeof e;if("boolean"===r)return"boolean";if("string"===r)return"string";if("number"===r)return"number";if("symbol"===r)return"symbol";if("function"===r)return t=e,"GeneratorFunction"===s(t)?"generatorfunction":"function";if(function(e){return Array.isArray?Array.isArray(e):e instanceof Array}(e))return"array";if(function(e){if(e.constructor&&"function"==typeof e.constructor.isBuffer)return e.constructor.isBuffer(e);return!1}(e))return"buffer";if(function(e){try{if("number"==typeof e.length&&"function"==typeof e.callee)return!0}catch(e){if(-1!==e.message.indexOf("callee"))return!0}return!1}(e))return"arguments";if(function(e){return e instanceof Date||"function"==typeof e.toDateString&&"function"==typeof e.getDate&&"function"==typeof e.setDate}(e))return"date";if(function(e){return e instanceof Error||"string"==typeof e.message&&e.constructor&&"number"==typeof e.constructor.stackTraceLimit}(e))return"error";if(function(e){return e instanceof RegExp||"string"==typeof e.flags&&"boolean"==typeof e.ignoreCase&&"boolean"==typeof e.multiline&&"boolean"==typeof e.global}(e))return"regexp";switch(s(e)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(function(e){return"function"==typeof e.throw&&"function"==typeof e.return&&"function"==typeof e.next}(e))return"generator";switch(r=i.call(e)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return r.slice(8,-1).toLowerCase().replace(/\s/g,"")};function s(e){return e.constructor?e.constructor.name:null}const a="@@__STRUCT__@@",c="@@__KIND__@@";function l(e){return!(!e||!e[a])}function u(e,t){return"function"==typeof e?e(t):e}var d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};class h{constructor(e,t,r){this.name=e,this.type=t,this.validate=r}}function p(e,t,r){if(l(e))return e[c];if(e instanceof h)return e;switch(o(e)){case"array":return e.length>1?E(e,t,r):m(e,t,r);case"function":return g(e,t,r);case"object":return b(e,t,r);case"string":{let n,i=!0;if(e.endsWith("?")&&(i=!1,e=e.slice(0,-1)),e.includes("|")){n=w(e.split(/\s*\|\s*/g),t,r)}else if(e.includes("&")){n=_(e.split(/\s*&\s*/g),t,r)}else n=v(e,t,r);return i||(n=y(n,undefined,r)),n}}throw new Error(`Invalid schema: ${e}`)}function f(e,t,r){if("array"!==o(e))throw new Error(`Invalid schema: ${e}`);const n=e.map((e=>{try{return JSON.stringify(e)}catch(t){return String(e)}})).join(" | ");return new h("enum",n,((r=u(t))=>e.includes(r)?[undefined,r]:[{data:r,path:[],value:r,type:n}]))}function g(e,t,r){if("function"!==o(e))throw new Error(`Invalid schema: ${e}`);const n="<function>";return new h("function",n,((r=u(t),i)=>{const s=e(r,i);let a,c={path:[],reason:null};switch(o(s)){case"boolean":a=s;break;case"string":a=!1,c.reason=s;break;case"object":a=!1,c=d({},c,s);break;default:throw new Error(`Invalid result: ${s}`)}return a?[undefined,r]:[d({type:n,value:r,data:r},c)]}))}function m(e,t,r){if("array"!==o(e)||1!==e.length)throw new Error(`Invalid schema: ${e}`);const n=v("array",undefined,r),i=p(e[0],undefined,r),s=`[${i.type}]`;return new h("list",s,((e=u(t))=>{const[r,o]=n.validate(e);if(r)return r.type=s,[r];e=o;const a=[],c=[];for(let t=0;t<e.length;t++){const r=e[t],[n,o]=i.validate(r);if(n){(n.errors||[n]).forEach((r=>{r.path=[t].concat(r.path),r.data=e,a.push(r)}))}else c[t]=o}if(a.length){const e=a[0];return e.errors=a,[e]}return[undefined,c]}))}function b(e,t,r){if("object"!==o(e))throw new Error(`Invalid schema: ${e}`);const n=v("object",undefined,r),i=[],s={};for(const t in e){i.push(t);const n=p(e[t],undefined,r);s[t]=n}const a=`{${i.join()}}`;return new h("object",a,((e=u(t))=>{const[r]=n.validate(e);if(r)return r.type=a,[r];const i=[],o={},c=Object.keys(e),l=Object.keys(s);if(new Set(c.concat(l)).forEach((r=>{let n=e[r];const a=s[r];if(n===undefined){n=u(t&&t[r],e)}if(!a){const t={data:e,path:[r],value:n};return void i.push(t)}const[c,l]=a.validate(n,e);if(c){(c.errors||[c]).forEach((t=>{t.path=[r].concat(t.path),t.data=e,i.push(t)}))}else(r in e||l!==undefined)&&(o[r]=l)})),i.length){const e=i[0];return e.errors=i,[e]}return[undefined,o]}))}function y(e,t,r){return w([e,"undefined"],t,r)}function v(e,t,r){if("string"!==o(e))throw new Error(`Invalid schema: ${e}`);const{types:n}=r,i=n[e];if("function"!==o(i))throw new Error(`Invalid type: ${e}`);const s=g(i,t),a=e;return new h("scalar",a,(e=>{const[t,r]=s.validate(e);return t?(t.type=a,[t]):[undefined,r]}))}function E(e,t,r){if("array"!==o(e))throw new Error(`Invalid schema: ${e}`);const n=e.map((e=>p(e,undefined,r))),i=v("array",undefined,r),s=`[${n.map((e=>e.type)).join()}]`;return new h("tuple",s,((e=u(t))=>{const[r]=i.validate(e);if(r)return r.type=s,[r];const o=[],a=[],c=Math.max(e.length,n.length);for(let t=0;t<c;t++){const r=n[t],i=e[t];if(!r){const r={data:e,path:[t],value:i};a.push(r);continue}const[s,c]=r.validate(i);if(s){(s.errors||[s]).forEach((r=>{r.path=[t].concat(r.path),r.data=e,a.push(r)}))}else o[t]=c}if(a.length){const e=a[0];return e.errors=a,[e]}return[undefined,o]}))}function w(e,t,r){if("array"!==o(e))throw new Error(`Invalid schema: ${e}`);const n=e.map((e=>p(e,undefined,r))),i=n.map((e=>e.type)).join(" | ");return new h("union",i,((e=u(t))=>{const r=[];for(const t of n){const[n,i]=t.validate(e);if(!n)return[undefined,i];r.push(n)}return r[0].type=i,r}))}function _(e,t,r){if("array"!==o(e))throw new Error(`Invalid schema: ${e}`);const n=e.map((e=>p(e,undefined,r))),i=n.map((e=>e.type)).join(" & ");return new h("intersection",i,((e=u(t))=>{let r=e;for(const e of n){const[t,n]=e.validate(r);if(t)return t.type=i,[t];r=n}return[undefined,r]}))}const S={any:p,dict:function(e,t,r){if("array"!==o(e)||2!==e.length)throw new Error(`Invalid schema: ${e}`);const n=v("object",undefined,r),i=p(e[0],undefined,r),s=p(e[1],undefined,r),a=`dict<${i.type},${s.type}>`;return new h("dict",a,(e=>{const r=u(t);e=r?d({},r,e):e;const[o]=n.validate(e);if(o)return o.type=a,[o];const c={},l=[];for(let t in e){const r=e[t],[n,o]=i.validate(t);if(n){(n.errors||[n]).forEach((r=>{r.path=[t].concat(r.path),r.data=e,l.push(r)}));continue}t=o;const[a,u]=s.validate(r);if(a){(a.errors||[a]).forEach((r=>{r.path=[t].concat(r.path),r.data=e,l.push(r)}))}else c[t]=u}if(l.length){const e=l[0];return e.errors=l,[e]}return[undefined,c]}))},enum:f,enums:function(e,t,r){return m([f(e,undefined)],t,r)},function:g,instance:function(e,t,r){const n=`instance<${e.name}>`;return new h("instance",n,((r=u(t))=>r instanceof e?[undefined,r]:[{data:r,path:[],value:r,type:n}]))},interface:function(e,t,r){if("object"!==o(e))throw new Error(`Invalid schema: ${e}`);const n=[],i={};for(const t in e){n.push(t);const o=p(e[t],undefined,r);i[t]=o}const s=`{${n.join()}}`;return new h("interface",s,(e=>{const r=u(t);e=r?d({},r,e):e;const n=[],o=e;for(const r in i){let s=e[r];const a=i[r];if(s===undefined){s=u(t&&t[r],e)}const[c,l]=a.validate(s,e);if(c){(c.errors||[c]).forEach((t=>{t.path=[r].concat(t.path),t.data=e,n.push(t)}))}else(r in e||l!==undefined)&&(o[r]=l)}if(n.length){const e=n[0];return e.errors=n,[e]}return[undefined,o]}))},lazy:function(e,t,r){if("function"!==o(e))throw new Error(`Invalid schema: ${e}`);let n,i;return n=new h("lazy","lazy...",(t=>(i=e(),n.name=i.kind,n.type=i.type,n.validate=i.validate,n.validate(t)))),n},list:m,literal:function(e,t,r){const n=`literal: ${JSON.stringify(e)}`;return new h("literal",n,((r=u(t))=>r===e?[undefined,r]:[{data:r,path:[],value:r,type:n}]))},object:b,optional:y,partial:function(e,t,r){if("object"!==o(e))throw new Error(`Invalid schema: ${e}`);const n=v("object",undefined,r),i=[],s={};for(const t in e){i.push(t);const n=p(e[t],undefined,r);s[t]=n}const a=`{${i.join()},...}`;return new h("partial",a,((e=u(t))=>{const[r]=n.validate(e);if(r)return r.type=a,[r];const i=[],o={};for(const r in s){let n=e[r];const a=s[r];if(n===undefined){n=u(t&&t[r],e)}const[c,l]=a.validate(n,e);if(c){(c.errors||[c]).forEach((t=>{t.path=[r].concat(t.path),t.data=e,i.push(t)}))}else(r in e||l!==undefined)&&(o[r]=l)}if(i.length){const e=i[0];return e.errors=i,[e]}return[undefined,o]}))},scalar:v,tuple:E,union:w,intersection:_,dynamic:function(e,t,r){if("function"!==o(e))throw new Error(`Invalid schema: ${e}`);return new h("dynamic","dynamic...",((r=u(t),n)=>{const i=e(r,n);if("function"!==o(i))throw new Error(`Invalid schema: ${i}`);const[s,a]=i.validate(r);return s?[s]:[undefined,a]}))}},C={any:e=>e!==undefined};function k(e={}){const t=d({},C,e.types||{});function r(e,r,i={}){l(e)&&(e=e.schema);const o=S.any(e,r,d({},i,{types:t}));function s(e){if(this instanceof s)throw new Error("Invalid `new` keyword!");return s.assert(e)}return Object.defineProperty(s,a,{value:!0}),Object.defineProperty(s,c,{value:o}),s.kind=o.name,s.type=o.type,s.schema=e,s.defaults=r,s.options=i,s.assert=e=>{const[t,r]=o.validate(e);if(t)throw new n(t);return r},s.test=e=>{const[t]=o.validate(e);return!t},s.validate=e=>{const[t,r]=o.validate(e);return t?[new n(t)]:[undefined,r]},s}return Object.keys(S).forEach((e=>{const n=S[e];r[e]=(e,i,o)=>r(n(e,i,d({},o,{types:t})),i,o)})),r}["arguments","array","boolean","buffer","error","float32array","float64array","function","generatorfunction","int16array","int32array","int8array","map","null","number","object","promise","regexp","set","string","symbol","uint16array","uint32array","uint8array","uint8clampedarray","undefined","weakmap","weakset"].forEach((e=>{C[e]=t=>o(t)===e})),C.date=e=>"date"===o(e)&&!isNaN(e);const T=k();r.struct=T,r.superstruct=k,r.isStruct=l,r.StructError=n}}},{package:"3box>ipfs>superstruct"}],[5920,{},function(){with(this)return function(){"use strict";return function(e,t,r){const n=()=>!0,i=["newListener","removeListener"],o=e=>!i.includes(e);t.exports=function(e,t){let r=(t=t||{}).eventFilter||n;if("skipInternal"===r&&(r=o),"function"!=typeof r)throw new Error("createEventEmitterProxy - Invalid eventFilter");let i=e;return new Proxy({},{get:(e,t)=>"setTarget"===t?s:i[t],set:(e,t,r)=>"setTarget"===t?(s=r,!0):(i[t]=r,!0)});function s(e){const t=i;i=e,t.eventNames().filter(r).forEach((r=>{(function(e,t){if(e.rawListeners)return e.rawListeners(t);let r=e._events[t]||[];Array.isArray(r)||(r=[r]);return r.slice()})(t,r).forEach((t=>e.on(r,t)))})),t.removeAllListeners()}}}}},{package:"swappable-obj-proxy"}],[5921,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e){let t=e;return new Proxy({},{get:(e,n)=>"setTarget"===n?r:t[n],set:(e,n,i)=>"setTarget"===n?(r=i,!0):(t[n]=i,!0)});function r(e){t=e}}}}},{package:"swappable-obj-proxy"}],[5922,{"./createEventEmitterProxy":5920,"./createSwappableProxy":5921},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("./createSwappableProxy"),i=e("./createEventEmitterProxy");t.exports={createSwappableProxy:n,createEventEmitterProxy:i}}}},{package:"swappable-obj-proxy"}],[5923,{"./headers":5924,bl:5927,"readable-stream":5942,util:2138},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("util"),i=e("bl"),o=e("./headers"),s=e("readable-stream").Writable,a=e("readable-stream").PassThrough,c=function(){},l=function(e){return(e&=511)&&512-e},u=function(e,t){this._parent=e,this.offset=t,a.call(this,{autoDestroy:!1})};n.inherits(u,a),u.prototype.destroy=function(e){this._parent.destroy(e)};var d=function(e){if(!(this instanceof d))return new d(e);s.call(this,e),e=e||{},this._offset=0,this._buffer=i(),this._missing=0,this._partial=!1,this._onparse=c,this._header=null,this._stream=null,this._overflow=null,this._cb=null,this._locked=!1,this._destroyed=!1,this._pax=null,this._paxGlobal=null,this._gnuLongPath=null,this._gnuLongLinkPath=null;var t=this,r=t._buffer,n=function(){t._continue()},a=function(e){if(t._locked=!1,e)return t.destroy(e);t._stream||n()},h=function(){t._stream=null;var e=l(t._header.size);e?t._parse(e,p):t._parse(512,y),t._locked||n()},p=function(){t._buffer.consume(l(t._header.size)),t._parse(512,y),n()},f=function(){var e=t._header.size;t._paxGlobal=o.decodePax(r.slice(0,e)),r.consume(e),h()},g=function(){var e=t._header.size;t._pax=o.decodePax(r.slice(0,e)),t._paxGlobal&&(t._pax=Object.assign({},t._paxGlobal,t._pax)),r.consume(e),h()},m=function(){var n=t._header.size;this._gnuLongPath=o.decodeLongPath(r.slice(0,n),e.filenameEncoding),r.consume(n),h()},b=function(){var n=t._header.size;this._gnuLongLinkPath=o.decodeLongPath(r.slice(0,n),e.filenameEncoding),r.consume(n),h()},y=function(){var i,s=t._offset;try{i=t._header=o.decode(r.slice(0,512),e.filenameEncoding,e.allowUnknownFormat)}catch(e){t.emit("error",e)}return r.consume(512),i?"gnu-long-path"===i.type?(t._parse(i.size,m),void n()):"gnu-long-link-path"===i.type?(t._parse(i.size,b),void n()):"pax-global-header"===i.type?(t._parse(i.size,f),void n()):"pax-header"===i.type?(t._parse(i.size,g),void n()):(t._gnuLongPath&&(i.name=t._gnuLongPath,t._gnuLongPath=null),t._gnuLongLinkPath&&(i.linkname=t._gnuLongLinkPath,t._gnuLongLinkPath=null),t._pax&&(t._header=i=function(e,t){return t.path&&(e.name=t.path),t.linkpath&&(e.linkname=t.linkpath),t.size&&(e.size=parseInt(t.size,10)),e.pax=t,e}(i,t._pax),t._pax=null),t._locked=!0,i.size&&"directory"!==i.type?(t._stream=new u(t,s),t.emit("entry",i,t._stream,a),t._parse(i.size,h),void n()):(t._parse(512,y),void t.emit("entry",i,function(e,t){var r=new u(e,t);return r.end(),r}(t,s),a))):(t._parse(512,y),void n())};this._onheader=y,this._parse(512,y)};n.inherits(d,s),d.prototype.destroy=function(e){this._destroyed||(this._destroyed=!0,e&&this.emit("error",e),this.emit("close"),this._stream&&this._stream.emit("close"))},d.prototype._parse=function(e,t){this._destroyed||(this._offset+=e,this._missing=e,t===this._onheader&&(this._partial=!1),this._onparse=t)},d.prototype._continue=function(){if(!this._destroyed){var e=this._cb;this._cb=c,this._overflow?this._write(this._overflow,undefined,e):e()}},d.prototype._write=function(e,t,r){if(!this._destroyed){var n=this._stream,i=this._buffer,o=this._missing;if(e.length&&(this._partial=!0),e.length<o)return this._missing-=e.length,this._overflow=null,n?n.write(e,r):(i.append(e),r());this._cb=r,this._missing=0;var s=null;e.length>o&&(s=e.slice(o),e=e.slice(0,o)),n?n.end(e):i.append(e),this._overflow=s,this._onparse()}},d.prototype._final=function(e){if(this._partial)return this.destroy(new Error("Unexpected end of data"));e()},t.exports=d}}},{package:"@metamask/snap-controllers>tar-stream"}],[5924,{buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e){(function(){var t=e.alloc,n="0".charCodeAt(0),i=e.from("ustar\0","binary"),o=e.from("00","binary"),s=e.from("ustar ","binary"),a=e.from(" \0","binary"),c=parseInt("7777",8),l=257,u=function(e,t,r,n){for(;r<n;r++)if(e[r]===t)return r;return n},d=function(e){for(var t=256,r=0;r<148;r++)t+=e[r];for(var n=156;n<512;n++)t+=e[n];return t},h=function(e,t){return(e=e.toString(8)).length>t?"7777777777777777777".slice(0,t)+" ":"0000000000000000000".slice(0,t-e.length)+e+" "};var p=function(e,t,r){if(128&(e=e.slice(t,t+r))[t=0])return function(e){var t;if(128===e[0])t=!0;else{if(255!==e[0])return null;t=!1}for(var r=[],n=e.length-1;n>0;n--){var i=e[n];t?r.push(i):r.push(255-i)}var o=0,s=r.length;for(n=0;n<s;n++)o+=r[n]*Math.pow(256,n);return t?o:-1*o}(e);for(;t<e.length&&32===e[t];)t++;for(var n=(i=u(e,32,t,e.length),o=e.length,s=e.length,"number"!=typeof i?s:(i=~~i)>=o?o:i>=0||(i+=o)>=0?i:0);t<n&&0===e[t];)t++;return n===t?0:parseInt(e.slice(t,n).toString(),8);var i,o,s},f=function(e,t,r,n){return e.slice(t,u(e,0,t,t+r)).toString(n)},g=function(t){var r=e.byteLength(t),n=Math.floor(Math.log(r)/Math.log(10))+1;return r+n>=Math.pow(10,n)&&n++,r+n+t};r.decodeLongPath=function(e,t){return f(e,0,e.length,t)},r.encodePax=function(t){var r="";t.name&&(r+=g(" path="+t.name+"\n")),t.linkname&&(r+=g(" linkpath="+t.linkname+"\n"));var n=t.pax;if(n)for(var i in n)r+=g(" "+i+"="+n[i]+"\n");return e.from(r)},r.decodePax=function(e){for(var t={};e.length;){for(var r=0;r<e.length&&32!==e[r];)r++;var n=parseInt(e.slice(0,r).toString(),10);if(!n)return t;var i=e.slice(r+1,n-1).toString(),o=i.indexOf("=");if(-1===o)return t;t[i.slice(0,o)]=i.slice(o+1),e=e.slice(n)}return t},r.encode=function(r){var s=t(512),a=r.name,u="";if(5===r.typeflag&&"/"!==a[a.length-1]&&(a+="/"),e.byteLength(a)!==a.length)return null;for(;e.byteLength(a)>100;){var p=a.indexOf("/");if(-1===p)return null;u+=u?"/"+a.slice(0,p):a.slice(0,p),a=a.slice(p+1)}return e.byteLength(a)>100||e.byteLength(u)>155||r.linkname&&e.byteLength(r.linkname)>100?null:(s.write(a),s.write(h(r.mode&c,6),100),s.write(h(r.uid,6),108),s.write(h(r.gid,6),116),s.write(h(r.size,11),124),s.write(h(r.mtime.getTime()/1e3|0,11),136),s[156]=n+function(e){switch(e){case"file":return 0;case"link":return 1;case"symlink":return 2;case"character-device":return 3;case"block-device":return 4;case"directory":return 5;case"fifo":return 6;case"contiguous-file":return 7;case"pax-header":return 72}return 0}(r.type),r.linkname&&s.write(r.linkname,157),i.copy(s,l),o.copy(s,263),r.uname&&s.write(r.uname,265),r.gname&&s.write(r.gname,297),s.write(h(r.devmajor||0,6),329),s.write(h(r.devminor||0,6),337),u&&s.write(u,345),s.write(h(d(s),6),148),s)},r.decode=function(e,t,r){var o=0===e[156]?0:e[156]-n,c=f(e,0,100,t),u=p(e,100,8),h=p(e,108,8),g=p(e,116,8),m=p(e,124,12),b=p(e,136,12),y=function(e){switch(e){case 0:return"file";case 1:return"link";case 2:return"symlink";case 3:return"character-device";case 4:return"block-device";case 5:return"directory";case 6:return"fifo";case 7:return"contiguous-file";case 72:return"pax-header";case 55:return"pax-global-header";case 27:return"gnu-long-link-path";case 28:case 30:return"gnu-long-path"}return null}(o),v=0===e[157]?null:f(e,157,100,t),E=f(e,265,32),w=f(e,297,32),_=p(e,329,8),S=p(e,337,8),C=d(e);if(256===C)return null;if(C!==p(e,148,8))throw new Error("Invalid tar header. Maybe the tar is corrupted or it needs to be gunzipped?");if(0===i.compare(e,l,263))e[345]&&(c=f(e,345,155,t)+"/"+c);else if(0===s.compare(e,l,263)&&0===a.compare(e,263,265));else if(!r)throw new Error("Invalid tar header: unknown format.");return 0===o&&c&&"/"===c[c.length-1]&&(o=5),{name:c,mode:u,uid:h,gid:g,size:m,mtime:new Date(1e3*b),type:y,linkname:v,uname:E,gname:w,devmajor:_,devminor:S}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/snap-controllers>tar-stream"}],[5925,{"./extract":5923,"./pack":5943},function(){with(this)return function(){"use strict";return function(e,t,r){r.extract=e("./extract"),r.pack=e("./pack")}}},{package:"@metamask/snap-controllers>tar-stream"}],[5926,{buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){const{Buffer:n}=e("buffer"),i=Symbol.for("BufferList");function o(e){if(!(this instanceof o))return new o(e);o._init.call(this,e)}o._init=function(e){Object.defineProperty(this,i,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)},o.prototype._new=function(e){return new o(e)},o.prototype._offset=function(e){if(0===e)return[0,0];let t=0;for(let r=0;r<this._bufs.length;r++){const n=t+this._bufs[r].length;if(e<n||r===this._bufs.length-1)return[r,e-t];t=n}},o.prototype._reverseOffset=function(e){const t=e[0];let r=e[1];for(let e=0;e<t;e++)r+=this._bufs[e].length;return r},o.prototype.get=function(e){if(e>this.length||e<0)return undefined;const t=this._offset(e);return this._bufs[t[0]][t[1]]},o.prototype.slice=function(e,t){return"number"==typeof e&&e<0&&(e+=this.length),"number"==typeof t&&t<0&&(t+=this.length),this.copy(null,0,e,t)},o.prototype.copy=function(e,t,r,i){if(("number"!=typeof r||r<0)&&(r=0),("number"!=typeof i||i>this.length)&&(i=this.length),r>=this.length)return e||n.alloc(0);if(i<=0)return e||n.alloc(0);const o=!!e,s=this._offset(r),a=i-r;let c=a,l=o&&t||0,u=s[1];if(0===r&&i===this.length){if(!o)return 1===this._bufs.length?this._bufs[0]:n.concat(this._bufs,this.length);for(let t=0;t<this._bufs.length;t++)this._bufs[t].copy(e,l),l+=this._bufs[t].length;return e}if(c<=this._bufs[s[0]].length-u)return o?this._bufs[s[0]].copy(e,t,u,u+c):this._bufs[s[0]].slice(u,u+c);o||(e=n.allocUnsafe(a));for(let t=s[0];t<this._bufs.length;t++){const r=this._bufs[t].length-u;if(!(c>r)){this._bufs[t].copy(e,l,u,u+c),l+=r;break}this._bufs[t].copy(e,l,u),l+=r,c-=r,u&&(u=0)}return e.length>l?e.slice(0,l):e},o.prototype.shallowSlice=function(e,t){if(e=e||0,t="number"!=typeof t?this.length:t,e<0&&(e+=this.length),t<0&&(t+=this.length),e===t)return this._new();const r=this._offset(e),n=this._offset(t),i=this._bufs.slice(r[0],n[0]+1);return 0===n[1]?i.pop():i[i.length-1]=i[i.length-1].slice(0,n[1]),0!==r[1]&&(i[0]=i[0].slice(r[1])),this._new(i)},o.prototype.toString=function(e,t,r){return this.slice(t,r).toString(e)},o.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;){if(!(e>=this._bufs[0].length)){this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift()}return this},o.prototype.duplicate=function(){const e=this._new();for(let t=0;t<this._bufs.length;t++)e.append(this._bufs[t]);return e},o.prototype.append=function(e){if(null==e)return this;if(e.buffer)this._appendBuffer(n.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let t=0;t<e.length;t++)this.append(e[t]);else if(this._isBufferList(e))for(let t=0;t<e._bufs.length;t++)this.append(e._bufs[t]);else"number"==typeof e&&(e=e.toString()),this._appendBuffer(n.from(e));return this},o.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length},o.prototype.indexOf=function(e,t,r){if(r===undefined&&"string"==typeof t&&(r=t,t=undefined),"function"==typeof e||Array.isArray(e))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if("number"==typeof e?e=n.from([e]):"string"==typeof e?e=n.from(e,r):this._isBufferList(e)?e=e.slice():Array.isArray(e.buffer)?e=n.from(e.buffer,e.byteOffset,e.byteLength):n.isBuffer(e)||(e=n.from(e)),t=Number(t||0),isNaN(t)&&(t=0),t<0&&(t=this.length+t),t<0&&(t=0),0===e.length)return t>this.length?this.length:t;const i=this._offset(t);let o=i[0],s=i[1];for(;o<this._bufs.length;o++){const t=this._bufs[o];for(;s<t.length;){if(t.length-s>=e.length){const r=t.indexOf(e,s);if(-1!==r)return this._reverseOffset([o,r]);s=t.length-e.length+1}else{const t=this._reverseOffset([o,s]);if(this._match(t,e))return t;s++}}s=0}return-1},o.prototype._match=function(e,t){if(this.length-e<t.length)return!1;for(let r=0;r<t.length;r++)if(this.get(e+r)!==t[r])return!1;return!0},function(){const e={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(const t in e)!function(t){o.prototype[t]=null===e[t]?function(e,r){return this.slice(e,e+r)[t](0,r)}:function(r=0){return this.slice(r,r+e[t])[t](0)}}(t)}(),o.prototype._isBufferList=function(e){return e instanceof o||o.isBufferList(e)},o.isBufferList=function(e){return null!=e&&e[i]},t.exports=o}}},{package:"@metamask/snap-controllers>tar-stream>bl"}],[5927,{"./BufferList":5926,inherits:4453,"readable-stream":5942},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("readable-stream").Duplex,i=e("inherits"),o=e("./BufferList");function s(e){if(!(this instanceof s))return new s(e);if("function"==typeof e){this._callback=e;const t=function(e){this._callback&&(this._callback(e),this._callback=null)}.bind(this);this.on("pipe",(function(e){e.on("error",t)})),this.on("unpipe",(function(e){e.removeListener("error",t)})),e=null}o._init.call(this,e),n.call(this)}i(s,n),Object.assign(s.prototype,o.prototype),s.prototype._new=function(e){return new s(e)},s.prototype._write=function(e,t,r){this._appendBuffer(e),"function"==typeof r&&r()},s.prototype._read=function(e){if(!this.length)return this.push(null);e=Math.min(e,this.length),this.push(this.slice(0,e)),this.consume(e)},s.prototype.end=function(e){n.prototype.end.call(this,e),this._callback&&(this._callback(null,this.slice()),this._callback=null)},s.prototype._destroy=function(e,t){this._bufs.length=0,this.length=0,t(e)},s.prototype._isBufferList=function(e){return e instanceof s||e instanceof o||s.isBufferList(e)},s.isBufferList=o.isBufferList,t.exports=s,t.exports.BufferListStream=s,t.exports.BufferList=o}}},{package:"@metamask/snap-controllers>tar-stream>bl"}],[5928,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n={};function i(e,t,r){r||(r=Error);var i=function(e){var r,n;function i(r,n,i){return e.call(this,function(e,r,n){return"string"==typeof t?t:t(e,r,n)}(r,n,i))||this}return n=e,(r=i).prototype=Object.create(n.prototype),r.prototype.constructor=r,r.__proto__=n,i}(r);i.prototype.name=r.name,i.prototype.code=e,n[e]=i}function o(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map((function(e){return String(e)})),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}i("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),i("ERR_INVALID_ARG_TYPE",(function(e,t,r){var n,i,s,a;if("string"==typeof t&&(i="not ",t.substr(!s||s<0?0:+s,i.length)===i)?(n="must not be",t=t.replace(/^not /,"")):n="must be",function(e,t,r){return(r===undefined||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}(e," argument"))a="The ".concat(e," ").concat(n," ").concat(o(t,"type"));else{var c=function(e,t,r){return"number"!=typeof r&&(r=0),!(r+t.length>e.length)&&-1!==e.indexOf(t,r)}(e,".")?"property":"argument";a='The "'.concat(e,'" ').concat(c," ").concat(n," ").concat(o(t,"type"))}return a+=". Received type ".concat(typeof r)}),TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.codes=n}}},{package:"@metamask/snap-controllers>tar-stream>readable-stream"}],[5929,{"./_stream_readable":5931,"./_stream_writable":5933,_process:5430,inherits:4453},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};t.exports=l;var i=e("./_stream_readable"),o=e("./_stream_writable");e("inherits")(l,i);for(var s=n(o.prototype),a=0;a<s.length;a++){var c=s[a];l.prototype[c]||(l.prototype[c]=o.prototype[c])}function l(e){if(!(this instanceof l))return new l(e);i.call(this,e),o.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",u)))}function u(){this._writableState.ended||r.nextTick(d,this)}function d(e){e.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==undefined&&this._writableState!==undefined&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){this._readableState!==undefined&&this._writableState!==undefined&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/snap-controllers>tar-stream>readable-stream"}],[5930,{"./_stream_transform":5932,inherits:4453},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=i;var n=e("./_stream_transform");function i(e){if(!(this instanceof i))return new i(e);n.call(this,e)}e("inherits")(i,n),i.prototype._transform=function(e,t,r){r(null,e)}}}},{package:"@metamask/snap-controllers>tar-stream>readable-stream"}],[5931,{"../errors":5928,"./_stream_duplex":5929,"./internal/streams/async_iterator":5934,"./internal/streams/buffer_list":5935,"./internal/streams/destroy":5936,"./internal/streams/from":5938,"./internal/streams/state":5940,"./internal/streams/stream":5941,_process:5430,buffer:2132,events:2133,inherits:4453,"string_decoder/":5916,util:2131},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n;t.exports=C,C.ReadableState=S;e("events").EventEmitter;var i=function(e,t){return e.listeners(t).length},o=e("./internal/streams/stream"),s=e("buffer").Buffer,a=global.Uint8Array||function(){};var c,l=e("util");c=l&&l.debuglog?l.debuglog("stream"):function(){};var u,d,h,p=e("./internal/streams/buffer_list"),f=e("./internal/streams/destroy"),g=e("./internal/streams/state").getHighWaterMark,m=e("../errors").codes,b=m.ERR_INVALID_ARG_TYPE,y=m.ERR_STREAM_PUSH_AFTER_EOF,v=m.ERR_METHOD_NOT_IMPLEMENTED,E=m.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;e("inherits")(C,o);var w=f.errorOrDestroy,_=["error","close","destroy","pause","resume"];function S(t,r,i){n=n||e("./_stream_duplex"),t=t||{},"boolean"!=typeof i&&(i=r instanceof n),this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=g(this,t,"readableHighWaterMark",i),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(u||(u=e("string_decoder/").StringDecoder),this.decoder=new u(t.encoding),this.encoding=t.encoding)}function C(t){if(n=n||e("./_stream_duplex"),!(this instanceof C))return new C(t);var r=this instanceof n;this._readableState=new S(t,this,r),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),o.call(this)}function k(e,t,r,n,i){c("readableAddChunk",t);var o,l=e._readableState;if(null===t)l.reading=!1,function(e,t){if(c("onEofChunk"),t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?P(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,R(e)))}(e,l);else if(i||(o=function(e,t){var r;n=t,s.isBuffer(n)||n instanceof a||"string"==typeof t||t===undefined||e.objectMode||(r=new b("chunk",["string","Buffer","Uint8Array"],t));var n;return r}(l,t)),o)w(e,o);else if(l.objectMode||t&&t.length>0)if("string"==typeof t||l.objectMode||Object.getPrototypeOf(t)===s.prototype||(t=function(e){return s.from(e)}(t)),n)l.endEmitted?w(e,new E):T(e,l,t,!0);else if(l.ended)w(e,new y);else{if(l.destroyed)return!1;l.reading=!1,l.decoder&&!r?(t=l.decoder.write(t),l.objectMode||0!==t.length?T(e,l,t,!1):A(e,l)):T(e,l,t,!1)}else n||(l.reading=!1,A(e,l));return!l.ended&&(l.length<l.highWaterMark||0===l.length)}function T(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&P(e)),A(e,t)}Object.defineProperty(C.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==undefined&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),C.prototype.destroy=f.destroy,C.prototype._undestroy=f.undestroy,C.prototype._destroy=function(e,t){t(e)},C.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=s.from(e,t),t=""),r=!0),k(this,e,t,!1,r)},C.prototype.unshift=function(e){return k(this,e,null,!0,!1)},C.prototype.isPaused=function(){return!1===this._readableState.flowing},C.prototype.setEncoding=function(t){u||(u=e("string_decoder/").StringDecoder);var r=new u(t);this._readableState.decoder=r,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,i="";null!==n;)i+=r.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var M=1073741824;function O(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=M?e=M:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function P(e){var t=e._readableState;c("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(c("emitReadable",t.flowing),t.emittedReadable=!0,r.nextTick(R,e))}function R(e){var t=e._readableState;c("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,U(e)}function A(e,t){t.readingMore||(t.readingMore=!0,r.nextTick(I,e,t))}function I(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(c("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function N(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function D(e){c("readable nexttick read 0"),e.read(0)}function x(e,t){c("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),U(e),t.flowing&&!t.reading&&e.read(0)}function U(e){var t=e._readableState;for(c("flow",t.flowing);t.flowing&&null!==e.read(););}function L(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function j(e){var t=e._readableState;c("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,r.nextTick(B,t,e))}function B(e,t){if(c("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}function F(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}C.prototype.read=function(e){c("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return c("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?j(this):P(this),null;if(0===(e=O(e,t))&&t.ended)return 0===t.length&&j(this),null;var n,i=t.needReadable;return c("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&c("length less than watermark",i=!0),t.ended||t.reading?c("reading or ended",i=!1):i&&(c("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=O(r,t))),null===(n=e>0?L(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&j(this)),null!==n&&this.emit("data",n),n},C.prototype._read=function(e){w(this,new v("_read()"))},C.prototype.pipe=function(e,t){var n=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=e;break;case 1:o.pipes=[o.pipes,e];break;default:o.pipes.push(e)}o.pipesCount+=1,c("pipe count=%d opts=%j",o.pipesCount,t);var s=(!t||!1!==t.end)&&e!==r.stdout&&e!==r.stderr?l:m;function a(t,r){c("onunpipe"),t===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,c("cleanup"),e.removeListener("close",f),e.removeListener("finish",g),e.removeListener("drain",u),e.removeListener("error",p),e.removeListener("unpipe",a),n.removeListener("end",l),n.removeListener("end",m),n.removeListener("data",h),d=!0,!o.awaitDrain||e._writableState&&!e._writableState.needDrain||u())}function l(){c("onend"),e.end()}o.endEmitted?r.nextTick(s):n.once("end",s),e.on("unpipe",a);var u=function(e){return function(){var t=e._readableState;c("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&i(e,"data")&&(t.flowing=!0,U(e))}}(n);e.on("drain",u);var d=!1;function h(t){c("ondata");var r=e.write(t);c("dest.write",r),!1===r&&((1===o.pipesCount&&o.pipes===e||o.pipesCount>1&&-1!==F(o.pipes,e))&&!d&&(c("false write response, pause",o.awaitDrain),o.awaitDrain++),n.pause())}function p(t){c("onerror",t),m(),e.removeListener("error",p),0===i(e,"error")&&w(e,t)}function f(){e.removeListener("finish",g),m()}function g(){c("onfinish"),e.removeListener("close",f),m()}function m(){c("unpipe"),n.unpipe(e)}return n.on("data",h),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",p),e.once("close",f),e.once("finish",g),e.emit("pipe",n),o.flowing||(c("pipe resume"),n.resume()),e},C.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)n[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=F(t.pipes,e);return-1===s||(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},C.prototype.on=function(e,t){var n=o.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===e&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,c("on readable",i.length,i.reading),i.length?P(this):i.reading||r.nextTick(D,this))),n},C.prototype.addListener=C.prototype.on,C.prototype.removeListener=function(e,t){var n=o.prototype.removeListener.call(this,e,t);return"readable"===e&&r.nextTick(N,this),n},C.prototype.removeAllListeners=function(e){var t=o.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&e!==undefined||r.nextTick(N,this),t},C.prototype.resume=function(){var e=this._readableState;return e.flowing||(c("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,r.nextTick(x,e,t))}(this,e)),e.paused=!1,this},C.prototype.pause=function(){return c("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(c("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},C.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",(function(){if(c("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(c("wrapped data"),r.decoder&&(i=r.decoder.write(i)),!r.objectMode||null!==i&&i!==undefined)&&((r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause())))})),e)this[i]===undefined&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<_.length;o++)e.on(_[o],this.emit.bind(this,_[o]));return this._read=function(t){c("wrapped _read",t),n&&(n=!1,e.resume())},this},"function"==typeof Symbol&&(C.prototype[Symbol.asyncIterator]=function(){return d===undefined&&(d=e("./internal/streams/async_iterator")),d(this)}),Object.defineProperty(C.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(C.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(C.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),C._fromList=L,Object.defineProperty(C.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(C.from=function(t,r){return h===undefined&&(h=e("./internal/streams/from")),h(C,t,r)})}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/snap-controllers>tar-stream>readable-stream"}],[5932,{"../errors":5928,"./_stream_duplex":5929,inherits:4453},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=u;var n=e("../errors").codes,i=n.ERR_METHOD_NOT_IMPLEMENTED,o=n.ERR_MULTIPLE_CALLBACK,s=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=n.ERR_TRANSFORM_WITH_LENGTH_0,c=e("./_stream_duplex");function l(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(null===n)return this.emit("error",new o);r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function u(e){if(!(this instanceof u))return new u(e);c.call(this,e),this._transformState={afterTransform:l.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",d)}function d(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?h(this,null,null):this._flush((function(t,r){h(e,t,r)}))}function h(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new a;if(e._transformState.transforming)throw new s;return e.push(null)}e("inherits")(u,c),u.prototype.push=function(e,t){return this._transformState.needTransform=!1,c.prototype.push.call(this,e,t)},u.prototype._transform=function(e,t,r){r(new i("_transform()"))},u.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},u.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},u.prototype._destroy=function(e,t){c.prototype._destroy.call(this,e,(function(e){t(e)}))}}}},{package:"@metamask/snap-controllers>tar-stream>readable-stream"}],[5933,{"../errors":5928,"./_stream_duplex":5929,"./internal/streams/destroy":5936,"./internal/streams/state":5940,"./internal/streams/stream":5941,_process:5430,buffer:2132,inherits:4453,"util-deprecate":6019},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){function n(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;e.entry=null;for(;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree.next=e}(t,e)}}var i;t.exports=C,C.WritableState=S;var o={deprecate:e("util-deprecate")},s=e("./internal/streams/stream"),a=e("buffer").Buffer,c=global.Uint8Array||function(){};var l,u=e("./internal/streams/destroy"),d=e("./internal/streams/state").getHighWaterMark,h=e("../errors").codes,p=h.ERR_INVALID_ARG_TYPE,f=h.ERR_METHOD_NOT_IMPLEMENTED,g=h.ERR_MULTIPLE_CALLBACK,m=h.ERR_STREAM_CANNOT_PIPE,b=h.ERR_STREAM_DESTROYED,y=h.ERR_STREAM_NULL_VALUES,v=h.ERR_STREAM_WRITE_AFTER_END,E=h.ERR_UNKNOWN_ENCODING,w=u.errorOrDestroy;function _(){}function S(t,o,s){i=i||e("./_stream_duplex"),t=t||{},"boolean"!=typeof s&&(s=o instanceof i),this.objectMode=!!t.objectMode,s&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=d(this,t,"writableHighWaterMark",s),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=!1===t.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,i=n.sync,o=n.writecb;if("function"!=typeof o)throw new g;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,i,o){--t.pendingcb,n?(r.nextTick(o,i),r.nextTick(R,e,t),e._writableState.errorEmitted=!0,w(e,i)):(o(i),e._writableState.errorEmitted=!0,w(e,i),R(e,t))}(e,n,i,t,o);else{var s=O(n)||e.destroyed;s||n.corked||n.bufferProcessing||!n.bufferedRequest||M(e,n),i?r.nextTick(T,e,n,s,o):T(e,n,s,o)}}(o,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new n(this)}function C(t){var r=this instanceof(i=i||e("./_stream_duplex"));if(!r&&!l.call(C,this))return new C(t);this._writableState=new S(t,this,r),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),s.call(this)}function k(e,t,r,n,i,o,s){t.writelen=n,t.writecb=s,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new b("write")):r?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function T(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),R(e,t)}function M(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var i=t.bufferedRequestCount,o=new Array(i),s=t.corkedRequestsFree;s.entry=r;for(var a=0,c=!0;r;)o[a]=r,r.isBuf||(c=!1),r=r.next,a+=1;o.allBuffers=c,k(e,t,!0,t.length,o,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new n(t),t.bufferedRequestCount=0}else{for(;r;){var l=r.chunk,u=r.encoding,d=r.callback;if(k(e,t,!1,t.objectMode?1:l.length,l,u,d),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function O(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function P(e,t){e._final((function(r){t.pendingcb--,r&&w(e,r),t.prefinished=!0,e.emit("prefinish"),R(e,t)}))}function R(e,t){var n=O(t);if(n&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,r.nextTick(P,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var i=e._readableState;(!i||i.autoDestroy&&i.endEmitted)&&e.destroy()}return n}e("inherits")(C,s),S.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(S.prototype,"buffer",{get:o.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer "+"instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(l=Function.prototype[Symbol.hasInstance],Object.defineProperty(C,Symbol.hasInstance,{value:function(e){return!!l.call(this,e)||this===C&&(e&&e._writableState instanceof S)}})):l=function(e){return e instanceof this},C.prototype.pipe=function(){w(this,new m)},C.prototype.write=function(e,t,n){var i,o=this._writableState,s=!1,l=!o.objectMode&&(i=e,a.isBuffer(i)||i instanceof c);return l&&!a.isBuffer(e)&&(e=function(e){return a.from(e)}(e)),"function"==typeof t&&(n=t,t=null),l?t="buffer":t||(t=o.defaultEncoding),"function"!=typeof n&&(n=_),o.ending?function(e,t){var n=new v;w(e,n),r.nextTick(t,n)}(this,n):(l||function(e,t,n,i){var o;return null===n?o=new y:"string"==typeof n||t.objectMode||(o=new p("chunk",["string","Buffer"],n)),!o||(w(e,o),r.nextTick(i,o),!1)}(this,o,e,n))&&(o.pendingcb++,s=function(e,t,r,n,i,o){if(!r){var s=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=a.from(t,r));return t}(t,n,i);n!==s&&(r=!0,i="buffer",n=s)}var c=t.objectMode?1:n.length;t.length+=c;var l=t.length<t.highWaterMark;l||(t.needDrain=!0);if(t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:o,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else k(e,t,!1,c,n,i,o);return l}(this,o,l,e,t,n)),s},C.prototype.cork=function(){this._writableState.corked++},C.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||M(this,e))},C.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new E(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(C.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(C.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),C.prototype._write=function(e,t,r){r(new f("_write()"))},C.prototype._writev=null,C.prototype.end=function(e,t,n){var i=this._writableState;return"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!==e&&e!==undefined&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||function(e,t,n){t.ending=!0,R(e,t),n&&(t.finished?r.nextTick(n):e.once("finish",n));t.ended=!0,e.writable=!1}(this,i,n),this},Object.defineProperty(C.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(C.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==undefined&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),C.prototype.destroy=u.destroy,C.prototype._undestroy=u.undestroy,C.prototype._destroy=function(e,t){t(e)}}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/snap-controllers>tar-stream>readable-stream"}],[5934,{"./end-of-stream":5937,_process:5430},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n;function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o=e("./end-of-stream"),s=Symbol("lastResolve"),a=Symbol("lastReject"),c=Symbol("error"),l=Symbol("ended"),u=Symbol("lastPromise"),d=Symbol("handlePromise"),h=Symbol("stream");function p(e,t){return{value:e,done:t}}function f(e){var t=e[s];if(null!==t){var r=e[h].read();null!==r&&(e[u]=null,e[s]=null,e[a]=null,t(p(r,!1)))}}function g(e){r.nextTick(f,e)}var m=Object.getPrototypeOf((function(){})),b=Object.setPrototypeOf((i(n={get stream(){return this[h]},next:function(){var e=this,t=this[c];if(null!==t)return Promise.reject(t);if(this[l])return Promise.resolve(p(undefined,!0));if(this[h].destroyed)return new Promise((function(t,n){r.nextTick((function(){e[c]?n(e[c]):t(p(undefined,!0))}))}));var n,i=this[u];if(i)n=new Promise(function(e,t){return function(r,n){e.then((function(){t[l]?r(p(undefined,!0)):t[d](r,n)}),n)}}(i,this));else{var o=this[h].read();if(null!==o)return Promise.resolve(p(o,!1));n=new Promise(this[d])}return this[u]=n,n}},Symbol.asyncIterator,(function(){return this})),i(n,"return",(function(){var e=this;return new Promise((function(t,r){e[h].destroy(null,(function(e){e?r(e):t(p(undefined,!0))}))}))})),n),m);t.exports=function(e){var t,r=Object.create(b,(i(t={},h,{value:e,writable:!0}),i(t,s,{value:null,writable:!0}),i(t,a,{value:null,writable:!0}),i(t,c,{value:null,writable:!0}),i(t,l,{value:e._readableState.endEmitted,writable:!0}),i(t,d,{value:function(e,t){var n=r[h].read();n?(r[u]=null,r[s]=null,r[a]=null,e(p(n,!1))):(r[s]=e,r[a]=t)},writable:!0}),t));return r[u]=null,o(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=r[a];return null!==t&&(r[u]=null,r[s]=null,r[a]=null,t(e)),void(r[c]=e)}var n=r[s];null!==n&&(r[u]=null,r[s]=null,r[a]=null,n(p(undefined,!0))),r[l]=!0})),e.on("readable",g.bind(null,r)),r}}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/snap-controllers>tar-stream>readable-stream"}],[5935,{buffer:2132,util:2131},function(){with(this)return function(){"use strict";return function(e,t,r){function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=e("buffer").Buffer,a=e("util").inspect,c=a&&a.custom||"inspect";t.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,r,l;return t=e,r=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return s.alloc(0);for(var t,r,n,i=s.allocUnsafe(e>>>0),o=this.head,a=0;o;)t=o.data,r=i,n=a,s.prototype.copy.call(t,r,n),a+=o.data.length,o=o.next;return i}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,n=t.data;for(e-=n.length;t=t.next;){var i=t.data,o=e>i.length?i.length:e;if(o===i.length?n+=i:n+=i.slice(0,e),0==(e-=o)){o===i.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(o));break}++r}return this.length-=r,n}},{key:"_getBuffer",value:function(e){var t=s.allocUnsafe(e),r=this.head,n=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var i=r.data,o=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,o),0==(e-=o)){o===i.length?(++n,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=i.slice(o));break}++n}return this.length-=n,t}},{key:c,value:function(e,t){return a(this,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}],r&&o(t.prototype,r),l&&o(t,l),e}()}}},{package:"@metamask/snap-controllers>tar-stream>readable-stream"}],[5936,{_process:5430},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e){(function(){function r(e,t){i(e,t),n(e)}function n(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function i(e,t){e.emit("error",t)}t.exports={destroy:function(t,o){var s=this,a=this._readableState&&this._readableState.destroyed,c=this._writableState&&this._writableState.destroyed;return a||c?(o?o(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,e.nextTick(i,this,t)):e.nextTick(i,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!o&&t?s._writableState?s._writableState.errorEmitted?e.nextTick(n,s):(s._writableState.errorEmitted=!0,e.nextTick(r,s,t)):e.nextTick(r,s,t):o?(e.nextTick(n,s),o(t)):e.nextTick(n,s)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var r=e._readableState,n=e._writableState;r&&r.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/snap-controllers>tar-stream>readable-stream"}],[5937,{"../../../errors":5928},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function i(){}t.exports=function e(t,r,o){if("function"==typeof r)return e(t,null,r);r||(r={}),o=function(e){var t=!1;return function(){if(!t){t=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];e.apply(this,n)}}}(o||i);var s=r.readable||!1!==r.readable&&t.readable,a=r.writable||!1!==r.writable&&t.writable,c=function(){t.writable||u()},l=t._writableState&&t._writableState.finished,u=function(){a=!1,l=!0,s||o.call(t)},d=t._readableState&&t._readableState.endEmitted,h=function(){s=!1,d=!0,a||o.call(t)},p=function(e){o.call(t,e)},f=function(){var e;return s&&!d?(t._readableState&&t._readableState.ended||(e=new n),o.call(t,e)):a&&!l?(t._writableState&&t._writableState.ended||(e=new n),o.call(t,e)):void 0},g=function(){t.req.on("finish",u)};return!function(e){return e.setHeader&&"function"==typeof e.abort}(t)?a&&!t._writableState&&(t.on("end",c),t.on("close",c)):(t.on("complete",u),t.on("abort",f),t.req?g():t.on("request",g)),t.on("end",h),t.on("finish",u),!1!==r.error&&t.on("error",p),t.on("close",f),function(){t.removeListener("complete",u),t.removeListener("abort",f),t.removeListener("request",g),t.req&&t.req.removeListener("finish",u),t.removeListener("end",c),t.removeListener("close",c),t.removeListener("finish",u),t.removeListener("end",h),t.removeListener("error",p),t.removeListener("close",f)}}}}},{package:"@metamask/snap-controllers>tar-stream>readable-stream"}],[5938,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(){throw new Error("Readable.from is not available in the browser")}}}},{package:"@metamask/snap-controllers>tar-stream>readable-stream"}],[5939,{"../../../errors":5928,"./end-of-stream":5937},function(){with(this)return function(){"use strict";return function(e,t,r){var n;var i=e("../../../errors").codes,o=i.ERR_MISSING_ARGS,s=i.ERR_STREAM_DESTROYED;function a(e){if(e)throw e}function c(t,r,i,o){o=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(o);var a=!1;t.on("close",(function(){a=!0})),n===undefined&&(n=e("./end-of-stream")),n(t,{readable:r,writable:i},(function(e){if(e)return o(e);a=!0,o()}));var c=!1;return function(e){if(!a&&!c)return c=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(t)?t.abort():"function"==typeof t.destroy?t.destroy():void o(e||new s("pipe"))}}function l(e){e()}function u(e,t){return e.pipe(t)}function d(e){return e.length?"function"!=typeof e[e.length-1]?a:e.pop():a}t.exports=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,i=d(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new o("streams");var s=t.map((function(e,r){var o=r<t.length-1;return c(e,o,r>0,(function(e){n||(n=e),e&&s.forEach(l),o||(s.forEach(l),i(n))}))}));return t.reduce(u)}}}},{package:"@metamask/snap-controllers>tar-stream>readable-stream"}],[5940,{"../../../errors":5928},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;t.exports={getHighWaterMark:function(e,t,r,i){var o=function(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}(t,i,r);if(null!=o){if(!isFinite(o)||Math.floor(o)!==o||o<0)throw new n(i?r:"highWaterMark",o);return Math.floor(o)}return e.objectMode?16:16384}}}}},{package:"@metamask/snap-controllers>tar-stream>readable-stream"}],[5941,{events:2133},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e("events").EventEmitter}}},{package:"@metamask/snap-controllers>tar-stream>readable-stream"}],[5942,{"./lib/_stream_duplex.js":5929,"./lib/_stream_passthrough.js":5930,"./lib/_stream_readable.js":5931,"./lib/_stream_transform.js":5932,"./lib/_stream_writable.js":5933,"./lib/internal/streams/end-of-stream.js":5937,"./lib/internal/streams/pipeline.js":5939},function(){with(this)return function(){"use strict";return function(e,t,r){(r=t.exports=e("./lib/_stream_readable.js")).Stream=r,r.Readable=r,r.Writable=e("./lib/_stream_writable.js"),r.Duplex=e("./lib/_stream_duplex.js"),r.Transform=e("./lib/_stream_transform.js"),r.PassThrough=e("./lib/_stream_passthrough.js"),r.finished=e("./lib/internal/streams/end-of-stream.js"),r.pipeline=e("./lib/internal/streams/pipeline.js")}}},{package:"@metamask/snap-controllers>tar-stream>readable-stream"}],[5943,{"./headers":5924,_process:5430,buffer:2132,"end-of-stream":2389,"fs-constants":4345,inherits:4453,"readable-stream":5942,string_decoder:5916},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r,n){(function(){var i=e("fs-constants"),o=e("end-of-stream"),s=e("inherits"),a=n.alloc,c=e("readable-stream").Readable,l=e("readable-stream").Writable,u=e("string_decoder").StringDecoder,d=e("./headers"),h=parseInt("755",8),p=parseInt("644",8),f=a(1024),g=function(){},m=function(e,t){(t&=511)&&e.push(f.slice(0,512-t))};var b=function(e){l.call(this),this.written=0,this._to=e,this._destroyed=!1};s(b,l),b.prototype._write=function(e,t,r){if(this.written+=e.length,this._to.push(e))return r();this._to._drain=r},b.prototype.destroy=function(){this._destroyed||(this._destroyed=!0,this.emit("close"))};var y=function(){l.call(this),this.linkname="",this._decoder=new u("utf-8"),this._destroyed=!1};s(y,l),y.prototype._write=function(e,t,r){this.linkname+=this._decoder.write(e),r()},y.prototype.destroy=function(){this._destroyed||(this._destroyed=!0,this.emit("close"))};var v=function(){l.call(this),this._destroyed=!1};s(v,l),v.prototype._write=function(e,t,r){r(new Error("No body allowed for this entry"))},v.prototype.destroy=function(){this._destroyed||(this._destroyed=!0,this.emit("close"))};var E=function(e){if(!(this instanceof E))return new E(e);c.call(this,e),this._drain=g,this._finalized=!1,this._finalizing=!1,this._destroyed=!1,this._stream=null};s(E,c),E.prototype.entry=function(e,t,s){if(this._stream)throw new Error("already piping an entry");if(!this._finalized&&!this._destroyed){"function"==typeof t&&(s=t,t=null),s||(s=g);var a=this;if(e.size&&"symlink"!==e.type||(e.size=0),e.type||(e.type=function(e){switch(e&i.S_IFMT){case i.S_IFBLK:return"block-device";case i.S_IFCHR:return"character-device";case i.S_IFDIR:return"directory";case i.S_IFIFO:return"fifo";case i.S_IFLNK:return"symlink"}return"file"}(e.mode)),e.mode||(e.mode="directory"===e.type?h:p),e.uid||(e.uid=0),e.gid||(e.gid=0),e.mtime||(e.mtime=new Date),"string"==typeof t&&(t=n.from(t)),n.isBuffer(t)){e.size=t.length,this._encode(e);var c=this.push(t);return m(a,e.size),c?r.nextTick(s):this._drain=s,new v}if("symlink"===e.type&&!e.linkname){var l=new y;return o(l,(function(t){if(t)return a.destroy(),s(t);e.linkname=l.linkname,a._encode(e),s()})),l}if(this._encode(e),"file"!==e.type&&"contiguous-file"!==e.type)return r.nextTick(s),new v;var u=new b(this);return this._stream=u,o(u,(function(t){return a._stream=null,t?(a.destroy(),s(t)):u.written!==e.size?(a.destroy(),s(new Error("size mismatch"))):(m(a,e.size),a._finalizing&&a.finalize(),void s())})),u}},E.prototype.finalize=function(){this._stream?this._finalizing=!0:this._finalized||(this._finalized=!0,this.push(f),this.push(null))},E.prototype.destroy=function(e){this._destroyed||(this._destroyed=!0,e&&this.emit("error",e),this.emit("close"),this._stream&&this._stream.destroy&&this._stream.destroy())},E.prototype._encode=function(e){if(!e.pax){var t=d.encode(e);if(t)return void this.push(t)}this._encodePax(e)},E.prototype._encodePax=function(e){var t=d.encodePax({name:e.name,linkname:e.linkname,pax:e.pax}),r={name:"PaxHeader",mode:e.mode,uid:e.uid,gid:e.gid,size:t.length,mtime:e.mtime,type:"pax-header",linkname:e.linkname&&"PaxHeader",uname:e.uname,gname:e.gname,devmajor:e.devmajor,devminor:e.devminor};this.push(d.encode(r)),this.push(t),m(this,t.length),r.size=e.size,r.type=e.type,this.push(d.encode(r))},E.prototype._read=function(e){var t=this._drain;this._drain=g,t()},t.exports=E}).call(this)}).call(this,e("_process"),e("buffer").Buffer)}}},{package:"@metamask/snap-controllers>tar-stream"}],[5945,{_process:5430,stream:2135},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("stream");function i(e,t,i){e=e||function(e){this.queue(e)},t=t||function(){this.queue(null)};var o=!1,s=!1,a=[],c=!1,l=new n;function u(){for(;a.length&&!l.paused;){var e=a.shift();if(null===e)return l.emit("end");l.emit("data",e)}}function d(){l.writable=!1,t.call(l),!l.readable&&l.autoDestroy&&l.destroy()}return l.readable=l.writable=!0,l.paused=!1,l.autoDestroy=!(i&&!1===i.autoDestroy),l.write=function(t){return e.call(this,t),!l.paused},l.queue=l.push=function(e){return c||(null===e&&(c=!0),a.push(e),u()),l},l.on("end",(function(){l.readable=!1,!l.writable&&l.autoDestroy&&r.nextTick((function(){l.destroy()}))})),l.end=function(e){if(!o)return o=!0,arguments.length&&l.write(e),d(),l},l.destroy=function(){if(!s)return s=!0,o=!0,a.length=0,l.writable=l.readable=!1,l.emit("close"),l},l.pause=function(){if(!l.paused)return l.paused=!0,l},l.resume=function(){return l.paused&&(l.paused=!1,l.emit("resume")),u(),l.paused||l.emit("drain"),l},l}t.exports=i,i.through=i}).call(this)}).call(this,e("_process"))}}},{package:"debounce-stream>through"}],[5946,{"lodash.throttle":5018},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("lodash.throttle");t.exports=function e(t){if(!(this instanceof e))return new e(t);const r=(t=t||{}).validity||30,i=new Map,o=n((()=>{i.forEach(((e,t)=>{const n=e.validity||r;(function(e){const t=(new Date).getTime()-e.getTime();return Math.floor(t/1e3)})(e.timestamp)>n&&i.delete(t)}))}),200);this.put=(e,t,r)=>{this.has(e)||i.set(e,{value:t,timestamp:new Date,validity:r}),o()},this.get=e=>{if(i.has(e))return i.get(e).value;throw new Error("key does not exist")},this.has=e=>i.has(e)}}}},{package:"3box>ipfs>libp2p>libp2p-floodsub>libp2p-pubsub>time-cache"}],[5948,{},function(){with(this)return function(){"use strict";return function(e,t,r){
/**
 * Timestamp for 64-bit time_t, nanosecond precision and strftime
 *
 * @author Yusuke Kawasaki
 * @license MIT
 * @see https://github.com/kawanet/timestamp-nano
 */
!function(){void 0!==t&&(t.exports=m);var e=86400,r=3200,n=1168776,i=100982246400,o=1e3*i,s=864e13,a=4294967296,c=1e6,l=1e9,u="000000000",d=Math.trunc||function(e){var t=e-e%1;return 0===t&&(e<0||0===e&&1/e!=1/0)?-0:t},h=m.prototype;m.fromDate=function(e){return new m(+e)},m.fromInt64BE=w(0,1,2,3,0,4),m.fromInt64LE=w(3,2,1,0,4,0),m.fromString=function(e){var t,r=new m,n=(e+="").replace(/^\s*[+\-]?\d+/,(function(e){var t=+e,n=1970+(t-1970)%400;return r.year=t-n,n})).replace(/(?:Z|([+\-]\d{2}):?(\d{2}))$/,(function(e,r,n){return r<0&&(n*=-1),t=6e4*(60*+r+ +n),""})).replace(/\.\d+$/,(function(e){return r.nano=+(e+u).substr(1,9),""})).split(/\D+/);n.length>1?n[1]--:n[1]=0;if(r.time=t=Date.UTC.apply(Date,n)-(t||0),isNaN(t))throw new TypeError("Invalid Date");return b(r)},m.fromTimeT=function(e){return v(e,0)},h.year=0,h.time=0,h.nano=0,h.addNano=function(e){return this.nano+=+e||0,this},h.getNano=function(){var e=b(this);return(e.time%1e3*c+ +e.nano+l)%l},h.getTimeT=function(){var t=b(this),i=Math.floor(t.time/1e3),o=t.year;o&&(i+=o*n*e/r);return i},h.getYear=function(){return this.toDate().getUTCFullYear()+this.year},h.toDate=function(){return y(b(this).time)},h.toJSON=function(){return this.toString().replace(/0{1,6}Z$/,"Z")},h.toString=function(e){var t=this,r=t.toDate(),n={H:function(){return S(r.getUTCHours())},L:function(){return C(r.getUTCMilliseconds(),3)},M:function(){return S(r.getUTCMinutes())},N:function(){return C(t.getNano(),9)},S:function(){return S(r.getUTCSeconds())},Y:function(){var e=t.getYear();return e>999999?"+"+e:e>9999?"+"+C(e,6):e>=0?C(e,4):e>=-999999?"-"+C(-e,6):e},a:function(){return f[r.getUTCDay()]},b:function(){return p[r.getUTCMonth()]},d:function(){return S(r.getUTCDate())},e:function(){return e=r.getUTCDate(),(e>9?"":" ")+(0|e);var e},m:function(){return S(r.getUTCMonth()+1)}};return function e(t){return t.replace(/%./g,(function(t){var r=t[1],i=g[r],o=n[r];return i?e(i):o?o():t}))}(e||"%Y-%m-%dT%H:%M:%S.%NZ")},h.writeInt64BE=E(0,1,2,3,0,4),h.writeInt64LE=E(3,2,1,0,4,0);var p=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],f=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],g={"%":"%",F:"%Y-%m-%d",n:"\n",R:"%H:%M",T:"%H:%M:%S",t:"\t",X:"%T",Z:"GMT",z:"+0000"};return m;function m(e,t,r){var n=this;if(!(n instanceof m))return new m(e,t,r);n.time=+e||0,n.nano=+t||0,n.year=+r||0,b(n)}function b(e){var t,n,i=e.year,a=e.time,l=e.nano;if(l<0||c<=l){var u=Math.floor(l/c);l-=u*c,a+=u,t=1}var h=i%r;if(a<-s||s<a||h){(n=d(a/o))&&(i+=n*r,a-=n*o);var p=y(a);p.setUTCFullYear(h+p.getUTCFullYear());var f=(a=+p)+(n=d((i-=h)/r))*o;n&&-s<=f&&f<=s&&(i-=n*r,a=f),t=1}return t&&(e.year=i,e.time=a,e.nano=l),e}function y(e){var t=new Date(0);return t.setTime(e),t}function v(e,t){t|=0,e=+e||0;var n=d((t*=a)/i)+d(e/i),o=t%i+e%i,s=d(o/i);return s&&(n+=s,o-=s*i),new m(1e3*o,0,n*r)}function E(e,t,r,n,i,o){return function(e,t){var r=b(this);e||(e=new Array(8));_(e,t|=0);var n=Math.floor(r.time/1e3),c=31556952*r.year,l=d(c/a)+d(n/a),u=c%a+n%a,h=Math.floor(u/a);h&&(l+=h,u-=h*a);return s(e,t+i,l),s(e,t+o,u),e};function s(i,o,s){i[o+e]=s>>24&255,i[o+t]=s>>16&255,i[o+r]=s>>8&255,i[o+n]=255&s}}function w(e,t,r,n,i,o){return function(e,t){_(e,t|=0);var r=s(e,t+i);return v(s(e,t+o),r)};function s(i,o){return 16777216*i[o+e]+(i[o+t]<<16|i[o+r]<<8|i[o+n])}}function _(e,t){var r=e&&e.length;if(null==r)throw new TypeError("Invalid Buffer");if(r<t+8)throw new RangeError("Out of range")}function S(e){return(e>9?"":"0")+(0|e)}function C(e,t){return(u+(0|e)).substr(-t)}}()}}},{package:"3box>ipfs>ipns>timestamp-nano"}],[5952,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e,t){for(var r=[],n=(t=t||0)||0;n<e.length;n++)r[n-t]=e[n];return r}}}},{package:"3box>ipfs>libp2p-webrtc-star>socket.io-client>to-array"}],[5953,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e){if(e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray)return new DataView(e.buffer,e.byteOffset,e.byteLength);if(e instanceof ArrayBuffer)return new DataView(e);throw new TypeError("Expected `data` to be an ArrayBuffer, Buffer, Int8Array, Uint8Array or Uint8ClampedArray")}}}},{package:"base32-encode>to-data-view"}],[5955,{},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.FIAT_RATES_UPDATE=r.NOTIFICATION=r.BLOCK=r.CONNECT=r.ERROR=void 0;r.ERROR="blockchain-error";r.CONNECT="blockchain-connect";r.BLOCK="blockchain-block";r.NOTIFICATION="blockchain-notification";r.FIAT_RATES_UPDATE="fiat-rates-update"}}},{package:"eth-trezor-keyring>trezor-connect"}],[5956,{},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.POOL_RELAY_TYPE=r.CERTIFICATE_TYPE=r.ADDRESS_TYPE=r.NETWORK_IDS=r.PROTOCOL_MAGICS=void 0;var n=Object.freeze({mainnet:764824073,testnet:42});r.PROTOCOL_MAGICS=n;var i=Object.freeze({mainnet:1,testnet:0});r.NETWORK_IDS=i;var o=Object.freeze({Base:0,Pointer:4,Enterprise:6,Byron:8,Reward:14});r.ADDRESS_TYPE=o;var s=Object.freeze({StakeRegistration:0,StakeDeregistration:1,StakeDelegation:2,StakePoolRegistration:3});r.CERTIFICATE_TYPE=s;var a=Object.freeze({SingleHostIp:0,SingleHostName:1,MultipleHostName:2});r.POOL_RELAY_TYPE=a}}},{package:"eth-trezor-keyring>trezor-connect"}],[5957,{},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.WAIT_FOR_SELECTION=r.WORD=r.PASSPHRASE_ON_DEVICE=r.PASSPHRASE=r.PIN=r.BUTTON=r.LOADING=r.USED_ELSEWHERE=r.RELEASED=r.ACQUIRED=r.RELEASE=r.ACQUIRE=r.CHANGED=r.DISCONNECT=r.CONNECT_UNACQUIRED=r.CONNECT=void 0;r.CONNECT="device-connect";r.CONNECT_UNACQUIRED="device-connect_unacquired";r.DISCONNECT="device-disconnect";r.CHANGED="device-changed";r.ACQUIRE="device-acquire";r.RELEASE="device-release";r.ACQUIRED="device-acquired";r.RELEASED="device-released";r.USED_ELSEWHERE="device-used_elsewhere";r.LOADING="device-loading";r.BUTTON="button";r.PIN="pin";r.PASSPHRASE="passphrase";r.PASSPHRASE_ON_DEVICE="passphrase_on_device";r.WORD="word";r.WAIT_FOR_SELECTION="device-wait_for_selection"}}},{package:"eth-trezor-keyring>trezor-connect"}],[5958,{"@babel/runtime/helpers/inheritsLoose":201,"@babel/runtime/helpers/interopRequireDefault":202,"@babel/runtime/helpers/wrapNativeSuper":221},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");r.__esModule=!0,r.LIBUSB_ERROR_MESSAGE=r.WEBUSB_ERROR_MESSAGE=r.INVALID_PIN_ERROR_MESSAGE=r.WRONG_PREVIOUS_SESSION_ERROR_MESSAGE=r.TypedError=r.TrezorError=r.ERROR_CODES=void 0;var i=n(e("@babel/runtime/helpers/inheritsLoose")),o=n(e("@babel/runtime/helpers/wrapNativeSuper")),s={Init_NotInitialized:"TrezorConnect not yet initialized",Init_AlreadyInitialized:"TrezorConnect has been already initialized",Init_IframeBlocked:"Iframe blocked",Init_IframeTimeout:"Iframe timeout",Init_ManifestMissing:"Manifest not set. Read more at https://github.com/trezor/connect/blob/develop/docs/index.md",Popup_ConnectionMissing:"Unable to establish connection with iframe",Transport_Missing:"Transport is missing",Transport_InvalidProtobuf:"",Method_InvalidPackage:"This version of trezor-connect is not suitable to work without browser. Use trezor-connect@extended package instead",Method_InvalidParameter:"",Method_NotAllowed:"Method not allowed for this configuration",Method_PermissionsNotGranted:"Permissions not granted",Method_Cancel:"Cancelled",Method_Interrupted:"Popup closed",Method_UnknownCoin:"Coin not found",Method_AddressNotMatch:"Addresses do not match",Method_FirmwareUpdate_DownloadFailed:"Failed to download firmware binary",Method_CustomMessage_Callback:'Parameter "callback" is not a function',Method_Discovery_BundleException:"",Method_Override:"override",Method_NoResponse:"Call resolved without response",Backend_NotSupported:"BlockchainLink settings not found in coins.json",Backend_WorkerMissing:"",Backend_Disconnected:"Backend disconnected",Backend_Invalid:"Invalid backend",Backend_Error:"",Runtime:"",Device_NotFound:"Device not found",Device_InitializeFailed:"",Device_FwException:"",Device_ModeException:"",Device_Disconnected:"Device disconnected",Device_UsedElsewhere:"Device is used in another window",Device_InvalidState:"Passphrase is incorrect",Device_CallInProgress:"Device call in progress"};r.ERROR_CODES=s;var a=function(e){function t(t,r){var n;return(n=e.call(this,r)||this).code=t,n.message=r,n}return(0,i.default)(t,e),t}((0,o.default)(Error));r.TrezorError=a;r.TypedError=function(e,t){return new a(e,t||s[e])};r.WRONG_PREVIOUS_SESSION_ERROR_MESSAGE="wrong previous session";r.INVALID_PIN_ERROR_MESSAGE="PIN invalid";r.WEBUSB_ERROR_MESSAGE="NetworkError: Unable to claim interface.";r.LIBUSB_ERROR_MESSAGE="LIBUSB_ERROR"}}},{package:"eth-trezor-keyring>trezor-connect"}],[5959,{},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.CALL=r.ERROR=r.INIT=r.LOADED=r.BOOTSTRAP=void 0;r.BOOTSTRAP="iframe-bootstrap";r.LOADED="iframe-loaded";r.INIT="iframe-init";r.ERROR="iframe-error";r.CALL="iframe-call"}}},{package:"eth-trezor-keyring>trezor-connect"}],[5960,{"./blockchain":5955,"./cardano":5956,"./device":5957,"./errors":5958,"./iframe":5959,"./network":5961,"./popup":5962,"./transport":5963,"./ui":5964},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.CARDANO=r.UI=r.TRANSPORT=r.POPUP=r.NETWORK=r.IFRAME=r.ERRORS=r.DEVICE=r.BLOCKCHAIN=r.BLOCKCHAIN_EVENT=r.RESPONSE_EVENT=r.TRANSPORT_EVENT=r.DEVICE_EVENT=r.UI_EVENT=r.CORE_EVENT=void 0;var n=p(e("./blockchain"));r.BLOCKCHAIN=n;var i=p(e("./device"));r.DEVICE=i;var o=p(e("./errors"));r.ERRORS=o;var s=p(e("./iframe"));r.IFRAME=s;var a=p(e("./network"));r.NETWORK=a;var c=p(e("./popup"));r.POPUP=c;var l=p(e("./transport"));r.TRANSPORT=l;var u=p(e("./ui"));r.UI=u;var d=p(e("./cardano"));function h(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(h=function(e){return e?r:t})(e)}function p(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=h(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}r.CARDANO=d;r.CORE_EVENT="CORE_EVENT";r.UI_EVENT="UI_EVENT";r.DEVICE_EVENT="DEVICE_EVENT";r.TRANSPORT_EVENT="TRANSPORT_EVENT";r.RESPONSE_EVENT="RESPONSE_EVENT";r.BLOCKCHAIN_EVENT="BLOCKCHAIN_EVENT"}}},{package:"eth-trezor-keyring>trezor-connect"}],[5961,{},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.TYPES=void 0;var n=Object.freeze({bitcoin:"Bitcoin",ethereum:"Ethereum",eos:"Eos",nem:"NEM",stellar:"Stellar",cardano:"Cardano",ripple:"Ripple",tezos:"Tezors",binance:"Binance"});r.TYPES=n}}},{package:"eth-trezor-keyring>trezor-connect"}],[5962,{},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.CLOSE_WINDOW=r.CANCEL_POPUP_REQUEST=r.CLOSED=r.HANDSHAKE=r.EXTENSION_USB_PERMISSIONS=r.ERROR=r.INIT=r.LOADED=r.BOOTSTRAP=void 0;r.BOOTSTRAP="popup-bootstrap";r.LOADED="popup-loaded";r.INIT="popup-init";r.ERROR="popup-error";r.EXTENSION_USB_PERMISSIONS="open-usb-permissions";r.HANDSHAKE="popup-handshake";r.CLOSED="popup-closed";r.CANCEL_POPUP_REQUEST="ui-cancel-popup-request";r.CLOSE_WINDOW="window.close"}}},{package:"eth-trezor-keyring>trezor-connect"}],[5963,{},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.START_PENDING=r.DISABLE_WEBUSB=r.REQUEST=r.STREAM=r.UPDATE=r.ERROR=r.START=void 0;r.START="transport-start";r.ERROR="transport-error";r.UPDATE="transport-update";r.STREAM="transport-stream";r.REQUEST="transport-request_device";r.DISABLE_WEBUSB="transport-disable_webusb";r.START_PENDING="transport-start_pending"}}},{package:"eth-trezor-keyring>trezor-connect"}],[5964,{},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.IFRAME_FAILURE=r.ADDRESS_VALIDATION=r.BUNDLE_PROGRESS=r.LOGIN_CHALLENGE_RESPONSE=r.LOGIN_CHALLENGE_REQUEST=r.CUSTOM_MESSAGE_RESPONSE=r.CUSTOM_MESSAGE_REQUEST=r.CHANGE_SETTINGS=r.RECEIVE_WORD=r.RECEIVE_FEE=r.RECEIVE_ACCOUNT=r.CHANGE_ACCOUNT=r.RECEIVE_DEVICE=r.RECEIVE_PASSPHRASE=r.RECEIVE_PIN=r.RECEIVE_CONFIRMATION=r.RECEIVE_PERMISSION=r.REQUEST_WORD=r.REQUEST_BUTTON=r.INSUFFICIENT_FUNDS=r.UPDATE_CUSTOM_FEE=r.SELECT_FEE=r.SELECT_ACCOUNT=r.SELECT_DEVICE=r.SET_OPERATION=r.LOADING=r.CONNECT=r.INVALID_PASSPHRASE_ACTION=r.INVALID_PASSPHRASE=r.REQUEST_PASSPHRASE_ON_DEVICE=r.REQUEST_PASSPHRASE=r.INVALID_PIN=r.REQUEST_PIN=r.REQUEST_CONFIRMATION=r.REQUEST_PERMISSION=r.CLOSE_UI_WINDOW=r.REQUEST_UI_WINDOW=r.DEVICE_NEEDS_BACKUP=r.FIRMWARE_PROGRESS=r.FIRMWARE_NOT_INSTALLED=r.FIRMWARE_NOT_COMPATIBLE=r.FIRMWARE_NOT_SUPPORTED=r.FIRMWARE_OUTDATED=r.FIRMWARE_OLD=r.SEEDLESS=r.INITIALIZE=r.REQUIRE_MODE=r.NOT_IN_BOOTLOADER=r.BOOTLOADER=r.TRANSPORT=void 0;r.TRANSPORT="ui-no_transport";r.BOOTLOADER="ui-device_bootloader_mode";r.NOT_IN_BOOTLOADER="ui-device_not_in_bootloader_mode";r.REQUIRE_MODE="ui-device_require_mode";r.INITIALIZE="ui-device_not_initialized";r.SEEDLESS="ui-device_seedless";r.FIRMWARE_OLD="ui-device_firmware_old";r.FIRMWARE_OUTDATED="ui-device_firmware_outdated";r.FIRMWARE_NOT_SUPPORTED="ui-device_firmware_unsupported";r.FIRMWARE_NOT_COMPATIBLE="ui-device_firmware_not_compatible";r.FIRMWARE_NOT_INSTALLED="ui-device_firmware_not_installed";r.FIRMWARE_PROGRESS="ui-firmware-progress";r.DEVICE_NEEDS_BACKUP="ui-device_needs_backup";r.REQUEST_UI_WINDOW="ui-request_window";r.CLOSE_UI_WINDOW="ui-close_window";r.REQUEST_PERMISSION="ui-request_permission";r.REQUEST_CONFIRMATION="ui-request_confirmation";r.REQUEST_PIN="ui-request_pin";r.INVALID_PIN="ui-invalid_pin";r.REQUEST_PASSPHRASE="ui-request_passphrase";r.REQUEST_PASSPHRASE_ON_DEVICE="ui-request_passphrase_on_device";r.INVALID_PASSPHRASE="ui-invalid_passphrase";r.INVALID_PASSPHRASE_ACTION="ui-invalid_passphrase_action";r.CONNECT="ui-connect";r.LOADING="ui-loading";r.SET_OPERATION="ui-set_operation";r.SELECT_DEVICE="ui-select_device";r.SELECT_ACCOUNT="ui-select_account";r.SELECT_FEE="ui-select_fee";r.UPDATE_CUSTOM_FEE="ui-update_custom_fee";r.INSUFFICIENT_FUNDS="ui-insufficient_funds";r.REQUEST_BUTTON="ui-button";r.REQUEST_WORD="ui-request_word";r.RECEIVE_PERMISSION="ui-receive_permission";r.RECEIVE_CONFIRMATION="ui-receive_confirmation";r.RECEIVE_PIN="ui-receive_pin";r.RECEIVE_PASSPHRASE="ui-receive_passphrase";r.RECEIVE_DEVICE="ui-receive_device";r.CHANGE_ACCOUNT="ui-change_account";r.RECEIVE_ACCOUNT="ui-receive_account";r.RECEIVE_FEE="ui-receive_fee";r.RECEIVE_WORD="ui-receive_word";r.CHANGE_SETTINGS="ui-change_settings";r.CUSTOM_MESSAGE_REQUEST="ui-custom_request";r.CUSTOM_MESSAGE_RESPONSE="ui-custom_response";r.LOGIN_CHALLENGE_REQUEST="ui-login_challenge_request";r.LOGIN_CHALLENGE_RESPONSE="ui-login_challenge_response";r.BUNDLE_PROGRESS="ui-bundle_progress";r.ADDRESS_VALIDATION="ui-address_validation";r.IFRAME_FAILURE="ui-iframe_failure"}}},{package:"eth-trezor-keyring>trezor-connect"}],[5965,{"@babel/runtime/helpers/defineProperty":196,"@babel/runtime/helpers/interopRequireDefault":202},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");r.__esModule=!0,r.parse=r.corsValidator=r.getEnv=r.DEFAULT_PRIORITY=void 0;var i=n(e("@babel/runtime/helpers/defineProperty"));function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var s="8.2.6",a="https://connect.trezor.io/"+(s.split(".").map((function(e){return parseInt(e,10)}))[0]+"/");r.DEFAULT_PRIORITY=2;var c={configSrc:"./data/config.json",version:s,debug:!1,priority:2,trustedHost:!1,connectSrc:a,iframeSrc:a+"iframe.html",popup:!0,popupSrc:a+"popup.html",webusbSrc:a+"webusb.html",transportReconnect:!1,webusb:!0,pendingTransportEvent:!0,supportedBrowser:"undefined"==typeof navigator||!/Trident|MSIE|Edge/.test(navigator.userAgent),manifest:null,env:"web",lazyLoad:!1,timestamp:(new Date).getTime(),interactionTimeout:600},l=function(){if("undefined"!=typeof chrome&&chrome.runtime&&void 0!==chrome.runtime.onConnect)return"webextension";if("undefined"!=typeof navigator){if("string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase())return"react-native";if(navigator.userAgent.toLowerCase().indexOf(" electron/")>-1)return"electron"}return"web"};r.getEnv=l;var u=function(e){if("string"==typeof e)return e.match(/^https:\/\/([A-Za-z0-9\-_]+\.)*trezor\.io\//)||e.match(/^https?:\/\/localhost:[58][0-9]{3}\//)||e.match(/^https:\/\/([A-Za-z0-9\-_]+\.)*sldev\.cz\//)||e.match(/^https?:\/\/([A-Za-z0-9\-_]+\.)*trezoriovpjcahpzkrewelclulmszwbqpzmzgub37gbcjlvluxtruqad\.onion\//)?e:void 0};r.corsValidator=u;r.parse=function(e){void 0===e&&(e={});var t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},c);if(Object.prototype.hasOwnProperty.call(e,"debug")&&(Array.isArray(e),"boolean"==typeof e.debug?t.debug=e.debug:"string"==typeof e.debug&&(t.debug="true"===e.debug)),"string"==typeof e.connectSrc&&(t.connectSrc=e.connectSrc),"undefined"!=typeof global&&"string"==typeof global.__TREZOR_CONNECT_SRC&&(t.connectSrc=u(global.__TREZOR_CONNECT_SRC),t.debug=!0),"undefined"!=typeof window&&window.location&&"string"==typeof window.location.search){var r=window.location.search.split("&").find((function(e){return e.indexOf("trezor-connect-src")>=0}));if(r){var n=r.split("=")[1];t.connectSrc=u(decodeURIComponent(n)),t.debug=!0}}var s=t.connectSrc||a;return t.iframeSrc=s+"iframe.html",t.popupSrc=s+"popup.html",t.webusbSrc=s+"webusb.html","boolean"==typeof e.transportReconnect&&(t.transportReconnect=e.transportReconnect),"boolean"==typeof e.webusb&&(t.webusb=e.webusb),"boolean"==typeof e.popup&&(t.popup=e.popup),"boolean"==typeof e.lazyLoad&&(t.lazyLoad=e.lazyLoad),"boolean"==typeof e.pendingTransportEvent&&(t.pendingTransportEvent=e.pendingTransportEvent),"undefined"!=typeof window&&window.location&&"file:"===window.location.protocol&&(t.origin="file://"+window.location.pathname,t.webusb=!1),"string"==typeof e.extension&&(t.extension=e.extension),"string"==typeof e.env?t.env=e.env:t.env=l(),"number"==typeof e.timestamp&&(t.timestamp=e.timestamp),"number"==typeof e.interactionTimeout&&(t.interactionTimeout=e.interactionTimeout),"object"==typeof e.manifest&&(t.manifest=function(e){if(e&&"string"==typeof e.email&&"string"==typeof e.appUrl)return{email:e.email,appUrl:e.appUrl}}(e.manifest)),c=t}}}},{package:"eth-trezor-keyring>trezor-connect"}],[5966,{"../../constants":5960,"../../data/ConnectSettings":5965,"../../iframe/builder":5968,"../../message":5972,"../../message/builder":5971,"../../popup/PopupManager":5974,"../../types":5981,"../../utils/debug":5997,"../../webusb/button":5999,"@babel/runtime/helpers/asyncToGenerator":192,"@babel/runtime/helpers/defineProperty":196,"@babel/runtime/helpers/interopRequireDefault":202,"@babel/runtime/regenerator":222,events:2133},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");r.__esModule=!0,r.disableWebUSB=r.requestLogin=r.customMessage=r.getSettings=r.renderWebUSBButton=r.uiResponse=r.call=r.init=r.cancel=r.dispose=r.manifest=r.eventEmitter=void 0;var i=n(e("@babel/runtime/regenerator")),o=n(e("@babel/runtime/helpers/defineProperty")),s=n(e("@babel/runtime/helpers/asyncToGenerator")),a=n(e("events")),c=n(e("../../popup/PopupManager")),l=b(e("../../iframe/builder")),u=n(e("../../webusb/button")),d=e("../../message"),h=e("../../message/builder"),p=e("../../data/ConnectSettings"),f=e("../../utils/debug"),g=e("../../constants");b(e("../../types"));function m(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(m=function(e){return e?r:t})(e)}function b(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=m(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){(0,o.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var E=new a.default;r.eventEmitter=E;var w,_,S=(0,f.initLog)("[trezor-connect.js]"),C=function(){var e=new c.default(w);return e.on(g.POPUP.CLOSED,(function(e){l.postMessage({type:g.POPUP.CLOSED,payload:e?{error:e}:null},!1)})),e};r.manifest=function(e){w=(0,p.parse)({manifest:e})};var k=function(){E.removeAllListeners(),l.dispose(),_&&_.close()};r.dispose=k;r.cancel=function(e){_&&_.emit(g.POPUP.CLOSED,e)};var T=function(e){if(e.origin===l.origin){var t=(0,d.parseMessage)(e.data),r=t.event,n=t.type,i=t.payload,o=t.id||0;switch(S.log("handleMessage",t),r){case g.RESPONSE_EVENT:l.messagePromises[o]?(l.messagePromises[o].resolve({id:o,success:t.success,payload:i}),delete l.messagePromises[o]):S.warn("Unknown message id "+o);break;case g.DEVICE_EVENT:case g.TRANSPORT_EVENT:case g.BLOCKCHAIN_EVENT:E.emit(r,t),E.emit(n,i);break;case g.UI_EVENT:if(n===g.IFRAME.BOOTSTRAP){l.clearTimeout();break}n===g.IFRAME.LOADED&&l.initPromise.resolve(),n===g.IFRAME.ERROR&&l.initPromise.reject(i.error),E.emit(r,t),E.emit(n,i);break;default:S.log("Undefined message",r,e)}}},M=function(){var e=(0,s.default)(i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t={}),!l.instance){e.next=3;break}throw g.ERRORS.TypedError("Init_AlreadyInitialized");case 3:if(w||(w=(0,p.parse)(t)),w.manifest){e.next=6;break}throw g.ERRORS.TypedError("Init_ManifestMissing");case 6:if(!w.lazyLoad){e.next=9;break}return w.lazyLoad=!1,e.abrupt("return");case 9:return _||(_=C()),S.enabled=!!w.debug,window.addEventListener("message",T),window.addEventListener("unload",k),e.next=15,l.init(w);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();r.init=M;var O=function(){var e=(0,s.default)(i.default.mark((function e(t){var r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l.instance||l.timeout){e.next=15;break}if((w=(0,p.parse)(w)).manifest){e.next=4;break}return e.abrupt("return",(0,d.errorMessage)(g.ERRORS.TypedError("Init_ManifestMissing")));case 4:return _||(_=C()),_.request(!0),e.prev=6,e.next=9,M(w);case 9:e.next=15;break;case 11:return e.prev=11,e.t0=e.catch(6),_&&(["Init_IframeBlocked","Init_IframeTimeout"].includes(e.t0.code)?_.postMessage((0,h.UiMessage)(g.UI.IFRAME_FAILURE)):_.close()),e.abrupt("return",(0,d.errorMessage)(e.t0));case 15:if(!l.timeout){e.next=17;break}return e.abrupt("return",(0,d.errorMessage)(g.ERRORS.TypedError("Init_ManifestMissing")));case 17:if(!l.error){e.next=19;break}return e.abrupt("return",(0,d.errorMessage)(l.error));case 19:return w.popup&&_&&_.request(),e.prev=20,e.next=23,l.postMessage({type:g.IFRAME.CALL,payload:t});case 23:if(!(r=e.sent)){e.next=27;break}return!r.success&&"Device_CallInProgress"!==r.payload.code&&_&&_.unlock(),e.abrupt("return",r);case 27:return _&&_.unlock(),e.abrupt("return",(0,d.errorMessage)(g.ERRORS.TypedError("Method_NoResponse")));case 31:return e.prev=31,e.t1=e.catch(20),S.error("__call error",e.t1),_&&_.close(),e.abrupt("return",(0,d.errorMessage)(e.t1));case 36:case"end":return e.stop()}}),e,null,[[6,11],[20,31]])})));return function(t){return e.apply(this,arguments)}}();r.call=O;var P=function(e){l.postMessage({event:g.UI_EVENT,type:g.UI.CUSTOM_MESSAGE_RESPONSE,payload:e})};r.uiResponse=function(e){var t=e.type,r=e.payload;l.postMessage({event:g.UI_EVENT,type:t,payload:r})};r.renderWebUSBButton=function(e){(0,u.default)(e,w.webusbSrc,l.origin)};r.getSettings=function(){return l.instance?O({method:"getSettings"}):Promise.resolve((0,d.errorMessage)(g.ERRORS.TypedError("Init_NotInitialized")))};var R=function(){var e=(0,s.default)(i.default.mark((function e(t){var r,n,o;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"==typeof t.callback){e.next=2;break}return e.abrupt("return",(0,d.errorMessage)(g.ERRORS.TypedError("Method_CustomMessage_Callback")));case 2:return r=t.callback,n=function(){var e=(0,s.default)(i.default.mark((function e(t){var n,o;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.data)||n.type!==g.UI.CUSTOM_MESSAGE_REQUEST){e.next=6;break}return e.next=4,r(n.payload);case 4:o=e.sent,P(o||{message:"release"});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),window.addEventListener("message",n,!1),e.next=7,O(v(v({method:"customMessage"},t),{},{callback:null}));case 7:return o=e.sent,window.removeEventListener("message",n),e.abrupt("return",o);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();r.customMessage=R;var A=function(){var e=(0,s.default)(i.default.mark((function e(t){var r,n,o;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!=typeof t.callback){e.next=9;break}return r=t.callback,n=function(){var e=(0,s.default)(i.default.mark((function e(t){var n,o;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.data)||n.type!==g.UI.LOGIN_CHALLENGE_REQUEST){e.next=12;break}return e.prev=2,e.next=5,r();case 5:o=e.sent,l.postMessage({event:g.UI_EVENT,type:g.UI.LOGIN_CHALLENGE_RESPONSE,payload:o}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),l.postMessage({event:g.UI_EVENT,type:g.UI.LOGIN_CHALLENGE_RESPONSE,payload:e.t0.message});case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}(),window.addEventListener("message",n,!1),e.next=6,O(v(v({method:"requestLogin"},t),{},{asyncChallenge:!0,callback:null}));case 6:return o=e.sent,window.removeEventListener("message",n),e.abrupt("return",o);case 9:return e.abrupt("return",O(v({method:"requestLogin"},t)));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();r.requestLogin=A;r.disableWebUSB=function(){l.postMessage({event:g.UI_EVENT,type:g.TRANSPORT.DISABLE_WEBUSB})}}}},{package:"eth-trezor-keyring>trezor-connect"}],[5967,{"@babel/runtime/helpers/asyncToGenerator":192,"@babel/runtime/helpers/interopRequireDefault":202,"@babel/runtime/regenerator":222,"cross-fetch":2240},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");r.__esModule=!0,r.getOrigin=r.httpRequest=void 0;var i=n(e("@babel/runtime/regenerator")),o=n(e("@babel/runtime/helpers/asyncToGenerator")),s=n(e("cross-fetch")),a=function(){var e=(0,o.default)(i.default.mark((function e(t,r){var n,o;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===r&&(r="text"),e.next=3,(0,s.default)(t,{credentials:"same-origin"});case 3:if(!(n=e.sent).ok){e.next=13;break}if("json"!==r){e.next=10;break}return e.next=8,n.text();case 8:return o=e.sent,e.abrupt("return",JSON.parse(o));case 10:if("binary"!==r){e.next=12;break}return e.abrupt("return",n.arrayBuffer());case 12:return e.abrupt("return",n.text());case 13:throw new Error("httpRequest error: "+t+" "+n.statusText);case 14:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();r.httpRequest=a;r.getOrigin=function(e){if(0===e.indexOf("file://"))return"file://";var t=e.match(/^.+\:\/\/[^\/]+/);return Array.isArray(t)&&t.length>0?t[0]:"unknown"}}}},{package:"eth-trezor-keyring>trezor-connect"}],[5968,{"../constants":5960,"../env/browser/networkUtils":5967,"../utils/deferred":5998,"./inline-styles":5969,"@babel/runtime/helpers/asyncToGenerator":192,"@babel/runtime/helpers/interopRequireDefault":202,"@babel/runtime/regenerator":222},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");r.__esModule=!0,r.clearTimeout=r.dispose=r.postMessage=r.init=r.messagePromises=r.error=r.timeout=r.initPromise=r.origin=r.instance=void 0;var i,o,s=n(e("@babel/runtime/regenerator")),a=n(e("@babel/runtime/helpers/asyncToGenerator")),c=e("../utils/deferred"),l=e("../constants"),u=e("../env/browser/networkUtils"),d=n(e("./inline-styles"));r.instance=i,r.origin=o;var h=(0,c.create)();r.initPromise=h;var p,f=0;r.timeout=f,r.error=p;var g=0,m={};r.messagePromises=m;var b=function(){var e=(0,a.default)(s.default.mark((function e(t){var n,a,d,p,g;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.initPromise=h=(0,c.create)(),(n=document.getElementById("trezorconnect"))?r.instance=i=n:(r.instance=i=document.createElement("iframe"),i.frameBorder="0",i.width="0px",i.height="0px",i.style.position="absolute",i.style.display="none",i.style.border="0px",i.style.width="0px",i.style.height="0px",i.id="trezorconnect"),"web"===t.env?(d=t.manifest?JSON.stringify(t.manifest):"undefined",p="version="+t.version+"&manifest="+encodeURIComponent(btoa(JSON.stringify(d))),a=t.iframeSrc+"?"+p):a=t.iframeSrc,i.setAttribute("src",a),t.webusb&&i.setAttribute("allow","usb"),r.origin=o=(0,u.getOrigin)(i.src),r.timeout=f=window.setTimeout((function(){h.reject(l.ERRORS.TypedError("Init_IframeTimeout"))}),1e4),g=function(){if(i){try{var e=i.contentWindow.location.origin;if(!e||"null"===e)return void v()}catch(e){}var r;"undefined"!=typeof chrome&&chrome.runtime&&void 0!==chrome.runtime.onConnect&&(chrome.runtime.onConnect.addListener((function(){})),r=chrome.runtime.id),i.contentWindow.postMessage({type:l.IFRAME.INIT,payload:{settings:t,extension:r}},o),i.onload=undefined}else h.reject(l.ERRORS.TypedError("Init_IframeBlocked"))},i.attachEvent?i.attachEvent("onload",g):i.onload=g,document.body&&(document.body.appendChild(i),y()),e.prev=11,e.next=14,h.promise;case 14:e.next=20;break;case 16:throw e.prev=16,e.t0=e.catch(11),i&&(i.parentNode&&i.parentNode.removeChild(i),r.instance=i=null),e.t0;case 20:return e.prev=20,window.clearTimeout(f),r.timeout=f=0,e.finish(20);case 24:case"end":return e.stop()}}),e,null,[[11,16,20,24]])})));return function(t){return e.apply(this,arguments)}}();r.init=b;var y=function(){if(!i)throw l.ERRORS.TypedError("Init_IframeBlocked");var e=i.ownerDocument,t=e.head||e.getElementsByTagName("head")[0],r=document.createElement("style");r.setAttribute("type","text/css"),r.setAttribute("id","TrezorConnectStylesheet"),r.styleSheet?(r.styleSheet.cssText=d.default,t.appendChild(r)):(r.appendChild(document.createTextNode(d.default)),t.append(r))},v=function(){window.clearTimeout(f),r.error=p=l.ERRORS.TypedError("Init_IframeBlocked"),E(),h.reject(p)};r.postMessage=function(e,t){if(void 0===t&&(t=!0),!i)throw l.ERRORS.TypedError("Init_IframeBlocked");if(t){g++,e.id=g,m[g]=(0,c.create)();var r=m[g].promise;return i.contentWindow.postMessage(e,o),r}return i.contentWindow.postMessage(e,o),null};var E=function(){if(i&&i.parentNode)try{i.parentNode.removeChild(i)}catch(e){}r.instance=i=null,r.timeout=f=0};r.dispose=E;r.clearTimeout=function(){window.clearTimeout(f)}}}},{package:"eth-trezor-keyring>trezor-connect"}],[5969,{},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.default=void 0;r.default='.trezorconnect-container{position:fixed!important;display:-webkit-box!important;display:-webkit-flex!important;display:-ms-flexbox!important;display:flex!important;-webkit-box-orient:vertical!important;-webkit-box-direction:normal!important;-webkit-flex-direction:column!important;-ms-flex-direction:column!important;flex-direction:column!important;-webkit-box-align:center!important;-webkit-align-items:center!important;-ms-flex-align:center!important;align-items:center!important;z-index:10000!important;width:100%!important;height:100%!important;top:0!important;left:0!important;background:rgba(0,0,0,.35)!important;overflow:auto!important;padding:20px!important;margin:0!important}.trezorconnect-container .trezorconnect-window{position:relative!important;display:block!important;width:370px!important;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif!important;margin:auto!important;border-radius:3px!important;background-color:#fff!important;text-align:center!important;overflow:hidden!important}.trezorconnect-container .trezorconnect-window .trezorconnect-head{text-align:left;padding:12px 24px!important;display:-webkit-box!important;display:-webkit-flex!important;display:-ms-flexbox!important;display:flex!important;-webkit-box-align:center!important;-webkit-align-items:center!important;-ms-flex-align:center!important;align-items:center!important}.trezorconnect-container .trezorconnect-window .trezorconnect-head .trezorconnect-logo{-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1}.trezorconnect-container .trezorconnect-window .trezorconnect-head .trezorconnect-close{cursor:pointer!important;height:24px!important}.trezorconnect-container .trezorconnect-window .trezorconnect-head .trezorconnect-close svg{fill:#757575;-webkit-transition:fill .3s ease-in-out!important;transition:fill .3s ease-in-out!important}.trezorconnect-container .trezorconnect-window .trezorconnect-head .trezorconnect-close:hover svg{fill:#494949}.trezorconnect-container .trezorconnect-window .trezorconnect-body{padding:24px 24px 32px!important;background:#FBFBFB!important;border-top:1px solid #EBEBEB}.trezorconnect-container .trezorconnect-window .trezorconnect-body h3{color:#505050!important;font-size:16px!important;font-weight:500!important}.trezorconnect-container .trezorconnect-window .trezorconnect-body p{margin:8px 0 24px!important;font-weight:400!important;color:#A9A9A9!important;font-size:12px!important}.trezorconnect-container .trezorconnect-window .trezorconnect-body button{width:100%!important;padding:12px 24px!important;margin:0!important;border-radius:3px!important;font-size:14px!important;font-weight:300!important;cursor:pointer!important;background:#01B757!important;color:#fff!important;border:0!important;-webkit-transition:background-color .3s ease-in-out!important;transition:background-color .3s ease-in-out!important}.trezorconnect-container .trezorconnect-window .trezorconnect-body button:hover{background-color:#00AB51!important}.trezorconnect-container .trezorconnect-window .trezorconnect-body button:active{background-color:#009546!important}/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImlucHV0IiwiJHN0ZGluIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQWNBLHlCQUNJLFNBQUEsZ0JBQ0EsUUFBQSxzQkFDQSxRQUFBLHVCQUNBLFFBQUEsc0JBRUEsUUFBQSxlQUNBLG1CQUFBLG1CQUNBLHNCQUFBLGlCQUNBLHVCQUFBLGlCQUNBLG1CQUFBLGlCQUNBLGVBQUEsaUJBRUEsa0JBQUEsaUJBQ0Esb0JBQUEsaUJBQ0EsZUFBQSxpQkNmTSxZQUFhLGlCREFyQixRQUFTLGdCQWtCSCxNQUFBLGVBQ0EsT0FBQSxlQUNBLElBQUEsWUFDQSxLQUFBLFlBQ0EsV0FBQSwwQkFDQSxTQUFBLGVBQ0EsUUFBQSxlQUNBLE9BQUEsWUNkUiwrQ0RYRSxTQUFVLG1CQTZCQSxRQUFBLGdCQUNBLE1BQUEsZ0JBQ0EsWUFBQSxjQUFBLG1CQUFBLFdBQUEsT0FBQSxpQkFBQSxNQUFBLHFCQUNBLE9BQUEsZUNmVixjQUFlLGNEakJmLGlCQWlCRSxlQWtCWSxXQUFBLGlCQ2ZkLFNBQVUsaUJEbUJJLG1FQUNBLFdBQUEsS0NoQmQsUUFBUyxLQUFLLGVEeEJkLFFBQVMsc0JBMENTLFFBQUEsdUJBQ0EsUUFBQSxzQkNmbEIsUUFBUyxlRGlCSyxrQkE1QlosaUJBOEJvQixvQkFBQSxpQkNoQmxCLGVBQWdCLGlCRC9CWixZQWlCTixpQkFzQ1EsdUZBQ0EsaUJBQUEsRUNwQlYsYUFBYyxFRHBDVixTQUFVLEVBMkRBLEtBQUEsRUFFQSx3RkNwQmQsT0FBUSxrQkR6Q1IsT0FBUSxlQWlFTSw0RkFDQSxLQUFBLFFBQ0EsbUJBQUEsS0FBQSxJQUFBLHNCQ3BCZCxXQUFZLEtBQUssSUFBSyxzQkR3QlIsa0dBQ0EsS0FBQSxRQUVBLG1FQUNBLFFBQUEsS0FBQSxLQUFBLGVBQ0EsV0FBQSxrQkFDQSxXQUFBLElBQUEsTUFBQSxRQUVBLHNFQUNBLE1BQUEsa0JBQ0EsVUFBQSxlQ3JCZCxZQUFhLGNEd0JLLHFFQ3JCbEIsT0FBUSxJQUFJLEVBQUksZUR3QkYsWUFBQSxjQUNJLE1BQUEsa0JDdEJsQixVQUFXLGVBRWIsMEVBQ0UsTUFBTyxlQUNQLFFBQVMsS0FBSyxlQUNkLE9BQVEsWUFDUixjQUFlLGNBQ2YsVUFBVyxlQUNYLFlBQWEsY0FDYixPQUFRLGtCQUNSLFdBQVksa0JBQ1osTUFBTyxlQUNQLE9BQVEsWUFDUixtQkFBb0IsaUJBQWlCLElBQUssc0JBQzFDLFdBQVksaUJBQWlCLElBQUssc0JBRXBDLGdGQUNFLGlCQUFrQixrQkFFcEIsaUZBQ0UsaUJBQWtCIn0= */'}}},{package:"eth-trezor-keyring>trezor-connect"}],[5970,{"./constants":5960,"./env/node":5966,"./types":5981,"@babel/runtime/helpers/defineProperty":196,"@babel/runtime/helpers/interopRequireDefault":202},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");r.__esModule=!0;var i={};r.default=void 0;var o=n(e("@babel/runtime/helpers/defineProperty")),s=e("./constants");Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||e in r&&r[e]===s[e]||(r[e]=s[e]))}));var a=e("./env/node"),c=e("./types");function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){(0,o.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}Object.keys(c).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(i,e)||e in r&&r[e]===c[e]||(r[e]=c[e]))}));var d={manifest:a.manifest,init:a.init,getSettings:a.getSettings,on:function(e,t){a.eventEmitter.on(e,t)},off:function(e,t){a.eventEmitter.removeListener(e,t)},removeAllListeners:function(){a.eventEmitter.removeAllListeners()},uiResponse:a.uiResponse,blockchainGetAccountBalanceHistory:function(e){return(0,a.call)(u({method:"blockchainGetAccountBalanceHistory"},e))},blockchainGetCurrentFiatRates:function(e){return(0,a.call)(u({method:"blockchainGetCurrentFiatRates"},e))},blockchainGetFiatRatesForTimestamps:function(e){return(0,a.call)(u({method:"blockchainGetFiatRatesForTimestamps"},e))},blockchainDisconnect:function(e){return(0,a.call)(u({method:"blockchainDisconnect"},e))},blockchainEstimateFee:function(e){return(0,a.call)(u({method:"blockchainEstimateFee"},e))},blockchainGetTransactions:function(e){return(0,a.call)(u({method:"blockchainGetTransactions"},e))},blockchainSetCustomBackend:function(e){return(0,a.call)(u({method:"blockchainSetCustomBackend"},e))},blockchainSubscribe:function(e){return(0,a.call)(u({method:"blockchainSubscribe"},e))},blockchainSubscribeFiatRates:function(e){return(0,a.call)(u({method:"blockchainSubscribeFiatRates"},e))},blockchainUnsubscribe:function(e){return(0,a.call)(u({method:"blockchainUnsubscribe"},e))},blockchainUnsubscribeFiatRates:function(e){return(0,a.call)(u({method:"blockchainUnsubscribeFiatRates"},e))},customMessage:function(e){return(0,a.customMessage)(e)},requestLogin:function(e){return(0,a.requestLogin)(e)},cardanoGetAddress:function(e){var t=a.eventEmitter.listenerCount(s.UI.ADDRESS_VALIDATION)>0;return(0,a.call)(u(u({method:"cardanoGetAddress"},e),{},{useEventListener:t}))},cardanoGetNativeScriptHash:function(e){return(0,a.call)(u({method:"cardanoGetNativeScriptHash"},e))},cardanoGetPublicKey:function(e){return(0,a.call)(u({method:"cardanoGetPublicKey"},e))},cardanoSignTransaction:function(e){return(0,a.call)(u({method:"cardanoSignTransaction"},e))},cipherKeyValue:function(e){return(0,a.call)(u({method:"cipherKeyValue"},e))},composeTransaction:function(e){return(0,a.call)(u({method:"composeTransaction"},e))},ethereumGetAddress:function(e){var t=a.eventEmitter.listenerCount(s.UI.ADDRESS_VALIDATION)>0;return(0,a.call)(u(u({method:"ethereumGetAddress"},e),{},{useEventListener:t}))},ethereumGetPublicKey:function(e){return(0,a.call)(u({method:"ethereumGetPublicKey"},e))},ethereumSignMessage:function(e){return(0,a.call)(u({method:"ethereumSignMessage"},e))},ethereumSignTransaction:function(e){return(0,a.call)(u({method:"ethereumSignTransaction"},e))},ethereumSignTypedData:function(e){return(0,a.call)(u({method:"ethereumSignTypedData"},e))},ethereumVerifyMessage:function(e){return(0,a.call)(u({method:"ethereumVerifyMessage"},e))},getAccountInfo:function(e){return(0,a.call)(u({method:"getAccountInfo"},e))},getAddress:function(e){var t=a.eventEmitter.listenerCount(s.UI.ADDRESS_VALIDATION)>0;return(0,a.call)(u(u({method:"getAddress"},e),{},{useEventListener:t}))},getDeviceState:function(e){return(0,a.call)(u({method:"getDeviceState"},e))},getFeatures:function(e){return(0,a.call)(u({method:"getFeatures"},e))},getPublicKey:function(e){return(0,a.call)(u({method:"getPublicKey"},e))},liskGetAddress:function(){return(0,a.call)({method:"liskDeprecated"})},liskGetPublicKey:function(){return(0,a.call)({method:"liskDeprecated"})},liskSignMessage:function(){return(0,a.call)({method:"liskDeprecated"})},liskSignTransaction:function(){return(0,a.call)({method:"liskDeprecated"})},liskVerifyMessage:function(){return(0,a.call)({method:"liskDeprecated"})},nemGetAddress:function(e){var t=a.eventEmitter.listenerCount(s.UI.ADDRESS_VALIDATION)>0;return(0,a.call)(u(u({method:"nemGetAddress"},e),{},{useEventListener:t}))},nemSignTransaction:function(e){return(0,a.call)(u({method:"nemSignTransaction"},e))},pushTransaction:function(e){return(0,a.call)(u({method:"pushTransaction"},e))},rippleGetAddress:function(e){var t=a.eventEmitter.listenerCount(s.UI.ADDRESS_VALIDATION)>0;return(0,a.call)(u(u({method:"rippleGetAddress"},e),{},{useEventListener:t}))},rippleSignTransaction:function(e){return(0,a.call)(u({method:"rippleSignTransaction"},e))},signMessage:function(e){return(0,a.call)(u({method:"signMessage"},e))},signTransaction:function(e){return(0,a.call)(u({method:"signTransaction"},e))},stellarGetAddress:function(e){var t=a.eventEmitter.listenerCount(s.UI.ADDRESS_VALIDATION)>0;return(0,a.call)(u(u({method:"stellarGetAddress"},e),{},{useEventListener:t}))},stellarSignTransaction:function(e){return(0,a.call)(u({method:"stellarSignTransaction"},e))},tezosGetAddress:function(e){var t=a.eventEmitter.listenerCount(s.UI.ADDRESS_VALIDATION)>0;return(0,a.call)(u(u({method:"tezosGetAddress"},e),{},{useEventListener:t}))},tezosGetPublicKey:function(e){return(0,a.call)(u({method:"tezosGetPublicKey"},e))},tezosSignTransaction:function(e){return(0,a.call)(u({method:"tezosSignTransaction"},e))},eosGetPublicKey:function(e){return(0,a.call)(u({method:"eosGetPublicKey"},e))},eosSignTransaction:function(e){return(0,a.call)(u({method:"eosSignTransaction"},e))},binanceGetAddress:function(e){var t=a.eventEmitter.listenerCount(s.UI.ADDRESS_VALIDATION)>0;return(0,a.call)(u(u({method:"binanceGetAddress"},e),{},{useEventListener:t}))},binanceGetPublicKey:function(e){return(0,a.call)(u({method:"binanceGetPublicKey"},e))},binanceSignTransaction:function(e){return(0,a.call)(u({method:"binanceSignTransaction"},e))},verifyMessage:function(e){return(0,a.call)(u({method:"verifyMessage"},e))},resetDevice:function(e){return(0,a.call)(u({method:"resetDevice"},e))},wipeDevice:function(e){return(0,a.call)(u({method:"wipeDevice"},e))},applyFlags:function(e){return(0,a.call)(u({method:"applyFlags"},e))},applySettings:function(e){return(0,a.call)(u({method:"applySettings"},e))},backupDevice:function(e){return(0,a.call)(u({method:"backupDevice"},e))},changePin:function(e){return(0,a.call)(u({method:"changePin"},e))},firmwareUpdate:function(e){return(0,a.call)(u({method:"firmwareUpdate"},e))},recoveryDevice:function(e){return(0,a.call)(u({method:"recoveryDevice"},e))},getCoinInfo:function(e){return(0,a.call)(u({method:"getCoinInfo"},e))},rebootToBootloader:function(e){return(0,a.call)(u({method:"rebootToBootloader"},e))},dispose:a.dispose,cancel:a.cancel,renderWebUSBButton:a.renderWebUSBButton,disableWebUSB:a.disableWebUSB};r.default=d}}},{package:"eth-trezor-keyring>trezor-connect"}],[5971,{"../constants":5960,"@babel/runtime/helpers/defineProperty":196,"@babel/runtime/helpers/interopRequireDefault":202},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");r.__esModule=!0,r.BlockchainMessage=r.ResponseMessage=r.TransportMessage=r.DeviceMessage=r.UiMessage=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),o=e("../constants");function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}r.UiMessage=function(e,t){return{event:o.UI_EVENT,type:e,payload:t}};r.DeviceMessage=function(e,t){return{event:o.DEVICE_EVENT,type:e,payload:t}};r.TransportMessage=function(e,t){return{event:o.TRANSPORT_EVENT,type:e,payload:t.error?a(a({},t),{},{error:t.error.message,code:t.error.code}):t}};r.ResponseMessage=function(e,t,r){return void 0===r&&(r=null),{event:o.RESPONSE_EVENT,type:o.RESPONSE_EVENT,id:e,success:t,payload:t?r:{error:r.error.message,code:r.error.code}}};r.BlockchainMessage=function(e,t){return{event:o.BLOCKCHAIN_EVENT,type:e,payload:t}}}}},{package:"eth-trezor-keyring>trezor-connect"}],[5972,{},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.errorMessage=r.parseMessage=void 0;r.parseMessage=function(e){var t={event:e.event,type:e.type,payload:e.payload};return"number"==typeof e.id&&(t.id=e.id),"boolean"==typeof e.success&&(t.success=e.success),t};r.errorMessage=function(e){return{success:!1,payload:{error:e.message,code:e.code}}}}}},{package:"eth-trezor-keyring>trezor-connect"}],[5973,{"@babel/runtime/helpers/defineProperty":196,"@babel/runtime/helpers/interopRequireDefault":202,"@metamask/eth-sig-util":1130},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault")(e("@babel/runtime/helpers/defineProperty"));function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var o=e("@metamask/eth-sig-util");function s(e){switch(Object.prototype.toString.call(e)){case"[object Object]":var t=Object.keys(e).map((function(t){return[t,s(e[t])]}));return Object.fromEntries(t);case"[object Array]":return e.map((function(e){return s(e)}));case"[object BigInt]":return e.toString();default:return e}}t.exports=function(e,t){if(!t)throw new Error("Trezor: Only version 4 of typed data signing is supported");var r=o.SignTypedDataVersion.V4,a=o.TypedDataUtils.sanitizeData(e),c=a.types,l=a.primaryType,u=a.domain,d=a.message;return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({domain_separator_hash:o.TypedDataUtils.hashStruct("EIP712Domain",s(u),c,r).toString("hex"),message_hash:o.TypedDataUtils.hashStruct(l,s(d),c,r).toString("hex")},e)}}}},{package:"eth-trezor-keyring>trezor-connect"}],[5974,{"../constants/iframe":5959,"../constants/popup":5962,"../constants/ui":5964,"../env/browser/networkUtils":5967,"../utils/deferred":5998,"./showPopupRequest":5975,"@babel/runtime/helpers/assertThisInitialized":191,"@babel/runtime/helpers/asyncToGenerator":192,"@babel/runtime/helpers/defineProperty":196,"@babel/runtime/helpers/inheritsLoose":201,"@babel/runtime/helpers/interopRequireDefault":202,"@babel/runtime/regenerator":222,events:2133},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");r.__esModule=!0,r.default=void 0;var i=n(e("@babel/runtime/regenerator")),o=n(e("@babel/runtime/helpers/asyncToGenerator")),s=n(e("@babel/runtime/helpers/assertThisInitialized")),a=n(e("@babel/runtime/helpers/inheritsLoose")),c=n(e("@babel/runtime/helpers/defineProperty")),l=n(e("events")),u=b(e("../constants/popup")),d=b(e("../constants/iframe")),h=b(e("../constants/ui")),p=e("./showPopupRequest"),f=e("../env/browser/networkUtils"),g=e("../utils/deferred");function m(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(m=function(e){return e?r:t})(e)}function b(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=m(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}var y=function(e){function t(t){var r;return r=e.call(this)||this,(0,c.default)((0,s.default)(r),"requestTimeout",0),(0,c.default)((0,s.default)(r),"closeInterval",0),(0,c.default)((0,s.default)(r),"extensionTabId",0),r.settings=t,r.origin=(0,f.getOrigin)(t.popupSrc),r.handleMessage=r.handleMessage.bind((0,s.default)(r)),r.iframeHandshake=(0,g.create)(d.LOADED),"webextension"===r.settings.env&&(r.handleExtensionConnect=r.handleExtensionConnect.bind((0,s.default)(r)),r.handleExtensionMessage=r.handleExtensionMessage.bind((0,s.default)(r)),chrome.runtime.onConnect.addListener(r.handleExtensionConnect)),window.addEventListener("message",r.handleMessage,!1),r}(0,a.default)(t,e);var r=t.prototype;return r.request=function(e){var t=this;if(void 0===e&&(e=!1),this.locked)this._window&&("webextension"===this.settings.env?chrome.tabs.update(this._window.id,{active:!0}):this._window.focus());else{var r=this.open.bind(this);if(this.locked=!0,this.settings.supportedBrowser){var n=e||"webextension"===this.settings.env?1:850;this.requestTimeout=window.setTimeout((function(){t.requestTimeout=0,r(e)}),n)}else r()}},r.cancel=function(){this.close()},r.unlock=function(){this.locked=!1},r.open=function(e){var t=this,r=this.settings.popupSrc;this.settings.supportedBrowser?(this.popupPromise=(0,g.create)(u.LOADED),this.openWrapper(e?r+"#loading":r),this.closeInterval=window.setInterval((function(){t._window&&("webextension"===t.settings.env?chrome.tabs.get(t._window.id,(function(e){e||(t.close(),t.emit(u.CLOSED))})):t._window.closed&&(t.close(),t.emit(u.CLOSED)))}),500),this.openTimeout=window.setTimeout((function(){t.close(),(0,p.showPopupRequest)(t.open.bind(t),(function(){t.emit(u.CLOSED)}))}),3e3)):this.openWrapper(r+"#unsupported")},r.openWrapper=function(e){var t=this;"webextension"===this.settings.env?chrome.windows.getCurrent(null,(function(r){"normal"!==r.type?chrome.windows.create({url:e},(function(e){chrome.tabs.query({windowId:e.id,active:!0},(function(e){t._window=e[0]}))})):chrome.tabs.query({currentWindow:!0,active:!0},(function(r){t.extensionTabId=r[0].id,chrome.tabs.create({url:e,index:r[0].index+1},(function(e){t._window=e}))}))})):"electron"===this.settings.env?this._window=window.open(e,"modal"):(this._window=window.open("","_blank"),this._window&&(this._window.location.href=e))},r.handleExtensionConnect=function(e){"trezor-connect"===e.name&&(!this._window||this._window&&this._window.id!==e.sender.tab.id?e.disconnect():(window.clearTimeout(this.openTimeout),this.extensionPort=e,this.extensionPort.onMessage.addListener(this.handleExtensionMessage)))},r.handleExtensionMessage=function(e){var t=this;if(this.extensionPort){var r=this.extensionPort,n=e.data;if(n&&"object"==typeof n)if(n.type===u.ERROR){var i=n.payload&&"string"==typeof n.payload.error?n.payload.error:null;this.emit(u.CLOSED,i?"Popup error: "+i:null),this.close()}else n.type===u.LOADED?(this.popupPromise&&this.popupPromise.resolve(),this.iframeHandshake.promise.then((function(e){r.postMessage({type:u.INIT,payload:{settings:t.settings,useBroadcastChannel:e}})}))):n.type===u.EXTENSION_USB_PERMISSIONS?chrome.tabs.query({currentWindow:!0,active:!0},(function(e){chrome.tabs.create({url:"trezor-usb-permissions.html",index:e[0].index+1},(function(e){}))})):n.type===u.CLOSE_WINDOW&&(this.emit(u.CLOSED),this.close())}},r.handleMessage=function(e){var t=this,r=e.data;if((0,f.getOrigin)(e.origin)===this.origin&&r&&"object"==typeof r)if(r.type===d.LOADED){var n=!(!r.payload||"boolean"!=typeof r.payload.useBroadcastChannel)&&r.payload.useBroadcastChannel;this.iframeHandshake.resolve(n)}else if(r.type===u.BOOTSTRAP)window.clearTimeout(this.openTimeout);else if(r.type===u.ERROR&&this._window){var i=r.payload&&"string"==typeof r.payload.error?r.payload.error:null;this.emit(u.CLOSED,i?"Popup error: "+i:null),this.close()}else r.type===u.LOADED?(this.popupPromise&&this.popupPromise.resolve(),this.iframeHandshake.promise.then((function(e){t._window.postMessage({type:u.INIT,payload:{settings:t.settings,useBroadcastChannel:e}},t.origin)}))):r.type!==u.CANCEL_POPUP_REQUEST&&r.type!==h.CLOSE_UI_WINDOW||this.close()},r.close=function(){if(this.locked=!1,this.popupPromise=undefined,this.requestTimeout&&(window.clearTimeout(this.requestTimeout),this.requestTimeout=0),this.openTimeout&&(window.clearTimeout(this.openTimeout),this.openTimeout=0),this.closeInterval&&(window.clearInterval(this.closeInterval),this.closeInterval=0),this.extensionPort&&(this.extensionPort.disconnect(),this.extensionPort=null),this.extensionTabId&&(chrome.tabs.update(this.extensionTabId,{active:!0}),this.extensionTabId=0),this._window){if("webextension"===this.settings.env){chrome.runtime.lastError;chrome.tabs.remove(this._window.id,(function(){chrome.runtime.lastError}))}else this._window.close();this._window=null}},r.postMessage=function(){var e=(0,o.default)(i.default.mark((function e(t){var r=this;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._window||t.type===h.REQUEST_UI_WINDOW||!this.openTimeout){e.next=4;break}return this.close(),(0,p.showPopupRequest)(this.open.bind(this),(function(){r.emit(u.CLOSED)})),e.abrupt("return");case 4:if(!this.popupPromise){e.next=7;break}return e.next=7,this.popupPromise.promise;case 7:this._window&&this._window.postMessage(t,this.origin);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t}(l.default);r.default=y}}},{package:"eth-trezor-keyring>trezor-connect"}],[5975,{},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.showPopupRequest=void 0;var n="TrezorConnectInteractionLayer",i='\n    <div class="trezorconnect-container" id="'+n+'">\n        <div class="trezorconnect-window">\n            <div class="trezorconnect-head">\n                <svg class="trezorconnect-logo" x="0px" y="0px" viewBox="0 0 163.7 41.9" width="78px" height="20px" preserveAspectRatio="xMinYMin meet">\n                    <polygon points="101.1,12.8 118.2,12.8 118.2,17.3 108.9,29.9 118.2,29.9 118.2,35.2 101.1,35.2 101.1,30.7 110.4,18.1 101.1,18.1"/>\n                    <path d="M158.8,26.9c2.1-0.8,4.3-2.9,4.3-6.6c0-4.5-3.1-7.4-7.7-7.4h-10.5v22.3h5.8v-7.5h2.2l4.1,7.5h6.7L158.8,26.9z M154.7,22.5 h-4V18h4c1.5,0,2.5,0.9,2.5,2.2C157.2,21.6,156.2,22.5,154.7,22.5z"/>\n                    <path d="M130.8,12.5c-6.8,0-11.6,4.9-11.6,11.5s4.9,11.5,11.6,11.5s11.7-4.9,11.7-11.5S137.6,12.5,130.8,12.5z M130.8,30.3 c-3.4,0-5.7-2.6-5.7-6.3c0-3.8,2.3-6.3,5.7-6.3c3.4,0,5.8,2.6,5.8,6.3C136.6,27.7,134.2,30.3,130.8,30.3z"/>\n                    <polygon points="82.1,12.8 98.3,12.8 98.3,18 87.9,18 87.9,21.3 98,21.3 98,26.4 87.9,26.4 87.9,30 98.3,30 98.3,35.2 82.1,35.2 "/>\n                    <path d="M24.6,9.7C24.6,4.4,20,0,14.4,0S4.2,4.4,4.2,9.7v3.1H0v22.3h0l14.4,6.7l14.4-6.7h0V12.9h-4.2V9.7z M9.4,9.7 c0-2.5,2.2-4.5,5-4.5s5,2,5,4.5v3.1H9.4V9.7z M23,31.5l-8.6,4l-8.6-4V18.1H23V31.5z"/>\n                    <path d="M79.4,20.3c0-4.5-3.1-7.4-7.7-7.4H61.2v22.3H67v-7.5h2.2l4.1,7.5H80l-4.9-8.3C77.2,26.1,79.4,24,79.4,20.3z M71,22.5h-4V18 h4c1.5,0,2.5,0.9,2.5,2.2C73.5,21.6,72.5,22.5,71,22.5z"/>\n                    <polygon points="40.5,12.8 58.6,12.8 58.6,18.1 52.4,18.1 52.4,35.2 46.6,35.2 46.6,18.1 40.5,18.1 "/>\n                </svg>\n                <div class="trezorconnect-close">\n                    <svg x="0px" y="0px" viewBox="24 24 60 60" width="24px" height="24px" preserveAspectRatio="xMinYMin meet">\n                        <polygon class="st0" points="40,67.9 42.1,70 55,57.1 67.9,70 70,67.9 57.1,55 70,42.1 67.9,40 55,52.9 42.1,40 40,42.1 52.9,55 "/>\n                    </svg>\n                </div>\n            </div>\n            <div class="trezorconnect-body">\n                <h3>Popup was blocked</h3>\n                <p>Please click to âContinueâ to open popup manually</p>\n                <button class="trezorconnect-open">Continue</button>\n            </div>\n        </div>\n    </div>\n';r.showPopupRequest=function(e,t){if(!document.getElementById(n)){var r=document.createElement("div");r.id=n,r.className="trezorconnect-container",r.innerHTML=i,document.body&&document.body.appendChild(r),r.getElementsByClassName("trezorconnect-open")[0].onclick=function(){e(),document.body&&document.body.removeChild(r)},r.getElementsByClassName("trezorconnect-close")[0].onclick=function(){t(),document.body&&document.body.removeChild(r)}}}}}},{package:"eth-trezor-keyring>trezor-connect"}],[5976,{},function(){with(this)return function(){"use strict";return function(e,t,r){}}},{package:"eth-trezor-keyring>trezor-connect"}],[5977,{"../constants":5960,"./account":5976,"./backend/blockchain":5978,"./events":5980,"./misc":5982,"./networks/binance":5983,"./networks/bitcoin":5984,"./networks/cardano":5985,"./networks/coinInfo":5986,"./networks/eos":5987,"./networks/ethereum":5988,"./networks/nem":5989,"./networks/ripple":5990,"./networks/stellar":5991,"./networks/tezos":5992,"./params":5993,"./trezor/device":5994,"./trezor/management":5995,"./trezor/protobuf":5996},function(){with(this)return function(){"use strict";return function(e,t,r){i(e("../constants")),i(e("./params")),i(e("./trezor/device")),i(e("./trezor/management")),i(e("./trezor/protobuf")),i(e("./account")),i(e("./networks/bitcoin")),i(e("./networks/binance")),i(e("./networks/cardano")),i(e("./networks/coinInfo")),i(e("./networks/eos")),i(e("./networks/ethereum")),i(e("./networks/nem")),i(e("./networks/ripple")),i(e("./networks/stellar")),i(e("./networks/tezos")),i(e("./misc")),i(e("./events")),i(e("./backend/blockchain"));function n(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(n=function(e){return e?r:t})(e)}function i(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=n(t);if(r&&r.has(e))return r.get(e);var i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var a=o?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(i,s,a):i[s]=e[s]}return i.default=e,r&&r.set(e,i),i}}}},{package:"eth-trezor-keyring>trezor-connect"}],[5978,{"../../constants":5960},function(){with(this)return function(){"use strict";return function(e,t,r){e("../../constants")}}},{package:"eth-trezor-keyring>trezor-connect"}],[5979,{},function(){with(this)return function(){"use strict";return function(e,t,r){}}},{package:"eth-trezor-keyring>trezor-connect"}],[5980,{"../constants":5960},function(){with(this)return function(){"use strict";return function(e,t,r){e("../constants")}}},{package:"eth-trezor-keyring>trezor-connect"}],[5981,{"./account":5976,"./api":5977,"./backend/blockchain":5978,"./backend/transactions":5979,"./events":5980,"./misc":5982,"./networks/binance":5983,"./networks/bitcoin":5984,"./networks/cardano":5985,"./networks/coinInfo":5986,"./networks/eos":5987,"./networks/ethereum":5988,"./networks/nem":5989,"./networks/ripple":5990,"./networks/stellar":5991,"./networks/tezos":5992,"./params":5993,"./trezor/device":5994,"./trezor/management":5995},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0;var n=e("./api");Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===n[e]||(r[e]=n[e]))}));var i=e("./events");Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===i[e]||(r[e]=i[e]))}));var o=e("./misc");Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===o[e]||(r[e]=o[e]))}));var s=e("./params");Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===s[e]||(r[e]=s[e]))}));var a=e("./account");Object.keys(a).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===a[e]||(r[e]=a[e]))}));var c=e("./trezor/device");Object.keys(c).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===c[e]||(r[e]=c[e]))}));var l=e("./trezor/management");Object.keys(l).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===l[e]||(r[e]=l[e]))}));var u=e("./networks/bitcoin");Object.keys(u).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===u[e]||(r[e]=u[e]))}));var d=e("./networks/binance");Object.keys(d).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===d[e]||(r[e]=d[e]))}));var h=e("./networks/cardano");Object.keys(h).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===h[e]||(r[e]=h[e]))}));var p=e("./networks/coinInfo");Object.keys(p).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===p[e]||(r[e]=p[e]))}));var f=e("./networks/eos");Object.keys(f).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===f[e]||(r[e]=f[e]))}));var g=e("./networks/ethereum");Object.keys(g).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===g[e]||(r[e]=g[e]))}));var m=e("./networks/nem");Object.keys(m).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===m[e]||(r[e]=m[e]))}));var b=e("./networks/ripple");Object.keys(b).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===b[e]||(r[e]=b[e]))}));var y=e("./networks/stellar");Object.keys(y).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===y[e]||(r[e]=y[e]))}));var v=e("./networks/tezos");Object.keys(v).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===v[e]||(r[e]=v[e]))}));var E=e("./backend/blockchain");Object.keys(E).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===E[e]||(r[e]=E[e]))}));var w=e("./backend/transactions");Object.keys(w).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===w[e]||(r[e]=w[e]))}))}}},{package:"eth-trezor-keyring>trezor-connect"}],[5982,{},function(){with(this)return function(){"use strict";return function(e,t,r){}}},{package:"eth-trezor-keyring>trezor-connect"}],[5983,{},function(){with(this)return function(){"use strict";return function(e,t,r){}}},{package:"eth-trezor-keyring>trezor-connect"}],[5984,{},function(){with(this)return function(){"use strict";return function(e,t,r){}}},{package:"eth-trezor-keyring>trezor-connect"}],[5985,{"../trezor/protobuf":5996},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.CardanoTxWitnessType=r.CardanoTxSigningMode=r.CardanoPoolRelayType=r.CardanoNativeScriptHashDisplayFormat=r.CardanoNativeScriptType=r.CardanoCertificateType=r.CardanoAddressType=void 0;var n=e("../trezor/protobuf");r.CardanoAddressType=n.Enum_CardanoAddressType,r.CardanoCertificateType=n.Enum_CardanoCertificateType,r.CardanoNativeScriptType=n.Enum_CardanoNativeScriptType,r.CardanoNativeScriptHashDisplayFormat=n.Enum_CardanoNativeScriptHashDisplayFormat,r.CardanoPoolRelayType=n.Enum_CardanoPoolRelayType,r.CardanoTxSigningMode=n.Enum_CardanoTxSigningMode,r.CardanoTxWitnessType=n.Enum_CardanoTxWitnessType}}},{package:"eth-trezor-keyring>trezor-connect"}],[5986,{},function(){with(this)return function(){"use strict";return function(e,t,r){}}},{package:"eth-trezor-keyring>trezor-connect"}],[5987,{},function(){with(this)return function(){"use strict";return function(e,t,r){}}},{package:"eth-trezor-keyring>trezor-connect"}],[5988,{},function(){with(this)return function(){"use strict";return function(e,t,r){}}},{package:"eth-trezor-keyring>trezor-connect"}],[5989,{},function(){with(this)return function(){"use strict";return function(e,t,r){}}},{package:"eth-trezor-keyring>trezor-connect"}],[5990,{},function(){with(this)return function(){"use strict";return function(e,t,r){}}},{package:"eth-trezor-keyring>trezor-connect"}],[5991,{},function(){with(this)return function(){"use strict";return function(e,t,r){}}},{package:"eth-trezor-keyring>trezor-connect"}],[5992,{},function(){with(this)return function(){"use strict";return function(e,t,r){}}},{package:"eth-trezor-keyring>trezor-connect"}],[5993,{},function(){with(this)return function(){"use strict";return function(e,t,r){}}},{package:"eth-trezor-keyring>trezor-connect"}],[5994,{"../../constants":5960},function(){with(this)return function(){"use strict";return function(e,t,r){e("../../constants")}}},{package:"eth-trezor-keyring>trezor-connect"}],[5995,{},function(){with(this)return function(){"use strict";return function(e,t,r){}}},{package:"eth-trezor-keyring>trezor-connect"}],[5996,{},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.Enum_TezosBallotType=r.Enum_TezosContractType=r.Enum_StellarSignerType=r.Enum_StellarMemoType=r.Enum_StellarAssetType=r.Enum_NEMImportanceTransferMode=r.Enum_NEMModificationType=r.Enum_NEMSupplyChangeType=r.Enum_NEMMosaicLevy=r.Enum_WordRequestType=r.Enum_RecoveryDeviceType=r.Enum_SdProtectOperationType=r.Enum_Capability=r.Enum_SafetyCheckLevel=r.Enum_BackupType=r.Enum_EthereumDataType=r.Enum_PinMatrixRequestType=r.Enum_ButtonRequestType=r.Enum_FailureType=r.Enum_CardanoTxWitnessType=r.Enum_CardanoTxSigningMode=r.Enum_CardanoTxAuxiliaryDataSupplementType=r.Enum_CardanoPoolRelayType=r.Enum_CardanoCertificateType=r.Enum_CardanoNativeScriptHashDisplayFormat=r.Enum_CardanoNativeScriptType=r.Enum_CardanoAddressType=r.Enum_CardanoDerivationType=r.Enum_RequestType=r.Enum_AmountUnit=r.Enum_DecredStakingSpendType=r.Enum_OutputScriptType=r.Enum_InputScriptType=r.Enum_BinanceTimeInForce=r.Enum_BinanceOrderSide=r.Enum_BinanceOrderType=void 0;var n=Object.freeze({OT_UNKNOWN:0,MARKET:1,LIMIT:2,OT_RESERVED:3});r.Enum_BinanceOrderType=n;var i=Object.freeze({SIDE_UNKNOWN:0,BUY:1,SELL:2});r.Enum_BinanceOrderSide=i;var o=Object.freeze({TIF_UNKNOWN:0,GTE:1,TIF_RESERVED:2,IOC:3});r.Enum_BinanceTimeInForce=o;var s=Object.freeze({SPENDADDRESS:0,SPENDMULTISIG:1,EXTERNAL:2,SPENDWITNESS:3,SPENDP2SHWITNESS:4,SPENDTAPROOT:5});r.Enum_InputScriptType=s;var a=Object.freeze({PAYTOADDRESS:0,PAYTOSCRIPTHASH:1,PAYTOMULTISIG:2,PAYTOOPRETURN:3,PAYTOWITNESS:4,PAYTOP2SHWITNESS:5,PAYTOTAPROOT:6});r.Enum_OutputScriptType=a;var c=Object.freeze({SSGen:0,SSRTX:1});r.Enum_DecredStakingSpendType=c;var l=Object.freeze({BITCOIN:0,MILLIBITCOIN:1,MICROBITCOIN:2,SATOSHI:3});r.Enum_AmountUnit=l;var u=Object.freeze({TXINPUT:0,TXOUTPUT:1,TXMETA:2,TXFINISHED:3,TXEXTRADATA:4,TXORIGINPUT:5,TXORIGOUTPUT:6});r.Enum_RequestType=u;var d=Object.freeze({LEDGER:0,ICARUS:1,ICARUS_TREZOR:2});r.Enum_CardanoDerivationType=d;var h=Object.freeze({BASE:0,BASE_SCRIPT_KEY:1,BASE_KEY_SCRIPT:2,BASE_SCRIPT_SCRIPT:3,POINTER:4,POINTER_SCRIPT:5,ENTERPRISE:6,ENTERPRISE_SCRIPT:7,BYRON:8,REWARD:14,REWARD_SCRIPT:15});r.Enum_CardanoAddressType=h;var p=Object.freeze({PUB_KEY:0,ALL:1,ANY:2,N_OF_K:3,INVALID_BEFORE:4,INVALID_HEREAFTER:5});r.Enum_CardanoNativeScriptType=p;var f=Object.freeze({HIDE:0,BECH32:1,POLICY_ID:2});r.Enum_CardanoNativeScriptHashDisplayFormat=f;var g=Object.freeze({STAKE_REGISTRATION:0,STAKE_DEREGISTRATION:1,STAKE_DELEGATION:2,STAKE_POOL_REGISTRATION:3});r.Enum_CardanoCertificateType=g;var m=Object.freeze({SINGLE_HOST_IP:0,SINGLE_HOST_NAME:1,MULTIPLE_HOST_NAME:2});r.Enum_CardanoPoolRelayType=m;var b=Object.freeze({NONE:0,CATALYST_REGISTRATION_SIGNATURE:1});r.Enum_CardanoTxAuxiliaryDataSupplementType=b;var y=Object.freeze({ORDINARY_TRANSACTION:0,POOL_REGISTRATION_AS_OWNER:1,MULTISIG_TRANSACTION:2});r.Enum_CardanoTxSigningMode=y;var v=Object.freeze({BYRON_WITNESS:0,SHELLEY_WITNESS:1});r.Enum_CardanoTxWitnessType=v;var E=Object.freeze({Failure_UnexpectedMessage:1,Failure_ButtonExpected:2,Failure_DataError:3,Failure_ActionCancelled:4,Failure_PinExpected:5,Failure_PinCancelled:6,Failure_PinInvalid:7,Failure_InvalidSignature:8,Failure_ProcessError:9,Failure_NotEnoughFunds:10,Failure_NotInitialized:11,Failure_PinMismatch:12,Failure_WipeCodeMismatch:13,Failure_InvalidSession:14,Failure_FirmwareError:99});r.Enum_FailureType=E;var w=Object.freeze({ButtonRequest_Other:1,ButtonRequest_FeeOverThreshold:2,ButtonRequest_ConfirmOutput:3,ButtonRequest_ResetDevice:4,ButtonRequest_ConfirmWord:5,ButtonRequest_WipeDevice:6,ButtonRequest_ProtectCall:7,ButtonRequest_SignTx:8,ButtonRequest_FirmwareCheck:9,ButtonRequest_Address:10,ButtonRequest_PublicKey:11,ButtonRequest_MnemonicWordCount:12,ButtonRequest_MnemonicInput:13,_Deprecated_ButtonRequest_PassphraseType:14,ButtonRequest_UnknownDerivationPath:15,ButtonRequest_RecoveryHomepage:16,ButtonRequest_Success:17,ButtonRequest_Warning:18,ButtonRequest_PassphraseEntry:19,ButtonRequest_PinEntry:20});r.Enum_ButtonRequestType=w;var _=Object.freeze({PinMatrixRequestType_Current:1,PinMatrixRequestType_NewFirst:2,PinMatrixRequestType_NewSecond:3,PinMatrixRequestType_WipeCodeFirst:4,PinMatrixRequestType_WipeCodeSecond:5});r.Enum_PinMatrixRequestType=_;var S=Object.freeze({UINT:1,INT:2,BYTES:3,STRING:4,BOOL:5,ADDRESS:6,ARRAY:7,STRUCT:8});r.Enum_EthereumDataType=S;var C=Object.freeze({Bip39:0,Slip39_Basic:1,Slip39_Advanced:2});r.Enum_BackupType=C;var k=Object.freeze({Strict:0,PromptAlways:1,PromptTemporarily:2});r.Enum_SafetyCheckLevel=k;var T=Object.freeze({Capability_Bitcoin:1,Capability_Bitcoin_like:2,Capability_Binance:3,Capability_Cardano:4,Capability_Crypto:5,Capability_EOS:6,Capability_Ethereum:7,Capability_Lisk:8,Capability_Monero:9,Capability_NEM:10,Capability_Ripple:11,Capability_Stellar:12,Capability_Tezos:13,Capability_U2F:14,Capability_Shamir:15,Capability_ShamirGroups:16,Capability_PassphraseEntry:17});r.Enum_Capability=T;var M=Object.freeze({DISABLE:0,ENABLE:1,REFRESH:2});r.Enum_SdProtectOperationType=M;var O=Object.freeze({RecoveryDeviceType_ScrambledWords:0,RecoveryDeviceType_Matrix:1});r.Enum_RecoveryDeviceType=O;var P=Object.freeze({WordRequestType_Plain:0,WordRequestType_Matrix9:1,WordRequestType_Matrix6:2});r.Enum_WordRequestType=P;var R=Object.freeze({MosaicLevy_Absolute:1,MosaicLevy_Percentile:2});r.Enum_NEMMosaicLevy=R;var A=Object.freeze({SupplyChange_Increase:1,SupplyChange_Decrease:2});r.Enum_NEMSupplyChangeType=A;var I=Object.freeze({CosignatoryModification_Add:1,CosignatoryModification_Delete:2});r.Enum_NEMModificationType=I;var N=Object.freeze({ImportanceTransfer_Activate:1,ImportanceTransfer_Deactivate:2});r.Enum_NEMImportanceTransferMode=N;var D=Object.freeze({NATIVE:0,ALPHANUM4:1,ALPHANUM12:2});r.Enum_StellarAssetType=D;var x=Object.freeze({NONE:0,TEXT:1,ID:2,HASH:3,RETURN:4});r.Enum_StellarMemoType=x;var U=Object.freeze({ACCOUNT:0,PRE_AUTH:1,HASH:2});r.Enum_StellarSignerType=U;var L=Object.freeze({Implicit:0,Originated:1});r.Enum_TezosContractType=L;var j=Object.freeze({Yay:0,Nay:1,Pass:2});r.Enum_TezosBallotType=j}}},{package:"eth-trezor-keyring>trezor-connect"}],[5997,{},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.getLog=r.enableLogByPrefix=r.enableLog=r.initLog=void 0;var n={DescriptorStream:"color: #77ab59",DeviceList:"color: #36802d",Device:"color: #bada55",Core:"color: #c9df8a",IFrame:"color: #FFFFFF; background: #f4a742;",Popup:"color: #f48a00"},i=function(){function e(e,t){this.prefix=e,this.enabled=t,this.messages=[],this.css=n[e]||"color: #000000; background: #FFFFFF;"}var t=e.prototype;return t.addMessage=function(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];this.messages.push({level:e,prefix:t,message:n,timestamp:(new Date).getTime()}),this.messages.length>100&&this.messages.shift()},t.log=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n;(this.addMessage.apply(this,["log",this.prefix].concat(t)),this.enabled)&&(n=console).log.apply(n,[this.prefix].concat(t))},t.error=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n;(this.addMessage.apply(this,["error",this.prefix].concat(t)),this.enabled)&&(n=console).error.apply(n,[this.prefix].concat(t))},t.warn=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n;(this.addMessage.apply(this,["warn",this.prefix].concat(t)),this.enabled)&&(n=console).warn.apply(n,[this.prefix].concat(t))},t.debug=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n;(this.addMessage.apply(this,["debug",this.prefix].concat(t)),this.enabled)&&(n=console).log.apply(n,["%c"+this.prefix,this.css].concat(t))},e}(),o={};r.initLog=function(e,t){var r=new i(e,!!t);return o[e]=r,r};r.enableLog=function(e){Object.keys(o).forEach((function(t){o[t].enabled=e}))};r.enableLogByPrefix=function(e,t){o[e]&&(o[e].enabled=t)};r.getLog=function(){var e=[];return Object.keys(o).forEach((function(t){e=e.concat(o[t].messages)})),e.sort((function(e,t){return e.timestamp-t.timestamp})),e}}}},{package:"eth-trezor-keyring>trezor-connect"}],[5998,{"@babel/runtime/helpers/asyncToGenerator":192,"@babel/runtime/helpers/interopRequireDefault":202,"@babel/runtime/regenerator":222},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");r.__esModule=!0,r.create=function(e,t){var r,n=function(e){},s=function(e){},a=new Promise(function(){var t=(0,o.default)(i.default.mark((function t(o,a){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=o,s=a,"function"!=typeof e){t.next=11;break}return t.prev=3,t.next=6,e();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(3),a(t.t0);case 11:"string"==typeof e&&(r=e);case 12:case"end":return t.stop()}}),t,null,[[3,8]])})));return function(e,r){return t.apply(this,arguments)}}());return{id:r,device:t,resolve:n,reject:s,promise:a}},r.createAsync=function(e){var t=function(e){},r=function(e){},n=new Promise((function(e,n){t=e,r=n})),s=function(){var t=(0,o.default)(i.default.mark((function t(){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e();case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return{resolve:t,reject:r,promise:n,run:function(){return s(),n}}},r.resolveTimeoutPromise=function(e,t){return new Promise((function(r){setTimeout((function(){r(t)}),e)}))},r.rejectTimeoutPromise=void 0;var i=n(e("@babel/runtime/regenerator")),o=n(e("@babel/runtime/helpers/asyncToGenerator"));r.rejectTimeoutPromise=function(e,t){return new Promise((function(r,n){setTimeout((function(){n(t)}),e)}))}}}},{package:"eth-trezor-keyring>trezor-connect"}],[5999,{},function(){with(this)return function(){"use strict";return function(e,t,r){r.__esModule=!0,r.default=void 0;var n=function(e,t,r){var n=e||".trezor-webusb-button",i=document.querySelectorAll(n),o=t+"?"+Date.now();i.forEach((function(e){if(e.getElementsByTagName("iframe").length<1){var t=e.getBoundingClientRect(),n=document.createElement("iframe");n.frameBorder="0",n.width=Math.round(t.width)+"px",n.height=Math.round(t.height)+"px",n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.zIndex="1",n.setAttribute("allow","usb"),n.setAttribute("scrolling","no"),n.onload=function(){n.contentWindow.postMessage({},r)},n.src=o,e.append(n)}}))};r.default=n}}},{package:"eth-trezor-keyring>trezor-connect"}],[6,{"../../../shared/constants/alerts":6185,"@babel/runtime/helpers/defineProperty":196,"@babel/runtime/helpers/interopRequireDefault":202,"@metamask/obs-store":1206},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),o=e("@metamask/obs-store"),s=e("../../../shared/constants/alerts");function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const l={alertEnabledness:s.TOGGLEABLE_ALERT_TYPES.reduce(((e,t)=>(e[t]=!0,e)),{}),unconnectedAccountAlertShownOrigins:{},web3ShimUsageOrigins:{}};r.default=class{constructor(e={}){const{initState:t={},preferencesStore:r}=e,n=c(c({},l),{},{alertEnabledness:c(c({},l.alertEnabledness),t.alertEnabledness)});this.store=new o.ObservableStore(n),this.selectedAddress=r.getState().selectedAddress,r.subscribe((({selectedAddress:e})=>{this.store.getState().unconnectedAccountAlertShownOrigins&&this.selectedAddress!==e&&(this.selectedAddress=e,this.store.updateState({unconnectedAccountAlertShownOrigins:{}}))}))}setAlertEnabledness(e,t){let{alertEnabledness:r}=this.store.getState();r=c({},r),r[e]=t,this.store.updateState({alertEnabledness:r})}setUnconnectedAccountAlertShown(e){let{unconnectedAccountAlertShownOrigins:t}=this.store.getState();t=c({},t),t[e]=!0,this.store.updateState({unconnectedAccountAlertShownOrigins:t})}getWeb3ShimUsageState(e){return this.store.getState().web3ShimUsageOrigins[e]}setWeb3ShimUsageRecorded(e){this._setWeb3ShimUsageState(e,s.WEB3_SHIM_USAGE_ALERT_STATES.RECORDED)}setWeb3ShimUsageAlertDismissed(e){this._setWeb3ShimUsageState(e,s.WEB3_SHIM_USAGE_ALERT_STATES.DISMISSED)}_setWeb3ShimUsageState(e,t){let{web3ShimUsageOrigins:r}=this.store.getState();r=c({},r),r[e]=t,this.store.updateState({web3ShimUsageOrigins:r})}}}}},{package:"$root$"}],[60,{"./util":84,"@babel/runtime/helpers/interopRequireDefault":202,loglevel:5198,"webextension-polyfill":6161},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("webextension-polyfill")),o=n(e("loglevel")),s=e("./util");r.default=class{constructor(){this.isSupported=Boolean(i.default.storage.local),this.isSupported||o.default.error("Storage local API not available.")}async get(){if(!this.isSupported)return undefined;const e=await this._get();return t=e,0===Object.keys(t).length?undefined:e;var t}async set(e){return this._set(e)}_get(){const{local:e}=i.default.storage;return new Promise(((t,r)=>{e.get(null).then((e=>{const n=(0,s.checkForError)();n?r(n):t(e)}))}))}_set(e){const{local:t}=i.default.storage;return new Promise(((r,n)=>{t.set(e).then((()=>{const e=(0,s.checkForError)();e?n(e):r()}))}))}}}}},{package:"$root$"}],[6e3,{"./lib/truncate":6001,"utf8-byte-length/browser":6017},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./lib/truncate"),i=e("utf8-byte-length/browser");t.exports=n.bind(null,i)}}},{package:"3box>ipfs>libp2p-keychain>sanitize-filename>truncate-utf8-bytes"}],[6001,{},function(){with(this)return function(){"use strict";return function(e,t,r){function n(e){return e>=55296&&e<=56319}function i(e){return e>=56320&&e<=57343}t.exports=function(e,t,r){if("string"!=typeof t)throw new Error("Input must be string");for(var o,s,a=t.length,c=0,l=0;l<a;l+=1){if(o=t.charCodeAt(l),s=t[l],n(o)&&i(t.charCodeAt(l+1))&&(s+=t[l+=1]),(c+=e(s))===r)return t.slice(0,l+1);if(c>r)return t.slice(0,l-s.length+1)}return t}}}},{package:"3box>ipfs>libp2p-keychain>sanitize-filename>truncate-utf8-bytes"}],[6005,{buffer:2132,"is-typedarray":4755},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("is-typedarray").strict;t.exports=function(e){if(n(e)){var t=r.from(e.buffer);return e.byteLength!==e.buffer.byteLength&&(t=t.slice(e.byteOffset,e.byteOffset+e.byteLength)),t}return r.from(e)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"stylelint>write-file-atomic>typedarray-to-buffer"}],[6006,{},function(){with(this)return function(){"use strict";return function(e,t,r){!function(e,n){"object"==typeof r&&void 0!==t?n(r):"function"==typeof define&&define.amd?define(["exports"],n):n((e=e||self).typical={})}(this,(function(e){function t(e){return!isNaN(parseFloat(e))&&isFinite(e)}function r(e){return null!==e&&"object"==typeof e&&e.constructor===Object}function n(e){return i(e)&&"number"==typeof e.length}function i(e){return"object"==typeof e&&null!==e}function o(e){return void 0!==e}function s(e){return"function"==typeof e&&/^class /.test(Function.prototype.toString.call(e))}function a(e){if(null===e)return!0;switch(typeof e){case"string":case"number":case"symbol":case"undefined":case"boolean":return!0;default:return!1}}function c(e){if(e){const t=o(Promise)&&e instanceof Promise,r=e.then&&"function"==typeof e.then;return!(!t&&!r)}return!1}function l(e){return!(null===e||!o(e))&&("function"==typeof e[Symbol.iterator]||"function"==typeof e[Symbol.asyncIterator])}function u(e){return"string"==typeof e}function d(e){return"function"==typeof e}var h={isNumber:t,isPlainObject:r,isArrayLike:n,isObject:i,isDefined:o,isClass:s,isPrimitive:a,isPromise:c,isIterable:l,isString:u,isFunction:d};e.default=h,e.isArrayLike=n,e.isClass=s,e.isDefined=o,e.isFunction=d,e.isIterable=l,e.isNumber=t,e.isObject=i,e.isPlainObject=r,e.isPrimitive=a,e.isPromise=c,e.isString=u,Object.defineProperty(e,"__esModule",{value:!0})}))}}},{package:"3box>ipfs>ipld>typical"}],[6009,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e,t){var r=[],n={};if("function"!=typeof t){var i=t;t=function(e){return e[i]}}return e.forEach((function(e){var i=t(e);n[i]||(n[i]=!0,r.push(e))})),r}}}},{package:"3box>ipfs>peer-info>unique-by"}],[6010,{"./pad-string":6011,buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("buffer"),i=e("./pad-string");function o(e,t){return void 0===t&&(t="utf8"),n.Buffer.isBuffer(e)?a(e.toString("base64")):a(n.Buffer.from(e,t).toString("base64"))}function s(e){return e=e.toString(),i.default(e).replace(/\-/g,"+").replace(/_/g,"/")}function a(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}var c=o;c.encode=o,c.decode=function(e,t){return void 0===t&&(t="utf8"),n.Buffer.from(s(e),"base64").toString(t)},c.toBase64=s,c.fromBase64=a,c.toBuffer=function(e){return n.Buffer.from(s(e),"base64")},r.default=c}}},{package:"3box>did-jwt>uport-base64url"}],[6011,{buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("buffer");r.default=function(e){var t=e.length,r=t%4;if(!r)return e;var i=t,o=4-r,s=t+o,a=n.Buffer.alloc(s);for(a.write(e);o--;)a.write("=",i++);return a.toString()}}}},{package:"3box>did-jwt>uport-base64url"}],[6012,{"./dist/base64url":6010},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e("./dist/base64url").default,t.exports.default=t.exports}}},{package:"3box>did-jwt>uport-base64url"}],[6017,{},function(){with(this)return function(){"use strict";return function(e,t,r){function n(e){return e>=55296&&e<=56319}function i(e){return e>=56320&&e<=57343}t.exports=function(e){if("string"!=typeof e)throw new Error("Input must be string");for(var t=e.length,r=0,o=null,s=null,a=0;a<t;a++)i(o=e.charCodeAt(a))?null!=s&&n(s)?r+=1:r+=3:o<=127?r+=1:o>=128&&o<=2047?r+=2:o>=2048&&o<=65535&&(r+=3),s=o;return r}}}},{package:"3box>ipfs>libp2p-keychain>sanitize-filename>truncate-utf8-bytes>utf8-byte-length"}],[6039,{"../../is-buffer/index.js":4735,varint:6042},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const n=e("varint");t.exports=e=>{if(!r.isBuffer(e))throw new Error("arg needs to be a buffer");let t=[];for(;e.length>0;){const r=n.decode(e);t.push(r),e=e.slice(n.decode.bytes)}return t}}).call(this)}).call(this,{isBuffer:e("../../is-buffer/index.js")})}}},{package:"3box>ipfs>ipfs-bitswap>varint-decoder"}],[6040,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function e(t,r){var n,i=0,o=0,s=r=r||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[s++],i+=o<28?(127&n)<<o:(127&n)*Math.pow(2,o),o+=7}while(n>=128);return e.bytes=s-r,i}}}},{package:"3box>ipfs>varint"}],[6041,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function e(t,r,i){r=r||[];var o=i=i||0;for(;t>=n;)r[i++]=255&t|128,t/=128;for(;-128&t;)r[i++]=255&t|128,t>>>=7;return r[i]=0|t,e.bytes=i-o+1,r};var n=Math.pow(2,31)}}},{package:"3box>ipfs>varint"}],[6042,{"./decode.js":6040,"./encode.js":6041,"./length.js":6043},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={encode:e("./encode.js"),decode:e("./decode.js"),encodingLength:e("./length.js")}}}},{package:"3box>ipfs>varint"}],[6043,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n=Math.pow(2,7),i=Math.pow(2,14),o=Math.pow(2,21),s=Math.pow(2,28),a=Math.pow(2,35),c=Math.pow(2,42),l=Math.pow(2,49),u=Math.pow(2,56),d=Math.pow(2,63);t.exports=function(e){return e<n?1:e<i?2:e<o?3:e<s?4:e<a?5:e<c?6:e<l?7:e<u?8:e<d?9:10}}}},{package:"3box>ipfs>varint"}],[6046,{util:2138},function(){with(this)return function(){"use strict";return function(e,t,r){r.TextEncoder="undefined"!=typeof TextEncoder?TextEncoder:e("util").TextEncoder,r.TextDecoder="undefined"!=typeof TextDecoder?TextDecoder:e("util").TextDecoder}}},{package:"@ensdomains/content-hash>multihashes>web-encoding"}],[61,{"../../../shared/constants/app":6186,"../../../shared/constants/metametrics":6190,"../../../shared/modules/random-id":6206,"../metamask-controller":85,"@babel/runtime/helpers/interopRequireDefault":202,"@metamask/obs-store":1206,buffer:2132,"eth-rpc-errors":2489,"ethereumjs-util":2564,events:2133},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,r.normalizeMsgData=p;var i=n(e("events")),o=e("@metamask/obs-store"),s=e("ethereumjs-util"),a=e("eth-rpc-errors"),c=e("../../../shared/constants/app"),l=e("../metamask-controller"),u=n(e("../../../shared/modules/random-id")),d=e("../../../shared/constants/metametrics");class h extends i.default{constructor({metricsEvent:e}){super(),this.memStore=new o.ObservableStore({unapprovedMsgs:{},unapprovedMsgCount:0}),this.messages=[],this.metricsEvent=e}get unapprovedMsgCount(){return Object.keys(this.getUnapprovedMsgs()).length}getUnapprovedMsgs(){return this.messages.filter((e=>"unapproved"===e.status)).reduce(((e,t)=>(e[t.id]=t,e)),{})}async addUnapprovedMessageAsync(e,t){const r=this.addUnapprovedMessage(e,t);return await new Promise(((t,n)=>{this.once(`${r}:finished`,(r=>{switch(r.status){case"signed":return t(r.rawSig);case"rejected":return n(a.ethErrors.provider.userRejectedRequest("MetaMask Message Signature: User denied message signature."));case"errored":return n(new Error(`MetaMask Message Signature: ${r.error}`));default:return n(new Error(`MetaMask Message Signature: Unknown problem: ${JSON.stringify(e)}`))}}))}))}addUnapprovedMessage(e,t){t&&(e.origin=t.origin),e.data=p(e.data);const r=(new Date).getTime(),n=(0,u.default)(),i={id:n,msgParams:e,time:r,status:"unapproved",type:c.MESSAGE_TYPE.ETH_SIGN};return this.addMsg(i),this.emit("update"),n}addMsg(e){this.messages.push(e),this._saveMsgList()}getMsg(e){return this.messages.find((t=>t.id===e))}approveMessage(e){return this.setMsgStatusApproved(e.metamaskId),this.prepMsgForSigning(e)}setMsgStatusApproved(e){this._setMsgStatus(e,"approved")}setMsgStatusSigned(e,t){const r=this.getMsg(e);r.rawSig=t,this._updateMsg(r),this._setMsgStatus(e,"signed")}prepMsgForSigning(e){return delete e.metamaskId,Promise.resolve(e)}rejectMsg(e,t=undefined){if(t){const r=this.getMsg(e);this.metricsEvent({event:t,category:d.EVENT.CATEGORIES.TRANSACTIONS,properties:{action:"Sign Request",type:r.type}})}this._setMsgStatus(e,"rejected")}errorMessage(e,t){const r=this.getMsg(e);r.error=t,this._updateMsg(r),this._setMsgStatus(e,"errored")}clearUnapproved(){this.messages=this.messages.filter((e=>"unapproved"!==e.status)),this._saveMsgList()}_setMsgStatus(e,t){const r=this.getMsg(e);if(!r)throw new Error(`MessageManager - Message not found for id: "${e}".`);r.status=t,this._updateMsg(r),this.emit(`${e}:${t}`,r),"rejected"!==t&&"signed"!==t||this.emit(`${e}:finished`,r)}_updateMsg(e){const t=this.messages.findIndex((t=>t.id===e.id));-1!==t&&(this.messages[t]=e),this._saveMsgList()}_saveMsgList(){const e=this.getUnapprovedMsgs(),t=Object.keys(e).length;this.memStore.updateState({unapprovedMsgs:e,unapprovedMsgCount:t}),this.emit(l.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE)}}function p(e){return"0x"===e.slice(0,2)?e:(0,s.bufferToHex)(t.from(e,"utf8"))}r.default=h}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"$root$"}],[6162,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n,i;self.mozRTCPeerConnection||navigator.mozGetUserMedia?(n="moz",i=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1],10)):(self.webkitRTCPeerConnection||navigator.webkitGetUserMedia)&&(n="webkit",i=navigator.userAgent.match(/Chrom(e|ium)/)&&parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2],10));var o=self.RTCPeerConnection||self.mozRTCPeerConnection||self.webkitRTCPeerConnection,s=self.mozRTCIceCandidate||self.RTCIceCandidate,a=self.mozRTCSessionDescription||self.RTCSessionDescription,c=self.webkitMediaStream||self.MediaStream,l="https:"===self.location.protocol&&("webkit"===n&&i>=26||"moz"===n&&i>=33),u=self.AudioContext||self.webkitAudioContext,d=self.document&&document.createElement("video"),h=d&&d.canPlayType&&"probably"===d.canPlayType('video/webm; codecs="vp8", vorbis'),p=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia;t.exports={prefix:n,browserVersion:i,support:!!o&&!!p,supportRTCPeerConnection:!!o,supportVp8:h,supportGetUserMedia:!!p,supportDataChannel:!!(o&&o.prototype&&o.prototype.createDataChannel),supportWebAudio:!(!u||!u.prototype.createMediaStreamSource),supportMediaStream:!(!c||!c.prototype.removeTrack),supportScreenSharing:!!l,AudioContext:u,PeerConnection:o,SessionDescription:a,IceCandidate:s,MediaStream:c,getUserMedia:p}}}},{package:"3box>ipfs>libp2p-webrtc-star>webrtcsupport"}],[6172,{buffer:2132},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e){(function(){function r(t,r){if(t.length!==r.length)throw new Error("Inputs should have the same length");for(var n=e.allocUnsafe(t.length),i=0;i<t.length;i++)n[i]=t[i]^r[i];return n}t.exports=r,r.compare=function(e,t){if(e.length!==t.length)throw new Error("Inputs should have the same length");for(var r=0;r<e.length;r++)if(e[r]!==t[r])return e[r]<t[r]?-1:1;return 0},r.gt=function(e,t){return 1===r.compare(e,t)},r.lt=function(e,t){return-1===r.compare(e,t)},r.eq=function(e,t){return 0===r.compare(e,t)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-kad-dht>xor-distance"}],[6174,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)n.call(r,i)&&(e[i]=r[i])}return e};var n=Object.prototype.hasOwnProperty}}},{package:"watchify>xtend"}],[6177,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),o={},s=0,a=0;function c(e){var t="";do{t=i[e%64]+t,e=Math.floor(e/64)}while(e>0);return t}function l(){var e=c(+new Date);return e!==n?(s=0,n=e):e+"."+c(s++)}for(;a<64;a++)o[i[a]]=a;l.encode=c,l.decode=function(e){var t=0;for(a=0;a<e.length;a++)t=64*t+o[e.charAt(a)];return t},t.exports=l}}},{package:"3box>ipfs>libp2p-webrtc-star>socket.io-client>engine.io-client>yeast"}],[6193,{"./time":6195},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FALLBACK_SMART_TRANSACTIONS_REFRESH_TIME=r.FALLBACK_SMART_TRANSACTIONS_MAX_FEE_MULTIPLIER=r.FALLBACK_SMART_TRANSACTIONS_DEADLINE=void 0;const n=10*e("./time").SECOND;r.FALLBACK_SMART_TRANSACTIONS_REFRESH_TIME=n;r.FALLBACK_SMART_TRANSACTIONS_DEADLINE=180;r.FALLBACK_SMART_TRANSACTIONS_MAX_FEE_MULTIPLIER=2}}},{package:"$root$"}],[63,{"@babel/runtime/helpers/interopRequireDefault":202,events:2133},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("events"));class o extends i.default{constructor(e={}){super();const t=e.migrations||[];this.migrations=t.sort(((e,t)=>e.version-t.version));const r=this.migrations.slice(-1)[0];this.defaultVersion=e.defaultVersion||r&&r.version||0}async migrateData(e=this.generateInitialState()){const t=this.migrations.filter((function(t){return t.version>e.meta.version}));for(const r of t)try{const t=await r.migrate(e);if(!t.data)throw new Error("Migrator - migration returned empty data");if(t.version!==undefined&&t.meta.version!==r.version)throw new Error("Migrator - Migration did not update version number correctly");e=t}catch(t){const n=t.message;return t.message=`MetaMask Migration Error #${r.version}: ${n}`,this.emit("error",t),e}return e}generateInitialState(e){return{meta:{version:this.defaultVersion},data:e}}}r.default=o}}},{package:"$root$"}],[64,{"../../../shared/constants/time":6195,"../../../shared/modules/fetch-with-timeout":6200,"@babel/runtime/helpers/defineProperty":196,"@babel/runtime/helpers/interopRequireDefault":202,loglevel:5198},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),o=n(e("loglevel")),s=e("../../../shared/constants/time");const a=(0,n(e("../../../shared/modules/fetch-with-timeout")).default)(30*s.SECOND);r.default=class{constructor(){(0,i.default)(this,"isSupported",!0),this._initialized=!1,this._initializing=this._init(),this._state=undefined}async _init(){try{const e=await a("http://localhost:12345/state.json");e.ok&&(this._state=await e.json())}catch(e){o.default.debug(`Error loading network state: '${e.message}'`)}finally{this._initialized=!0}}async get(){return this._initialized||await this._initializing,this._state}async set(e){this._initialized||await this._initializing,this._state=e}}}}},{package:"$root$"}],[65,{"../platforms/extension":160,"@babel/runtime/helpers/interopRequireDefault":202,"safe-event-emitter":5749},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.NOTIFICATION_MANAGER_EVENTS=void 0;var i=n(e("safe-event-emitter")),o=n(e("../platforms/extension"));const s={POPUP_CLOSED:"onPopupClosed"};r.NOTIFICATION_MANAGER_EVENTS=s;class a extends i.default{constructor(){super(),this.platform=new o.default,this.platform.addOnRemovedListener(this._onWindowClosed.bind(this))}markAsAutomaticallyClosed(){this._popupAutomaticallyClosed=!0}async showPopup(){const e=await this._getPopup();if(e)await this.platform.focusWindow(e.id);else{let e=0,t=0;try{const r=await this.platform.getLastFocusedWindow();t=r.top,e=r.left+(r.width-360)}catch(r){const{screenX:n,screenY:i,outerWidth:o}=window;t=Math.max(i,0),e=Math.max(n+(o-360),0)}const r=await this.platform.openWindow({url:"notification.html",type:"popup",width:360,height:620,left:e,top:t});r.left!==e&&"fullscreen"!==r.state&&await this.platform.updateWindowPosition(r.id,e,t),this._popupId=r.id}}_onWindowClosed(e){e===this._popupId&&(this._popupId=undefined,this.emit(s.POPUP_CLOSED,{automaticallyClosed:this._popupAutomaticallyClosed}),this._popupAutomaticallyClosed=undefined)}async _getPopup(){const e=await this.platform.getAllWindows();return this._getPopupIn(e)}_getPopupIn(e){return e?e.find((e=>e&&"popup"===e.type&&e.id===this._popupId)):null}}r.default=a}}},{package:"$root$"}],[66,{"../../../shared/constants/app":6186,"../../../shared/constants/metametrics":6190,"../../../shared/modules/random-id":6206,"../metamask-controller":85,"./util":84,"@babel/runtime/helpers/interopRequireDefault":202,"@metamask/obs-store":1206,buffer:2132,"eth-rpc-errors":2489,"ethereumjs-util":2564,events:2133,loglevel:5198},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("events")),o=e("@metamask/obs-store"),s=e("ethereumjs-util"),a=e("eth-rpc-errors"),c=n(e("loglevel")),l=e("../../../shared/constants/app"),u=e("../metamask-controller"),d=n(e("../../../shared/modules/random-id")),h=e("../../../shared/constants/metametrics"),p=e("./util");const f=/^[0-9A-Fa-f]+$/gu;class g extends i.default{constructor({metricsEvent:e}){super(),this.memStore=new o.ObservableStore({unapprovedPersonalMsgs:{},unapprovedPersonalMsgCount:0}),this.messages=[],this.metricsEvent=e}get unapprovedPersonalMsgCount(){return Object.keys(this.getUnapprovedMsgs()).length}getUnapprovedMsgs(){return this.messages.filter((e=>"unapproved"===e.status)).reduce(((e,t)=>(e[t.id]=t,e)),{})}addUnapprovedMessageAsync(e,t){return new Promise(((r,n)=>{if(!e.from)return void n(new Error("MetaMask Message Signature: from field is required."));const i=this.addUnapprovedMessage(e,t);this.once(`${i}:finished`,(t=>{switch(t.status){case"signed":return void r(t.rawSig);case"rejected":return void n(a.ethErrors.provider.userRejectedRequest("MetaMask Message Signature: User denied message signature."));case"errored":return void n(new Error(`MetaMask Message Signature: ${t.error}`));default:n(new Error(`MetaMask Message Signature: Unknown problem: ${JSON.stringify(e)}`))}}))}))}addUnapprovedMessage(e,t){c.default.debug(`PersonalMessageManager addUnapprovedMessage: ${JSON.stringify(e)}`),t&&(e.origin=t.origin),e.data=this.normalizeMsgData(e.data);const r=(new Date).getTime(),n=(0,d.default)(),i={id:n,msgParams:e,time:r,status:"unapproved",type:l.MESSAGE_TYPE.PERSONAL_SIGN};return this.addMsg(i),this.emit("update"),n}addMsg(e){this.messages.push(e),this._saveMsgList()}getMsg(e){return this.messages.find((t=>t.id===e))}approveMessage(e){return this.setMsgStatusApproved(e.metamaskId),this.prepMsgForSigning(e)}setMsgStatusApproved(e){this._setMsgStatus(e,"approved")}setMsgStatusSigned(e,t){const r=this.getMsg(e);r.rawSig=t,this._updateMsg(r),this._setMsgStatus(e,"signed")}prepMsgForSigning(e){return delete e.metamaskId,Promise.resolve(e)}rejectMsg(e,t=undefined){if(t){const r=this.getMsg(e);this.metricsEvent({event:t,category:h.EVENT.CATEGORIES.TRANSACTIONS,properties:{action:"Sign Request",type:r.type}})}this._setMsgStatus(e,"rejected")}errorMessage(e,t){const r=this.getMsg(e);r.error=t,this._updateMsg(r),this._setMsgStatus(e,"errored")}clearUnapproved(){this.messages=this.messages.filter((e=>"unapproved"!==e.status)),this._saveMsgList()}_setMsgStatus(e,t){const r=this.getMsg(e);if(!r)throw new Error(`PersonalMessageManager - Message not found for id: "${e}".`);r.status=t,this._updateMsg(r),this.emit(`${e}:${t}`,r),"rejected"!==t&&"signed"!==t||this.emit(`${e}:finished`,r)}_updateMsg(e){const t=this.messages.findIndex((t=>t.id===e.id));-1!==t&&(this.messages[t]=e),this._saveMsgList()}_saveMsgList(){const e=this.getUnapprovedMsgs(),t=Object.keys(e).length;this.memStore.updateState({unapprovedPersonalMsgs:e,unapprovedPersonalMsgCount:t}),this.emit(u.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE)}normalizeMsgData(e){try{const t=(0,s.stripHexPrefix)(e);if(t.match(f))return(0,p.addHexPrefix)(t)}catch(e){c.default.debug("Message was not hex encoded, interpreting as utf8.")}return(0,s.bufferToHex)(t.from(e,"utf8"))}}r.default=g}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"$root$"}],[67,{"../../../../shared/constants/network":6191,"./handlers":71,"@babel/runtime/helpers/interopRequireDefault":202,"@metamask/controllers":1063,"@metamask/rpc-methods":1226,"eth-rpc-errors":2489,lodash:5188},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.createMethodMiddleware=function(e){const t=d.filter((t=>!Object.hasOwnProperty.call(e,t)));if(t.length>0)throw new Error(`Missing expected hooks:\n\n${t.join("\n")}\n`);return async function(t,r,n,i){if(c.UNSUPPORTED_RPC_METHODS.has(t.method))return i(s.ethErrors.rpc.methodNotSupported());const a=u.get(t.method);if(a){const{implementation:s,hookNames:c}=a;try{return await s(t,r,n,i,(0,o.selectHooks)(e,c))}catch(e){return console.error(e),i(e)}}return n()}};var i=e("@metamask/controllers"),o=e("@metamask/rpc-methods"),s=e("eth-rpc-errors"),a=e("lodash"),c=e("../../../../shared/constants/network");const l=[...n(e("./handlers")).default,...i.permissionRpcMethods.handlers],u=l.reduce(((e,t)=>{for(const r of t.methodNames)e.set(r,t);return e}),new Map),d=Array.from(new Set((0,a.flatten)(l.map((({hookNames:e})=>Object.keys(e))))).values())}}},{package:"$root$"}],[68,{"../../../../../shared/constants/app":6186,"../../../../../shared/constants/metametrics":6190,"../../../../../shared/constants/network":6191,"../../../../../shared/modules/network.utils":6204,"../../../../../shared/modules/rpc.utils":6207,"@babel/runtime/helpers/interopRequireDefault":202,"eth-rpc-errors":2489,lodash:5188,"valid-url":6035},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("eth-rpc-errors"),o=n(e("valid-url")),s=e("lodash"),a=e("../../../../../shared/constants/app"),c=e("../../../../../shared/constants/metametrics"),l=e("../../../../../shared/modules/network.utils"),u=e("../../../../../shared/modules/rpc.utils"),d=e("../../../../../shared/constants/network");var h={methodNames:[a.MESSAGE_TYPE.ADD_ETHEREUM_CHAIN],implementation:async function(e,t,r,n,{addCustomRpc:h,getCurrentChainId:p,getCurrentRpcUrl:f,findCustomRpcBy:g,updateRpcTarget:m,requestUserApproval:b,sendMetrics:y}){var v;if(null===(v=e.params)||void 0===v||!v[0]||"object"!=typeof e.params[0])return n(i.ethErrors.rpc.invalidParams({message:`Expected single, object parameter. Received:\n${JSON.stringify(e.params)}`}));const{origin:E}=e,{chainId:w,chainName:_=null,blockExplorerUrls:S=null,nativeCurrency:C=null,rpcUrls:k}=e.params[0],T=Object.keys((0,s.omit)(e.params[0],["chainId","chainName","blockExplorerUrls","iconUrls","rpcUrls","nativeCurrency"]));if(T.length>0)return n(i.ethErrors.rpc.invalidParams({message:`Received unexpected keys on object parameter. Unsupported keys:\n${T}`}));const M=e=>{try{const t=new URL(e);return"localhost"===t.hostname||"127.0.0.1"===t.hostname}catch(e){return!1}},O=Array.isArray(k)?k.find((e=>M(e)||o.default.isHttpsUri(e))):null,P=null!==S&&Array.isArray(S)?S.find((e=>M(e)||o.default.isHttpsUri(e))):null;if(!O)return n(i.ethErrors.rpc.invalidParams({message:`Expected an array with at least one valid string HTTPS url 'rpcUrls', Received:\n${k}`}));if(null!==S&&!P)return n(i.ethErrors.rpc.invalidParams({message:`Expected null or array with at least one valid string HTTPS URL 'blockExplorerUrl'. Received: ${S}`}));const R="string"==typeof w&&w.toLowerCase();if(!(0,l.isPrefixedFormattedHexString)(R))return n(i.ethErrors.rpc.invalidParams({message:`Expected 0x-prefixed, unpadded, non-zero hexadecimal string 'chainId'. Received:\n${w}`}));if(!(0,l.isSafeChainId)(parseInt(R,16)))return n(i.ethErrors.rpc.invalidParams({message:`Invalid chain ID "${R}": numerical value greater than max safe value. Received:\n${w}`}));if(d.CHAIN_ID_TO_NETWORK_ID_MAP[R])return n(i.ethErrors.rpc.invalidParams({message:"May not specify default MetaMask chain."}));const A=g({chainId:R});if(A&&A.rpcUrl===O){t.result=null;const e=p(),r=f();if(e===R&&r===O)return n();try{await m(await b({origin:E,type:a.MESSAGE_TYPE.SWITCH_ETHEREUM_CHAIN,requestData:{rpcUrl:A.rpcUrl,chainId:A.chainId,nickname:A.nickname,ticker:A.ticker}})),t.result=null}catch(e){if(e.code!==i.errorCodes.provider.userRejectedRequest)return n(e)}return n()}let I;try{I=await(0,u.jsonRpcRequest)(O,"eth_chainId")}catch(e){return n(i.ethErrors.rpc.internal({message:`Request for method 'eth_chainId on ${O} failed`,data:{networkErr:e}}))}if(R!==I)return n(i.ethErrors.rpc.invalidParams({message:`Chain ID returned by RPC URL ${O} does not match ${R}`,data:{chainId:I}}));if("string"!=typeof _||!_)return n(i.ethErrors.rpc.invalidParams({message:`Expected non-empty string 'chainName'. Received:\n${_}`}));const N=_.length>100?_.substring(0,100):_;if(null!==C){if("object"!=typeof C||Array.isArray(C))return n(i.ethErrors.rpc.invalidParams({message:`Expected null or object 'nativeCurrency'. Received:\n${C}`}));if(18!==C.decimals)return n(i.ethErrors.rpc.invalidParams({message:`Expected the number 18 for 'nativeCurrency.decimals' when 'nativeCurrency' is provided. Received: ${C.decimals}`}));if(!C.symbol||"string"!=typeof C.symbol)return n(i.ethErrors.rpc.invalidParams({message:`Expected a string 'nativeCurrency.symbol'. Received: ${C.symbol}`}))}const D=(null==C?void 0:C.symbol)||a.UNKNOWN_TICKER_SYMBOL;if(D!==a.UNKNOWN_TICKER_SYMBOL&&("string"!=typeof D||D.length<2||D.length>6))return n(i.ethErrors.rpc.invalidParams({message:`Expected 2-6 character string 'nativeCurrency.symbol'. Received:\n${D}`}));if(A&&A.chainId===R&&A.ticker!==D)return n(i.ethErrors.rpc.invalidParams({message:`nativeCurrency.symbol does not match currency symbol for a network the user already has added with the same chainId. Received:\n${D}`}));try{await h(await b({origin:E,type:a.MESSAGE_TYPE.ADD_ETHEREUM_CHAIN,requestData:{chainId:R,blockExplorerUrl:P,chainName:N,rpcUrl:O,ticker:D}})),y({event:"Custom Network Added",category:c.EVENT.CATEGORIES.NETWORK,referrer:{url:E},sensitiveProperties:{chain_id:R,rpc_url:O,network_name:N,network:O,symbol:D,block_explorer_url:P,source:c.EVENT.SOURCE.TRANSACTION.DAPP}}),t.result=null}catch(e){return n(e)}try{await m(await b({origin:E,type:a.MESSAGE_TYPE.SWITCH_ETHEREUM_CHAIN,requestData:{rpcUrl:O,chainId:R,nickname:N,ticker:D}}))}catch(e){if(e.code!==i.errorCodes.provider.userRejectedRequest)return n(e)}return n()},hookNames:{addCustomRpc:!0,getCurrentChainId:!0,getCurrentRpcUrl:!0,findCustomRpcBy:!0,updateRpcTarget:!0,requestUserApproval:!0,sendMetrics:!0}};r.default=h}}},{package:"$root$"}],[69,{"../../../../../shared/constants/app":6186},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n={methodNames:[e("../../../../../shared/constants/app").MESSAGE_TYPE.ETH_ACCOUNTS],implementation:async function(e,t,r,n,{getAccounts:i}){return t.result=await i(),n()},hookNames:{getAccounts:!0}};r.default=n}}},{package:"$root$"}],[7,{"../../../shared/constants/time":6195,"../metamask-controller":85,"@babel/runtime/helpers/defineProperty":196,"@babel/runtime/helpers/interopRequireDefault":202,"@metamask/obs-store":1206,events:2133},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),o=n(e("events")),s=e("@metamask/obs-store"),a=e("../metamask-controller"),c=e("../../../shared/constants/time");function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class d extends o.default{constructor(e={}){const{addUnlockListener:t,isUnlocked:r,initState:n,onInactiveTimeout:i,showUnlockRequest:o,preferencesStore:a,qrHardwareStore:c}=e;super(),this.onInactiveTimeout=i||(()=>undefined),this.store=new s.ObservableStore(u(u({timeoutMinutes:0,connectedStatusPopoverHasBeenShown:!0,defaultHomeActiveTabName:null,browserEnvironment:{},popupGasPollTokens:[],notificationGasPollTokens:[],fullScreenGasPollTokens:[],recoveryPhraseReminderHasBeenShown:!1,recoveryPhraseReminderLastShown:(new Date).getTime(),collectiblesDetectionNoticeDismissed:!1,enableEIP1559V2NoticeDismissed:!1,showTestnetMessageInDropdown:!0,trezorModel:null},n),{},{qrHardware:{},collectiblesDropdownState:{}})),this.timer=null,this.isUnlocked=r,this.waitingForUnlock=[],t(this.handleUnlock.bind(this)),this._showUnlockRequest=o,a.subscribe((({preferences:e})=>{this.store.getState().timeoutMinutes!==e.autoLockTimeLimit&&this._setInactiveTimeout(e.autoLockTimeLimit)})),c.subscribe((e=>{this.store.updateState({qrHardware:e})}));const{preferences:l}=a.getState();this._setInactiveTimeout(l.autoLockTimeLimit)}getUnlockPromise(e){return new Promise((t=>{this.isUnlocked()?t():this.waitForUnlock(t,e)}))}waitForUnlock(e,t){this.waitingForUnlock.push({resolve:e}),this.emit(a.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE),t&&this._showUnlockRequest()}handleUnlock(){if(this.waitingForUnlock.length>0){for(;this.waitingForUnlock.length>0;)this.waitingForUnlock.shift().resolve();this.emit(a.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE)}}setDefaultHomeActiveTabName(e){this.store.updateState({defaultHomeActiveTabName:e})}setConnectedStatusPopoverHasBeenShown(){this.store.updateState({connectedStatusPopoverHasBeenShown:!0})}setRecoveryPhraseReminderHasBeenShown(){this.store.updateState({recoveryPhraseReminderHasBeenShown:!0})}setRecoveryPhraseReminderLastShown(e){this.store.updateState({recoveryPhraseReminderLastShown:e})}setLastActiveTime(){this._resetTimer()}_setInactiveTimeout(e){this.store.updateState({timeoutMinutes:e}),this._resetTimer()}_resetTimer(){const{timeoutMinutes:e}=this.store.getState();this.timer&&clearTimeout(this.timer),e&&(this.timer=setTimeout((()=>this.onInactiveTimeout()),e*c.MINUTE))}setBrowserEnvironment(e,t){this.store.updateState({browserEnvironment:{os:e,browser:t}})}addPollingToken(e,t){const r=this.store.getState()[t];this.store.updateState({[t]:[...r,e]})}removePollingToken(e,t){const r=this.store.getState()[t];this.store.updateState({[t]:r.filter((t=>t!==e))})}clearPollingTokens(){this.store.updateState({popupGasPollTokens:[],notificationGasPollTokens:[],fullScreenGasPollTokens:[]})}setShowTestnetMessageInDropdown(e){this.store.updateState({showTestnetMessageInDropdown:e})}setTrezorModel(e){this.store.updateState({trezorModel:e})}setCollectiblesDetectionNoticeDismissed(e){this.store.updateState({collectiblesDetectionNoticeDismissed:e})}setEnableEIP1559V2NoticeDismissed(e){this.store.updateState({enableEIP1559V2NoticeDismissed:e})}updateCollectibleDropDownState(e){this.store.updateState({collectiblesDropdownState:e})}}r.default=d}}},{package:"$root$"}],[70,{"../../../../../shared/constants/app":6186,"@babel/runtime/helpers/defineProperty":196,"@babel/runtime/helpers/interopRequireDefault":202},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty"));function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var a={methodNames:[e("../../../../../shared/constants/app").MESSAGE_TYPE.GET_PROVIDER_STATE],implementation:async function(e,t,r,n,{getProviderState:i}){return t.result=s({},await i(e.origin)),n()},hookNames:{getProviderState:!0}};r.default=a}}},{package:"$root$"}],[71,{"./add-ethereum-chain":68,"./eth-accounts":69,"./get-provider-state":70,"./log-web3-shim-usage":72,"./request-accounts":73,"./send-metadata":74,"./switch-ethereum-chain":75,"./watch-asset":76,"@babel/runtime/helpers/interopRequireDefault":202},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("./add-ethereum-chain")),o=n(e("./eth-accounts")),s=n(e("./get-provider-state")),a=n(e("./log-web3-shim-usage")),c=n(e("./request-accounts")),l=n(e("./send-metadata")),u=n(e("./switch-ethereum-chain")),d=n(e("./watch-asset"));var h=[i.default,o.default,s.default,a.default,c.default,l.default,u.default,d.default];r.default=h}}},{package:"$root$"}],[72,{"../../../../../shared/constants/app":6186,"../../../../../shared/constants/metametrics":6190},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("../../../../../shared/constants/app"),i=e("../../../../../shared/constants/metametrics");var o={methodNames:[n.MESSAGE_TYPE.LOG_WEB3_SHIM_USAGE],implementation:function(e,t,r,n,{sendMetrics:o,getWeb3ShimUsageState:s,setWeb3ShimUsageRecorded:a}){const{origin:c}=e;s(c)===undefined&&(a(c),o({event:"Website Accessed window.web3 Shim",category:i.EVENT.CATEGORIES.INPAGE_PROVIDER,referrer:{url:c}},{excludeMetaMetricsId:!0}));return t.result=!0,n()},hookNames:{sendMetrics:!0,getWeb3ShimUsageState:!0,setWeb3ShimUsageRecorded:!0}};r.default=o}}},{package:"$root$"}],[73,{"../../../../../shared/constants/app":6186,"eth-rpc-errors":2489},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("eth-rpc-errors"),i=e("../../../../../shared/constants/app");var o={methodNames:[i.MESSAGE_TYPE.ETH_REQUEST_ACCOUNTS],implementation:async function(e,t,r,o,{origin:a,getAccounts:c,getUnlockPromise:l,hasPermission:u,requestAccountsPermission:d}){if(s.has(a))return t.error=n.ethErrors.rpc.resourceUnavailable(`Already processing ${i.MESSAGE_TYPE.ETH_REQUEST_ACCOUNTS}. Please wait.`),o();if(u(i.MESSAGE_TYPE.ETH_ACCOUNTS)){try{s.add(a),await l(!0),t.result=await c(),o()}catch(e){o(e)}finally{s.delete(a)}return undefined}try{await d()}catch(e){return t.error=e,o()}const h=await c();h.length>0?t.result=h:t.error=n.ethErrors.rpc.internal("Accounts unexpectedly unavailable. Please report this bug.");return o()},hookNames:{origin:!0,getAccounts:!0,getUnlockPromise:!0,hasPermission:!0,requestAccountsPermission:!0}};r.default=o;const s=new Set}}},{package:"$root$"}],[74,{"../../../../../shared/constants/app":6186,"@babel/runtime/helpers/defineProperty":196,"@babel/runtime/helpers/interopRequireDefault":202,"@babel/runtime/helpers/objectWithoutProperties":211,"eth-rpc-errors":2489},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),o=n(e("@babel/runtime/helpers/objectWithoutProperties")),s=e("eth-rpc-errors"),a=e("../../../../../shared/constants/app");const c=["icon","name"];function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d={methodNames:[a.MESSAGE_TYPE.SEND_METADATA],implementation:function(e,t,r,n,{addSubjectMetadata:i,subjectType:a}){const{origin:l,params:d}=e;if(!d||"object"!=typeof d||Array.isArray(d))return n(s.ethErrors.rpc.invalidParams({data:d}));{const{icon:e=null,name:t=null}=d,r=(0,o.default)(d,c);i(u(u({},r),{},{iconUrl:e,name:t,subjectType:a,origin:l}))}return t.result=!0,n()},hookNames:{addSubjectMetadata:!0,subjectType:!0}};r.default=d}}},{package:"$root$"}],[75,{"../../../../../shared/constants/app":6186,"../../../../../shared/constants/network":6191,"../../../../../shared/modules/network.utils":6204,"eth-rpc-errors":2489,lodash:5188},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("eth-rpc-errors"),i=e("lodash"),o=e("../../../../../shared/constants/app"),s=e("../../../../../shared/constants/network"),a=e("../../../../../shared/modules/network.utils");var c={methodNames:[o.MESSAGE_TYPE.SWITCH_ETHEREUM_CHAIN],implementation:async function(e,t,r,c,{getCurrentChainId:l,findCustomRpcBy:u,setProviderType:d,updateRpcTarget:h,requestUserApproval:p}){var f;if(null===(f=e.params)||void 0===f||!f[0]||"object"!=typeof e.params[0])return c(n.ethErrors.rpc.invalidParams({message:`Expected single, object parameter. Received:\n${JSON.stringify(e.params)}`}));const{origin:g}=e,{chainId:m}=e.params[0],b=Object.keys((0,i.omit)(e.params[0],["chainId"]));if(b.length>0)return c(n.ethErrors.rpc.invalidParams({message:`Received unexpected keys on object parameter. Unsupported keys:\n${b}`}));const y="string"==typeof m&&m.toLowerCase();if(!(0,a.isPrefixedFormattedHexString)(y))return c(n.ethErrors.rpc.invalidParams({message:`Expected 0x-prefixed, unpadded, non-zero hexadecimal string 'chainId'. Received:\n${m}`}));if(!(0,a.isSafeChainId)(parseInt(y,16)))return c(n.ethErrors.rpc.invalidParams({message:`Invalid chain ID "${y}": numerical value greater than max safe value. Received:\n${m}`}));const v=function(e,t){if(e in s.CHAIN_ID_TO_TYPE_MAP)return{chainId:e,ticker:s.ETH_SYMBOL,nickname:s.NETWORK_TO_NAME_MAP[e],rpcUrl:s.CHAIN_ID_TO_RPC_URL_MAP[e],type:s.CHAIN_ID_TO_TYPE_MAP[e]};return t({chainId:e})}(y,u);if(v){if(l()===y)return t.result=null,c();try{const e=await p({origin:g,type:o.MESSAGE_TYPE.SWITCH_ETHEREUM_CHAIN,requestData:v});m in s.CHAIN_ID_TO_TYPE_MAP?d(e.type):await h(e),t.result=null}catch(e){return c(e)}return c()}return c(n.ethErrors.provider.custom({code:4902,message:`Unrecognized chain ID "${m}". Try adding the chain using ${o.MESSAGE_TYPE.ADD_ETHEREUM_CHAIN} first.`}))},hookNames:{getCurrentChainId:!0,findCustomRpcBy:!0,setProviderType:!0,updateRpcTarget:!0,requestUserApproval:!0}};r.default=c}}},{package:"$root$"}],[76,{"../../../../../shared/constants/app":6186,"eth-rpc-errors":2489},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("eth-rpc-errors"),i=e("../../../../../shared/constants/app");var o={methodNames:[i.MESSAGE_TYPE.WATCH_ASSET,i.MESSAGE_TYPE.WATCH_ASSET_LEGACY],implementation:async function(e,t,r,i,{handleWatchAssetRequest:o}){try{const{options:r,type:n}=e.params,s=await o(r,n);return await s.result,t.result=!0,i()}catch(e){return"User rejected to watch the asset."===e.message?i(n.ethErrors.provider.userRejectedRequest()):i(e)}},hookNames:{handleWatchAssetRequest:!0}};r.default=o}}},{package:"$root$"}],[77,{"./createMethodMiddleware":67},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./createMethodMiddleware");Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===n[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return n[e]}}))}))}}},{package:"$root$"}],[78,{"@babel/runtime/helpers/interopRequireDefault":202,"eth-keyring-controller":2472,loglevel:5198},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("eth-keyring-controller")),o=n(e("loglevel"));var s={async verifyAccounts(e,t){if(!e||e.length<1)throw new Error("No created accounts defined.");const r=new(new i.default({}).getKeyringClassForType("HD Key Tree"))({mnemonic:t,numberOfAccounts:e.length}),n=await r.getAccounts();if(o.default.debug(`Created accounts: ${JSON.stringify(e)}`),o.default.debug(`Restored accounts: ${JSON.stringify(n)}`),n.length!==e.length)throw new Error("Wrong number of accounts");for(let t=0;t<n.length;t++)if(n[t].toLowerCase()!==e[t].toLowerCase())throw new Error(`Not identical accounts! Original: ${e[t]}, Restored: ${n[t]}`)}};r.default=s}}},{package:"$root$"}],[79,{"../../../shared/constants/time":6195,"@babel/runtime/helpers/interopRequireDefault":202,_process:5430,"analytics-node":1782},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.segment=r.createSegmentMock=void 0;var i,o,s=n(e("analytics-node")),a=e("../../../shared/constants/time");const c=null!==(i="XdGJ17zKf3NjBPCDQ2UDjJjkx6FYBMGP")?i:null,l=null!==(o=t.env.SEGMENT_HOST)&&void 0!==o?o:null,u=undefined,d=5*a.SECOND,h=(e=u)=>{const t={queue:[],flush(){t.queue.forEach((([e,t])=>{t()})),t.queue=[]},track(r,n=(()=>undefined)){t.queue.push([r,n]),t.queue.length>=e&&t.flush()},page(){},identify(){}};return t};r.createSegmentMock=h;const p=c?new s.default(c,{host:l,flushAt:u,flushInterval:d}):h(u);r.segment=p}).call(this)}).call(this,e("_process"))}}},{package:"$root$"}],[8,{"@babel/runtime/helpers/defineProperty":196,"@babel/runtime/helpers/interopRequireDefault":202,"@metamask/obs-store":1206},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),o=e("@metamask/obs-store");function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}r.default=class{constructor(e={}){const{accountTracker:t,getCurrentChainId:r}=e;this.accountTracker=t,this.getCurrentChainId=r;const n=a({cachedBalances:{}},e.initState);this.store=new o.ObservableStore(n),this._registerUpdates()}async updateCachedBalances({accounts:e}){const t=this.getCurrentChainId(),r=await this._generateBalancesToCache(e,t);this.store.updateState({cachedBalances:r})}_generateBalancesToCache(e,t){const{cachedBalances:r}=this.store.getState(),n=a({},r[t]);Object.keys(e).forEach((t=>{const r=e[t];r.balance&&(n[t]=r.balance)}));return a(a({},r),{},{[t]:n})}clearCachedBalances(){this.store.updateState({cachedBalances:{}})}_registerUpdates(){const e=this.updateCachedBalances.bind(this);this.accountTracker.store.subscribe(e)}}}}},{package:"$root$"}],[83,{"../../../shared/constants/app":6186,"../../../shared/constants/metametrics":6190,"../../../shared/modules/hexstring-utils":6202,"../../../shared/modules/random-id":6206,"../metamask-controller":85,"@babel/runtime/helpers/interopRequireDefault":202,"@metamask/obs-store":1206,assert:1805,"eth-rpc-errors":2489,"eth-sig-util":2491,events:2133,jsonschema:4788,loglevel:5198},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("events")),o=e("assert"),s=e("@metamask/obs-store"),a=e("eth-rpc-errors"),c=e("eth-sig-util"),l=n(e("loglevel")),u=n(e("jsonschema")),d=e("../../../shared/constants/app"),h=e("../metamask-controller"),p=n(e("../../../shared/modules/random-id")),f=e("../../../shared/constants/metametrics"),g=e("../../../shared/modules/hexstring-utils");class m extends i.default{constructor({getCurrentChainId:e,metricsEvent:t}){super(),this._getCurrentChainId=e,this.memStore=new s.ObservableStore({unapprovedTypedMessages:{},unapprovedTypedMessagesCount:0}),this.messages=[],this.metricsEvent=t}get unapprovedTypedMessagesCount(){return Object.keys(this.getUnapprovedMsgs()).length}getUnapprovedMsgs(){return this.messages.filter((e=>"unapproved"===e.status)).reduce(((e,t)=>(e[t.id]=t,e)),{})}addUnapprovedMessageAsync(e,t,r){return new Promise(((n,i)=>{const o=this.addUnapprovedMessage(e,t,r);this.once(`${o}:finished`,(t=>{switch(t.status){case"signed":return n(t.rawSig);case"rejected":return i(a.ethErrors.provider.userRejectedRequest("MetaMask Message Signature: User denied message signature."));case"errored":return i(new Error(`MetaMask Message Signature: ${t.error}`));default:return i(new Error(`MetaMask Message Signature: Unknown problem: ${JSON.stringify(e)}`))}}))}))}addUnapprovedMessage(e,t,r){e.version=r,t&&(e.origin=t.origin),this.validateParams(e),l.default.debug(`TypedMessageManager addUnapprovedMessage: ${JSON.stringify(e)}`);const n=(new Date).getTime(),i=(0,p.default)(),o={id:i,msgParams:e,time:n,status:"unapproved",type:d.MESSAGE_TYPE.ETH_SIGN_TYPED_DATA};return this.addMsg(o),this.emit("update"),i}validateParams(e){switch(o.strict.ok(e&&"object"==typeof e,"Params must be an object."),o.strict.ok("data"in e,'Params must include a "data" field.'),o.strict.ok("from"in e,'Params must include a "from" field.'),o.strict.ok("string"==typeof e.from&&(0,g.isValidHexAddress)(e.from,{allowNonPrefixed:!1}),'"from" field must be a valid, lowercase, hexadecimal Ethereum address string.'),e.version){case"V1":o.strict.ok(Array.isArray(e.data),'"params.data" must be an array.'),o.strict.doesNotThrow((()=>{(0,c.typedSignatureHash)(e.data)}),"Signing data must be valid EIP-712 typed data.");break;case"V3":case"V4":{let t;o.strict.equal(typeof e.data,"string",'"params.data" must be a string.'),o.strict.doesNotThrow((()=>{t=JSON.parse(e.data)}),'"data" must be a valid JSON string.');const r=u.default.validate(t,c.TYPED_MESSAGE_SCHEMA);if(o.strict.ok(t.primaryType in t.types,`Primary type of "${t.primaryType}" has no type definition.`),0!==r.errors.length)throw a.ethErrors.rpc.invalidParams({message:"Signing data must conform to EIP-712 schema. See https://git.io/fNtcx.",data:r.errors.map((e=>e.message.toString()))});let{chainId:n}=t.domain;if(n){const e=parseInt(this._getCurrentChainId(),16);o.strict.ok(!Number.isNaN(e),`Cannot sign messages for chainId "${n}", because MetaMask is switching networks.`),"string"==typeof n&&(n=parseInt(n,n.startsWith("0x")?16:10)),o.strict.equal(n,e,`Provided chainId "${n}" must match the active chainId "${e}"`)}break}default:o.strict.fail(`Unknown typed data version "${e.version}"`)}}addMsg(e){this.messages.push(e),this._saveMsgList()}getMsg(e){return this.messages.find((t=>t.id===e))}approveMessage(e){return this.setMsgStatusApproved(e.metamaskId),this.prepMsgForSigning(e)}setMsgStatusApproved(e){this._setMsgStatus(e,"approved")}setMsgStatusSigned(e,t){const r=this.getMsg(e);r.rawSig=t,this._updateMsg(r),this._setMsgStatus(e,"signed")}prepMsgForSigning(e){return delete e.metamaskId,delete e.version,Promise.resolve(e)}rejectMsg(e,t=undefined){if(t){const r=this.getMsg(e);this.metricsEvent({event:t,category:f.EVENT.CATEGORIES.TRANSACTIONS,properties:{action:"Sign Request",version:r.msgParams.version,type:r.type}})}this._setMsgStatus(e,"rejected")}errorMessage(e,t){const r=this.getMsg(e);r.error=t,this._updateMsg(r),this._setMsgStatus(e,"errored")}clearUnapproved(){this.messages=this.messages.filter((e=>"unapproved"!==e.status)),this._saveMsgList()}_setMsgStatus(e,t){const r=this.getMsg(e);if(!r)throw new Error(`TypedMessageManager - Message not found for id: "${e}".`);r.status=t,this._updateMsg(r),this.emit(`${e}:${t}`,r),"rejected"!==t&&"signed"!==t&&"errored"!==t||this.emit(`${e}:finished`,r)}_updateMsg(e){const t=this.messages.findIndex((t=>t.id===e.id));-1!==t&&(this.messages[t]=e),this._saveMsgList()}_saveMsgList(){const e=this.getUnapprovedMsgs(),t=Object.keys(e).length;this.memStore.updateState({unapprovedTypedMessages:e,unapprovedTypedMessagesCount:t}),this.emit(h.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE)}}r.default=m}}},{package:"$root$"}],[85,{"../../shared/constants/app":6186,"../../shared/constants/hardware-wallets":6188,"../../shared/constants/metametrics":6190,"../../shared/constants/network":6191,"../../shared/constants/permissions":6192,"../../shared/constants/swaps":6194,"../../shared/constants/time":6195,"../../shared/constants/transaction":6196,"../../shared/modules/hexstring-utils":6202,"../../shared/modules/string-utils":6208,"../../shared/modules/transaction.utils":6210,"../../shared/notifications":6211,"../../ui/helpers/utils/conversions.util":6748,"../../ui/helpers/utils/token-util":6764,"./account-import-strategies":2,"./controllers/alert":6,"./controllers/app-state":7,"./controllers/cached-balances":8,"./controllers/detect-tokens":9,"./controllers/ens":11,"./controllers/incoming-transactions":12,"./controllers/metametrics":13,"./controllers/network":17,"./controllers/onboarding":21,"./controllers/permissions":25,"./controllers/preferences":29,"./controllers/swaps":30,"./controllers/threebox":31,"./controllers/transactions":32,"./detect-multiple-instances":38,"./lib/ComposableObservableStore":40,"./lib/account-tracker":41,"./lib/createLoggerMiddleware":44,"./lib/createMetaRPCHandler":45,"./lib/createOnboardingMiddleware":46,"./lib/createOriginMiddleware":47,"./lib/createRPCMethodTrackingMiddleware":48,"./lib/createTabIdMiddleware":50,"./lib/decrypt-message-manager":51,"./lib/encryption-public-key-manager":52,"./lib/message-manager":61,"./lib/personal-message-manager":66,"./lib/rpc-method-middleware":77,"./lib/seed-phrase-verifier":78,"./lib/segment":79,"./lib/stream-utils":82,"./lib/typed-message-manager":83,"@babel/runtime/helpers/defineProperty":196,"@babel/runtime/helpers/interopRequireDefault":202,"@keystonehq/metamask-airgapped-keyring":579,"@metamask/controllers":1063,"@metamask/eth-ledger-bridge-keyring":1121,"@metamask/obs-store":1206,"@metamask/obs-store/dist/asStream":1205,"@metamask/smart-transactions-controller":1325,"@sentry/browser":1585,_process:5430,"await-semaphore":1886,buffer:2132,"eth-json-rpc-filters":2421,"eth-json-rpc-filters/subscriptionManager":2427,"eth-json-rpc-middleware":2445,"eth-keyring-controller":2472,"eth-lattice-keyring":2473,"eth-query":2485,"eth-rpc-errors":2489,"eth-trezor-keyring":2504,"ethereumjs-util":2564,events:2133,"json-rpc-engine":4775,"json-rpc-middleware-stream/engineStream":4777,lodash:5188,loglevel:5198,nanoid:5273,pump:5529},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t,n){(function(){var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.METAMASK_CONTROLLER_EVENTS=void 0;var o=i(e("@babel/runtime/helpers/defineProperty")),s=i(e("events")),a=i(e("pump")),c=e("@metamask/obs-store"),l=e("@metamask/obs-store/dist/asStream"),u=e("json-rpc-engine"),d=e("lodash"),h=i(e("json-rpc-middleware-stream/engineStream")),p=i(e("eth-json-rpc-filters")),f=i(e("eth-json-rpc-filters/subscriptionManager")),g=e("eth-json-rpc-middleware"),m=i(e("eth-keyring-controller")),b=e("eth-rpc-errors"),y=e("await-semaphore"),v=e("ethereumjs-util"),E=i(e("loglevel")),w=i(e("eth-trezor-keyring")),_=i(e("@metamask/eth-ledger-bridge-keyring")),S=i(e("eth-lattice-keyring")),C=e("@keystonehq/metamask-airgapped-keyring"),k=i(e("eth-query")),T=i(e("nanoid")),M=e("@sentry/browser"),O=e("@metamask/controllers"),P=i(e("@metamask/smart-transactions-controller")),R=e("../../shared/constants/transaction"),A=e("../../shared/constants/swaps"),I=e("../../shared/constants/network"),N=e("../../shared/constants/hardware-wallets"),D=e("../../shared/constants/permissions"),x=e("../../shared/notifications"),U=e("../../shared/modules/hexstring-utils"),L=e("../../shared/constants/time"),j=e("../../shared/constants/app"),B=e("../../shared/constants/metametrics"),F=e("../../ui/helpers/utils/conversions.util"),z=e("../../ui/helpers/utils/token-util"),G=e("../../shared/modules/string-utils"),q=e("../../shared/modules/transaction.utils"),W=e("./detect-multiple-instances"),H=i(e("./lib/ComposableObservableStore")),V=i(e("./lib/account-tracker")),Q=i(e("./lib/createLoggerMiddleware")),K=e("./lib/rpc-method-middleware"),$=i(e("./lib/createOriginMiddleware")),Y=i(e("./lib/createTabIdMiddleware")),J=i(e("./lib/createOnboardingMiddleware")),Z=e("./lib/stream-utils"),X=i(e("./controllers/ens")),ee=Ce(e("./controllers/network")),te=i(e("./controllers/preferences")),re=i(e("./controllers/app-state")),ne=i(e("./controllers/cached-balances")),ie=i(e("./controllers/alert")),oe=i(e("./controllers/onboarding")),se=i(e("./controllers/threebox")),ae=i(e("./controllers/incoming-transactions")),ce=Ce(e("./lib/message-manager")),le=i(e("./lib/decrypt-message-manager")),ue=i(e("./lib/encryption-public-key-manager")),de=i(e("./lib/personal-message-manager")),he=i(e("./lib/typed-message-manager")),pe=i(e("./controllers/transactions")),fe=i(e("./controllers/detect-tokens")),ge=i(e("./controllers/swaps")),me=i(e("./account-import-strategies")),be=i(e("./lib/seed-phrase-verifier")),ye=i(e("./controllers/metametrics")),ve=e("./lib/segment"),Ee=i(e("./lib/createMetaRPCHandler")),we=e("./controllers/permissions"),_e=i(e("./lib/createRPCMethodTrackingMiddleware"));function Se(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(Se=function(e){return e?r:t})(e)}function Ce(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=Se(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function ke(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Te(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ke(Object(r),!0).forEach((function(t){(0,o.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ke(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}r.METAMASK_CONTROLLER_EVENTS={UPDATE_BADGE:"updateBadge",APPROVAL_STATE_CHANGE:"ApprovalController:stateChange"};class Me extends s.default{constructor(e){var r;super(),this.defaultMaxListeners=20,this.sendUpdate=(0,d.debounce)(this.privateSendUpdate.bind(this),200*L.MILLISECOND),this.opts=e,this.extension=e.browser,this.platform=e.platform,this.notificationManager=e.notificationManager;const n=e.initState||{},i=this.platform.getVersion();this.recordFirstTimeInfo(n),this.activeControllerConnections=0,this.getRequestAccountTabIds=e.getRequestAccountTabIds,this.getOpenMetamaskTabsIds=e.getOpenMetamaskTabsIds,this.controllerMessenger=new O.ControllerMessenger,this.store=new H.default({state:n,controllerMessenger:this.controllerMessenger,persist:!0}),this.connections={},this.createVaultMutex=new y.Mutex,this.extension.runtime.onInstalled.addListener((e=>{"update"===e.reason&&"8.1.0"===i&&this.platform.openExtensionInBrowser()})),this.approvalController=new O.ApprovalController({messenger:this.controllerMessenger.getRestricted({name:"ApprovalController"}),showApprovalRequest:e.showUserConfirmation}),this.networkController=new ee.default(n.NetworkController),this.networkController.setInfuraProjectId(e.infuraProjectId),this.initializeProvider(),this.provider=this.networkController.getProviderAndBlockTracker().provider,this.blockTracker=this.networkController.getProviderAndBlockTracker().blockTracker,this.preferencesController=new te.default({initState:n.PreferencesController,initLangCode:e.initLangCode,openPopup:e.openPopup,network:this.networkController,provider:this.provider,migrateAddressBookState:this.migrateAddressBookState.bind(this)}),this.tokensController=new O.TokensController({onPreferencesStateChange:this.preferencesController.store.subscribe.bind(this.preferencesController.store),onNetworkStateChange:this.networkController.store.subscribe.bind(this.networkController.store),config:{provider:this.provider},state:n.TokensController}),this.assetsContractController=new O.AssetsContractController({onPreferencesStateChange:e=>this.preferencesController.store.subscribe(e)},{provider:this.provider}),this.collectiblesController=new O.CollectiblesController({onPreferencesStateChange:this.preferencesController.store.subscribe.bind(this.preferencesController.store),onNetworkStateChange:this.networkController.store.subscribe.bind(this.networkController.store),getERC721AssetName:this.assetsContractController.getERC721AssetName.bind(this.assetsContractController),getERC721AssetSymbol:this.assetsContractController.getERC721AssetSymbol.bind(this.assetsContractController),getERC721TokenURI:this.assetsContractController.getERC721TokenURI.bind(this.assetsContractController),getERC721OwnerOf:this.assetsContractController.getERC721OwnerOf.bind(this.assetsContractController),getERC1155BalanceOf:this.assetsContractController.getERC1155BalanceOf.bind(this.assetsContractController),getERC1155TokenURI:this.assetsContractController.getERC1155TokenURI.bind(this.assetsContractController)},{},n.CollectiblesController),this.collectiblesController.setApiKey(t.env.OPENSEA_KEY),this.metaMetricsController=new ye.default({segment:ve.segment,preferencesStore:this.preferencesController.store,onNetworkDidChange:this.networkController.on.bind(this.networkController,ee.NETWORK_EVENTS.NETWORK_DID_CHANGE),getNetworkIdentifier:this.networkController.getNetworkIdentifier.bind(this.networkController),getCurrentChainId:this.networkController.getCurrentChainId.bind(this.networkController),version:this.platform.getVersion(),environment:"production",initState:n.MetaMetricsController,captureException:M.captureException}),this.on("update",(e=>{this.metaMetricsController.handleMetaMaskStateUpdate(e)}));const o=this.controllerMessenger.getRestricted({name:"GasFeeController"}),s=A.GAS_API_BASE_URL;this.gasFeeController=new O.GasFeeController({interval:1e4,messenger:o,clientId:A.SWAPS_CLIENT_ID,getProvider:()=>this.networkController.getProviderAndBlockTracker().provider,onNetworkStateChange:this.networkController.on.bind(this.networkController,ee.NETWORK_EVENTS.NETWORK_DID_CHANGE),getCurrentNetworkEIP1559Compatibility:this.networkController.getEIP1559Compatibility.bind(this.networkController),getCurrentAccountEIP1559Compatibility:this.getCurrentAccountEIP1559Compatibility.bind(this),legacyAPIEndpoint:`${s}/networks/<chain_id>/gasPrices`,EIP1559APIEndpoint:`${s}/networks/<chain_id>/suggestedGasFees`,getCurrentNetworkLegacyGasAPICompatibility:()=>{const e=this.networkController.getCurrentChainId();return t.env.IN_TEST||e===I.MAINNET_CHAIN_ID},getChainId:()=>t.env.IN_TEST?I.MAINNET_CHAIN_ID:this.networkController.getCurrentChainId()}),this.qrHardwareKeyring=new C.MetaMaskKeyring,this.appStateController=new re.default({addUnlockListener:this.on.bind(this,"unlock"),isUnlocked:this.isUnlocked.bind(this),initState:n.AppStateController,onInactiveTimeout:()=>this.setLocked(),showUnlockRequest:e.showUserConfirmation,preferencesStore:this.preferencesController.store,qrHardwareStore:this.qrHardwareKeyring.getMemStore()});const a=this.controllerMessenger.getRestricted({name:"CurrencyRateController"});this.currencyRateController=new O.CurrencyRateController({includeUsdRate:!0,messenger:a,state:Te(Te({},n.CurrencyController),{},{nativeCurrency:this.networkController.providerStore.getState().ticker})});const c=this.controllerMessenger.getRestricted({name:"TokenListController"});this.tokenListController=new O.TokenListController({chainId:(0,F.hexToDecimal)(this.networkController.getCurrentChainId()),useStaticTokenList:!this.preferencesController.store.getState().useTokenDetection,onNetworkStateChange:e=>this.networkController.store.subscribe((t=>{const r=Te(Te({},t),{},{provider:Te(Te({},t.provider),{},{chainId:(0,F.hexToDecimal)(t.provider.chainId)})});return e(r)})),onPreferencesStateChange:e=>this.preferencesController.store.subscribe((t=>{const r=Te(Te({},t),{},{useStaticTokenList:!this.preferencesController.store.getState().useTokenDetection});return e(r)})),messenger:c,state:n.TokenListController}),this.phishingController=new O.PhishingController,this.announcementController=new O.AnnouncementController({allAnnouncements:x.UI_NOTIFICATIONS},n.AnnouncementController),this.tokenRatesController=new O.TokenRatesController({onTokensStateChange:e=>this.tokensController.subscribe(e),onCurrencyRateStateChange:e=>this.controllerMessenger.subscribe(`${this.currencyRateController.name}:stateChange`,e),onNetworkStateChange:e=>this.networkController.store.subscribe((t=>{const r=Te(Te({},t),{},{provider:Te(Te({},t.provider),{},{chainId:(0,F.hexToDecimal)(t.provider.chainId)})});return e(r)}))}),this.ensController=new X.default({provider:this.provider,getCurrentChainId:this.networkController.getCurrentChainId.bind(this.networkController),onNetworkDidChange:this.networkController.on.bind(this.networkController,ee.NETWORK_EVENTS.NETWORK_DID_CHANGE)}),this.incomingTransactionsController=new ae.default({blockTracker:this.blockTracker,onNetworkDidChange:this.networkController.on.bind(this.networkController,ee.NETWORK_EVENTS.NETWORK_DID_CHANGE),getCurrentChainId:this.networkController.getCurrentChainId.bind(this.networkController),preferencesController:this.preferencesController,initState:n.IncomingTransactionsController}),this.accountTracker=new V.default({provider:this.provider,blockTracker:this.blockTracker,getCurrentChainId:this.networkController.getCurrentChainId.bind(this.networkController)}),this.on("controllerConnectionChanged",(e=>{e>0?(this.accountTracker.start(),this.incomingTransactionsController.start(),this.currencyRateController.start(),this.tokenListController.start()):(this.accountTracker.stop(),this.incomingTransactionsController.stop(),this.currencyRateController.stop(),this.tokenListController.stop())})),this.cachedBalancesController=new ne.default({accountTracker:this.accountTracker,getCurrentChainId:this.networkController.getCurrentChainId.bind(this.networkController),initState:n.CachedBalancesController}),this.onboardingController=new oe.default({initState:n.OnboardingController}),this.tokensController.hub.on("pendingSuggestedAsset",(async()=>{await e.openPopup()}));const l=[w.default,_.default,S.default,C.MetaMaskKeyring];this.keyringController=new m.default({keyringTypes:l,initState:n.KeyringController,encryptor:e.encryptor||undefined}),this.keyringController.memStore.subscribe((e=>this._onKeyringControllerUpdate(e))),this.keyringController.on("unlock",(()=>this._onUnlock())),this.keyringController.on("lock",(()=>this._onLock()));const u=()=>this.preferencesController.store.getState().identities;this.permissionController=new O.PermissionController({messenger:this.controllerMessenger.getRestricted({name:"PermissionController",allowedActions:[`${this.approvalController.name}:addRequest`,`${this.approvalController.name}:hasRequest`,`${this.approvalController.name}:acceptRequest`,`${this.approvalController.name}:rejectRequest`]}),state:n.PermissionController,caveatSpecifications:(0,we.getCaveatSpecifications)({getIdentities:u}),permissionSpecifications:Te({},(0,we.getPermissionSpecifications)({getIdentities:u,getAllAccounts:this.keyringController.getAccounts.bind(this.keyringController),captureKeyringTypesWithMissingIdentities:(e={},t=[])=>{const r=t.filter((t=>!e[t])).map((e=>{var t;return null===(t=this.keyringController.getKeyringForAccount(e))||void 0===t?void 0:t.type})),n=Object.keys(e||{}).length,i=Object.keys(this.accountTracker.store.getState().accounts||{}).length;(0,M.captureException)(new Error(`Attempt to get permission specifications failed because their were ${t.length} accounts, but ${n} identities, and the ${r} keyrings included accounts with missing identities. Meanwhile, there are ${i} accounts in the account tracker.`))}})),unrestrictedMethods:we.unrestrictedMethods}),this.permissionLogController=new we.PermissionLogController({restrictedMethods:new Set(Object.keys(D.RestrictedMethods)),initState:n.PermissionLogController}),this.subjectMetadataController=new O.SubjectMetadataController({messenger:this.controllerMessenger.getRestricted({name:"SubjectMetadataController",allowedActions:[`${this.permissionController.name}:hasPermissions`]}),state:n.SubjectMetadataController,subjectCacheLimit:100}),this.detectTokensController=new fe.default({preferences:this.preferencesController,tokensController:this.tokensController,network:this.networkController,keyringMemStore:this.keyringController.memStore,tokenList:this.tokenListController}),this.addressBookController=new O.AddressBookController(undefined,n.AddressBookController),this.alertController=new ie.default({initState:n.AlertController,preferencesStore:this.preferencesController.store}),this.threeBoxController=new se.default({preferencesController:this.preferencesController,addressBookController:this.addressBookController,keyringController:this.keyringController,initState:n.ThreeBoxController,getKeyringControllerState:this.keyringController.memStore.getState.bind(this.keyringController.memStore),version:i,trackMetaMetricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)}),this.txController=new pe.default({initState:n.TransactionController||n.TransactionManager,getPermittedAccounts:this.getPermittedAccounts.bind(this),getProviderConfig:this.networkController.getProviderConfig.bind(this.networkController),getCurrentNetworkEIP1559Compatibility:this.networkController.getEIP1559Compatibility.bind(this.networkController),getCurrentAccountEIP1559Compatibility:this.getCurrentAccountEIP1559Compatibility.bind(this),networkStore:this.networkController.networkStore,getCurrentChainId:this.networkController.getCurrentChainId.bind(this.networkController),preferencesStore:this.preferencesController.store,txHistoryLimit:60,signTransaction:this.keyringController.signTransaction.bind(this.keyringController),provider:this.provider,blockTracker:this.blockTracker,createEventFragment:this.metaMetricsController.createEventFragment.bind(this.metaMetricsController),updateEventFragment:this.metaMetricsController.updateEventFragment.bind(this.metaMetricsController),finalizeEventFragment:this.metaMetricsController.finalizeEventFragment.bind(this.metaMetricsController),getEventFragmentById:this.metaMetricsController.getEventFragmentById.bind(this.metaMetricsController),trackMetaMetricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController),getParticipateInMetrics:()=>this.metaMetricsController.state.participateInMetaMetrics,getEIP1559GasFeeEstimates:this.gasFeeController.fetchGasFeeEstimates.bind(this.gasFeeController),getExternalPendingTransactions:this.getExternalPendingTransactions.bind(this),getAccountType:this.getAccountType.bind(this),getDeviceModel:this.getDeviceModel.bind(this),getTokenStandardAndDetails:this.assetsContractController.getTokenStandardAndDetails.bind(this.assetsContractController)}),this.txController.on("newUnapprovedTx",(()=>e.showUserConfirmation())),this.txController.on("tx:status-update",(async(e,t)=>{if(t===R.TRANSACTION_STATUSES.CONFIRMED||t===R.TRANSACTION_STATUSES.FAILED){const t=this.txController.txStateManager.getTransaction(e),s=this.preferencesController.getFrequentRpcListDetail();let a={};if(t.chainId){var r;const e=s.find((e=>t.chainId===e.chainId));a=null!==(r=null==e?void 0:e.rpcPrefs)&&void 0!==r?r:{}}this.platform.showTransactionNotification(t,a);const{txReceipt:c}=t;if(t.type===R.TRANSACTION_TYPES.TOKEN_METHOD_TRANSFER_FROM&&t.txParams!==undefined){var n,i;const{data:e,to:r,from:o}=t.txParams,{chainId:s}=t,a=(0,q.parseStandardTokenTransactionData)(e),c=null!==(n=(0,z.getTokenIdParam)(a))&&void 0!==n?n:(0,z.getTokenValueParam)(a),{allCollectibles:l}=this.collectiblesController.state,u=null==l||null===(i=l[o])||void 0===i?void 0:i[s].find((({address:e,tokenId:t})=>(0,G.isEqualCaseInsensitive)(e,r)&&t===c));u&&this.collectiblesController.checkAndUpdateSingleCollectibleOwnershipStatus(u,!1,{userAddress:o,chainId:s})}const l=await this.getState();var o;if(c&&"0x0"===c.status)this.metaMetricsController.trackEvent({event:"Tx Status Update: On-Chain Failure",category:B.EVENT.CATEGORIES.BACKGROUND,properties:{action:"Transactions",errorMessage:null===(o=t.simulationFails)||void 0===o?void 0:o.reason,numberOfTokens:l.tokens.length,numberOfAccounts:Object.keys(l.accounts).length}},{matomoEvent:!0})}})),this.networkController.on(ee.NETWORK_EVENTS.NETWORK_DID_CHANGE,(async()=>{const{ticker:e}=this.networkController.getProviderConfig();try{await this.currencyRateController.setNativeCurrency(e)}catch(e){console.error(e)}})),this.networkController.lookupNetwork(),this.messageManager=new ce.default({metricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)}),this.personalMessageManager=new de.default({metricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)}),this.decryptMessageManager=new le.default({metricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)}),this.encryptionPublicKeyManager=new ue.default({metricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)}),this.typedMessageManager=new he.default({getCurrentChainId:this.networkController.getCurrentChainId.bind(this.networkController),metricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)}),this.swapsController=new ge.default({getBufferedGasLimit:this.txController.txGasUtil.getBufferedGasLimit.bind(this.txController.txGasUtil),networkController:this.networkController,provider:this.provider,getProviderConfig:this.networkController.getProviderConfig.bind(this.networkController),getTokenRatesState:()=>this.tokenRatesController.state,getCurrentChainId:this.networkController.getCurrentChainId.bind(this.networkController),getEIP1559GasFeeEstimates:this.gasFeeController.fetchGasFeeEstimates.bind(this.gasFeeController)}),this.smartTransactionsController=new P.default({onNetworkStateChange:this.networkController.store.subscribe.bind(this.networkController.store),getNetwork:this.networkController.getNetworkState.bind(this.networkController),getNonceLock:this.txController.nonceTracker.getNonceLock.bind(this.txController.nonceTracker),confirmExternalTransaction:this.txController.confirmExternalTransaction.bind(this.txController),provider:this.provider,trackMetaMetricsEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController)},undefined,n.SmartTransactionsController),this.networkController.on(ee.NETWORK_EVENTS.NETWORK_DID_CHANGE,(()=>{this.accountTracker._updateAccounts()})),this.networkController.on(ee.NETWORK_EVENTS.NETWORK_WILL_CHANGE,(()=>{this.txController.txStateManager.clearUnapprovedTxs(),this.encryptionPublicKeyManager.clearUnapproved(),this.personalMessageManager.clearUnapproved(),this.typedMessageManager.clearUnapproved(),this.decryptMessageManager.clearUnapproved(),this.messageManager.clearUnapproved()})),this.on("update",(e=>this._onStateUpdate(e))),this.store.updateStructure({AppStateController:this.appStateController.store,TransactionController:this.txController.store,KeyringController:this.keyringController.store,PreferencesController:this.preferencesController.store,MetaMetricsController:this.metaMetricsController.store,AddressBookController:this.addressBookController,CurrencyController:this.currencyRateController,NetworkController:this.networkController.store,CachedBalancesController:this.cachedBalancesController.store,AlertController:this.alertController.store,OnboardingController:this.onboardingController.store,IncomingTransactionsController:this.incomingTransactionsController.store,PermissionController:this.permissionController,PermissionLogController:this.permissionLogController.store,SubjectMetadataController:this.subjectMetadataController,ThreeBoxController:this.threeBoxController.store,AnnouncementController:this.announcementController,GasFeeController:this.gasFeeController,TokenListController:this.tokenListController,TokensController:this.tokensController,SmartTransactionsController:this.smartTransactionsController,CollectiblesController:this.collectiblesController}),this.memStore=new H.default({config:{AppStateController:this.appStateController.store,NetworkController:this.networkController.store,AccountTracker:this.accountTracker.store,TxController:this.txController.memStore,CachedBalancesController:this.cachedBalancesController.store,TokenRatesController:this.tokenRatesController,MessageManager:this.messageManager.memStore,PersonalMessageManager:this.personalMessageManager.memStore,DecryptMessageManager:this.decryptMessageManager.memStore,EncryptionPublicKeyManager:this.encryptionPublicKeyManager.memStore,TypesMessageManager:this.typedMessageManager.memStore,KeyringController:this.keyringController.memStore,PreferencesController:this.preferencesController.store,MetaMetricsController:this.metaMetricsController.store,AddressBookController:this.addressBookController,CurrencyController:this.currencyRateController,AlertController:this.alertController.store,OnboardingController:this.onboardingController.store,IncomingTransactionsController:this.incomingTransactionsController.store,PermissionController:this.permissionController,PermissionLogController:this.permissionLogController.store,SubjectMetadataController:this.subjectMetadataController,ThreeBoxController:this.threeBoxController.store,SwapsController:this.swapsController.store,EnsController:this.ensController.store,ApprovalController:this.approvalController,AnnouncementController:this.announcementController,GasFeeController:this.gasFeeController,TokenListController:this.tokenListController,TokensController:this.tokensController,SmartTransactionsController:this.smartTransactionsController,CollectiblesController:this.collectiblesController},controllerMessenger:this.controllerMessenger}),this.memStore.subscribe(this.sendUpdate.bind(this));const h=null===(r={})||void 0===r?void 0:r.PASSWORD;h&&!this.isUnlocked()&&this.onboardingController.store.getState().completedOnboarding&&this.submitPassword(h),this.extension.runtime.getPlatformInfo().then((({os:e})=>{this.appStateController.setBrowserEnvironment(e,this.extension.runtime.getBrowserInfo===undefined?"chrome":"firefox")})),this.setupControllerEventSubscriptions(),this.publicConfigStore=this.createPublicConfigStore(),this.extension.runtime.onMessageExternal.addListener(W.onMessageReceived),(0,W.checkForMultipleVersionsRunning)()}setupControllerEventSubscriptions(){const e=async(e,t)=>{this.isUnlocked()&&this.notifyConnections(e,{method:we.NOTIFICATION_NAMES.accountsChanged,params:t.length<2?t:await this.getPermittedAccounts(e)}),this.permissionLogController.updateAccountsHistory(e,t)};let t;this.preferencesController.store.subscribe((async({selectedAddress:r})=>{if(r&&r!==t){t=r;const n=(0,we.getPermittedAccountsByOrigin)(this.permissionController.state);for(const[t,i]of n.entries())i.includes(r)&&e(t,i)}})),this.controllerMessenger.subscribe(`${this.permissionController.name}:stateChange`,(async(t,r)=>{const n=(0,we.getChangedAccounts)(t,r);for(const[t,r]of n.entries())e(t,r)}),we.getPermittedAccountsByOrigin)}initializeProvider(){const e=this.platform.getVersion(),t={static:{eth_syncing:!1,web3_clientVersion:`MetaMask/v${e}`},version:e,getAccounts:async({origin:e},{suppressUnauthorizedError:t=!0}={})=>{if(e===j.ORIGIN_METAMASK){const e=this.preferencesController.getSelectedAddress();return e?[e]:[]}return this.isUnlocked()?await this.getPermittedAccounts(e,{suppressUnauthorizedError:t}):[]},processTransaction:this.newUnapprovedTransaction.bind(this),processEthSignMessage:this.newUnsignedMessage.bind(this),processTypedMessage:this.newUnsignedTypedMessage.bind(this),processTypedMessageV3:this.newUnsignedTypedMessage.bind(this),processTypedMessageV4:this.newUnsignedTypedMessage.bind(this),processPersonalMessage:this.newUnsignedPersonalMessage.bind(this),processDecryptMessage:this.newRequestDecryptMessage.bind(this),processEncryptionPublicKey:this.newRequestEncryptionPublicKey.bind(this),getPendingNonce:this.getPendingNonce.bind(this),getPendingTransactionByHash:e=>this.txController.getTransactions({searchCriteria:{hash:e,status:R.TRANSACTION_STATUSES.SUBMITTED}})[0]};return this.networkController.initializeProvider(t)}createPublicConfigStore(){const e=new c.ObservableStore,{networkController:t}=this;function r(r){const n=t.getCurrentChainId();"loading"!==r.network&&e.putState(function(e,{isUnlocked:t,network:r}){return{isUnlocked:t,chainId:e,networkVersion:r}}(n,r))}return this.on("update",r),r(this.getState()),e}async getProviderState(e){return Te(Te({isUnlocked:this.isUnlocked()},this.getProviderNetworkState()),{},{accounts:await this.getPermittedAccounts(e)})}getProviderNetworkState(e){const{network:t}=e||this.getState();return{chainId:this.networkController.getCurrentChainId(),networkVersion:t}}getState(){const{vault:e}=this.keyringController.store.getState();return Te({isInitialized:Boolean(e)},this.memStore.getFlatState())}getApi(){const{addressBookController:e,alertController:t,approvalController:r,appStateController:n,collectiblesController:i,collectibleDetectionController:o,currencyRateController:s,detectTokensController:a,ensController:c,gasFeeController:l,keyringController:u,metaMetricsController:d,networkController:h,announcementController:p,onboardingController:f,permissionController:g,preferencesController:m,qrHardwareKeyring:y,swapsController:v,threeBoxController:E,tokensController:w,smartTransactionsController:_,txController:S,assetsContractController:C}=this;return Te(Te({getState:this.getState.bind(this),setCurrentCurrency:s.setCurrentCurrency.bind(s),setUseBlockie:m.setUseBlockie.bind(m),setUseNonceField:m.setUseNonceField.bind(m),setUsePhishDetect:m.setUsePhishDetect.bind(m),setUseTokenDetection:m.setUseTokenDetection.bind(m),setUseCollectibleDetection:m.setUseCollectibleDetection.bind(m),setOpenSeaEnabled:m.setOpenSeaEnabled.bind(m),setIpfsGateway:m.setIpfsGateway.bind(m),setParticipateInMetaMetrics:d.setParticipateInMetaMetrics.bind(d),setCurrentLocale:m.setCurrentLocale.bind(m),markPasswordForgotten:this.markPasswordForgotten.bind(this),unMarkPasswordForgotten:this.unMarkPasswordForgotten.bind(this),getRequestAccountTabIds:this.getRequestAccountTabIds,getOpenMetamaskTabsIds:this.getOpenMetamaskTabsIds,markNotificationPopupAsAutomaticallyClosed:()=>this.notificationManager.markAsAutomaticallyClosed(),addNewAccount:this.addNewAccount.bind(this),verifySeedPhrase:this.verifySeedPhrase.bind(this),resetAccount:this.resetAccount.bind(this),removeAccount:this.removeAccount.bind(this),importAccountWithStrategy:this.importAccountWithStrategy.bind(this),connectHardware:this.connectHardware.bind(this),forgetDevice:this.forgetDevice.bind(this),checkHardwareStatus:this.checkHardwareStatus.bind(this),unlockHardwareWalletAccount:this.unlockHardwareWalletAccount.bind(this),setLedgerTransportPreference:this.setLedgerTransportPreference.bind(this),attemptLedgerTransportCreation:this.attemptLedgerTransportCreation.bind(this),establishLedgerTransportPreference:this.establishLedgerTransportPreference.bind(this),submitQRHardwareCryptoHDKey:y.submitCryptoHDKey.bind(y),submitQRHardwareCryptoAccount:y.submitCryptoAccount.bind(y),cancelSyncQRHardware:y.cancelSync.bind(y),submitQRHardwareSignature:y.submitSignature.bind(y),cancelQRHardwareSignRequest:y.cancelSignRequest.bind(y),fetchInfoToSync:this.fetchInfoToSync.bind(this),submitPassword:this.submitPassword.bind(this),verifyPassword:this.verifyPassword.bind(this),setProviderType:h.setProviderType.bind(h),rollbackToPreviousProvider:h.rollbackToPreviousProvider.bind(h),setCustomRpc:this.setCustomRpc.bind(this),updateAndSetCustomRpc:this.updateAndSetCustomRpc.bind(this),delCustomRpc:this.delCustomRpc.bind(this),addCustomNetwork:this.addCustomNetwork.bind(this),requestUserApproval:this.requestUserApproval.bind(this),setSelectedAddress:m.setSelectedAddress.bind(m),addToken:w.addToken.bind(w),rejectWatchAsset:w.rejectWatchAsset.bind(w),acceptWatchAsset:w.acceptWatchAsset.bind(w),updateTokenType:w.updateTokenType.bind(w),removeToken:w.removeAndIgnoreToken.bind(w),setAccountLabel:m.setAccountLabel.bind(m),setFeatureFlag:m.setFeatureFlag.bind(m),setPreference:m.setPreference.bind(m),addKnownMethodData:m.addKnownMethodData.bind(m),setDismissSeedBackUpReminder:m.setDismissSeedBackUpReminder.bind(m),setAdvancedGasFee:m.setAdvancedGasFee.bind(m),setEIP1559V2Enabled:m.setEIP1559V2Enabled.bind(m),setTheme:m.setTheme.bind(m),setCustomNetworkListEnabled:m.setCustomNetworkListEnabled.bind(m),getTokenStandardAndDetails:this.getTokenStandardAndDetails.bind(this),addCollectible:i.addCollectible.bind(i),addCollectibleVerifyOwnership:i.addCollectibleVerifyOwnership.bind(i),removeAndIgnoreCollectible:i.removeAndIgnoreCollectible.bind(i),removeCollectible:i.removeCollectible.bind(i),checkAndUpdateAllCollectiblesOwnershipStatus:i.checkAndUpdateAllCollectiblesOwnershipStatus.bind(i),checkAndUpdateSingleCollectibleOwnershipStatus:i.checkAndUpdateSingleCollectibleOwnershipStatus.bind(i),isCollectibleOwner:i.isCollectibleOwner.bind(i),setAddressBook:e.set.bind(e),removeFromAddressBook:e.delete.bind(e),setLastActiveTime:n.setLastActiveTime.bind(n),setDefaultHomeActiveTabName:n.setDefaultHomeActiveTabName.bind(n),setConnectedStatusPopoverHasBeenShown:n.setConnectedStatusPopoverHasBeenShown.bind(n),setRecoveryPhraseReminderHasBeenShown:n.setRecoveryPhraseReminderHasBeenShown.bind(n),setRecoveryPhraseReminderLastShown:n.setRecoveryPhraseReminderLastShown.bind(n),setShowTestnetMessageInDropdown:n.setShowTestnetMessageInDropdown.bind(n),setCollectiblesDetectionNoticeDismissed:n.setCollectiblesDetectionNoticeDismissed.bind(n),setEnableEIP1559V2NoticeDismissed:n.setEnableEIP1559V2NoticeDismissed.bind(n),updateCollectibleDropDownState:n.updateCollectibleDropDownState.bind(n),tryReverseResolveAddress:c.reverseResolveAddress.bind(c),setLocked:this.setLocked.bind(this),createNewVaultAndKeychain:this.createNewVaultAndKeychain.bind(this),createNewVaultAndRestore:this.createNewVaultAndRestore.bind(this),exportAccount:u.exportAccount.bind(u),cancelTransaction:S.cancelTransaction.bind(S),updateTransaction:S.updateTransaction.bind(S),updateAndApproveTransaction:S.updateAndApproveTransaction.bind(S),approveTransactionsWithSameNonce:S.approveTransactionsWithSameNonce.bind(S),createCancelTransaction:this.createCancelTransaction.bind(this),createSpeedUpTransaction:this.createSpeedUpTransaction.bind(this),estimateGas:this.estimateGas.bind(this),getNextNonce:this.getNextNonce.bind(this),addUnapprovedTransaction:S.addUnapprovedTransaction.bind(S),createTransactionEventFragment:S.createTransactionEventFragment.bind(S),getTransactions:S.getTransactions.bind(S),updateEditableParams:S.updateEditableParams.bind(S),updateTransactionGasFees:S.updateTransactionGasFees.bind(S),updateTransactionSendFlowHistory:S.updateTransactionSendFlowHistory.bind(S),updateSwapApprovalTransaction:S.updateSwapApprovalTransaction.bind(S),updateSwapTransaction:S.updateSwapTransaction.bind(S),updatePreviousGasParams:S.updatePreviousGasParams.bind(S),signMessage:this.signMessage.bind(this),cancelMessage:this.cancelMessage.bind(this),signPersonalMessage:this.signPersonalMessage.bind(this),cancelPersonalMessage:this.cancelPersonalMessage.bind(this),signTypedMessage:this.signTypedMessage.bind(this),cancelTypedMessage:this.cancelTypedMessage.bind(this),decryptMessage:this.decryptMessage.bind(this),decryptMessageInline:this.decryptMessageInline.bind(this),cancelDecryptMessage:this.cancelDecryptMessage.bind(this),encryptionPublicKey:this.encryptionPublicKey.bind(this),cancelEncryptionPublicKey:this.cancelEncryptionPublicKey.bind(this),setSeedPhraseBackedUp:f.setSeedPhraseBackedUp.bind(f),completeOnboarding:f.completeOnboarding.bind(f),setFirstTimeFlowType:f.setFirstTimeFlowType.bind(f),setAlertEnabledness:t.setAlertEnabledness.bind(t),setUnconnectedAccountAlertShown:t.setUnconnectedAccountAlertShown.bind(t),setWeb3ShimUsageAlertDismissed:t.setWeb3ShimUsageAlertDismissed.bind(t),setThreeBoxSyncingPermission:E.setThreeBoxSyncingPermission.bind(E),restoreFromThreeBox:E.restoreFromThreeBox.bind(E),setShowRestorePromptToFalse:E.setShowRestorePromptToFalse.bind(E),getThreeBoxLastUpdated:E.getLastUpdated.bind(E),turnThreeBoxSyncingOn:E.turnThreeBoxSyncingOn.bind(E),initializeThreeBox:this.initializeThreeBox.bind(this),removePermissionsFor:g.revokePermissions.bind(g),approvePermissionsRequest:g.acceptPermissionsRequest.bind(g),rejectPermissionsRequest:g.rejectPermissionsRequest.bind(g)},(0,we.getPermissionBackgroundApiMethods)(g)),{},{fetchAndSetQuotes:v.fetchAndSetQuotes.bind(v),setSelectedQuoteAggId:v.setSelectedQuoteAggId.bind(v),resetSwapsState:v.resetSwapsState.bind(v),setSwapsTokens:v.setSwapsTokens.bind(v),clearSwapsQuotes:v.clearSwapsQuotes.bind(v),setApproveTxId:v.setApproveTxId.bind(v),setTradeTxId:v.setTradeTxId.bind(v),setSwapsTxGasPrice:v.setSwapsTxGasPrice.bind(v),setSwapsTxGasLimit:v.setSwapsTxGasLimit.bind(v),setSwapsTxMaxFeePerGas:v.setSwapsTxMaxFeePerGas.bind(v),setSwapsTxMaxFeePriorityPerGas:v.setSwapsTxMaxFeePriorityPerGas.bind(v),safeRefetchQuotes:v.safeRefetchQuotes.bind(v),stopPollingForQuotes:v.stopPollingForQuotes.bind(v),setBackgroundSwapRouteState:v.setBackgroundSwapRouteState.bind(v),resetPostFetchState:v.resetPostFetchState.bind(v),setSwapsErrorKey:v.setSwapsErrorKey.bind(v),setInitialGasEstimate:v.setInitialGasEstimate.bind(v),setCustomApproveTxData:v.setCustomApproveTxData.bind(v),setSwapsLiveness:v.setSwapsLiveness.bind(v),setSwapsFeatureFlags:v.setSwapsFeatureFlags.bind(v),setSwapsUserFeeLevel:v.setSwapsUserFeeLevel.bind(v),setSwapsQuotesPollingLimitEnabled:v.setSwapsQuotesPollingLimitEnabled.bind(v),setSmartTransactionsOptInStatus:_.setOptInState.bind(_),fetchSmartTransactionFees:_.getFees.bind(_),submitSignedTransactions:_.submitSignedTransactions.bind(_),cancelSmartTransaction:_.cancelSmartTransaction.bind(_),fetchSmartTransactionsLiveness:_.fetchLiveness.bind(_),updateSmartTransaction:_.updateSmartTransaction.bind(_),setStatusRefreshInterval:_.setStatusRefreshInterval.bind(_),trackMetaMetricsEvent:d.trackEvent.bind(d),trackMetaMetricsPage:d.trackPage.bind(d),createEventFragment:d.createEventFragment.bind(d),updateEventFragment:d.updateEventFragment.bind(d),finalizeEventFragment:d.finalizeEventFragment.bind(d),resolvePendingApproval:r.accept.bind(r),rejectPendingApproval:async(e,t)=>{r.reject(e,new b.EthereumRpcError(t.code,t.message,t.data))},updateViewedNotifications:p.updateViewed.bind(p),getGasFeeEstimatesAndStartPolling:l.getGasFeeEstimatesAndStartPolling.bind(l),disconnectGasFeeEstimatePoller:l.disconnectPoller.bind(l),getGasFeeTimeEstimate:l.getTimeEstimate.bind(l),addPollingTokenToAppState:n.addPollingToken.bind(n),removePollingTokenFromAppState:n.removePollingToken.bind(n),detectNewTokens:a.detectNewTokens.bind(a),detectCollectibles:null,addDetectedTokens:null,importTokens:null,ignoreTokens:null,getBalancesInSingleCall:null})}async getTokenStandardAndDetails(e,t,r){var n,i;const o=await this.assetsContractController.getTokenStandardAndDetails(e,t,r);return Te(Te({},o),{},{decimals:null==o||null===(n=o.decimals)||void 0===n?void 0:n.toString(10),balance:null==o||null===(i=o.balance)||void 0===i?void 0:i.toString(10)})}async createNewVaultAndKeychain(e){const t=await this.createVaultMutex.acquire();try{let r;if((await this.keyringController.getAccounts()).length>0)r=await this.keyringController.fullUpdate();else{r=await this.keyringController.createNewVaultAndKeychain(e);const t=await this.keyringController.getAccounts();this.preferencesController.setAddresses(t),this.selectFirstIdentity()}return r}finally{t()}}async requestUserApproval(e,t){try{await this.approvalController.addAndShowApprovalRequest({origin:"metamask",type:"wallet_addEthereumChain",requestData:{chainId:e.chainId,blockExplorerUrl:e.rpcPrefs.blockExplorerUrl,chainName:e.nickname,rpcUrl:e.rpcUrl,ticker:e.ticker,imageUrl:e.rpcPrefs.imageUrl}})}catch(e){if(!t||"User rejected the request."!==e.message)throw e}}async addCustomNetwork(e){const{chainId:t,chainName:r,rpcUrl:n,ticker:i,blockExplorerUrl:o}=e;await this.preferencesController.addToFrequentRpcList(n,t,i,r,{blockExplorerUrl:o})}async createNewVaultAndRestore(e,t){const r=await this.createVaultMutex.acquire();try{let i,o;const s=n.from(t),{keyringController:a}=this;this.preferencesController.setAddresses([]),this.permissionController.clearState(),this.accountTracker.clearAccounts(),this.cachedBalancesController.clearCachedBalances(),this.txController.txStateManager.clearUnapprovedTxs();const c=await a.createNewVaultAndRestore(e,s),l=new k.default(this.provider);i=await a.getAccounts(),o=await this.getBalance(i[i.length-1],l);const u=a.getKeyringsByType("HD Key Tree")[0];if(!u)throw new Error("MetamaskController - No HD Key Tree found");for(;"0x0"!==o;)await a.addNewAccount(u),i=await a.getAccounts(),o=await this.getBalance(i[i.length-1],l);i.length>1&&"0x0"===o&&(await this.removeAccount(i[i.length-1]),i=await a.getAccounts());const d=this.preferencesController.getLedgerTransportPreference();return this.setLedgerTransportPreference(d),this.preferencesController.setAddresses(i),this.selectFirstIdentity(),c}finally{r()}}getBalance(e,t){return new Promise(((r,n)=>{const i=this.accountTracker.store.getState().accounts[e];i&&i.balance?r(i.balance):t.getBalance(e,((e,t)=>{e?(n(e),E.default.error(e)):r(t||"0x0")}))}))}async fetchInfoToSync(){const{currentLocale:e,frequentRpcList:t,identities:r,selectedAddress:n,useTokenDetection:i}=this.preferencesController.store.getState(),{tokenList:o}=this.tokenListController.state,s={currentLocale:e,frequentRpcList:t,identities:r,selectedAddress:n},{allTokens:a,allIgnoredTokens:c}=this.tokensController.state,l={};Object.keys(a).forEach((e=>{l[e]={},Object.keys(a[e]).forEach((t=>{const r=(0,U.toChecksumHexAddress)(t);l[e][r]=a[e][r].filter((e=>{if(e.isERC721===undefined){const t=i?e.address.toLowerCase():e.address;if(o[t]!==undefined)return!0}else if(!1===e.isERC721)return!0;return!1}))}))}));const u=this.keyringController.getKeyringsByType("HD Key Tree")[0],d=this.keyringController.getKeyringsByType("Simple Key Pair"),h=await u.getAccounts(),p=(await Promise.all(d.map((e=>e.getAccounts())))).reduce(((e,t)=>[...e,...t]),[]),f={hd:h.filter(((e,t)=>h.indexOf(e)===t)).map((e=>(0,U.toChecksumHexAddress)(e))),simpleKeyPair:p.filter(((e,t)=>p.indexOf(e)===t)).map((e=>(0,U.toChecksumHexAddress)(e))),ledger:[],trezor:[],lattice:[]};let{transactions:g}=this.txController.store.getState();return g=Object.values(g).filter((e=>{const t=(0,U.toChecksumHexAddress)(e.txParams.from);return f.hd.includes(t)})),{accounts:f,preferences:s,transactions:g,tokens:{allTokens:l,allIgnoredTokens:c},network:this.networkController.store.getState()}}async submitPassword(e){await this.keyringController.submitPassword(e);try{await this.blockTracker.checkForLatestBlock()}catch(e){E.default.error("Error while unlocking extension.",e)}try{const e=this.threeBoxController.getThreeBoxSyncingState();e&&!this.threeBoxController.box?(this.threeBoxController.init(),this.threeBoxController.turnThreeBoxSyncingOn()):e&&this.threeBoxController.box&&this.threeBoxController.turnThreeBoxSyncingOn()}catch(e){E.default.error("Error while unlocking extension.",e)}const t=this.preferencesController.getLedgerTransportPreference();return this.setLedgerTransportPreference(t),this.keyringController.fullUpdate()}async verifyPassword(e){await this.keyringController.verifyPassword(e)}selectFirstIdentity(){const{identities:e}=this.preferencesController.store.getState(),t=Object.keys(e)[0];this.preferencesController.setSelectedAddress(t)}getPrimaryKeyringMnemonic(){const e=this.keyringController.getKeyringsByType("HD Key Tree")[0];if(!e.mnemonic)throw new Error("Primary keyring mnemonic unavailable.");return e.mnemonic}async getKeyringForDevice(e,t=null){let r=null;switch(e){case N.DEVICE_NAMES.TREZOR:r=w.default.type;break;case N.DEVICE_NAMES.LEDGER:r=_.default.type;break;case N.DEVICE_NAMES.QR:r=C.MetaMaskKeyring.type;break;case N.DEVICE_NAMES.LATTICE:r=S.default.type;break;default:throw new Error("MetamaskController:getKeyringForDevice - Unknown device")}let n=await this.keyringController.getKeyringsByType(r)[0];if(n||(n=await this.keyringController.addNewKeyring(r)),t&&n.setHdPath&&n.setHdPath(t),e===N.DEVICE_NAMES.LATTICE&&(n.appName="MetaMask"),e===N.DEVICE_NAMES.TREZOR){const e=n.getModel();this.appStateController.setTrezorModel(e)}return n.network=this.networkController.getProviderConfig().type,n}async attemptLedgerTransportCreation(){const e=await this.getKeyringForDevice(N.DEVICE_NAMES.LEDGER);return await e.attemptMakeApp()}async establishLedgerTransportPreference(){const e=this.preferencesController.getLedgerTransportPreference();return await this.setLedgerTransportPreference(e)}async connectHardware(e,t,r){const n=await this.getKeyringForDevice(e,r);let i=[];switch(t){case-1:i=await n.getPreviousPage();break;case 1:i=await n.getNextPage();break;default:i=await n.getFirstPage()}const o=await this.keyringController.getAccounts(),s=[...new Set(o.concat(i.map((e=>e.address.toLowerCase()))))];return this.accountTracker.syncWithAddresses(s),i}async checkHardwareStatus(e,t){return(await this.getKeyringForDevice(e,t)).isUnlocked()}async forgetDevice(e){return(await this.getKeyringForDevice(e)).forgetDevice(),!0}async getAccountType(e){switch((await this.keyringController.getKeyringForAccount(e)).type){case N.KEYRING_TYPES.TREZOR:case N.KEYRING_TYPES.LATTICE:case N.KEYRING_TYPES.QR:case N.KEYRING_TYPES.LEDGER:return"hardware";case N.KEYRING_TYPES.IMPORTED:return"imported";default:return"MetaMask"}}async getDeviceModel(e){const t=await this.keyringController.getKeyringForAccount(e);switch(t.type){case N.KEYRING_TYPES.TREZOR:return t.getModel();case N.KEYRING_TYPES.QR:return t.getName();case N.KEYRING_TYPES.LEDGER:return N.DEVICE_NAMES.LEDGER;case N.KEYRING_TYPES.LATTICE:return N.DEVICE_NAMES.LATTICE;default:return"N/A"}}getAccountLabel(e,t,r){return`${e[0].toUpperCase()}${e.slice(1)} ${parseInt(t,10)+1} ${r||""}`.trim()}async unlockHardwareWalletAccount(e,t,r,n){const i=await this.getKeyringForDevice(t,r);i.setAccountToUnlock(e);const o=await this.keyringController.getAccounts(),s=await this.keyringController.addNewAccount(i),a=await this.keyringController.getAccounts();this.preferencesController.setAddresses(a),a.forEach((r=>{if(!o.includes(r)){const o=this.getAccountLabel(t===N.DEVICE_NAMES.QR?i.getName():t,e,n);this.preferencesController.setAccountLabel(r,o),this.preferencesController.setSelectedAddress(r)}}));const{identities:c}=this.preferencesController.store.getState();return Te(Te({},s),{},{identities:c})}async addNewAccount(){const e=this.keyringController.getKeyringsByType("HD Key Tree")[0];if(!e)throw new Error("MetamaskController - No HD Key Tree found");const{keyringController:t}=this,r=await t.getAccounts(),n=await t.addNewAccount(e),i=await t.getAccounts();await this.verifySeedPhrase(),this.preferencesController.setAddresses(i),i.forEach((e=>{r.includes(e)||this.preferencesController.setSelectedAddress(e)}));const{identities:o}=this.preferencesController.store.getState();return Te(Te({},n),{},{identities:o})}async verifySeedPhrase(){const e=this.keyringController.getKeyringsByType("HD Key Tree")[0];if(!e)throw new Error("MetamaskController - No HD Key Tree found");const t=await e.serialize(),r=n.from(t.mnemonic),i=await e.getAccounts();if(i.length<1)throw new Error("MetamaskController - No accounts found");try{return await be.default.verifyAccounts(i,r),Array.from(r.values())}catch(e){throw E.default.error(e.message),e}}async resetAccount(){const e=this.preferencesController.getSelectedAddress();return this.txController.wipeTransactions(e),this.networkController.resetConnection(),e}async getPermittedAccounts(e,{suppressUnauthorizedError:t=!0}={}){try{return await this.permissionController.executeRestrictedMethod(e,D.RestrictedMethods.eth_accounts)}catch(e){if(t&&e.code===b.errorCodes.provider.unauthorized)return[];throw e}}removeAllAccountPermissions(e){this.permissionController.updatePermissionsByCaveat(D.CaveatTypes.restrictReturnedAccounts,(t=>we.CaveatMutatorFactories[D.CaveatTypes.restrictReturnedAccounts].removeAccount(e,t)))}async removeAccount(e){this.removeAllAccountPermissions(e),this.preferencesController.removeAddress(e),this.accountTracker.removeAccount([e]);const t=await this.keyringController.getKeyringForAccount(e);await this.keyringController.removeAccount(e);const r=t?await t.getAccounts():{};var n;0===(null==r?void 0:r.length)&&(null===(n=t.destroy)||void 0===n||n.call(t));return e}async importAccountWithStrategy(e,t){const r=await me.default.importAccount(e,t),n=await this.keyringController.addNewKeyring("Simple Key Pair",[r]),i=await n.getAccounts(),o=await this.keyringController.getAccounts();this.preferencesController.setAddresses(o),await this.preferencesController.setSelectedAddress(i[0])}async newUnapprovedTransaction(e,t){return await this.txController.newUnapprovedTransaction(e,t)}async newUnsignedMessage(e,t){const r=(0,ce.normalizeMsgData)(e.data);let n;if(66!==r.length&&67!==r.length)throw b.ethErrors.rpc.invalidParams("eth_sign requires 32 byte message hash");return n=this.messageManager.addUnapprovedMessageAsync(e,t),this.sendUpdate(),this.opts.showUserConfirmation(),await n}async signMessage(e){E.default.info("MetaMaskController - signMessage");const t=e.metamaskId;try{const r=await this.messageManager.approveMessage(e),n=await this.keyringController.signMessage(r);return this.messageManager.setMsgStatusSigned(t,n),this.getState()}catch(e){throw E.default.info("MetaMaskController - eth_sign failed",e),this.messageManager.errorMessage(t,e),e}}cancelMessage(e){const{messageManager:t}=this;return t.rejectMsg(e),this.getState()}async newUnsignedPersonalMessage(e,t){const r=this.personalMessageManager.addUnapprovedMessageAsync(e,t);return this.sendUpdate(),this.opts.showUserConfirmation(),r}async signPersonalMessage(e){E.default.info("MetaMaskController - signPersonalMessage");const t=e.metamaskId;try{const r=await this.personalMessageManager.approveMessage(e),n=await this.keyringController.signPersonalMessage(r);return this.personalMessageManager.setMsgStatusSigned(t,n),this.getState()}catch(e){throw E.default.info("MetaMaskController - eth_personalSign failed",e),this.personalMessageManager.errorMessage(t,e),e}}cancelPersonalMessage(e){return this.personalMessageManager.rejectMsg(e),this.getState()}async newRequestDecryptMessage(e,t){const r=this.decryptMessageManager.addUnapprovedMessageAsync(e,t);return this.sendUpdate(),this.opts.showUserConfirmation(),r}async decryptMessageInline(e){E.default.info("MetaMaskController - decryptMessageInline");const t=e.metamaskId,r=this.decryptMessageManager.getMsg(t);try{const t=(0,v.stripHexPrefix)(e.data),i=n.from(t,"hex");e.data=JSON.parse(i.toString("utf8")),r.rawData=await this.keyringController.decryptMessage(e)}catch(e){r.error=e.message}return this.decryptMessageManager._updateMsg(r),this.getState()}async decryptMessage(e){E.default.info("MetaMaskController - decryptMessage");const t=e.metamaskId;try{const r=await this.decryptMessageManager.approveMessage(e),i=(0,v.stripHexPrefix)(r.data),o=n.from(i,"hex");r.data=JSON.parse(o.toString("utf8"));const s=await this.keyringController.decryptMessage(r);this.decryptMessageManager.setMsgStatusDecrypted(t,s)}catch(e){E.default.info("MetaMaskController - eth_decrypt failed.",e),this.decryptMessageManager.errorMessage(t,e)}return this.getState()}cancelDecryptMessage(e){return this.decryptMessageManager.rejectMsg(e),this.getState()}async newRequestEncryptionPublicKey(e,t){const r=e;switch((await this.keyringController.getKeyringForAccount(r)).type){case N.KEYRING_TYPES.LEDGER:return new Promise(((e,t)=>{t(new Error("Ledger does not support eth_getEncryptionPublicKey."))}));case N.KEYRING_TYPES.TREZOR:return new Promise(((e,t)=>{t(new Error("Trezor does not support eth_getEncryptionPublicKey."))}));case N.KEYRING_TYPES.LATTICE:return new Promise(((e,t)=>{t(new Error("Lattice does not support eth_getEncryptionPublicKey."))}));case N.KEYRING_TYPES.QR:return Promise.reject(new Error("QR hardware does not support eth_getEncryptionPublicKey."));default:{const r=this.encryptionPublicKeyManager.addUnapprovedMessageAsync(e,t);return this.sendUpdate(),this.opts.showUserConfirmation(),r}}}async encryptionPublicKey(e){E.default.info("MetaMaskController - encryptionPublicKey");const t=e.metamaskId;try{const r=await this.encryptionPublicKeyManager.approveMessage(e),n=await this.keyringController.getEncryptionPublicKey(r.data);this.encryptionPublicKeyManager.setMsgStatusReceived(t,n)}catch(e){E.default.info("MetaMaskController - eth_getEncryptionPublicKey failed.",e),this.encryptionPublicKeyManager.errorMessage(t,e)}return this.getState()}cancelEncryptionPublicKey(e){return this.encryptionPublicKeyManager.rejectMsg(e),this.getState()}newUnsignedTypedMessage(e,t,r){const n=this.typedMessageManager.addUnapprovedMessageAsync(e,t,r);return this.sendUpdate(),this.opts.showUserConfirmation(),n}async signTypedMessage(e){E.default.info("MetaMaskController - eth_signTypedData");const t=e.metamaskId,{version:r}=e;try{const n=await this.typedMessageManager.approveMessage(e);"V1"!==r&&"string"==typeof n.data&&(n.data=JSON.parse(n.data));const i=await this.keyringController.signTypedMessage(n,{version:r});return this.typedMessageManager.setMsgStatusSigned(t,i),this.getState()}catch(e){throw E.default.info("MetaMaskController - eth_signTypedData failed.",e),this.typedMessageManager.errorMessage(t,e),e}}cancelTypedMessage(e){return this.typedMessageManager.rejectMsg(e),this.getState()}async getCurrentAccountEIP1559Compatibility(){return!0}async createCancelTransaction(e,t,r){await this.txController.createCancelTransaction(e,t,r);return await this.getState()}async createSpeedUpTransaction(e,t,r){await this.txController.createSpeedUpTransaction(e,t,r);return await this.getState()}estimateGas(e){return new Promise(((t,r)=>this.txController.txGasUtil.query.estimateGas(e,((e,n)=>e?r(e):t(n.toString(16))))))}markPasswordForgotten(){this.preferencesController.setPasswordForgotten(!0),this.sendUpdate()}unMarkPasswordForgotten(){this.preferencesController.setPasswordForgotten(!1),this.sendUpdate()}setupUntrustedCommunication({connectionStream:e,sender:t,subjectType:r}){const{usePhishDetect:n}=this.preferencesController.store.getState();let i;if(i=r||(t.id&&t.id!==this.extension.runtime.id?j.SUBJECT_TYPES.EXTENSION:j.SUBJECT_TYPES.WEBSITE),t.url){const{hostname:r}=new URL(t.url);if(n&&this.phishingController.test(r))return E.default.debug("MetaMask - sending phishing warning for",r),void this.sendPhishingWarning(e,r)}const o=(0,Z.setupMultiplex)(e);this.setupProviderConnection(o.createStream("metamask-provider"),t,i),t.url&&this.setupPublicConfig(o.createStream("publicConfig"))}setupTrustedCommunication(e,t){const r=(0,Z.setupMultiplex)(e);this.setupControllerConnection(r.createStream("controller")),this.setupProviderConnection(r.createStream("provider"),t,j.SUBJECT_TYPES.INTERNAL)}setupPhishingCommunication({connectionStream:e}){const{usePhishDetect:t}=this.preferencesController.store.getState();if(!t)return;const r=(0,Z.setupMultiplex)(e).createStream("metamask-phishing-safelist");r.on("data",(0,Ee.default)({safelistPhishingDomain:this.safelistPhishingDomain.bind(this)},r))}sendPhishingWarning(e,t){(0,Z.setupMultiplex)(e).createStream("phishing").write({hostname:t})}setupControllerConnection(e){const t=this.getApi();this.activeControllerConnections+=1,this.emit("controllerConnectionChanged",this.activeControllerConnections),e.on("data",(0,Ee.default)(t,e));const r=t=>{e._writableState.ended||e.write({jsonrpc:"2.0",method:"sendUpdate",params:[t]})};this.on("update",r),e.on("end",(()=>{this.activeControllerConnections-=1,this.emit("controllerConnectionChanged",this.activeControllerConnections),this.removeListener("update",r)}))}setupProviderConnection(e,t,r){let n,i;n=r===j.SUBJECT_TYPES.INTERNAL?j.ORIGIN_METAMASK:new URL(t.url).origin,t.id&&t.id!==this.extension.runtime.id&&this.subjectMetadataController.addSubjectMetadata({origin:n,extensionId:t.id,subjectType:j.SUBJECT_TYPES.EXTENSION}),t.tab&&t.tab.id&&(i=t.tab.id);const o=this.setupProviderEngine({origin:n,sender:t,subjectType:r,tabId:i}),s=(0,h.default)({engine:o}),c=this.addConnection(n,{engine:o});(0,a.default)(e,s,e,(e=>{o._middleware.forEach((e=>{e.destroy&&"function"==typeof e.destroy&&e.destroy()})),c&&this.removeConnection(n,c),e&&E.default.error(e)}))}setupProviderEngine({origin:e,subjectType:t,sender:r,tabId:n}){const i=new u.JsonRpcEngine,{blockTracker:o,provider:s}=this,a=(0,p.default)({provider:s,blockTracker:o}),c=(0,f.default)({provider:s,blockTracker:o});return c.events.on("notification",(e=>i.emit("notification",e))),i.push((0,$.default)({origin:e})),n&&i.push((0,Y.default)({tabId:n})),i.push((0,Q.default)({origin:e})),i.push(this.permissionLogController.createMiddleware()),i.push((0,_e.default)({trackEvent:this.metaMetricsController.trackEvent.bind(this.metaMetricsController),getMetricsState:this.metaMetricsController.store.getState.bind(this.metaMetricsController.store)})),t===j.SUBJECT_TYPES.WEBSITE&&i.push((0,J.default)({location:r.url,registerOnboarding:this.onboardingController.registerOnboarding})),i.push((0,K.createMethodMiddleware)({origin:e,subjectType:t,addSubjectMetadata:this.subjectMetadataController.addSubjectMetadata.bind(this.subjectMetadataController),getProviderState:this.getProviderState.bind(this),getUnlockPromise:this.appStateController.getUnlockPromise.bind(this.appStateController),handleWatchAssetRequest:this.tokensController.watchAsset.bind(this.tokensController),requestUserApproval:this.approvalController.addAndShowApprovalRequest.bind(this.approvalController),sendMetrics:this.metaMetricsController.trackEvent.bind(this.metaMetricsController),getAccounts:this.getPermittedAccounts.bind(this,e),getPermissionsForOrigin:this.permissionController.getPermissions.bind(this.permissionController,e),hasPermission:this.permissionController.hasPermission.bind(this.permissionController,e),requestAccountsPermission:this.permissionController.requestPermissions.bind(this.permissionController,{origin:e},{eth_accounts:{}}),requestPermissionsForOrigin:this.permissionController.requestPermissions.bind(this.permissionController,{origin:e}),addCustomRpc:async({chainId:e,blockExplorerUrl:t,ticker:r,chainName:n,rpcUrl:i}={})=>{await this.preferencesController.addToFrequentRpcList(i,e,r,n,{blockExplorerUrl:t})},findCustomRpcBy:this.findCustomRpcBy.bind(this),getCurrentChainId:this.networkController.getCurrentChainId.bind(this.networkController),getCurrentRpcUrl:this.networkController.getCurrentRpcUrl.bind(this.networkController),setProviderType:this.networkController.setProviderType.bind(this.networkController),updateRpcTarget:({rpcUrl:e,chainId:t,ticker:r,nickname:n})=>{this.networkController.setRpcTarget(e,t,r,n)},getWeb3ShimUsageState:this.alertController.getWeb3ShimUsageState.bind(this.alertController),setWeb3ShimUsageRecorded:this.alertController.setWeb3ShimUsageRecorded.bind(this.alertController)})),i.push(a),i.push(c.middleware),t!==j.SUBJECT_TYPES.INTERNAL&&i.push(this.permissionController.createPermissionMiddleware({origin:e})),i.push((0,g.providerAsMiddleware)(s)),i}setupPublicConfig(e){const t=(0,l.storeAsStream)(this.publicConfigStore);(0,a.default)(t,e,(e=>{t.destroy(),e&&E.default.error(e)}))}addConnection(e,{engine:t}){if(e===j.ORIGIN_METAMASK)return null;this.connections[e]||(this.connections[e]={});const r=(0,T.default)();return this.connections[e][r]={engine:t},r}removeConnection(e,t){const r=this.connections[e];r&&(delete r[t],0===Object.keys(r).length&&delete this.connections[e])}removeAllConnections(e){const t=this.connections[e];t&&Object.keys(t).forEach((t=>{this.removeConnection(e,t)}))}notifyConnections(e,t){const r=this.connections[e];r&&Object.values(r).forEach((e=>{e.engine&&e.engine.emit("notification",t)}))}notifyAllConnections(e){const t="function"==typeof e?t=>e(t):()=>e;Object.keys(this.connections).forEach((e=>{Object.values(this.connections[e]).forEach((async r=>{r.engine&&r.engine.emit("notification",await t(e))}))}))}async _onKeyringControllerUpdate(e){const{keyrings:t}=e,r=t.reduce(((e,{accounts:t})=>e.concat(t)),[]);r.length&&(this.preferencesController.syncAddresses(r),this.accountTracker.syncWithAddresses(r))}_onUnlock(){this.notifyAllConnections((async e=>({method:we.NOTIFICATION_NAMES.unlockStateChanged,params:{isUnlocked:!0,accounts:await this.getPermittedAccounts(e)}}))),this.emit("unlock")}_onLock(){this.notifyAllConnections({method:we.NOTIFICATION_NAMES.unlockStateChanged,params:{isUnlocked:!1}}),this.emit("lock")}_onStateUpdate(e){this.isClientOpenAndUnlocked=e.isUnlocked&&this._isClientOpen,this.notifyAllConnections({method:we.NOTIFICATION_NAMES.chainChanged,params:this.getProviderNetworkState(e)})}privateSendUpdate(){this.emit("update",this.getState())}isUnlocked(){return this.keyringController.memStore.getState().isUnlocked}getExternalPendingTransactions(e){return this.smartTransactionsController.getTransactions({addressFrom:e,status:"pending"})}async getPendingNonce(e){const{nonceDetails:t,releaseLock:r}=await this.txController.nonceTracker.getNonceLock(e),n=t.params.highestSuggested;return r(),n}async getNextNonce(e){const t=await this.txController.nonceTracker.getNonceLock(e);return t.releaseLock(),t.nextNonce}async migrateAddressBookState(e,t,r=!1){const{addressBook:n}=this.addressBookController.state;if(n[e])for(const i of Object.keys(n[e])){const o=n[e][i];this.addressBookController.set(i,o.name,t,o.memo),r||this.addressBookController.delete(e,i)}}async updateAndSetCustomRpc(e,t,r="ETH",n,i){return this.networkController.setRpcTarget(e,t,r,n,i),await this.preferencesController.updateRpc({rpcUrl:e,chainId:t,ticker:r,nickname:n,rpcPrefs:i}),e}async setCustomRpc(e,t,r="ETH",n="",i={}){const o=this.preferencesController.getFrequentRpcListDetail().find((t=>e===t.rpcUrl));return o?this.networkController.setRpcTarget(o.rpcUrl,o.chainId,o.ticker,o.nickname,i):(this.networkController.setRpcTarget(e,t,r,n,i),await this.preferencesController.addToFrequentRpcList(e,t,r,n,i)),e}async delCustomRpc(e){await this.preferencesController.removeFromFrequentRpcList(e)}findCustomRpcBy(e){const t=this.preferencesController.getFrequentRpcListDetail();for(const r of t)for(const t of Object.keys(e))if(r[t]===e[t])return r;return null}async initializeThreeBox(){await this.threeBoxController.init()}async setLedgerTransportPreference(e){const t=this.preferencesController.getLedgerTransportPreference(),r=this.preferencesController.setLedgerTransportPreference(e),n=await this.getKeyringForDevice(N.DEVICE_NAMES.LEDGER);return null!=n&&n.updateTransportMethod?n.updateTransportMethod(r).catch((e=>{throw this.preferencesController.setLedgerTransportPreference(t),e})):undefined}recordFirstTimeInfo(e){if(!("firstTimeInfo"in e)){const t=this.platform.getVersion();e.firstTimeInfo={version:t,date:Date.now()}}}set isClientOpen(e){this._isClientOpen=e,this.detectTokensController.isOpen=e}onClientClosed(){try{this.gasFeeController.stopPolling(),this.appStateController.clearPollingTokens()}catch(e){console.error(e)}}onEnvironmentTypeClosed(e){const t=j.POLLING_TOKEN_ENVIRONMENT_TYPES[e];this.appStateController.store.getState()[t].forEach((e=>{this.gasFeeController.disconnectPoller(e),this.appStateController.removePollingToken(e,t)}))}safelistPhishingDomain(e){return this.phishingController.bypass(e)}setLocked(){var e;const[t]=this.keyringController.getKeyringsByType(N.KEYRING_TYPES.TREZOR);t&&t.dispose();const[r]=this.keyringController.getKeyringsByType(N.KEYRING_TYPES.LEDGER);return null==r||null===(e=r.destroy)||void 0===e||e.call(r),this.keyringController.setLocked()}}r.default=Me}).call(this)}).call(this,e("_process"),e("buffer").Buffer)}}},{package:"$root$"}],[86,{lodash:5188},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:2,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=2;try{"etherscan"===t.data.config.provider.type&&(t.data.config.provider.type="rpc",t.data.config.provider.rpcTarget="https://rpc.metamask.io/")}catch(e){}return Promise.resolve(t)}};r.default=i}}},{package:"$root$"}],[87,{lodash:5188},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:3,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=3;try{"https://rawtestrpc.metamask.io/"===t.data.config.provider.rpcTarget&&(t.data.config.provider.rpcTarget="https://testrpc.metamask.io/")}catch(e){}return Promise.resolve(t)}};r.default=i}}},{package:"$root$"}],[88,{lodash:5188},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:4,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=4;try{if("rpc"!==t.data.config.provider.type)return Promise.resolve(t);switch(t.data.config.provider.rpcTarget){case"https://testrpc.metamask.io/":t.data.config.provider={type:"testnet"};break;case"https://rpc.metamask.io/":t.data.config.provider={type:"mainnet"}}}catch(e){}return Promise.resolve(t)}};r.default=i}}},{package:"$root$"}],[89,{"@babel/runtime/helpers/defineProperty":196,"@babel/runtime/helpers/interopRequireDefault":202,lodash:5188},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),o=e("lodash");function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var c={version:5,migrate(e){const t=(0,o.cloneDeep)(e);t.meta.version=5;try{const e=function(e){const{config:t}=e,r=a(a({},e),{},{KeyringController:{vault:e.vault,selectedAccount:t.selectedAccount,walletNicknames:e.walletNicknames}});return delete r.vault,delete r.walletNicknames,delete r.config.selectedAccount,r}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #5${e.stack}`)}return Promise.resolve(t)}};r.default=c}}},{package:"$root$"}],[9,{"../../../shared/constants/metametrics":6190,"../../../shared/constants/network":6191,"../../../shared/constants/time":6195,"../../../shared/constants/transaction":6196,"../../../shared/modules/network.utils":6204,"../../../shared/modules/string-utils":6208,"../../../ui/helpers/constants/common":6725,"../constants/contracts":4,"@babel/runtime/helpers/interopRequireDefault":202,loglevel:5198,"single-call-balance-checker-abi":5855,web3:6109},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("web3")),o=e("loglevel"),s=n(e("single-call-balance-checker-abi")),a=e("../constants/contracts"),c=e("../../../shared/constants/time"),l=e("../../../shared/constants/network"),u=(e("../../../shared/modules/network.utils"),e("../../../shared/modules/string-utils"));e("../../../ui/helpers/constants/common"),e("../../../shared/constants/transaction"),e("../../../shared/constants/metametrics");const d=3*c.MINUTE;r.default=class{constructor({interval:e=d,preferences:t,network:r,keyringMemStore:n,tokenList:i,tokensController:o,assetsContractController:s=null,trackMetaMetricsEvent:a}={}){var c,l,u;this.assetsContractController=s,this.tokensController=o,this.preferences=t,this.interval=e,this.network=r,this.keyringMemStore=n,this.tokenList=i,this.selectedAddress=null===(c=this.preferences)||void 0===c?void 0:c.store.getState().selectedAddress,this.tokenAddresses=null===(l=this.tokensController)||void 0===l?void 0:l.state.tokens.map((e=>e.address)),this.hiddenTokens=null===(u=this.tokensController)||void 0===u?void 0:u.state.ignoredTokens,this.detectedTokens=[],this._trackMetaMetricsEvent=a,null==t||t.store.subscribe((({selectedAddress:e,useTokenDetection:t})=>{this.selectedAddress===e&&this.useTokenDetection===t||(this.selectedAddress=e,this.useTokenDetection=t,this.restartTokenDetection())})),null==o||o.subscribe((({tokens:e=[],ignoredTokens:t=[],detectedTokens:r=[]})=>{this.tokenAddresses=e.map((e=>e.address)),this.hiddenTokens=t,this.detectedTokens=[]}))}async _getTokenBalances(e){const t=this.web3.eth.contract(s.default).at(a.SINGLE_CALL_BALANCES_ADDRESS);return new Promise(((r,n)=>{t.balances([this.selectedAddress],e,((e,t)=>e?n(e):r(t)))}))}async detectNewTokens(){if(!this.isActive)return;const{tokenList:e}=this._tokenList.state;if(this._network.store.getState().provider.chainId!==l.MAINNET_CHAIN_ID||0===Object.keys(e).length)return;const t=[];this.web3.setProvider(this._network._provider);for(const r in e)this.tokenAddresses.find((e=>(0,u.isEqualCaseInsensitive)(e,r)))||this.hiddenTokens.find((e=>(0,u.isEqualCaseInsensitive)(e,r)))||this.detectedTokens.find((({address:e})=>(0,u.isEqualCaseInsensitive)(e,r)))||t.push(r);const r=[t.slice(0,1e3),t.slice(1e3,t.length-1)];for(const t of r){let r;try{r=await this._getTokenBalances(t)}catch(e){return void(0,o.warn)("MetaMask - DetectTokensController single call balance fetch failed",e)}let n=[];n=t.filter(((e,t)=>{const n=r[t];return n&&!n.isZero()})),await Promise.all(n.map((t=>this.tokensController.addToken(t,e[t].symbol,e[t].decimals))))}}restartTokenDetection(){this.isActive&&this.selectedAddress&&(this.detectNewTokens(),this.interval=d)}set interval(e){this._handle&&clearInterval(this._handle),e&&(this._handle=setInterval((()=>{this.detectNewTokens()}),e))}set network(e){e&&(this._network=e,this.web3=new i.default(e._provider))}set keyringMemStore(e){e&&(this._keyringMemStore=e,this._keyringMemStore.subscribe((({isUnlocked:e})=>{this.isUnlocked!==e&&(this.isUnlocked=e,e&&this.restartTokenDetection())})))}set tokenList(e){e&&(this._tokenList=e)}get isActive(){return this.isOpen&&this.isUnlocked}}}}},{package:"$root$"}],[90,{"@babel/runtime/helpers/defineProperty":196,"@babel/runtime/helpers/interopRequireDefault":202,lodash:5188},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),o=e("lodash");function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var c={version:6,migrate(e){const t=(0,o.cloneDeep)(e);t.meta.version=6;try{const e=function(e){const t=e.KeyringController,r=a(a({},e),{},{PreferencesController:{selectedAddress:t.selectedAccount}});return delete r.KeyringController.selectedAccount,r}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #6${e.stack}`)}return Promise.resolve(t)}};r.default=c}}},{package:"$root$"}],[91,{"@babel/runtime/helpers/defineProperty":196,"@babel/runtime/helpers/interopRequireDefault":202,lodash:5188},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),o=e("lodash");function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var c={version:7,migrate(e){const t=(0,o.cloneDeep)(e);t.meta.version=7;try{const e=function(e){const t=a(a({},e),{},{TransactionManager:{transactions:e.transactions||[],gasMultiplier:e.gasMultiplier||1}});return delete t.transactions,delete t.gasMultiplier,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #7${e.stack}`)}return Promise.resolve(t)}};r.default=c}}},{package:"$root$"}],[92,{"@babel/runtime/helpers/defineProperty":196,"@babel/runtime/helpers/interopRequireDefault":202,lodash:5188},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/defineProperty")),o=e("lodash");function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var c={version:8,migrate(e){const t=(0,o.cloneDeep)(e);t.meta.version=8;try{const e=function(e){const t=a(a({},e),{},{NoticeController:{noticesList:e.noticesList||[]}});return delete t.noticesList,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #8${e.stack}`)}return Promise.resolve(t)}};r.default=c}}},{package:"$root$"}],[93,{lodash:5188},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:9,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=9;try{const e=function(e){const t=(0,n.merge)({},e,{CurrencyController:{currentCurrency:e.currentFiat||e.fiatCurrency||"USD",conversionRate:e.conversionRate,conversionDate:e.conversionDate}});return delete t.currentFiat,delete t.fiatCurrency,delete t.conversionRate,delete t.conversionDate,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #9${e.stack}`)}return Promise.resolve(t)}};r.default=i}}},{package:"$root$"}],[94,{lodash:5188},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:10,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=10;try{const e=function(e){const t=(0,n.merge)({},e,{ShapeShiftController:{shapeShiftTxList:e.shapeShiftTxList||[]}});return delete t.shapeShiftTxList,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #10${e.stack}`)}return Promise.resolve(t)}};r.default=i}}},{package:"$root$"}],[95,{lodash:5188},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:11,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=11;try{const e=function(e){const t=e;return delete t.TOSHash,delete t.isDisclaimerConfirmed,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #11${e.stack}`)}return Promise.resolve(t)}};r.default=i}}},{package:"$root$"}],[96,{lodash:5188},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:12,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=12;try{const e=function(e){const t=e;return t.NoticeController.noticesList.forEach((e=>{e.read&&(e.body="")})),t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #12${e.stack}`)}return Promise.resolve(t)}};r.default=i}}},{package:"$root$"}],[97,{lodash:5188},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:13,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=13;try{const e=function(e){const t=e,{config:r}=t;r&&r.provider&&"testnet"===r.provider.type&&(t.config.provider.type="ropsten");return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #13${e.stack}`)}return Promise.resolve(t)}};r.default=i}}},{package:"$root$"}],[98,{lodash:5188},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash");var i={version:14,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=14;try{const e=function(e){const t=e;return t.NetworkController={},t.NetworkController.provider=t.config.provider,delete t.config.provider,t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #14${e.stack}`)}return Promise.resolve(t)}};r.default=i}}},{package:"$root$"}],[99,{"../../../shared/constants/transaction":6196,lodash:5188},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("lodash"),i=e("../../../shared/constants/transaction");var o={version:15,migrate(e){const t=(0,n.cloneDeep)(e);t.meta.version=15;try{const e=function(e){const t=e,{TransactionController:r}=t;if(r&&r.transactions){const{transactions:e}=r;t.TransactionController.transactions=e.map((e=>e.err?("Gave up submitting tx."===e.err.message&&(e.status=i.TRANSACTION_STATUSES.FAILED),e):e))}return t}(t.data);t.data=e}catch(e){console.warn(`MetaMask Migration #15${e.stack}`)}return Promise.resolve(t)}};r.default=o}}},{package:"$root$"}],[3,{"../../shared/constants/app":6186,"../../shared/constants/metametrics":6190,"../../shared/constants/time":6195,"../../shared/modules/mv3.utils":6203,"../../shared/modules/object.utils":6205,"./first-time-state":39,"./lib/createStreamSink":49,"./lib/ens-ipfs/setup":56,"./lib/get-first-preferred-lang-code":58,"./lib/getObjStructure":59,"./lib/local-store":60,"./lib/migrator":63,"./lib/network-store":64,"./lib/notification-manager":65,"./lib/setupSentry":81,"./lib/util":84,"./metamask-controller":85,"./migrations":159,"./platforms/extension":160,"@babel/runtime/helpers/defineProperty":196,"@babel/runtime/helpers/interopRequireDefault":202,"@metamask/obs-store":1206,"@sentry/browser":1585,_process:5430,"debounce-stream":2301,"end-of-stream":2389,"eth-rpc-errors":2489,"extension-port-stream":2628,loglevel:5198,pump:5529,"webextension-polyfill":6161},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){var r=e("@babel/runtime/helpers/interopRequireDefault"),n=r(e("@babel/runtime/helpers/defineProperty")),i=r(e("end-of-stream")),o=r(e("pump")),s=r(e("debounce-stream")),a=r(e("loglevel")),c=r(e("webextension-polyfill")),l=e("@metamask/obs-store"),u=r(e("extension-port-stream")),d=e("@sentry/browser"),h=e("eth-rpc-errors"),p=e("../../shared/constants/app"),f=e("../../shared/constants/time"),g=e("../../shared/constants/metametrics"),m=e("../../shared/modules/mv3.utils"),b=e("../../shared/modules/object.utils"),y=r(e("./migrations")),v=r(e("./lib/migrator")),E=r(e("./platforms/extension")),w=r(e("./lib/local-store")),_=r(e("./lib/network-store")),S=e("./lib/setupSentry"),C=r(e("./lib/createStreamSink")),k=N(e("./lib/notification-manager")),T=N(e("./metamask-controller")),M=r(e("./first-time-state")),O=r(e("./lib/get-first-preferred-lang-code")),P=r(e("./lib/getObjStructure")),R=r(e("./lib/ens-ipfs/setup")),A=e("./lib/util");function I(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(I=function(e){return e?r:t})(e)}function N(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=I(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}const{sentry:x}=global,U=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},M.default),L={[p.ENVIRONMENT_TYPE_POPUP]:!0,[p.ENVIRONMENT_TYPE_NOTIFICATION]:!0,[p.ENVIRONMENT_TYPE_FULLSCREEN]:!0},j=["trezor-connect"];a.default.setDefaultLevel(t.env.METAMASK_DEBUG?"debug":"info");const B=new E.default,F=new k.default;global.METAMASK_NOTIFIER=F;let z=!1,G=!1,q=!1;const W={},H={},V=t.env.IN_TEST,Q=V?new _.default:new w.default;let K;(V||t.env.METAMASK_DEBUG)&&(global.metamaskGetState=Q.get.bind(Q));const $=new URL("https://metamask.github.io/phishing-warning/v1.1.0/"),Y=async e=>{c.default.runtime.onConnect.removeListener(Y),await J(e),a.default.info("MetaMask initialization complete.")};async function J(e){const t=await async function(){const e=new v.default({migrations:y.default});e.on("error",console.warn),K=await Q.get()||e.generateInitialState(U),K&&!K.data&&(K=e.generateInitialState(U),x.captureMessage("MetaMask - Empty vault found - unable to recover"));if(e.on("error",(e=>{const t=(0,P.default)(K);x.captureException(e,{extra:{vaultStructure:t}})})),K=await e.migrateData(K),!K)throw new Error("MetaMask - migrator returned undefined");Q.isSupported?Q.set(K):setTimeout((()=>{throw new Error("MetaMask - Localstore not supported")}));return K.data}(),r=await(0,O.default)();await function(e,t,r){const n=new T.default({infuraProjectId:"9aa3d95b3bc440fa88ea12eaa4456161",showUserConfirmation:X,openPopup:ee,initState:e,initLangCode:t,platform:B,notificationManager:F,browser:c.default,getRequestAccountTabIds:()=>H,getOpenMetamaskTabsIds:()=>W});function f(e){return K.data=e,K}(0,R.default)({getCurrentChainId:n.networkController.getCurrentChainId.bind(n.networkController),getIpfsGateway:n.preferencesController.getIpfsGateway.bind(n.preferencesController),provider:n.provider}),(0,o.default)((0,l.storeAsStream)(n.store),(0,s.default)(1e3),(0,l.storeTransformStream)(f),(0,C.default)(E),(e=>{a.default.error("MetaMask - Persistence pipeline failed",e)})),y=n,global.sentryHooks.getSentryState=function(){const e=y.getState(),t=(0,b.maskObject)({metamask:e},S.SENTRY_STATE);return{browser:window.navigator.userAgent,store:t,version:B.getVersion()}};var y;let v=!1;async function E(e){if(!e)throw new Error("MetaMask - updated state is missing");if(!e.data)throw new Error("MetaMask - updated state does not have data");if(Q.isSupported)try{await Q.set(e),v&&(v=!1)}catch(e){v||(v=!0,(0,d.captureException)(e)),a.default.error("error setting state in local store:",e)}}(0,m.isManifestV3)()&&r&&M(r);c.default.runtime.onConnect.addListener(M),c.default.runtime.onConnectExternal.addListener(O);const w=()=>z||Boolean(Object.keys(W).length)||G,_=(e,t)=>{if(!1===e)n.onClientClosed();else{if(t===p.ENVIRONMENT_TYPE_FULLSCREEN&&Boolean(Object.keys(W).length))return;n.onEnvironmentTypeClosed(t)}};function M(e){var t;const r=e.name;if(j.includes(e.name))return;let o=!1;o=(0,A.getPlatform)()===p.PLATFORM_FIREFOX?L[r]:e.sender.origin===`chrome-extension://${c.default.runtime.id}`;const s=null!==(t=e.sender)&&void 0!==t&&t.url?new URL(e.sender.url):null;if(o){const t=new u.default(e);if(n.isClientOpen=!0,n.setupTrustedCommunication(t,e.sender),(0,m.isManifestV3)()&&e.postMessage({name:"CONNECTION_READY"}),r===p.ENVIRONMENT_TYPE_POPUP&&(z=!0,(0,i.default)(t,(()=>{z=!1;const e=w();n.isClientOpen=e,_(e,p.ENVIRONMENT_TYPE_POPUP)}))),r===p.ENVIRONMENT_TYPE_NOTIFICATION&&(G=!0,(0,i.default)(t,(()=>{G=!1;const e=w();n.isClientOpen=e,_(e,p.ENVIRONMENT_TYPE_NOTIFICATION)}))),r===p.ENVIRONMENT_TYPE_FULLSCREEN){const r=e.sender.tab.id;W[r]=!0,(0,i.default)(t,(()=>{delete W[r];const e=w();n.isClientOpen=e,_(e,p.ENVIRONMENT_TYPE_FULLSCREEN)}))}}else if(s&&s.origin===$.origin&&s.pathname===$.pathname){const t=new u.default(e);n.setupPhishingCommunication({connectionStream:t})}else{if(e.sender&&e.sender.tab&&e.sender.url){const t=e.sender.tab.id,r=new URL(e.sender.url),{origin:n}=r;e.onMessage.addListener((e=>{e.data&&"eth_requestAccounts"===e.data.method&&(H[n]=t)}))}O(e)}}function O(e){const t=new u.default(e);n.setupUntrustedCommunication({connectionStream:t,sender:e.sender})}function P(){let e="";const t=I();t&&(e=String(t)),(0,m.isManifestV3)()?(c.default.action.setBadgeText({text:e}),c.default.action.setBadgeBackgroundColor({color:"#037DD6"})):(c.default.browserAction.setBadgeText({text:e}),c.default.browserAction.setBadgeBackgroundColor({color:"#037DD6"}))}function I(){const e=n.txController.getUnapprovedTxCount(),{unapprovedMsgCount:t}=n.messageManager,{unapprovedPersonalMsgCount:r}=n.personalMessageManager,{unapprovedDecryptMsgCount:i}=n.decryptMessageManager,{unapprovedEncryptionPublicKeyMsgCount:o}=n.encryptionPublicKeyManager,{unapprovedTypedMessagesCount:s}=n.typedMessageManager;return e+t+r+i+o+s+n.approvalController.getTotalApprovalCount()+n.appStateController.waitingForUnlock.length}function N(){Object.keys(n.txController.txStateManager.getUnapprovedTxList()).forEach((e=>n.txController.txStateManager.setTxStatusRejected(e))),n.messageManager.messages.filter((e=>"unapproved"===e.status)).forEach((e=>n.messageManager.rejectMsg(e.id,g.REJECT_NOTFICIATION_CLOSE_SIG))),n.personalMessageManager.messages.filter((e=>"unapproved"===e.status)).forEach((e=>n.personalMessageManager.rejectMsg(e.id,g.REJECT_NOTFICIATION_CLOSE_SIG))),n.typedMessageManager.messages.filter((e=>"unapproved"===e.status)).forEach((e=>n.typedMessageManager.rejectMsg(e.id,g.REJECT_NOTFICIATION_CLOSE_SIG))),n.decryptMessageManager.messages.filter((e=>"unapproved"===e.status)).forEach((e=>n.decryptMessageManager.rejectMsg(e.id,g.REJECT_NOTFICIATION_CLOSE))),n.encryptionPublicKeyManager.messages.filter((e=>"unapproved"===e.status)).forEach((e=>n.encryptionPublicKeyManager.rejectMsg(e.id,g.REJECT_NOTFICIATION_CLOSE))),n.approvalController.clear(h.ethErrors.provider.userRejectedRequest()),P()}return P(),n.txController.on(T.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE,P),n.messageManager.on(T.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE,P),n.personalMessageManager.on(T.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE,P),n.decryptMessageManager.on(T.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE,P),n.encryptionPublicKeyManager.on(T.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE,P),n.typedMessageManager.on(T.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE,P),n.appStateController.on(T.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE,P),n.controllerMessenger.subscribe(T.METAMASK_CONTROLLER_EVENTS.APPROVAL_STATE_CHANGE,P),F.on(k.NOTIFICATION_MANAGER_EVENTS.POPUP_CLOSED,(({automaticallyClosed:e})=>{e?I()>0&&X():N()})),Promise.resolve()}(t,r,e),await async function(){let e;try{const t=new URL("https://metamask.github.io/phishing-warning/v1.1.0/");let r,n;t.hash="#extensionStartup",e=window.document.createElement("iframe"),e.setAttribute("src",t.href),e.setAttribute("sandbox","allow-scripts allow-same-origin");const i=new Promise(((e,t)=>{r=e,n=t}));e.addEventListener("load",r),window.document.body.appendChild(e),setTimeout((()=>n(new Z)),1e3),await i}catch(e){e instanceof Z?console.warn("Phishing warning page timeout; page not guaraneteed to work offline."):console.error("Failed to initialize phishing warning page",e)}finally{e&&e.remove()}}(),a.default.info("MetaMask initialization complete.")}(0,m.isManifestV3)()?c.default.runtime.onConnect.addListener(Y):J().catch(a.default.error);class Z extends Error{constructor(){super("Timeout failed")}}async function X(){const e=await B.getActiveTabs(),t=Boolean(e.find((e=>W[e.id]))),r=e.length>0&&e[0].extData&&e[0].extData.indexOf("vivaldi_tab")>-1;if(!q&&(r||!z)&&!t){q=!0;try{await F.showPopup()}finally{q=!1}}}async function ee(){await X(),await new Promise((e=>{const t=setInterval((()=>{G||(clearInterval(t),e())}),f.SECOND)}))}c.default.runtime.onInstalled.addListener((({reason:e})=>{"install"!==e||t.env.METAMASK_DEBUG||t.env.IN_TEST||B.openExtensionInBrowser()}))}).call(this)}).call(this,e("_process"))}}},{package:"$root$"}]],[3],{});