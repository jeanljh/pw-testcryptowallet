import{i as C,o as P}from"../../chunk-NE6JW6I4.js";import{m as g,n as c,p as u}from"../../chunk-RXSWFOXN.js";c();u();c();u();var S=class{constructor(){this.cache=new Map,this.changeListeners=new Set,this.QUOTA_BYTES=10485760*5,this.usedKeys=new Set}get(e=null,t){this.usedKeys.add(e);let r=e,n=t;typeof e=="function"&&(n=e,r=null);let s=()=>{let i={};return r===null?this.cache.forEach((o,h)=>{i[h]=o}):typeof r=="string"?this.cache.has(r)&&(i[r]=this.cache.get(r)):Array.isArray(r)?r.forEach(o=>{this.cache.has(o)&&(i[o]=this.cache.get(o))}):typeof r=="object"&&r!==null&&Object.entries(r).forEach(([o,h])=>{i[o]=this.cache.has(o)?this.cache.get(o):h}),i};if(n&&typeof n=="function"){try{let i=s();setTimeout(()=>n(i),0)}catch{setTimeout(()=>n({}),0)}return}return Promise.resolve().then(s)}set(e,t){this.usedKeys.add(e);let r=async()=>{if(!e||typeof e!="object")throw new Error("Items must be an object");let n={};Object.entries(e).forEach(([s,i])=>{let o=this.cache.get(s);n[s]={oldValue:o,newValue:i},this.cache.set(s,i)}),this.notifyListeners(n)};if(t&&typeof t=="function"){r().then(()=>t()).catch(()=>t());return}return r()}remove(e,t){let r=async()=>{let n=Array.isArray(e)?e:[e],s={};n.forEach(i=>{if(this.cache.has(i)){let o=this.cache.get(i);s[i]={oldValue:o,newValue:void 0},this.cache.delete(i)}}),Object.keys(s).length>0&&this.notifyListeners(s)};if(t&&typeof t=="function"){r().then(()=>t()).catch(()=>t());return}return r()}clear(e){let t=async()=>{let r={};this.cache.forEach((n,s)=>{r[s]={oldValue:n,newValue:void 0}}),this.cache.clear(),this.notifyListeners(r)};if(e&&typeof e=="function"){t().then(()=>e()).catch(()=>e());return}return t()}getKeys(e){let t=()=>Array.from(this.cache.keys());if(e&&typeof e=="function"){try{let r=t();setTimeout(()=>e(r),0)}catch{setTimeout(()=>e([]),0)}return}return Promise.resolve(t())}setDataDirectly(e){e&&typeof e=="object"&&(this.cache.clear(),Object.entries(e).forEach(([t,r])=>{this.cache.set(t,r)}))}addChangeListener(e){typeof e=="function"&&this.changeListeners.add(e)}removeChangeListener(e){this.changeListeners.delete(e)}notifyListeners(e){this.changeListeners.size>0&&this.changeListeners.forEach(t=>{t(e,"local")})}},p=new S,O={local:p,onChanged:{addListener:a=>p.addChangeListener(a),removeListener:a=>p.removeChangeListener(a)}},l=O;c();u();var w=class{constructor(){this.cookies=new Map,this.syncQueue=new Set,this.syncTimer=null,this.SYNC_DELAY=100}get(){let e=[];return this.cookies.forEach((r,n)=>{if(this.isExpired(r)){this.cookies.delete(n);return}e.push(`${n}${n?"=":""}${r.value}`)}),e.join("; ")}set(e){if(typeof e!="string")return;let t=this.parseCookieString(e);if(!t)return;let{name:r,value:n,...s}=t;n===""||typeof s.expires=="string"&&new Date(s.expires)<new Date?this.cookies.delete(r):this.cookies.set(r,{value:n,...s,createdAt:new Date().toISOString()}),this.syncQueue.add(r)}parseCookieString(e){let t=e.split(";").map(h=>h.trim());if(t.length===0)return null;let r=t[0],n=r.indexOf("=");if(n===-1)return null;let s=r.substring(0,n).trim(),i=r.substring(n+1).trim(),o={};for(let h=1;h<t.length;h++){let d=t[h],y=d.indexOf("=");if(y===-1)o[d.toLowerCase()]=!0;else{let E=d.substring(0,y).trim().toLowerCase(),D=d.substring(y+1).trim();o[E]=D}}return{name:s,value:i,...o}}isExpired(e){if(!e.expires)return!1;try{return new Date(e.expires)<new Date}catch{return!1}}setDataDirectly(e){!e||typeof e!="string"||(this.cookies.clear(),e.trim()&&e.split("; ").forEach(r=>{let n=r.indexOf("=");if(n!==-1){let s=r.substring(0,n).trim(),i=r.substring(n+1).trim();this.cookies.set(s,{value:i,createdAt:new Date().toISOString()})}}))}clear(){this.cookies.forEach((e,t)=>{this.syncQueue.add(t)}),this.cookies.clear()}},A=new w,m=A;c();u();var v=class{constructor(){this.cache=new Map,this.syncQueue=new Set,this.syncTimer=null,this.SYNC_DELAY=100,this.usedKeys=new Set}getItem(e){this.usedKeys.add(e);let t=this.cache.get(e);return t!==void 0?t:null}setItem(e,t){this.usedKeys.add(e);let r=String(t);this.cache.set(e,r),this.syncQueue.add(e)}removeItem(e){this.usedKeys.add(e),this.cache.delete(e),this.syncQueue.add(e)}clear(){this.cache.clear()}key(e){return Array.from(this.cache.keys())[e]||null}get length(){return this.cache.size}setDataDirectly(e){e&&typeof e=="object"&&(this.cache.clear(),Object.entries(e).forEach(([t,r])=>{this.cache.set(t,String(r))}))}},T=new v,L=T;c();u();var b=class{constructor(){this.cache=new Map,this.syncQueue=new Set,this.syncTimer=null,this.SYNC_DELAY=100,this.usedKeys=new Set}getItem(e){this.usedKeys.add(e);let t=this.cache.get(e);return t!==void 0?t:null}setItem(e,t){this.usedKeys.add(e);let r=String(t);this.cache.set(e,r),this.syncQueue.add(e)}removeItem(e){this.usedKeys.add(e),this.cache.delete(e),this.syncQueue.add(e)}clear(){this.cache.clear()}key(e){return Array.from(this.cache.keys())[e]||null}get length(){return this.cache.size}setDataDirectly(e){e&&typeof e=="object"&&(this.cache.clear(),Object.entries(e).forEach(([t,r])=>{this.cache.set(t,String(r))}))}},j=new b,x=j;chrome.runtime={id:"OKX-SES-iframe",reload:()=>{},getManifest:()=>({version:g.env.APP_VERSION}),getURL:a=>a,getPlatformInfo:()=>Promise.resolve({os:"win"})};window.browser?window.browser.runtime=window.chrome.runtime:Object.defineProperty(window,"browser",{value:{runtime:window.chrome.runtime},writable:!1,configurable:!1});function I(){Object.defineProperty(document,"cookie",{get(){return m.get()},set(a){m.set(a)},configurable:!1}),document.cookie_setCookieDirectly=a=>{m.setDataDirectly(a)},Object.defineProperty(window,"localStorage",{value:L,writable:!1,configurable:!1}),Object.defineProperty(window,"sessionStorage",{value:x,writable:!1,configurable:!1}),window.browser?Object.defineProperty(window.browser,"storage",{value:l,writable:!1,configurable:!1}):Object.defineProperty(window,"browser",{value:{storage:l},writable:!1,configurable:!1}),window.chrome?Object.defineProperty(window.chrome,"storage",{value:l,writable:!1,configurable:!1}):Object.defineProperty(window,"chrome",{value:{storage:l},writable:!1,configurable:!1})}P()!==C&&I();
//# sourceMappingURL=index.js.map
