import{a as Me}from"./chunk-BXET464F.js";import{a as St}from"./chunk-P7T5PXZK.js";import{k as vt}from"./chunk-RZ6UTWVB.js";import"./chunk-KW3KLDWA.js";import"./chunk-M7JGFMJS.js";import{c as y,o as u,q as d}from"./chunk-4J7XGGEQ.js";var W=y(w=>{u();d();Object.defineProperty(w,"__esModule",{value:!0});w.decode=w.encode=w.unescape=w.escape=w.pad=void 0;var Le=Me();function _e(e){return`${e}${"=".repeat(4-(e.length%4||4))}`}w.pad=_e;function Ue(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}w.escape=Ue;function ke(e){return _e(e).replace(/-/g,"+").replace(/_/g,"/")}w.unescape=ke;function Et(e){return Ue((0,Le.fromByteArray)(new TextEncoder().encode(e)))}w.encode=Et;function Pt(e){return new TextDecoder().decode((0,Le.toByteArray)(_e(ke(e))))}w.decode=Pt});var z=y(b=>{u();d();Object.defineProperty(b,"__esModule",{value:!0});b.output=b.exists=b.hash=b.bytes=b.bool=b.number=b.isBytes=void 0;function Y(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`positive integer expected, not ${e}`)}b.number=Y;function Ie(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}b.bool=Ie;function De(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}b.isBytes=De;function ge(e,...t){if(!De(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}b.bytes=ge;function Ne(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Y(e.outputLen),Y(e.blockLen)}b.hash=Ne;function $e(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}b.exists=$e;function Fe(e,t){ge(e);let r=t.outputLen;if(e.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}b.output=Fe;var Ot={number:Y,bool:Ie,bytes:ge,hash:Ne,exists:$e,output:Fe};b.default=Ot});var Ve=y(Z=>{u();d();Object.defineProperty(Z,"__esModule",{value:!0});Z.crypto=void 0;Z.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var J=y(a=>{u();d();Object.defineProperty(a,"__esModule",{value:!0});a.randomBytes=a.wrapXOFConstructorWithOpts=a.wrapConstructorWithOpts=a.wrapConstructor=a.checkOpts=a.Hash=a.concatBytes=a.toBytes=a.utf8ToBytes=a.asyncLoop=a.nextTick=a.hexToBytes=a.bytesToHex=a.byteSwap32=a.byteSwapIfBE=a.byteSwap=a.isLE=a.rotl=a.rotr=a.createView=a.u32=a.u8=a.isBytes=void 0;var be=Ve(),xe=z();function jt(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}a.isBytes=jt;var Tt=e=>new Uint8Array(e.buffer,e.byteOffset,e.byteLength);a.u8=Tt;var qt=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4));a.u32=qt;var At=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);a.createView=At;var Bt=(e,t)=>e<<32-t|e>>>t;a.rotr=Bt;var Ht=(e,t)=>e<<t|e>>>32-t>>>0;a.rotl=Ht;a.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;var Mt=e=>e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255;a.byteSwap=Mt;a.byteSwapIfBE=a.isLE?e=>e:e=>(0,a.byteSwap)(e);function Lt(e){for(let t=0;t<e.length;t++)e[t]=(0,a.byteSwap)(e[t])}a.byteSwap32=Lt;var Ut=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function kt(e){(0,xe.bytes)(e);let t="";for(let r=0;r<e.length;r++)t+=Ut[e[r]];return t}a.bytesToHex=kt;var E={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function We(e){if(e>=E._0&&e<=E._9)return e-E._0;if(e>=E._A&&e<=E._F)return e-(E._A-10);if(e>=E._a&&e<=E._f)return e-(E._a-10)}function It(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);let t=e.length,r=t/2;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);let n=new Uint8Array(r);for(let s=0,i=0;s<r;s++,i+=2){let o=We(e.charCodeAt(i)),h=We(e.charCodeAt(i+1));if(o===void 0||h===void 0){let l=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+l+'" at index '+i)}n[s]=o*16+h}return n}a.hexToBytes=It;var Dt=async()=>{};a.nextTick=Dt;async function Nt(e,t,r){let n=Date.now();for(let s=0;s<e;s++){r(s);let i=Date.now()-n;i>=0&&i<t||(await(0,a.nextTick)(),n+=i)}}a.asyncLoop=Nt;function Je(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}a.utf8ToBytes=Je;function ee(e){return typeof e=="string"&&(e=Je(e)),(0,xe.bytes)(e),e}a.toBytes=ee;function $t(...e){let t=0;for(let n=0;n<e.length;n++){let s=e[n];(0,xe.bytes)(s),t+=s.length}let r=new Uint8Array(t);for(let n=0,s=0;n<e.length;n++){let i=e[n];r.set(i,s),s+=i.length}return r}a.concatBytes=$t;var we=class{clone(){return this._cloneInto()}};a.Hash=we;var Ft={}.toString;function Vt(e,t){if(t!==void 0&&Ft.call(t)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(e,t)}a.checkOpts=Vt;function Wt(e){let t=n=>e().update(ee(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}a.wrapConstructor=Wt;function Jt(e){let t=(n,s)=>e(s).update(ee(n)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=n=>e(n),t}a.wrapConstructorWithOpts=Jt;function Gt(e){let t=(n,s)=>e(s).update(ee(n)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=n=>e(n),t}a.wrapXOFConstructorWithOpts=Gt;function Rt(e=32){if(be.crypto&&typeof be.crypto.getRandomValues=="function")return be.crypto.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}a.randomBytes=Rt});var Re=y(M=>{u();d();Object.defineProperty(M,"__esModule",{value:!0});M.hmac=M.HMAC=void 0;var te=z(),Ge=J(),G=class extends Ge.Hash{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,(0,te.hash)(t);let n=(0,Ge.toBytes)(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?t.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=t.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(t){return(0,te.exists)(this),this.iHash.update(t),this}digestInto(t){(0,te.exists)(this),(0,te.bytes)(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:s,destroyed:i,blockLen:o,outputLen:h}=this;return t=t,t.finished=s,t.destroyed=i,t.blockLen=o,t.outputLen=h,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};M.HMAC=G;var Kt=(e,t,r)=>new G(e,t).update(r).digest();M.hmac=Kt;M.hmac.create=(e,t)=>new G(e,t)});var Ke=y(T=>{u();d();Object.defineProperty(T,"__esModule",{value:!0});T.HashMD=T.Maj=T.Chi=void 0;var me=z(),R=J();function Xt(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),h=Number(r&i),l=n?4:0,p=n?0:4;e.setUint32(t+l,o,n),e.setUint32(t+p,h,n)}var Qt=(e,t,r)=>e&t^~e&r;T.Chi=Qt;var Yt=(e,t,r)=>e&t^e&r^t&r;T.Maj=Yt;var Ce=class extends R.Hash{constructor(t,r,n,s){super(),this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=(0,R.createView)(this.buffer)}update(t){(0,me.exists)(this);let{view:r,buffer:n,blockLen:s}=this;t=(0,R.toBytes)(t);let i=t.length;for(let o=0;o<i;){let h=Math.min(s-this.pos,i-o);if(h===s){let l=(0,R.createView)(t);for(;s<=i-o;o+=s)this.process(l,o);continue}n.set(t.subarray(o,o+h),this.pos),this.pos+=h,o+=h,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){(0,me.exists)(this),(0,me.output)(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:s,isLE:i}=this,{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let c=o;c<s;c++)r[c]=0;Xt(n,s-8,BigInt(this.length*8),i),this.process(n,0);let h=(0,R.createView)(t),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let p=l/4,f=this.get();if(p>f.length)throw new Error("_sha2: outputLen bigger than state");for(let c=0;c<p;c++)h.setUint32(4*c,f[c],i)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:n,length:s,finished:i,destroyed:o,pos:h}=this;return t.length=s,t.pos=h,t.finished=i,t.destroyed=o,s%r&&t.buffer.set(n),t}};T.HashMD=Ce});var Ee=y(k=>{u();d();Object.defineProperty(k,"__esModule",{value:!0});k.sha224=k.sha256=void 0;var ve=Ke(),x=J(),zt=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),q=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),A=new Uint32Array(64),re=class extends ve.HashMD{constructor(){super(64,32,8,!1),this.A=q[0]|0,this.B=q[1]|0,this.C=q[2]|0,this.D=q[3]|0,this.E=q[4]|0,this.F=q[5]|0,this.G=q[6]|0,this.H=q[7]|0}get(){let{A:t,B:r,C:n,D:s,E:i,F:o,G:h,H:l}=this;return[t,r,n,s,i,o,h,l]}set(t,r,n,s,i,o,h,l){this.A=t|0,this.B=r|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=h|0,this.H=l|0}process(t,r){for(let c=0;c<16;c++,r+=4)A[c]=t.getUint32(r,!1);for(let c=16;c<64;c++){let S=A[c-15],v=A[c-2],j=(0,x.rotr)(S,7)^(0,x.rotr)(S,18)^S>>>3,V=(0,x.rotr)(v,17)^(0,x.rotr)(v,19)^v>>>10;A[c]=V+A[c-7]+j+A[c-16]|0}let{A:n,B:s,C:i,D:o,E:h,F:l,G:p,H:f}=this;for(let c=0;c<64;c++){let S=(0,x.rotr)(h,6)^(0,x.rotr)(h,11)^(0,x.rotr)(h,25),v=f+S+(0,ve.Chi)(h,l,p)+zt[c]+A[c]|0,V=((0,x.rotr)(n,2)^(0,x.rotr)(n,13)^(0,x.rotr)(n,22))+(0,ve.Maj)(n,s,i)|0;f=p,p=l,l=h,h=o+v|0,o=i,i=s,s=n,n=v+V|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,h=h+this.E|0,l=l+this.F|0,p=p+this.G|0,f=f+this.H|0,this.set(n,s,i,o,h,l,p,f)}roundClean(){A.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},Se=class extends re{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}};k.sha256=(0,x.wrapConstructor)(()=>new re);k.sha224=(0,x.wrapConstructor)(()=>new Se)});var rt=y(I=>{u();d();Object.defineProperty(I,"__esModule",{value:!0});I.joseToDer=I.derToJose=void 0;var Qe=Me(),Ye=W();function Pe(e){return(e/8|0)+(e%8===0?0:1)}var Zt={ES256:Pe(256),ES384:Pe(384),ES512:Pe(521)};function ze(e){let t=Zt[e];if(t)return t;throw new Error(`Unknown algorithm "${e}"`)}var ne=128,Ze=0,er=32,tr=16,rr=2,et=tr|er|Ze<<6,se=rr|Ze<<6;function tt(e){if(e instanceof Uint8Array)return e;if(typeof e=="string")return(0,Qe.toByteArray)((0,Ye.pad)(e));throw new TypeError("ECDSA signature must be a Base64 string or a Uint8Array")}function nr(e,t){let r=tt(e),n=ze(t),s=n+1,i=r.length,o=0;if(r[o++]!==et)throw new Error('Could not find expected "seq"');let h=r[o++];if(h===(ne|1)&&(h=r[o++]),i-o<h)throw new Error(`"seq" specified length of "${h}", only "${i-o}" remaining`);if(r[o++]!==se)throw new Error('Could not find expected "int" for "r"');let l=r[o++];if(i-o-2<l)throw new Error(`"r" specified length of "${l}", only "${i-o-2}" available`);if(s<l)throw new Error(`"r" specified length of "${l}", max of "${s}" is acceptable`);let p=o;if(o+=l,r[o++]!==se)throw new Error('Could not find expected "int" for "s"');let f=r[o++];if(i-o!==f)throw new Error(`"s" specified length of "${f}", expected "${i-o}"`);if(s<f)throw new Error(`"s" specified length of "${f}", max of "${s}" is acceptable`);let c=o;if(o+=f,o!==i)throw new Error(`Expected to consume entire array, but "${i-o}" bytes remain`);let S=n-l,v=n-f,j=new Uint8Array(S+l+v+f);for(o=0;o<S;++o)j[o]=0;j.set(r.subarray(p+Math.max(-S,0),p+l),o),o=n;for(let V=o;o<V+v;++o)j[o]=0;return j.set(r.subarray(c+Math.max(-v,0),c+f),o),(0,Ye.escape)((0,Qe.fromByteArray)(j))}I.derToJose=nr;function Xe(e,t,r){let n=0;for(;t+n<r&&e[t+n]===0;)++n;return e[t+n]>=ne&&--n,n}function sr(e,t){e=tt(e);let r=ze(t),n=e.length;if(n!==r*2)throw new TypeError(`"${t}" signatures must be "${r*2}" bytes, saw "${n}"`);let s=Xe(e,0,r),i=Xe(e,r,e.length),o=r-s,h=r-i,l=1+1+o+1+1+h,p=l<ne,f=new Uint8Array((p?2:3)+l),c=0;return f[c++]=et,p?f[c++]=l:(f[c++]=ne|1,f[c++]=l&255),f[c++]=se,f[c++]=o,s<0?(f[c++]=0,f.set(e.subarray(0,r),c),c+=r):(f.set(e.subarray(s,r),c),c+=r-s),f[c++]=se,f[c++]=h,i<0?(f[c++]=0,f.set(e.subarray(r),c)):f.set(e.subarray(r+i),c),f}I.joseToDer=sr});var K=y(D=>{u();d();Object.defineProperty(D,"__esModule",{value:!0});D.InvalidTokenError=D.MissingParametersError=void 0;var Oe=class extends Error{constructor(t){super(),this.name="MissingParametersError",this.message=t||""}};D.MissingParametersError=Oe;var je=class extends Error{constructor(t){super(),this.name="InvalidTokenError",this.message=t||""}};D.InvalidTokenError=je});var it=y(ce=>{u();d();Object.defineProperty(ce,"__esModule",{value:!0});ce.SECP256K1Client=void 0;var or=Re(),ir=Ee(),oe=St(),nt=rt(),st=K(),ot=J();oe.utils.hmacSha256Sync=(e,...t)=>{let r=or.hmac.create(ir.sha256,e);return t.forEach(n=>r.update(n)),r.digest()};var ie=class{static derivePublicKey(t,r=!0){return t.length===66&&(t=t.slice(0,64)),t.length<64&&(t=t.padStart(64,"0")),(0,ot.bytesToHex)(oe.getPublicKey(t,r))}static signHash(t,r,n="jose"){if(!t||!r)throw new st.MissingParametersError("a signing input hash and private key are all required");let s=oe.signSync(t,r.slice(0,64),{der:!0,canonical:!1});if(n==="der")return(0,ot.bytesToHex)(s);if(n==="jose")return(0,nt.derToJose)(s,"ES256");throw Error("Invalid signature format")}static loadSignature(t){return(0,nt.joseToDer)(t,"ES256")}static verifyHash(t,r,n){if(!t||!r||!n)throw new st.MissingParametersError("a signing input hash, der signature, and public key are all required");return oe.verify(r,t,n,{strict:!1})}};ce.SECP256K1Client=ie;ie.algorithmName="ES256K"});var ae=y(N=>{u();d();Object.defineProperty(N,"__esModule",{value:!0});N.cryptoClients=N.SECP256K1Client=void 0;var ct=it();Object.defineProperty(N,"SECP256K1Client",{enumerable:!0,get:function(){return ct.SECP256K1Client}});var cr={ES256K:ct.SECP256K1Client};N.cryptoClients=cr});var Te=y(B=>{u();d();var ar=B&&B.__awaiter||function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function h(f){try{p(n.next(f))}catch(c){o(c)}}function l(f){try{p(n.throw(f))}catch(c){o(c)}}function p(f){f.done?i(f.value):s(f.value).then(h,l)}p((n=n.apply(e,t||[])).next())})};Object.defineProperty(B,"__esModule",{value:!0});B.hashSha256Async=B.hashSha256=void 0;var ur=Ee();function at(e){return(0,ur.sha256)(e)}B.hashSha256=at;function dr(e){return ar(this,void 0,void 0,function*(){try{if(typeof crypto<"u"&&typeof crypto.subtle<"u"){let r=typeof e=="string"?new TextEncoder().encode(e):e,n=yield crypto.subtle.digest("SHA-256",r);return new Uint8Array(n)}else{let r=vt();if(!r.createHash)throw new Error("`crypto` module does not contain `createHash`");return Promise.resolve(r.createHash("sha256").update(e).digest())}}catch(t){return console.log(t),console.log('Crypto lib not found. Neither the global `crypto.subtle` Web Crypto API, nor the or the Node.js `require("crypto").createHash` module is available. Falling back to JS implementation.'),Promise.resolve(at(e))}})}B.hashSha256Async=dr});var ft=y(H=>{u();d();var fr=H&&H.__awaiter||function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function h(f){try{p(n.next(f))}catch(c){o(c)}}function l(f){try{p(n.throw(f))}catch(c){o(c)}}function p(f){f.done?i(f.value):s(f.value).then(h,l)}p((n=n.apply(e,t||[])).next())})};Object.defineProperty(H,"__esModule",{value:!0});H.TokenSigner=H.createUnsecuredToken=void 0;var qe=W(),ut=ae(),hr=K(),dt=Te();function Ae(e,t){let r=[],n=qe.encode(JSON.stringify(t));r.push(n);let s=qe.encode(JSON.stringify(e));return r.push(s),r.join(".")}function lr(e){return Ae(e,{typ:"JWT",alg:"none"})+"."}H.createUnsecuredToken=lr;var Be=class{constructor(t,r){if(!(t&&r))throw new hr.MissingParametersError("a signing algorithm and private key are required");if(typeof t!="string")throw new Error("signing algorithm parameter must be a string");if(t=t.toUpperCase(),!ut.cryptoClients.hasOwnProperty(t))throw new Error("invalid signing algorithm");this.tokenType="JWT",this.cryptoClient=ut.cryptoClients[t],this.rawPrivateKey=r}header(t={}){let r={typ:this.tokenType,alg:this.cryptoClient.algorithmName};return Object.assign({},r,t)}sign(t,r=!1,n={}){let s=this.header(n),i=Ae(t,s),o=(0,dt.hashSha256)(i);return this.createWithSignedHash(t,r,s,i,o)}signAsync(t,r=!1,n={}){return fr(this,void 0,void 0,function*(){let s=this.header(n),i=Ae(t,s),o=yield(0,dt.hashSha256Async)(i);return this.createWithSignedHash(t,r,s,i,o)})}createWithSignedHash(t,r,n,s,i){let o=this.cryptoClient.signHash(i,this.rawPrivateKey);return r?{header:[qe.encode(JSON.stringify(n))],payload:JSON.stringify(t),signature:[o]}:[s,o].join(".")}};H.TokenSigner=Be});var lt=y(de=>{u();d();Object.defineProperty(de,"__esModule",{value:!0});de.TokenVerifier=void 0;var pr=W(),ht=ae(),yr=K(),ue=Te(),He=class{constructor(t,r){if(!(t&&r))throw new yr.MissingParametersError("a signing algorithm and public key are required");if(typeof t!="string")throw"signing algorithm parameter must be a string";if(t=t.toUpperCase(),!ht.cryptoClients.hasOwnProperty(t))throw"invalid signing algorithm";this.tokenType="JWT",this.cryptoClient=ht.cryptoClients[t],this.rawPublicKey=r}verify(t){return typeof t=="string"?this.verifyCompact(t,!1):typeof t=="object"?this.verifyExpanded(t,!1):!1}verifyAsync(t){return typeof t=="string"?this.verifyCompact(t,!0):typeof t=="object"?this.verifyExpanded(t,!0):Promise.resolve(!1)}verifyCompact(t,r){let n=t.split("."),s=n[0]+"."+n[1],i=o=>{let h=this.cryptoClient.loadSignature(n[2]);return this.cryptoClient.verifyHash(o,h,this.rawPublicKey)};if(r)return(0,ue.hashSha256Async)(s).then(o=>i(o));{let o=(0,ue.hashSha256)(s);return i(o)}}verifyExpanded(t,r){let n=[t.header.join("."),pr.encode(t.payload)].join("."),s=!0,i=o=>(t.signature.map(h=>{let l=this.cryptoClient.loadSignature(h);this.cryptoClient.verifyHash(o,l,this.rawPublicKey)||(s=!1)}),s);if(r)return(0,ue.hashSha256Async)(n).then(o=>i(o));{let o=(0,ue.hashSha256)(n);return i(o)}}};de.TokenVerifier=He});var pt=y(he=>{u();d();Object.defineProperty(he,"__esModule",{value:!0});he.decodeToken=void 0;var fe=W();function _r(e){if(typeof e=="string"){let t=e.split("."),r=JSON.parse(fe.decode(t[0])),n=JSON.parse(fe.decode(t[1])),s=t[2];return{header:r,payload:n,signature:s}}else if(typeof e=="object"){if(typeof e.payload!="string")throw new Error("Expected token payload to be a base64 or json string");let t=e.payload;e.payload[0]!=="{"&&(t=fe.decode(t));let r=[];return e.header.map(n=>{let s=JSON.parse(fe.decode(n));r.push(s)}),{header:r,payload:JSON.parse(t),signature:e.signature}}}he.decodeToken=_r});var $=y(C=>{u();d();var gr=C&&C.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),X=C&&C.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&gr(t,e,r)};Object.defineProperty(C,"__esModule",{value:!0});X(ft(),C);X(lt(),C);X(pt(),C);X(K(),C);X(ae(),C)});var L=y(le=>{u();d();Object.defineProperty(le,"__esModule",{value:!0});le.getDefaultProvider=void 0;async function br(){return window.BitcoinProvider}le.getDefaultProvider=br});var yt=y(Q=>{u();d();Object.defineProperty(Q,"__esModule",{value:!0});Q.AddressPurposes=void 0;var wr;(function(e){e.PAYMENT="payment",e.ORDINALS="ordinals"})(wr=Q.AddressPurposes||(Q.AddressPurposes={}))});var _t=y(P=>{u();d();var xr=P&&P.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),mr=P&&P.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&xr(t,e,r)};Object.defineProperty(P,"__esModule",{value:!0});P.getAddress=void 0;var Cr=$(),vr=L(),Sr=async e=>{let{getProvider:t=vr.getDefaultProvider}=e,r=await t();if(!r)throw new Error("No Bitcoin wallet installed");let{purposes:n}=e.payload;if(!n)throw new Error("Address purposes are required");try{let s=(0,Cr.createUnsecuredToken)(e.payload),i=await r.connect(s);e.onFinish?.(i)}catch(s){console.error("[Connect] Error during address request",s),e.onCancel?.()}};P.getAddress=Sr;mr(yt(),P)});var gt=y(U=>{u();d();Object.defineProperty(U,"__esModule",{value:!0});U.callWalletPopup=U.CallMethod=void 0;var Er=$(),Pr=L(),Or;(function(e){e.SIGN_TRANSACTION="signTransaction",e.GET_ADDRESS="getAddress"})(Or=U.CallMethod||(U.CallMethod={}));var jr=async e=>{let{getProvider:t=Pr.getDefaultProvider}=e,r=await t();if(!r)throw new Error("No Bitcoin wallet installed");let{method:n}=e.payload;if(!n)throw new Error("A wallet method is required");let s=(0,Er.createUnsecuredToken)(e.payload);try{let i=await r.call(s);e.onFinish?.(i)}catch(i){console.error("[Connect] Error during call request",i),e.onCancel?.()}};U.callWalletPopup=jr});var wt=y(bt=>{u();d();Object.defineProperty(bt,"__esModule",{value:!0})});var xt=y(O=>{u();d();var Tr=O&&O.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),qr=O&&O.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&Tr(t,e,r)};Object.defineProperty(O,"__esModule",{value:!0});O.signMessage=void 0;var Ar=$(),Br=L(),Hr=async e=>{let{getProvider:t=Br.getDefaultProvider}=e,r=await t();if(!r)throw new Error("No Bitcoin wallet installed");let{address:n,message:s}=e.payload;if(!n)throw new Error("An address is required to sign a message");if(!s)throw new Error("A message to be signed is required");try{let i=(0,Ar.createUnsecuredToken)(e.payload),o=await r.signMessage(i);e.onFinish?.(o)}catch(i){console.error("[Connect] Error during sign message request",i),e.onCancel?.()}};O.signMessage=Hr;qr(wt(),O)});var mt=y(pe=>{u();d();Object.defineProperty(pe,"__esModule",{value:!0});pe.sendBtcTransaction=void 0;var Mr=$(),Lr=L(),Ur=async e=>{let{getProvider:t=Lr.getDefaultProvider}=e,r=await t();if(!r)throw new Error("No Bitcoin wallet installed");let{recipients:n,senderAddress:s}=e.payload;if(!n||n.length===0)throw new Error("At least one recipient is required");if(!s)throw new Error("The sender address is required");try{let i=(0,Mr.createUnsecuredToken)(e.payload),o=await r.sendBtcTransaction(i);e.onFinish?.(o)}catch(i){console.error("[Connect] Error during send BTC transaction request",i),e.onCancel?.()}};pe.sendBtcTransaction=Ur});var Ct=y(ye=>{u();d();Object.defineProperty(ye,"__esModule",{value:!0});ye.signTransaction=void 0;var kr=$(),Ir=L(),Dr=async e=>{let{getProvider:t=Ir.getDefaultProvider}=e,r=await t();if(!r)throw new Error("No Bitcoin wallet installed");let{psbtBase64:n,inputsToSign:s}=e.payload;if(!n)throw new Error("A value for psbtBase64 representing the tx hash is required");if(!s)throw new Error("An array specifying the inputs to be signed by the wallet is required");try{let i=(0,kr.createUnsecuredToken)(e.payload),o=await r.signTransaction(i);e.onFinish?.(o)}catch(i){console.error("[Connect] Error during sign transaction request",i),e.onCancel?.()}};ye.signTransaction=Dr});var $r=y(m=>{u();d();var Nr=m&&m.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),F=m&&m.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&Nr(t,e,r)};Object.defineProperty(m,"__esModule",{value:!0});F(_t(),m);F(gt(),m);F(L(),m);F(xt(),m);F(mt(),m);F(Ct(),m)});export default $r();
//# sourceMappingURL=dist-U5WTB4OX.js.map
