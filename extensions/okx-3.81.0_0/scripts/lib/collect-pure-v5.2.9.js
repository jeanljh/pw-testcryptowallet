!function(){"use strict";var t=function(){return(t=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function e(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}function n(t,e,n,i){return new(n||(n=Promise))(function(r,o){function a(t){try{c(i.next(t))}catch(t){o(t)}}function s(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((i=i.apply(t,e||[])).next())})}function i(t,e){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function r(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function o(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=o.next()).done;)a.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a}function a(t,e){for(var n=0,i=e.length,r=t.length;n<i;n++,r++)t[r]=e[n];return t}var s,c=function(){function t(t){this._hooks={},this._cache=[],this._hooksCache={}}return t.prototype.on=function(t,e){t&&e&&"function"==typeof e&&(this._hooks[t]||(this._hooks[t]=[]),this._hooks[t].push(e))},t.prototype.once=function(t,e){var n=this;if(t&&e&&"function"==typeof e){this.on(t,function i(r){e(r),n.off(t,i)})}},t.prototype.off=function(t,e){if(t&&this._hooks[t]&&this._hooks[t].length)if(e){var n=this._hooks[t].indexOf(e);-1!==n&&this._hooks[t].splice(n,1)}else this._hooks[t]=[]},t.prototype.emit=function(t,e,n){if(n){if(!t)return;-1!==this._cache.indexOf(n)?this._emit(t,e):(this._hooksCache.hasOwnProperty(n)||(this._hooksCache[n]={}),this._hooksCache[n].hasOwnProperty(t)||(this._hooksCache[n][t]=[]),this._hooksCache[n][t].push(e))}else this._emit(t,e)},t.prototype._emit=function(t,e){t&&this._hooks[t]&&this._hooks[t].length&&a([],o(this._hooks[t])).forEach(function(t){try{t(e)}catch(t){}})},t.prototype.set=function(t){t&&-1===this._cache.indexOf(t)&&this._cache.push(t)},t}(),u=function(t){return null!=t&&"[object Object]"==Object.prototype.toString.call(t)},h=function(t){return Array.isArray(t)},l=function(t){return"boolean"==typeof t},f=function(t){return void 0===t},p=function(t){return null!=t&&""!==t.trim()},d=(s=+Date.now()+Number("".concat(Math.random()).slice(2,8)),function(){return s+=1}),g=function(t,e,n,i){t.addEventListener?t.addEventListener(e,n,i):t.attachEven?t.attachEven("on".concat(e),n):t["on".concat(e)]=n},m=function(t,e,n,i){t.addEventListener?t.removeEventListener(e,n,i):t.attachEven&&t.detachEven("on".concat(e),n)},v=function(t){return function(t,e,n){if("string"==typeof t&&"number"==typeof e&&"number"==typeof n){var i,r=[];n=n<=25?n:n%25;var o=String.fromCharCode(n+97);i=t.split(o);for(var a=0;a<i.length;a++){var s=parseInt(i[a],n);s=1*s^e;var c=String.fromCharCode(s);r.push(c)}return r.join("")}}(t,64,25)},_=function(t){var e=-1!==navigator.userAgent.indexOf("iPhone")||-1!==navigator.userAgent.indexOf("iPad")||-1!==navigator.userAgent.indexOf("Mac OS X");g(window,e?"pagehide":"beforeunload",t,!1)},y=function(t,e,n){var i=document.createElement("script");i.src=t,i.onerror=function(){n(t)},i.onload=function(){e()},document.getElementsByTagName("head")[0].appendChild(i)},b=function(){var t=0;return["hidden","msHidden","webkitHidden"].forEach(function(e){void 0!==document[e]&&(t=1)}),t},w=function(t,e){void 0===t&&(t=function(){}),void 0===e&&(e=1e3);var n,i=Date.now()+e;return n=window.setTimeout(function r(){var o=Date.now()-i;t(),i+=e,n=window.setTimeout(r,Math.max(0,e-o))},e),function(){window.clearTimeout(n)}},E=function(t){var e=document.createElement("a");return e.href=t,e},S=function(t){var e={};try{var n=E(t).search;(n=n.slice(1)).split("&").forEach(function(t){var n,i,r=t.split("=");r.length&&(n=r[0],i=r[1]);try{e[n]=decodeURIComponent(void 0===i?"":i)}catch(t){e[n]=i}})}catch(t){}return e},k=function(t,e){t.split("&").forEach(function(t){var n=t.indexOf("="),i="",r="";if(-1===n?i=t:(i=t.substring(0,n),r=t.substring(n+1)),i){try{i=decodeURIComponent(i)}catch(t){}try{r=decodeURIComponent(r)}catch(t){}e[i]=r}})},T=function(t){for(var e=0,n=0,i=(t+="").length,r=0;r<i;r++)((e=31*e+t.charCodeAt(n++))>0x7fffffffffff||e<-0x800000000000)&&(e&=0xffffffffffff);return e<0&&(e+=0x7ffffffffffff),e},D=function(){var t=window.navigator.appName,e=window.navigator.userAgent;return-1!==t.indexOf("Microsoft Internet Explorer")&&(-1!==e.indexOf("MSIE 8.0")||-1!==e.indexOf("MSIE 7.0")||-1!==e.indexOf("MSIE 9.0"))},z=function(){var t=window.navigator.appName,e=window.navigator.userAgent;return-1!==t.indexOf("Microsoft Internet Explorer")&&(-1!==e.indexOf("MSIE 8.0")||-1!==e.indexOf("MSIE 7.0")||-1!==e.indexOf("MSIE 9.0"))},A=function(){var t=window.navigator.appName,e=window.navigator.userAgent;return-1!==t.indexOf("Microsoft Internet Explorer")&&(-1!==e.indexOf("MSIE 8.0")||-1!==e.indexOf("MSIE 9.0"))},x=function(){var t=window.navigator.appName,e=window.navigator.userAgent;return-1!==t.indexOf("Microsoft Internet Explorer")&&-1!==e.indexOf("MSIE 7.0")};var I=function(t){var e,n,i=[],r=t.length;r%2!=0&&(n=r+1,t=(e=t).length>=n?e:new Array(n-e.length+1).join("0")+e),r=t.length;for(var o=0;o<r;o+=2)i.push(parseInt(t.substr(o,2),16));return i},R="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function O(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function C(t,e){return t(e={exports:{}},e.exports),e.exports}var M=C(function(t,e){var n;n=function(){function t(){for(var t=0,e={};t<arguments.length;t++){var n=arguments[t];for(var i in n)e[i]=n[i]}return e}function e(t){return t.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(i){function r(){}function o(e,n,o){if("undefined"!=typeof document){"number"==typeof(o=t({path:"/"},r.defaults,o)).expires&&(o.expires=new Date(1*new Date+864e5*o.expires)),o.expires=o.expires?o.expires.toUTCString():"";try{var a=JSON.stringify(n);/^[\{\[]/.test(a)&&(n=a)}catch(t){}n=i.write?i.write(n,e):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var c in o)o[c]&&(s+="; "+c,!0!==o[c]&&(s+="="+o[c].split(";")[0]));return document.cookie=e+"="+n+s}}function a(t,n){if("undefined"!=typeof document){for(var r={},o=document.cookie?document.cookie.split("; "):[],a=0;a<o.length;a++){var s=o[a].split("="),c=s.slice(1).join("=");n||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var u=e(s[0]);if(c=(i.read||i)(c,u)||e(c),n)try{c=JSON.parse(c)}catch(t){}if(r[u]=c,t===u)break}catch(t){}}return t?r[t]:r}}return r.set=o,r.get=function(t){return a(t,!1)},r.getJSON=function(t){return a(t,!0)},r.remove=function(e,n){o(e,"",t(n,{expires:-1}))},r.defaults={},r.withConverter=n,r}(function(){})},t.exports=n()}),B=C(function(t,e){t.exports=function t(e,n,i){function r(a,s){if(!n[a]){if(!e[a]){var c=O;if(!s&&c)return c(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var h=n[a]={exports:{}};e[a][0].call(h.exports,function(t){var n=e[a][1][t];return r(n||t)},h,h.exports,t,e,n,i)}return n[a].exports}for(var o=O,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(t,e,n){(function(t){var n,i,r=t.MutationObserver||t.WebKitMutationObserver;if(r){var o=0,a=new r(h),s=t.document.createTextNode("");a.observe(s,{characterData:!0}),n=function(){s.data=o=++o%2}}else if(t.setImmediate||void 0===t.MessageChannel)n="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){h(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(h,0)};else{var c=new t.MessageChannel;c.port1.onmessage=h,n=function(){c.port2.postMessage(0)}}var u=[];function h(){var t,e;i=!0;for(var n=u.length;n;){for(e=u,u=[],t=-1;++t<n;)e[t]();n=u.length}i=!1}e.exports=function(t){1!==u.push(t)||i||n()}}).call(this,void 0!==R?R:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,n){var i=t(1);function r(){}var o={},a=["REJECTED"],s=["FULFILLED"],c=["PENDING"];function u(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,t!==r&&p(this,t)}function h(t,e,n){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function l(t,e,n){i(function(){var i;try{i=e(n)}catch(e){return o.reject(t,e)}i===t?o.reject(t,new TypeError("Cannot resolve promise with itself")):o.resolve(t,i)})}function f(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function p(t,e){var n=!1;function i(e){n||(n=!0,o.reject(t,e))}function r(e){n||(n=!0,o.resolve(t,e))}var a=d(function(){e(r,i)});"error"===a.status&&i(a.value)}function d(t,e){var n={};try{n.value=t(e),n.status="success"}catch(t){n.status="error",n.value=t}return n}e.exports=u,u.prototype.catch=function(t){return this.then(null,t)},u.prototype.then=function(t,e){if("function"!=typeof t&&this.state===s||"function"!=typeof e&&this.state===a)return this;var n=new this.constructor(r);if(this.state!==c){var i=this.state===s?t:e;l(n,i,this.outcome)}else this.queue.push(new h(n,t,e));return n},h.prototype.callFulfilled=function(t){o.resolve(this.promise,t)},h.prototype.otherCallFulfilled=function(t){l(this.promise,this.onFulfilled,t)},h.prototype.callRejected=function(t){o.reject(this.promise,t)},h.prototype.otherCallRejected=function(t){l(this.promise,this.onRejected,t)},o.resolve=function(t,e){var n=d(f,e);if("error"===n.status)return o.reject(t,n.value);var i=n.value;if(i)p(t,i);else{t.state=s,t.outcome=e;for(var r=-1,a=t.queue.length;++r<a;)t.queue[r].callFulfilled(e)}return t},o.reject=function(t,e){t.state=a,t.outcome=e;for(var n=-1,i=t.queue.length;++n<i;)t.queue[n].callRejected(e);return t},u.resolve=function(t){return t instanceof this?t:o.resolve(new this(r),t)},u.reject=function(t){var e=new this(r);return o.reject(e,t)},u.all=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,i=!1;if(!n)return this.resolve([]);for(var a=new Array(n),s=0,c=-1,u=new this(r);++c<n;)h(t[c],c);return u;function h(t,r){e.resolve(t).then(function(t){a[r]=t,++s!==n||i||(i=!0,o.resolve(u,a))},function(t){i||(i=!0,o.reject(u,t))})}},u.race=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,i=!1;if(!n)return this.resolve([]);for(var a,s=-1,c=new this(r);++s<n;)a=t[s],e.resolve(a).then(function(t){i||(i=!0,o.resolve(c,t))},function(t){i||(i=!0,o.reject(c,t))});return c}},{1:1}],3:[function(t,e,n){(function(e){"function"!=typeof e.Promise&&(e.Promise=t(2))}).call(this,void 0!==R?R:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(t,e,n){var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(t){return}}();function o(t,e){t=t||[],e=e||{};try{return new Blob(t,e)}catch(o){if("TypeError"!==o.name)throw o;for(var n="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,i=new n,r=0;r<t.length;r+=1)i.append(t[r]);return i.getBlob(e.type)}}"undefined"==typeof Promise&&t(3);var a=Promise;function s(t,e){e&&t.then(function(t){e(null,t)},function(t){e(t)})}function c(t,e,n){"function"==typeof e&&t.then(e),"function"==typeof n&&t.catch(n)}function u(t){return"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t)),t}function h(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var l="local-forage-detect-blob-support",f=void 0,p={},d=Object.prototype.toString,g="readonly",m="readwrite";function v(t){return"boolean"==typeof f?a.resolve(f):function(t){return new a(function(e){var n=t.transaction(l,m),i=o([""]);n.objectStore(l).put(i,"key"),n.onabort=function(t){t.preventDefault(),t.stopPropagation(),e(!1)},n.oncomplete=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);e(n||!t||parseInt(t[1],10)>=43)}}).catch(function(){return!1})}(t).then(function(t){return f=t})}function _(t){var e=p[t.name],n={};n.promise=new a(function(t,e){n.resolve=t,n.reject=e}),e.deferredOperations.push(n),e.dbReady?e.dbReady=e.dbReady.then(function(){return n.promise}):e.dbReady=n.promise}function y(t){var e=p[t.name],n=e.deferredOperations.pop();if(n)return n.resolve(),n.promise}function b(t,e){var n=p[t.name],i=n.deferredOperations.pop();if(i)return i.reject(e),i.promise}function w(t,e){return new a(function(n,i){if(p[t.name]=p[t.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},t.db){if(!e)return n(t.db);_(t),t.db.close()}var o=[t.name];e&&o.push(t.version);var a=r.open.apply(r,o);e&&(a.onupgradeneeded=function(e){var n=a.result;try{n.createObjectStore(t.storeName),e.oldVersion<=1&&n.createObjectStore(l)}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+t.name+'" has been upgraded from version '+e.oldVersion+" to version "+e.newVersion+', but the storage "'+t.storeName+'" already exists.')}}),a.onerror=function(t){t.preventDefault(),i(a.error)},a.onsuccess=function(){var e=a.result;e.onversionchange=function(t){t.target.close()},n(e),y(t)}})}function E(t){return w(t,!1)}function S(t){return w(t,!0)}function k(t,e){if(!t.db)return!0;var n=!t.db.objectStoreNames.contains(t.storeName),i=t.version<t.db.version,r=t.version>t.db.version;if(i&&(t.version!==e&&console.warn('The database "'+t.name+"\" can't be downgraded from version "+t.db.version+" to version "+t.version+"."),t.version=t.db.version),r||n){if(n){var o=t.db.version+1;o>t.version&&(t.version=o)}return!0}return!1}function T(t){var e=function(t){for(var e=t.length,n=new ArrayBuffer(e),i=new Uint8Array(n),r=0;r<e;r++)i[r]=t.charCodeAt(r);return n}(atob(t.data));return o([e],{type:t.type})}function D(t){return t&&t.__local_forage_encoded_blob}function z(t){var e=this,n=e._initReady().then(function(){var t=p[e._dbInfo.name];if(t&&t.dbReady)return t.dbReady});return c(n,t,t),n}function A(t,e,n,i){void 0===i&&(i=1);try{var r=t.db.transaction(t.storeName,e);n(null,r)}catch(r){if(i>0&&(!t.db||"InvalidStateError"===r.name||"NotFoundError"===r.name))return a.resolve().then(function(){if(!t.db||"NotFoundError"===r.name&&!t.db.objectStoreNames.contains(t.storeName)&&t.version<=t.db.version)return t.db&&(t.version=t.db.version+1),S(t)}).then(function(){return function(t){_(t);for(var e=p[t.name],n=e.forages,i=0;i<n.length;i++){var r=n[i];r._dbInfo.db&&(r._dbInfo.db.close(),r._dbInfo.db=null)}return t.db=null,E(t).then(function(e){return t.db=e,k(t)?S(t):e}).then(function(i){t.db=e.db=i;for(var r=0;r<n.length;r++)n[r]._dbInfo.db=i}).catch(function(e){throw b(t,e),e})}(t).then(function(){A(t,e,n,i-1)})}).catch(n);n(r)}}var x={_driver:"asyncStorage",_initStorage:function(t){var e=this,n={db:null};if(t)for(var i in t)n[i]=t[i];var r=p[n.name];r||(r={forages:[],db:null,dbReady:null,deferredOperations:[]},p[n.name]=r),r.forages.push(e),e._initReady||(e._initReady=e.ready,e.ready=z);var o=[];function s(){return a.resolve()}for(var c=0;c<r.forages.length;c++){var u=r.forages[c];u!==e&&o.push(u._initReady().catch(s))}var h=r.forages.slice(0);return a.all(o).then(function(){return n.db=r.db,E(n)}).then(function(t){return n.db=t,k(n,e._defaultConfig.version)?S(n):t}).then(function(t){n.db=r.db=t,e._dbInfo=n;for(var i=0;i<h.length;i++){var o=h[i];o!==e&&(o._dbInfo.db=n.db,o._dbInfo.version=n.version)}})},_support:function(){try{if(!r||!r.open)return!1;var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),e="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!t||e)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(t){return!1}}(),iterate:function(t,e){var n=this,i=new a(function(e,i){n.ready().then(function(){A(n._dbInfo,g,function(r,o){if(r)return i(r);try{var a=o.objectStore(n._dbInfo.storeName),s=a.openCursor(),c=1;s.onsuccess=function(){var n=s.result;if(n){var i=n.value;D(i)&&(i=T(i));var r=t(i,n.key,c++);void 0!==r?e(r):n.continue()}else e()},s.onerror=function(){i(s.error)}}catch(t){i(t)}})}).catch(i)});return s(i,e),i},getItem:function(t,e){var n=this;t=u(t);var i=new a(function(e,i){n.ready().then(function(){A(n._dbInfo,g,function(r,o){if(r)return i(r);try{var a=o.objectStore(n._dbInfo.storeName),s=a.get(t);s.onsuccess=function(){var t=s.result;void 0===t&&(t=null),D(t)&&(t=T(t)),e(t)},s.onerror=function(){i(s.error)}}catch(t){i(t)}})}).catch(i)});return s(i,e),i},setItem:function(t,e,n){var i=this;t=u(t);var r=new a(function(n,r){var o;i.ready().then(function(){return o=i._dbInfo,"[object Blob]"===d.call(e)?v(o.db).then(function(t){return t?e:(n=e,new a(function(t,e){var i=new FileReader;i.onerror=e,i.onloadend=function(e){var i=btoa(e.target.result||"");t({__local_forage_encoded_blob:!0,data:i,type:n.type})},i.readAsBinaryString(n)}));var n}):e}).then(function(e){A(i._dbInfo,m,function(o,a){if(o)return r(o);try{var s=a.objectStore(i._dbInfo.storeName);null===e&&(e=void 0);var c=s.put(e,t);a.oncomplete=function(){void 0===e&&(e=null),n(e)},a.onabort=a.onerror=function(){try{var t=c.error?c.error:c.transaction.error;r(t)}catch(t){r(t)}}}catch(t){r(t)}})}).catch(r)});return s(r,n),r},removeItem:function(t,e){var n=this;t=u(t);var i=new a(function(e,i){n.ready().then(function(){A(n._dbInfo,m,function(r,o){if(r)return i(r);try{var a=o.objectStore(n._dbInfo.storeName),s=a.delete(t);o.oncomplete=function(){e()},o.onerror=function(){i(s.error)},o.onabort=function(){try{var t=s.error?s.error:s.transaction.error;i(t)}catch(t){i(t)}}}catch(t){i(t)}})}).catch(i)});return s(i,e),i},clear:function(t){var e=this,n=new a(function(t,n){e.ready().then(function(){A(e._dbInfo,m,function(i,r){if(i)return n(i);try{var o=r.objectStore(e._dbInfo.storeName),a=o.clear();r.oncomplete=function(){t()},r.onabort=r.onerror=function(){try{var t=a.error?a.error:a.transaction.error;n(t)}catch(t){n(t)}}}catch(t){n(t)}})}).catch(n)});return s(n,t),n},length:function(t){var e=this,n=new a(function(t,n){e.ready().then(function(){A(e._dbInfo,g,function(i,r){if(i)return n(i);try{var o=r.objectStore(e._dbInfo.storeName),a=o.count();a.onsuccess=function(){t(a.result)},a.onerror=function(){n(a.error)}}catch(t){n(t)}})}).catch(n)});return s(n,t),n},key:function(t,e){var n=this,i=new a(function(e,i){t<0?e(null):n.ready().then(function(){A(n._dbInfo,g,function(r,o){if(r)return i(r);try{var a=o.objectStore(n._dbInfo.storeName),s=!1,c=(a.openKeyCursor||a.openCursor).call(a);c.onsuccess=function(){var n=c.result;n?0===t?e(n.key):s?e(n.key):(s=!0,n.advance(t)):e(null)},c.onerror=function(){i(c.error)}}catch(t){i(t)}})}).catch(i)});return s(i,e),i},keys:function(t){var e=this,n=new a(function(t,n){e.ready().then(function(){A(e._dbInfo,g,function(i,r){if(i)return n(i);try{var o=r.objectStore(e._dbInfo.storeName),a=(o.openKeyCursor||o.openCursor).call(o),s=[];a.onsuccess=function(){var e=a.result;e?(s.push(e.key),e.continue()):t(s)},a.onerror=function(){n(a.error)}}catch(t){n(t)}})}).catch(n)});return s(n,t),n},dropInstance:function(t,e){e=h.apply(this,arguments);var n,i=this.config();if((t="function"!=typeof t&&t||{}).name||(t.name=t.name||i.name,t.storeName=t.storeName||i.storeName),t.name){var o=t.name===i.name&&this._dbInfo.db,c=o?a.resolve(this._dbInfo.db):E(t).then(function(e){var n=p[t.name],i=n.forages;n.db=e;for(var r=0;r<i.length;r++)i[r]._dbInfo.db=e;return e});n=t.storeName?c.then(function(e){if(e.objectStoreNames.contains(t.storeName)){var n=e.version+1;_(t);var i=p[t.name],o=i.forages;e.close();for(var s=0;s<o.length;s++){var c=o[s];c._dbInfo.db=null,c._dbInfo.version=n}var u=new a(function(e,i){var o=r.open(t.name,n);o.onerror=function(t){var e=o.result;e.close(),i(t)},o.onupgradeneeded=function(){var e=o.result;e.deleteObjectStore(t.storeName)},o.onsuccess=function(){var t=o.result;t.close(),e(t)}});return u.then(function(t){i.db=t;for(var e=0;e<o.length;e++){var n=o[e];n._dbInfo.db=t,y(n._dbInfo)}}).catch(function(e){throw(b(t,e)||a.resolve()).catch(function(){}),e})}}):c.then(function(e){_(t);var n=p[t.name],i=n.forages;e.close();for(var o=0;o<i.length;o++){var s=i[o];s._dbInfo.db=null}var c=new a(function(e,n){var i=r.deleteDatabase(t.name);i.onerror=function(){var t=i.result;t&&t.close(),n(i.error)},i.onblocked=function(){console.warn('dropInstance blocked for database "'+t.name+'" until all open connections are closed')},i.onsuccess=function(){var t=i.result;t&&t.close(),e(t)}});return c.then(function(t){n.db=t;for(var e=0;e<i.length;e++){var r=i[e];y(r._dbInfo)}}).catch(function(e){throw(b(t,e)||a.resolve()).catch(function(){}),e})})}else n=a.reject("Invalid arguments");return s(n,e),n}},I="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",R="~~local_forage_type~",O=/^~~local_forage_type~([^~]+)~/,C="__lfsc__:",M=C.length,B="arbf",G="blob",U="si08",N="ui08",L="uic8",P="si16",F="si32",q="ur16",j="ui32",K="fl32",V="fl64",H=M+B.length,J=Object.prototype.toString;function Z(t){var e,n,i,r,o,a=.75*t.length,s=t.length,c=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var u=new ArrayBuffer(a),h=new Uint8Array(u);for(e=0;e<s;e+=4)n=I.indexOf(t[e]),i=I.indexOf(t[e+1]),r=I.indexOf(t[e+2]),o=I.indexOf(t[e+3]),h[c++]=n<<2|i>>4,h[c++]=(15&i)<<4|r>>2,h[c++]=(3&r)<<6|63&o;return u}function W(t){var e,n=new Uint8Array(t),i="";for(e=0;e<n.length;e+=3)i+=I[n[e]>>2],i+=I[(3&n[e])<<4|n[e+1]>>4],i+=I[(15&n[e+1])<<2|n[e+2]>>6],i+=I[63&n[e+2]];return n.length%3==2?i=i.substring(0,i.length-1)+"=":n.length%3==1&&(i=i.substring(0,i.length-2)+"=="),i}var X={serialize:function(t,e){var n="";if(t&&(n=J.call(t)),t&&("[object ArrayBuffer]"===n||t.buffer&&"[object ArrayBuffer]"===J.call(t.buffer))){var i,r=C;t instanceof ArrayBuffer?(i=t,r+=B):(i=t.buffer,"[object Int8Array]"===n?r+=U:"[object Uint8Array]"===n?r+=N:"[object Uint8ClampedArray]"===n?r+=L:"[object Int16Array]"===n?r+=P:"[object Uint16Array]"===n?r+=q:"[object Int32Array]"===n?r+=F:"[object Uint32Array]"===n?r+=j:"[object Float32Array]"===n?r+=K:"[object Float64Array]"===n?r+=V:e(new Error("Failed to get type for BinaryArray"))),e(r+W(i))}else if("[object Blob]"===n){var o=new FileReader;o.onload=function(){var n=R+t.type+"~"+W(this.result);e(C+G+n)},o.readAsArrayBuffer(t)}else try{e(JSON.stringify(t))}catch(n){console.error("Couldn't convert value into a JSON string: ",t),e(null,n)}},deserialize:function(t){if(t.substring(0,M)!==C)return JSON.parse(t);var e,n=t.substring(H),i=t.substring(M,H);if(i===G&&O.test(n)){var r=n.match(O);e=r[1],n=n.substring(r[0].length)}var a=Z(n);switch(i){case B:return a;case G:return o([a],{type:e});case U:return new Int8Array(a);case N:return new Uint8Array(a);case L:return new Uint8ClampedArray(a);case P:return new Int16Array(a);case q:return new Uint16Array(a);case F:return new Int32Array(a);case j:return new Uint32Array(a);case K:return new Float32Array(a);case V:return new Float64Array(a);default:throw new Error("Unkown type: "+i)}},stringToBuffer:Z,bufferToString:W};function $(t,e,n,i){t.executeSql("CREATE TABLE IF NOT EXISTS "+e.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,i)}function Y(t,e,n,i,r,o){t.executeSql(n,i,r,function(t,a){a.code===a.SYNTAX_ERR?t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[e.storeName],function(t,s){s.rows.length?o(t,a):$(t,e,function(){t.executeSql(n,i,r,o)},o)},o):o(t,a)},o)}var Q={_driver:"webSQLStorage",_initStorage:function(t){var e=this,n={db:null};if(t)for(var i in t)n[i]="string"!=typeof t[i]?t[i].toString():t[i];var r=new a(function(t,i){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(t){return i(t)}n.db.transaction(function(r){$(r,n,function(){e._dbInfo=n,t()},function(t,e){i(e)})},i)});return n.serializer=X,r},_support:"function"==typeof openDatabase,iterate:function(t,e){var n=this,i=new a(function(e,i){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(n){Y(n,r,"SELECT * FROM "+r.storeName,[],function(n,i){for(var o=i.rows,a=o.length,s=0;s<a;s++){var c=o.item(s),u=c.value;if(u&&(u=r.serializer.deserialize(u)),void 0!==(u=t(u,c.key,s+1)))return void e(u)}e()},function(t,e){i(e)})})}).catch(i)});return s(i,e),i},getItem:function(t,e){var n=this;t=u(t);var i=new a(function(e,i){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(n){Y(n,r,"SELECT * FROM "+r.storeName+" WHERE key = ? LIMIT 1",[t],function(t,n){var i=n.rows.length?n.rows.item(0).value:null;i&&(i=r.serializer.deserialize(i)),e(i)},function(t,e){i(e)})})}).catch(i)});return s(i,e),i},setItem:function(t,e,n){return function t(e,n,i,r){var o=this;e=u(e);var c=new a(function(a,s){o.ready().then(function(){void 0===n&&(n=null);var c=n,u=o._dbInfo;u.serializer.serialize(n,function(n,h){h?s(h):u.db.transaction(function(t){Y(t,u,"INSERT OR REPLACE INTO "+u.storeName+" (key, value) VALUES (?, ?)",[e,n],function(){a(c)},function(t,e){s(e)})},function(n){if(n.code===n.QUOTA_ERR){if(r>0)return void a(t.apply(o,[e,c,i,r-1]));s(n)}})})}).catch(s)});return s(c,i),c}.apply(this,[t,e,n,1])},removeItem:function(t,e){var n=this;t=u(t);var i=new a(function(e,i){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(n){Y(n,r,"DELETE FROM "+r.storeName+" WHERE key = ?",[t],function(){e()},function(t,e){i(e)})})}).catch(i)});return s(i,e),i},clear:function(t){var e=this,n=new a(function(t,n){e.ready().then(function(){var i=e._dbInfo;i.db.transaction(function(e){Y(e,i,"DELETE FROM "+i.storeName,[],function(){t()},function(t,e){n(e)})})}).catch(n)});return s(n,t),n},length:function(t){var e=this,n=new a(function(t,n){e.ready().then(function(){var i=e._dbInfo;i.db.transaction(function(e){Y(e,i,"SELECT COUNT(key) as c FROM "+i.storeName,[],function(e,n){var i=n.rows.item(0).c;t(i)},function(t,e){n(e)})})}).catch(n)});return s(n,t),n},key:function(t,e){var n=this,i=new a(function(e,i){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(n){Y(n,r,"SELECT key FROM "+r.storeName+" WHERE id = ? LIMIT 1",[t+1],function(t,n){var i=n.rows.length?n.rows.item(0).key:null;e(i)},function(t,e){i(e)})})}).catch(i)});return s(i,e),i},keys:function(t){var e=this,n=new a(function(t,n){e.ready().then(function(){var i=e._dbInfo;i.db.transaction(function(e){Y(e,i,"SELECT key FROM "+i.storeName,[],function(e,n){for(var i=[],r=0;r<n.rows.length;r++)i.push(n.rows.item(r).key);t(i)},function(t,e){n(e)})})}).catch(n)});return s(n,t),n},dropInstance:function(t,e){e=h.apply(this,arguments);var n=this.config();(t="function"!=typeof t&&t||{}).name||(t.name=t.name||n.name,t.storeName=t.storeName||n.storeName);var i,r=this;return s(i=t.name?new a(function(e){var i;i=t.name===n.name?r._dbInfo.db:openDatabase(t.name,"","",0),t.storeName?e({db:i,storeNames:[t.storeName]}):e(function(t){return new a(function(e,n){t.transaction(function(i){i.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(n,i){for(var r=[],o=0;o<i.rows.length;o++)r.push(i.rows.item(o).name);e({db:t,storeNames:r})},function(t,e){n(e)})},function(t){n(t)})})}(i))}).then(function(t){return new a(function(e,n){t.db.transaction(function(i){function r(t){return new a(function(e,n){i.executeSql("DROP TABLE IF EXISTS "+t,[],function(){e()},function(t,e){n(e)})})}for(var o=[],s=0,c=t.storeNames.length;s<c;s++)o.push(r(t.storeNames[s]));a.all(o).then(function(){e()}).catch(function(t){n(t)})},function(t){n(t)})})}):a.reject("Invalid arguments"),e),i}};function tt(t,e){var n=t.name+"/";return t.storeName!==e.storeName&&(n+=t.storeName+"/"),n}function et(){return!function(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch(t){return!0}}()||localStorage.length>0}var nt={_driver:"localStorageWrapper",_initStorage:function(t){var e={};if(t)for(var n in t)e[n]=t[n];return e.keyPrefix=tt(t,this._defaultConfig),et()?(this._dbInfo=e,e.serializer=X,a.resolve()):a.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(t){return!1}}(),iterate:function(t,e){var n=this,i=n.ready().then(function(){for(var e=n._dbInfo,i=e.keyPrefix,r=i.length,o=localStorage.length,a=1,s=0;s<o;s++){var c=localStorage.key(s);if(0===c.indexOf(i)){var u=localStorage.getItem(c);if(u&&(u=e.serializer.deserialize(u)),void 0!==(u=t(u,c.substring(r),a++)))return u}}});return s(i,e),i},getItem:function(t,e){var n=this;t=u(t);var i=n.ready().then(function(){var e=n._dbInfo,i=localStorage.getItem(e.keyPrefix+t);return i&&(i=e.serializer.deserialize(i)),i});return s(i,e),i},setItem:function(t,e,n){var i=this;t=u(t);var r=i.ready().then(function(){void 0===e&&(e=null);var n=e;return new a(function(r,o){var a=i._dbInfo;a.serializer.serialize(e,function(e,i){if(i)o(i);else try{localStorage.setItem(a.keyPrefix+t,e),r(n)}catch(t){"QuotaExceededError"!==t.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==t.name||o(t),o(t)}})})});return s(r,n),r},removeItem:function(t,e){var n=this;t=u(t);var i=n.ready().then(function(){var e=n._dbInfo;localStorage.removeItem(e.keyPrefix+t)});return s(i,e),i},clear:function(t){var e=this,n=e.ready().then(function(){for(var t=e._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var i=localStorage.key(n);0===i.indexOf(t)&&localStorage.removeItem(i)}});return s(n,t),n},length:function(t){var e=this.keys().then(function(t){return t.length});return s(e,t),e},key:function(t,e){var n=this,i=n.ready().then(function(){var e,i=n._dbInfo;try{e=localStorage.key(t)}catch(t){e=null}return e&&(e=e.substring(i.keyPrefix.length)),e});return s(i,e),i},keys:function(t){var e=this,n=e.ready().then(function(){for(var t=e._dbInfo,n=localStorage.length,i=[],r=0;r<n;r++){var o=localStorage.key(r);0===o.indexOf(t.keyPrefix)&&i.push(o.substring(t.keyPrefix.length))}return i});return s(n,t),n},dropInstance:function(t,e){if(e=h.apply(this,arguments),!(t="function"!=typeof t&&t||{}).name){var n=this.config();t.name=t.name||n.name,t.storeName=t.storeName||n.storeName}var i,r=this;return s(i=t.name?new a(function(e){t.storeName?e(tt(t,r._defaultConfig)):e(t.name+"/")}).then(function(t){for(var e=localStorage.length-1;e>=0;e--){var n=localStorage.key(e);0===n.indexOf(t)&&localStorage.removeItem(n)}}):a.reject("Invalid arguments"),e),i}},it=function(t,e){for(var n=t.length,i=0;i<n;){if((r=t[i])===(o=e)||"number"==typeof r&&"number"==typeof o&&isNaN(r)&&isNaN(o))return!0;i++}var r,o;return!1},rt=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},ot={},at={},st={INDEXEDDB:x,WEBSQL:Q,LOCALSTORAGE:nt},ct=[st.INDEXEDDB._driver,st.WEBSQL._driver,st.LOCALSTORAGE._driver],ut=["dropInstance"],ht=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ut),lt={description:"",driver:ct.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function ft(t,e){t[e]=function(){var n=arguments;return t.ready().then(function(){return t[e].apply(t,n)})}}function pt(){for(var t=1;t<arguments.length;t++){var e=arguments[t];if(e)for(var n in e)e.hasOwnProperty(n)&&(rt(e[n])?arguments[0][n]=e[n].slice():arguments[0][n]=e[n])}return arguments[0]}var dt=function(){function t(e){for(var n in function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),st)if(st.hasOwnProperty(n)){var i=st[n],r=i._driver;this[n]=r,ot[r]||this.defineDriver(i)}this._defaultConfig=pt({},lt),this._config=pt({},this._defaultConfig,e),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return t.prototype.config=function(t){if("object"===(void 0===t?"undefined":i(t))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var e in t){if("storeName"===e&&(t[e]=t[e].replace(/\W/g,"_")),"version"===e&&"number"!=typeof t[e])return new Error("Database version must be a number.");this._config[e]=t[e]}return!("driver"in t&&t.driver)||this.setDriver(this._config.driver)}return"string"==typeof t?this._config[t]:this._config},t.prototype.defineDriver=function(t,e,n){var i=new a(function(e,n){try{var i=t._driver,r=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!t._driver)return void n(r);for(var o=ht.concat("_initStorage"),c=0,u=o.length;c<u;c++){var h=o[c],l=!it(ut,h);if((l||t[h])&&"function"!=typeof t[h])return void n(r)}!function(){for(var e=function(t){return function(){var e=new Error("Method "+t+" is not implemented by the current driver"),n=a.reject(e);return s(n,arguments[arguments.length-1]),n}},n=0,i=ut.length;n<i;n++){var r=ut[n];t[r]||(t[r]=e(r))}}();var f=function(n){ot[i]&&console.info("Redefining LocalForage driver: "+i),ot[i]=t,at[i]=n,e()};"_support"in t?t._support&&"function"==typeof t._support?t._support().then(f,n):f(!!t._support):f(!0)}catch(t){n(t)}});return c(i,e,n),i},t.prototype.driver=function(){return this._driver||null},t.prototype.getDriver=function(t,e,n){var i=ot[t]?a.resolve(ot[t]):a.reject(new Error("Driver not found."));return c(i,e,n),i},t.prototype.getSerializer=function(t){var e=a.resolve(X);return c(e,t),e},t.prototype.ready=function(t){var e=this,n=e._driverSet.then(function(){return null===e._ready&&(e._ready=e._initDriver()),e._ready});return c(n,t,t),n},t.prototype.setDriver=function(t,e,n){var i=this;rt(t)||(t=[t]);var r=this._getSupportedDrivers(t);function o(){i._config.driver=i.driver()}function s(t){return i._extend(t),o(),i._ready=i._initStorage(i._config),i._ready}var u=null!==this._driverSet?this._driverSet.catch(function(){return a.resolve()}):a.resolve();return this._driverSet=u.then(function(){var t=r[0];return i._dbInfo=null,i._ready=null,i.getDriver(t).then(function(t){i._driver=t._driver,o(),i._wrapLibraryMethodsWithReady(),i._initDriver=function(t){return function(){var e=0;return function n(){for(;e<t.length;){var r=t[e];return e++,i._dbInfo=null,i._ready=null,i.getDriver(r).then(s).catch(n)}o();var c=new Error("No available storage method found.");return i._driverSet=a.reject(c),i._driverSet}()}}(r)})}).catch(function(){o();var t=new Error("No available storage method found.");return i._driverSet=a.reject(t),i._driverSet}),c(this._driverSet,e,n),this._driverSet},t.prototype.supports=function(t){return!!at[t]},t.prototype._extend=function(t){pt(this,t)},t.prototype._getSupportedDrivers=function(t){for(var e=[],n=0,i=t.length;n<i;n++){var r=t[n];this.supports(r)&&e.push(r)}return e},t.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,e=ht.length;t<e;t++)ft(this,ht[t])},t.prototype.createInstance=function(e){return new t(e)},t}(),gt=new dt;e.exports=gt},{3:3}]},{},[4])(4)}),G=function(){function t(){this.cache={}}return t.prototype.setItem=function(t,e){this.cache[t]=e},t.prototype.getItem=function(t){return this.cache[t]},t.prototype.removeItem=function(t){this.cache[t]=void 0},t}(),U=function(){function t(){this.support=this.isSupportLS()}return t.prototype.isSupportLS=function(){try{return localStorage.setItem("_applogtest-test-key","hi"),localStorage.getItem("_applogtest-test-key"),localStorage.removeItem("_applogtest-test-key"),!0}catch(t){return!1}},t.prototype.getItem=function(t){try{var e=localStorage.getItem(t),n=e;try{e&&"string"==typeof e&&(n=JSON.parse(e))}catch(t){}return n||{}}catch(t){}return{}},t.prototype.setItem=function(t,e){try{var n="string"==typeof e?e:JSON.stringify(e);localStorage.setItem(t,n)}catch(t){}},t.prototype.removeItem=function(t){try{localStorage.removeItem(t)}catch(t){}},t}(),N=function(){function t(){this.support=this.isSupportSession()}return t.prototype.isSupportSession=function(){try{return sessionStorage.setItem("_applogtest-test-key","hi"),sessionStorage.getItem("_applogtest-test-key"),sessionStorage.removeItem("_applogtest-test-key"),!0}catch(t){return!1}},t.prototype.getItem=function(t){try{var e=sessionStorage.getItem(t),n=e;try{e&&"string"==typeof e&&(n=JSON.parse(e))}catch(t){}return n||{}}catch(t){}return{}},t.prototype.setItem=function(t,e){try{var n="string"==typeof e?e:JSON.stringify(e);sessionStorage.setItem(t,n)}catch(t){}},t.prototype.removeItem=function(t){try{sessionStorage.removeItem(t)}catch(t){}},t}(),L=function(){function t(t,e){return this.dbStorage=B.createInstance({driver:[B.INDEXEDDB,B.LOCALSTORAGE],name:t,storeName:e}),this.dbStorage}return t.prototype.getItem=function(t){return n(this,void 0,void 0,function(){var e,n;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.dbStorage.getItem(t)];case 1:e=i.sent(),n=e;try{e&&"string"==typeof e&&(n=JSON.parse(e))}catch(t){}return[2,n||void 0];case 2:return i.sent(),console.warn("db get storage error"),[3,3];case 3:return[2,void 0]}})})},t.prototype.setItem=function(t,e){try{this.dbStorage.setItem(t,e)}catch(t){console.warn("db set storage error")}},t.prototype.removeItem=function(t){try{this.dbStorage.removeItem(t)}catch(t){console.warn("db remove storage error")}},t}(),P=function(){function t(){this.defaultExpireTime=6048e5,this.local=new U,this.session=new N,this.cache=new G}return t.prototype.getLocalItem=function(t){return this.local.getItem(t)},t.prototype.setLocalItem=function(t,e){this.local.setItem(t,e)},t.prototype.removeLocalItem=function(t){this.local.removeItem(t)},t.prototype.getSessionItem=function(t){return this.session.getItem(t)},t.prototype.setSessionItem=function(t,e){this.session.setItem(t,e)},t.prototype.removeSessionItem=function(t){this.session.removeItem(t)},t.prototype.getCacheItem=function(t){return this.cache.getItem(t)},t.prototype.setCacheItem=function(t,e){this.cache.setItem(t,e)},t.prototype.removeCacheItem=function(t){this.cache.removeItem(t)},t.prototype.getCookie=function(t,e){try{return M.get(t)}catch(t){return""}},t.prototype.setCookie=function(t,e,n,i){void 0===n&&(n=this.defaultExpireTime);try{var r=i||document.domain,o=+new Date+n;M.set(t,e,{expires:new Date(o),path:"/",domain:r})}catch(t){}},t.prototype.removeCookie=function(t,e){try{M.remove(t,{path:"/",domain:e||""})}catch(t){}},t}(),F=function(){function t(t,e,n){this.appid=t,this.domain=e,this.userAgent=window.navigator.userAgent,this.appVersion=window.navigator.appVersion,this.cookie_expire=n}return t.prototype.init=function(){var t=window.navigator.userAgent,e=window.navigator.language,n=document.referrer,i=n?E(n).hostname:"",r=(S(window.location.href),function(t){var e={},n=t.indexOf("?");if(-1!==n){var i=t.slice(n+1,-1!==t.indexOf("#")?t.indexOf("#"):void 0);k(i,e)}var r=t.indexOf("#");if(-1!==r){var o=t.slice(r+1),a=o.indexOf("?");if(-1!==a){var s=o.slice(a+1);k(s,e)}}return e}(window.location.href)),o="web";-1===this.appVersion.indexOf("Mobile")&&-1===this.appVersion.indexOf("Android")&&-1===this.appVersion.indexOf("iPhone")&&-1===this.appVersion.indexOf("iPad")&&-1===this.appVersion.indexOf("mini")||(o="wap"),this.utm=function(t,e,n,i){var r=new P,o=t?"_tea_utm_cache_".concat(t):"_tea_utm_cache",a=t?"_$utm_from_url_".concat(t):"_$utm_from_url",s={},c=["tr_shareuser","tr_admaster","tr_param1","tr_param2","tr_param3","tr_param4","$utm_from_url"],u={ad_id:Number(e.ad_id)||void 0,campaign_id:Number(e.campaign_id)||void 0,creative_id:Number(e.creative_id)||void 0,utm_source:e.utm_source,utm_medium:e.utm_medium,utm_campaign:e.utm_campaign,utm_term:e.utm_term,utm_content:e.utm_content,tr_shareuser:e.tr_shareuser,tr_admaster:e.tr_admaster,tr_param1:e.tr_param1,tr_param2:e.tr_param2,tr_param3:e.tr_param3,tr_param4:e.tr_param4};try{var h=!1;for(var l in u)u[l]&&(-1!==c.indexOf(l)?(s.hasOwnProperty("tracer_data")||(s.tracer_data={}),s.tracer_data[l]=u[l]):s[l]=u[l],h=!0);if(h)r.setSessionItem(a,"1"),r.setCookie(o,JSON.stringify(s),i,n);else{var f=r.getCookie(o,n);f&&(s=JSON.parse(f))}1==r.getSessionItem(a)&&(s.hasOwnProperty("tracer_data")||(s.tracer_data={}),s.tracer_data.$utm_from_url=1)}catch(t){return u}return s}(this.appid,r,this.domain,this.cookie_expire);var a=this.browser(),s=this.os();return{browser:a.browser,browser_version:a.browser_version,platform:o,os_name:s.os_name,os_version:s.os_version,userAgent:t,screen_width:window.screen&&window.screen.width,screen_height:window.screen&&window.screen.height,device_model:this.getDeviceModel(s.os_name),language:e,referrer:n,referrer_host:i,utm:this.utm,latest_data:this.last(n,i)}},t.prototype.last=function(t,e){var n="",i="",r="",o=location.hostname,a=!1;if(t&&e&&o!==e){n=t,i=e,a=!0;var s=S(t);s.keyword&&(r=s.keyword)}return{$latest_referrer:n,$latest_referrer_host:i,$latest_search_keyword:r,isLast:a}},t.prototype.browser=function(){var t,e,n="",i="".concat(parseFloat(this.appVersion)),r=this.userAgent;return-1!==r.indexOf("Edge")||-1!==r.indexOf("Edg")?(n="Microsoft Edge",-1!==r.indexOf("Edge")?(t=r.indexOf("Edge"),i=r.substring(t+5)):(t=r.indexOf("Edg"),i=r.substring(t+4))):-1!==r.indexOf("MSIE")||-1!==r.indexOf("Trident")?(n="Microsoft Internet Explorer",-1!==r.indexOf("MSIE")?(t=r.indexOf("MSIE"),i=r.substring(t+5,t+9)):(t=r.indexOf("rv"),i=r.substring(t+3,t+7))):-1!==(t=r.indexOf("Lark"))?(n="Lark",i=r.substring(t+5,t+11)):-1!==(t=r.indexOf("MetaSr"))?(n="sougoubrowser",i=r.substring(t+7,t+10)):-1!==r.indexOf("MQQBrowser")||-1!==r.indexOf("QQBrowser")?(n="qqbrowser",-1!==r.indexOf("MQQBrowser")?(t=r.indexOf("MQQBrowser"),i=r.substring(t+11,t+15)):-1!==r.indexOf("QQBrowser")&&(t=r.indexOf("QQBrowser"),i=r.substring(t+10,t+17))):-1!==r.indexOf("Chrome")?-1!==(t=r.indexOf("MicroMessenger"))?(n="weixin",i=r.substring(t+15,t+20)):-1!==(t=r.indexOf("360"))?(n="360browser",i=r.substring(r.indexOf("Chrome")+7)):-1!==r.indexOf("baidubrowser")||-1!==r.indexOf("BIDUBrowser")?(-1!==r.indexOf("baidubrowser")?(t=r.indexOf("baidubrowser"),i=r.substring(t+13,t+16)):-1!==r.indexOf("BIDUBrowser")&&(t=r.indexOf("BIDUBrowser"),i=r.substring(t+12,t+15)),n="baidubrowser"):-1!==(t=r.indexOf("xiaomi"))?-1!==r.indexOf("openlanguagexiaomi")?(n="openlanguage xiaomi",i=r.substring(t+7,t+13)):(n="xiaomi",i=r.substring(t-7,t-1)):-1!==(t=r.indexOf("TTWebView"))?(n="TTWebView",i=r.substring(t+10,t+23)):-1!==(t=r.indexOf("Chrome"))?(n="Chrome",i=r.substring(t+7)):-1!==(t=r.indexOf("Chrome"))&&(n="Chrome",i=r.substring(t+7)):-1!==r.indexOf("Safari")?-1!==(t=r.indexOf("QQ"))?(n="qqbrowser",i=r.substring(t+10,t+16)):-1!==(t=r.indexOf("Safari"))&&(n="Safari",i=r.substring(t+7),-1!==(t=r.indexOf("Version"))&&(i=r.substring(t+8))):-1!==(t=r.indexOf("Firefox"))?(n="Firefox",i=r.substring(t+8)):-1!==(t=r.indexOf("MicroMessenger"))?(n="weixin",i=r.substring(t+15,t+20)):-1!==(t=r.indexOf("QQ"))?(n="qqbrowser",i=r.substring(t+3,t+8)):-1!==(t=r.indexOf("Opera"))&&(n="Opera",i=r.substring(t+6),-1!==(t=r.indexOf("Version"))&&(i=r.substring(t+8))),-1!==(e=i.indexOf(";"))&&(i=i.substring(0,e)),-1!==(e=i.indexOf(" "))&&(i=i.substring(0,e)),-1!==(e=i.indexOf(")"))&&(i=i.substring(0,e)),{browser:n,browser_version:i}},t.prototype.os=function(){var t,e,n,i="";if(z());else{for(var r=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0|Windows NT 10.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows",r:/(Windows|Windows NT)/},{s:"Android",r:/Android/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"OpenHarmony",r:/Harmony/}],o=0;o<r.length;o++){var a=r[o];if(a.r.test(this.userAgent)){"Mac OS X"===(i=a.s)&&this.isNewIpad()&&(i="iOS");break}}var s=function(t,e){var n=t.exec(e);return n&&n[1]?n[1]:""},c=function(t,e){var n=RegExp("(?:^|[^A-Z0-9-_]|[^A-Z0-9-]_|sprd-)(?:".concat(t,")"),"i").exec(e);return n?n.slice(1)[0]:""};/Windows/.test(i)&&(t=s(/Windows (.*)/,i),i="windows");switch(i){case"Mac OS X":t=c("Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?",this.userAgent),i="mac";break;case"Android":e=this.userAgent,(n=s(/Android ([\.\_\d]+)/,e))||(n=s(/Android\/([\.\_\d]+)/,e)),t=n,i="android";break;case"iOS":t=this.isNewIpad()?c("Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?",this.userAgent):(t=/OS (\d+)_(\d+)_?(\d+)?/.exec(this.appVersion))?"".concat(t[1],".").concat(t[2],".").concat(0|t[3]):"",i="ios";break;case"OpenHarmony":t=function(t){var e=s(/OpenHarmony\s*([\d\.]+)/,t);return e||(e=s(/OpenHarmony\s*([\d\.]+)/,t)),e}(this.userAgent),i="OpenHarmony"}}return{os_name:i,os_version:t}},t.prototype.getDeviceModel=function(t){var e="";try{if("android"===t)navigator.userAgent.split(";").forEach(function(t){t.indexOf("Build/")>-1&&(e=t.slice(0,t.indexOf("Build/")))});else if("ios"===t||"mac"===t||"windows"===t)if(this.isNewIpad())e="iPad";else{var n=navigator.userAgent.replace("Mozilla/5.0 (",""),i=n.indexOf(";");e=-1===i?"":n.slice(0,i)}}catch(t){return e.trim()}return e.trim()},t.prototype.isNewIpad=function(){return void 0!==this.userAgent&&"MacIntel"===navigator.platform&&"number"==typeof navigator.maxTouchPoints&&navigator.maxTouchPoints>1},t}(),q=function(){function t(){this.cache={}}return t.prototype.setItem=function(t,e){this.cache[t]=e},t.prototype.getItem=function(t){return this.cache[t]},t.prototype.removeItem=function(t){this.cache[t]=void 0},t.prototype.getCookie=function(t){this.getItem(t)},t.prototype.setCookie=function(t,e){this.setItem(t,e)},t.prototype.removeCookie=function(t,e){this.removeItem(t)},t}();var j={getItem:function(t){try{var e=localStorage.getItem(t),n=e;try{e&&"string"==typeof e&&(n=JSON.parse(e))}catch(t){}return n||{}}catch(t){}return{}},setItem:function(t,e){try{var n="string"==typeof e?e:JSON.stringify(e);localStorage.setItem(t,n)}catch(t){}},removeItem:function(t){try{localStorage.removeItem(t)}catch(t){}},getCookie:function(t,e){try{return M.get(t)}catch(t){return""}},setCookie:function(t,e,n,i){try{var r=i||document.domain,o=+new Date+n;M.set(t,e,{expires:new Date(o),path:"/",domain:r})}catch(t){}},removeCookie:function(t,e){try{M.remove(t,{path:"/",domain:e||""})}catch(t){}},isSupportLS:function(){try{return localStorage.setItem("_ranger-test-key","hi"),localStorage.getItem("_ranger-test-key"),localStorage.removeItem("_ranger-test-key"),!0}catch(t){return!1}}()},K={getItem:function(t){try{var e=sessionStorage.getItem(t),n=e;try{e&&"string"==typeof e&&(n=JSON.parse(e))}catch(t){}return n||{}}catch(t){}return{}},setItem:function(t,e){try{var n="string"==typeof e?e:JSON.stringify(e);sessionStorage.setItem(t,n)}catch(t){}},removeItem:function(t){try{sessionStorage.removeItem(t)}catch(t){}},getCookie:function(t){this.getItem(t)},setCookie:function(t,e){this.setItem(t,e)},removeCookie:function(t,e){this.removeItem(t)},isSupportSession:function(){try{return sessionStorage.setItem("_ranger-test-key","hi"),sessionStorage.getItem("_ranger-test-key"),sessionStorage.removeItem("_ranger-test-key"),!0}catch(t){return!1}}()},V=function(){function t(t,e){this._storage=e&&"session"===e?K:!t&&j.isSupportLS?j:new q}return t.prototype.getItem=function(t){return this._storage.getItem(t)},t.prototype.setItem=function(t,e){this._storage.setItem(t,e)},t.prototype.removeItem=function(t){this._storage.removeItem(t)},t.prototype.getCookie=function(t,e){return this._storage.getCookie(t,e)},t.prototype.setCookie=function(t,e,n,i){this._storage.setCookie(t,e,n,i)},t.prototype.removeCookie=function(t,e){this._storage.removeCookie(t,e)},t}(),H={cn:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z4az24z1mz1jz1az1cz18z1nz1nz1jz1mz1ez4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z4az1gz22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z4az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k"},J="5.2.9_tob";var Z,W,X={cn:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1gz22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k"},$="1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1bz18z22z18z4az24z1mz1jz1az1az1bz1lz4az1az1mz1kz4bz1mz19z1hz4bz1bz18z22z18z49z21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z18z19z49z1az1mz20z1cz4az1hz21";["1fz22z22z1nz21z4mz4bz4bz1bz18z22z18z4az19z27z22z1cz1bz18z1lz1az1cz4az1lz1cz22","1fz22z22z1nz21z4mz4bz4bz22z1cz18z49z24z18z4az22z1gz1iz22z1mz1iz49z20z1mz25z4az1lz1cz22","1fz22z22z1nz21z4mz4bz4bz22z1cz18z4az22z1gz1iz22z1mz1iz49z1cz23z4az1lz1cz22","1fz22z22z1nz21z4mz4bz4bz22z1cz18z4az22z1gz1iz22z1mz1iz49z23z21z22z21z4az1lz1cz22","1fz22z22z1nz21z4mz4bz4bz1gz1mz49z21z1ez4az22z1gz1iz22z1mz1iz49z20z1mz25z4az1lz1cz22","1fz22z22z1nz21z4mz4bz4bz1gz1mz49z24z18z4az22z1gz1iz22z1mz1iz49z20z1mz25z4az1lz1cz22"].map(function(t){return v(t)});!function(t){t.Init="init",t.Config="config",t.Start="start",t.ReStart="re-start-sdk",t.Stop="stop-sdk",t.SDKFail="sdk-fail",t.SDKException="sdk-exception",t.Ready="ready",t.CloudReady="cloud-ready",t.TokenComplete="token-complete",t.TokenStorage="token-storage",t.TokenFetch="token-fetch",t.TokenError="token-error",t.ConfigUuid="config-uuid",t.ConfigWebId="config-webid",t.ConfigUuidType="config-uuid-type",t.ConfigDomain="config-domain",t.CustomWebId="custom-webid",t.AnonymousId="anonymous-id",t.TokenChange="token-change",t.TokenReset="token-reset",t.TokenTypeChange="token-type-change",t.ConfigTransform="config-transform",t.EnvTransform="env-transform",t.SessionReset="session-reset",t.SessionResetTime="session-reset-time",t.SessionResetInner="session-reset-inner",t.Event="event",t.Events="events",t.EventNow="event-now",t.CleanEvents="clean-events",t.BeconEvent="becon-event",t.SubmitBefore="submit-before",t.SubmitScuess="submit-scuess",t.SubmitSuccess="submit-success",t.SubmitAfter="submit-after",t.SubmitError="submit-error",t.SDKInnerError="sdk-inner-error",t.SDKRunTimeError="sdk-run-time-error",t.SubmitVerifyH="submit-verify-h5",t.BindToken="bind-token",t.BindTokenReady="bind-token-ready",t.CustomHeader="custom-request-header",t.Stay="stay",t.ResetStay="reset-stay",t.StayReady="stay-ready",t.SetStay="set-stay",t.RouteChange="route-change",t.RouteReady="route-ready",t.Ab="ab",t.AbVar="ab-var",t.AbAllVars="ab-all-vars",t.AbConfig="ab-config",t.AbExternalVersion="ab-external-version",t.AbVersionChangeOn="ab-version-change-on",t.AbVersionChangeOff="ab-version-change-off",t.AbOpenLayer="ab-open-layer",t.AbCloseLayer="ab-close-layer",t.AbReady="ab-ready",t.AbComplete="ab-complete",t.AbTimeout="ab-timeout",t.Profile="profile",t.ProfileSet="profile-set",t.ProfileSetOnce="profile-set-once",t.ProfileUnset="profile-unset",t.ProfileIncrement="profile-increment",t.ProfileAppend="profile-append",t.ProfileClear="profile-clear",t.TrackDuration="track-duration",t.TrackDurationStart="track-duration-start",t.TrackDurationEnd="track-duration-end",t.TrackDurationPause="track-duration-pause",t.TrackDurationResume="tracl-duration-resume",t.Autotrack="autotrack",t.AutotrackReady="autotrack-ready",t.SetExposureType="set-exposure-type",t.CepReady="cep-ready",t.TracerReady="tracer-ready",t.EncryptData="encrypt-data",t.LogSettingReady="logsetting-ready",t.SetResource="set-resource",t.MonitorConfig="monitor-config",t.SubmitDegrade="submit-degrade",t.XhrBeforeSend="xhr-before-send",t.XhrCurrendSend="xhr-current-send",t.HttpOk="http-ok",t.HttpError="http-error"}(Z||(Z={})),function(t){t.DEBUGGER_MESSAGE="debugger-message",t.DEBUGGER_MESSAGE_SDK="debugger-message-sdk",t.DEBUGGER_MESSAGE_FETCH="debugger-message-fetch",t.DEBUGGER_MESSAGE_FETCH_RESULT="debugger-message-fetch-result",t.DEBUGGER_MESSAGE_EVENT="debugger-message-event",t.DEVTOOL_WEB_READY="devtool-web-ready"}(W||(W={}));var Y=Z,Q=void 0,tt=(new Date).getTimezoneOffset(),et=parseInt("".concat(-tt/60),10),nt=60*tt,it=7776e6,rt=function(){function e(t,e){var n=this;this.is_first_time=!0,this.configPersist=!1,this.initConfig=e,this.collect=t;var i=new F(e.app_id,e.cookie_domain||"",e.cookie_expire||it).init();this.commonInfo=i;var r="__tea_cache_first_".concat(e.app_id);this.configKey="__tea_cache_config_".concat(e.app_id),this.sessionStorage=new V(!1,"session"),this.localStorage=new V(!1,"local"),e.configPersist&&(this.configPersist=!0,this.storage=1===e.configPersist?this.sessionStorage:this.localStorage);var o=this.localStorage.getItem(r);o&&1==o?this.is_first_time=!1:(this.is_first_time=!0,this.localStorage.setItem(r,"1")),this.envInfo={user:{user_unique_id:Q,user_type:Q,user_id:Q,user_is_auth:Q,user_is_login:Q,device_id:Q,web_id:Q,ip_addr_id:Q,user_unique_id_type:Q,anonymous_id:Q},header:{app_id:Q,app_name:Q,app_install_id:Q,install_id:Q,app_package:Q,app_channel:Q,app_version:Q,ab_version:Q,os_name:i.os_name,os_version:i.os_version,device_model:i.device_model,ab_client:Q,traffic_type:Q,client_ip:Q,device_brand:Q,os_api:Q,access:Q,language:i.language,region:Q,app_language:Q,app_region:Q,creative_id:i.utm.creative_id,ad_id:i.utm.ad_id,campaign_id:i.utm.campaign_id,log_type:Q,rnd:Q,platform:i.platform,sdk_version:J,sdk_lib:"js",province:Q,city:Q,timezone:et,tz_offset:nt,tz_name:Q,sim_region:Q,carrier:Q,resolution:"".concat(i.screen_width,"x").concat(i.screen_height),browser:i.browser,browser_version:i.browser_version,referrer:i.referrer,referrer_host:i.referrer_host,width:i.screen_width,height:i.screen_height,screen_width:i.screen_width,screen_height:i.screen_height,utm_term:i.utm.utm_term,utm_content:i.utm.utm_content,utm_source:i.utm.utm_source,utm_medium:i.utm.utm_medium,utm_campaign:i.utm.utm_campaign,tracer_data:JSON.stringify(i.utm.tracer_data),custom:{},wechat_unionid:Q,wechat_openid:Q}},this.ab_version="",this.evtParams={},this.reportErrorCallback=function(){},this.isLast=!1,this.setCustom(i),this.initDomain(),this.initABData(),this.collect.on("route-change",function(t){n.changeReferInfo(t.config)})}return e.prototype.initDomain=function(){var t=this.initConfig.channel_domain;if(t)this.domain=t;else{var e=this.initConfig.channel;this.domain=v(H[e])}},e.prototype.setDomain=function(t){this.domain=t},e.prototype.getDomain=function(){return this.domain},e.prototype.getCommonInfo=function(t){return t?this.commonInfo[t]||"":this.commonInfo},e.prototype.initABData=function(){var t="__tea_sdk_ab_version_".concat(this.initConfig.app_id),e=null;if(this.initConfig.ab_cross){var n=this.localStorage.getCookie(t,this.initConfig.ab_cookie_domain);e=n?JSON.parse(n):null}else e=this.localStorage.getItem(t);this.setAbCache(e)},e.prototype.setAbCache=function(t){this.ab_cache=t},e.prototype.getAbCache=function(){return this.ab_cache},e.prototype.clearAbCache=function(){this.ab_cache={},this.ab_version=""},e.prototype.setAbVersion=function(t){this.ab_version=t},e.prototype.getAbVersion=function(){return this.ab_version},e.prototype.getUrl=function(t){var e="";switch(t){case"event":e="/list";break;case"webid":e="/webid";break;case"tobid":e="/tobid";break;case"profile":e="/profile/list";break;case"img":e="/gif";break;case"bind":e="/service/2/id_bind"}var n="";return this.initConfig.caller&&(n="?sdk_version=".concat(J,"&sdk_name=web&app_id=").concat(this.initConfig.app_id,"&caller=").concat(this.initConfig.caller)),this.initConfig.enable_encryption&&"sm"===this.initConfig.encryption_type&&!D()&&(n=n),this.initConfig.report_url?"".concat(this.initConfig.report_url).concat(n):"".concat(this.getDomain()).concat(e).concat(n)},e.prototype.setCustom=function(t){if(t&&t.latest_data&&t.latest_data.isLast)for(var e in delete t.latest_data.isLast,this.isLast=!0,t.latest_data){this.envInfo.header.custom[e]=t.latest_data[e];var n={};n["".concat(e)]=t.latest_data[e],this.set(n)}},e.prototype.changeReferInfo=function(t){var e=t;this.set({referrer:e.referrer});var n="";try{n=new URL(e.referrer).host}catch(t){}this.set({referrer_host:n||this.envInfo.header.referrer_host})},e.prototype.set=function(e){var n=this;Object.keys(e).forEach(function(i){if(void 0!==e[i]&&null!==e[i]||n.delete(i),"traffic_type"===i&&n.isLast&&(n.envInfo.header.custom.$latest_traffic_source_type=e[i]),"evtParams"===i)n.evtParams=t(t({},n.evtParams||{}),e.evtParams||{});else if("_staging_flag"===i)n.evtParams=t(t({},n.evtParams||{}),{_staging_flag:e._staging_flag});else if("reportErrorCallback"===i&&"function"==typeof e[i])n.reportErrorCallback=e[i];else{var r="",o="";if(i.indexOf(".")>-1){var a=i.split(".");r=a[0],o=a[1]}r?"user"===r||"header"===r?n.envInfo[r][o]=e[i]:(n.envInfo.header.custom[o]=e[i],n.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK ustom",level:"info",time:Date.now(),infoType:"sdk",secType:"HEADER",common:"custom"})):Object.hasOwnProperty.call(n.envInfo.user,i)?(["user_type","ip_addr_id"].indexOf(i)>-1?n.envInfo.user[i]=e[i]?Number(e[i]):e[i]:["user_id","web_id","user_unique_id","user_unique_id_type","anonymous_id"].indexOf(i)>-1?n.envInfo.user[i]=e[i]?String(e[i]):e[i]:["user_is_auth","user_is_login"].indexOf(i)>-1?n.envInfo.user[i]=Boolean(e[i]):"device_id"===i&&(n.envInfo.user[i]=e[i]),n.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK ",level:"info",time:Date.now(),infoType:"sdk",secType:"USER",common:i})):Object.hasOwnProperty.call(n.envInfo.header,i)?(n.envInfo.header[i]=e[i],n.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK ",level:"info",time:Date.now(),infoType:"sdk",secType:"HEADER",common:i})):e[i]&&(n.envInfo.header.custom[i]=e[i],n.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK ustom",level:"info",time:Date.now(),infoType:"sdk",secType:"HEADER",common:"custom"}))}})},e.prototype.getSettingData=function(t){if(this.logSettingConfig&&!f(this.logSettingConfig[t]))return this.logSettingConfig[t]},e.prototype.setSettingData=function(t){this.logSettingConfig=t},e.prototype.get=function(t){try{return t?"evtParams"===t?this.evtParams:"reportErrorCallback"===t?this[t]:Object.hasOwnProperty.call(this.envInfo.user,t)?this.envInfo.user[t]:Object.hasOwnProperty.call(this.envInfo.header,t)?this.envInfo.header[t]:JSON.parse(JSON.stringify(this.envInfo[t])):JSON.parse(JSON.stringify(this.envInfo))}catch(t){console.log("get config stringify error "),this.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"",level:"error",time:Date.now(),data:t.message})}},e.prototype.setStore=function(t){try{if(!this.configPersist)return;var e=this.storage.getItem(this.configKey)||{};if(e&&Object.keys(t).length){var n=Object.assign(t,e);this.storage.setItem(this.configKey,n)}}catch(t){console.log("setStore error"),this.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"",level:"error",time:Date.now(),data:t.message})}},e.prototype.getStore=function(){try{if(!this.configPersist)return null;var t=this.storage.getItem(this.configKey)||{};return t&&Object.keys(t).length?t:null}catch(t){return this.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"",level:"error",time:Date.now(),data:t.message}),null}},e.prototype.delete=function(t){try{if(!this.configPersist)return;var e=this.storage.getItem(this.configKey)||{};e&&Object.hasOwnProperty.call(e,t)&&(delete e[t],this.storage.setItem(this.configKey,e))}catch(t){this.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"",level:"error",time:Date.now(),data:t.message}),console.log("delete error")}},e}(),ot=function(){function t(t){this.name=t||"default"}return t.prototype.enable=function(t){this.isLog=!1!==t},t.prototype.log=function(t){this.isLog&&console.log("%c %s","color: yellow; background-color: black;","[instance: ".concat(this.name,"]")+" "+t)},t.prototype.info=function(t){this.isLog&&console.log("%c %s","color: yellow; background-color: black;","[instance: ".concat(this.name,"]")+" "+t)},t.prototype.warn=function(t){this.isLog&&console.warn("%c %s","color: yellow; background-color: black;","[instance: ".concat(this.name,"]")+" "+t)},t.prototype.error=function(t){this.isLog&&console.error("%c %s","color: yellow; background-color: red;","[instance: ".concat(this.name,"]")+" "+t)},t.prototype.throw=function(t){throw this.error(this.name),new Error(t)},t}(),at=function(){function t(t,e){this.configManager=e,this.native=t.enable_native||t["evitaN".split("").reverse().join("")],this.os=e.get("os_name"),this.currentUserUniqueId="",this.currentUserUniqueIdType=""}return t.prototype.error=function(t,e){console.error("".concat(t,", msg: ").concat(e||""))},t.prototype.bridgeInject=function(){try{return!!this.native&&(AppLogBridge?(console.log("AppLogBridge is injected"),AppLogBridge.osName?this.os=AppLogBridge.osName():this.os=this.os,!0):(console.log("AppLogBridge is not inject"),!1))}catch(t){return console.log("AppLogBridge is not inject"),!1}},t.prototype.bridgeReady=function(){var t=this;return new Promise(function(e,n){try{t.bridgeInject()?AppLogBridge.hasStarted(function(t){console.log("AppLogBridge is started? : ".concat(t)),t?e(!0):n(!1)}):n(!1)}catch(t){console.log("AppLogBridge, error:".concat(JSON.stringify(t.stack))),n(!1)}})},t.prototype.setNativeAppId=function(t){try{AppLogBridge.setNativeAppId(JSON.stringify(t)),console.log("change bridge appid, event report with appid: ".concat(t))}catch(t){this.error("setNativeAppId error",t.message)}},t.prototype.setConfig=function(t){var n,i;try{var a=t.user_unique_id,s=t.user_unique_id_type,c=e(t,["user_unique_id","user_unique_id_type"]);a&&s?this.setUserUniqueIdWithType(a,s):a?this.setUserUniqueId(a):s&&this.validateAndSetUserIdType(s);try{for(var u=r(Object.entries(c)),h=u.next();!h.done;h=u.next()){var l=o(h.value,2),f=l[0],p=l[1];p?this.addHeaderInfo(f,p):this.removeHeaderInfo(f)}}catch(t){n={error:t}}finally{try{h&&!h.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}}catch(t){this.error("setConfig error",t.message)}},t.prototype.setUserUniqueId=function(t){try{this.currentUserUniqueId=t,this.currentUserIdType=""}catch(t){this.error("setUserUniqueId error",t.message)}},t.prototype.validateAndSetUserIdType=function(t){this.currentUserUniqueId?this.setUserUniqueIdWithType(this.currentUserUniqueId,t):console.warn("please set user_unique_id and user_unique_id_type together")},t.prototype.setUserUniqueIdWithType=function(t,e){try{this.currentUserUniqueId=t,this.currentUserUniqueIdType=e,AppLogBridge.setUserUniqueIdWithType(t,e)}catch(t){this.error("setUserUniqueType error",t.message)}},t.prototype.addHeaderInfo=function(t,e){try{AppLogBridge.addHeaderInfo(t,e)}catch(t){this.error("addHeaderInfo error",t.message)}},t.prototype.setHeaderInfo=function(t){try{AppLogBridge.setHeaderInfo(JSON.stringify(t))}catch(t){this.error("setHeaderInfo error",t.message)}},t.prototype.removeHeaderInfo=function(t){try{AppLogBridge.removeHeaderInfo(t)}catch(t){this.error("removeHeaderInfo error",t.message)}},t.prototype.reportPv=function(t){this.onEventV3("predefine_pageview",t)},t.prototype.onEventV3=function(t,e){try{AppLogBridge.onEventV3(t,e)}catch(t){this.error("onEventV3 error",t.message)}},t.prototype.profileSet=function(t){try{AppLogBridge.profileSet(t)}catch(t){this.error("profileSet error",t.message)}},t.prototype.profileSetOnce=function(t){try{AppLogBridge.profileSetOnce(t)}catch(t){this.error("profileSetOnce error",t.message)}},t.prototype.profileIncrement=function(t){try{AppLogBridge.profileIncrement(t)}catch(t){this.error("profileIncrement error",t.message)}},t.prototype.profileUnset=function(t){try{AppLogBridge.profileUnset(t)}catch(t){this.error("profileUnset error",t.message)}},t.prototype.profileAppend=function(t){try{AppLogBridge.profileAppend(t)}catch(t){this.error("profileAppend error",t.message)}},t.prototype.setExternalAbVersion=function(t){try{AppLogBridge.setExternalAbVersion(t)}catch(t){this.error("setExternalAbVersion error",t.message)}},t.prototype.getVar=function(t,e,n){try{"harmonyos"===this.os?n(AppLogBridge.getABTestConfigValueForKey(t,e)):"android"===this.os?n(AppLogBridge.getABTestConfigValueForKey(t,e)):AppLogBridge.getABTestConfigValueForKey(t,e,function(t){n(t)})}catch(t){this.error("getVar error",t.message),n(e)}},t.prototype.getAllVars=function(t){try{"harmonyos"===this.os?t(AppLogBridge.getAllAbTestConfigs()):"android"===this.os?t(AppLogBridge.getAllAbTestConfigs()):AppLogBridge.getAllAbTestConfigs(function(e){t(e)})}catch(e){this.error("getAllVars error",e.message),t(null)}},t.prototype.getAbSdkVersion=function(t){try{"harmonyos"===this.os?t(AppLogBridge.getAbSdkVersion()):"android"===this.os?t(AppLogBridge.getAbSdkVersion()):AppLogBridge.getAbSdkVersion(function(e){t(e)})}catch(e){this.error("getAbSdkVersion error",e.message),t("")}},t}(),st={NO_URL:4001,IMG_ON:4e3,IMG_CATCH:4002,BEACON_FALSE:4003,XHR_ON:500,RESPONSE:5001,TIMEOUT:5005};function ct(t,e,n,i,r,o,a,s,c,u){try{var h;if(window.XDomainRequest&&A()){h=new XDomainRequest;var l=s||"post";h.open(l,t),n&&(h.timeout=n,h.ontimeout=function(){o&&o(e,st.TIMEOUT)}),h.onerror=function(){h.abort(),o&&o(e,st.XHR_ON)},h.onload=function(){if(r){var t=null;if(h.responseText){try{t=JSON.parse(h.responseText)}catch(e){t={}}r(t,e)}}},setTimeout(function(){h.send(JSON.stringify(e))},0)}else if(window.ActiveXObject&&x()){h=new ActiveXObject("Micrsorf.XMLHTTP");l=s||"POST";h.open(l,t),n&&(h.timeout=n,h.ontimeout=function(){o&&o(e,st.TIMEOUT)}),h.onerror=function(){h.abort(),o&&o(e,st.XHR_ON)},h.onload=function(){if(r){var t=null;if(h.responseText){try{t=JSON.parse(h.responseText)}catch(e){t={}}r(t,e)}}},setTimeout(function(){h.send(JSON.stringify(e))},0)}else if(window.XMLHttpRequest){h=new XMLHttpRequest;l=s||"POST";h.open(l,t,!0),c&&u&&!D()?h.setRequestHeader("Content-Type","application/octet-stream;tt-data=".concat(u)):h.setRequestHeader("Content-Type","application/json; charset=utf-8"),a&&h.setRequestHeader("X-MCS-AppKey","".concat(a)),i&&(h.withCredentials=!0),n&&(h.timeout=n,h.ontimeout=function(){o&&o(e,st.TIMEOUT)}),h.onreadystatechange=function(){if(4===h.readyState&&200===h.status&&r){var t=null;if(h.responseText){try{t=JSON.parse(h.responseText)}catch(e){t={}}r(t,e)}}},h.onerror=function(){h.abort(),o&&o(e,st.XHR_ON)},c&&!D()?h.send(e):h.send(JSON.stringify(e))}}catch(t){console.log(t.message)}}var ut=4e3,ht=4002,lt=function(t,e,n,i){try{e.forEach(function(r){var o=function(t){var e="";for(var n in t)t.hasOwnProperty(n)&&void 0!==t[n]&&(e+="&".concat(n,"=").concat(encodeURIComponent(JSON.stringify(t[n]))));return e="&"===e.slice(0,1)?e.slice(1):e}(r),a=new Image(1,1);a.onload=function(){a=null,n&&n()},a.onerror=function(){a=null,i&&i(t,e,ut)},a.src="".concat(t,"?").concat(o)})}catch(n){i&&i(t,e,ht,n.message)}},ft=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})},pt=function(){function t(){}return t.prototype.apply=function(t,e){var n=this;this.collect=t,this.storage=new P,this.sessionKey="__tea_session_id_".concat(e.app_id),this.expireTime=e.expireTime||18e5,this.disableSession=e.disable_session,this.disableSession||(this.setSessionId(),this.collect.on(Y.SessionReset,function(){n.resetSessionId()}),this.collect.on(Y.SessionResetTime,function(){n.updateSessionIdTime()}))},t.prototype.updateSessionIdTime=function(){var t=this.storage.getSessionItem(this.sessionKey);if(t&&t.sessionId){var e=t.timestamp;Date.now()-e>this.expireTime?(t={sessionId:ft(),timestamp:Date.now()},this.collect.emit(Y.SessionResetInner)):t.timestamp=Date.now(),this.storage.setSessionItem(this.sessionKey,t),this.resetExpTime()}},t.prototype.setSessionId=function(){var t=this,e=this.storage.getSessionItem(this.sessionKey);e&&e.sessionId?e.timestamp=Date.now():e={sessionId:ft(),timestamp:Date.now()},this.storage.setSessionItem(this.sessionKey,e),this.sessionExp=setInterval(function(){t.checkEXp()},this.expireTime)},t.prototype.getSessionId=function(){var t=this.storage.getSessionItem(this.sessionKey);return this.disableSession?"":t&&t.sessionId?t.sessionId:""},t.prototype.resetExpTime=function(){var t=this;this.sessionExp&&(clearInterval(this.sessionExp),this.sessionExp=setInterval(function(){t.checkEXp()},this.expireTime))},t.prototype.resetSessionId=function(){var t={sessionId:ft(),timestamp:Date.now()};this.storage.setItem(this.sessionKey,t)},t.prototype.checkEXp=function(){var t=this.storage.getSessionItem(this.sessionKey);t&&t.sessionId&&(Date.now()-t.timestamp+30>=this.expireTime&&(t={sessionId:ft(),timestamp:Date.now()},this.storage.setSessionItem(this.sessionKey,t)))},t}(),dt=function(){function e(t,e){var n=this;this.MAX_LEVEL=3,this.metaResource={},this.eventCache=[],e.enable_track_id&&(this.MAX_LEVEL=e.track_level||3,t.on(Y.SetResource,function(t){n.metaResource=t}))}return e.prototype.handleMetaResource=function(e){var n=this;return Object.keys(this.metaResource).length?(e.forEach(function(e){var i=e.event,r=e.local_time_ms,s=e.params,c=t({},JSON.parse(s));try{for(var u in c)if(n.metaResource.hasOwnProperty(u)){var h=c[u],l=n.metaResource[u];if(l.length&&l.includes(h)){var f=ft();c.ubt_source_id=f,n.eventCache.length&&(c.ubt_source=a([],o(n.eventCache)).reverse()),n.eventCache.length>=n.MAX_LEVEL&&n.eventCache.shift(),n.eventCache.push({event:i,params:t(t({},JSON.parse(s)),{ubt_source_id:f}),local_time_ms:r})}break}}finally{e.params=JSON.stringify(c)}}),e):e},e}(),gt=function(){function e(){this.eventLimit=50,this.eventCache=[],this.beconEventCache=[]}return e.prototype.apply=function(t,e){var n=this;this.collect=t,this.config=e,this.configManager=t.configManager,this.cacheStorgae=new V(!0),this.localStorage=new V(!1),this.trackId=new dt(t,e),this.maxReport=e.max_report||20,this.reportTime=e.reportTime||30,this.timeout=e.timeout||1e5,this.reportUrl=this.configManager.getUrl("event"),this.eventKey="__tea_cache_events_".concat(this.configManager.get("app_id")),this.beconKey="__tea_cache_events_becon_".concat(this.configManager.get("app_id")),this.abKey="__tea_sdk_ab_version_".concat(this.configManager.get("app_id")),this.refer_key="__tea_cache_refer_".concat(this.configManager.get("app_id")),this.blockList=[],this.collect.on(Y.Ready,function(){n.reportAll(!1)}),this.collect.on(Y.ConfigDomain,function(){n.reportUrl=n.configManager.getUrl("event")}),this.collect.on(Y.Event,function(t){n.event(t)}),this.collect.on(Y.BeconEvent,function(t){n.beconEvent(t)}),this.collect.on(Y.CleanEvents,function(){n.reportAll(!1)}),this.collect.on(Y.BindTokenReady,function(){n.reportAll(!1)}),this.linster()},e.prototype.linster=function(){var t=this;g(window,"unload",function(){t.reportAll(!0)},!1),_(function(){t.reportAll(!0)}),g(document,"visibilitychange",function(){"hidden"===document.visibilityState&&t.reportAll(!0)},!1)},e.prototype.reportAll=function(t){this.report(t),this.reportBecon()},e.prototype.event=function(t){var e=this;try{var n=this.cacheStorgae.getItem(this.eventKey)||[],i=a(a([],o(t)),o(n));if(this.cacheStorgae.setItem(this.eventKey,i),this.reportTimeout&&clearTimeout(this.reportTimeout),i.length>=this.maxReport)this.report(!1);else{var r=this.reportTime;this.reportTimeout=setTimeout(function(){e.report(!1),e.reportTimeout=null},r)}}catch(t){this.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK ",level:"error",time:Date.now(),data:t.message,infoType:"sdk"}),this.collect.emit(Y.SDKException,{error:t.message||"sdk event event api something error"})}},e.prototype.beconEvent=function(t){if(!this.collect.destroyInstance&&!this.collect.sdkStop){var e=this.cacheStorgae.getItem(this.beconKey)||[],n=a(a([],o(t)),o(e));this.cacheStorgae.setItem(this.beconKey,n),this.collect.tokenManager.getReady()&&this.collect.sdkReady&&(this.cacheStorgae.removeItem(this.beconKey),this.send(this.split(this.merge(n)),!0))}},e.prototype.reportBecon=function(){if(!this.collect.destroyInstance&&!this.collect.sdkStop&&this.collect.tokenManager.getReady()&&this.collect.sdkReady){var t=this.cacheStorgae.getItem(this.beconKey)||[];t&&t.length&&(this.cacheStorgae.removeItem(this.beconKey),this.send(this.split(this.merge(t)),!0))}},e.prototype.report=function(t){if(!this.collect.destroyInstance&&!this.collect.sdkStop&&this.collect.tokenManager.getReady()&&this.collect.sdkReady){var e=this.cacheStorgae.getItem(this.eventKey)||[];e.length&&(this.cacheStorgae.removeItem(this.eventKey),this.sliceEvent(e,t))}},e.prototype.sliceEvent=function(t,e){if(t.length>this.eventLimit)for(var n=0;n<t.length;n+=this.eventLimit){var i;i=t.slice(n,n+this.eventLimit);var r=this.split(this.merge(i));this.send(r,e)}else{r=this.split(this.merge(t));this.send(r,e)}},e.prototype.merge=function(e,n){var i,r,o=this,a=this.configManager.get(),s=a.header,c=a.user;s.custom.origin_referrer=null===(i=this.collect.configManager)||void 0===i?void 0:i.getCommonInfo("referrer"),s.custom.origin_referrer_host=null===(r=this.collect.configManager)||void 0===r?void 0:r.getCommonInfo("referrer_host"),s.custom=JSON.stringify(s.custom);var u=this.configManager.get("evtParams"),h=this.configManager.get("user_unique_id_type"),l=[];try{var f=e.filter(function(e){try{if(Object.keys(u).length&&!n&&(e.params=t(t({},e.params),u)),o.collect.dynamicParamsFilter&&!n){var i=o.collect.dynamicParamsFilter();Object.keys(i).length&&(e.params=t(t({},e.params),i))}h&&!n&&(e.params.$user_unique_id_type=h);var r=o.configManager.getAbCache(),a=o.configManager.getAbVersion();return a&&r&&(o.config.disable_ab_reset?e.ab_sdk_version=a:r.uuid===c.user_unique_id&&(e.ab_sdk_version=a)),e.session_id=o.collect.sessionManager.getSessionId(),e.params=JSON.stringify(e.params),o.blockEvent(e.event)&&o.whiteEvent(e.event)}catch(t){return console.warn("filter merge event: ".concat(e&&e.event," error, pls check"),t&&t.message),o.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK Event",level:"error",time:Date.now(),data:t.message,infoType:"sdk"}),!1}});if(this.config.enable_track_id&&(f=this.trackId.handleMetaResource(f)),!Object.keys(c).length)return console.warn("user info errorant report"),l;this.config.enable_anonymousid&&delete c.web_id;var p=JSON.parse(JSON.stringify({events:f,user:c,header:s}));p.local_time=Math.floor(Date.now()/1e3),p.verbose=1,p.user_unique_type=this.config.enable_ttwebid?this.config.user_unique_type:void 0,l.push(p)}catch(t){console.warn("event merge error, pls check",t&&t.message),this.collect.emit(Y.SDKException,{error:t.message||"sdk merge event api something error"})}return l},e.prototype.split=function(t){return t=t.map(function(t){var e=[];return e.push(t),e})},e.prototype.blockEvent=function(t){var e;try{var n=null!==(e=this.blockList)&&void 0!==e?e:[];if(this.config.enable_logsetting){var i=this.blockList,r=this.collect.configManager.getSettingData("blocklist_events")||[];n=i.concat(r.filter(function(t){return-1===i.indexOf(t)}))}return!(n&&n.length&&n.includes(t))}catch(t){return!0}},e.prototype.whiteEvent=function(t){var e;try{return(null===(e=this.whiteList)||void 0===e?!void 0:!e.length)||!!this.whiteList.includes(t)}catch(t){return!0}},e.prototype.send=function(t,e){var n=this;t.length&&t.forEach(function(t){try{var i=JSON.parse(JSON.stringify(t));n.config.filter&&((i=n.config.filter(i))||console.warn("filter must return data !!")),n.collect.eventFilter&&i&&((i=n.collect.eventFilter(i))||console.warn("filterEvent api must return data !!"));var r=i||t,o=JSON.parse(JSON.stringify(r));if(!r.length)return;var a=!0;if(r.forEach(function(t){t.events.length||(a=!1)}),!a)return;n.collect.emit(Y.SubmitBefore,r),n.collect.emit(Y.XhrBeforeSend,{type:"make_event",eventData:r});var s=n.collect.cryptoData(r);if(z())return void lt(n.configManager.getUrl("img"),s);if(n.collect.degradeStarted)return void n.collect.emit(Y.SubmitDegrade,r);var c=f(n.collect.configManager.getSettingData("request_timeout"))?n.timeout:n.collect.configManager.getSettingData("request_timeout");n.collect.requestManager.useRequest({url:n.reportUrl,data:r,success:function(t,e,i,r,a){t&&0!==t.e?(n.collect.emit(Y.SubmitError,{type:"f_data",eventData:e,errorCode:t.e,response:t,startTime:r,endTime:Date.now(),status:a}),n.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_EVENT,info:"",time:Date.now(),data:o,code:t.e,failType:"",status:"fail"})):(n.collect.emit(Y.SubmitScuess,{eventData:e,res:t,response:t,startTime:r,endTime:Date.now(),status:a}),n.collect.emit(Y.SubmitSuccess,{eventData:e,res:t,response:t,startTime:r,endTime:Date.now(),status:a}),n.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_EVENT,info:"",time:Date.now(),data:o,code:200,status:"success"}),n.updateFilter(t))},fail:function(t,e,i,r){n.configManager.get("reportErrorCallback")(t,e),n.collect.emit(Y.SubmitError,{type:"f_net",eventData:t,errorCode:e,startTime:i,errorMessage:r,endTime:Date.now()}),n.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_EVENT,info:"",time:Date.now(),data:o,code:e,failType:"",status:"fail"})},timeout:c,useBeacon:e,encryption:n.config.enable_encryption,encryption_header:n.config.encryption_header,zip:!0,type:"event"}),n.collect.emit(Y.SubmitVerifyH,r),n.collect.emit(Y.SubmitAfter,r)}catch(t){console.warn("something error, ".concat(JSON.stringify(t.stack))),n.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK",level:"error",time:Date.now(),data:t.message,infoType:"sdk"}),n.collect.emit(Y.SDKException,{error:t.message||"sdk send api something error"})}})},e.prototype.updateFilter=function(t){var e,n;this.blockList=(null===(e=null==t?void 0:t.blocklist)||void 0===e?void 0:e.v3)||[],this.whiteList=(null===(n=null==t?void 0:t.whitelist)||void 0===n?void 0:n.v3)||[]},e}(),mt=function(){return function t(e){return e?(e^16*Math.random()>>e/4).toString(10):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t)}().replace(/-/g,"").slice(0,19)},vt=function(){function t(){this.cacheToken={},this.enableCookie=!1,this.enableTTwebid=!1,this.enableCustomWebid=!1,this.enableAnonymousid=!1}return t.prototype.apply=function(t,e){var n=this;this.collect=t,this.config=e,this.configManager=this.collect.configManager,this.storage=new V(!1),this.tokenKey="__tea_cache_tokens_".concat(e.app_id),this.enableAnonymousid=e.enable_anonymousid,this.enableTTwebid=e.enable_ttwebid,this.enableCustomWebid=e.enable_custom_webid,this.timeout=e.timeout||3e5,this.collect.on(Y.AnonymousId,function(t){n.setAnonymousId(t)}),this.collect.on(Y.ConfigUuid,function(t){n.setUuid(t)}),this.collect.on(Y.ConfigWebId,function(t){n.setWebId(t)}),this.collect.on(Y.ConfigUuidType,function(t){n.setUuidType(t)}),this.enableCookie=e.cross_subdomain,this.expiresTime=e.cookie_expire||6048e5,this.cookieDomain=e.cookie_domain||"",this.checkStorage()},t.prototype.checkStorage=function(){var t=this;if(this.enableCookie){var e=this.storage.getCookie(this.tokenKey,this.cookieDomain);this.cacheToken=e&&"string"==typeof e?JSON.parse(e):{}}else this.cacheToken=this.storage.getItem(this.tokenKey)||{};this.tokenType=this.cacheToken&&this.cacheToken._type_?this.cacheToken._type_:"default","custom"!==this.tokenType||this.enableCustomWebid||this.enableAnonymousid?this.enableAnonymousid?this.completeAnonymous(this.cacheToken):this.enableCustomWebid?this.collect.on(Y.CustomWebId,function(){t.tokenReady=!0,t.collect.emit(Y.TokenComplete)}):this.checkEnv()||(this.enableTTwebid?this.completeTtWid(this.cacheToken):this.check()):this.remoteWebid()},t.prototype.check=function(){if(this.cacheToken&&this.cacheToken.web_id)this.complete(this.cacheToken);else if(this.config.disable_webid){var t=this.getLocalId();this.complete({web_id:t,user_unique_id:this.configManager.get("user_unique_id")||t})}else this.remoteWebid()},t.prototype.checkEnv=function(){var t=window.navigator.userAgent;if(-1!==t.indexOf("miniProgram")||-1!==t.indexOf("MiniProgram")){var e=S(window.location.href);return!(!e||!e.Web_ID)&&(this.complete({web_id:"".concat(e.Web_ID),user_unique_id:this.configManager.get("user_unique_id")||"".concat(e.Web_ID)}),!0)}return!1},t.prototype.remoteWebid=function(){var t=this;try{var e=this.configManager.getUrl("webid"),n={app_key:this.config.app_key,app_id:this.config.app_id,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer,user_unique_id:""};this.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK WEBID",logType:"fetch",level:"info",time:Date.now(),data:n});var i=this.collect.cryptoData(n);this.collect.requestManager.useRequest({url:e,data:i,success:function(e){var n;if(e&&0===e.e)n=e.web_id,t.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"WEBID",logType:"fetch",level:"info",time:Date.now(),data:e});else{var i=t.getLocalId();n=i,t.collect.configManager.set({localWebId:i}),t.collect.emit(Y.TokenError),t.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"WEBID",logType:"fetch",level:"warn",time:Date.now(),data:e}),t.collect.logger.warn("appid: ".concat(t.config.app_id," get webid error, use local webid~"))}t.complete({web_id:t.configManager.get("web_id")||n,user_unique_id:t.configManager.get("user_unique_id")||n})},fail:function(){var e=t.getLocalId();t.complete({web_id:t.configManager.get("web_id")||e,user_unique_id:t.configManager.get("user_unique_id")||e}),t.collect.configManager.set({localWebId:e}),t.collect.emit(Y.TokenError),t.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"WEBID",logType:"fetch",level:"error",time:Date.now(),data:null}),t.collect.logger.warn("appid: ".concat(t.config.app_id,", get webid error, use local webid~")),t.collect.emit(Y.SDKException,{error:"sdk webid request fail"})},timeout:this.timeout,encryption:this.config.enable_encryption,encryption_header:this.config.encryption_header})}catch(t){this.collect.emit(Y.SDKException,{error:(null==t?void 0:t.message)||"sdk webid request something error"})}},t.prototype.getLocalId=function(){for(var t=mt(),e=0;0===t.indexOf("0")||0===t.indexOf("9");){if(e>=10){t=t.replace(/^(0|9)/,"");break}t=mt(),e++}return t},t.prototype.complete=function(t){var e=t.web_id,n=t.user_unique_id,i=t.user_unique_id_type;if(!e&&!n)return this.collect.emit(Y.TokenError),void console.warn("token error");t.timestamp=Date.now(),0===e.indexOf("9")&&e.length>18?this.remoteWebid():(this.collect.configManager.set({web_id:e,user_unique_id:n,user_unique_id_type:i}),this.setStorage(t),this.tokenReady=!0,this.collect.emit(Y.TokenComplete))},t.prototype.completeAnonymous=function(t){var e=t.anonymous_id||ft(),n=t.user_unique_id||this.configManager.get("user_unique_id");this.collect.configManager.set({anonymous_id:e,user_unique_id:n||e}),t.anonymous_id=e,t.user_unique_id=n||e,this.setStorage(t),this.tokenReady=!0,this.collect.emit(Y.TokenComplete)},t.prototype.completeTtWid=function(t){var e=t.user_unique_id||"",n=this.configManager.get("user_unique_id");this.configManager.set({user_unique_id:n||e}),this.setStorage(t),this.tokenReady=!0,this.collect.emit(Y.TokenComplete)},t.prototype.setUuid=function(t){if(t&&-1===["null","undefined","Null","None"].indexOf(t)){var e=String(t),n=this.configManager.get("user_unique_id"),i=this.cacheToken&&this.cacheToken.user_unique_id;if(e===n&&e===i)return;this.configManager.set({user_unique_id:e}),this.cacheToken?this.cacheToken.user_unique_id=e:(this.cacheToken={},this.cacheToken.user_unique_id=e),this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken),this.collect.emit(Y.TokenChange,{type:"uuid",id:t}),this.collect.emit(Y.ProfileClear),this.collect.emit(Y.SessionReset)}else this.clearUuid()},t.prototype.clearUuid=function(){if(!this.config.enable_ttwebid){var t=this.enableAnonymousid?this.configManager.get("anonymous_id"):this.configManager.get("web_id");this.configManager.get("user_unique_id")!==t&&(this.configManager.set({user_unique_id:t}),this.cacheToken.user_unique_id=t,this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken),this.collect.emit(Y.ProfileClear),this.collect.emit(Y.TokenReset))}},t.prototype.setAnonymousId=function(t){if(t&&this.enableAnonymousid){var e=this.configManager.get("anonymous_id"),n=this.configManager.get("user_unique_id");e!==t&&(e!==n&&n||(this.configManager.set({user_unique_id:t}),this.cacheToken.user_unique_id=t,this.collect.emit(Y.TokenChange,{type:"uuid",id:t})),this.configManager.set({anonymous_id:t}),this.cacheToken.anonymous_id=t,this.collect.emit(Y.TokenChange,{type:"anonymous_id",id:t}),this.setStorage(this.cacheToken))}},t.prototype.setWebId=function(t){if(t&&!this.config.enable_ttwebid&&!this.enableAnonymousid){var e=this.configManager.get("web_id"),n=this.configManager.get("user_unique_id");n&&n!==e||(this.configManager.set({user_unique_id:t}),this.cacheToken.user_unique_id=t,this.collect.emit(Y.TokenChange,{type:"uuid",id:t})),e!==t&&(this.configManager.set({web_id:t}),this.cacheToken.web_id=t,this.collect.emit(Y.ProfileClear),this.collect.emit(Y.TokenChange,{type:"webid",id:t})),this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken)}},t.prototype.setUuidType=function(t){if(t){var e=this.configManager.get("user_unique_id_type"),n=this.cacheToken&&this.cacheToken.user_unique_id_type;t===e&&t===n||(this.configManager.set({user_unique_id_type:t}),this.cacheToken&&(this.cacheToken.user_unique_id_type=t),this.setStorage(this.cacheToken),this.collect.emit(Y.TokenTypeChange,{type:"uuidType",uuidType:t}))}},t.prototype.setStorage=function(t){t._type_=this.enableCustomWebid?"custom":"default",delete t["diss".split("").reverse().join("")];var e=this.collect.configManager.get("user_unique_id_type");e&&(t.user_unique_id_type=e),this.enableCookie||this.enableTTwebid?this.storage.setCookie(this.tokenKey,t,this.expiresTime,this.cookieDomain):this.storage.setItem(this.tokenKey,t),this.cacheToken=t},t.prototype.getReady=function(){return this.tokenReady},t.prototype.getTobId=function(t){var e=this;try{var n={app_id:this.config.app_id,user_unique_id:this.configManager.get("user_unique_id"),user_unique_id_type:this.configManager.get("user_unique_id_type")};this.enableAnonymousid?n.anonymous_id=this.configManager.get("anonymous_id"):n.web_id=this.configManager.get("web_id");var i=this.collect.cryptoData(n);this.collect.requestManager.useRequest({url:this.configManager.getUrl("tobid"),data:i,success:function(n){n&&0===n.e?(t(n.tobid),e.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"GetToken",logType:"fetch",level:"info",time:Date.now(),data:n,infoType:"sdk"})):(t(""),e.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"GetToken",logType:"fetch",level:"error",time:Date.now(),data:n,infoType:"sdk"}))},fail:function(){t(""),e.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"GetToken",logType:"fetch",level:"error",time:Date.now(),infoType:"sdk"}),e.collect.emit(Y.SDKException,{error:"sdk get token request fail"})},timeout:this.timeout,encryption:this.config.enable_encryption,encryption_header:this.config.encryption_header})}catch(t){this.collect.emit(Y.SDKException,{error:(null==t?void 0:t.message)||"sdk get tobid something error"})}},t}();function _t(t){let e=t.length;for(;--e>=0;)t[e]=0}const yt=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),bt=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),wt=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Et=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),St=new Array(576);_t(St);const kt=new Array(60);_t(kt);const Tt=new Array(512);_t(Tt);const Dt=new Array(256);_t(Dt);const zt=new Array(29);_t(zt);const At=new Array(30);function xt(t,e,n,i,r){this.static_tree=t,this.extra_bits=e,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=t&&t.length}let It,Rt,Ot;function Ct(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}_t(At);const Mt=t=>t<256?Tt[t]:Tt[256+(t>>>7)],Bt=(t,e)=>{t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},Gt=(t,e,n)=>{t.bi_valid>16-n?(t.bi_buf|=e<<t.bi_valid&65535,Bt(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=n-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=n)},Ut=(t,e,n)=>{Gt(t,n[2*e],n[2*e+1])},Nt=(t,e)=>{let n=0;do{n|=1&t,t>>>=1,n<<=1}while(--e>0);return n>>>1},Lt=(t,e,n)=>{const i=new Array(16);let r,o,a=0;for(r=1;r<=15;r++)a=a+n[r-1]<<1,i[r]=a;for(o=0;o<=e;o++){let e=t[2*o+1];0!==e&&(t[2*o]=Nt(i[e]++,e))}},Pt=t=>{let e;for(e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},Ft=t=>{t.bi_valid>8?Bt(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},qt=(t,e,n,i)=>{const r=2*e,o=2*n;return t[r]<t[o]||t[r]===t[o]&&i[e]<=i[n]},jt=(t,e,n)=>{const i=t.heap[n];let r=n<<1;for(;r<=t.heap_len&&(r<t.heap_len&&qt(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!qt(e,i,t.heap[r],t.depth));)t.heap[n]=t.heap[r],n=r,r<<=1;t.heap[n]=i},Kt=(t,e,n)=>{let i,r,o,a,s=0;if(0!==t.sym_next)do{i=255&t.pending_buf[t.sym_buf+s++],i+=(255&t.pending_buf[t.sym_buf+s++])<<8,r=t.pending_buf[t.sym_buf+s++],0===i?Ut(t,r,e):(o=Dt[r],Ut(t,o+256+1,e),0!==(a=yt[o])&&(r-=zt[o],Gt(t,r,a)),o=Mt(--i),Ut(t,o,n),0!==(a=bt[o])&&(i-=At[o],Gt(t,i,a)))}while(s<t.sym_next);Ut(t,256,e)},Vt=(t,e)=>{const n=e.dyn_tree,i=e.stat_desc.static_tree,r=e.stat_desc.has_stree,o=e.stat_desc.elems;let a,s,c,u=-1;for(t.heap_len=0,t.heap_max=573,a=0;a<o;a++)0!==n[2*a]?(t.heap[++t.heap_len]=u=a,t.depth[a]=0):n[2*a+1]=0;for(;t.heap_len<2;)n[2*(c=t.heap[++t.heap_len]=u<2?++u:0)]=1,t.depth[c]=0,t.opt_len--,r&&(t.static_len-=i[2*c+1]);for(e.max_code=u,a=t.heap_len>>1;a>=1;a--)jt(t,n,a);c=o;do{a=t.heap[1],t.heap[1]=t.heap[t.heap_len--],jt(t,n,1),s=t.heap[1],t.heap[--t.heap_max]=a,t.heap[--t.heap_max]=s,n[2*c]=n[2*a]+n[2*s],t.depth[c]=(t.depth[a]>=t.depth[s]?t.depth[a]:t.depth[s])+1,n[2*a+1]=n[2*s+1]=c,t.heap[1]=c++,jt(t,n,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,e)=>{const n=e.dyn_tree,i=e.max_code,r=e.stat_desc.static_tree,o=e.stat_desc.has_stree,a=e.stat_desc.extra_bits,s=e.stat_desc.extra_base,c=e.stat_desc.max_length;let u,h,l,f,p,d,g=0;for(f=0;f<=15;f++)t.bl_count[f]=0;for(n[2*t.heap[t.heap_max]+1]=0,u=t.heap_max+1;u<573;u++)(f=n[2*n[2*(h=t.heap[u])+1]+1]+1)>c&&(f=c,g++),n[2*h+1]=f,h>i||(t.bl_count[f]++,p=0,h>=s&&(p=a[h-s]),d=n[2*h],t.opt_len+=d*(f+p),o&&(t.static_len+=d*(r[2*h+1]+p)));if(0!==g){do{for(f=c-1;0===t.bl_count[f];)f--;t.bl_count[f]--,t.bl_count[f+1]+=2,t.bl_count[c]--,g-=2}while(g>0);for(f=c;0!==f;f--)for(h=t.bl_count[f];0!==h;)(l=t.heap[--u])>i||(n[2*l+1]!==f&&(t.opt_len+=(f-n[2*l+1])*n[2*l],n[2*l+1]=f),h--)}})(t,e),Lt(n,u,t.bl_count)},Ht=(t,e,n)=>{let i,r,o=-1,a=e[1],s=0,c=7,u=4;for(0===a&&(c=138,u=3),e[2*(n+1)+1]=65535,i=0;i<=n;i++)r=a,a=e[2*(i+1)+1],++s<c&&r===a||(s<u?t.bl_tree[2*r]+=s:0!==r?(r!==o&&t.bl_tree[2*r]++,t.bl_tree[32]++):s<=10?t.bl_tree[34]++:t.bl_tree[36]++,s=0,o=r,0===a?(c=138,u=3):r===a?(c=6,u=3):(c=7,u=4))},Jt=(t,e,n)=>{let i,r,o=-1,a=e[1],s=0,c=7,u=4;for(0===a&&(c=138,u=3),i=0;i<=n;i++)if(r=a,a=e[2*(i+1)+1],!(++s<c&&r===a)){if(s<u)do{Ut(t,r,t.bl_tree)}while(0!=--s);else 0!==r?(r!==o&&(Ut(t,r,t.bl_tree),s--),Ut(t,16,t.bl_tree),Gt(t,s-3,2)):s<=10?(Ut(t,17,t.bl_tree),Gt(t,s-3,3)):(Ut(t,18,t.bl_tree),Gt(t,s-11,7));s=0,o=r,0===a?(c=138,u=3):r===a?(c=6,u=3):(c=7,u=4)}};let Zt=!1;const Wt=(t,e,n,i)=>{Gt(t,0+(i?1:0),3),Ft(t),Bt(t,n),Bt(t,~n),n&&t.pending_buf.set(t.window.subarray(e,e+n),t.pending),t.pending+=n};var Xt={_tr_init:t=>{Zt||((()=>{let t,e,n,i,r;const o=new Array(16);for(n=0,i=0;i<28;i++)for(zt[i]=n,t=0;t<1<<yt[i];t++)Dt[n++]=i;for(Dt[n-1]=i,r=0,i=0;i<16;i++)for(At[i]=r,t=0;t<1<<bt[i];t++)Tt[r++]=i;for(r>>=7;i<30;i++)for(At[i]=r<<7,t=0;t<1<<bt[i]-7;t++)Tt[256+r++]=i;for(e=0;e<=15;e++)o[e]=0;for(t=0;t<=143;)St[2*t+1]=8,t++,o[8]++;for(;t<=255;)St[2*t+1]=9,t++,o[9]++;for(;t<=279;)St[2*t+1]=7,t++,o[7]++;for(;t<=287;)St[2*t+1]=8,t++,o[8]++;for(Lt(St,287,o),t=0;t<30;t++)kt[2*t+1]=5,kt[2*t]=Nt(t,5);It=new xt(St,yt,257,286,15),Rt=new xt(kt,bt,0,30,15),Ot=new xt(new Array(0),wt,0,19,7)})(),Zt=!0),t.l_desc=new Ct(t.dyn_ltree,It),t.d_desc=new Ct(t.dyn_dtree,Rt),t.bl_desc=new Ct(t.bl_tree,Ot),t.bi_buf=0,t.bi_valid=0,Pt(t)},_tr_stored_block:Wt,_tr_flush_block:(t,e,n,i)=>{let r,o,a=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),Vt(t,t.l_desc),Vt(t,t.d_desc),a=(t=>{let e;for(Ht(t,t.dyn_ltree,t.l_desc.max_code),Ht(t,t.dyn_dtree,t.d_desc.max_code),Vt(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*Et[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e})(t),r=t.opt_len+3+7>>>3,(o=t.static_len+3+7>>>3)<=r&&(r=o)):r=o=n+5,n+4<=r&&-1!==e?Wt(t,e,n,i):4===t.strategy||o===r?(Gt(t,2+(i?1:0),3),Kt(t,St,kt)):(Gt(t,4+(i?1:0),3),((t,e,n,i)=>{let r;for(Gt(t,e-257,5),Gt(t,n-1,5),Gt(t,i-4,4),r=0;r<i;r++)Gt(t,t.bl_tree[2*Et[r]+1],3);Jt(t,t.dyn_ltree,e-1),Jt(t,t.dyn_dtree,n-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,a+1),Kt(t,t.dyn_ltree,t.dyn_dtree)),Pt(t),i&&Ft(t)},_tr_tally:(t,e,n)=>(t.pending_buf[t.sym_buf+t.sym_next++]=e,t.pending_buf[t.sym_buf+t.sym_next++]=e>>8,t.pending_buf[t.sym_buf+t.sym_next++]=n,0===e?t.dyn_ltree[2*n]++:(t.matches++,e--,t.dyn_ltree[2*(Dt[n]+256+1)]++,t.dyn_dtree[2*Mt(e)]++),t.sym_next===t.sym_end),_tr_align:t=>{Gt(t,2,3),Ut(t,256,St),(t=>{16===t.bi_valid?(Bt(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)}};var $t=(t,e,n,i)=>{let r=65535&t|0,o=t>>>16&65535|0,a=0;for(;0!==n;){n-=a=n>2e3?2e3:n;do{o=o+(r=r+e[i++]|0)|0}while(--a);r%=65521,o%=65521}return r|o<<16|0};const Yt=new Uint32Array((()=>{let t,e=[];for(var n=0;n<256;n++){t=n;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e})());var Qt=(t,e,n,i)=>{const r=Yt,o=i+n;t^=-1;for(let n=i;n<o;n++)t=t>>>8^r[255&(t^e[n])];return-1^t},te={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},ee={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:ne,_tr_stored_block:ie,_tr_flush_block:re,_tr_tally:oe,_tr_align:ae}=Xt,{Z_NO_FLUSH:se,Z_PARTIAL_FLUSH:ce,Z_FULL_FLUSH:ue,Z_FINISH:he,Z_BLOCK:le,Z_OK:fe,Z_STREAM_END:pe,Z_STREAM_ERROR:de,Z_DATA_ERROR:ge,Z_BUF_ERROR:me,Z_DEFAULT_COMPRESSION:ve,Z_FILTERED:_e,Z_HUFFMAN_ONLY:ye,Z_RLE:be,Z_FIXED:we,Z_DEFAULT_STRATEGY:Ee,Z_UNKNOWN:Se,Z_DEFLATED:ke}=ee,Te=286,De=30,ze=19,Ae=2*Te+1,xe=15,Ie=(t,e)=>(t.msg=te[e],e),Re=t=>2*t-(t>4?9:0),Oe=t=>{let e=t.length;for(;--e>=0;)t[e]=0},Ce=t=>{let e,n,i,r=t.w_size;i=e=t.hash_size;do{n=t.head[--i],t.head[i]=n>=r?n-r:0}while(--e);i=e=r;do{n=t.prev[--i],t.prev[i]=n>=r?n-r:0}while(--e)};let Me=(t,e,n)=>(e<<t.hash_shift^n)&t.hash_mask;const Be=t=>{const e=t.state;let n=e.pending;n>t.avail_out&&(n=t.avail_out),0!==n&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+n),t.next_out),t.next_out+=n,e.pending_out+=n,t.total_out+=n,t.avail_out-=n,e.pending-=n,0===e.pending&&(e.pending_out=0))},Ge=(t,e)=>{re(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,Be(t.strm)},Ue=(t,e)=>{t.pending_buf[t.pending++]=e},Ne=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},Le=(t,e,n,i)=>{let r=t.avail_in;return r>i&&(r=i),0===r?0:(t.avail_in-=r,e.set(t.input.subarray(t.next_in,t.next_in+r),n),1===t.state.wrap?t.adler=$t(t.adler,e,r,n):2===t.state.wrap&&(t.adler=Qt(t.adler,e,r,n)),t.next_in+=r,t.total_in+=r,r)},Pe=(t,e)=>{let n,i,r=t.max_chain_length,o=t.strstart,a=t.prev_length,s=t.nice_match;const c=t.strstart>t.w_size-262?t.strstart-(t.w_size-262):0,u=t.window,h=t.w_mask,l=t.prev,f=t.strstart+258;let p=u[o+a-1],d=u[o+a];t.prev_length>=t.good_match&&(r>>=2),s>t.lookahead&&(s=t.lookahead);do{if(u[(n=e)+a]===d&&u[n+a-1]===p&&u[n]===u[o]&&u[++n]===u[o+1]){o+=2,n++;do{}while(u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&o<f);if(i=258-(f-o),o=f-258,i>a){if(t.match_start=e,a=i,i>=s)break;p=u[o+a-1],d=u[o+a]}}}while((e=l[e&h])>c&&0!=--r);return a<=t.lookahead?a:t.lookahead},Fe=t=>{const e=t.w_size;let n,i,r;do{if(i=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-262)&&(t.window.set(t.window.subarray(e,e+e-i),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,t.insert>t.strstart&&(t.insert=t.strstart),Ce(t),i+=e),0===t.strm.avail_in)break;if(n=Le(t.strm,t.window,t.strstart+t.lookahead,i),t.lookahead+=n,t.lookahead+t.insert>=3)for(r=t.strstart-t.insert,t.ins_h=t.window[r],t.ins_h=Me(t,t.ins_h,t.window[r+1]);t.insert&&(t.ins_h=Me(t,t.ins_h,t.window[r+3-1]),t.prev[r&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=r,r++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<262&&0!==t.strm.avail_in)},qe=(t,e)=>{let n,i,r,o=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,a=0,s=t.strm.avail_in;do{if(n=65535,r=t.bi_valid+42>>3,t.strm.avail_out<r)break;if(r=t.strm.avail_out-r,n>(i=t.strstart-t.block_start)+t.strm.avail_in&&(n=i+t.strm.avail_in),n>r&&(n=r),n<o&&(0===n&&e!==he||e===se||n!==i+t.strm.avail_in))break;a=e===he&&n===i+t.strm.avail_in?1:0,ie(t,0,0,a),t.pending_buf[t.pending-4]=n,t.pending_buf[t.pending-3]=n>>8,t.pending_buf[t.pending-2]=~n,t.pending_buf[t.pending-1]=~n>>8,Be(t.strm),i&&(i>n&&(i=n),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+i),t.strm.next_out),t.strm.next_out+=i,t.strm.avail_out-=i,t.strm.total_out+=i,t.block_start+=i,n-=i),n&&(Le(t.strm,t.strm.output,t.strm.next_out,n),t.strm.next_out+=n,t.strm.avail_out-=n,t.strm.total_out+=n)}while(0===a);return(s-=t.strm.avail_in)&&(s>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=s&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-s,t.strm.next_in),t.strstart),t.strstart+=s,t.insert+=s>t.w_size-t.insert?t.w_size-t.insert:s),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),a?4:e!==se&&e!==he&&0===t.strm.avail_in&&t.strstart===t.block_start?2:(r=t.window_size-t.strstart,t.strm.avail_in>r&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,r+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),r>t.strm.avail_in&&(r=t.strm.avail_in),r&&(Le(t.strm,t.window,t.strstart,r),t.strstart+=r,t.insert+=r>t.w_size-t.insert?t.w_size-t.insert:r),t.high_water<t.strstart&&(t.high_water=t.strstart),r=t.bi_valid+42>>3,o=(r=t.pending_buf_size-r>65535?65535:t.pending_buf_size-r)>t.w_size?t.w_size:r,((i=t.strstart-t.block_start)>=o||(i||e===he)&&e!==se&&0===t.strm.avail_in&&i<=r)&&(n=i>r?r:i,a=e===he&&0===t.strm.avail_in&&n===i?1:0,ie(t,t.block_start,n,a),t.block_start+=n,Be(t.strm)),a?3:1)},je=(t,e)=>{let n,i;for(;;){if(t.lookahead<262){if(Fe(t),t.lookahead<262&&e===se)return 1;if(0===t.lookahead)break}if(n=0,t.lookahead>=3&&(t.ins_h=Me(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==n&&t.strstart-n<=t.w_size-262&&(t.match_length=Pe(t,n)),t.match_length>=3)if(i=oe(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=Me(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=Me(t,t.ins_h,t.window[t.strstart+1]);else i=oe(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(Ge(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,e===he?(Ge(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Ge(t,!1),0===t.strm.avail_out)?1:2},Ke=(t,e)=>{let n,i,r;for(;;){if(t.lookahead<262){if(Fe(t),t.lookahead<262&&e===se)return 1;if(0===t.lookahead)break}if(n=0,t.lookahead>=3&&(t.ins_h=Me(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==n&&t.prev_length<t.max_lazy_match&&t.strstart-n<=t.w_size-262&&(t.match_length=Pe(t,n),t.match_length<=5&&(t.strategy===_e||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-3,i=oe(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=Me(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,i&&(Ge(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if((i=oe(t,0,t.window[t.strstart-1]))&&Ge(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=oe(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===he?(Ge(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Ge(t,!1),0===t.strm.avail_out)?1:2};function Ve(t,e,n,i,r){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=i,this.func=r}const He=[new Ve(0,0,0,0,qe),new Ve(4,4,8,4,je),new Ve(4,5,16,8,je),new Ve(4,6,32,32,je),new Ve(4,4,16,16,Ke),new Ve(8,16,32,32,Ke),new Ve(8,16,128,128,Ke),new Ve(8,32,128,256,Ke),new Ve(32,128,258,1024,Ke),new Ve(32,258,258,4096,Ke)];function Je(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ke,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*Ae),this.dyn_dtree=new Uint16Array(2*(2*De+1)),this.bl_tree=new Uint16Array(2*(2*ze+1)),Oe(this.dyn_ltree),Oe(this.dyn_dtree),Oe(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(xe+1),this.heap=new Uint16Array(2*Te+1),Oe(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Te+1),Oe(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Ze=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||42!==e.status&&57!==e.status&&69!==e.status&&73!==e.status&&91!==e.status&&103!==e.status&&113!==e.status&&666!==e.status?1:0},We=t=>{if(Ze(t))return Ie(t,de);t.total_in=t.total_out=0,t.data_type=Se;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=2===e.wrap?57:e.wrap?42:113,t.adler=2===e.wrap?0:1,e.last_flush=-2,ne(e),fe},Xe=t=>{const e=We(t);return e===fe&&(t=>{t.window_size=2*t.w_size,Oe(t.head),t.max_lazy_match=He[t.level].max_lazy,t.good_match=He[t.level].good_length,t.nice_match=He[t.level].nice_length,t.max_chain_length=He[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0})(t.state),e},$e=(t,e,n,i,r,o)=>{if(!t)return de;let a=1;if(e===ve&&(e=6),i<0?(a=0,i=-i):i>15&&(a=2,i-=16),r<1||r>9||n!==ke||i<8||i>15||e<0||e>9||o<0||o>we||8===i&&1!==a)return Ie(t,de);8===i&&(i=9);const s=new Je;return t.state=s,s.strm=t,s.status=42,s.wrap=a,s.gzhead=null,s.w_bits=i,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=r+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+3-1)/3),s.window=new Uint8Array(2*s.w_size),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<r+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Uint8Array(s.pending_buf_size),s.sym_buf=s.lit_bufsize,s.sym_end=3*(s.lit_bufsize-1),s.level=e,s.strategy=o,s.method=n,Xe(t)};var Ye={deflateInit:(t,e)=>$e(t,e,ke,15,8,Ee),deflateInit2:$e,deflateReset:Xe,deflateResetKeep:We,deflateSetHeader:(t,e)=>Ze(t)||2!==t.state.wrap?de:(t.state.gzhead=e,fe),deflate:(t,e)=>{if(Ze(t)||e>le||e<0)return t?Ie(t,de):de;const n=t.state;if(!t.output||0!==t.avail_in&&!t.input||666===n.status&&e!==he)return Ie(t,0===t.avail_out?me:de);const i=n.last_flush;if(n.last_flush=e,0!==n.pending){if(Be(t),0===t.avail_out)return n.last_flush=-1,fe}else if(0===t.avail_in&&Re(e)<=Re(i)&&e!==he)return Ie(t,me);if(666===n.status&&0!==t.avail_in)return Ie(t,me);if(42===n.status&&0===n.wrap&&(n.status=113),42===n.status){let e=ke+(n.w_bits-8<<4)<<8,i=-1;if(e|=(i=n.strategy>=ye||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(e|=32),Ne(n,e+=31-e%31),0!==n.strstart&&(Ne(n,t.adler>>>16),Ne(n,65535&t.adler)),t.adler=1,n.status=113,Be(t),0!==n.pending)return n.last_flush=-1,fe}if(57===n.status)if(t.adler=0,Ue(n,31),Ue(n,139),Ue(n,8),n.gzhead)Ue(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),Ue(n,255&n.gzhead.time),Ue(n,n.gzhead.time>>8&255),Ue(n,n.gzhead.time>>16&255),Ue(n,n.gzhead.time>>24&255),Ue(n,9===n.level?2:n.strategy>=ye||n.level<2?4:0),Ue(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(Ue(n,255&n.gzhead.extra.length),Ue(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(t.adler=Qt(t.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if(Ue(n,0),Ue(n,0),Ue(n,0),Ue(n,0),Ue(n,0),Ue(n,9===n.level?2:n.strategy>=ye||n.level<2?4:0),Ue(n,3),n.status=113,Be(t),0!==n.pending)return n.last_flush=-1,fe;if(69===n.status){if(n.gzhead.extra){let e=n.pending,i=(65535&n.gzhead.extra.length)-n.gzindex;for(;n.pending+i>n.pending_buf_size;){let r=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+r),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>e&&(t.adler=Qt(t.adler,n.pending_buf,n.pending-e,e)),n.gzindex+=r,Be(t),0!==n.pending)return n.last_flush=-1,fe;e=0,i-=r}let r=new Uint8Array(n.gzhead.extra);n.pending_buf.set(r.subarray(n.gzindex,n.gzindex+i),n.pending),n.pending+=i,n.gzhead.hcrc&&n.pending>e&&(t.adler=Qt(t.adler,n.pending_buf,n.pending-e,e)),n.gzindex=0}n.status=73}if(73===n.status){if(n.gzhead.name){let e,i=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>i&&(t.adler=Qt(t.adler,n.pending_buf,n.pending-i,i)),Be(t),0!==n.pending)return n.last_flush=-1,fe;i=0}e=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,Ue(n,e)}while(0!==e);n.gzhead.hcrc&&n.pending>i&&(t.adler=Qt(t.adler,n.pending_buf,n.pending-i,i)),n.gzindex=0}n.status=91}if(91===n.status){if(n.gzhead.comment){let e,i=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>i&&(t.adler=Qt(t.adler,n.pending_buf,n.pending-i,i)),Be(t),0!==n.pending)return n.last_flush=-1,fe;i=0}e=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,Ue(n,e)}while(0!==e);n.gzhead.hcrc&&n.pending>i&&(t.adler=Qt(t.adler,n.pending_buf,n.pending-i,i))}n.status=103}if(103===n.status){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(Be(t),0!==n.pending))return n.last_flush=-1,fe;Ue(n,255&t.adler),Ue(n,t.adler>>8&255),t.adler=0}if(n.status=113,Be(t),0!==n.pending)return n.last_flush=-1,fe}if(0!==t.avail_in||0!==n.lookahead||e!==se&&666!==n.status){let i=0===n.level?qe(n,e):n.strategy===ye?((t,e)=>{let n;for(;;){if(0===t.lookahead&&(Fe(t),0===t.lookahead)){if(e===se)return 1;break}if(t.match_length=0,n=oe(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,n&&(Ge(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===he?(Ge(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Ge(t,!1),0===t.strm.avail_out)?1:2})(n,e):n.strategy===be?((t,e)=>{let n,i,r,o;const a=t.window;for(;;){if(t.lookahead<=258){if(Fe(t),t.lookahead<=258&&e===se)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(i=a[r=t.strstart-1])===a[++r]&&i===a[++r]&&i===a[++r]){o=t.strstart+258;do{}while(i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&r<o);t.match_length=258-(o-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(n=oe(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(n=oe(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),n&&(Ge(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===he?(Ge(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Ge(t,!1),0===t.strm.avail_out)?1:2})(n,e):He[n.level].func(n,e);if(3!==i&&4!==i||(n.status=666),1===i||3===i)return 0===t.avail_out&&(n.last_flush=-1),fe;if(2===i&&(e===ce?ae(n):e!==le&&(ie(n,0,0,!1),e===ue&&(Oe(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),Be(t),0===t.avail_out))return n.last_flush=-1,fe}return e!==he?fe:n.wrap<=0?pe:(2===n.wrap?(Ue(n,255&t.adler),Ue(n,t.adler>>8&255),Ue(n,t.adler>>16&255),Ue(n,t.adler>>24&255),Ue(n,255&t.total_in),Ue(n,t.total_in>>8&255),Ue(n,t.total_in>>16&255),Ue(n,t.total_in>>24&255)):(Ne(n,t.adler>>>16),Ne(n,65535&t.adler)),Be(t),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?fe:pe)},deflateEnd:t=>{if(Ze(t))return de;const e=t.state.status;return t.state=null,113===e?Ie(t,ge):fe},deflateSetDictionary:(t,e)=>{let n=e.length;if(Ze(t))return de;const i=t.state,r=i.wrap;if(2===r||1===r&&42!==i.status||i.lookahead)return de;if(1===r&&(t.adler=$t(t.adler,e,n,0)),i.wrap=0,n>=i.w_size){0===r&&(Oe(i.head),i.strstart=0,i.block_start=0,i.insert=0);let t=new Uint8Array(i.w_size);t.set(e.subarray(n-i.w_size,n),0),e=t,n=i.w_size}const o=t.avail_in,a=t.next_in,s=t.input;for(t.avail_in=n,t.next_in=0,t.input=e,Fe(i);i.lookahead>=3;){let t=i.strstart,e=i.lookahead-2;do{i.ins_h=Me(i,i.ins_h,i.window[t+3-1]),i.prev[t&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=t,t++}while(--e);i.strstart=t,i.lookahead=2,Fe(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,t.next_in=a,t.input=s,t.avail_in=o,i.wrap=r,fe},deflateInfo:"pako deflate (from Nodeca project)"};const Qe=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var tn={assign:function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const n=e.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const e in n)Qe(n,e)&&(t[e]=n[e])}}return t},flattenChunks:t=>{let e=0;for(let n=0,i=t.length;n<i;n++)e+=t[n].length;const n=new Uint8Array(e);for(let e=0,i=0,r=t.length;e<r;e++){let r=t[e];n.set(r,i),i+=r.length}return n}};let en=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){en=!1}const nn=new Uint8Array(256);for(let t=0;t<256;t++)nn[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;nn[254]=nn[254]=1;var rn={string2buf:t=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let e,n,i,r,o,a=t.length,s=0;for(r=0;r<a;r++)55296==(64512&(n=t.charCodeAt(r)))&&r+1<a&&56320==(64512&(i=t.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(i-56320),r++),s+=n<128?1:n<2048?2:n<65536?3:4;for(e=new Uint8Array(s),o=0,r=0;o<s;r++)55296==(64512&(n=t.charCodeAt(r)))&&r+1<a&&56320==(64512&(i=t.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(i-56320),r++),n<128?e[o++]=n:n<2048?(e[o++]=192|n>>>6,e[o++]=128|63&n):n<65536?(e[o++]=224|n>>>12,e[o++]=128|n>>>6&63,e[o++]=128|63&n):(e[o++]=240|n>>>18,e[o++]=128|n>>>12&63,e[o++]=128|n>>>6&63,e[o++]=128|63&n);return e},buf2string:(t,e)=>{const n=e||t.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,e));let i,r;const o=new Array(2*n);for(r=0,i=0;i<n;){let e=t[i++];if(e<128){o[r++]=e;continue}let a=nn[e];if(a>4)o[r++]=65533,i+=a-1;else{for(e&=2===a?31:3===a?15:7;a>1&&i<n;)e=e<<6|63&t[i++],a--;a>1?o[r++]=65533:e<65536?o[r++]=e:(e-=65536,o[r++]=55296|e>>10&1023,o[r++]=56320|1023&e)}}return((t,e)=>{if(e<65534&&t.subarray&&en)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let n="";for(let i=0;i<e;i++)n+=String.fromCharCode(t[i]);return n})(o,r)},utf8border:(t,e)=>{(e=e||t.length)>t.length&&(e=t.length);let n=e-1;for(;n>=0&&128==(192&t[n]);)n--;return n<0?e:0===n?e:n+nn[t[n]]>e?n:e}};var on=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const an=Object.prototype.toString,{Z_NO_FLUSH:sn,Z_SYNC_FLUSH:cn,Z_FULL_FLUSH:un,Z_FINISH:hn,Z_OK:ln,Z_STREAM_END:fn,Z_DEFAULT_COMPRESSION:pn,Z_DEFAULT_STRATEGY:dn,Z_DEFLATED:gn}=ee;function mn(t){this.options=tn.assign({level:pn,method:gn,chunkSize:16384,windowBits:15,memLevel:8,strategy:dn},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new on,this.strm.avail_out=0;let n=Ye.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(n!==ln)throw new Error(te[n]);if(e.header&&Ye.deflateSetHeader(this.strm,e.header),e.dictionary){let t;if(t="string"==typeof e.dictionary?rn.string2buf(e.dictionary):"[object ArrayBuffer]"===an.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,(n=Ye.deflateSetDictionary(this.strm,t))!==ln)throw new Error(te[n]);this._dict_set=!0}}function vn(t,e){const n=new mn(e);if(n.push(t,!0),n.err)throw n.msg||te[n.err];return n.result}mn.prototype.push=function(t,e){const n=this.strm,i=this.options.chunkSize;let r,o;if(this.ended)return!1;for(o=e===~~e?e:!0===e?hn:sn,"string"==typeof t?n.input=rn.string2buf(t):"[object ArrayBuffer]"===an.call(t)?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),(o===cn||o===un)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if((r=Ye.deflate(n,o))===fn)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),r=Ye.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===ln;if(0!==n.avail_out){if(o>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},mn.prototype.onData=function(t){this.chunks.push(t)},mn.prototype.onEnd=function(t){t===ln&&(this.result=tn.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var _n={Deflate:mn,deflate:vn,deflateRaw:function(t,e){return(e=e||{}).raw=!0,vn(t,e)},gzip:function(t,e){return(e=e||{}).gzip=!0,vn(t,e)},constants:ee};var yn=function(t,e){let n,i,r,o,a,s,c,u,h,l,f,p,d,g,m,v,_,y,b,w,E,S,k,T;const D=t.state;n=t.next_in,k=t.input,i=n+(t.avail_in-5),r=t.next_out,T=t.output,o=r-(e-t.avail_out),a=r+(t.avail_out-257),s=D.dmax,c=D.wsize,u=D.whave,h=D.wnext,l=D.window,f=D.hold,p=D.bits,d=D.lencode,g=D.distcode,m=(1<<D.lenbits)-1,v=(1<<D.distbits)-1;t:do{p<15&&(f+=k[n++]<<p,p+=8,f+=k[n++]<<p,p+=8),_=d[f&m];e:for(;;){if(f>>>=y=_>>>24,p-=y,0===(y=_>>>16&255))T[r++]=65535&_;else{if(!(16&y)){if(0==(64&y)){_=d[(65535&_)+(f&(1<<y)-1)];continue e}if(32&y){D.mode=16191;break t}t.msg="invalid literal/length code",D.mode=16209;break t}b=65535&_,(y&=15)&&(p<y&&(f+=k[n++]<<p,p+=8),b+=f&(1<<y)-1,f>>>=y,p-=y),p<15&&(f+=k[n++]<<p,p+=8,f+=k[n++]<<p,p+=8),_=g[f&v];n:for(;;){if(f>>>=y=_>>>24,p-=y,!(16&(y=_>>>16&255))){if(0==(64&y)){_=g[(65535&_)+(f&(1<<y)-1)];continue n}t.msg="invalid distance code",D.mode=16209;break t}if(w=65535&_,p<(y&=15)&&(f+=k[n++]<<p,(p+=8)<y&&(f+=k[n++]<<p,p+=8)),(w+=f&(1<<y)-1)>s){t.msg="invalid distance too far back",D.mode=16209;break t}if(f>>>=y,p-=y,w>(y=r-o)){if((y=w-y)>u&&D.sane){t.msg="invalid distance too far back",D.mode=16209;break t}if(E=0,S=l,0===h){if(E+=c-y,y<b){b-=y;do{T[r++]=l[E++]}while(--y);E=r-w,S=T}}else if(h<y){if(E+=c+h-y,(y-=h)<b){b-=y;do{T[r++]=l[E++]}while(--y);if(E=0,h<b){b-=y=h;do{T[r++]=l[E++]}while(--y);E=r-w,S=T}}}else if(E+=h-y,y<b){b-=y;do{T[r++]=l[E++]}while(--y);E=r-w,S=T}for(;b>2;)T[r++]=S[E++],T[r++]=S[E++],T[r++]=S[E++],b-=3;b&&(T[r++]=S[E++],b>1&&(T[r++]=S[E++]))}else{E=r-w;do{T[r++]=T[E++],T[r++]=T[E++],T[r++]=T[E++],b-=3}while(b>2);b&&(T[r++]=T[E++],b>1&&(T[r++]=T[E++]))}break}}break}}while(n<i&&r<a);n-=b=p>>3,f&=(1<<(p-=b<<3))-1,t.next_in=n,t.next_out=r,t.avail_in=n<i?i-n+5:5-(n-i),t.avail_out=r<a?a-r+257:257-(r-a),D.hold=f,D.bits=p};const bn=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),wn=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),En=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Sn=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var kn=(t,e,n,i,r,o,a,s)=>{const c=s.bits;let u,h,l,f,p,d,g=0,m=0,v=0,_=0,y=0,b=0,w=0,E=0,S=0,k=0,T=null;const D=new Uint16Array(16),z=new Uint16Array(16);let A,x,I,R=null;for(g=0;g<=15;g++)D[g]=0;for(m=0;m<i;m++)D[e[n+m]]++;for(y=c,_=15;_>=1&&0===D[_];_--);if(y>_&&(y=_),0===_)return r[o++]=20971520,r[o++]=20971520,s.bits=1,0;for(v=1;v<_&&0===D[v];v++);for(y<v&&(y=v),E=1,g=1;g<=15;g++)if(E<<=1,(E-=D[g])<0)return-1;if(E>0&&(0===t||1!==_))return-1;for(z[1]=0,g=1;g<15;g++)z[g+1]=z[g]+D[g];for(m=0;m<i;m++)0!==e[n+m]&&(a[z[e[n+m]]++]=m);if(0===t?(T=R=a,d=20):1===t?(T=bn,R=wn,d=257):(T=En,R=Sn,d=0),k=0,m=0,g=v,p=o,b=y,w=0,l=-1,f=(S=1<<y)-1,1===t&&S>852||2===t&&S>592)return 1;for(;;){A=g-w,a[m]+1<d?(x=0,I=a[m]):a[m]>=d?(x=R[a[m]-d],I=T[a[m]-d]):(x=96,I=0),u=1<<g-w,v=h=1<<b;do{r[p+(k>>w)+(h-=u)]=A<<24|x<<16|I|0}while(0!==h);for(u=1<<g-1;k&u;)u>>=1;if(0!==u?(k&=u-1,k+=u):k=0,m++,0==--D[g]){if(g===_)break;g=e[n+a[m]]}if(g>y&&(k&f)!==l){for(0===w&&(w=y),p+=v,E=1<<(b=g-w);b+w<_&&!((E-=D[b+w])<=0);)b++,E<<=1;if(S+=1<<b,1===t&&S>852||2===t&&S>592)return 1;r[l=k&f]=y<<24|b<<16|p-o|0}}return 0!==k&&(r[p+k]=g-w<<24|64<<16|0),s.bits=y,0};const{Z_FINISH:Tn,Z_BLOCK:Dn,Z_TREES:zn,Z_OK:An,Z_STREAM_END:xn,Z_NEED_DICT:In,Z_STREAM_ERROR:Rn,Z_DATA_ERROR:On,Z_MEM_ERROR:Cn,Z_BUF_ERROR:Mn,Z_DEFLATED:Bn}=ee,Gn=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function Un(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Nn=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<16180||e.mode>16211?1:0},Ln=t=>{if(Nn(t))return Rn;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=16180,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,An},Pn=t=>{if(Nn(t))return Rn;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Ln(t)},Fn=(t,e)=>{let n;if(Nn(t))return Rn;const i=t.state;return e<0?(n=0,e=-e):(n=5+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?Rn:(null!==i.window&&i.wbits!==e&&(i.window=null),i.wrap=n,i.wbits=e,Pn(t))},qn=(t,e)=>{if(!t)return Rn;const n=new Un;t.state=n,n.strm=t,n.window=null,n.mode=16180;const i=Fn(t,e);return i!==An&&(t.state=null),i};let jn,Kn,Vn=!0;const Hn=t=>{if(Vn){jn=new Int32Array(512),Kn=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(kn(1,t.lens,0,288,jn,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;kn(2,t.lens,0,32,Kn,0,t.work,{bits:5}),Vn=!1}t.lencode=jn,t.lenbits=9,t.distcode=Kn,t.distbits=5},Jn=(t,e,n,i)=>{let r;const o=t.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),i>=o.wsize?(o.window.set(e.subarray(n-o.wsize,n),0),o.wnext=0,o.whave=o.wsize):((r=o.wsize-o.wnext)>i&&(r=i),o.window.set(e.subarray(n-i,n-i+r),o.wnext),(i-=r)?(o.window.set(e.subarray(n-i,n),0),o.wnext=i,o.whave=o.wsize):(o.wnext+=r,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=r))),0};var Zn={inflateReset:Pn,inflateReset2:Fn,inflateResetKeep:Ln,inflateInit:t=>qn(t,15),inflateInit2:qn,inflate:(t,e)=>{let n,i,r,o,a,s,c,u,h,l,f,p,d,g,m,v,_,y,b,w,E,S,k=0;const T=new Uint8Array(4);let D,z;const A=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Nn(t)||!t.output||!t.input&&0!==t.avail_in)return Rn;16191===(n=t.state).mode&&(n.mode=16192),a=t.next_out,r=t.output,c=t.avail_out,o=t.next_in,i=t.input,s=t.avail_in,u=n.hold,h=n.bits,l=s,f=c,S=An;t:for(;;)switch(n.mode){case 16180:if(0===n.wrap){n.mode=16192;break}for(;h<16;){if(0===s)break t;s--,u+=i[o++]<<h,h+=8}if(2&n.wrap&&35615===u){0===n.wbits&&(n.wbits=15),n.check=0,T[0]=255&u,T[1]=u>>>8&255,n.check=Qt(n.check,T,2,0),u=0,h=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&u)<<8)+(u>>8))%31){t.msg="incorrect header check",n.mode=16209;break}if((15&u)!==Bn){t.msg="unknown compression method",n.mode=16209;break}if(h-=4,E=8+(15&(u>>>=4)),0===n.wbits&&(n.wbits=E),E>15||E>n.wbits){t.msg="invalid window size",n.mode=16209;break}n.dmax=1<<n.wbits,n.flags=0,t.adler=n.check=1,n.mode=512&u?16189:16191,u=0,h=0;break;case 16181:for(;h<16;){if(0===s)break t;s--,u+=i[o++]<<h,h+=8}if(n.flags=u,(255&n.flags)!==Bn){t.msg="unknown compression method",n.mode=16209;break}if(57344&n.flags){t.msg="unknown header flags set",n.mode=16209;break}n.head&&(n.head.text=u>>8&1),512&n.flags&&4&n.wrap&&(T[0]=255&u,T[1]=u>>>8&255,n.check=Qt(n.check,T,2,0)),u=0,h=0,n.mode=16182;case 16182:for(;h<32;){if(0===s)break t;s--,u+=i[o++]<<h,h+=8}n.head&&(n.head.time=u),512&n.flags&&4&n.wrap&&(T[0]=255&u,T[1]=u>>>8&255,T[2]=u>>>16&255,T[3]=u>>>24&255,n.check=Qt(n.check,T,4,0)),u=0,h=0,n.mode=16183;case 16183:for(;h<16;){if(0===s)break t;s--,u+=i[o++]<<h,h+=8}n.head&&(n.head.xflags=255&u,n.head.os=u>>8),512&n.flags&&4&n.wrap&&(T[0]=255&u,T[1]=u>>>8&255,n.check=Qt(n.check,T,2,0)),u=0,h=0,n.mode=16184;case 16184:if(1024&n.flags){for(;h<16;){if(0===s)break t;s--,u+=i[o++]<<h,h+=8}n.length=u,n.head&&(n.head.extra_len=u),512&n.flags&&4&n.wrap&&(T[0]=255&u,T[1]=u>>>8&255,n.check=Qt(n.check,T,2,0)),u=0,h=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&n.flags&&((p=n.length)>s&&(p=s),p&&(n.head&&(E=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(i.subarray(o,o+p),E)),512&n.flags&&4&n.wrap&&(n.check=Qt(n.check,i,p,o)),s-=p,o+=p,n.length-=p),n.length))break t;n.length=0,n.mode=16186;case 16186:if(2048&n.flags){if(0===s)break t;p=0;do{E=i[o+p++],n.head&&E&&n.length<65536&&(n.head.name+=String.fromCharCode(E))}while(E&&p<s);if(512&n.flags&&4&n.wrap&&(n.check=Qt(n.check,i,p,o)),s-=p,o+=p,E)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&n.flags){if(0===s)break t;p=0;do{E=i[o+p++],n.head&&E&&n.length<65536&&(n.head.comment+=String.fromCharCode(E))}while(E&&p<s);if(512&n.flags&&4&n.wrap&&(n.check=Qt(n.check,i,p,o)),s-=p,o+=p,E)break t}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&n.flags){for(;h<16;){if(0===s)break t;s--,u+=i[o++]<<h,h+=8}if(4&n.wrap&&u!==(65535&n.check)){t.msg="header crc mismatch",n.mode=16209;break}u=0,h=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=16191;break;case 16189:for(;h<32;){if(0===s)break t;s--,u+=i[o++]<<h,h+=8}t.adler=n.check=Gn(u),u=0,h=0,n.mode=16190;case 16190:if(0===n.havedict)return t.next_out=a,t.avail_out=c,t.next_in=o,t.avail_in=s,n.hold=u,n.bits=h,In;t.adler=n.check=1,n.mode=16191;case 16191:if(e===Dn||e===zn)break t;case 16192:if(n.last){u>>>=7&h,h-=7&h,n.mode=16206;break}for(;h<3;){if(0===s)break t;s--,u+=i[o++]<<h,h+=8}switch(n.last=1&u,h-=1,3&(u>>>=1)){case 0:n.mode=16193;break;case 1:if(Hn(n),n.mode=16199,e===zn){u>>>=2,h-=2;break t}break;case 2:n.mode=16196;break;case 3:t.msg="invalid block type",n.mode=16209}u>>>=2,h-=2;break;case 16193:for(u>>>=7&h,h-=7&h;h<32;){if(0===s)break t;s--,u+=i[o++]<<h,h+=8}if((65535&u)!=(u>>>16^65535)){t.msg="invalid stored block lengths",n.mode=16209;break}if(n.length=65535&u,u=0,h=0,n.mode=16194,e===zn)break t;case 16194:n.mode=16195;case 16195:if(p=n.length){if(p>s&&(p=s),p>c&&(p=c),0===p)break t;r.set(i.subarray(o,o+p),a),s-=p,o+=p,c-=p,a+=p,n.length-=p;break}n.mode=16191;break;case 16196:for(;h<14;){if(0===s)break t;s--,u+=i[o++]<<h,h+=8}if(n.nlen=257+(31&u),u>>>=5,h-=5,n.ndist=1+(31&u),u>>>=5,h-=5,n.ncode=4+(15&u),u>>>=4,h-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=16209;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;h<3;){if(0===s)break t;s--,u+=i[o++]<<h,h+=8}n.lens[A[n.have++]]=7&u,u>>>=3,h-=3}for(;n.have<19;)n.lens[A[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,D={bits:n.lenbits},S=kn(0,n.lens,0,19,n.lencode,0,n.work,D),n.lenbits=D.bits,S){t.msg="invalid code lengths set",n.mode=16209;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;v=(k=n.lencode[u&(1<<n.lenbits)-1])>>>16&255,_=65535&k,!((m=k>>>24)<=h);){if(0===s)break t;s--,u+=i[o++]<<h,h+=8}if(_<16)u>>>=m,h-=m,n.lens[n.have++]=_;else{if(16===_){for(z=m+2;h<z;){if(0===s)break t;s--,u+=i[o++]<<h,h+=8}if(u>>>=m,h-=m,0===n.have){t.msg="invalid bit length repeat",n.mode=16209;break}E=n.lens[n.have-1],p=3+(3&u),u>>>=2,h-=2}else if(17===_){for(z=m+3;h<z;){if(0===s)break t;s--,u+=i[o++]<<h,h+=8}h-=m,E=0,p=3+(7&(u>>>=m)),u>>>=3,h-=3}else{for(z=m+7;h<z;){if(0===s)break t;s--,u+=i[o++]<<h,h+=8}h-=m,E=0,p=11+(127&(u>>>=m)),u>>>=7,h-=7}if(n.have+p>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=16209;break}for(;p--;)n.lens[n.have++]=E}}if(16209===n.mode)break;if(0===n.lens[256]){t.msg="invalid code -- missing end-of-block",n.mode=16209;break}if(n.lenbits=9,D={bits:n.lenbits},S=kn(1,n.lens,0,n.nlen,n.lencode,0,n.work,D),n.lenbits=D.bits,S){t.msg="invalid literal/lengths set",n.mode=16209;break}if(n.distbits=6,n.distcode=n.distdyn,D={bits:n.distbits},S=kn(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,D),n.distbits=D.bits,S){t.msg="invalid distances set",n.mode=16209;break}if(n.mode=16199,e===zn)break t;case 16199:n.mode=16200;case 16200:if(s>=6&&c>=258){t.next_out=a,t.avail_out=c,t.next_in=o,t.avail_in=s,n.hold=u,n.bits=h,yn(t,f),a=t.next_out,r=t.output,c=t.avail_out,o=t.next_in,i=t.input,s=t.avail_in,u=n.hold,h=n.bits,16191===n.mode&&(n.back=-1);break}for(n.back=0;v=(k=n.lencode[u&(1<<n.lenbits)-1])>>>16&255,_=65535&k,!((m=k>>>24)<=h);){if(0===s)break t;s--,u+=i[o++]<<h,h+=8}if(v&&0==(240&v)){for(y=m,b=v,w=_;v=(k=n.lencode[w+((u&(1<<y+b)-1)>>y)])>>>16&255,_=65535&k,!(y+(m=k>>>24)<=h);){if(0===s)break t;s--,u+=i[o++]<<h,h+=8}u>>>=y,h-=y,n.back+=y}if(u>>>=m,h-=m,n.back+=m,n.length=_,0===v){n.mode=16205;break}if(32&v){n.back=-1,n.mode=16191;break}if(64&v){t.msg="invalid literal/length code",n.mode=16209;break}n.extra=15&v,n.mode=16201;case 16201:if(n.extra){for(z=n.extra;h<z;){if(0===s)break t;s--,u+=i[o++]<<h,h+=8}n.length+=u&(1<<n.extra)-1,u>>>=n.extra,h-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;v=(k=n.distcode[u&(1<<n.distbits)-1])>>>16&255,_=65535&k,!((m=k>>>24)<=h);){if(0===s)break t;s--,u+=i[o++]<<h,h+=8}if(0==(240&v)){for(y=m,b=v,w=_;v=(k=n.distcode[w+((u&(1<<y+b)-1)>>y)])>>>16&255,_=65535&k,!(y+(m=k>>>24)<=h);){if(0===s)break t;s--,u+=i[o++]<<h,h+=8}u>>>=y,h-=y,n.back+=y}if(u>>>=m,h-=m,n.back+=m,64&v){t.msg="invalid distance code",n.mode=16209;break}n.offset=_,n.extra=15&v,n.mode=16203;case 16203:if(n.extra){for(z=n.extra;h<z;){if(0===s)break t;s--,u+=i[o++]<<h,h+=8}n.offset+=u&(1<<n.extra)-1,u>>>=n.extra,h-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=16209;break}n.mode=16204;case 16204:if(0===c)break t;if(p=f-c,n.offset>p){if((p=n.offset-p)>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=16209;break}p>n.wnext?(p-=n.wnext,d=n.wsize-p):d=n.wnext-p,p>n.length&&(p=n.length),g=n.window}else g=r,d=a-n.offset,p=n.length;p>c&&(p=c),c-=p,n.length-=p;do{r[a++]=g[d++]}while(--p);0===n.length&&(n.mode=16200);break;case 16205:if(0===c)break t;r[a++]=n.length,c--,n.mode=16200;break;case 16206:if(n.wrap){for(;h<32;){if(0===s)break t;s--,u|=i[o++]<<h,h+=8}if(f-=c,t.total_out+=f,n.total+=f,4&n.wrap&&f&&(t.adler=n.check=n.flags?Qt(n.check,r,f,a-f):$t(n.check,r,f,a-f)),f=c,4&n.wrap&&(n.flags?u:Gn(u))!==n.check){t.msg="incorrect data check",n.mode=16209;break}u=0,h=0}n.mode=16207;case 16207:if(n.wrap&&n.flags){for(;h<32;){if(0===s)break t;s--,u+=i[o++]<<h,h+=8}if(4&n.wrap&&u!==(4294967295&n.total)){t.msg="incorrect length check",n.mode=16209;break}u=0,h=0}n.mode=16208;case 16208:S=xn;break t;case 16209:S=On;break t;case 16210:return Cn;case 16211:default:return Rn}return t.next_out=a,t.avail_out=c,t.next_in=o,t.avail_in=s,n.hold=u,n.bits=h,(n.wsize||f!==t.avail_out&&n.mode<16209&&(n.mode<16206||e!==Tn))&&Jn(t,t.output,t.next_out,f-t.avail_out),l-=t.avail_in,f-=t.avail_out,t.total_in+=l,t.total_out+=f,n.total+=f,4&n.wrap&&f&&(t.adler=n.check=n.flags?Qt(n.check,r,f,t.next_out-f):$t(n.check,r,f,t.next_out-f)),t.data_type=n.bits+(n.last?64:0)+(16191===n.mode?128:0)+(16199===n.mode||16194===n.mode?256:0),(0===l&&0===f||e===Tn)&&S===An&&(S=Mn),S},inflateEnd:t=>{if(Nn(t))return Rn;let e=t.state;return e.window&&(e.window=null),t.state=null,An},inflateGetHeader:(t,e)=>{if(Nn(t))return Rn;const n=t.state;return 0==(2&n.wrap)?Rn:(n.head=e,e.done=!1,An)},inflateSetDictionary:(t,e)=>{const n=e.length;let i,r,o;return Nn(t)?Rn:0!==(i=t.state).wrap&&16190!==i.mode?Rn:16190===i.mode&&(r=$t(r=1,e,n,0))!==i.check?On:(o=Jn(t,e,n,n))?(i.mode=16210,Cn):(i.havedict=1,An)},inflateInfo:"pako inflate (from Nodeca project)"};var Wn=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const Xn=Object.prototype.toString,{Z_NO_FLUSH:$n,Z_FINISH:Yn,Z_OK:Qn,Z_STREAM_END:ti,Z_NEED_DICT:ei,Z_STREAM_ERROR:ni,Z_DATA_ERROR:ii,Z_MEM_ERROR:ri}=ee;function oi(t){this.options=tn.assign({chunkSize:65536,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new on,this.strm.avail_out=0;let n=Zn.inflateInit2(this.strm,e.windowBits);if(n!==Qn)throw new Error(te[n]);if(this.header=new Wn,Zn.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=rn.string2buf(e.dictionary):"[object ArrayBuffer]"===Xn.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=Zn.inflateSetDictionary(this.strm,e.dictionary))!==Qn))throw new Error(te[n])}function ai(t,e){const n=new oi(e);if(n.push(t),n.err)throw n.msg||te[n.err];return n.result}oi.prototype.push=function(t,e){const n=this.strm,i=this.options.chunkSize,r=this.options.dictionary;let o,a,s;if(this.ended)return!1;for(a=e===~~e?e:!0===e?Yn:$n,"[object ArrayBuffer]"===Xn.call(t)?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),(o=Zn.inflate(n,a))===ei&&r&&((o=Zn.inflateSetDictionary(n,r))===Qn?o=Zn.inflate(n,a):o===ii&&(o=ei));n.avail_in>0&&o===ti&&n.state.wrap>0&&0!==t[n.next_in];)Zn.inflateReset(n),o=Zn.inflate(n,a);switch(o){case ni:case ii:case ei:case ri:return this.onEnd(o),this.ended=!0,!1}if(s=n.avail_out,n.next_out&&(0===n.avail_out||o===ti))if("string"===this.options.to){let t=rn.utf8border(n.output,n.next_out),e=n.next_out-t,r=rn.buf2string(n.output,t);n.next_out=e,n.avail_out=i-e,e&&n.output.set(n.output.subarray(t,t+e),0),this.onData(r)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(o!==Qn||0!==s){if(o===ti)return o=Zn.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},oi.prototype.onData=function(t){this.chunks.push(t)},oi.prototype.onEnd=function(t){t===Qn&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=tn.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var si={Inflate:oi,inflate:ai,inflateRaw:function(t,e){return(e=e||{}).raw=!0,ai(t,e)},ungzip:ai,constants:ee};const{Deflate:ci,deflate:ui,deflateRaw:hi,gzip:li}=_n,{Inflate:fi,inflate:pi,inflateRaw:di,ungzip:gi}=si;var mi={Deflate:ci,deflate:ui,deflateRaw:hi,gzip:li,Inflate:fi,inflate:pi,inflateRaw:di,ungzip:gi,constants:ee},vi=function(){return!(!window.navigator||!window.navigator.sendBeacon)},_i=function(){function t(t,e){var n=this;this.collector=t,this.config=e,this.requestType=e.request_type||"xhr",this.supportBeacon=vi(),this.errorCode={NO_URL:4001,IMG_ON:4e3,IMG_CATCH:4002,BEACON_FALSE:4003,XHR_ERROR:5002,TIMEOUT:5005},this.errorMessage={BEACON_FALSE:"xhr sendbeacon error",XHR_ERROR:"xhr request error",BEACON:"xhr sendbeacon error",TIMEOUT:"xhr request timeout"},this.customHeader=e.custom_request_header||{},this.collector.on(Y.CustomHeader,function(t){n.setRequestHeader(t)})}return t.prototype.setRequestHeader=function(t){this.customHeader=Object.assign(this.customHeader,t)},t.prototype.useFetch=function(t){var e=t.url,n=t.data,i=t.method,r=t.success,o=t.fail,a={"Content-Type":"application/json; charset=utf-8"};if(Object.keys(this.customHeader).length)for(var s in this.customHeader)a[s]=this.customHeader[s];window.fetch?fetch(e,{method:i||"POST",headers:a,body:JSON.stringify(n)}).then(function(t){return t.json()}).then(function(t){r&&r(t)}).catch(function(t){o&&o(n,t)}):(this.requestType="xhr",console.log("your brwoser not support fetch, use xhr"),this.useRequest({url:e,data:n,method:i,success:r,fail:o}))},t.prototype.useBeacon=function(t){var e=t.url,n=t.data,i=t.success,r=t.fail,o=Date.now();window.navigator.sendBeacon(e,JSON.stringify(n))?i&&i({e:0},n,o):r&&r(n,this.errorCode.BEACON_FALSE,o,this.errorMessage.BEACON_FALSE)},t.prototype.useRequest=function(t){var e=this,n=t.url,i=t.data,r=t.method,o=t.success,a=t.fail,s=t.timeout,c=t.useBeacon,u=t.withCredentials,h=t.app_key,l=t.forceXhr,f=t.encryption,p=t.encryption_header,d=t.status,g=t.zip,m=t.type;if(c&&this.supportBeacon)this.useBeacon({url:n,data:i,method:r,success:o,fail:a});else if("fetch"!==this.requestType||l)try{var v=null;if(window.XDomainRequest&&A()){v=new XDomainRequest;var _=r||"post",y=Date.now();v.open(_,n),s&&(v.timeout=s,v.ontimeout=function(){a&&a(i,e.errorCode.TIMEOUT,y,e.errorMessage.TIMEOUT)}),v.onerror=function(){a&&a(i,e.errorCode.XHR_ERROR,y,e.errorMessage.XHR_ERROR),v.abort()},v.onload=function(){if(o){var t=null;if(v.responseText){try{t=JSON.parse(v.responseText)}catch(e){t={}}o(t,i)}}},setTimeout(function(){f?v.send(i):v.send(JSON.stringify(i))},0)}else if(window.ActiveXObject&&x()){v=new ActiveXObject("Micrsorf.XMLHTTP");_=r||"POST";var b=Date.now();v.open(_,n),s&&(v.timeout=s,v.ontimeout=function(){a&&a(i,e.errorCode.TIMEOUT,b,e.errorMessage.TIMEOUT)}),v.onerror=function(){a&&a(i,e.errorCode.XHR_ERROR,b,e.errorMessage.XHR_ERROR),v.abort()},v.onload=function(){if(o){var t=null;if(v.responseText){try{t=JSON.parse(v.responseText)}catch(e){t={}}o(t,i)}}},setTimeout(function(){v.send(JSON.stringify(i))},0)}else if(window.XMLHttpRequest){v=new XMLHttpRequest;_=r||"POST";v.open(_,"".concat(n),!0);var w=Date.now();if(f&&p&&!D()?v.setRequestHeader("Content-Type","application/octet-stream;tt-data=".concat(p)):v.setRequestHeader("Content-Type","application/json; charset=utf-8"),this.collector.emit(Y.XhrCurrendSend,{type:"net_event",eventData:i}),h&&v.setRequestHeader("X-MCS-AppKey","".concat(h)),Object.keys(this.customHeader).length)for(var E in this.customHeader)v.setRequestHeader(E,this.customHeader[E]);u&&(v.withCredentials=!0),s&&(v.timeout=s,v.ontimeout=function(){a&&a(i,e.errorCode.TIMEOUT,w,e.errorMessage.TIMEOUT)}),v.onload=function(){if(o){var t=null;if(v.responseText){try{t=JSON.parse(v.responseText)}catch(e){t={}}o(t,i,d,w,v.status),"monitor"!==d&&"event"===m&&e.collector.emit(Y.HttpOk,{data:i,status:d})}}},v.onerror=function(){a&&a(i,e.errorCode.XHR_ERROR,w,e.errorMessage.XHR_ERROR),"monitor"!==d&&"event"===m&&e.collector.emit(Y.HttpError,{data:i,status:d}),v.abort()};try{if(f&&!D())v.send(i);else if(g&&this.config.enable_zip){var S=(new TextEncoder).encode(JSON.stringify(i)),k=mi.gzip(S);v.setRequestHeader("Content-Encoding","gzip"),v.send(k)}else v.send(JSON.stringify(i))}catch(t){v.setRequestHeader("Content-Encoding",""),v.send(JSON.stringify(i)),this.collector.emit(Y.SDKInnerError,{type:"sdk_error_send",eventData:i,errorCode:1e3,msg:t.message||t.stack||"sdk_error_send"})}}}catch(t){this.collector.emit(Y.SDKInnerError,{type:"sdk_error_request",eventData:i,errorCode:1001,msg:t.message||t.stack||"sdk_error_request"}),this.collector.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK useRequest ",level:"error",time:Date.now(),data:t.message,infoType:"sdk"})}else this.useFetch({url:n,data:i,method:r,success:o,fail:a})},t}(),yi=function(){function e(){}return e.prototype.apply=function(t,e){var n=this;if(!z()){this.collect=t,this.config=e,this.duration=6e4,this.reportUrl="".concat(t.configManager.getDomain(),"/profile/list");var i=t.Types;this.cache={},this.types=i,this.collect.on(i.ProfileSet,function(t){n.setProfile(t)}),this.collect.on(i.ProfileSetOnce,function(t){n.setOnceProfile(t)}),this.collect.on(i.ProfileUnset,function(t){n.unsetProfile(t)}),this.collect.on(i.ProfileIncrement,function(t){n.incrementProfile(t)}),this.collect.on(i.ProfileAppend,function(t){n.appendProfile(t)}),this.collect.on(i.ProfileClear,function(){n.cache={}}),this.ready(i.Profile)}},e.prototype.ready=function(t){var e=this;if(this.collect.set(t),this.collect.hook._hooksCache.hasOwnProperty(t)){var n=this.collect.hook._hooksCache[t];if(!Object.keys(n).length)return;var i=function(t){n[t].length&&n[t].forEach(function(n){e.collect.hook.emit(t,n)})};for(var r in n)i(r)}},e.prototype.report=function(t,e){var n=this;void 0===e&&(e={});try{if(this.config.disable_track_event)return;if(this.collect.sdkStop)return;var i=[];i.push(this.collect.processEvent(t,e));var r=this.collect.eventManager.merge(i,!0),o=this.collect.cryptoData(r);this.collect.configManager.getUrl("profile");this.collect.requestManager.useRequest({url:this.reportUrl,data:o,timeout:1e5,encryption:this.config.enable_encryption,encryption_header:this.config.encryption_header,zip:!0,success:function(t,e,i,r,o){t&&0!==t.e?n.collect.emit(n.types.SubmitError,{type:"f_data",eventData:e,errorCode:t.e,response:t,startTime:r,endTime:Date.now(),status:o}):n.collect.emit(n.types.SubmitSuccess,{eventData:e,res:t,response:t,startTime:r,endTime:Date.now(),status:o})},fail:function(t,e,i){n.collect.emit(n.types.SubmitError,{type:"f_net",eventData:t,errorCode:e,startTime:i,endTime:Date.now()})}}),this.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_EVENT,info:"profile ",time:Date.now(),data:r,code:200,status:"success"})}catch(t){this.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"profile report ",level:"error",time:Date.now(),data:t.message,infoType:"sdk"})}},e.prototype.setProfile=function(e){var n=this.formatParams(e);n&&Object.keys(n).length&&(this.pushCache(n),this.report("__profile_set",t(t({},n),{profile:!0})))},e.prototype.setOnceProfile=function(e){var n=this.formatParams(e,!0);n&&Object.keys(n).length&&(this.pushCache(n),this.report("__profile_set_once",t(t({},n),{profile:!0})))},e.prototype.incrementProfile=function(e){e?this.report("__profile_increment",t(t({},e),{profile:!0})):console.warn("please check the params, must be object!!!")},e.prototype.unsetProfile=function(e){if(e){var n={};n[e]="1",this.report("__profile_unset",t(t({},n),{profile:!0}))}else console.warn("please check the key, must be string!!!")},e.prototype.appendProfile=function(e){if(e){var n={};for(var i in e)"string"==typeof e[i]||"Array"===Object.prototype.toString.call(e[i]).slice(8,-1)?n[i]=e[i]:console.warn("please check the value of param: ".concat(i,", must be string or array !!!"));Object.keys(n).length&&this.report("__profile_append",t(t({},n),{profile:!0}))}else console.warn("please check the params, must be object!!!")},e.prototype.pushCache=function(t){var e=this;Object.keys(t).forEach(function(n){e.cache[n]={val:e.clone(t[n]),timestamp:Date.now()}})},e.prototype.formatParams=function(t,e){var n=this;void 0===e&&(e=!1);try{if(!t||"[object Object]"!==Object.prototype.toString.call(t))return void console.warn("please check the params type, must be object !!!");var i={};for(var r in t)"string"==typeof t[r]||"number"==typeof t[r]||"Array"===Object.prototype.toString.call(t[r]).slice(8,-1)?i[r]=t[r]:console.warn("please check the value of params:".concat(r,", must be string,number,Array !!!"));var o=Object.keys(i);if(!o.length)return;var a=Date.now();return o.filter(function(i){var r=n.cache[i];return e?!r:!(r&&n.compare(r.val,t[i])&&a-r.timestamp<n.duration)}).reduce(function(t,e){return t[e]=i[e],t},{})}catch(t){this.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"",level:"error",time:Date.now(),data:t.message}),console.log("error")}},e.prototype.compare=function(t,e){try{return JSON.stringify(t)===JSON.stringify(e)}catch(t){return this.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"",level:"error",time:Date.now(),data:t.message}),!1}},e.prototype.clone=function(t){try{return JSON.parse(JSON.stringify(t))}catch(e){return this.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"",level:"error",time:Date.now(),data:e.message}),t}},e.prototype.unReady=function(){console.warn("sdk is not ready, please use this api after start")},e}(),bi=function(){return"undefined"!=typeof window?(window.LogPluginObject||(window.LogPluginObject={}),window.LogPluginObject):null},wi=function(){function t(){this.setUrl="/service/2/log_settings",this.expire=216e5}return t.prototype.apply=function(t,e){e.enable_logsetting?(this.collect=t,this.config=e,this.setKey="__applog_web_logsetting_".concat(e.app_id),this.cacheStorgae=new P,this.check()):t.emit(Y.LogSettingReady)},t.prototype.check=function(){try{var t=this.getLocalData();t&&Object.keys(t).length?(null==t?void 0:t.timestamp)<Date.now()-this.expire?this.fetchSetting():(this.setLocalData(t),this.fetchSetting(!0)):this.fetchSetting()}catch(t){this.collect.emit(Y.LogSettingReady),this.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK Check LogSetting Data Error",logType:"fetch",level:"error",time:Date.now(),infoType:"sdk"}),this.collect.emit(Y.SDKException,{error:(null==t?void 0:t.message)||"sdk logsetting check cache something error"})}},t.prototype.fetchSetting=function(t){var e=this;t?this.collect.emit(Y.LogSettingReady):this.collect.requestManager.useRequest({url:"".concat(this.collect.configManager.getDomain()).concat(this.setUrl),data:{magic_tag:"ss_app_log",header:{aid:this.config.app_id,platform:"web"}},timeout:3e4,success:function(t){(null==t?void 0:t.config)?(e.setLocalData(t.config),e.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"LogSetting Request Success",logType:"fetch",level:"info",time:Date.now(),data:t,infoType:"sdk"})):e.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"LogSetting Request Response No Data",logType:"fetch",level:"error",time:Date.now(),infoType:"sdk"}),e.collect.emit(Y.LogSettingReady)},fail:function(){e.collect.emit(Y.LogSettingReady),e.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"LogSetting Request Fail",logType:"fetch",level:"error",time:Date.now(),infoType:"sdk"}),e.collect.emit(Y.SDKException,{error:"sdk logsetting request fail"})},encryption:this.config.enable_encryption,encryption_header:this.config.encryption_header})},t.prototype.getLocalData=function(){return this.cacheStorgae.getLocalItem(this.setKey)},t.prototype.setLocalData=function(t){this.collect.configManager.setSettingData(t),this.cacheStorgae.setLocalItem(this.setKey,t)},t}();try{var Ei=bi();Ei&&(Ei.LogSetting=function(t,e){(new wi).apply(t,e)})}catch(t){console.log(t)}var Si=function(){function t(t,e){var n=this,i=t.Types;this.collector=t,this.config=e,this.Types=i,this.configCache=[],this.eventCache=[],this.beaconEventCache=[],t.once(i.CloudReady,function(t){n.tracerInit(t)}),t.on(i.ConfigTransform,function(t){n.tracerConfig(t)}),t.on(i.Event,function(t){try{n.tracerEvent(JSON.parse(JSON.stringify(t)))}catch(t){}}),t.on(i.BeconEvent,function(t){try{n.tracerBeacon(JSON.parse(JSON.stringify(t)))}catch(t){}})}return t.prototype.tracerInit=function(t){var e=this;try{if(!this.config.tracer_appId||!this.config.tracer_domain)return void console.warn("miss tracer_appId or tracer_domain, please check.");this.tracer=new Sr("tracer_cloud"),this.tracer.init({app_id:this.config.tracer_appId,channel_domain:this.config.tracer_domain,log:!0,disable_heartbeat:!0,disable_sdk_monitor:!0,disable_auto_pv:!0}),this.configCache.length&&(this.configCache.forEach(function(t){e.tracerConfig(t)}),this.configCache=[]),this.tracer.once(this.Types.Ready,function(n){var i,r;if((e.eventCache.length||e.beaconEventCache.length)&&(e.eventCache.forEach(function(t){e.tracerEvent(t)}),e.beaconEventCache.forEach(function(t){e.tracerBeacon(t)}),e.eventCache=[],e.beaconEventCache=[]),2===(null===(r=null===(i=e.config)||void 0===i?void 0:i.tracer_bind)||void 0===r?void 0:r.length)){var o=t.userInfo.web_id,a=n.userInfo.web_id,s=e.config.tracer_bind,c={};c["".concat(s[0])]=o,c["".concat(s[1])]=a,e.collector.bindToken(c,function(){},!0)}}),this.tracer.start()}catch(t){console.warn("tracer saas instancemsg: ".concat(JSON.stringify(t.message)))}},t.prototype.tracerConfig=function(t){this.tracer?this.tracer.config(t):this.configCache.push(t)},t.prototype.tracerEvent=function(t){this.tracer?this.tracer.eventManager.event(t):this.eventCache.push(t)},t.prototype.tracerBeacon=function(t){this.tracer?this.tracer.eventManager.beaconEvent(t):this.beaconEventCache.push(t)},t}(),ki=function(){function t(t,e){this.collect=t,this.config=e}return t.prototype.getAppId=function(){var t=this.config.app_id;if(t&&"number"==typeof t)return this.config.app_id;if("string"==typeof t&&t.startsWith("rangers://")){if(this.parseAppId)return this.parseAppId;try{var e=(t=t.substring("rangers://".length)).trim().split("/");if(2===(null==e?void 0:e.length)){var n=e[0],i=e[1];if(p(i)&&p(n)){var a=window.atob(i);if(a&&n.toLowerCase()==function(t){var e,n,i=1732584193,a=4023233417,s=2562383102,c=271733878,u=(new TextEncoder).encode(t),h=8*u.length,l=(56-u.length%64+64)%64||64,f=new Uint8Array(u.length+l+8);f.set(u),f[u.length]=128;var p=new DataView(f.buffer,f.byteLength-8);p.setUint32(0,h>>>0,!0),p.setUint32(4,Math.floor(h/4294967296),!0);for(var d=0;d<f.length;d+=64){for(var g=new Uint32Array(16),m=new DataView(f.buffer,d,64),v=0;v<16;v++)g[v]=m.getUint32(4*v,!0);for(var _=i,y=a,b=s,w=c,E=function(t,e,n){return t&e|~t&n},S=function(t,e,n){return t&n|e&~n},k=function(t,e,n){return t^e^n},T=function(t,e,n){return e^(t|~n)},D=function(t,e){return t<<e|t>>>32-e},z=new Uint32Array(64),A=0;A<64;A++)z[A]=Math.floor(4294967296*Math.abs(Math.sin(A+1)))>>>0;var x=[[E,0,7,1],[E,1,12,2],[E,2,17,3],[E,3,22,4],[E,4,7,5],[E,5,12,6],[E,6,17,7],[E,7,22,8],[E,8,7,9],[E,9,12,10],[E,10,17,11],[E,11,22,12],[E,12,7,13],[E,13,12,14],[E,14,17,15],[E,15,22,16],[S,1,5,17],[S,6,9,18],[S,11,14,19],[S,0,20,20],[S,5,5,21],[S,10,9,22],[S,15,14,23],[S,4,20,24],[S,9,5,25],[S,14,9,26],[S,3,14,27],[S,8,20,28],[S,13,5,29],[S,2,9,30],[S,7,14,31],[S,12,20,32],[k,5,4,33],[k,8,11,34],[k,11,16,35],[k,14,23,36],[k,1,4,37],[k,4,11,38],[k,7,16,39],[k,10,23,40],[k,13,4,41],[k,0,11,42],[k,3,16,43],[k,6,23,44],[k,9,4,45],[k,12,11,46],[k,15,16,47],[k,2,23,48],[T,0,6,49],[T,7,10,50],[T,14,15,51],[T,5,21,52],[T,12,6,53],[T,3,10,54],[T,10,15,55],[T,1,21,56],[T,8,6,57],[T,15,10,58],[T,6,15,59],[T,13,21,60],[T,4,6,61],[T,11,10,62],[T,2,15,63],[T,9,21,64]];try{for(var I=(e=void 0,r(x)),R=I.next();!R.done;R=I.next()){var O=o(R.value,4),C=O[0],M=O[1],B=O[2],G=O[3],U=C(y,b,w);U=D(U=_+U+g[M]+z[G-1]>>>0,B),_=w,w=b,b=y,y=U=U+y>>>0}}catch(t){e={error:t}}finally{try{R&&!R.done&&(n=I.return)&&n.call(I)}finally{if(e)throw e.error}}i=i+_>>>0,a=a+y>>>0,s=s+b>>>0,c=c+w>>>0}var N=new Uint32Array([i,a,s,c]);return Array.from(N).map(function(t){return Array.from(new Uint8Array(new Uint32Array([t]).buffer)).map(function(t){return t.toString(16).padStart(2,"0")}).join("")}).join("")}(a))return this.parseAppId=Number(a),this.parseAppId;this.collect.logger.error("Init failed. App id parse error! AppId: ".concat(this.config.app_id))}}}catch(t){this.collect.logger.error("Init failed. App id parse error! App AppId: ".concat(this.config.app_id))}return this.parseAppId}this.collect.logger.error("Init failed. AppId is error! please check AppId: ".concat(this.config.app_id))},t}(),Ti=C(function(t,e){(function(){var e;function n(t,e,n){null!=t&&("number"==typeof t?this.fromNumber(t,e,n):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function i(){return new n(null)}var r="undefined"!=typeof navigator;r&&"Microsoft Internet Explorer"==navigator.appName?(n.prototype.am=function(t,e,n,i,r,o){for(var a=32767&e,s=e>>15;--o>=0;){var c=32767&this[t],u=this[t++]>>15,h=s*c+u*a;r=((c=a*c+((32767&h)<<15)+n[i]+(1073741823&r))>>>30)+(h>>>15)+s*u+(r>>>30),n[i++]=1073741823&c}return r},e=30):r&&"Netscape"!=navigator.appName?(n.prototype.am=function(t,e,n,i,r,o){for(;--o>=0;){var a=e*this[t++]+n[i]+r;r=Math.floor(a/67108864),n[i++]=67108863&a}return r},e=26):(n.prototype.am=function(t,e,n,i,r,o){for(var a=16383&e,s=e>>14;--o>=0;){var c=16383&this[t],u=this[t++]>>14,h=s*c+u*a;r=((c=a*c+((16383&h)<<14)+n[i]+r)>>28)+(h>>14)+s*u,n[i++]=268435455&c}return r},e=28),n.prototype.DB=e,n.prototype.DM=(1<<e)-1,n.prototype.DV=1<<e;n.prototype.FV=Math.pow(2,52),n.prototype.F1=52-e,n.prototype.F2=2*e-52;var o,a,s="0123456789abcdefghijklmnopqrstuvwxyz",c=new Array;for(o="0".charCodeAt(0),a=0;a<=9;++a)c[o++]=a;for(o="a".charCodeAt(0),a=10;a<36;++a)c[o++]=a;for(o="A".charCodeAt(0),a=10;a<36;++a)c[o++]=a;function u(t){return s.charAt(t)}function h(t,e){var n=c[t.charCodeAt(e)];return null==n?-1:n}function l(t){var e=i();return e.fromInt(t),e}function f(t){var e,n=1;return 0!=(e=t>>>16)&&(t=e,n+=16),0!=(e=t>>8)&&(t=e,n+=8),0!=(e=t>>4)&&(t=e,n+=4),0!=(e=t>>2)&&(t=e,n+=2),0!=(e=t>>1)&&(t=e,n+=1),n}function p(t){this.m=t}function d(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function g(t,e){return t&e}function m(t,e){return t|e}function v(t,e){return t^e}function _(t,e){return t&~e}function y(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function b(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function w(){}function E(t){return t}function S(t){this.r2=i(),this.q3=i(),n.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}p.prototype.convert=function(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t},p.prototype.revert=function(t){return t},p.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},p.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},p.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},d.prototype.convert=function(t){var e=i();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(n.ZERO)>0&&this.m.subTo(e,e),e},d.prototype.revert=function(t){var e=i();return t.copyTo(e),this.reduce(e),e},d.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var n=32767&t[e],i=n*this.mpl+((n*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[n=e+this.m.t]+=this.m.am(0,i,t,e,0,this.m.t);t[n]>=t.DV;)t[n]-=t.DV,t[++n]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)},d.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},d.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},n.prototype.copyTo=function(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s},n.prototype.fromInt=function(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0},n.prototype.fromString=function(t,e){var i;if(16==e)i=4;else if(8==e)i=3;else if(256==e)i=8;else if(2==e)i=1;else if(32==e)i=5;else{if(4!=e)return void this.fromRadix(t,e);i=2}this.t=0,this.s=0;for(var r=t.length,o=!1,a=0;--r>=0;){var s=8==i?255&t[r]:h(t,r);s<0?"-"==t.charAt(r)&&(o=!0):(o=!1,0==a?this[this.t++]=s:a+i>this.DB?(this[this.t-1]|=(s&(1<<this.DB-a)-1)<<a,this[this.t++]=s>>this.DB-a):this[this.t-1]|=s<<a,(a+=i)>=this.DB&&(a-=this.DB))}8==i&&0!=(128&t[0])&&(this.s=-1,a>0&&(this[this.t-1]|=(1<<this.DB-a)-1<<a)),this.clamp(),o&&n.ZERO.subTo(this,this)},n.prototype.clamp=function(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t},n.prototype.dlShiftTo=function(t,e){var n;for(n=this.t-1;n>=0;--n)e[n+t]=this[n];for(n=t-1;n>=0;--n)e[n]=0;e.t=this.t+t,e.s=this.s},n.prototype.drShiftTo=function(t,e){for(var n=t;n<this.t;++n)e[n-t]=this[n];e.t=Math.max(this.t-t,0),e.s=this.s},n.prototype.lShiftTo=function(t,e){var n,i=t%this.DB,r=this.DB-i,o=(1<<r)-1,a=Math.floor(t/this.DB),s=this.s<<i&this.DM;for(n=this.t-1;n>=0;--n)e[n+a+1]=this[n]>>r|s,s=(this[n]&o)<<i;for(n=a-1;n>=0;--n)e[n]=0;e[a]=s,e.t=this.t+a+1,e.s=this.s,e.clamp()},n.prototype.rShiftTo=function(t,e){e.s=this.s;var n=Math.floor(t/this.DB);if(n>=this.t)e.t=0;else{var i=t%this.DB,r=this.DB-i,o=(1<<i)-1;e[0]=this[n]>>i;for(var a=n+1;a<this.t;++a)e[a-n-1]|=(this[a]&o)<<r,e[a-n]=this[a]>>i;i>0&&(e[this.t-n-1]|=(this.s&o)<<r),e.t=this.t-n,e.clamp()}},n.prototype.subTo=function(t,e){for(var n=0,i=0,r=Math.min(t.t,this.t);n<r;)i+=this[n]-t[n],e[n++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i-=t.s;n<this.t;)i+=this[n],e[n++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;n<t.t;)i-=t[n],e[n++]=i&this.DM,i>>=this.DB;i-=t.s}e.s=i<0?-1:0,i<-1?e[n++]=this.DV+i:i>0&&(e[n++]=i),e.t=n,e.clamp()},n.prototype.multiplyTo=function(t,e){var i=this.abs(),r=t.abs(),o=i.t;for(e.t=o+r.t;--o>=0;)e[o]=0;for(o=0;o<r.t;++o)e[o+i.t]=i.am(0,r[o],e,o,0,i.t);e.s=0,e.clamp(),this.s!=t.s&&n.ZERO.subTo(e,e)},n.prototype.squareTo=function(t){for(var e=this.abs(),n=t.t=2*e.t;--n>=0;)t[n]=0;for(n=0;n<e.t-1;++n){var i=e.am(n,e[n],t,2*n,0,1);(t[n+e.t]+=e.am(n+1,2*e[n],t,2*n+1,i,e.t-n-1))>=e.DV&&(t[n+e.t]-=e.DV,t[n+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(n,e[n],t,2*n,0,1)),t.s=0,t.clamp()},n.prototype.divRemTo=function(t,e,r){var o=t.abs();if(!(o.t<=0)){var a=this.abs();if(a.t<o.t)return null!=e&&e.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=i());var s=i(),c=this.s,u=t.s,h=this.DB-f(o[o.t-1]);h>0?(o.lShiftTo(h,s),a.lShiftTo(h,r)):(o.copyTo(s),a.copyTo(r));var l=s.t,p=s[l-1];if(0!=p){var d=p*(1<<this.F1)+(l>1?s[l-2]>>this.F2:0),g=this.FV/d,m=(1<<this.F1)/d,v=1<<this.F2,_=r.t,y=_-l,b=null==e?i():e;for(s.dlShiftTo(y,b),r.compareTo(b)>=0&&(r[r.t++]=1,r.subTo(b,r)),n.ONE.dlShiftTo(l,b),b.subTo(s,s);s.t<l;)s[s.t++]=0;for(;--y>=0;){var w=r[--_]==p?this.DM:Math.floor(r[_]*g+(r[_-1]+v)*m);if((r[_]+=s.am(0,w,r,y,0,l))<w)for(s.dlShiftTo(y,b),r.subTo(b,r);r[_]<--w;)r.subTo(b,r)}null!=e&&(r.drShiftTo(l,e),c!=u&&n.ZERO.subTo(e,e)),r.t=l,r.clamp(),h>0&&r.rShiftTo(h,r),c<0&&n.ZERO.subTo(r,r)}}},n.prototype.invDigit=function(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return(e=(e=(e=(e=e*(2-(15&t)*e)&15)*(2-(255&t)*e)&255)*(2-((65535&t)*e&65535))&65535)*(2-t*e%this.DV)%this.DV)>0?this.DV-e:-e},n.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},n.prototype.exp=function(t,e){if(t>4294967295||t<1)return n.ONE;var r=i(),o=i(),a=e.convert(this),s=f(t)-1;for(a.copyTo(r);--s>=0;)if(e.sqrTo(r,o),(t&1<<s)>0)e.mulTo(o,a,r);else{var c=r;r=o,o=c}return e.revert(r)},n.prototype.toString=function(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var n,i=(1<<e)-1,r=!1,o="",a=this.t,s=this.DB-a*this.DB%e;if(a-- >0)for(s<this.DB&&(n=this[a]>>s)>0&&(r=!0,o=u(n));a>=0;)s<e?(n=(this[a]&(1<<s)-1)<<e-s,n|=this[--a]>>(s+=this.DB-e)):(n=this[a]>>(s-=e)&i,s<=0&&(s+=this.DB,--a)),n>0&&(r=!0),r&&(o+=u(n));return r?o:"0"},n.prototype.negate=function(){var t=i();return n.ZERO.subTo(this,t),t},n.prototype.abs=function(){return this.s<0?this.negate():this},n.prototype.compareTo=function(t){var e=this.s-t.s;if(0!=e)return e;var n=this.t;if(0!=(e=n-t.t))return this.s<0?-e:e;for(;--n>=0;)if(0!=(e=this[n]-t[n]))return e;return 0},n.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+f(this[this.t-1]^this.s&this.DM)},n.prototype.mod=function(t){var e=i();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(n.ZERO)>0&&t.subTo(e,e),e},n.prototype.modPowInt=function(t,e){var n;return n=t<256||e.isEven()?new p(e):new d(e),this.exp(t,n)},n.ZERO=l(0),n.ONE=l(1),w.prototype.convert=E,w.prototype.revert=E,w.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n)},w.prototype.sqrTo=function(t,e){t.squareTo(e)},S.prototype.convert=function(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=i();return t.copyTo(e),this.reduce(e),e},S.prototype.revert=function(t){return t},S.prototype.reduce=function(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)},S.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},S.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)};var k,T,D,z=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],A=(1<<26)/z[z.length-1];function x(){var t;t=(new Date).getTime(),T[D++]^=255&t,T[D++]^=t>>8&255,T[D++]^=t>>16&255,T[D++]^=t>>24&255,D>=G&&(D-=G)}if(n.prototype.chunkSize=function(t){return Math.floor(Math.LN2*this.DB/Math.log(t))},n.prototype.toRadix=function(t){if(null==t&&(t=10),0==this.signum()||t<2||t>36)return"0";var e=this.chunkSize(t),n=Math.pow(t,e),r=l(n),o=i(),a=i(),s="";for(this.divRemTo(r,o,a);o.signum()>0;)s=(n+a.intValue()).toString(t).substr(1)+s,o.divRemTo(r,o,a);return a.intValue().toString(t)+s},n.prototype.fromRadix=function(t,e){this.fromInt(0),null==e&&(e=10);for(var i=this.chunkSize(e),r=Math.pow(e,i),o=!1,a=0,s=0,c=0;c<t.length;++c){var u=h(t,c);u<0?"-"==t.charAt(c)&&0==this.signum()&&(o=!0):(s=e*s+u,++a>=i&&(this.dMultiply(r),this.dAddOffset(s,0),a=0,s=0))}a>0&&(this.dMultiply(Math.pow(e,a)),this.dAddOffset(s,0)),o&&n.ZERO.subTo(this,this)},n.prototype.fromNumber=function(t,e,i){if("number"==typeof e)if(t<2)this.fromInt(1);else for(this.fromNumber(t,i),this.testBit(t-1)||this.bitwiseTo(n.ONE.shiftLeft(t-1),m,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(n.ONE.shiftLeft(t-1),this);else{var r=new Array,o=7&t;r.length=1+(t>>3),e.nextBytes(r),o>0?r[0]&=(1<<o)-1:r[0]=0,this.fromString(r,256)}},n.prototype.bitwiseTo=function(t,e,n){var i,r,o=Math.min(t.t,this.t);for(i=0;i<o;++i)n[i]=e(this[i],t[i]);if(t.t<this.t){for(r=t.s&this.DM,i=o;i<this.t;++i)n[i]=e(this[i],r);n.t=this.t}else{for(r=this.s&this.DM,i=o;i<t.t;++i)n[i]=e(r,t[i]);n.t=t.t}n.s=e(this.s,t.s),n.clamp()},n.prototype.changeBit=function(t,e){var i=n.ONE.shiftLeft(t);return this.bitwiseTo(i,e,i),i},n.prototype.addTo=function(t,e){for(var n=0,i=0,r=Math.min(t.t,this.t);n<r;)i+=this[n]+t[n],e[n++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i+=t.s;n<this.t;)i+=this[n],e[n++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;n<t.t;)i+=t[n],e[n++]=i&this.DM,i>>=this.DB;i+=t.s}e.s=i<0?-1:0,i>0?e[n++]=i:i<-1&&(e[n++]=this.DV+i),e.t=n,e.clamp()},n.prototype.dMultiply=function(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()},n.prototype.dAddOffset=function(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}},n.prototype.multiplyLowerTo=function(t,e,n){var i,r=Math.min(this.t+t.t,e);for(n.s=0,n.t=r;r>0;)n[--r]=0;for(i=n.t-this.t;r<i;++r)n[r+this.t]=this.am(0,t[r],n,r,0,this.t);for(i=Math.min(t.t,e);r<i;++r)this.am(0,t[r],n,r,0,e-r);n.clamp()},n.prototype.multiplyUpperTo=function(t,e,n){--e;var i=n.t=this.t+t.t-e;for(n.s=0;--i>=0;)n[i]=0;for(i=Math.max(e-this.t,0);i<t.t;++i)n[this.t+i-e]=this.am(e-i,t[i],n,0,0,this.t+i-e);n.clamp(),n.drShiftTo(1,n)},n.prototype.modInt=function(t){if(t<=0)return 0;var e=this.DV%t,n=this.s<0?t-1:0;if(this.t>0)if(0==e)n=this[0]%t;else for(var i=this.t-1;i>=0;--i)n=(e*n+this[i])%t;return n},n.prototype.millerRabin=function(t){var e=this.subtract(n.ONE),r=e.getLowestSetBit();if(r<=0)return!1;var o=e.shiftRight(r);(t=t+1>>1)>z.length&&(t=z.length);for(var a=i(),s=0;s<t;++s){a.fromInt(z[Math.floor(Math.random()*z.length)]);var c=a.modPow(o,this);if(0!=c.compareTo(n.ONE)&&0!=c.compareTo(e)){for(var u=1;u++<r&&0!=c.compareTo(e);)if(0==(c=c.modPowInt(2,this)).compareTo(n.ONE))return!1;if(0!=c.compareTo(e))return!1}}return!0},n.prototype.clone=function(){var t=i();return this.copyTo(t),t},n.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},n.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},n.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},n.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},n.prototype.toByteArray=function(){var t=this.t,e=new Array;e[0]=this.s;var n,i=this.DB-t*this.DB%8,r=0;if(t-- >0)for(i<this.DB&&(n=this[t]>>i)!=(this.s&this.DM)>>i&&(e[r++]=n|this.s<<this.DB-i);t>=0;)i<8?(n=(this[t]&(1<<i)-1)<<8-i,n|=this[--t]>>(i+=this.DB-8)):(n=this[t]>>(i-=8)&255,i<=0&&(i+=this.DB,--t)),0!=(128&n)&&(n|=-256),0==r&&(128&this.s)!=(128&n)&&++r,(r>0||n!=this.s)&&(e[r++]=n);return e},n.prototype.equals=function(t){return 0==this.compareTo(t)},n.prototype.min=function(t){return this.compareTo(t)<0?this:t},n.prototype.max=function(t){return this.compareTo(t)>0?this:t},n.prototype.and=function(t){var e=i();return this.bitwiseTo(t,g,e),e},n.prototype.or=function(t){var e=i();return this.bitwiseTo(t,m,e),e},n.prototype.xor=function(t){var e=i();return this.bitwiseTo(t,v,e),e},n.prototype.andNot=function(t){var e=i();return this.bitwiseTo(t,_,e),e},n.prototype.not=function(){for(var t=i(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t},n.prototype.shiftLeft=function(t){var e=i();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e},n.prototype.shiftRight=function(t){var e=i();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e},n.prototype.getLowestSetBit=function(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+y(this[t]);return this.s<0?this.t*this.DB:-1},n.prototype.bitCount=function(){for(var t=0,e=this.s&this.DM,n=0;n<this.t;++n)t+=b(this[n]^e);return t},n.prototype.testBit=function(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)},n.prototype.setBit=function(t){return this.changeBit(t,m)},n.prototype.clearBit=function(t){return this.changeBit(t,_)},n.prototype.flipBit=function(t){return this.changeBit(t,v)},n.prototype.add=function(t){var e=i();return this.addTo(t,e),e},n.prototype.subtract=function(t){var e=i();return this.subTo(t,e),e},n.prototype.multiply=function(t){var e=i();return this.multiplyTo(t,e),e},n.prototype.divide=function(t){var e=i();return this.divRemTo(t,e,null),e},n.prototype.remainder=function(t){var e=i();return this.divRemTo(t,null,e),e},n.prototype.divideAndRemainder=function(t){var e=i(),n=i();return this.divRemTo(t,e,n),new Array(e,n)},n.prototype.modPow=function(t,e){var n,r,o=t.bitLength(),a=l(1);if(o<=0)return a;n=o<18?1:o<48?3:o<144?4:o<768?5:6,r=o<8?new p(e):e.isEven()?new S(e):new d(e);var s=new Array,c=3,u=n-1,h=(1<<n)-1;if(s[1]=r.convert(this),n>1){var g=i();for(r.sqrTo(s[1],g);c<=h;)s[c]=i(),r.mulTo(g,s[c-2],s[c]),c+=2}var m,v,_=t.t-1,y=!0,b=i();for(o=f(t[_])-1;_>=0;){for(o>=u?m=t[_]>>o-u&h:(m=(t[_]&(1<<o+1)-1)<<u-o,_>0&&(m|=t[_-1]>>this.DB+o-u)),c=n;0==(1&m);)m>>=1,--c;if((o-=c)<0&&(o+=this.DB,--_),y)s[m].copyTo(a),y=!1;else{for(;c>1;)r.sqrTo(a,b),r.sqrTo(b,a),c-=2;c>0?r.sqrTo(a,b):(v=a,a=b,b=v),r.mulTo(b,s[m],a)}for(;_>=0&&0==(t[_]&1<<o);)r.sqrTo(a,b),v=a,a=b,b=v,--o<0&&(o=this.DB-1,--_)}return r.revert(a)},n.prototype.modInverse=function(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return n.ZERO;for(var i=t.clone(),r=this.clone(),o=l(1),a=l(0),s=l(0),c=l(1);0!=i.signum();){for(;i.isEven();)i.rShiftTo(1,i),e?(o.isEven()&&a.isEven()||(o.addTo(this,o),a.subTo(t,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);for(;r.isEven();)r.rShiftTo(1,r),e?(s.isEven()&&c.isEven()||(s.addTo(this,s),c.subTo(t,c)),s.rShiftTo(1,s)):c.isEven()||c.subTo(t,c),c.rShiftTo(1,c);i.compareTo(r)>=0?(i.subTo(r,i),e&&o.subTo(s,o),a.subTo(c,a)):(r.subTo(i,r),e&&s.subTo(o,s),c.subTo(a,c))}return 0!=r.compareTo(n.ONE)?n.ZERO:c.compareTo(t)>=0?c.subtract(t):c.signum()<0?(c.addTo(t,c),c.signum()<0?c.add(t):c):c},n.prototype.pow=function(t){return this.exp(t,new w)},n.prototype.gcd=function(t){var e=this.s<0?this.negate():this.clone(),n=t.s<0?t.negate():t.clone();if(e.compareTo(n)<0){var i=e;e=n,n=i}var r=e.getLowestSetBit(),o=n.getLowestSetBit();if(o<0)return e;for(r<o&&(o=r),o>0&&(e.rShiftTo(o,e),n.rShiftTo(o,n));e.signum()>0;)(r=e.getLowestSetBit())>0&&e.rShiftTo(r,e),(r=n.getLowestSetBit())>0&&n.rShiftTo(r,n),e.compareTo(n)>=0?(e.subTo(n,e),e.rShiftTo(1,e)):(n.subTo(e,n),n.rShiftTo(1,n));return o>0&&n.lShiftTo(o,n),n},n.prototype.isProbablePrime=function(t){var e,n=this.abs();if(1==n.t&&n[0]<=z[z.length-1]){for(e=0;e<z.length;++e)if(n[0]==z[e])return!0;return!1}if(n.isEven())return!1;for(e=1;e<z.length;){for(var i=z[e],r=e+1;r<z.length&&i<A;)i*=z[r++];for(i=n.modInt(i);e<r;)if(i%z[e++]==0)return!1}return n.millerRabin(t)},n.prototype.square=function(){var t=i();return this.squareTo(t),t},n.prototype.Barrett=S,null==T){var I;if(T=new Array,D=0,"undefined"!=typeof window&&window.crypto)if(window.crypto.getRandomValues){var R=new Uint8Array(32);for(window.crypto.getRandomValues(R),I=0;I<32;++I)T[D++]=R[I]}else if("Netscape"==navigator.appName&&navigator.appVersion<"5"){var O=window.crypto.random(32);for(I=0;I<O.length;++I)T[D++]=255&O.charCodeAt(I)}for(;D<G;)I=Math.floor(65536*Math.random()),T[D++]=I>>>8,T[D++]=255&I;D=0,x()}function C(){if(null==k){for(x(),(k=new B).init(T),D=0;D<T.length;++D)T[D]=0;D=0}return k.next()}function M(){}function B(){this.i=0,this.j=0,this.S=new Array}M.prototype.nextBytes=function(t){var e;for(e=0;e<t.length;++e)t[e]=C()},B.prototype.init=function(t){var e,n,i;for(e=0;e<256;++e)this.S[e]=e;for(n=0,e=0;e<256;++e)n=n+this.S[e]+t[e%t.length]&255,i=this.S[e],this.S[e]=this.S[n],this.S[n]=i;this.i=0,this.j=0},B.prototype.next=function(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]};var G=256;t.exports={default:n,BigInteger:n,SecureRandom:M}}).call(R)});Ti.BigInteger,Ti.SecureRandom;function Di(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var zi=Ti.BigInteger;var Ai=function(){function t(){this.tlv=null,this.t="00",this.l="00",this.v=""}var e=t.prototype;return e.getEncodedHex=function(){return this.tlv||(this.v=this.getValue(),this.l=this.getLength(),this.tlv=this.t+this.l+this.v),this.tlv},e.getLength=function(){var t=this.v.length/2,e=t.toString(16);return e.length%2==1&&(e="0"+e),t<128?e:(128+e.length/2).toString(16)+e},e.getValue=function(){return""},t}(),xi=function(t){function e(e){var n;return(n=t.call(this)||this).t="02",e&&(n.v=function(t){var e=t.toString(16);if("-"!==e[0])e.length%2==1?e="0"+e:e.match(/^[0-7]/)||(e="00"+e);else{var n=(e=e.substr(1)).length;n%2==1?n+=1:e.match(/^[0-7]/)||(n+=2);for(var i="",r=0;r<n;r++)i+="f";e=(e=(i=new zi(i,16)).xor(t).add(zi.ONE)).toString(16).replace(/^-/,"")}return e}(e)),n}return Di(e,t),e.prototype.getValue=function(){return this.v},e}(Ai),Ii=function(t){function e(e){var n;return(n=t.call(this)||this).t="30",n.asn1Array=e,n}return Di(e,t),e.prototype.getValue=function(){return this.v=this.asn1Array.map(function(t){return t.getEncodedHex()}).join(""),this.v},e}(Ai);function Ri(t,e){return+t[e+2]<8?1:128&+t.substr(e+2,2)}function Oi(t,e){var n=Ri(t,e),i=t.substr(e+2,2*n);return i?(+i[0]<8?new zi(i,16):new zi(i.substr(2),16)).intValue():-1}function Ci(t,e){return e+2*(Ri(t,e)+1)}var Mi=function(t,e){var n=new xi(t),i=new xi(e);return new Ii([n,i]).getEncodedHex()},Bi=function(t){var e=Ci(t,0),n=Ci(t,e),i=Oi(t,e),r=t.substr(n,2*i),o=n+r.length,a=Ci(t,o),s=Oi(t,o),c=t.substr(a,2*s);return{r:new zi(r,16),s:new zi(c,16)}},Gi=Ti.BigInteger,Ui=new Gi("2"),Ni=new Gi("3"),Li=function(){function t(t,e){this.x=e,this.q=t}var e=t.prototype;return e.equals=function(t){return t===this||this.q.equals(t.q)&&this.x.equals(t.x)},e.toBigInteger=function(){return this.x},e.negate=function(){return new t(this.q,this.x.negate().mod(this.q))},e.add=function(e){return new t(this.q,this.x.add(e.toBigInteger()).mod(this.q))},e.subtract=function(e){return new t(this.q,this.x.subtract(e.toBigInteger()).mod(this.q))},e.multiply=function(e){return new t(this.q,this.x.multiply(e.toBigInteger()).mod(this.q))},e.divide=function(e){return new t(this.q,this.x.multiply(e.toBigInteger().modInverse(this.q)).mod(this.q))},e.square=function(){return new t(this.q,this.x.square().mod(this.q))},t}(),Pi=function(){function t(t,e,n,i){this.curve=t,this.x=e,this.y=n,this.z=null==i?Gi.ONE:i,this.zinv=null}var e=t.prototype;return e.getX=function(){return null===this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))},e.getY=function(){return null===this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))},e.equals=function(t){return t===this||(this.isInfinity()?t.isInfinity():t.isInfinity()?this.isInfinity():!!t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(Gi.ZERO)&&t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(Gi.ZERO))},e.isInfinity=function(){return null===this.x&&null===this.y||this.z.equals(Gi.ZERO)&&!this.y.toBigInteger().equals(Gi.ZERO)},e.negate=function(){return new t(this.curve,this.x,this.y.negate(),this.z)},e.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var n=this.x.toBigInteger(),i=this.y.toBigInteger(),r=this.z,o=e.x.toBigInteger(),a=e.y.toBigInteger(),s=e.z,c=this.curve.q,u=n.multiply(s).mod(c),h=o.multiply(r).mod(c),l=u.subtract(h),f=i.multiply(s).mod(c),p=a.multiply(r).mod(c),d=f.subtract(p);if(Gi.ZERO.equals(l))return Gi.ZERO.equals(d)?this.twice():this.curve.infinity;var g=u.add(h),m=r.multiply(s).mod(c),v=l.square().mod(c),_=l.multiply(v).mod(c),y=m.multiply(d.square()).subtract(g.multiply(v)).mod(c),b=l.multiply(y).mod(c),w=d.multiply(v.multiply(u).subtract(y)).subtract(f.multiply(_)).mod(c),E=_.multiply(m).mod(c);return new t(this.curve,this.curve.fromBigInteger(b),this.curve.fromBigInteger(w),E)},e.twice=function(){if(this.isInfinity())return this;if(!this.y.toBigInteger().signum())return this.curve.infinity;var e=this.x.toBigInteger(),n=this.y.toBigInteger(),i=this.z,r=this.curve.q,o=this.curve.a.toBigInteger(),a=e.square().multiply(Ni).add(o.multiply(i.square())).mod(r),s=n.shiftLeft(1).multiply(i).mod(r),c=n.square().mod(r),u=c.multiply(e).multiply(i).mod(r),h=s.square().mod(r),l=a.square().subtract(u.shiftLeft(3)).mod(r),f=s.multiply(l).mod(r),p=a.multiply(u.shiftLeft(2).subtract(l)).subtract(h.shiftLeft(1).multiply(c)).mod(r),d=s.multiply(h).mod(r);return new t(this.curve,this.curve.fromBigInteger(f),this.curve.fromBigInteger(p),d)},e.multiply=function(t){if(this.isInfinity())return this;if(!t.signum())return this.curve.infinity;for(var e=t.multiply(Ni),n=this.negate(),i=this,r=e.bitLength()-2;r>0;r--){i=i.twice();var o=e.testBit(r);o!==t.testBit(r)&&(i=i.add(o?this:n))}return i},t}(),Fi=function(){function t(t,e,n){this.q=t,this.a=this.fromBigInteger(e),this.b=this.fromBigInteger(n),this.infinity=new Pi(this,null,null)}var e=t.prototype;return e.equals=function(t){return t===this||this.q.equals(t.q)&&this.a.equals(t.a)&&this.b.equals(t.b)},e.fromBigInteger=function(t){return new Li(this.q,t)},e.decodePointHex=function(t){switch(parseInt(t.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:var e=this.fromBigInteger(new Gi(t.substr(2),16)),n=this.fromBigInteger(e.multiply(e.square()).add(e.multiply(this.a)).add(this.b).toBigInteger().modPow(this.q.divide(new Gi("4")).add(Gi.ONE),this.q));return n.toBigInteger().mod(Ui).equals(new Gi(t.substr(0,2),16).subtract(Ui))||(n=n.negate()),new Pi(this,e,n);case 4:case 6:case 7:var i=(t.length-2)/2,r=t.substr(2,i),o=t.substr(i+2,i);return new Pi(this,this.fromBigInteger(new Gi(r,16)),this.fromBigInteger(new Gi(o,16)));default:return null}},t}(),qi={ECPointFp:Pi,ECCurveFp:Fi},ji=Ti.BigInteger,Ki=Ti.SecureRandom,Vi=qi.ECCurveFp,Hi=new Ki,Ji=$i(),Zi=Ji.curve,Wi=Ji.G,Xi=Ji.n;function $i(){var t=new ji("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFF",16),e=new ji("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFC",16),n=new ji("28E9FA9E9D9F5E344D5A9E4BCF6509A7F39789F515AB8F92DDBCBD414D940E93",16),i=new Vi(t,e,n),r=i.decodePointHex("0432C4AE2C1F1981195F9904466A39C9948FE30BBFF2660BE1715A4589334C74C7BC3736A2F4F6779C59BDCEE36B692153D0A9877CC62A474002DF32E52139F0A0");return{curve:i,G:r,n:new ji("FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFF7203DF6B21C6052B53BBF40939D54123",16)}}function Yi(t,e){return t.length>=e?t:new Array(e-t.length+1).join("0")+t}var Qi={getGlobalCurve:function(){return Zi},generateEcparam:$i,generateKeyPairHex:function(t,e,n){var i=(t?new ji(t,e,n):new ji(Xi.bitLength(),Hi)).mod(Xi.subtract(ji.ONE)).add(ji.ONE),r=Yi(i.toString(16),64),o=Wi.multiply(i);return{privateKey:r,publicKey:"04"+Yi(o.getX().toBigInteger().toString(16),64)+Yi(o.getY().toBigInteger().toString(16),64)}},compressPublicKeyHex:function(t){if(130!==t.length)throw new Error("Invalid public key to compress");var e=(t.length-2)/2,n=t.substr(2,e),i="03";return new ji(t.substr(e+2,e),16).mod(new ji("2")).equals(ji.ZERO)&&(i="02"),i+n},utf8ToHex:function(t){for(var e=(t=unescape(encodeURIComponent(t))).length,n=[],i=0;i<e;i++)n[i>>>2]|=(255&t.charCodeAt(i))<<24-i%4*8;for(var r=[],o=0;o<e;o++){var a=n[o>>>2]>>>24-o%4*8&255;r.push((a>>>4).toString(16)),r.push((15&a).toString(16))}return r.join("")},leftPad:Yi,arrayToHex:function(t){return t.map(function(t){return 1===(t=t.toString(16)).length?"0"+t:t}).join("")},arrayToUtf8:function(t){for(var e=[],n=0,i=0;i<2*t.length;i+=2)e[i>>>3]|=parseInt(t[n],10)<<24-i%8*4,n++;try{for(var r=[],o=0;o<t.length;o++){var a=e[o>>>2]>>>24-o%4*8&255;r.push(String.fromCharCode(a))}return decodeURIComponent(escape(r.join("")))}catch(t){throw new Error("Malformed UTF-8 data")}},hexToArray:function(t){var e=[],n=t.length;n%2!=0&&(t=Yi(t,n+1)),n=t.length;for(var i=0;i<n;i+=2)e.push(parseInt(t.substr(i,2),16));return e},verifyPublicKey:function(t){var e=Zi.decodePointHex(t);if(!e)return!1;var n=e.getX();return e.getY().square().equals(n.multiply(n.square()).add(n.multiply(Zi.a)).add(Zi.b))},comparePublicKeyHex:function(t,e){var n=Zi.decodePointHex(t);if(!n)return!1;var i=Zi.decodePointHex(e);return!!i&&n.equals(i)}},tr=new Uint32Array(68),er=new Uint32Array(64);function nr(t,e){var n=31&e;return t<<n|t>>>32-n}function ir(t){return t^nr(t,9)^nr(t,17)}function rr(t){var e=8*t.length,n=e%512;n=n>=448?512-n%448-1:448-n-1;for(var i=new Array((n-7)/8),r=new Array(8),o=0,a=i.length;o<a;o++)i[o]=0;for(var s=0,c=r.length;s<c;s++)r[s]=0;e=e.toString(2);for(var u=7;u>=0;u--)if(e.length>8){var h=e.length-8;r[u]=parseInt(e.substr(h),2),e=e.substr(0,h)}else e.length>0&&(r[u]=parseInt(e,2),e="");for(var l,f=new Uint8Array([].concat(t,[128],i,r)),p=new DataView(f.buffer,0),d=f.length/64,g=new Uint32Array([1937774191,1226093241,388252375,3666478592,2842636476,372324522,3817729613,2969243214]),m=0;m<d;m++){tr.fill(0),er.fill(0);for(var v=16*m,_=0;_<16;_++)tr[_]=p.getUint32(4*(v+_),!1);for(var y=16;y<68;y++)tr[y]=(l=tr[y-16]^tr[y-9]^nr(tr[y-3],15))^nr(l,15)^nr(l,23)^nr(tr[y-13],7)^tr[y-6];for(var b=0;b<64;b++)er[b]=tr[b]^tr[b+4];for(var w=g[0],E=g[1],S=g[2],k=g[3],T=g[4],D=g[5],z=g[6],A=g[7],x=void 0,I=void 0,R=void 0,O=void 0,C=0;C<64;C++)O=C>=0&&C<=15?2043430169:2055708042,I=(C>=0&&C<=15?w^E^S:w&E|w&S|E&S)+k+((x=nr(nr(w,12)+T+nr(O,C),7))^nr(w,12))+er[C],R=(C>=0&&C<=15?T^D^z:T&D|~T&z)+A+x+tr[C],k=S,S=nr(E,9),E=w,w=I,A=z,z=nr(D,19),D=T,T=ir(R);g[0]^=w,g[1]^=E,g[2]^=S,g[3]^=k,g[4]^=T,g[5]^=D,g[6]^=z,g[7]^=A}for(var M=[],B=0,G=g.length;B<G;B++){var U=g[B];M.push((4278190080&U)>>>24,(16711680&U)>>>16,(65280&U)>>>8,255&U)}return M}for(var or=64,ar=new Uint8Array(or),sr=new Uint8Array(or),cr=0;cr<or;cr++)ar[cr]=54,sr[cr]=92;var ur=rr,hr=Ti.BigInteger,lr=Mi,fr=Bi,pr=ur,dr=Qi.generateEcparam(),gr=dr.G,mr=dr.curve,vr=dr.n,_r=0;function yr(t,e,n){void 0===n&&(n="1234567812345678"),n=Qi.utf8ToHex(n);var i,r,o=Qi.leftPad(gr.curve.a.toBigInteger().toRadix(16),64),a=Qi.leftPad(gr.curve.b.toBigInteger().toRadix(16),64),s=Qi.leftPad(gr.getX().toBigInteger().toRadix(16),64),c=Qi.leftPad(gr.getY().toBigInteger().toRadix(16),64);if(128===e.length)i=e.substr(0,64),r=e.substr(64,64);else{var u=gr.curve.decodePointHex(e);i=Qi.leftPad(u.getX().toBigInteger().toRadix(16),64),r=Qi.leftPad(u.getY().toBigInteger().toRadix(16),64)}var h=Qi.hexToArray(n+o+a+s+c+i+r),l=4*n.length;h.unshift(255&l),h.unshift(l>>8&255);var f=pr(h);return Qi.arrayToHex(pr(f.concat(Qi.hexToArray(t))))}function br(){var t=Qi.generateKeyPairHex(),e=mr.decodePointHex(t.publicKey);return t.k=new hr(t.privateKey,16),t.x1=e.getX().toBigInteger(),t}var wr={generateKeyPairHex:Qi.generateKeyPairHex,compressPublicKeyHex:Qi.compressPublicKeyHex,comparePublicKeyHex:Qi.comparePublicKeyHex,doEncrypt:function(t,e,n){void 0===n&&(n=1),t="string"==typeof t?Qi.hexToArray(Qi.utf8ToHex(t)):Array.prototype.slice.call(t),e=Qi.getGlobalCurve().decodePointHex(e);var i=Qi.generateKeyPairHex(),r=new hr(i.privateKey,16),o=i.publicKey;o.length>128&&(o=o.substr(o.length-128));var a=e.multiply(r),s=Qi.hexToArray(Qi.leftPad(a.getX().toBigInteger().toRadix(16),64)),c=Qi.hexToArray(Qi.leftPad(a.getY().toBigInteger().toRadix(16),64)),u=Qi.arrayToHex(pr([].concat(s,t,c))),h=1,l=0,f=[],p=[].concat(s,c),d=function(){f=pr([].concat(p,[h>>24&255,h>>16&255,h>>8&255,255&h])),h++,l=0};d();for(var g=0,m=t.length;g<m;g++)l===f.length&&d(),t[g]^=255&f[l++];var v=Qi.arrayToHex(t);return n===_r?o+v+u:o+u+v},doDecrypt:function(t,e,n,i){void 0===n&&(n=1);var r=(void 0===i?{}:i).output,o=void 0===r?"string":r;e=new hr(e,16);var a=t.substr(128,64),s=t.substr(192);n===_r&&(a=t.substr(t.length-64),s=t.substr(128,t.length-128-64));var c=Qi.hexToArray(s),u=Qi.getGlobalCurve().decodePointHex("04"+t.substr(0,128)).multiply(e),h=Qi.hexToArray(Qi.leftPad(u.getX().toBigInteger().toRadix(16),64)),l=Qi.hexToArray(Qi.leftPad(u.getY().toBigInteger().toRadix(16),64)),f=1,p=0,d=[],g=[].concat(h,l),m=function(){d=pr([].concat(g,[f>>24&255,f>>16&255,f>>8&255,255&f])),f++,p=0};m();for(var v=0,_=c.length;v<_;v++)p===d.length&&m(),c[v]^=255&d[p++];return Qi.arrayToHex(pr([].concat(h,c,l)))===a.toLowerCase()?"array"===o?c:Qi.arrayToUtf8(c):"array"===o?[]:""},doSignature:function(t,e,n){var i=void 0===n?{}:n,r=i.pointPool,o=i.der,a=i.hash,s=i.publicKey,c=i.userId,u="string"==typeof t?Qi.utf8ToHex(t):Qi.arrayToHex(t);a&&(u=yr(u,s=s||function(t){var e=gr.multiply(new hr(t,16)),n=Qi.leftPad(e.getX().toBigInteger().toString(16),64),i=Qi.leftPad(e.getY().toBigInteger().toString(16),64);return"04"+n+i}(e),c));var h=new hr(e,16),l=new hr(u,16),f=null,p=null,d=null;do{do{var g=void 0;f=(g=r&&r.length?r.pop():br()).k,p=l.add(g.x1).mod(vr)}while(p.equals(hr.ZERO)||p.add(f).equals(vr));d=h.add(hr.ONE).modInverse(vr).multiply(f.subtract(p.multiply(h))).mod(vr)}while(d.equals(hr.ZERO));return o?lr(p,d):Qi.leftPad(p.toString(16),64)+Qi.leftPad(d.toString(16),64)},doVerifySignature:function(t,e,n,i){var r,o,a=void 0===i?{}:i,s=a.der,c=a.hash,u=a.userId,h="string"==typeof t?Qi.utf8ToHex(t):Qi.arrayToHex(t);if(c&&(h=yr(h,n,u)),s){var l=fr(e);r=l.r,o=l.s}else r=new hr(e.substring(0,64),16),o=new hr(e.substring(64),16);var f=mr.decodePointHex(n),p=new hr(h,16),d=r.add(o).mod(vr);if(d.equals(hr.ZERO))return!1;var g=gr.multiply(o).add(f.multiply(d)),m=p.add(g.getX().toBigInteger()).mod(vr);return r.equals(m)},getPoint:br,verifyPublicKey:Qi.verifyPublicKey},Er=function(){function t(){}return t.prototype.doEncrypt=function(t,e,n){return void 0===n&&(n=1),"04"+wr.doEncrypt(t,e,n)},t}();var Sr=function(){function n(t){this.disableAutoPageView=!1,this.bridgeReport=!1,this.staging=!1,this.pluginInstances=[],this.sended=!1,this.started=!1,this.destroyInstance=!1,this.adapters={},this.sdkReady=!1,this.name=t,this.hook=new c(this),this.logger=new ot(t),this.remotePlugin=new Map,this.Types=Y,this.adapters.fetch=ct,this.adapters.storage=V}return n.usePlugin=function(t,e,i){if(e){for(var r=!1,o=0,a=n.plugins.length;o<a;o++){if(n.plugins[o].name===e){n.plugins[o].plugin=t,n.plugins[o].options=i||{},r=!0;break}}r||n.plugins.push({name:e,plugin:t,options:i})}else n.plugins.push({plugin:t})},n.prototype.usePlugin=function(t,e,n){t&&(this.remotePlugin.get(t)?console.info("your sdk version has ".concat(t," already ~")):e?"string"==typeof e?this.remotePlugin.get(t)||this.remotePlugin.set(t,{src:e,call:n}):this.remotePlugin.get(t)||this.remotePlugin.set(t,{instance:e}):this.remotePlugin.get(t)||this.remotePlugin.set(t,"sdk"))},n.prototype.init=function(t){var e=this;this.logger.enable(t.log),this.getApp=new ki(this,t);var i=this.getApp.getAppId();if(t.app_id=i,this.inited)this.logger.log("init can be call only one time");else{if(!t||!u(t))return this.logger.warn("init params error,please check"),void this.hook.emit(Y.SDKFail,{message:"init params error,please check;"});if(!i||("number"!=typeof(r=i)||isNaN(r)))return this.logger.warn("app_id param is error, must be number, please check!"),void this.hook.emit(Y.SDKFail,{message:"app_id param is error, must be number, please check!"});var r;if(t.app_key&&!function(t){return"string"==typeof t}(t.app_key))return this.logger.warn("app_key param is error, must be string, please check!"),void this.hook.emit(Y.SDKFail,{message:"app_key param is error, must be string, please check!"});if(t.channel_domain||-1!==["cn","sg","va"].indexOf(t.channel)||(this.logger.warn("channel must be `cn`, `sg`,`va` !!!"),t.channel="cn"),this.emit(Y.MonitorConfig,{initConfig:t}),this.configManager=new rt(this,t),this.appBridge=new at(t,this.configManager),this.bridgeReport=this.appBridge.bridgeInject(),this.requestManager=new _i(this,t),this.logSetting=new wi,this.initConfig=t,this.env=t.channel_domain?"self":"public",this.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK Init",data:t,level:"info",time:Date.now(),infoType:"cus"}),t.disable_auto_pv&&(this.disableAutoPageView=!0),this.bridgeReport){try{n.plugins.length&&n.plugins.reduce(function(t,n){var i=n.plugin,r=n.options;if("stay"===(null==n?void 0:n.name)||"autotrack"===(null==n?void 0:n.name)){var o=Object.assign(e.initConfig,r),a=new i;a.apply(e,o),t.push(a)}return t},this.pluginInstances)}catch(t){this.logger.log("load plugin error, ".concat(t.message)),this.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK",level:"error",time:Date.now(),data:t.message,infoType:"sdk"}),this.emit(Y.SDKException,{error:(null==t?void 0:t.message)||"sdk load plugin something error"})}this.inited=!0,this.emit(Y.Init)}else t.enable_encryption&&"sm"===t.encryption_type&&this.initCrypto(),this.configManager.set({app_id:t.app_id}),this.eventManager=new gt,this.tokenManager=new vt,this.sessionManager=new pt,this.profileManager=new yi,Promise.all([new Promise(function(t){e.once(Y.TokenComplete,function(){t(!0)})}),new Promise(function(t){e.once(Y.Start,function(){t(!0)})}),new Promise(function(t){e.once(Y.LogSettingReady,function(){t(!0)})})]).then(function(){e.ready(t)}).catch(function(t){console.log(t)}),this.logSetting.apply(this,t),this.tokenManager.apply(this,t),this.eventManager.apply(this,t),this.sessionManager.apply(this,t),this.initConfig.tracer_appId&&new Si(this,this.initConfig),this.inited=!0,this.emit(Y.Init)}},n.prototype.ready=function(t){var e=this;try{n.plugins.length&&n.plugins.reduce(function(t,n){var i=n.plugin,r=n.options,o=Object.assign(e.initConfig,r),a=new i;return a.apply(e,o),t.push(a),e.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK".concat(n.name,""),level:"info",time:Date.now(),infoType:"sdk"}),t},this.pluginInstances)}catch(t){this.logger.log("load plugin error, ".concat(t.message)),this.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK",level:"error",time:Date.now(),data:t.message,infoType:"sdk"}),this.emit(Y.SDKException,{error:(null==t?void 0:t.message)||"sdk load plugin something error"})}try{this.sdkReady=!0,this.emit(Y.Ready,{userInfo:this.configManager.get("user")}),this.emit(Y.CloudReady,{userInfo:this.configManager.get("user")}),this.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK ",time:Date.now(),secType:"USER",level:"info",data:this.configManager.get("user"),infoType:"sdk"}),this.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK ",time:Date.now(),level:"info",data:this.configManager.get("user"),infoType:"sdk"}),this.logger.info("appid: ".concat(t.app_id,", userInfo:").concat(JSON.stringify(this.configManager.get("user")))),this.logger.info("appid: ".concat(t.app_id,", sdk is ready, version is ").concat(J,", you can report now !!!")),this.profileManager.apply(this,t);try{(window.opener||window.parent).postMessage("[tea-sdk]ready","*")}catch(t){this.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK",level:"error",time:Date.now(),data:t.message,infoType:"sdk"})}this.pageView(),this.on(Y.TokenChange,function(n){"webid"!==n.type&&"anonymous_id"!==n.type||e.pageView(),e.logger.info("appid: ".concat(t.app_id," token change, new userInfo:").concat(JSON.stringify(e.configManager.get("user")))),e.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK ",time:Date.now(),secType:"USER",level:"info",data:e.configManager.get("user"),infoType:"sdk"})}),this.on(Y.TokenReset,function(){e.logger.info("appid: ".concat(t.app_id," token reset, new userInfo:").concat(JSON.stringify(e.configManager.get("user")))),e.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK ",time:Date.now(),secType:"USER",level:"info",data:e.configManager.get("user"),infoType:"sdk"})}),this.on(Y.RouteChange,function(n){n.init||t.disable_route_report||e.pageView(n.config)}),this.on(Y.ReStart,function(){e.pageView()})}catch(t){this.emit(Y.SDKFail,{message:(null==t?void 0:t.message)||"sdk init ready fail."}),this.emit(Y.SDKException,{error:(null==t?void 0:t.message)||"sdk load plugin something error"})}},n.prototype.config=function(n){if(this.inited)if(n&&u(n))if(this.bridgeReport)this.appBridge.setConfig(n);else{n._staging_flag&&1===n._staging_flag&&(this.staging=!0),n.disable_auto_pv&&(this.disableAutoPageView=!0,delete n.disable_auto_pv);var i=t({},n);if(this.initConfig&&this.initConfig.configPersist){var r=this.configManager.getStore();r&&(i=Object.assign(r,n)),this.configManager.setStore(n)}i.web_id,i.user_unique_id;var o=e(i,["web_id","user_unique_id"]);i.hasOwnProperty("web_id")&&this.emit(Y.ConfigWebId,i.web_id),i.hasOwnProperty("user_unique_id")&&this.emit(Y.ConfigUuid,i.user_unique_id),i.hasOwnProperty("user_unique_id_type")&&this.emit(Y.ConfigUuidType,i.user_unique_id_type),this.configManager.set(o),this.emit(Y.ConfigTransform,i),this.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK Config",level:"info",time:Date.now(),data:i,infoType:"cus"})}else this.logger.warn("config params is error, please check");else this.logger.warn("config must be use after function init")},n.prototype.setUserUniqueID=function(t){this.config({user_unique_id:t})},n.prototype.setHeaderInfo=function(t,e){var n={};n[t]=e,this.config(n)},n.prototype.removeHeaderInfo=function(t){var e={};e[t]=void 0,this.config(e)},n.prototype.setDomain=function(t){this.configManager&&this.configManager.setDomain(t),this.emit(Y.ConfigDomain)},n.prototype.getConfig=function(t){return this.configManager.get(t)},n.prototype.send=function(){this.start()},n.prototype.start=function(){this.inited&&!this.sended&&(this.sended=!0,this.emit(Y.Start),this.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK Start",level:"info",time:Date.now(),infoType:"cus"}),this.bridgeReport&&(this.pageView(),this.emit(Y.Ready)))},n.prototype.event=function(t,e){var n=this;try{if(this.initConfig&&this.initConfig.disable_track_event)return;var i=[];if(Array.isArray(t))t.forEach(function(t){var e=n.processEvent(t[0],t[1]||{});e&&i.push(e)});else{var r=this.processEvent(t,e);if(!r)return;i.push(r)}this.bridgeReport?i.forEach(function(t){var e=t.event,i=t.params;n.appBridge.onEventV3(e,JSON.stringify(i))}):i.length&&(this.emit(Y.Event,i),this.emit(Y.SessionResetTime)),this.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK Event",level:"info",time:Date.now(),data:t,infoType:"cus"})}catch(t){this.logger.warn("something error, please check"),this.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK Event",level:"error",time:Date.now(),data:t.message,infoType:"sdk"}),this.emit(Y.SDKException,{error:(null==t?void 0:t.message)||"sdk event api something error"})}},n.prototype.beconEvent=function(t,e){var n=this;try{if(this.initConfig&&this.initConfig.disable_track_event)return;if(Array.isArray(t))return void console.warn("beconEvent not support batch report, please check");var i=[],r=this.processEvent(t,e||{});if(!r)return;i.push(r),this.bridgeReport?i.forEach(function(t){var e=t.event,i=t.params;n.appBridge.onEventV3(e,JSON.stringify(i))}):i.length&&(this.emit(Y.BeconEvent,i),this.emit(Y.SessionResetTime)),this.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK Beacon Event",level:"info",time:Date.now(),data:t,infoType:"sdk"})}catch(t){this.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK Beacon Event",level:"error",time:Date.now(),data:t.message,infoType:"sdk"}),this.emit(Y.SDKException,{error:(null==t?void 0:t.message)||"sdk beaconevent api something error"})}},n.prototype.beaconEvent=function(t,e){this.beconEvent(t,e)},n.prototype.processEvent=function(t,e){void 0===e&&(e={});try{if(!t)return this.logger.warn("eventName is null please check"),null;var n=t;/^event\./.test(t)&&(n=t.slice(6));var i=e;"object"!=typeof i&&(i={}),i.profile?delete i.profile:i.event_index=d();var r=void 0;return i.local_ms?(r=i.local_ms,delete i.local_ms):r=+new Date,{event:n,params:i,local_time_ms:r,is_bav:this.initConfig&&this.initConfig.autotrack?1:0}}catch(n){return this.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK",level:"error",time:Date.now(),data:n.message,infoType:"sdk"}),this.emit(Y.SDKException,{error:(null==n?void 0:n.message)||"sdk processEvent has something error"}),{event:t,params:e}}},n.prototype.dynamicParams=function(t){this.dynamicParamsFilter=t},n.prototype.filterEvent=function(t){this.eventFilter=t},n.prototype.on=function(t,e){this.hook.on(t,e)},n.prototype.once=function(t,e){this.hook.once(t,e)},n.prototype.off=function(t,e){this.hook.off(t,e)},n.prototype.emit=function(t,e,n){this.hook.emit(t,e,n)},n.prototype.set=function(t){this.hook.set(t)},n.prototype.pageView=function(t){this.disableAutoPageView||this.predefinePageView(t)},n.prototype.predefinePageView=function(e){if(void 0===e&&(e={}),this.inited){var n={title:document.title||location.pathname,url:location.href,url_path:this.handlePath(),time:Date.now(),referrer:window.document.referrer,$is_first_time:"".concat(this.configManager&&this.configManager.is_first_time||!1)},i=t(t({},n),e);this.event("predefine_pageview",i),this.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK PV",level:"info",time:Date.now(),infoType:"sdk"})}else console.warn("predefinePageView should call after init")},n.prototype.handlePath=function(){var t=location.pathname;try{if(this.initConfig.allow_hash){var e=new URL(location.href).hash.match(/#\/([^?#]+)/i);return e&&e.length?e[1]:location.pathname}}catch(e){t=location.pathname}return t},n.prototype.clearEventCache=function(){this.emit(Y.CleanEvents)},n.prototype.setWebIDviaUnionID=function(t){if(t){var e=T(t);this.config({web_id:"".concat(e),wechat_unionid:t}),this.emit(Y.CustomWebId)}},n.prototype.setWebIDviaOpenID=function(t){if(t){var e=T(t);this.config({web_id:"".concat(e),wechat_openid:t}),this.emit(Y.CustomWebId)}},n.prototype.setAnonymousId=function(t){this.emit(Y.AnonymousId,t)},n.prototype.setNativeAppId=function(t){this.bridgeReport&&this.appBridge.setNativeAppId(t)},n.prototype.setRequestHeaders=function(t){this.emit(Y.CustomHeader,t)},n.prototype.resetStayDuration=function(t,e,n){void 0===t&&(t=""),void 0===e&&(e=""),void 0===n&&(n=""),this.emit(Y.ResetStay,{url_path:t,title:e,url:n},Y.Stay)},n.prototype.resetStayParams=function(t,e,n){void 0===t&&(t=""),void 0===e&&(e=""),void 0===n&&(n=""),this.emit(Y.SetStay,{url_path:t,title:e,url:n},Y.Stay)},n.prototype.getToken=function(e,n){var i=this;if(this.inited){var r=!1,o=function(n){if(!r){r=!0;var o=i.configManager.get().user;return n&&(o.tobid=n,o["diss".split("").reverse().join("")]=n),e(t({},o))}},a=function(){i.tokenManager.getTobId(function(t){o(t)})};this.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK GetToken",level:"info",time:Date.now(),infoType:"cus"}),this.sdkReady?a():(n&&setTimeout(function(){o()},n),this.on(Y.Ready,function(){a()}))}else this.logger.warn("getToken must be use after function init")},n.prototype.bindToken=function(t,e,n){this.sdkStop=!0,this.emit(Y.BindToken,{params:t,callback:e,retry:n})},n.prototype.setResourceEvent=function(t){this.emit(Y.SetResource,t)},n.prototype.startTrackEvent=function(t){t&&this.emit(Y.TrackDurationStart,t,Y.TrackDuration)},n.prototype.endTrackEvent=function(t,e){void 0===e&&(e={}),t&&this.emit(Y.TrackDurationEnd,{eventName:t,params:e},Y.TrackDuration)},n.prototype.pauseTrackEvent=function(t){t&&this.emit(Y.TrackDurationPause,t,Y.TrackDuration)},n.prototype.resumeTrackEvent=function(t){t&&this.emit(Y.TrackDurationResume,t,Y.TrackDuration)},n.prototype.profileSet=function(t){this.bridgeReport?this.appBridge.profileSet(JSON.stringify(t)):this.emit(Y.ProfileSet,t,Y.Profile),this.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK profileSet",level:"info",time:Date.now(),data:t,infoType:"cus"})},n.prototype.profileSetOnce=function(t){this.bridgeReport?this.appBridge.profileSetOnce(JSON.stringify(t)):this.emit(Y.ProfileSetOnce,t,Y.Profile),this.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK profileSetOnce",level:"info",time:Date.now(),data:t,infoType:"cus"})},n.prototype.profileIncrement=function(t){this.bridgeReport?this.appBridge.profileIncrement(JSON.stringify(t)):this.emit(Y.ProfileIncrement,t,Y.Profile),this.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK profileIncrement",level:"info",time:Date.now(),data:t,infoType:"cus"})},n.prototype.profileUnset=function(t){this.bridgeReport?this.appBridge.profileUnset(t):this.emit(Y.ProfileUnset,t,Y.Profile),this.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK profileUnset",level:"info",time:Date.now(),data:t,infoType:"cus"})},n.prototype.profileAppend=function(t){this.bridgeReport?this.appBridge.profileAppend(JSON.stringify(t)):this.emit(Y.ProfileAppend,t,Y.Profile),this.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK profileAppend",level:"info",time:Date.now(),data:t,infoType:"cus"})},n.prototype.setExternalAbVersion=function(t){this.bridgeReport?this.appBridge.setExternalAbVersion(t):this.emit(Y.AbExternalVersion,"string"==typeof t&&t?"".concat(t).trim():null,Y.Ab)},n.prototype.getVar=function(t,e,n){this.bridgeReport?this.appBridge.getVar(t,e,n):this.emit(Y.AbVar,{name:t,defaultValue:e,callback:n},Y.Ab)},n.prototype.getAllVars=function(t){this.bridgeReport?this.appBridge.getAllVars(t):this.emit(Y.AbAllVars,t,Y.Ab)},n.prototype.getABconfig=function(t,e){this.emit(Y.AbConfig,{params:t,callback:e},Y.Ab)},n.prototype.getAbSdkVersion=function(t){if(!this.bridgeReport||!t)return this.configManager.getAbVersion()||"";this.appBridge.getAbSdkVersion(t)},n.prototype.onAbSdkVersionChange=function(t){var e=this;return this.emit(Y.AbVersionChangeOn,t,Y.Ab),function(){e.emit(Y.AbVersionChangeOff,t,Y.Ab)}},n.prototype.offAbSdkVersionChange=function(t){this.emit(Y.AbVersionChangeOff,t,Y.Ab)},n.prototype.openOverlayer=function(){this.emit(Y.AbOpenLayer,"",Y.Ab)},n.prototype.closeOverlayer=function(){this.emit(Y.AbCloseLayer,"",Y.Ab)},n.prototype.initCrypto=function(){this.publicKey=this.initConfig.crypto_publicKey||"04BA9E229380DC0E41E10839B0C52A4763D3EDFE8903F3B8E81395523381E03AA995D295BD4A4088792E4785B224F7837EB4D2C7C05973C7AE8687A35ACAE470A0"},n.prototype.cryptoData=function(t){try{if(this.initConfig.enable_encryption&&"sm"===this.initConfig.encryption_type&&!D()){var e=void 0;e=(new Er).doEncrypt(JSON.stringify(t),this.publicKey,1);var n=I(e);return(e=new Uint8Array(n)).buffer||e}return t}catch(e){return console.log("",e),this.emit(Y.SDKException,{error:(null==e?void 0:e.message)||"sdk crypto data something error"}),t}},n.prototype.stop=function(){this.sdkStop=!0},n.prototype.reStart=function(){this.sdkStop=!1,this.emit(Y.ReStart)},n.prototype.destoryInstace=function(){this.destroyInstance||(this.destroyInstance=!0,this.off(Y.TokenComplete))},n.prototype.destoryInstance=function(){this.destroyInstance||(this.destroyInstance=!0,this.off(Y.TokenComplete))},n.prototype.setExposureType=function(t){this.emit(Y.SetExposureType,t)},n.plugins=[],n}(),kr={},Tr=[],Dr=function(t){t.length&&t.forEach(function(t){Tr.push(t)})},zr=function(t,e,n,i){var r=t&&t.source||window.opener||window.parent,o=t&&t.origin||i||"*",a={type:e,payload:n};r.postMessage(JSON.stringify(a),o)},Ar=function(t,e){kr[t]=kr[t]||[],kr[t].push(e)},xr=function(t){if(Tr.some(function(t){return"*"===t})||Tr.some(function(e){return t.origin.indexOf(e)>-1})){var e=t.data;if("string"==typeof t.data)try{e=JSON.parse(t.data)}catch(t){e=void 0}if(!e)return;var n=e.type,i=e.payload;kr[n]&&kr[n].forEach(function(e){"function"==typeof e&&e(t,i)})}},Ir=function(t,e){var n={};if(Object.keys(t).length)for(var i in t){if("filter"===i||"autotrack"===i||"enable_stay_duration"===i)break;n[i]=t[i]}(window.opener||window.parent).postMessage({type:"tea:sdk:info",config:n,version:e},location.origin),window.addEventListener("message",xr,!1)},Rr="__applog_ab_style__",Or="",Cr=!1;function Mr(t){var e=t.event,n=t.editorUrl;t.collectInstance,t.fromSession;Cr||(Cr=!0,y(n,function(){zr(e,"abEditorScriptloadSuccess")},function(){e&&zr(e,"abEditorScriptloadError"),Cr=!1}))}var Br;!function(t){var e=function(){try{return!!Symbol.iterator}catch(t){return!1}}(),n=function(t){var n={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return e&&(n[Symbol.iterator]=function(){return n}),n},i=function(t){return encodeURIComponent(t).replace(/%20/g,"+")},r=function(t){return decodeURIComponent(String(t).replace(/\+/g," "))};(function(){try{var e=t.URLSearchParams;return"a=1"===new e("?a=1").toString()&&"function"==typeof e.prototype.set&&"function"==typeof e.prototype.entries}catch(e){return!1}})()||function(){var r=function t(e){Object.defineProperty(this,"_entries",{writable:!0,value:{}});var n=typeof e;if("undefined"===n);else if("string"===n)""!==e&&this._fromString(e);else if(e instanceof t){var i=this;e.forEach(function(t,e){i.append(e,t)})}else{if(null===e||"object"!==n)throw new TypeError("Unsupported input's type for URLSearchParams");if("[object Array]"===Object.prototype.toString.call(e))for(var r=0;r<e.length;r++){var o=e[r];if("[object Array]"!==Object.prototype.toString.call(o)&&2===o.length)throw new TypeError("Expected [string, any] as entry at index "+r+" of URLSearchParams's input");this.append(o[0],o[1])}else for(var a in e)e.hasOwnProperty(a)&&this.append(a,e[a])}},o=r.prototype;o.append=function(t,e){t in this._entries?this._entries[t].push(String(e)):this._entries[t]=[String(e)]},o.delete=function(t){delete this._entries[t]},o.get=function(t){return t in this._entries?this._entries[t][0]:null},o.getAll=function(t){return t in this._entries?this._entries[t].slice(0):[]},o.has=function(t){return t in this._entries},o.set=function(t,e){this._entries[t]=[String(e)]},o.forEach=function(t,e){var n;for(var i in this._entries)if(this._entries.hasOwnProperty(i)){n=this._entries[i];for(var r=0;r<n.length;r++)t.call(e,n[r],i,this)}},o.keys=function(){var t=[];return this.forEach(function(e,n){t.push(n)}),n(t)},o.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),n(t)},o.entries=function(){var t=[];return this.forEach(function(e,n){t.push([n,e])}),n(t)},e&&(o[Symbol.iterator]=o.entries),o.toString=function(){var t=[];return this.forEach(function(e,n){t.push(i(n)+"="+i(e))}),t.join("&")},t.URLSearchParams=r}();var o=t.URLSearchParams.prototype;"function"!=typeof o.sort&&(o.sort=function(){var t=this,e=[];this.forEach(function(n,i){e.push([i,n]),t._entries||t.delete(i)}),e.sort(function(t,e){return t[0]<e[0]?-1:t[0]>e[0]?1:0}),t._entries&&(t._entries={});for(var n=0;n<e.length;n++)this.append(e[n][0],e[n][1])}),"function"!=typeof o._fromString&&Object.defineProperty(o,"_fromString",{enumerable:!1,configurable:!1,writable:!1,value:function(t){if(this._entries)this._entries={};else{var e=[];this.forEach(function(t,n){e.push(n)});for(var n=0;n<e.length;n++)this.delete(e[n])}var i,o=(t=t.replace(/^\?/,"")).split("&");for(n=0;n<o.length;n++)i=o[n].split("="),this.append(r(i[0]),i.length>1?r(i[1]):"")}})}(void 0!==R?R:"undefined"!=typeof window?window:"undefined"!=typeof self?self:R),function(t){if(function(){try{var e=new t.URL("b","http://a");return e.pathname="c d","http://a/c%20d"===e.href&&e.searchParams}catch(e){return!1}}()||function(){var e=t.URL,n=function e(n,i){"string"!=typeof n&&(n=String(n)),i&&"string"!=typeof i&&(i=String(i));var r,o=document;if(i&&(void 0===t.location||i!==t.location.href)){i=i.toLowerCase(),(r=(o=document.implementation.createHTMLDocument("")).createElement("base")).href=i,o.head.appendChild(r);try{if(0!==r.href.indexOf(i))throw new Error(r.href)}catch(e){throw new Error("URL unable to set base "+i+" due to "+e)}}var a=o.createElement("a");a.href=n,r&&(o.body.appendChild(a),a.href=a.href);var s=o.createElement("input");if(s.type="url",s.value=n,":"===a.protocol||!/:/.test(a.href)||!s.checkValidity()&&!i)throw new TypeError("Invalid URL");Object.defineProperty(this,"_anchorElement",{value:a});var c=new t.URLSearchParams(this.search),u=!0,h=!0,l=this;["append","delete","set"].forEach(function(t){var e=c[t];c[t]=function(){e.apply(c,arguments),u&&(h=!1,l.search=c.toString(),h=!0)}}),Object.defineProperty(this,"searchParams",{value:c,enumerable:!0});var f=void 0;Object.defineProperty(this,"_updateSearchParams",{enumerable:!1,configurable:!1,writable:!1,value:function(){this.search!==f&&(f=this.search,h&&(u=!1,this.searchParams._fromString(this.search),u=!0))}})},i=n.prototype;["hash","host","hostname","port","protocol"].forEach(function(t){!function(t){Object.defineProperty(i,t,{get:function(){return this._anchorElement[t]},set:function(e){this._anchorElement[t]=e},enumerable:!0})}(t)}),Object.defineProperty(i,"search",{get:function(){return this._anchorElement.search},set:function(t){this._anchorElement.search=t,this._updateSearchParams()},enumerable:!0}),Object.defineProperties(i,{toString:{get:function(){var t=this;return function(){return t.href}}},href:{get:function(){return this._anchorElement.href.replace(/\?$/,"")},set:function(t){this._anchorElement.href=t,this._updateSearchParams()},enumerable:!0},pathname:{get:function(){return this._anchorElement.pathname.replace(/(^\/?)/,"/")},set:function(t){this._anchorElement.pathname=t},enumerable:!0},origin:{get:function(){var t={"http:":80,"https:":443,"ftp:":21}[this._anchorElement.protocol],e=this._anchorElement.port!=t&&""!==this._anchorElement.port;return this._anchorElement.protocol+"//"+this._anchorElement.hostname+(e?":"+this._anchorElement.port:"")},enumerable:!0},password:{get:function(){return""},set:function(t){},enumerable:!0},username:{get:function(){return""},set:function(t){},enumerable:!0}}),n.createObjectURL=function(t){return e.createObjectURL.apply(e,arguments)},n.revokeObjectURL=function(t){return e.revokeObjectURL.apply(e,arguments)},t.URL=n}(),void 0!==t.location&&!("origin"in t.location)){var e=function(){return t.location.protocol+"//"+t.location.hostname+(t.location.port?":"+t.location.port:"")};try{Object.defineProperty(t.location,"origin",{get:e,enumerable:!0})}catch(n){setInterval(function(){t.location.origin=e()},100)}}}(void 0!==R?R:"undefined"!=typeof window?window:"undefined"!=typeof self?self:R),function(t){t[t.Var=0]="Var",t[t.All=1]="All"}(Br||(Br={}));var Gr=function(){function e(){this.fetchStatus="no",this.refreshFetchStatus="complete",this.versions=[],this.extVersions=[],this.mulilinkVersions=[],this.enable_multilink=!1,this.enable_ab_visual=!1,this.editMode=!1,this.callbacks=[],this.data=null,this.changeListener=new Map,this.readyStatus=!1,this.exposureCache=[],this.auto_exposure=!1}return e.prototype.apply=function(t,e){var n=this;if(this.collect=t,this.config=e,this.config.enable_ab_test){var i=t.configManager.getSettingData("bav_ab_config");if(!l(i)||i){var r=e.enable_multilink,o=e.ab_channel_domain,a=e.enable_ab_visual,s=e.ab_cross,c=e.ab_cookie_domain,u=e.disable_ab_reset,h=e.auto_exposure_expriment,f=o||v(X[e.channel||"cn"]),p=t.adapters.storage;this.cacheStorgae=new p(!1),this.enable_multilink=r,this.enable_ab_visual=a,this.abKey="__tea_sdk_ab_version_".concat(e.app_id),this.ab_cross=s,this.ab_cookie_domain=c||"",this.fetchUrl="".concat(f).concat("/service/2/abtest_config/"),this.reportUrl="".concat(t.configManager.getUrl("event")),this.exposureLimit=e.exposure_limit||5,this.ab_batch_time=e.ab_batch_time||50,this.overlay_opacity=e.overlay_opacity||0,this.auto_exposure=h;var d=this.collect.Types;this.types=d;var g=t.configManager.getSettingData("bav_ab_refresh");this.collect.on(d.TokenChange,function(t){u||l(i)&&!g||"uuid"===t.type&&n.readyStatus&&(n.clearCache(),n.fetchAB())}),this.collect.on(d.TokenReset,function(){u||l(i)&&!g||n.readyStatus&&(n.clearCache(),n.fetchAB())}),this.collect.on(d.AbVar,function(t){var e=t.name,i=t.defaultValue,r=t.callback;n.getVar(e,i,r)}),this.collect.on(d.AbAllVars,function(t){n.getAllVars(t)}),this.collect.on(d.AbConfig,function(t){var e=t.params,i=t.callback;n.getABconfig(e,i)}),this.collect.on(d.AbExternalVersion,function(t){n.setExternalAbVersion(t)}),this.collect.on(d.AbOpenLayer,function(){n.openOverlayer()}),this.collect.on(d.AbCloseLayer,function(){n.closeOverlayer()}),this.collect.on(d.AbVersionChangeOn,function(t){n.changeListener.set(t,t)}),this.collect.on(d.AbVersionChangeOff,function(t){n.changeListener.get(t)&&n.changeListener.delete(t)}),this.loadMode(),(this.enable_ab_visual||this.enable_multilink)&&this.openOverlayer(this.config.multilink_timeout_ms||500),this.checkLocal(),this.ready("ab"),this.readyStatus||(this.fetchAB(),this.readyStatus=!0),this.collect.emit(d.AbReady)}}},e.prototype.ready=function(t){var e=this;if(this.collect.set(t),this.collect.hook._hooksCache.hasOwnProperty(t)){var n=this.collect.hook._hooksCache[t];if(!Object.keys(n).length)return;var i=function(t){n[t].length&&n[t].forEach(function(n){e.collect.hook.emit(t,n)})};for(var r in n)i(r)}},e.prototype.loadMode=function(){var t,e,n=function(){try{var t=JSON.parse(atob(window.name));return t||void 0}catch(t){return}}(),i="";if(n){var r=n.scenario,o=n.href;r?(this.editMode=!0,i=r):!o||-1===o.indexOf("datatester")&&-1===o.indexOf("visual-editor")||(this.editMode=!0,i="visual-editor")}this.enable_ab_visual&&(function(t,e){window.TEAVisualEditor=window.TEAVisualEditor||{},Dr(["*"]);var n,i="";Ir(e,J);var r="";try{var o=window.performance.getEntriesByType("resource");if(o&&o.length&&(o.forEach(function(t){"script"===t.initiatorType&&t.name&&-1!==t.name.indexOf("collect")&&(r=t.name)}),r||document.currentScript&&(r=document.currentScript.src),r&&(n=r.split("/"))&&n.length)){i="https:/";for(var a=2;a<n.length&&a!==n.length-1;a++)i+="/".concat(n[a]);i="".concat(i,"/visual-ab-core")}}catch(t){}Ar("tea:openVisualABEditor",function(n){var r=v($),o=n.data;if("string"==typeof n.data)try{o=JSON.parse(n.data)}catch(t){o=void 0}if(o){var a=o.lang;if(o.appId!==e.app_id)return zr(n,"appIdError"),void console.error("abtest appid is not belong the page appid please check");var s=o.version;if(s){var c=s?".".concat(s):".1.0.1";Or=i?"".concat(i).concat(c,".js?query=").concat(Date.now()):"".concat(r,"?query=").concat(Date.now())}else Or="".concat(r,"?query=").concat(Date.now());window.TEAVisualEditor.lang=a,window.TEAVisualEditor.__ab_domin=e.channel_domain||"",Mr({event:n,editorUrl:Or,collectInstance:t})}})}(this.collect,this.config),"visual-editor"===i)?this.collect.destoryInstace():this.enable_multilink&&(t=this.collect,e=this.config,window.TEAVisualEditor=window.TEAVisualEditor||{},window.TEAVisualEditor.appId=e.app_id,Ar("tea:openTesterEventInspector",function(e){var n=e.data;if("string"==typeof e.data)try{n=JSON.parse(e.data)}catch(t){n=void 0}if(n){var i=n.referrer,r=n.lang,o=n.appId;window.TEAVisualEditor.__editor_ajax_domain=i||"",window.TEAVisualEditor.__ab_appId=o||"",window.TEAVisualEditor.lang=r||"";var a=v("1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1bz18z22z18z4az24z1mz1jz1az1az1bz1lz4az1az1mz1kz4bz1mz19z1hz4bz1bz18z22z18z49z21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz22z1cz21z22z1cz20z49z1cz24z1cz1lz22z49z1gz1lz21z1nz1cz1az22z1mz20");a="".concat(a,".2.2.0"),Mr({event:e,editorUrl:"".concat(a,".js?query=").concat(Date.now()),collectInstance:t})}}))},e.prototype.checkLocal=function(){var t=this.getABCache(),e=t.ab_version,n=t.ab_ext_version,i=t.ab_version_multilink,r=t.data,o=this.checkFromUrl();o?this.mulilinkVersions.push(o):this.mulilinkVersions=i||[],this.extVersions=n||[],this.versions=e||[],this.data=r;var a=this.versions.concat(this.extVersions);this.enable_multilink&&(a=a.concat(this.mulilinkVersions)),this.configVersions(a.join(","))},e.prototype.checkFromUrl=function(){var t=S(window.location.href);return t&&t.vid?t.vid:""},e.prototype.updateVersions=function(){var t=this.extVersions.length?this.versions.concat(this.extVersions):this.versions;this.enable_multilink&&(t=t.concat(this.mulilinkVersions)),this.configVersions(t.join(",")),this.updateABCache(),this.changeListener.size>0&&this.changeListener.forEach(function(e){"function"==typeof e&&e(t)})},e.prototype.configVersions=function(t){this.collect.configManager.setAbVersion(t)},e.prototype.getVar=function(t,e,n){if(!t)throw new Error("variable must not be empty");if(void 0===e)throw new Error("variable no default value");if("function"!=typeof n)throw new Error("callback must be a function");var i={name:t,defaultValue:e,callback:n,type:Br.Var};this.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK GetVar",level:"info",time:Date.now(),data:t,infoType:"cus"}),"complete"===this.fetchStatus&&"complete"===this.refreshFetchStatus?this.getRealVar(i,t):this.callbacks.push(i)},e.prototype.getRealVar=function(t,e){var n=t.name,i=t.defaultValue,r=t.callback,o=this.data;if(o){if(u(o[n])){var a=o[n].vid;return"$ab_url"===e?this.mulilinkVersions.includes(a)||this.mulilinkVersions.push(a):this.versions.includes(a)||this.versions.push(a),this.updateVersions(),this.fechEvent(a,e,i),r(o[n].val),void this.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDKGetVar".concat(n),level:"info",time:Date.now(),data:o[n],infoType:"sdk"})}r(i),this.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDKGerVar",level:"info",time:Date.now(),data:this.data,infoType:"sdk"})}else r(i)},e.prototype.getAllVars=function(t){if("function"!=typeof t)throw new Error("callback must be a function");var e={callback:t,type:Br.All};this.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK GetAllVars",level:"info",time:Date.now(),infoType:"cus"}),"complete"===this.fetchStatus&&"complete"===this.refreshFetchStatus?this.getRealAllVars(e):this.callbacks.push(e)},e.prototype.getRealAllVars=function(t){(0,t.callback)(this.data?JSON.parse(JSON.stringify(this.data)):{}),this.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK GetAllVars",level:"info",time:Date.now(),data:this.data,infoType:"sdk"})},e.prototype.exposureAll=function(t){try{if(Object.keys(t).length)for(var e in t){if("$ab_url"===e||"$ab_modification"===e)break;this.getRealVar({name:e,defaultValue:t[e].val,callback:function(){},type:Br.Var},e)}}catch(t){console.warn("exposure all expriment err",JSON.stringify(t.message))}},e.prototype.fechEvent=function(t,e,n){try{if(this.config.disable_track_event)return;if(this.collect.sdkStop)return;if(!t)return;var i=this.collect.configManager.get(),r=i.header,o=i.user,a=this.getABCache();if(a&&a.uuid&&a.uuid!==o.user_unique_id)return;var s={event:"abtest_exposure",ab_sdk_version:"".concat(t),params:JSON.stringify({app_id:this.config.appId,ab_url:"$ab_url"===e?n:window.location.href}),local_time_ms:Date.now()};r.custom=JSON.stringify(r.custom);var c={events:[s],user:o,header:r};this.reportExposure(c,e)}catch(t){this.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK ",level:"error",time:Date.now(),data:t.message,infoType:"sdk"})}},e.prototype.reportExposure=function(t,e){this.exposureCache.push(t),this.report(e)},e.prototype.report=function(t){var e=this;try{var n=this.collect.cryptoData(this.exposureCache);if(z())return void lt(this.collect.configManager.getUrl("img"),n);this.collect.requestManager.useRequest({url:this.reportUrl,data:n,timeout:1e5,useBeacon:"$ab_url"===t,encryption:this.config.enable_encryption,encryption_header:this.config.encryption_header,zip:!0,type:"event"}),this.exposureCache.forEach(function(t){e.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_EVENT,info:"",time:Date.now(),data:[t],code:200,status:"success",infoType:"sdk"})}),this.exposureCache=[]}catch(t){console.log("ab report err",t)}},e.prototype.setExternalAbVersion=function(t){this.extVersions=[t],this.updateVersions()},e.prototype.getABconfig=function(t,e){var n=Object.keys(t);n&&n.length&&this.collect.configManager.set(t),this.fetchAB(e)},e.prototype.get=function(t){if(this.ab_cross){var e=this.cacheStorgae.getCookie(t,this.ab_cookie_domain);return e?JSON.parse(e):null}return this.cacheStorgae.getItem(t)},e.prototype.set=function(t,e){this.ab_cross?this.cacheStorgae.setCookie(t,e,2592e6,this.ab_cookie_domain):this.cacheStorgae.setItem(t,e),this.collect.configManager.setAbCache(e)},e.prototype.remove=function(){this.ab_cross?this.cacheStorgae.removeCookie(this.abKey,this.ab_cookie_domain):this.cacheStorgae.removeItem(this.abKey)},e.prototype.getABCache=function(t){var e={ab_version:[],ab_ext_version:[],ab_version_multilink:[],data:null,timestamp:+new Date,uuid:""};return e=this.get(this.abKey)||e,t?e[t]:e},e.prototype.updateABCache=function(){var t=this.getABCache();t.ab_version_multilink=this.mulilinkVersions,t.ab_ext_version=this.extVersions,t.ab_version=this.versions,t.timestamp=Date.now(),this.set(this.abKey,t)},e.prototype.setAbCache=function(t){var e=this.getABCache();e.data=this.data,e.uuid=t,e.timestamp=Date.now(),this.set(this.abKey,e)},e.prototype.clearCache=function(){this.refreshFetchStatus="ing",this.data={},this.extVersions=[],this.mulilinkVersions=[],this.versions=[],this.collect.configManager.clearAbCache()},e.prototype.openOverlayer=function(t){var e=this;if(function(t){if(!document.getElementById(Rr)){var e="body { opacity: ".concat(t," !important; }"),n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.id=Rr,i.type="text/css",i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e)),n.appendChild(i)}}(this.overlay_opacity),t)var n=setTimeout(function(){e.closeOverlayer(),clearTimeout(n)},t)},e.prototype.closeOverlayer=function(){var t;(t=document.getElementById(Rr))&&t.parentElement.removeChild(t)},e.prototype.fetchComplete=function(t,e){var n=this;if(t&&"[object Object]"==Object.prototype.toString.call(t)){this.data=t,this.setAbCache(e);var i=[];Object.keys(t).forEach(function(e){var n=t[e].vid;n&&i.push(n)}),this.versions=this.versions.filter(function(t){return i.includes(t)});var r=t.$ab_url,o=t.$ab_modification;if(o&&o.val&&this.enable_ab_visual){if(this.collect.destroyInstance)return;this.getVar("$ab_modification",window.location.href,function(){!function(t){window.TEAVisualEditor=window.TEAVisualEditor||{},window.TEAVisualEditor.__ab_config=t;var e=v("1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1bz18z22z18z4az24z1mz1jz1az1az1bz1lz4az1az1mz1kz4bz1mz19z1hz4bz1bz18z22z18z49z21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z18z19z49z1jz1mz18z1bz1cz20z4az1hz21");y("".concat(e,"?query=").concat(Date.now()),function(){console.log("load visual render success")},function(){console.log("load visual render fail")})}(o.val),n.closeOverlayer(),n.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK ",level:"info",logType:"fetch",time:Date.now(),infoType:"sdk",data:{$ab_modification:o}})})}else if(r&&this.enable_multilink){this.mulilinkVersions=this.mulilinkVersions.filter(function(t){return i.includes(t)}),this.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK ",level:"info",logType:"fetch",time:Date.now(),infoType:"sdk",data:{$ab_url:r}});var a=r.val,s=r.vid;a&&s&&this.getVar("$ab_url",a,function(){n.editMode||(a!==window.location.href?setTimeout(function(){if(!n.collect.destroyInstance){var t="".concat(a);t=-1===t.indexOf("http")?"https://".concat(t):t;var e=E(t).host;try{var i=new URL(t);e!==location.host?i.searchParams.append("vid",s):window.history.replaceState("","",t),window.location.href=i.href}catch(e){window.location.href=t}}},100):n.closeOverlayer())})}this.auto_exposure&&this.exposureAll(t),this.updateVersions()}else this.closeOverlayer();this.callbacks.forEach(function(t){return n[t.type===Br.Var?"getRealVar":"getRealAllVars"](t,"")}),this.callbacks=[]},e.prototype.fetchAB=function(e){var n=this,i=this.collect.configManager.get(),r=i.header,o=i.user;this.config.enable_anonymousid&&delete o.web_id;var a=o.user_unique_id,s={header:t(t(t({aid:this.config.app_id},o||{}),r||{}),{ab_sdk_version:this.collect.configManager.getAbVersion(),ab_url:window.location.href})};this.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK AB",level:"info",logType:"fetch",time:Date.now(),data:s,infoType:"sdk"});var c=this.collect.cryptoData(s);this.collect.requestManager.useRequest({url:this.fetchUrl,data:c,success:function(t){n.fetchStatus="complete",n.refreshFetchStatus="complete";var i=t.data;"success"===t.message?(n.fetchComplete(i,a),e&&e(i)):(n.fetchComplete(null,a),e&&e(null)),n.collect.emit(n.types.AbComplete,i),n.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"AB",level:"info",logType:"fetch",time:Date.now(),data:i,infoType:"sdk"})},fail:function(){n.fetchStatus="complete",n.refreshFetchStatus="complete",n.fetchComplete(null,a),e&&e(null),n.collect.emit(n.types.AbTimeout),n.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"AB",level:"error",logType:"fetch",time:Date.now(),infoType:"sdk"})},timeout:this.config.ab_timeout||1e4,encryption:this.config.enable_encryption,encryption_header:this.config.encryption_header})},e}();try{var Ur=bi();Ur&&(Ur.LogAb=function(t,e){(new Gr).apply(t,e)})}catch(t){console.log(t)}var Nr=function(){function e(t,e){this.maxDuration=432e5,this.aliveDTime=6e4,this.options={aliveName:"predefine_page_alive",params:{}},this.collect=t,this.config=e,this.pageStartTime=Date.now(),this.sessionStartTime=this.pageStartTime,this.timerHandler=null,u(e.enable_stay_duration)&&(this.options=Object.assign(this.options,e.enable_stay_duration))}return e.prototype.setParams=function(t,e,n){this.set_path=t,this.set_url=n,this.set_title=e},e.prototype.resetParams=function(t,e,n){this.url_path=t,this.url=n,this.title=e},e.prototype.enable=function(t,e,n){this.url_path=t||this.url_path,this.url=n||this.url,this.title=e||this.title,this.disableCallback=this.enablePageAlive(),this.options.params instanceof Function?this.customParmas=this.options.params():this.customParmas=this.options.params},e.prototype.disable=function(){this.disableCallback(),this.pageStartTime=Date.now()},e.prototype.sendEvent=function(e,n){void 0===n&&(n=!1);var i=n?this.aliveDTime:Date.now()-this.sessionStartTime;i<0||i>this.aliveDTime||Date.now()-this.pageStartTime>this.maxDuration||(this.collect.beconEvent(this.options.aliveName,t({url_path:this.getParams("url_path"),title:this.getParams("title"),url:this.getParams("url"),duration:i,is_support_visibility_change:b(),startTime:this.sessionStartTime,hidden:document.visibilityState,leave:e},this.customParmas)),this.sessionStartTime=Date.now(),this.resetParams(location.pathname,document.title,location.href))},e.prototype.getParams=function(t){switch(t){case"url_path":return this.set_path||this.url_path||location.pathname;case"title":return this.set_title||this.title||document.title||location.pathname;case"url":return this.set_url||this.url||location.href}},e.prototype.setUpTimer=function(){var t=this;return this.timerHandler&&clearInterval(this.timerHandler),setInterval(function(){Date.now()-t.sessionStartTime>t.aliveDTime&&t.sendEvent(!1,!0)},1e3)},e.prototype.visibilitychange=function(){"hidden"===document.visibilityState?this.timerHandler&&(clearInterval(this.timerHandler),this.sendEvent(!1)):"visible"===document.visibilityState&&(this.sessionStartTime=Date.now(),this.timerHandler=this.setUpTimer())},e.prototype.beforeunload=function(){document.hidden||this.sendEvent(!0)},e.prototype.enablePageAlive=function(){var t=this;this.timerHandler=this.setUpTimer();var e=this.visibilitychange.bind(this),n=this.beforeunload.bind(this);return g(document,"visibilitychange",e,!1),g(window,"pagehide",n,!1),function(){t.beforeunload(),m(document,"visibilitychange",e,!1),m(window,"beforeunload",n,!1),m(window,"pagehide",n,!1)}},e}(),Lr=function(){function e(t,e){var n=this;this.maxDuration=432e5,this.aliveDTime=6e4,this.options={closeName:"predefine_page_close",params:{}},this.visibilitychange=function(){"hidden"===document.visibilityState?n.activeEndTime=Date.now():"visible"===document.visibilityState&&(n.activeEndTime&&(n.totalTime+=n.activeEndTime-n.activeStartTime,n.activeTimes+=1),n.activeEndTime=void 0,n.activeStartTime=Date.now())},this.beforeunload=function(){if(n.totalTime+=(n.activeEndTime||Date.now())-n.activeStartTime,n.config.autotrack){try{window.sessionStorage.setItem("_tea_cache_duration",JSON.stringify({duration:n.totalTime,page_title:document.title||location.pathname}))}catch(t){}}n.sendEventPageClose()},this.collect=t,this.config=e,this.maxDuration=e.maxDuration||864e5,this.pageStartTime=Date.now(),u(e.enable_stay_duration)&&(this.options=Object.assign(this.options,e.enable_stay_duration)),this.resetData()}return e.prototype.setParams=function(t,e,n){this.set_path=t,this.set_url=n,this.set_title=e},e.prototype.resetParams=function(t,e,n){this.url_path=t,this.url=n,this.title=e},e.prototype.enable=function(t,e,n){this.url_path=t||this.url_path,this.url=n||this.url,this.title=e||this.title,this.disableCallback=this.enablePageClose()},e.prototype.disable=function(){this.disableCallback()},e.prototype.resetData=function(){this.activeStartTime=void 0===this.activeStartTime?this.pageStartTime:Date.now(),this.activeEndTime=void 0,this.activeTimes=1,this.totalTime=0,this.options.params instanceof Function?this.customParmas=this.options.params():this.customParmas=this.options.params,this.resetParams(location.pathname,document.title,location.href)},e.prototype.sendEventPageClose=function(){var e=Date.now()-this.pageStartTime;this.totalTime<0||e<0||this.totalTime>=this.maxDuration||(this.collect.beconEvent(this.options.closeName,t({url_path:this.getParams("url_path"),title:this.getParams("title"),url:this.getParams("url"),active_times:this.activeTimes,duration:this.totalTime,total_duration:e,is_support_visibility_change:b()},this.customParmas)),this.pageStartTime=Date.now(),this.resetData())},e.prototype.getParams=function(t){switch(t){case"url_path":return this.set_path||this.url_path||location.pathname;case"title":return this.set_title||this.title||document.title||location.pathname;case"url":return this.set_url||this.url||location.href}},e.prototype.enablePageClose=function(){var t=this,e=this.visibilitychange.bind(this),n=this.beforeunload.bind(this);return document.addEventListener("visibilitychange",e),window.addEventListener("pagehide",n),function(){t.beforeunload(),document.removeEventListener("visibilitychange",e),window.removeEventListener("beforeunload",n),window.removeEventListener("pagehide",n)}},e}(),Pr=function(){function t(){}return t.prototype.apply=function(t,e){var n=this;if(this.collect=t,this.config=e,this.config.enable_stay_duration){this.title=document.title||location.pathname,this.url=location.href,this.url_path=location.pathname,this.pageAlive=new Nr(t,e),this.pageClose=new Lr(t,e);var i=this.collect.Types;this.collect.on(i.ResetStay,function(t){var e=t.url_path,i=t.title,r=t.url;n.resetStayDuration(e,i,r)}),this.collect.on(i.RouteChange,function(t){t.init||e.disable_route_report||n.resetStayDuration()}),this.collect.on(i.SetStay,function(t){var e=t.url_path,i=t.title,r=t.url;n.setStayParmas(e,i,r)}),this.enable(this.url_path,this.title,this.url),this.ready(i.Stay),this.collect.emit(i.StayReady)}},t.prototype.ready=function(t){var e=this;if(this.collect.set(t),this.collect.hook._hooksCache.hasOwnProperty(t)){var n=this.collect.hook._hooksCache[t];if(!Object.keys(n).length)return;var i=function(t){n[t].length&&n[t].forEach(function(n){e.collect.hook.emit(t,n)})};for(var r in n)i(r)}},t.prototype.enable=function(t,e,n){this.pageAlive.enable(t,e,n),this.pageClose.enable(t,e,n)},t.prototype.disable=function(){this.pageAlive.disable(),this.pageClose.disable()},t.prototype.setStayParmas=function(t,e,n){void 0===t&&(t=""),void 0===e&&(e=""),void 0===n&&(n=""),this.pageAlive.setParams(t,e,n),this.pageClose.setParams(t,e,n),this.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK  resetStayParams",level:"info",time:Date.now(),data:{url_path:t,title:e,url:n},infoType:"cus"})},t.prototype.reset=function(t,e,n){this.disable(),this.enable(t,e,n)},t.prototype.resetStayDuration=function(t,e,n){this.reset(t,e,n),this.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"SDK  resetStayDuration",level:"info",time:Date.now(),data:{url_path:t,title:e,url:n},infoType:"sdk"})},t}();try{var Fr=bi();Fr&&(Fr.LogStay=function(t,e){(new Pr).apply(t,e)})}catch(t){console.log(t)}var qr=function(){function e(){}return e.prototype.apply=function(t,e){var n=this;this.collect=t,this.config=e,this.retryLimit=14,this.currentCount=0,this.retryTimeRanger=2e3,this.bindInfoMap=new Map,this.collect.on(Y.BindToken,function(t){n.addToCache(t)})},e.prototype.addToCache=function(t){var e=mt();this.bindInfoMap.set(e,t),this.fetchBind(e)},e.prototype.retry=function(t,e,n,i){var r=this;void 0===e&&(e=!1),e&&(this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){if(r.currentCount>=r.retryLimit)return i(n),r.collect.sdkStop=!1,r.collect.emit(Y.BindTokenReady),void r.reset();r.fetchBind(t),r.currentCount++,r.currentCount>0&&r.currentCount<=2&&(r.retryTimeRanger=1e4),r.currentCount>2&&r.currentCount<=4&&(r.retryTimeRanger=2e4),r.currentCount>4&&r.currentCount<=6&&(r.retryTimeRanger=6e4),r.currentCount>6&&r.currentCount<=8&&(r.retryTimeRanger=12e4),r.currentCount>8&&r.currentCount<=10&&(r.retryTimeRanger=18e4),r.currentCount>10&&r.currentCount<=12&&(r.retryTimeRanger=36e4),r.currentCount>12&&r.currentCount<=14&&(r.retryTimeRanger=54e4)},this.retryTimeRanger))},e.prototype.reset=function(){clearTimeout(this.timer),this.timer=null,this.currentCount=0,this.retryTimeRanger=2e3},e.prototype.fetchBind=function(e){var n=this,i=this.bindInfoMap.get(e),r=i.params,o=i.callback,a=i.retry,s=this.collect.configManager.getUrl("bind"),c={header:{aid:this.collect.configManager.get("app_id"),identities:t({},r)}};this.collect.requestManager.useRequest({url:s,data:c,success:function(t){10500===(null==t?void 0:t.status_code)?n.retry(e,a,t,o):(o(t),n.collect.sdkStop=!1,n.reset(),n.collect.emit(Y.BindTokenReady))},fail:function(t){o(t),n.collect.sdkStop=!1,n.collect.emit(Y.BindTokenReady)},time:3e4,encryption:this.config.enable_encryption,encryption_header:this.config.encryption_header})},e}(),jr=function(){function t(){var t=this;this.setInterval=function(){t.clearIntervalFunc=w(function(){t.isSessionhasEvent&&t.endCurrentSession()},t.sessionInterval)},this.clearInterval=function(){t.clearIntervalFunc&&t.clearIntervalFunc()}}return t.prototype.apply=function(t,e){var n=this;if(this.collect=t,e.enable_heartbeat){this.sessionInterval=6e4,this.startTime=0,this.lastTime=0,this.setInterval();var i=this.collect.Types;this.collect.on(i.SessionResetTime,function(){n.process()})}},t.prototype.endCurrentSession=function(){this.collect.event("_be_active",{start_time:this.startTime,end_time:this.lastTime,url:window.location.href,referrer:window.document.referrer,title:document.title||location.pathname}),this.isSessionhasEvent=!1,this.startTime=0},t.prototype.process=function(){this.isSessionhasEvent||(this.isSessionhasEvent=!0,this.startTime=+new Date);var t=this.lastTime||+new Date;this.lastTime=+new Date,this.lastTime-t>this.sessionInterval&&(this.clearInterval(),this.endCurrentSession(),this.setInterval())},t}(),Kr=function(){function t(){}return t.prototype.apply=function(t,e){var n=this;if(this.collect=t,this.config=e,!this.config.channel_domain&&!(this.config.disable_track_event||this.config.disable_sdk_monitor||this.config.enable_encryption)){this.url=t.configManager.getUrl("event");var i=this.collect.Types;this.collect.on(i.Ready,function(){n.sdkOnload()}),this.collect.on(i.SubmitError,function(t){var e=t.type,i=t.eventData,r=t.errorCode;"f_data"===e&&n.sdkError(i,r)}),this.collect.on(t.Types.SDKInnerError,function(t){var e=t.type,i=t.eventData,r=t.errorCode,o=t.msg;n.sdkInnerError(e,i,r,o)}),this.collect.on(t.Types.SDKRunTimeError,function(t){var e=t.type,i=t.eventData,r=t.errorCode,o=t.msg;n.sdkRunTimeError(e,i,r,o)})}},t.prototype.sdkOnload=function(){var t=this;try{var e=this.collect.configManager.get(),n=e.header,i=e.user,r=n.app_id,o=n.app_name,a=n.sdk_version,s=i.web_id,c=i.anonymous_id,u={events:[{event:"onload",params:JSON.stringify({app_id:r,app_name:o||"",sdk_version:a,sdk_type:"script",sdk_config:this.config,sdk_desc:"TOB"}),local_time_ms:Date.now()}],user:{user_unique_id:this.config.enable_anonymousid?c:s},header:{}};setTimeout(function(){t.collect.requestManager.useRequest({url:t.url,data:[u],timeout:3e4,app_key:"566f58151b0ed37e",forceXhr:!0})},16)}catch(t){}},t.prototype.sdkError=function(t,e){var n=this;try{var i=t[0],r=i.user,o=i.header,a=[];t.forEach(function(t){t.events.forEach(function(t){a.push(t)})});var s={events:a.map(function(t){return{event:"on_error",params:JSON.stringify({error_code:e,app_id:o.app_id,app_name:o.app_name||"",error_event:t.event,sdk_version:o.sdk_version,local_time_ms:t.local_time_ms,tea_event_index:Date.now(),params:t.params,header:JSON.stringify(o),user:JSON.stringify(r)}),local_time_ms:Date.now()}}),user:{user_unique_id:r.user_unique_id},header:{}};setTimeout(function(){n.collect.requestManager.useRequest({url:n.url,data:[s],timeout:3e4,app_key:"566f58151b0ed37e",forceXhr:!0})},16)}catch(t){}},t.prototype.sdkInnerError=function(t,e,n,i){var r=this;try{var o=e[0],a=o.user,s=o.header,c=[];e.forEach(function(t){t.events.forEach(function(t){c.push(t)})});var u={events:c.map(function(e){return{event:"on_error",params:JSON.stringify({type:t,error_code:n,app_id:s.app_id,app_name:s.app_name||"",error_event:e.event,sdk_version:s.sdk_version,local_time_ms:e.local_time_ms,tea_event_index:Date.now(),params:e.params,header:s,user:a,ua:window.navigator.userAgent,err_msg:i}),local_time_ms:Date.now()}}),user:a,header:{}};setTimeout(function(){r.collect.requestManager.useRequest({url:r.url,data:[u],timeout:3e4,app_key:"566f58151b0ed37e",forceXhr:!0})},16)}catch(t){}},t.prototype.sdkRunTimeError=function(t,e,n,i){var r=this;try{var o=this.collect.configManager.get(),a=o.user,s=o.header,c={events:[{event:"on_error",params:JSON.stringify({type:t,errorCode:n,app_id:s.app_id,app_name:s.app_name||"",error_event:e.event,sdk_version:s.sdk_version,local_time_ms:e.local_time_ms,tea_event_index:Date.now(),header:s,user:a,ua:window.navigator.userAgent,err_msg:i}),local_time_ms:Date.now()}],user:a,header:{}};setTimeout(function(){r.collect.requestManager.useRequest({url:r.url,data:[c],timeout:3e4,app_key:"566f58151b0ed37e",forceXhr:!0})},16)}catch(t){}},t}();function Vr(t,e){if(void 0===e&&(e="list"),!t)return!1;if(e&&"list"===e){if(["LI","TR","DL"].includes(t.nodeName))return!0;if(t.dataset&&t.dataset.hasOwnProperty("teaIdx"))return!0;if(t.hasAttribute&&t.hasAttribute("data-tea-idx"))return!0}else{if(["A","BUTTON"].includes(t.nodeName))return!0;if(t.dataset&&t.dataset.hasOwnProperty("teaContainer"))return!0;if(t.hasAttribute&&t.hasAttribute("data-tea-container"))return!0;if(t.hasAttribute&&$r(t,"ss"))return!0}return!1}var Hr=function(t,e){return!!$r(t,e)};function Jr(t){for(var e=t;e&&!Vr(e,"container");){if("HTML"===e.nodeName||"BODY"===e.nodeName)return t;e=e.parentElement}return e||t}var Zr=function(t){if(!t)return"";var e="";return t.textContent?e=t.textContent.trim():t.innerText&&(e=t.innerText.trim()),"input"!==t.tagName&&"INPUT"!==t.tagName||(e=t.value||""),e};function Wr(t){for(var e=t;e&&e.parentNode;){if(e.hasAttribute("data-tea-ignore"))return!0;if("HTML"===e.nodeName||"body"===e.nodeName)return!1;e=e.parentNode}return!1}var Xr=function(t,e){return t.hasAttribute?t.hasAttribute(e):t.attributes?!(!t.attributes[e]||!t.attributes[e].specified):void 0},$r=function(t,e){if("string"==typeof e)return Xr(t,e);if(h(e)){for(var n=!1,i=0;i<e.length;i++){if(Xr(t,e[i])){n=!0;break}}return n}},Yr=function(t,e){var n={};if("string"==typeof e)Xr(t,e)&&(n[e]=t.getAttribute(e));else if(h(e))for(var i=0;i<e.length;i++){Xr(t,e[i])&&(n[e[i]]=t.getAttribute(e[i]))}return n},Qr=function(t){if(t.children.length){var e=t.children;return![].slice.call(e).some(function(t){return t.children.length>0})}return!0},to=function(t){if("svg"===t.tagName.toLowerCase())return!0;for(var e=t.parentElement,n=!1;e;)"svg"===e.tagName.toLowerCase()?(e=null,n=!0):e=e.parentElement;return n};var eo=function(){function e(e,n,i){var r=this;this.clickEvent=function(t){(function(t,e){if(1!==t.nodeType)return!1;if(!e.svg&&to(t))return!1;if(["HTML","BODY"].includes(t.tagName.toUpperCase()))return!1;var n=t;return!!("none"!==n.style.display&&(Vr(n,"container")||e.track_attr&&Hr(n,e.track_attr)||Qr(n)))})(t.target,r.options)&&r.eventHandel({eventType:"dom",eventName:"click"},t)},this.changeEvent=function(t){r.eventHandel({eventType:"dom",eventName:"change"},t)},this.submitEvent=function(t){r.eventHandel({eventType:"dom",eventName:"submit"},t)},this.getPageViewEvent=function(e,n){n&&"pushState"===n&&r.eventHandel({eventType:"dom",eventName:"beat"},t({beat_type:0},e)),r.eventHandel({eventType:"dom",eventName:"page_view"},e)},this.getPageLoadEvent=function(t){r.eventHandel({eventType:"dom",eventName:"page_statistics"},{lcp:t})},this.config=i.getConfig().eventConfig,this.collect=n,this.options=e,this.beatTime=e.beat,this.statistics=!1}return e.prototype.init=function(t){this.eventHandel=t;var e=this.config.mode;this.addListener(e)},e.prototype.addListener=function(t){var e=this;if("proxy-capturing"===t&&(this.config.click&&window.document.addEventListener("click",this.clickEvent,!0),this.config.change&&window.document.addEventListener("change",this.changeEvent,!0),this.config.submit&&window.document.addEventListener("submit",this.submitEvent,!0),this.config.pv&&this.collect.on("route-change",function(t){var n=t.config,i=t.name;e.getPageViewEvent(n,i)}),this.config.beat)){try{"complete"===document.readyState?this.beatEvent(this.beatTime):window.addEventListener("load",function(){e.beatEvent(e.beatTime)});var n=0,i=null;window.addEventListener("scroll",function(){clearTimeout(i),i=setTimeout(r,500),n=document.documentElement.scrollTop||document.body.scrollTop});var r=function(){(document.documentElement.scrollTop||document.body.scrollTop)==n&&e.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:1})}}catch(t){}try{var o=window.performance&&window.performance.getEntriesByType("paint");if(o&&o.length)new PerformanceObserver(function(t){var n=t.getEntries(),i=n[n.length-1],r=i.renderTime||i.loadTime;e.statistics||(e.getPageLoadEvent(r),e.statistics=!0)}).observe({entryTypes:["largest-contentful-paint"]}),setTimeout(function(){e.statistics||(e.getPageLoadEvent(o[0].startTime||0),e.statistics=!0)},2e3);else this.getPageLoadEvent(0)}catch(t){this.getPageLoadEvent(0)}}},e.prototype.removeListener=function(){window.document.removeEventListener("click",this.clickEvent,!0),window.document.removeEventListener("change",this.changeEvent,!0),window.document.removeEventListener("submit",this.submitEvent,!0)},e.prototype.beatEvent=function(t){var e=this;try{var n;this.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:3}),this.beatTime&&(n=setInterval(function(){e.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:2})},t)),_(function(){e.eventHandel({eventType:"dom",eventName:"beat",eventSend:"becon"},{beat_type:0}),e.beatTime&&clearInterval(n)})}catch(t){}},e}(),no={eventConfig:{mode:"proxy-capturing",submit:!1,click:!0,change:!1,pv:!0,beat:!0,hashTag:!1,impr:!1},scoutConfig:{mode:"xpath"}},io=function(){function t(t,e){this.config=t,this.config.eventConfig=Object.assign(this.config.eventConfig,e)}return t.prototype.getConfig=function(){return this.config},t.prototype.setConfig=function(t){return this.config=t},t}();function ro(t){for(var e=[];null!==t.parentElement;)e.push(t),t=t.parentElement;var n=[],i=[];return e.forEach(function(t){var e=function(t){if(null===t)return{str:"",index:0};var e=0,n=t.parentElement;if(n)for(var i=n.children,r=0;r<i.length&&i[r]!==t;r++)i[r].nodeName===t.nodeName&&e++;return{str:[t.nodeName.toLowerCase(),Vr(t,"list")?"[]":""].join(""),index:e}}(t),r=e.str,o=e.index;n.unshift(r),i.unshift(o)}),{element_path:"/".concat(n.join("/")),positions:i}}function oo(t,e,n,i){var r={},o=function(t){if(t){var e=t.getBoundingClientRect(),n=e.width,i=e.height;return{left:e.left,top:e.top,element_width:n,element_height:i}}}(e),a=function(t,e){void 0===t&&(t={}),void 0===e&&(e={});var n=t.clientX,i=t.clientY,r=e.left,o=e.top,a=n-r>=0?n-r:0,s=i-o>=0?i-o:0;return{touch_x:Math.floor(a),touch_y:Math.floor(s)}}(t,o),s=o.element_width,c=o.element_height,u=a.touch_x,h=a.touch_y,l=ro(e),f=l.element_path,p=l.positions,d=function(t){var e=Jr(t),n=[];return function t(e){var i=function(t){var e="";return 3===t.nodeType?e=t.textContent.trim():t.dataset&&t.dataset.hasOwnProperty("teaTitle")?e=t.getAttribute("data-tea-title"):t.hasAttribute("ata-tea-title")?e=t.getAttribute("data-tea-title"):t.hasAttribute("title")?e=t.getAttribute("title"):"INPUT"===t.nodeName&&["button","submit"].includes(t.getAttribute("type"))?e=t.getAttribute("value"):"IMG"===t.nodeName&&t.getAttribute("alt")&&(e=t.getAttribute("alt")),e.slice(0,200)}(e);if(i&&-1===n.indexOf(i)&&n.push(i),e.childNodes.length>0)for(var r=e.childNodes,o=0;o<r.length;o++)8!==r[o].nodeType&&t(r[o])}(e),n}(e),g=window.performance.timing.navigationStart,m=Date.now()-g,v=p.map(function(t){return"".concat(t)}),_=null;if(window.TEAVisualEditor&&window.TEAVisualEditor.getOriginXpath&&(_=window.TEAVisualEditor.getOriginXpath({xpath:f,positions:v})),r.element_path=_&&_.xpath||f,r.positions=_&&_.positions||v,i&&!i.text&&(r.texts=d,r.element_title=Zr(e)),r.element_id=e.getAttribute("id")||"",r.element_class_name=e.getAttribute("class")||"",r.element_type=e.nodeType,r.element_width=Math.floor(s),r.element_height=Math.floor(c),r.touch_x=u,r.touch_y=h,r.page_manual_key="",r.elememt_manual_key="",r.since_page_start_ms=m,r.page_start_ms=g,r.page_path=location.pathname,r.page_host=location.host,n.track_attr&&Hr(e,n.track_attr)){var y=Yr(e,n.track_attr);for(var b in y)r[b]=y[b]}if(n.custom_attr)try{if(Hr(e,n.custom_attr)){y=Yr(e,n.custom_attr),b=decodeURIComponent(y[n.custom_attr]);var w=JSON.parse(b);if(Object.keys(w))for(var E in w)r[E]=w[E]}}catch(t){console.log("custom attr error")}var S=Jr(e);return"A"===S.tagName&&(r.href=S.getAttribute("href")),!1!==n.src&&("IMG"!==e.tagName||e.getAttribute("src").includes("base64")||(r.src=e.getAttribute("src"))),r}var ao,so=function(e,n,i,r,o){return t(t({event:e},oo(n,i,r,o)),{is_html:1,page_key:window.location.href,page_title:document.title})},co=function(){function e(t,e){this.ignore={text:!1},this.initConfig=t,this.options=e,this.eventName=e&&"tea"===e.custom?{click:"__bav_click",page:"__bav_page",beat:"__bav_beat",static:"__bav_page_statistics",exposure:"__bav_page_exposure"}:{click:"bav2b_click",page:"bav2b_page",beat:"bav2b_beat",static:"bav2b_page_statistics",exposure:"$bav2b_exposure",scroll:"$bav2b_slide"},e&&!1===e.text&&(this.ignore.text=!0),e&&e.exposure&&e.exposure.eventName&&(this.eventName.exposure=e.exposure.eventName),e&&e.scroll&&e.scroll.eventName&&(this.eventName.scroll=e.scroll.eventName)}return e.prototype.handleEvent=function(e,n){try{if(Wr(e.target))return null;var i="bav2b_click";switch(n){case"click":return i=this.eventName.click,so(i,e,e.target,this.options,this.ignore);case"change":return t(t({},so(i="bav2b_change",e,e.target,this.options)),function(t,e){try{if("bav2b_change"===t)return e.hasAttribute("data-tea-track")?{value:e.value}:{}}catch(t){return{}}}(i,e.target));case"submit":return so(i="bav2b_submit",e,e.target,this.options)}}catch(t){return console.error(t),null}},e.prototype.handleViewEvent=function(t){t.event=this.eventName.page,t.page_title=document.title,t.page_total_width=window.innerWidth,t.page_total_height=window.innerHeight;try{var e=window.sessionStorage&&window.sessionStorage.getItem("_tea_cache_duration");if(e){var n=JSON.parse(e);t.refer_page_duration_ms=n?n.duration:""}t.scroll_width=document.documentElement.scrollLeft?document.documentElement.scrollLeft+window.innerWidth:window.innerWidth,t.scroll_height=document.documentElement.scrollTop?document.documentElement.scrollTop+window.innerHeight:window.innerHeight,t.page_start_ms=window.performance.timing.navigationStart}catch(t){console.log("page event error ".concat(JSON.stringify(t)))}return t},e.prototype.handleStatisticsEvent=function(t){var e={};e.event=this.eventName.static,e.is_html=1,e.page_key=location.href,e.refer_page_key=document.referrer||"",e.page_title=document.title,e.page_manual_key=this.initConfig.autotrack.page_manual_key||"",e.refer_page_manual_key="";try{var n=t.lcp,i=window.performance.timing,r=i.loadEventEnd-i.navigationStart;e.page_init_cost_ms=parseInt(n||(r>0?r:0)),e.page_start_ms=i.navigationStart}catch(t){console.log("page_statistics event error ".concat(JSON.stringify(t)))}return e},e.prototype.handleBeadtEvent=function(t){t.event=this.eventName.beat,t.page_key=window.location.href,t.is_html=1,t.page_title=document.title,t.page_manual_key=this.initConfig.autotrack.page_manual_key||"";try{t.page_viewport_width=window.innerWidth,t.page_viewport_height=window.innerHeight,t.page_total_width=document.documentElement.scrollWidth,t.page_total_height=document.documentElement.scrollHeight,t.scroll_width=document.documentElement.scrollLeft+window.innerWidth,t.scroll_height=document.documentElement.scrollTop+window.innerHeight,t.since_page_start_ms=Date.now()-window.performance.timing.navigationStart,t.page_start_ms=window.performance.timing.navigationStart}catch(t){console.log("beat event error ".concat(JSON.stringify(t)))}return t},e.prototype.handleExposureEvent=function(t,e){if(Wr(e.target))return null;var n=so(t.event||this.eventName.exposure,e,e.target||e,this.options,this.ignore);if(n.$exposure_type=t.exposureType,this.options.exposure.callback){var i=this.options.exposure.callback(n);return i||Object.keys(i).length?i:(console.warn("exposure callback must return data!"),n)}return n},e.prototype.handleScrollEvent=function(t,e){var n=so(t.event||this.eventName.scroll,e,e.target||e,this.options,this.ignore);if(n=Object.assign(n,t.params),!this.options.scroll.callback||(n=this.options.scroll.callback(n))||Object.keys(n).length)return n;console.warn("scroll callback must return data!")},e}(),uo=function(){function t(t){this.collect=t}return t.prototype.send=function(t,e){var n=e.event;delete e.event,t&&"becon"===t.eventSend?this.collect.beconEvent(n,e):this.collect.event(n,e)},t.prototype.get=function(t,e){var n=Object.assign({headers:{"content-type":"application/json"},method:"GET"},e);fetch(t,n)},t.prototype.post=function(t,e){var n=Object.assign({headers:{"content-type":"application/json"},method:"POST"},e);fetch(t,n)},t}(),ho=function(){function t(t,e){this._instance=null,this._intersection=t,this.config=e,this._intersection&&this.init()}return t.prototype.init=function(){var t=this;if(window.MutationObserver)try{if(this._instance=new MutationObserver(function(e){e.forEach(function(e){"attributes"===e.type&&t.attributeChangeObserve(e),"childList"===e.type&&t.modifyNodeObserve(e)})}),!document||!document.body)return void console.warn("please use sdk api init after body element");var e=!1!==this.config.autotrack.exposure.attributes;this._instance.observe(document.body,{childList:!0,attributes:e,subtree:!0,attributeOldValue:!1})}catch(t){console.log("your browser cannot support MutationObservero cannot report exposure event, please update")}else console.log("your browser cannot support MutationObservero cannot report exposure event, please update")},t.prototype.attributeChangeObserve=function(t){t.target.hasAttribute("data-exposure")?this.exposureAdd(t,"mutation"):this.exposureRemove(t)},t.prototype.modifyNodeObserve=function(t){var e=this;Array.prototype.forEach.call(t.addedNodes,function(t){1===t.nodeType&&t.hasAttribute("data-exposure")&&e.exposureAdd(t,"intersect"),e.mapChild(t,e.exposureAdd.bind(e))}),Array.prototype.forEach.call(t.removedNodes,function(t){1===t.nodeType&&t.hasAttribute("data-exposure")&&e.exposureRemove(t),e.mapChild(t,e.exposureRemove.bind(e))})},t.prototype.mapChild=function(t,e){var n=this;1===t.nodeType&&t.children.length&&Array.prototype.forEach.call(t.children,function(t){1===t.nodeType&&t.hasAttribute("data-exposure")&&e(t),n.mapChild(t,e)})},t.prototype.exposureAdd=function(t,e){try{this._intersection&&this._intersection.exposureAdd(t,e)}catch(t){console.log("intersection error",JSON.stringify(t.message))}},t.prototype.exposureRemove=function(t){try{this._intersection&&this._intersection.exposureRemove(t)}catch(t){console.log("intersection error",JSON.stringify(t.message))}},t._exposure_observer=null,t}();!function(t){t[t.EXPOSURE_ONCE=0]="EXPOSURE_ONCE",t[t.LIFECYCLE_SHOW_NEW=3]="LIFECYCLE_SHOW_NEW",t[t.RESUME_FORM_PAGE=6]="RESUME_FORM_PAGE",t[t.RESUME_FORM_BACK=7]="RESUME_FORM_BACK",t[t.NOT_EXPOSURE=-1]="NOT_EXPOSURE"}(ao||(ao={}));var lo,fo=function(){function t(e,n,i){var r=this;this.backStatus=!1,this.instance=this.buildObserver(),this.collect=e,this.observeMap=t._observer_map,n.autotrack.exposure.ratio?this.ratio=n.autotrack.exposure.ratio:0===n.autotrack.exposure.ratio?this.ratio=0:this.ratio=.5,this.timeLimit=n.autotrack.exposure.stay||0,this.exposureType=ao.NOT_EXPOSURE,this.eventHandle=i,this.hashMap=new Map,this.backStatus=!1,this.lastState=null,this.collect.on("re-start-sdk",function(){r.visibilitychange()}),this.addListen()}return t.prototype.buildObserver=function(){var e=this;if(t._observer_instance)return console.log("your browser cannot support IntersectionObserver so cannot report exposure event, please update"),null;if(window.IntersectionObserver){for(var n=[],i=0;i<=1;i+=.01)n.push(i);n.push(1);try{t._observer_instance=new IntersectionObserver(function(t){t.forEach(function(t){var n=t.target.observeId,i=e.observeMap.get(n),r=(t.target,t.isIntersecting,t.intersectionRatio);if(i.intersectionRatio=r,r<=.1&&(t.target.backStatus=!1),e.observeMap.set(n,i),r<e.ratio)return i.isIntersecting=!1,i.added=!1,i.exposured=!1,i.startTime=Date.now(),void e.observeMap.set(n,i);if(!i.added){if(i.startTime=Date.now(),i.added=!0,i.isIntersecting=!0,e.timeLimit){var o=setTimeout(function(){try{if(i.isIntersecting&&!i.exposured&&e.observeMap.get(n)){var r=e.observeMap.get(n).intersectionRatio;e.exposureEvent(t,r,n,i)}}catch(t){console.log("IntersectionObserver setTimeout errorsg: ".concat(JSON.stringify(t)))}},e.timeLimit);i.wait=o}e.observeMap.set(n,i)}Date.now()-i.startTime>=e.timeLimit&&!i.exposured&&e.exposureEvent(t,r,n,i)})},{threshold:n})}catch(t){console.log("IntersectionObserver errorsg: ".concat(JSON.stringify(t)))}return t._observer_instance}return console.log("your browser cannot support IntersectionObserver so cannot report exposure event, please update"),null},t.prototype.exposureAdd=function(t,e){var n="mutation"===e?t.target:t,i=n.observeId,r=mt();if(i||this.observeMap.has(i)){var o=this.observeMap.get(i);if(o&&n!==o.instance)this.unobserve(n),this.observeMap.delete(i),n.observeId=r,n.visible=!1,this.observeMap.set(r,{instance:n.cloneNode(!0),isIntersecting:!1}),this.observe(n);else{if(!0===n.visible)return;this.handleBoundingExposure(n)}}else n.observeId=r,n.visible=!1,this.observeMap.set(r,{instance:n.cloneNode(!0),isIntersecting:!1}),this.observe(n)},t.prototype.exposureRemove=function(t){this.observeMap.has(t.observeId)&&(this.observeMap.delete(t.observeId),this.unobserve(t),t.observeId="",t.visible=!1)},t.prototype.exposureEvent=function(t,e,n,i){if(e>=this.ratio){if("0"===t.target.style.opacity||"hidden"===t.target.style.visibility)return;if(!0===i.exposured)return;i.startWait&&clearTimeout(i.startWait);var r=t.target.getAttribute("data-exposure-event");this.eventHandle({eventType:"dom",eventName:"exposure",event:r,exposureType:this.getExposureType(t.target)},t),t.target.visible=!0,t.target.hasExposure=!0,i.startTime=Date.now(),i.exposured=!0}else i.startTime=Date.now(),i.exposured=!1;this.observeMap.set(n,i)},t.prototype.observe=function(t){this.instance&&this.instance.observe(t)},t.prototype.unobserve=function(t){this.instance&&this.instance.unobserve(t)},t.prototype.getExposureDomToExposure=function(){var t=this;Array.prototype.forEach.call(document.querySelectorAll("[data-exposure]"),function(e){t.handleBoundingExposure(e)})},t.prototype.visibilitychange=function(){var t=this,e=null;"visible"===document.visibilityState?this.timeLimit?e=setTimeout(function(){t.getExposureDomToExposure()},this.timeLimit):this.getExposureDomToExposure():(clearTimeout(e),this.customType=void 0)},t.prototype.handleBoundingExposure=function(t){if(this.getBoundingRatio(t)>=this.ratio){t.visible=!0;var e=t.getAttribute&&t.getAttribute("data-exposure-event");this.eventHandle({eventType:"dom",eventName:"exposure",event:e,exposureType:this.customType||ao.RESUME_FORM_BACK},t)}},t.prototype.getBoundingRatio=function(t){var e=t.getBoundingClientRect(),n=e.top,i=e.left,r=e.width,o=e.height,a=window.innerWidth||document.documentElement.clientWidth,s=window.innerHeight||document.documentElement.clientHeight;return n>=0&&i>=0&&n<=s&&i<=a?(r>a?a:r)*(s-n)/(r*o):0},t.prototype.getExposureType=function(t){return t.visible?!1!==t.backStatus&&(this.backStatus||this.customType||2===window.performance.navigation.type)?this.exposureType=ao.RESUME_FORM_PAGE:this.exposureType=ao.LIFECYCLE_SHOW_NEW:(t.hasExposure,!1!==t.backStatus&&(this.backStatus||this.customType||2===window.performance.navigation.type)?this.exposureType=ao.RESUME_FORM_PAGE:this.exposureType=ao.EXPOSURE_ONCE),this.exposureType},t.prototype.addListen=function(){var t=this;this.collect.on("set-exposure-type",function(e){t.customType=e});var e=this.visibilitychange.bind(this);if(g(document,"visibilitychange",e,!1),window.addEventListener("hashchange",function(e){var n=t.hashMap.get(e.oldURL);n&&location.href===n.prev?(t.backStatus=!0,t.exposureType=ao.RESUME_FORM_PAGE):(t.backStatus=!1,t.hashMap.set(location.href,{current:e.newURL,prev:e.oldURL}))}),this.collect.bridgeReport){var n=window.history.pushState;history.pushState=function(e){for(var i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];"function"==typeof history.onpushstate&&history.onpushstate({state:e});var s=n.call.apply(n,a([history,e],o(i)));return t.lastState=e,s};var i=history.replaceState;history.replaceState=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];"function"==typeof history.onreplacestate&&history.onreplacestate({state:e});var s=i.call.apply(i,a([history,e],o(n)));return t.lastState=e,s}}else this.collect.on("STATE_CHANGE",function(e){t.lastState=e});return window.addEventListener("popstate",function(e){var n=e.state;n&&n.current&&t.lastState&&t.lastState.back&&n.current===t.lastState.back?(t.backStatus=!0,t.exposureType=ao.RESUME_FORM_PAGE):t.backStatus=!1}),function(){m(document,"visibilitychange",e,!1)}},t._observer_instance=null,t._observer_map=new Map,t}(),po=function(){function t(t,e,n){e.autotrack&&e.autotrack.exposure&&(this._intersection=new fo(t,e,n),this._observer=new ho(this._intersection,e),this._intersection&&this._observer?this.initObserver():console.log("your browser version cannot support exposure event, please update~"))}return t.prototype.initObserver=function(){var t=this;Array.prototype.forEach.call(document.querySelectorAll("[data-exposure]"),function(e){t._intersection.exposureAdd(e,"intersect")})},t}();!function(t){t[t.SCROLL_UP=1]="SCROLL_UP",t[t.SCROLL_DOWN=2]="SCROLL_DOWN",t[t.SCROLL_LEFT=3]="SCROLL_LEFT",t[t.SCROLL_RIGHT=4]="SCROLL_RIGHT",t[t.NOT_SCROLL=-1]="NOT_SCROLL"}(lo||(lo={}));var go=function(){function t(t,e){this.distance=30,t.autotrack&&t.autotrack.scroll&&(t.autotrack.scroll.distance&&(this.distance=t.autotrack.scroll.distance),this.eventHandle=e,this.addLinstenr(),this.mutation())}return t.prototype.addLinstenr=function(){var t=this;Array.prototype.forEach.call(document.querySelectorAll("[data-scroll]"),function(e){t.scrollHandle(e)})},t.prototype.mutation=function(){var t=this;if(window.MutationObserver)try{var e=new MutationObserver(function(e){e.forEach(function(e){"childList"===e.type&&t.modifyNodeObserve(e)})});if(!document||!document.body)return void console.warn("please use sdk api init after body element");e.observe(document.body,{childList:!0,attributes:!0,subtree:!0,attributeOldValue:!1})}catch(t){console.log("your browser cannot support MutationObserver")}else console.log("your browser cannot support MutationObserver")},t.prototype.modifyNodeObserve=function(t){var e=this;Array.prototype.forEach.call(t.addedNodes,function(t){1===t.nodeType&&t.hasAttribute("data-scroll")&&e.scrollHandle(t),e.mapChild(t,e.scrollHandle.bind(e))}),Array.prototype.forEach.call(t.removedNodes,function(t){1===t.nodeType&&t.hasAttribute("data-scroll")&&e.scrollHandle(t,"remove"),e.mapChild(t,e.scrollHandle.bind(e))})},t.prototype.mapChild=function(t,e){var n=this;1===t.nodeType&&t.children.length&&Array.prototype.forEach.call(t.children,function(t){1===t.nodeType&&t.hasAttribute("data-scroll")&&e(t),n.mapChild(t,e)})},t.prototype.scrollHandle=function(t,e){var n=this;try{var i=t.scrollTop,r=t.scrollLeft,o=null,a=0,s=0,c=function(e){clearTimeout(o),o=setTimeout(function(){var o=t.scrollTop,l=t.scrollLeft,f=e.target&&e.target.getAttribute("data-scroll-event")||"";1===h||2===h?o===c&&(s=c-i,Math.abs(s)>=n.distance&&n.distance&&n.eventHandle({eventType:"dom",eventName:"scroll",event:f,params:{$direction:h,$offsetY:s,$offsetX:a}},e)):3!==h&&4!==h||l===u&&(a=u-r,Math.abs(a)>=n.distance&&n.distance&&n.eventHandle({eventType:"dom",eventName:"scroll",event:f,params:{$direction:h,$offsetY:s,$offsetX:a}},e)),i=c,r=u},100);var c=t.scrollTop,u=t.scrollLeft,h=lo.NOT_SCROLL;c>i?h=lo.SCROLL_DOWN:c<i?h=lo.SCROLL_UP:u>r?h=lo.SCROLL_LEFT:u<r&&(h=lo.SCROLL_RIGHT)};return"remove"===e?t.removeEventListener("scroll",c,!1):t.addEventListener("scroll",c,!1),function(){t.removeEventListener("scroll",c,!1)}}catch(t){console.warn("scroll event error",JSON.stringify(t))}},t}(),mo={hashTag:!1,impr:!1},vo=function(){function t(){}return t.prototype.apply=function(t,e){if(this.autoTrackStart=!1,this.collect=t,this.config=e,e.autotrack){var n=t.configManager.getSettingData("bav_log_collect");if((!l(n)||n)&&(!e.autotrack||!e.autotrack.collect_url||e.autotrack.collect_url())){var i=t.Types;this.ready(i.Autotrack),this.collect.emit(i.AutotrackReady)}}},t.prototype.ready=function(t){this.collect.set(t);var e=this.config.autotrack;e="object"==typeof e?e:{},e=Object.assign(mo,e),this.destroyed=!1,this.options=e,this.Config=new io(no,this.options),this.Exposure=new po(this.collect,this.config,this.handle.bind(this)),this.Scroll=new go(this.config,this.handle.bind(this)),this.Listener=new eo(e,this.collect,this.Config),this.EventHandle=new co(this.config,e),this.Request=new uo(this.collect),this.autoTrackStart=!0,this.init()},t.prototype.init=function(){this.Listener.init(this.handle.bind(this))},t.prototype.handle=function(t,e){try{if(this.config.autotrack.collect_url&&!this.config.autotrack.collect_url())return}catch(t){}this.collect.sdkStop||"dom"===t.eventType&&this.handleDom(t,e)},t.prototype.handleDom=function(t,e){try{var n=t.eventName;if("click"===n||"change"===n||"submit"===n)(a=this.EventHandle.handleEvent(e,n))&&this.Request.send({eventType:"custom"},a);else if("page_view"===n||"page_statistics"===n){var i=void 0;(i="page_view"===n?this.EventHandle.handleViewEvent(e):this.EventHandle.handleStatisticsEvent(e))&&this.Request.send({eventType:"custom"},i)}else if("beat"===n){var r=this.EventHandle.handleBeadtEvent(e),o=t.eventSend;r&&this.Request.send({eventType:"custom",eventSend:o},r)}else if("exposure"===n){(a=this.EventHandle.handleExposureEvent(t,e))&&this.Request.send({eventType:"custom"},a)}else if("scroll"===n){var a;(a=this.EventHandle.handleScrollEvent(t,e))&&this.Request.send({eventType:"custom"},a)}}catch(t){console.log("handel dom event error ".concat(JSON.stringify(t)))}},t.prototype.destroy=function(){if(!this.autoTrackStart)return console.warn("engine is undefined, make sure you have called autoTrack.start()");this.autoTrackStart=!1,this.Listener.removeListener()},t}();try{var _o=bi();_o&&(_o.LogAutoTrack=function(t,e){(new vo).apply(t,e)})}catch(t){}var yo=function(){function t(){this.verifyReady=!1,this.cleanStatus=!1}return t.prototype.apply=function(t,e){var n=this;z()||(this.collector=t,this.config=e,this.eventStorage=[],this.collector.on("submit-verify-h5",function(t){t&&t.length&&n.eventStore(t[0])}),this.checkUrl(),this.heartbeat())},t.prototype.checkUrl=function(){var t=window.location.href,e=S(t);e._r_d_&&e._r_c_k_?(this.verifyReady=!0,this.domain=e._r_d_,this.key=e._r_c_k_,this.checkCache()):this.collector.off("submit-verify-h5")},t.prototype.checkCache=function(){this.eventStorage.length&&this.postVerify(this.eventStorage)},t.prototype.heartbeat=function(){var t=this;this.heart=setInterval(function(){var e={event:"simulator_test__",local_time_ms:Date.now()},n=t.collector.configManager.get(),i=n.header,r={events:[e],user:n.user,header:i};t.eventStore(r)},6e4)},t.prototype.eventStore=function(t){this.cleanStatus||(this.verifyReady?this.postVerify(t):this.eventStorage.push(t))},t.prototype.cleanVerify=function(){this.cleanStatus=!0,this.eventStorage=[],clearInterval(this.heart)},t.prototype.postVerify=function(t){var e=this;try{var n=JSON.parse(JSON.stringify(t));h(t)?n.forEach(function(t){e.fetchLog(t)}):this.fetchLog(n)}catch(t){console.log("web verify post error ~")}},t.prototype.fetchLog=function(t){this.collector.requestManager.useRequest({url:"".concat(this.domain,"/simulator/h5/log?connection_key=").concat(this.key),data:t,timeout:2e4})},t.prototype.leave=function(){var t=this;document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState&&t.cleanVerify()}),_(function(){t.cleanVerify()})},t}(),bo=function(){function t(){this.errorCache=new Map,this.sleepTime=1e3,this.maxTime=16e3,this.minTime=1e3,this.goodCount=0,this.maxGoodCount=2,this.maxSilceCount=50,this.sendStatus=!1,this.firstTrigger=!0,this.degradeStarted=!1,this.backoff_ratio=0,this.tempId=[],this.queue=Promise.resolve(),this.enableDegrade=!1}return t.prototype.apply=function(t,e){var r=this;try{if(t.destroy)return;this.collect=t,this.config=e,this.storage=new L("applog_sdk_event_store_".concat(e.app_id),"DEGRADE_EVENT_STORE"),this.enableDegrade=e.enable_degrade||!1,this.eventUrl=this.collect.configManager.getUrl("event"),this.eventKey="__applog_degrade_events",this.eventSleepTimeKey="__applog_degrade_events_sleep_time",this.collect.on("http-error",function(t){return n(r,void 0,void 0,function(){var e=this;return i(this,function(n){switch(n.label){case 0:return this.enableDegrade&&this.triggerDegrade(t),this.queue=this.queue.then(function(){return e.addErrorEventToCache(t)}),[4,this.queue];case 1:return n.sent(),this.enableDegrade&&this.firstTrigger&&(this.tryReportDataFromDB(),this.firstTrigger=!1),[2]}})})}),this.collect.on("submit-degrade",function(t){return n(r,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:return[4,this.addDegradeEventToCache(t)];case 1:return e.sent(),[2]}})})}),this.collect.on("http-ok",function(){r.deleteDataFromDB()}),this.checkStorage()}catch(t){this.collect.emit("sdk-inner-error",{type:"sdk_error_inner",errorCode:1e3,msg:t.message||t.stack||"sdk_error_degrage"})}},t.prototype.getSleepTime=function(){return n(this,void 0,void 0,function(){var t;return i(this,function(e){switch(e.label){case 0:return t=this,[4,this.storage.getItem(this.eventSleepTimeKey)];case 1:return t.sleepTime=e.sent()||this.sleepTime,console.log(this.sleepTime),[2]}})})},t.prototype.triggerDegrade=function(t){try{if(console.log("degradeInfo",t),"degrade"===t.status)return void this.addSleepTime();this.degradeStarted=!0,this.collect.degradeStarted=!0}catch(t){console.log("trigger degrade error",JSON.stringify(t))}},t.prototype.checkStorage=function(){return n(this,void 0,void 0,function(){var t,e;return i(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.storage.getItem(this.eventKey)];case 1:return(t=n.sent())&&t.size?(this.tryReportDataFromDB(),[3,3]):[2];case 2:return e=n.sent(),console.log("check storage error"),this.collect.emit("sdk-inner-error",{type:"sdk_error_inner",errorCode:1e3,msg:e.message||e.stack||"sdk_error_degrage_checkstorage"}),[3,3];case 3:return[2]}})})},t.prototype.getDatafromDBToSlice=function(){return n(this,void 0,void 0,function(){var t,e,n,a,s,c,u,h,l,f,p,d=this;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.storage.getItem(this.eventKey)];case 1:if(t=i.sent(),e=new Map,n=[],this.tempId=[],!t.size)return[2,[]];if(t.size<=this.maxSilceCount)e=t;else try{for(a=r(t),s=a.next();!s.done&&(c=o(s.value,2),u=c[0],h=c[1],e.size<this.maxSilceCount);s=a.next())e.set(u,h)}catch(t){f={error:t}}finally{try{s&&!s.done&&(p=a.return)&&p.call(a)}finally{if(f)throw f.error}}return e.forEach(function(t){var e;(null===(e=t.eventData)||void 0===e||e)&&(n.push(t.eventData[0]),d.tempId.push(t.id))}),[2,n];case 2:return l=i.sent(),this.collect.emit("sdk-inner-error",{type:"sdk_error_inner",errorCode:1e3,msg:l.message||l.stack||"sdk_error_degrage_getDatafromDBToSlice"}),[2,[]];case 3:return[2]}})})},t.prototype.addErrorEventToCache=function(t){return n(this,void 0,void 0,function(){var e,n;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),e=t.data,"degrade"===t.status?[2]:[4,this.addDegradeEventToCache(e)];case 1:return i.sent(),[3,3];case 2:return n=i.sent(),console.log("addErrorEventToCache error",JSON.stringify(n)),this.collect.emit("sdk-inner-error",{type:"sdk_error_inner",errorCode:1e3,msg:n.message||n.stack||"sdk_error_degrage_addErrorEventToCache"}),[3,3];case 3:return[2]}})})},t.prototype.addDegradeEventToCache=function(t){return n(this,void 0,void 0,function(){var e,n,r;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.storage.getItem(this.eventKey)];case 1:return(e=i.sent())||(e=new Map),n=mt(),e.set(n,{eventData:t,id:n}),this.setDataToDB(e),[3,3];case 2:return r=i.sent(),console.log("addDegradeEventToCache error",JSON.stringify(r)),this.collect.emit("sdk-inner-error",{type:"sdk_error_inner",errorCode:1e3,msg:r.message||r.stack||"sdk_error_degrage_addDegradeEventToCache"}),[3,3];case 3:return[2]}})})},t.prototype.setDataToDB=function(t){try{this.storage.setItem(this.eventKey,t)}catch(e){console.log("set data to DB error",e.message),this.dropEvents(t),this.collect.emit("sdk-inner-error",{type:"sdk_error_inner",errorCode:1e3,msg:e.message||e.stack||"sdk_error_degrage_setDataToDB"})}},t.prototype.dropEvents=function(t){try{var e=this.collect.configManager.get(),n=e.user,i=e.header;i.app_id=1338;var r=[];t.forEach(function(t){var e=t.event,n=t.local_time_ms;r.push({eventName:e,eventTime:n})});var o={events:[{event:"sdk_monitor",params:JSON.stringify({storage_fails:r}),local_time_ms:Date.now()}],user:n,header:i};this.collect.requestManager.useRequest({url:this.eventUrl,data:o,timeout:3e4,type:"event"})}catch(t){console.log("drop data error",JSON.stringify(t))}},t.prototype.tryReportDataFromDB=function(){var t=this;if(!this.sendStatus)try{this.sleepFn=setTimeout(function(){return n(t,void 0,void 0,function(){var t;return i(this,function(e){switch(e.label){case 0:return[4,this.getDatafromDBToSlice()];case 1:return(t=e.sent()).length?(this.fetchData(t),[2]):(clearTimeout(this.sleepFn),[2])}})})},this.sleepTime)}catch(t){console.warn("error check storage"),this.collect.emit("sdk-inner-error",{type:"sdk_error_inner",errorCode:1e3,msg:t.message||t.stack||"sdk_error_degrage_tryReportDataFromDB"})}},t.prototype.addSleepTime=function(){this.sendStatus=!1,this.sleepTime=2*this.sleepTime,this.sleepTime>this.maxTime&&(this.sleepTime=this.maxTime),this.storage.setItem(this.eventSleepTimeKey,this.sleepTime),this.sleepFn&&clearTimeout(this.sleepFn),this.tryReportDataFromDB()},t.prototype.deleteDataFromDB=function(){return n(this,void 0,void 0,function(){var t,e;return i(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),this.sendStatus=!1,this.enableDegrade&&(this.goodCount+=1,this.goodCount===this.maxGoodCount&&(this.goodCount=0,this.sleepTime=this.sleepTime/2),this.sleepTime<=this.minTime&&(this.sleepTime=this.minTime,this.degradeStarted=!1,this.collect.degradeStarted=!1)),clearTimeout(this.sleepFn),[4,this.storage.getItem(this.eventKey)];case 1:return t=n.sent(),this.tempId.length&&t&&(this.tempId.forEach(function(e){t.delete(e)}),this.tempId=[],this.setDataToDB(t)),[4,this.reportRestData()];case 2:return n.sent(),[3,4];case 3:return e=n.sent(),console.warn("deleteDataFromDB error"),this.collect.emit("sdk-inner-error",{type:"sdk_error_inner",errorCode:1e3,msg:e.message||e.stack||"sdk_error_degrage_deleteDataFromDB"}),[3,4];case 4:return[2]}})})},t.prototype.reportRestData=function(){return n(this,void 0,void 0,function(){var t;return i(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.storage.getItem(this.eventKey)];case 1:return(t=e.sent())&&t.size?(this.tryReportDataFromDB(),[3,3]):[2];case 2:return e.sent(),[3,3];case 3:return[2]}})})},t.prototype.random=function(){return Math.floor(1e4*Math.random())},t.prototype.fetchData=function(t){var e=this;this.sendStatus=!0,this.collect.requestManager.useRequest({url:this.eventUrl,data:t,timeout:3e4,type:"event",status:"degrade",success:function(){e.sendStatus=!1}})},t.prototype.destroy=function(){this.collect.off("http-error"),this.collect.off("http-ok")},t}();try{var wo=bi();wo&&(wo.LogStore=function(t,e){(new bo).apply(t,e)})}catch(t){console.log(t)}var Eo=function(){function t(){this.autotrack=!1,this.spa=!1,this.cache={},this.allowHash=!1}return t.prototype.apply=function(t,e){if(e.spa||e.autotrack){var n=t.Types;this.collect=t,this.config=e,this.appid=e.app_id,this.allowHash=e.allow_hash,this.fncArray=new Map,this.setKey(),this.setLocation(),this.hack(),this.init(),this.listener(),t.emit(n.RouteReady)}},t.prototype.setKey=function(){var t=this.collect.adapters.storage;this.storage=new t(!1),this.cache_key="__tea_cache_refer_".concat(this.appid),this.cache={refer_key:"",refer_title:document.title||location.pathname,refer_manual_key:"",routeChange:!1},this.config.autotrack&&"object"==typeof this.config.autotrack&&this.config.autotrack.page_manual_key&&(this.cache.refer_manual_key=this.config.autotrack.page_manual_key),this.storage.setItem(this.cache_key,this.cache)},t.prototype.hack=function(){var t=this,e=window.history.pushState;history.pushState=function(n){for(var i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];"function"==typeof history.onpushstate&&history.onpushstate({state:n});var s=e.call.apply(e,a([history,n],o(i)));if(t.collect.emit("STATE_CHANGE",n),t.lastLocation===location.href)return s;t.setReferCache(t.lastLocation);var c=t.getPopStateChangeEventData();return t.lastLocation=location.href,t.sendPv(c,"pushState"),s};var n=history.replaceState;history.replaceState=function(e){for(var i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];"function"==typeof history.onreplacestate&&history.onreplacestate({state:e});var s=n.call.apply(n,a([history,e],o(i)));if(t.collect.emit("STATE_CHANGE",e),t.lastLocation===location.href)return s;t.setReferCache(t.lastLocation);var c=t.getPopStateChangeEventData();return t.lastLocation=location.href,t.sendPv(c),s}},t.prototype.setLocation=function(){"undefined"!=typeof window&&(this.lastLocation=window.location.href)},t.prototype.getLocation=function(){return this.lastLocation},t.prototype.init=function(){var t=this.getPopStateChangeEventData();this.collect.emit("route-change",{config:t,init:!0})},t.prototype.listener=function(){var t=this,e=null;window.addEventListener("hashchange",function(n){if(t.lastLocation!==window.location.href&&(clearTimeout(e),t.allowHash)){t.setReferCache(t.lastLocation),t.lastLocation=window.location.href;var i=t.getPopStateChangeEventData();t.sendPv(i)}}),window.addEventListener("popstate",function(n){t.lastLocation!==window.location.href&&(e=setTimeout(function(){t.setReferCache(t.lastLocation),t.lastLocation=window.location.href;var e=t.getPopStateChangeEventData();t.sendPv(e)},10))})},t.prototype.getPopStateChangeEventData=function(){var t=this.pageConfig();return t.is_back=0,t},t.prototype.pageConfig=function(){try{var t=this.storage.getItem(this.cache_key)||{},e=!1,n=this.storage.getItem("__tea_cache_first_".concat(this.appid));return e=!n||1!=n,{is_html:1,url:location.href,referrer:this.handleRefer(),page_key:location.href,refer_page_key:this.handleRefer(),page_title:document.title||location.pathname,page_manual_key:this.config.autotrack&&this.config.autotrack.page_manual_key||"",refer_page_manual_key:t&&t.refer_manual_key||"",refer_page_title:t&&t.refer_title||"",page_path:this.collect.handlePath(),url_path:this.collect.handlePath(),page_host:location.host,is_first_time:"".concat(e)}}catch(t){return this.collect.emit(W.DEBUGGER_MESSAGE,{type:W.DEBUGGER_MESSAGE_SDK,info:"",level:"error",time:Date.now(),data:t.message}),{}}},t.prototype.sendPv=function(t,e){this.collect.emit("route-change",{config:t,init:!1})},t.prototype.handleRefer=function(){var t="";try{var e=this.storage.getItem(this.cache_key)||{};t=e.routeChange?e.refer_key:this.collect.configManager.get("referrer")}catch(e){t=document.referrer}return t},t.prototype.setReferCache=function(t){var e=this.storage.getItem(this.cache_key)||{};e.refer_key=t,e.routeChange=!0,this.storage.setItem(this.cache_key,e)},t}();try{var So=bi();So&&(So.LogRoute=function(t,e){(new Eo).apply(t,e)})}catch(t){console.log(t)}var ko=function(){function t(){}return t.prototype.apply=function(t,e){var n=this;this.collector=t,this.config=e;var i=t.Types;t.on(i.TrackDurationStart,function(t){n.trackStart(t)}),t.on(i.TrackDurationEnd,function(t){n.trackEnd(t)}),t.on(i.TrackDurationPause,function(t){n.trackPause(t)}),t.on(i.TrackDurationResume,function(t){n.trackResume(t)}),this.Types=i,this.TrackMap=new Map,this.ready(i.TrackDuration)},t.prototype.ready=function(t){var e=this;if(this.collector.set(t),this.collector.hook._hooksCache.hasOwnProperty(t)){var n=this.collector.hook._hooksCache[t];if(!Object.keys(n).length)return;var i=function(t){n[t].length&&n[t].forEach(function(n){e.collector.hook.emit(t,n)})};for(var r in n)i(r)}},t.prototype.trackStart=function(t){this.TrackMap.set(t,{startTime:Date.now(),isPause:!1,pauseTime:0,resumeTime:0})},t.prototype.trackEnd=function(t){var e=t.eventName,n=t.params;if(this.TrackMap.has(e)){var i=this.TrackMap.get(e),r=0;r=i.isPause?i.pauseTime-i.startTime:i.resumeTime?i.pauseTime-i.startTime+(Date.now()-i.resumeTime):Date.now()-i.startTime;var o=Object.assign(n,{event_duration:r});this.collector.event(e,o),this.cleanTrack(e)}},t.prototype.trackPause=function(t){if(this.TrackMap.has(t)){var e=this.TrackMap.get(t);e.isPause||(e.isPause=!0,e.pauseTime=Date.now(),this.TrackMap.set(t,e))}},t.prototype.trackResume=function(t){if(this.TrackMap.has(t)){var e=this.TrackMap.get(t);e.isPause&&(e.isPause=!1,e.resumeTime=Date.now(),this.TrackMap.set(t,e))}},t.prototype.cleanTrack=function(t){this.TrackMap.delete(t)},t}(),To=function(){function t(){this.privateMode=!1}return t.prototype.apply=function(t,e){this.collector=t,this.config=e,this.dynamicEditorUrl="",this.privateMode=!!e.channel_domain,window.TEAVisualEditor=window.TEAVisualEditor||{},window.TEAVisualEditor.appId=e.app_id,this.dynamicUrl(),this.init()},t.prototype.init=function(){this.config.autotrack||(Dr(["*"]),this.addMessage()),this.reviceMessage()},t.prototype.addMessage=function(){window.addEventListener("message",xr,!1)},t.prototype.reviceMessage=function(){var t=this;try{Ar("tea:openHeatMapCore",function(e){var n=v("1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1bz18z22z18z4az24z1mz1jz1az1az1bz1lz4az1az1mz1kz4bz1mz19z1hz4bz1bz18z22z18z49z21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz1fz1cz18z22z1kz18z1nz49z1az1mz20z1c");n=t.privateMode&&t.dynamicEditorUrl?"".concat(t.dynamicEditorUrl,"/heatmap-core.2.2.0"):"".concat(n,".2.2.0"),t.loadScriptUrl({event:e,url:"".concat(n,".js?query=").concat(Date.now())})})}catch(t){console.log("openHeatMapCore error"),this.collector.emit("sdk-inner-error",{type:"sdk_error_load_heatmap",errorCode:1e3,msg:t.message||t.stack||"sdk_error_load_heatmap"})}},t.prototype.loadScriptUrl=function(t){var e=t.event,n=t.url;y(n,function(){zr(e,"".concat(n," ScriptloadSuccess"))},function(){e&&zr(e,"".concat(n," ScriptloadFail"))})},t.prototype.dynamicUrl=function(){if(this.privateMode){var t="",e="";try{var n=window.performance.getEntriesByType("resource");if(n&&n.length){var i=this.config.remote_file_protocol?"".concat(this.config.remote_file_protocol,":"):location.protocol;if(i=i||"https:",n.forEach(function(t){"script"===t.initiatorType&&t.name&&-1!==t.name.indexOf("collect")&&(e=t.name)}),e||document.currentScript&&(e=document.currentScript.src),e&&(t=e.split("/"))&&t.length){this.dynamicEditorUrl="".concat(i,"/");for(var r=2;r<t.length&&r!==t.length-1;r++)this.dynamicEditorUrl=this.dynamicEditorUrl+"/".concat(t[r]);if(this.dynamicEditorUrl&&this.dynamicEditorUrl.indexOf("/5.0")){var o=this.dynamicEditorUrl.split("/5.0");this.dynamicEditorUrl=o[0]||this.dynamicEditorUrl}}}}catch(t){this.collector.emit("sdk-inner-error",{type:"sdk_error_parsing_remote_url",errorCode:1e3,msg:t.message||t.stack||"sdk_error_parsing_remote_url"})}}},t}(),Do=["getConfig","getAbSdkVersion"],zo=["init","usePlugin","autoInitializationRangers","on"],Ao=new Set(["init","usePlugin","autoInitializationRangers","on"]),xo=function(){function t(t){this.task=[],this.newProcessTask=[],this.processMap=!1,this.Collector=t,this.collectMap=new Map,this.processMap=new Map,this.taskMap=new Map}return t.prototype.processTask=function(){var t=this;if(Array.isArray(this.task))try{this.task.length&&(this.task.forEach(function(e){var n=t.processScope(e[0]),i=n.scope,r=n.cmd;t.taskMap.get(i)||t.taskMap.set(i,{taskLisMap:[],scope:i,inited:!1});var o=t.taskMap.get(i);o.taskLisMap.push({cmd:r,params:e}),t.taskMap.set(i,o)}),this.taskMap.size&&this.taskMap.forEach(function(e,n){var i=t.taskMap.get(n).taskLisMap;i.length&&function i(r){for(var s=r.length-1;s>=0;s--)if(Ao.has(r[s].cmd)||t.processMap.get(n)){Ao.has(r[s].cmd)&&(t.processMap.set(n,!0),"init"===r[s].cmd&&(e.inited=!0)),t.processCmd.apply(t,a([],o(r[s].params)));var c=t.taskMap.get(n);c.taskLisMap.splice(s,1),t.taskMap.set(n,c)}var u=t.taskMap.get(n).taskLisMap;u.length&&e.inited&&i(u.reverse())}(i.reverse())})),this.task=[]}catch(t){console.error("An error occurred while processing tasks:",t)}else console.warn("Expected an array for this.task, but got:",this.task)},t.prototype.processCmd=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(h(t)){var n=this.processScope(t[0]),i=n.scope,r=n.cmd;if(!this.processMap.get(i))return this.task.push(t),void this.processTask();if(t.splice(0,1),-1!==Do.indexOf(r))return this.callCmd(i,r,t);this.callCmd(i,r,t)}},t.prototype.callCmd=function(t,e,n){try{if(-1!==zo.indexOf(e)&&(this.collectMap.get(t)||(this.collect=new this.Collector(t),this.collectMap.set(t,this.collect))),!this.collectMap.get(t))return void console.log("init or use must be first call, cmd:".concat(e));var i=this.collectMap.get(t);if(i.__proto__.hasOwnProperty(e))if("event"===e)i.event.apply(i,a([e],o(n)));else{if(-1!==Do.indexOf(e))return i[e].apply(i,a([],o(n)));i[e].apply(i,a([],o(n)))}else i.event.apply(i,a([e],o(n)))}catch(t){}},t.prototype.findIndex=function(t,e,n){var i=this,r=-1;try{t.forEach(function(t,o){var a=void 0!==n?t[n]:t,s=i.processScope(a).cmd;-1!==e.indexOf(s)&&(r=o)})}catch(t){return r}return r},t.prototype.processScope=function(t){var e="default";try{if("string"==typeof t&&t.indexOf(".")>-1){var n=t.split(".");e=n[0],t=n[1]}}catch(n){return{scope:e,cmd:t}}return{scope:e,cmd:t}},t}();Sr.usePlugin(Gr,"ab"),Sr.usePlugin(qr,"bind"),Sr.usePlugin(Pr,"stay"),Sr.usePlugin(ko,"trackduration"),Sr.usePlugin(vo,"autotrack"),Sr.usePlugin(To,"heatmap"),Sr.usePlugin(bo,"degrade"),Sr.usePlugin(yo,"verify_h5"),Sr.usePlugin(jr,"heartbeat"),Sr.usePlugin(Kr,"monitor"),Sr.usePlugin(Eo,"route"),function(t){if("undefined"!=typeof window){var e=function(){if("undefined"!=typeof window)return window.LogAnalyticsObject||window.TeaAnalyticsObject}();if(e&&window[e]){var n=window[e];n.sdkLoad?console.log("you page has load sdk file already, do not load another sdk file"):(t.task=n.q||[],window[e]=t.processCmd.bind(t),window[e].sdkLoad=!0,t.processTask())}}}(new xo(Sr))}();