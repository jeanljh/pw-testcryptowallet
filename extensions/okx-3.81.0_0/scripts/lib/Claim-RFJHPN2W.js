import{d as dt,e as ut,i as ft,j as pt,k as Ct,l as _t,n as x}from"./chunk-SEANA4YQ.js";import"./chunk-5V4BKHLN.js";import"./chunk-QCBPGYXR.js";import{a as mt}from"./chunk-XPWDQTID.js";import{b as ct}from"./chunk-XSDSRNBQ.js";import{b as lt}from"./chunk-ALZVVIHH.js";import{K as it,L as nt}from"./chunk-SPXYT2VO.js";import"./chunk-7CFB2XTF.js";import"./chunk-BADVKNVD.js";import"./chunk-FLUPYUSZ.js";import{H as Nt,f as z}from"./chunk-UC2GDSBD.js";import"./chunk-RYV5MLCF.js";import"./chunk-EGQ54WS5.js";import{f as at}from"./chunk-OE3Y2WW2.js";import{j as st}from"./chunk-PI6SXITR.js";import{Mb as et,Ub as rt,vd as C}from"./chunk-LZ43QKYM.js";import{c as d}from"./chunk-LLRT7ZCZ.js";import{a as ot}from"./chunk-LH3J3TLH.js";import{H as N,ea as k,m as tt,n as b}from"./chunk-XEVJKE53.js";import"./chunk-2TP4LTGZ.js";import"./chunk-FA47DEF6.js";import"./chunk-NHQL3RON.js";import"./chunk-AUVAPXJK.js";import"./chunk-UCYWIXHR.js";import"./chunk-25RXMKCK.js";import"./chunk-YS3HYG35.js";import"./chunk-GVNSNU7P.js";import"./chunk-N3AWCE75.js";import"./chunk-MVO3PFGF.js";import"./chunk-DKCWR6P4.js";import"./chunk-NLHAZXT3.js";import"./chunk-Z7O2BQPT.js";import"./chunk-RRVELJ3L.js";import"./chunk-MWBMNCFR.js";import"./chunk-J5HV5RZ5.js";import"./chunk-JXDUUE4S.js";import"./chunk-Y5NME4BP.js";import"./chunk-T7EATGE4.js";import{t as V,y as T}from"./chunk-YP7AL7GO.js";import"./chunk-VYWNZTTM.js";import"./chunk-33JFC56H.js";import{a as R}from"./chunk-6N5VE5LT.js";import{a as E}from"./chunk-6YOUVTKE.js";import"./chunk-AEGO4G2O.js";import"./chunk-GQPYV2B4.js";import"./chunk-7BSXWXHJ.js";import"./chunk-M7JGFMJS.js";import{f as u,o as a,q as i}from"./chunk-4J7XGGEQ.js";a();i();var o=u(E()),W=u(Nt()),J=u(R());a();i();var Z={list:"list",coin:"coin",orderDetail:"orderDetail"};a();i();var G=u(E());a();i();var gt=u(E());var M=()=>{let{walletContractStore:e}=d(),{gasFee:t,nativeCoin:r}=e,{coinAmountInt:s,decimals:n}=r??{};return(0,gt.useMemo)(()=>{let l=st(s,n);return ot.gte(l,t||"0")},[t,s,n])};var Mt=()=>{let{HeaderTip:e}=k.components,{walletContractStore:t}=d(),{gasInfo:r,gasLimitError:s,nativeCoin:n,compuletedGetNativeCoinError:l,compuletedGetNativeCoinLoading:m,computedTipsBtnProps:w}=t,{symbol:S}=n??{},f={type:z.TYPE.error,renderGasStation:!1},y=M(),p=()=>G.default.createElement(e,{type:z.TYPE.warn,message:C("swaptrade_extension_cinteraction_insufficient_networkfee",{symbol:S}),actions:[w],renderGasStation:!1}),v=()=>G.default.createElement(e,{...f,message:C("swaptrade_extension_cinteraction_might_error")}),L=()=>G.default.createElement(e,{...f,message:s});return m?null:l?G.default.createElement(e,{...f,message:C("swaptrade_history_error_retrieve_balance_error")}):s?L():y&&r?.gasLimitInfo?.queryGasLimitErrorUseDefault?v():y?null:p()},ht=b(Mt);a();i();var St=u(E());var Bt=({chainId:e,tokenContractAddress:t,amount:r,isNativeToken:s})=>{let n=_t({chainId:e,tokenContractAddress:t,isNativeToken:s}),{coinId:l,decimals:m}=n||{};return(0,St.useMemo)(()=>[{coinId:l,assetChange:Ct("+",r,m),useMinPrecision:!1}],[r,l,m])},yt=Bt;a();i();var h=u(E()),Lt=u(R());a();i();var Tt=u(E());var Wt=()=>{let{walletContractStore:e}=d(),t=M(),{gasInfo:r,gasLimitError:s,compuletedGetNativeCoinError:n,compuletedGetNativeCoinLoading:l,gasFeeLoading:m}=e;return(0,Tt.useMemo)(()=>m||s||n||l||r?.isGasLimitLoading||r?.gasLimitInfo?.queryGasLimitErrorUseDefault||!t,[n,l,m,r?.gasLimitInfo?.queryGasLimitErrorUseDefault,r?.isGasLimitLoading,s,t])},wt=Wt;a();i();var Et=u(E());a();i();var $=class{constructor(){this.isLoading=!1;this.setLoading=t=>{this.isLoading=t};this.orderDetail=null;this.setOrderDetail=t=>{this.orderDetail=t};this.fetchOrderDetail=async t=>{this.setLoading(!0);let[r,s]=await N(lt.get(rt,{params:{orderId:t}}));if(r){this.setError(r),this.setLoading(!1);return}let n=s.data;this.setOrderDetail(n)};this.payload=null;this.setPayload=t=>{this.payload=t};this.sourceClaimPayload=null;this.setSourceClaimPayload=t=>{this.sourceClaimPayload=t};this.error=null;this.reset=()=>{this.setLoading(!1),this.setOrderDetail(null),this.setPayload(null),this.setSourceClaimPayload(null),this.clearError()};tt(this,{},{autoBind:!0})}setError(t){this.error=t}clearError(){this.error=null}},I=new $;var Ft=e=>{let{sendTransactionStore:t,walletContractStore:r,swapStore:s}=d(),{toChainId:n,orderId:l}=e||{};return(0,Et.useCallback)(async()=>{let{history:m}=k,{payload:w}=I;nt.info(it.CLAIM_PAYLOAD,{payload:w,tags:{orderId:l}});let[S,f]=await N(t.sendTransaction(n,w[0],r.walletSendParams));if(S){s.onWalletFail(S,l,!0);return}let{result:y,nonce:p}=mt(n,f);await s.updateClaimOrder({mainOrderId:l,redeemTxHash:y,nonce:p}),m?.goBack()},[t,n,r.walletSendParams,s,l])},It=Ft;a();i();var B={footer:"_footer_18rul_1","button-style":"_button-style_18rul_8",buttonStyle:"_button-style_18rul_8"};var Ht=({onChangeHeight:e,trade:t})=>{let r=(0,h.useRef)(null),[s,n]=(0,h.useState)(!1),{walletContractStore:l}=d(),{computedCancelBtnProps:m}=l;(0,h.useEffect)(()=>{let f=p=>{e&&e(p.offsetHeight)},y=new MutationObserver(p=>{f(p[0]?.target)});return r.current&&(f(r.current),y.observe(r.current,{childList:!0})),()=>{y.disconnect()}},[e]);let w=wt(),S=It(t);return h.default.createElement("div",{className:(0,Lt.default)(B.footer)},h.default.createElement(T,{block:!0,circle:!1,className:B.buttonStyle,size:T.SIZE.lg,category:T.CATEGORY.outline,type:T.TYPE.primary,loading:m.loading,loadingText:m.btnText,disabled:m.disabled,onClick:m.onClick},m.btnText),h.default.createElement(T,{block:!0,circle:!1,className:B.buttonStyle,size:T.SIZE.lg,type:T.TYPE.highlight,category:T.CATEGORY.fill,disabled:w,loading:s,loadingText:C("swaptrade_common_btn_confirm"),onClick:async()=>{n(!0),await S(),n(!1)}},C("swaptrade_common_btn_confirm")))},bt=b(Ht);a();i();var j=u(E());var Ut=({chainId:e,transactionPayload:t})=>{let{fromToStore:r}=d(),{isEvmChain:s}=r;return ut(e),s(e)?j.default.createElement(pt,{chainId:e,transactionPayload:t,isClaim:!0}):j.default.createElement(ft,{chainId:e,transactionPayload:t,isClaim:!0})},kt=Ut;var Yt=()=>{let[e,t]=(0,o.useState)(""),{components:{MultipleChangeSummary:r,TxTypeWithTools:s,SectionWrap:n,InteractiveAddress:l,ModuleWrap:m,ViewData:w}}=k,S=(0,W.useHistory)(),[f,y]=(0,o.useState)(80),{search:p}=(0,W.useLocation)(),{orderId:v,source:L}=(0,o.useMemo)(()=>at(p),[p]),{swapStore:P,accountStore:F,fromToStore:xt,walletContractStore:vt}=d(),{computedAccountId:Pt}=F,{isEvmChain:Dt}=xt,{gasInfo:H}=vt,{orderDetail:c,setPayload:D,payload:K,setLoading:U,setSourceClaimPayload:Q,sourceClaimPayload:Y}=I;(0,o.useEffect)(()=>{L&&(L===Z.list||L===Z.coin)&&e&&ct("bridge_claim_click","history_main",e)},[L,e]),(0,o.useEffect)(()=>{v&&I.fetchOrderDetail(v)},[v]),(0,o.useEffect)(()=>()=>{I.reset()},[]),(0,o.useEffect)(()=>{if(c){let A=F.getAddressByChainId(c.toChainId);t(A),P.fetchClaimCalldata(c,A).then(O=>{if(U(!1),!O){S.goBack();return}let{payload:q,sourceClaimPayload:Ot}=O;D(q),Q(Ot)}).catch(()=>{U(!1)})}},[P,c,F,D,U,Q,S]);let X=(0,o.useCallback)(async(A,O)=>{let q=await P.formatClaimPayload(A,O);D(q)},[D,P]);(0,o.useEffect)(()=>{c&&Y&&H&&X(Y,c)},[H.networkFee,c,Y,D,P,H,X]);let Gt=dt(et.CLAIM),At=yt({chainId:c?.toChainId,tokenContractAddress:c?.toTokenAddress,isNativeToken:c?.isNativeToken==="1",amount:c?.bridgeChildOrderDetailVo?.toAmountOut});return I.isLoading?o.default.createElement("div",{className:(0,J.default)(x.container,x.loading)},o.default.createElement(V,{size:V.SIZE.lg})):o.default.createElement("div",{className:x.container},o.default.createElement("div",{style:{height:`calc(100% - ${f}px)`},className:(0,J.default)(x.wrap)},o.default.createElement("div",{className:x.scroll,id:"wallet_scroll"},o.default.createElement(ht,null),o.default.createElement(s,{txTypeInfo:{baseInfo:Gt}},o.default.createElement(r,{title:C("swaptrade_orders_label_receive"),summaryList:At})),o.default.createElement(kt,{chainId:c?.toChainId,transactionPayload:K?.[0]}),o.default.createElement(n,null,o.default.createElement(l,{title:C("swaptrade_transfer_textarea_wallet_used"),address:e,walletId:Pt})),o.default.createElement(n,{bordered:!1},Dt(c?.toChainId)&&o.default.createElement(w,{copyable:{hideDesc:!0},data:K?.[0]?.data})))),o.default.createElement(bt,{onChangeHeight:y,trade:c}))},Se=b(Yt);export{Se as default};
//# sourceMappingURL=Claim-RFJHPN2W.js.map
