import{f as l}from"./chunk-OJWZP4US.js";import{a as fe}from"./chunk-3FSEKPUM.js";import{b as H}from"./chunk-XDPVWBGA.js";import{s as ae}from"./chunk-7CFB2XTF.js";import{d as se,f as ie,m as x,t as me}from"./chunk-PI6SXITR.js";import{$a as oe,Lb as ne,W as ee,Za as te,ab as re,vd as ue}from"./chunk-LZ43QKYM.js";import{a as Q,c as G}from"./chunk-LLRT7ZCZ.js";import{a as C}from"./chunk-LH3J3TLH.js";import{c as z,h as V,k as J}from"./chunk-XEVJKE53.js";import{M as S,_ as b,a as A,j as n,w as W,y as E}from"./chunk-NLHAZXT3.js";import{a as v}from"./chunk-6YOUVTKE.js";import{f as B,h as f,o as u,q as m}from"./chunk-4J7XGGEQ.js";u();m();var q=B(v());u();m();var _e=B(v());u();m();var de=B(v());function ce(){let o=(0,de.useRef)(!0);return o.current?(o.current=!1,!0):o.current}var Te=(o,e)=>{let t=ce();(0,_e.useEffect)(()=>t?()=>{}:o(),e)};function Re(){let{accountStore:o,fromToStore:e}=G(),{computedAccountId:t,address:r,setFromChainId:s,computedMultiAddresses:i}=o,{from:a,to:d,setBalanceState:h,getSwapTokenBalance:I,computedIsToAddressEqualsCurrentToAddress:U}=e,{amount:P,chainId:L}=a;(0,q.useEffect)(()=>{me(L)&&s(L)},[L,s]),(0,q.useEffect)(()=>{I()},[t,I]),(0,q.useEffect)(()=>{h({amount:P,address:r,from:a,to:d})},[P,r,a,d,h,U]),Te(()=>{I()},[i?.targetWalletAddress])}var Me=Re;u();m();u();m();var R={default:()=>({type:"",title:"",desc:""}),quote:o=>o.error_code===te?l["BLACKLIST_ADDRESS"]():o?.error_code===re?l["BUY_HONEYPOT"]():l["NETWORK_ERROR"](),sellHoneyport:()=>l["SELL_HONEYPOT"](),leverageToken:(o,e)=>l["LEVERAGE_TOKEN"](o?.tokenSymbol,e?.tokenSymbol),wrongNetwork:o=>l["UNSUPPORTED_CHAIN"]({chainName:o}),feeConfig:()=>l["FEE_CONFIG_ERROR"](),accountErrorTips:()=>l["ACCOUNT_ERROR_TIPS"](),limitRegionTips:()=>l["LIMIT_REGION"](),chainInMaintenance:o=>l["CHAIN_IN_MAINTANCE"](o)},Ye={handleQuoteErrorState:({quote:o,honeypotToken:e,hasLeverageToken:t,leverageTokenPair:r=[],shouldShowLimitRegionTip:s})=>{let{quoteError:i}=o;return s?R.limitRegionTips():i?R.quote(i):o?.bestRoute?.code===oe?R.sellHoneyport(e.tokenSymbol):t?R.leverageToken(r[0],r[1]):null},handleNetworkErrorState:o=>(ae({type:ee.SWITCH_WALLET}),R.wrongNetwork(o)),handleDefaultState:()=>R.default(),handleFeeConfigErrorState:()=>R.feeConfig(),handleFacetTokenAccountErrorState:()=>R.accountErrorTips(),handleLimitRegionErrorState:()=>R.limitRegionTips(),handleChainInMaintenance:o=>o?.toastContent?R.chainInMaintenance(o):null};u();m();u();m();b();u();m();var N=(o,e)=>({networkFeeAmount:o,networkFeeTokenSymbol:e,formattedNetworkFeeAmount:o?`${ie(o)} ${e}`:"--"}),O=o=>{let{commonStore:e}=Q(),{computedNowCurrencySymbol:t,currencyConversion:r}=e;return{networkFeeUsd:o,formattedNetworkFeeUsd:o?se(r(o).toString(),t):"--"}},X=o=>{let{estimateGasFeeAmount:e,fromNativeTokenSymbol:t,estimateGasFeeAmountUsd:r,bridge:s,fromToken:i,toToken:a,crossChainFee:d,bridgeFeeUsd:h,toSwapFee:I,toNativeTokenSymbol:U,toSwapFeeUsd:P}=o||{},{estimateBridgeFeeAmountUsd:L,estimateBridgeFeeAmount:le,bridgeName:pe,bridgeLogoUrl:he,estimateClaimFeeAmount:Z,estimateClaimFeeAmountUsd:Ee}=s||{},Y=N(d,s?.crossToToken?.tokenSymbol),j=O(h);return{from:{chainName:i?.chainName,chainLogo:i?.chainLogoUrl,...N(e,t),...O(r)},bridge:{bridgeName:pe,bridgeLogo:he,...N(le,t),...O(L),bridgeFeeAmount:Y.networkFeeAmount,bridgeFeeTokenSymbol:Y.networkFeeTokenSymbol,formattedBridgeFeeAmount:Y.formattedNetworkFeeAmount,bridgeFeeUsd:j.networkFeeUsd,formattedBridgeFeeUsd:j.formattedNetworkFeeUsd},to:{chainName:a?.chainName,chainLogo:a?.chainLogoUrl,...N(I,U),...O(P)},claim:C.gt(Z,0)?{chainName:ue("swaptrade_bridge_reminder_token_claim_fee"),chainLogo:a?.chainLogoUrl,...N(Z,U),...O(Ee)}:null}},ke=()=>{let{quoteStore:o}=G(),{quote:e}=o;return X(e?.bestRoute)},je=ke;u();m();b();u();m();b();u();m();b();u();m();var g=class{constructor(e,t){f(this,"percent","");f(this,"exactPercent","");f(this,"dexRouterPercent","");Object.assign(this,t),this.dexRouterPercent=e}get computedPercent(){return this.percent?x(this.percent,{needZero:!1}):""}get computedExactPercent(){let e=C.BigNumber(this.percent).multipliedBy(this.dexRouterPercent).dividedBy(100);return e.isNaN()?"":x(e.toNumber(),{needZero:!1})}};var M=class{constructor(e,t,r){f(this,"fromToken",{});f(this,"toToken",{});f(this,"dexQuoteInfoList",[]);let{fromToken:s={},toToken:i={},dexQuoteInfoList:a}=t||{};this.fromToken=s,this.toToken=i,this.dialogHeaderText=r?H(this.toToken?.tokenSymbol):`${H(this.fromToken?.tokenSymbol)}/${H(this.toToken?.tokenSymbol)}`,A(a)&&(this.dexQuoteInfoList=a.map(d=>new g(e,d)))}};var w=class{constructor(e,t){f(this,"percent","");f(this,"router","");f(this,"subRouterList",[]);f(this,"flag","");let{percent:r="",router:s="",flag:i="",subRouterList:a}=e||{};this.percent=r,this.router=s,this.flag=i,A(a)&&(this.subRouterList=a.map(d=>new M(r,d,t)))}get computedPercent(){return this.percent?x(this.percent,{needZero:!1}):""}};var k=class{constructor(e,t=!1){f(this,"data",[]);A(e)&&(this.data=e.map(r=>new w(r,t)))}};u();m();var c={DEFAULT:0,LOADING:1,DISCONNECTION:2,NO_DATA:3,SHOW_DATA:4},p={DISMISS:"0",FROM:"1",BRIDGE:"2",TO:"3"},y={IN_CHAIN:"0",CROSS_CHAIN:"1"},D={NORMAL_PERCENT:0,EXACT_PERCENT:1};var F=class{constructor(){this.fromToData={};this.setFromToData=e=>{this.fromToData=e};this.reloadQuote=null;this.setReloadQuote=e=>{this.reloadQuote=e};this.updateSmartRouterData=({isFetchQuoting:e,bestRoute:t,quoteError:r,quoteNull:s,shouldPauseQuote:i})=>{let a=t?J(t):{},d=a.commonDexInfo||{},h=i?{}:{...d,...a};this.setStatusByQuote({isFetchQuoting:e,quoteError:r,bestRoute:h,quoteNull:s,shouldPauseQuote:i}),this.updateData(h||{}),this.updateAllGasFee(h||{})};this.showEntryForPc=!1;this.setShowEntryForPc=e=>{this.showEntryForPc=e};this.isShowShowAll=!0;this.updateIsShowShowAll=(e=!1)=>{this.isShowShowAll=e};this.status=c.LOADING;this.setStatus=e=>{let r=W(c).some(s=>s===e);this.status=r?e:c.DEFAULT};this.setStatusByQuote=({isFetchQuoting:e,quoteError:t,bestRoute:r,quoteNull:s,shouldPauseQuote:i})=>{if(i){this.setStatus(c.NO_DATA);return}let{fromToStore:a}=Q();if(!t&&!r&&!s&&C.BigNumber(a?.computedTypedValue).gt(0)){this.setStatus(c.LOADING);return}if(e&&this.status!==c.SHOW_DATA&&this.status!==c.NO_DATA){this.setStatus(c.LOADING);return}if(t){this.setStatus(c.DISCONNECTION);return}if(s&&E(r?.dexRouterList)&&E(r?.fromDexRouterList)&&E(r?.bridge)&&E(r?.toDexRouterToList)){this.setStatus(c.NO_DATA);return}if(!E(r?.dexRouterList)||!E(r?.fromDexRouterList)||!E(r?.bridge)||!E(r?.toDexRouterToList)){this.setStatus(c.SHOW_DATA);return}this.setStatus(c.DEFAULT)};this.percentType=D.NORMAL_PERCENT;this.switchPercentType=()=>{this.percentType=this.percentType===D.NORMAL_PERCENT?D.EXACT_PERCENT:D.NORMAL_PERCENT};this.swapType=y.IN_CHAIN;this.setSwapType=e=>{this.swapType=e};this.tokenInfo={dexRouter:{token0:{},token1:{}},fromDexRouter:{token0:{},token1:{}},bridge:{token0:{},token1:{}},toDexRouter:{token0:{},token1:{}}};this.updateTokenInfo=e=>{S(this.tokenInfo,"dexRouter",{token0:this.fromToData.from||{},token1:this.fromToData.to||{}}),S(this.tokenInfo,"fromDexRouter",{token0:{...n(e,"fromToken",{}),amountIn:n(e,"fromTokenAmount","")},token1:{...n(e,"fromSwapToTokenInfo",{}),amountOut:n(e,"bridge.bridgeAmountIn","")}}),S(this.tokenInfo,"bridge",{token0:this.isCrossBridgeOnly?{...n(e,"fromToken",{}),amountIn:n(e,"bridge.bridgeAmountIn","")}:{...n(e,"bridge.crossFromToken",{}),amountIn:n(e,"bridge.bridgeAmountIn","")},token1:this.isCrossBridgeOnly?{...n(e,"toToken",{}),amountOut:n(e,"bridge.bridgeAmountOut","")}:{...n(e,"bridge.crossToToken",{}),amountOut:n(e,"bridge.bridgeAmountOut","")}}),S(this.tokenInfo,"toDexRouter",{token0:{...n(e,"toSwapFromTokenInfo",{}),amountIn:n(e,"bridge.bridgeAmountOut","")},token1:{...n(e,"toToken",{}),amountOut:n(e,"receiveAmount","")}})};this.dexRouterList=[];this.checkDagRouter=e=>!e||!e.length?!1:e?.filter?.(t=>!t.subRouterList).length;this.setDexRouterList=e=>{let t=this.checkDagRouter(e);this.dexRouterList=t?e:new k(e).data};this.fromDexRouterList=[];this.setFromDexRouterList=e=>{this.fromDexRouterList=new k(e).data};this.toDexRouterToList=[];this.setToDexRouterToList=e=>{this.toDexRouterToList=new k(e).data};this.bridgeRouterList=[];this.setBridgeRouterList=(e,t)=>{let r=(s={},i)=>({...s,tokenSymbol:i,fromBridge:!0});this.bridgeRouterList=new k([{percent:n(t,"percent")||"100",subRouterList:[{dexQuoteInfoList:[{dexName:n(t,"bridgeName"),percent:"100",okLinkUrl:n(t,"fromPoolAddress")}],fromToken:{},toToken:r(n(t,"crossFromToken"),n(t,"fromPoolName"))},{dexQuoteInfoList:[{dexName:n(t,"bridgeName"),percent:"100",okLinkUrl:n(t,"toPoolAddress")}],fromToken:{},toToken:r(n(t,"crossToToken"),n(t,"toPoolName"))}]}],!0).data};this.checkIsManyQuote=e=>{if(e.length>1)return!1;let t=e.length>0?n(e,[0,"subRouterList"],[]):[];return t.length>1?!1:n(t,[0,"dexQuoteInfoList","length"])>5};this.checkIsFewRouter=e=>e.length===1&&n(e,[0,"subRouterList","length"])<3;this.getInfoByMenuType=e=>{if(this.swapType===y.IN_CHAIN)return{routerList:this.dexRouterList,tokenInfo:this.tokenInfo.dexRouter};switch(e){case p.FROM:return{routerList:this.fromDexRouterList,tokenInfo:this.tokenInfo.fromDexRouter};case p.BRIDGE:return{routerList:this.bridgeRouterList,tokenInfo:this.tokenInfo.bridge};case p.TO:return{routerList:this.toDexRouterToList,tokenInfo:this.tokenInfo.toDexRouter};default:return{routerList:[],tokenInfo:this.tokenInfo.dexRouter}}};this.currentMenu=p.DISMISS;this.setCurrentMenu=e=>{let r=W(p).some(s=>s===e);this.currentMenu=r?e:p.DISMISS};this.menuList=[];this.showMenuList=!0;this.isCrossBridgeOnly=!1;this.setMenuListAndCurrentMenu=(e,t,r)=>{if(!Array.isArray(e)||E(e))this.showMenuList=!1,this.isCrossBridgeOnly=!1,this.setCurrentMenu(p.DISMISS);else{this.menuList=e.map(i=>({...i,bridge:{...r}}));let s=n(e,[0,"smartRoutingMenuType"]);(!this.showMenuList||this.currentMenu===p.DISMISS||!e.some(i=>n(i,"smartRoutingMenuType")===this.currentMenu))&&this.setCurrentMenu(s),this.isCrossBridgeOnly=e.length===1&&s===p.BRIDGE&&t===y.CROSS_CHAIN,this.showMenuList=!this.isCrossBridgeOnly}};this.updateData=e=>{let{swapType:t,smartRoutingMenuVoList:r,dexRouterList:s,fromDexRouterList:i,bridge:a,toDexRouterToList:d}=e;this.setSwapType(t),this.setMenuListAndCurrentMenu(r,t,a),this.setDexRouterList(s),this.setFromDexRouterList(i),this.setBridgeRouterList(e,a),this.setToDexRouterToList(d),this.updateTokenInfo(e)};this.showXRouteModal=ne.SWAP;this.setXRouteModal=e=>{this.showXRouteModal=e};this.subRouterData=null;this.setSubRouterData=e=>{this.subRouterData=e};this.subRouterModal=!1;this.setSubRouterModal=e=>{this.subRouterModal=e};this.dexQuoteInfoListData=[];this.setDexQuoteInfoListData=e=>{this.dexQuoteInfoListData=e};this.oldRouterModal=!1;this.setOldRouterModal=e=>{this.oldRouterModal=e};this.allGasFee={};this.updateAllGasFee=e=>{this.allGasFee=X(e)}}get computedIsFewRouter(){let{routerList:e}=this.computedCurrentRouter;return this.checkIsFewRouter(e)}get computedIsManyQuoteInfo(){let{routerList:e}=this.computedCurrentRouter;return this.checkIsManyQuote(e)}get computedCurrentRouter(){return this.getInfoByMenuType(this.currentMenu)}};var $=class extends F{constructor({swapStore:t,fromToStore:r,swapDappStore:s}){super();this.fromToStore=r||{},this.quoteStore=t.quoteStore||{},this.swapDappStore=s||{},fe(this,{},{autoBind:!0}),V(()=>({isFetchQuoting:this.quoteStore.quote?.isFetchQuoting,bestRoute:this.quoteStore.computedRouterForSmartRouterStore,quoteError:this.quoteStore.quote?.quoteError,quoteNull:this.quoteStore.quote?.quoteNull,fromToken:this.fromToStore.from,toToken:this.fromToStore.to,shouldPauseQuote:this.swapDappStore.computedSupportDappTradeByChain}),({isFetchQuoting:i,bestRoute:a,quoteError:d,quoteNull:h,shouldPauseQuote:I})=>{this.setReloadQuote(this.quoteStore.fetchQuote),this.setFromToData({from:this.fromToStore.from,to:this.fromToStore.to}),this.updateSmartRouterData({isFetchQuoting:i,bestRoute:a,quoteError:d,quoteNull:h,shouldPauseQuote:I})},{equals:z.shallow})}};export{Me as a,R as b,Ye as c,O as d,X as e,je as f,c as g,p as h,y as i,D as j,$ as k};
//# sourceMappingURL=chunk-WTOUIA45.js.map
