import{A as $,B as j,u as Y}from"./chunk-KW3KLDWA.js";import{e as g}from"./chunk-M7JGFMJS.js";import{c as p,n as h,o as f,q as i}from"./chunk-4J7XGGEQ.js";var C=p((vr,K)=>{f();i();var rr=Math.pow(2,30)-1;K.exports=function(r,e){if(typeof r!="number")throw new TypeError("Iterations not a number");if(r<0)throw new TypeError("Bad iterations");if(typeof e!="number")throw new TypeError("Key length not a number");if(e<0||e>rr||e!==e)throw new TypeError("Bad key length")}});var y=p((dr,U)=>{f();i();var b;globalThis.process&&globalThis.process.browser?b="utf-8":globalThis.process&&globalThis.process.version?(F=parseInt(h.version.split(".")[0].slice(1),10),b=F>=6?"utf-8":"binary"):b="utf-8";var F;U.exports=b});var P=p((Br,k)=>{f();i();var E=g().Buffer;k.exports=function(r,e,t){if(E.isBuffer(r))return r;if(typeof r=="string")return E.from(r,e);if(ArrayBuffer.isView(r))return E.from(r.buffer);throw new TypeError(t+" must be a string, a Buffer, a typed array or a DataView")}});var A=p((qr,O)=>{f();i();var er=j(),or=Y(),tr=$(),l=g().Buffer,nr=C(),L=y(),M=P(),ar=l.alloc(128),_={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function N(r,e,t){var a=ur(r),o=r==="sha512"||r==="sha384"?128:64;e.length>o?e=a(e):e.length<o&&(e=l.concat([e,ar],o));for(var n=l.allocUnsafe(o+_[r]),s=l.allocUnsafe(o+_[r]),u=0;u<o;u++)n[u]=e[u]^54,s[u]=e[u]^92;var c=l.allocUnsafe(o+t+4);n.copy(c,0,0,o),this.ipad1=c,this.ipad2=n,this.opad=s,this.alg=r,this.blocksize=o,this.hash=a,this.size=_[r]}N.prototype.run=function(r,e){r.copy(e,this.blocksize);var t=this.hash(e);return t.copy(this.opad,this.blocksize),this.hash(this.opad)};function ur(r){function e(a){return tr(r).update(a).digest()}function t(a){return new or().update(a).digest()}return r==="rmd160"||r==="ripemd160"?t:r==="md5"?er:e}function fr(r,e,t,a,o){nr(t,a),r=M(r,L,"Password"),e=M(e,L,"Salt"),o=o||"sha1";var n=new N(o,r,e.length),s=l.allocUnsafe(a),u=l.allocUnsafe(e.length+4);e.copy(u,0,0,e.length);for(var c=0,w=_[o],W=Math.ceil(a/w),S=1;S<=W;S++){u.writeUInt32BE(S,e.length);for(var q=n.run(u,n.ipad1),x=q,D=1;D<t;D++){x=n.run(x,n.ipad2);for(var d=0;d<w;d++)q[d]^=x[d]}q.copy(s,c),c+=w}return s}O.exports=fr});var V=p((Cr,Q)=>{f();i();var G=g().Buffer,ir=C(),R=y(),Z=A(),X=P(),B,m=globalThis.crypto&&globalThis.crypto.subtle,sr={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},H=[];function cr(r){if(globalThis.process&&!globalThis.process.browser||!m||!m.importKey||!m.deriveBits)return Promise.resolve(!1);if(H[r]!==void 0)return H[r];B=B||G.alloc(8);var e=J(B,B,10,128,r).then(function(){return!0}).catch(function(){return!1});return H[r]=e,e}var v;function T(){return v||(globalThis.process&&globalThis.process.nextTick?v=globalThis.process.nextTick:globalThis.queueMicrotask?v=globalThis.queueMicrotask:globalThis.setImmediate?v=globalThis.setImmediate:v=globalThis.setTimeout,v)}function J(r,e,t,a,o){return m.importKey("raw",r,{name:"PBKDF2"},!1,["deriveBits"]).then(function(n){return m.deriveBits({name:"PBKDF2",salt:e,iterations:t,hash:{name:o}},n,a<<3)}).then(function(n){return G.from(n)})}function hr(r,e){r.then(function(t){T()(function(){e(null,t)})},function(t){T()(function(){e(t)})})}Q.exports=function(r,e,t,a,o,n){typeof o=="function"&&(n=o,o=void 0),o=o||"sha1";var s=sr[o.toLowerCase()];if(!s||typeof globalThis.Promise!="function"){T()(function(){var u;try{u=Z(r,e,t,a,o)}catch(c){return n(c)}n(null,u)});return}if(ir(t,a),r=X(r,R,"Password"),e=X(e,R,"Salt"),typeof n!="function")throw new Error("No callback provided to pbkdf2");hr(cr(s).then(function(u){return u?J(r,e,t,a,s):Z(r,e,t,a,o)}),n)}});var lr=p(z=>{f();i();z.pbkdf2=V();z.pbkdf2Sync=A()});export{lr as a};
//# sourceMappingURL=chunk-KYZSYNSZ.js.map
