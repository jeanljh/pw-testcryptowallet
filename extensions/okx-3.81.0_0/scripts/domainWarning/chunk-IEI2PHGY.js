import{d as a}from"./chunk-JYR5PKQU.js";import{c as s,o as i,q as l}from"./chunk-4J7XGGEQ.js";var c=s((d,h)=>{i();l();var w=a().Buffer;function g(e){if(e.length<8||e.length>72||e[0]!==48||e[1]!==e.length-2||e[2]!==2)return!1;var r=e[3];if(r===0||5+r>=e.length||e[4+r]!==2)return!1;var n=e[5+r];return!(n===0||6+r+n!==e.length||e[4]&128||r>1&&e[4]===0&&!(e[5]&128)||e[r+6]&128||n>1&&e[r+6]===0&&!(e[r+7]&128))}function x(e){if(e.length<8)throw new Error("DER sequence length is too short");if(e.length>72)throw new Error("DER sequence length is too long");if(e[0]!==48)throw new Error("Expected DER sequence");if(e[1]!==e.length-2)throw new Error("DER sequence length is invalid");if(e[2]!==2)throw new Error("Expected DER integer");var r=e[3];if(r===0)throw new Error("R length is zero");if(5+r>=e.length)throw new Error("R length is too long");if(e[4+r]!==2)throw new Error("Expected DER integer (2)");var n=e[5+r];if(n===0)throw new Error("S length is zero");if(6+r+n!==e.length)throw new Error("S length is invalid");if(e[4]&128)throw new Error("R value is negative");if(r>1&&e[4]===0&&!(e[5]&128))throw new Error("R value excessively padded");if(e[r+6]&128)throw new Error("S value is negative");if(n>1&&e[r+6]===0&&!(e[r+7]&128))throw new Error("S value excessively padded");return{r:e.slice(4,4+r),s:e.slice(6+r)}}function E(e,r){var n=e.length,o=r.length;if(n===0)throw new Error("R length is zero");if(o===0)throw new Error("S length is zero");if(n>33)throw new Error("R length is too long");if(o>33)throw new Error("S length is too long");if(e[0]&128)throw new Error("R value is negative");if(r[0]&128)throw new Error("S value is negative");if(n>1&&e[0]===0&&!(e[1]&128))throw new Error("R value excessively padded");if(o>1&&r[0]===0&&!(r[1]&128))throw new Error("S value excessively padded");var t=w.allocUnsafe(6+n+o);return t[0]=48,t[1]=t.length-2,t[2]=2,t[3]=e.length,e.copy(t,4),t[4+n]=2,t[5+n]=r.length,r.copy(t,6+n),t}h.exports={check:g,decode:x,encode:E}});export{c as a};
//# sourceMappingURL=chunk-IEI2PHGY.js.map
