import{a as Tn}from"./chunk-KEUXDFG3.js";import{a as gn}from"./chunk-ZOPVBPAO.js";import{a as Cn}from"./chunk-PKLMUYJU.js";import{a as xn}from"./chunk-XIUQW5OS.js";import{a as dn,b as fn}from"./chunk-34YDQARM.js";import{a as _n}from"./chunk-3YSB4TUI.js";import"./chunk-JQ73YYWR.js";import"./chunk-RNB6EWQY.js";import{a as sn}from"./chunk-LFKA2PUG.js";import{i as an,j as ln,k as mn,l as cn,m as un,n as pn}from"./chunk-A7W3UWEW.js";import"./chunk-ESUENDB2.js";import"./chunk-IJ7JX7CH.js";import"./chunk-SLISBEZF.js";import{a as Oe,b as ve}from"./chunk-OJWYRJWY.js";import{a as Yt}from"./chunk-7IP3VPVS.js";import"./chunk-MJKLSIQL.js";import{a as Me}from"./chunk-ICSA2KYO.js";import{a as Pe,b as Fe}from"./chunk-M3OTLMUB.js";import{b as Zt,g as be,i as Jo,j as Qo,k as Be,m as Le,p as tn,q as en,r as on}from"./chunk-WRGSQF3V.js";import"./chunk-ELHHHA5F.js";import"./chunk-MI2Q756Z.js";import{a as rn}from"./chunk-ZZ5BEB5E.js";import"./chunk-7OWNMKUE.js";import"./chunk-EDJJACNG.js";import{a as _e}from"./chunk-V7XA3BQU.js";import"./chunk-JVF7GJB3.js";import"./chunk-QKPPTYDW.js";import"./chunk-IN42FW4K.js";import{a as ke}from"./chunk-WST3WRLT.js";import"./chunk-PONOZOFT.js";import"./chunk-57D6LCV2.js";import{a as H,b as pe,c as eo,d as Z}from"./chunk-KQ6OPOXD.js";import"./chunk-X7ACMHNF.js";import{a as ue}from"./chunk-DEJA7CK3.js";import"./chunk-LS6URCUV.js";import{a as tt}from"./chunk-XDEC3ZLT.js";import{a as nn,b as $t}from"./chunk-RGPNT5G7.js";import"./chunk-OQUE64GQ.js";import"./chunk-AQ4KTATJ.js";import{B as Ko,b as Vo,l as W,o as jo}from"./chunk-Q7DF5H6O.js";import"./chunk-G23O242T.js";import"./chunk-AQO2BBXJ.js";import"./chunk-GWMNMJND.js";import"./chunk-2VUOGSTW.js";import"./chunk-P4PGYDTS.js";import"./chunk-S7VT2TWF.js";import"./chunk-HBNZZZEG.js";import"./chunk-3W4MTHFJ.js";import"./chunk-L2MGED7F.js";import{d as Wt,g as Zo}from"./chunk-BNS5ABAB.js";import"./chunk-UFGJXE4D.js";import"./chunk-7QX2TXNH.js";import{d as Ut}from"./chunk-ZDHJHPQ5.js";import"./chunk-DFPRATON.js";import"./chunk-WY5R5HAR.js";import"./chunk-GTQ5U6DA.js";import{a as $o}from"./chunk-TE6AOABI.js";import"./chunk-63UDTGAT.js";import"./chunk-AZ2KZKVQ.js";import"./chunk-VCDDTW7H.js";import"./chunk-UULU72LG.js";import"./chunk-3MTWCI34.js";import"./chunk-E6XUX33V.js";import"./chunk-VTMJYROY.js";import"./chunk-ARK47WR5.js";import"./chunk-BEIWULHW.js";import"./chunk-DOCYQV54.js";import"./chunk-6T3CLU73.js";import"./chunk-STXPU7A6.js";import"./chunk-PFSPFZNW.js";import"./chunk-2JC6L37N.js";import"./chunk-BF6TFHGA.js";import"./chunk-57F7LIJM.js";import"./chunk-7OXXN2FT.js";import"./chunk-RK7WST36.js";import"./chunk-7Q4IDC7V.js";import"./chunk-F57QKCZQ.js";import"./chunk-HIVYZXF3.js";import"./chunk-JALTSNOZ.js";import"./chunk-4Y52FA3V.js";import"./chunk-B6WLGAPL.js";import"./chunk-ZYYACLV7.js";import"./chunk-TQMC5UQS.js";import"./chunk-ANWN6BF6.js";import"./chunk-XNP3OGQC.js";import"./chunk-A2QIZMPL.js";import"./chunk-HKU7TMFJ.js";import"./chunk-YTR7GLCK.js";import"./chunk-7I4OPLNV.js";import"./chunk-J3UBL564.js";import"./chunk-YMYQJ726.js";import"./chunk-FGRS6VIX.js";import"./chunk-INIQCRIO.js";import"./chunk-2P6PTKAN.js";import"./chunk-ZFBXO46L.js";import"./chunk-6Z5HVUBK.js";import"./chunk-ZBDGRK4Q.js";import"./chunk-XIYYKWE3.js";import"./chunk-GN2NRAOV.js";import"./chunk-SFFRTMXL.js";import"./chunk-RLY3NWVP.js";import"./chunk-U3KULTRT.js";import"./chunk-55T2IW2N.js";import"./chunk-WVUOJIBP.js";import"./chunk-JBROAQ6E.js";import"./chunk-LBCITKCK.js";import"./chunk-O4O5AL3V.js";import"./chunk-I56NHY6E.js";import"./chunk-GLRDVHLR.js";import{b as qo}from"./chunk-AP337SRV.js";import{b as yt}from"./chunk-TF4QEXO7.js";import"./chunk-CHMHYYPI.js";import"./chunk-GDQAWT2G.js";import{U as to}from"./chunk-QJ36ZOFH.js";import{n as dt,o as lt}from"./chunk-7HYQ2DGP.js";import"./chunk-G7XOYBNH.js";import{f as Xo}from"./chunk-JHO7RU36.js";import"./chunk-UOWKDFTX.js";import"./chunk-5A7EFNRM.js";import"./chunk-NA6P5YCH.js";import"./chunk-F2SPBGOT.js";import{e as Ho}from"./chunk-SYOIP55B.js";import"./chunk-V7ZNWTMX.js";import"./chunk-MSP5TDR3.js";import"./chunk-VWGNVM37.js";import"./chunk-QKBWJPY2.js";import"./chunk-XFPD3Q2E.js";import"./chunk-AFJBSSNA.js";import{i as vo}from"./chunk-3ZKJXYZ4.js";import{c as ft}from"./chunk-EBRJSEEJ.js";import"./chunk-PA7QUJH7.js";import"./chunk-MC7IOE6A.js";import"./chunk-N4IVZOUG.js";import"./chunk-JWVIZID6.js";import"./chunk-MSFAPAHB.js";import"./chunk-33XRMYWN.js";import"./chunk-ZOKF3EKQ.js";import"./chunk-MDBKHBHQ.js";import"./chunk-WRVJM3F3.js";import"./chunk-NYBKFEEM.js";import"./chunk-XVSXMJ3S.js";import"./chunk-KQ66JTF7.js";import{c as rt}from"./chunk-OOYDFTEF.js";import"./chunk-JNIP4OYT.js";import"./chunk-XRCQOGA2.js";import"./chunk-SWUBCABA.js";import"./chunk-DK5VLY7L.js";import"./chunk-VUHYFIVA.js";import"./chunk-QRAFULYC.js";import"./chunk-EEIYH3NC.js";import"./chunk-ITDLKQAF.js";import"./chunk-4W7LQOP5.js";import"./chunk-CIVR4FUI.js";import"./chunk-H7WHTGUY.js";import"./chunk-44SDMU5C.js";import"./chunk-U7IWD6UB.js";import"./chunk-CZBL7QEK.js";import"./chunk-PAJAZXOA.js";import{b as ce}from"./chunk-7MCLPJAH.js";import"./chunk-WAIJPY5X.js";import{n as le,o as me}from"./chunk-YGMRSF47.js";import"./chunk-6XGS36TZ.js";import"./chunk-M2YY6A5T.js";import"./chunk-XLG73W5Q.js";import{a as Yo}from"./chunk-GCS2RK7E.js";import"./chunk-OIPQWTNV.js";import"./chunk-VJI6MZK4.js";import"./chunk-5PRURJ2O.js";import{g as Cr,h as Go,u as h}from"./chunk-FGAB46RQ.js";import"./chunk-47ZMUKCZ.js";import{o as Dt}from"./chunk-Z62JX42S.js";import{A as Ae,C as Lo,D as Po,Na as ae,z as Je}from"./chunk-2QHGKEME.js";import"./chunk-HAHRUU64.js";import"./chunk-B624VS3G.js";import"./chunk-W4SQ6335.js";import{a as zo}from"./chunk-YDSDBRIT.js";import{a as Ro}from"./chunk-6PA65BO3.js";import"./chunk-OIXGC4LI.js";import"./chunk-MAAUVUWY.js";import"./chunk-4X64L7DZ.js";import{I as Q,W as Oo,_ as vt,c as U,d as Fo,j as Mo,ja as At}from"./chunk-WU2LB6XB.js";import"./chunk-GLL4BXR6.js";import"./chunk-4L5HWMAA.js";import{c as Uo,e as Wo}from"./chunk-EZS2GR7E.js";import{j as nt,q as ie}from"./chunk-NUN72MDU.js";import"./chunk-BFWVIVOY.js";import"./chunk-S3FOFXM7.js";import"./chunk-YIFLUVTR.js";import{c as Do,e as xr}from"./chunk-EN2WHAVL.js";import{h as Qe}from"./chunk-CP2RIMI2.js";import"./chunk-3QLLFUC4.js";import{a as $e}from"./chunk-EFOY37CC.js";import{c as p}from"./chunk-HMTT52FG.js";import"./chunk-45NMMWRA.js";import"./chunk-E4OV5WXB.js";import{b as ho,c as _r}from"./chunk-GR7YC6C3.js";import{A as So,J as dr,e as wo}from"./chunk-O33H5V3V.js";import"./chunk-DJN2J7J5.js";import"./chunk-35ANKHOJ.js";import"./chunk-BI4OEIFC.js";import{Sb as fr,bc as Ht,hc as Ao,jb as Ne,jc as ko,kc as bo,lc as Bo,nb as Ot,nc as Ee,ob as St,rb as No,tb as se,vb as Eo}from"./chunk-COF7YKSN.js";import{A as i,K as ot,o as E}from"./chunk-VZKEX7KP.js";import"./chunk-QCEQQDCM.js";import{H as go,I as To,P as Ke,Q as yo,X as Io,d as qt,o as re,p as je,y as Co}from"./chunk-BJKBO23H.js";import"./chunk-IO3ALUOJ.js";import"./chunk-AHVVUOFF.js";import"./chunk-JLNZTUPO.js";import"./chunk-MSZOM4GC.js";import"./chunk-BYVN72KS.js";import"./chunk-ZUJLXC72.js";import"./chunk-DJSNVDZI.js";import"./chunk-K336SGW3.js";import"./chunk-XFTQD4B2.js";import"./chunk-DIZF7D6Q.js";import"./chunk-JHCCLVAB.js";import"./chunk-W7AONC6R.js";import"./chunk-FOOC6LB7.js";import"./chunk-SEAUBLKM.js";import"./chunk-UP4BZFYG.js";import"./chunk-DHKS44RQ.js";import"./chunk-4DBVFCYR.js";import"./chunk-2IGQWLAB.js";import{a as fo}from"./chunk-GVV6OTQP.js";import{t as _o,u as xo,z as at}from"./chunk-ZFVABNQN.js";import"./chunk-VYWNZTTM.js";import"./chunk-LBWWOQL4.js";import{a as Ve}from"./chunk-4QGZDIBD.js";import{b as D}from"./chunk-73B6GL3S.js";import"./chunk-LVJGLJNA.js";import"./chunk-FYJQM2AY.js";import"./chunk-Z7PBP7IJ.js";import"./chunk-5F7M5EJ4.js";import"./chunk-RQWEJ5N6.js";import"./chunk-RNWGOGLT.js";import"./chunk-UGJ3FMEQ.js";import"./chunk-OPJRP6YV.js";import"./chunk-H6JAOQCX.js";import"./chunk-OJXBW2YQ.js";import"./chunk-PDRHBICP.js";import"./chunk-Z2AIGJGI.js";import"./chunk-SLQQVCPY.js";import"./chunk-ZRVP4J67.js";import"./chunk-YSKQ76UN.js";import"./chunk-A3W4ZDEQ.js";import"./chunk-VBZ4JSJ6.js";import"./chunk-LBYXY63E.js";import"./chunk-M4ANCDMF.js";import"./chunk-J6KTJ3IN.js";import"./chunk-5CQODPK7.js";import"./chunk-C5XO4JMZ.js";import"./chunk-HI3LE734.js";import"./chunk-RX4V72AK.js";import{f as x,o as a,p as y,q as l}from"./chunk-Y5OH3DDZ.js";a();l();var Bt=x(D());a();l();var De=x(D());ot();a();l();var yn=({unapproved:t})=>De.default.createElement(p.Container,null,De.default.createElement(Ut,{title:i("wallet_trade_maintitle_transaction_confirm"),backable:!1,closeable:!1}),De.default.createElement(sn,{unapproved:t}));a();l();var w=x(D()),In=x(ae()),Ue=x(Dt());ot();xr();ie();Ee();se();var gr=({unapproved:t})=>{let e=t?.localType,o=t?.method,r=ft({localType:e})?.coinId;r===void 0&&(r=St(e));let s=Wt(r),m=(0,In.useDispatch)(),d=t.walletId,f=t.params.transaction.from,M=me(d),C=t.params.transaction.amount||2,[,N]=ke({coinId:r,address:f,chainId:s?.chainId}),c=N?.transferReminder,_=N?.dummyOutput,[g,O]=(0,w.useState)({level:vt.STANDARD,satBytes:N?.normal}),b=g?.satBytes;(0,w.useEffect)(()=>{if(!b&&N?.normal&&O({level:vt.STANDARD,satBytes:N?.normal}),b&&g?.level!==vt.CUSTOM){let q=N[Pe[g?.level]?.satBytes];O({...g,satBytes:q})}},[N]);let[L,{toggle:P}]=(0,Ue.useBoolean)(!1),[F,{set:I}]=(0,Ue.useBoolean)(!1),[k,{set:G}]=(0,Ue.useBoolean)(!1),[z,ct]=(0,w.useState)(),[K,S]=Be({coinId:r,walletId:d,address:f,batchDummyNum:C,utxoType:Zt.SPLIT_UTXO}),[X,Y,Nt]=Qo({coinId:r,walletId:d,address:f,networkFee:z,utxoType:Zt.SPLIT_UTXO,batchDummyNum:C,coinAmount:E.mul(_,C)},{ready:!!_}),gt=(0,w.useMemo)(()=>Y.findIndex(({dummy:q})=>q!==!0),[Y]),ut=(0,w.useMemo)(()=>gt===-1?[]:Y.slice(gt),[gt,Y]),st=(0,w.useMemo)(()=>gt===-1?0:Math.max(C-gt,0),[C,gt]),Lt=E.gt(st,0),jt=E.mul(_,st),J=tn({coinId:r,fromAddr:f,satBytes:b}),it=(0,w.useCallback)(async()=>{try{if(!b)return;I(!0);let q=await J({inputs:ut,outputs:Array.from({length:st}).map(()=>({address:f,amount:_}))});G(!1),ct(q)}catch{G(!0)}finally{I(!1)}},[_,J,f,ut,st,b,G,I]);(0,w.useEffect)(()=>{it()},[it]);let Et=(0,w.useMemo)(()=>S===void 0||!z?!0:E.gt(S,z),[S,z]),Kt=le(d),[ht,wt]=(0,w.useState)(!1),Pt=(0,w.useCallback)(async()=>{await m(dt(t.id)),await m(yt()),await nt(m),wt(!1)},[m,t.id]),{addressCheckError:et,addressCheckLoading:Ft}=Yt({chainIndex:s?.chainId||Ne,method:o,from:f,handleCancel:Pt}),Jt=(0,w.useMemo)(()=>M?{type:Z.TIP_TYPE.COMMON_ERROR,message:i("wallet_extension_top_toast_dapp_comingsoon")}:k?{type:Z.TIP_TYPE.FEE_ERROR}:Et?et?{type:Z.TIP_TYPE.COMMON_ERROR,message:et}:{type:qt.TYPE.warn,message:c}:{coinId:r,type:Z.TIP_TYPE.FEE_BALANCE_INSUFFICIENT},[r,k,M,Et,c,et]),Qt=Ko({coinId:r,walletId:d,coinAmount:"0",fromAddr:f,toAddr:f,localType:s?.localType,networkFee:z,extJson:JSON.stringify({}),txSource:Ht.DAPP,txType:U.BTC_SPLIT_UTXO}),V=Le({coinId:r,txType:U.BTC_SPLIT_UTXO,address:f}),zt=(0,w.useCallback)(async()=>{if(Lt)try{await V(ut),wt(!0);let{signed:q,utxos:Xt}=await Do().splitUtxo({splitAmount:st,inputs:be(ut),amount:_,feePerB:g.satBytes},f,d),ge=await Vo(s?.localType,q);await Qt(q,{txHash:ge});let He=Y.filter(ee=>ee.dummy),Ze=[...be(He),...Xt.map(ee=>({...ee,rawTransaction:q}))];await m(lt(t.id,{utxos:Ze,txHash:ge}))}catch{}finally{wt(!1)}else{let q=Y.slice(0,C);await m(lt(t.id,{utxos:be(q)}))}},[C,m,_,Y,f,Lt,ut,Qt,st,g.satBytes,t.id,V,d]),{loading:te,onClick:Ce}=tt(Pt),{loading:Ie,onClick:he}=tt(zt),we=(0,w.useMemo)(()=>{let q={loading:te,actionType:W.ACTION_TYPE.CANCEL,btnText:i("wallet_dapp_connection_btn_reject"),onClick:Ce},Xt={actionType:W.ACTION_TYPE.CONFIRM,disabled:K||F||X||k||Nt||!Number(z)||M||et,onClick:he,loading:Ie||Ft};return Et||(Xt={coinId:r,walletId:d,address:f,actionType:W.ACTION_TYPE.FILL_UP}),[q,Xt]},[r,z,k,F,f,M,Et,K,Ce,he,Nt,X,d,te,Ie]);return w.default.createElement(p.Container,null,w.default.createElement(Ut,{backable:!1,closeable:!1,title:i("wallet_extension_send_title_send")}),w.default.createElement(H,null,w.default.createElement(pe,{title:i("wallet_extension_send_colored_send"),summaryList:[{coinId:r,coinAmount:jt}]})),w.default.createElement(H,null,w.default.createElement($t,{walletId:d,address:f,title:i("wallet_extension_network_address_title_walletused")},!!S&&w.default.createElement(Oe,{coinBalance:S,tooltip:i("extension_defi_bot_popuptext_avail_amount"),coinId:r}))),w.default.createElement(H,{bordered:!1},w.default.createElement(ue,{coinId:r,loading:F,feeError:k,networkFee:z,onClick:P})),w.default.createElement(ce,{placeholder:!0,offsetBottom:0,borderTop:!0},w.default.createElement(Z,{coinId:r,...Jt}),w.default.createElement(W,{buttonGroup:we})),w.default.createElement(Fe,{coinId:r,visible:L,signInfo:N,value:g,estimatedFee:z,onChange:O,onToggleVisible:P}),w.default.createElement(ve,{visible:Kt&&ht}))},hn=gr;a();l();var wn=x(D());var Sn=({unapproved:t})=>{let e=t.params?.message,o=Tn({unapproved:t});return wn.default.createElement(Cn,{message:e,unapproved:t,tipMessage:o})};a();l();var It=x(D()),Nn=x(ae()),En=x(Ro()),An=x(Dt());ie();Ee();fr();se();a();l();var Vt={AMOUNT:1,CONFIRM:2};var oo=Vt.AMOUNT;function Tr({unapproved:t}){let{from:e,type:o=U.BRC20_INSCRIBE,tick:n="",tid:r,amount:s,txSource:m=Ht.DAPP}=t?.params?.transaction||{},d=t?.localType||Eo,[f,M]=(0,It.useState)(oo),C=(0,Nn.useDispatch)(),N=(0,En.useHistory)(),_=ft({localType:d})?.netWorkId;_===void 0?_=Ot(d):_=+_;let g=(0,An.useCreation)(()=>o===U.BRC20_INSCRIBE?{chainId:_,coinType:Ae(_),symbol:n}:null,[o,r,n,_]),b=Wt(void 0,{},g)?.coinId,L=(0,It.useCallback)(async()=>{await C(dt(t.id)),await C(yt()),await nt(C)},[C,t.id]),P=Yt({from:e,chainIndex:Ot(d),handleCancel:L,method:t?.method}),F=(0,It.useCallback)(()=>{M(Vt.CONFIRM),oo=Vt.CONFIRM},[]),I=(0,It.useCallback)(async({txIds:G,commitTx:z,revealTxs:ct})=>{await C(lt(t.id,{txIds:G,commitTx:z,revealTxs:ct})),await C(yt()),N.push(Yo)},[C,N,t.id]),k=(0,It.useCallback)(()=>{M(Vt.AMOUNT),oo=Vt.AMOUNT},[]);return It.default.createElement(pn,{fromAddress:e,coinId:b},f===Vt.AMOUNT?It.default.createElement(cn,{amount:s,walletId:t.walletId,onCancel:L,onConfirm:F,headerProps:{closeable:!1,backable:!1}}):It.default.createElement(un,{addressCheckRet:P,txSource:m,onCancel:L,onConfirm:I,walletId:t.walletId,headerProps:{onBack:k,closeable:!1,backable:!0}}))}var kn=Tr;a();l();var u=x(D()),jn=x(ae()),Kn=x(Ro());ot();a();l();var no=x(D()),Bn=x(Dt());a();l();function bn(t=[]){if(!Array.isArray(t))throw new Error("assetChange should be an array");return t.map(e=>{let{direction:o,amount:n,usdAmount:r,symbol:s,logo:m}=e;return{operator:o===1?"+":"-",usdValue:r,rawValue:n,asset:{assetType:jo.NATIVE,amount:n,symbol:s,imageUrl:m}}})}var yr=({address:t,hexStringList:e=[],chainIndex:o=0},n={})=>{let r=e?.toString(),s={ready:o!==void 0&&!!e?.length,refreshDeps:[t,r,o],...n},{loading:m,data:d,error:f}=(0,Bn.useRequest)(async()=>(await vo({address:t,hexStringList:e,chainIndex:o})).data,s);return{loading:m,data:d,error:f}},Ir=t=>(0,no.useMemo)(()=>!t||!t.length?[]:t.map(e=>{let{assetChange:o=[],assetInversion:n}=e;return{status:e.analysisStatus,gasFee:e?.gasFee||0,isShowFee:e?.isShowFee,exploreUrl:e?.exploreUrl,inputInfo:e?.inputInfo||[],outputInfo:e?.outputInfo||[],assetChange:bn(o),assetInversion:n||!1}}),[t]),hr=(t=[])=>(0,no.useMemo)(()=>!t||!t.length?null:t.some(o=>o.status>0)?At.EXECUTE_ERROR:null,[t]);function Ln(t={},e={}){let{loading:o,data:n,error:r}=yr(t,e),{utxoAllInfos:s}=n||{},m=Ir(s),d=hr(m);return{loading:o,error:r||d,data:m}}a();l();var T=x(D()),fe=x(Ve());ot();a();l();Ee();function ro(t){return t===Ao.XRC_NFT}a();l();var de=x(D());var Fn=x(Cr());ot();var so=x(Dt());a();l();var Pn={address:"_address_11ipy_1"};function io({children:t,addresses:e=[],exploreUrl:o=""}){let n=e[0],r=(0,so.useMemoizedFn)(()=>{(0,Fn.default)(n),go.success({title:i("wallet_receive_toast_address_copied"),desc:""})},[n]),s=(0,so.useMemoizedFn)(()=>{o&&globalThis.platform.openTab({url:`${o}${n}`})},[n,o]);return e.length>1?t:de.default.createElement(je.WhiteBoard,{rebirthPopper:!0,popupStyle:{marginLeft:16,marginRight:16,padding:12,borderRadius:8},content:de.default.createElement(p.FlexBox,{align:p.ALIGN.center,justify:"center"},de.default.createElement(h.Text,{forceWrap:!0,size:h.SIZE.sm,className:Pn.address},n),de.default.createElement(rt,{size:rt.SIZE.xs,icon:"okx-wallet-plugin-copy",onClick:r,style:{marginLeft:8}}),de.default.createElement(rt,{size:rt.SIZE.sm,icon:"okx-wallet-plugin-open-link",onClick:s,style:{marginLeft:8}})),trigger:je.TRIGGER.hover},t)}a();l();var B={content:"_content_1i550_1",none:"_none_1i550_4",title:"_title_1i550_10",input:"_input_1i550_15",utxoContainer:"_utxoContainer_1i550_18",isCurrentAddr:"_isCurrentAddr_1i550_18",signTag:"_signTag_1i550_18",addrContainer:"_addrContainer_1i550_24",address:"_address_1i550_29",amount:"_amount_1i550_38",xrcAssetsContainer:"_xrcAssetsContainer_1i550_50",xrcAssetsTitle:"_xrcAssetsTitle_1i550_56",xrcAssetContainer:"_xrcAssetContainer_1i550_62",logo:"_logo_1i550_65",isNFT:"_isNFT_1i550_72",isNft:"_isNFT_1i550_72",amountText:"_amountText_1i550_75",protocol:"_protocol_1i550_78",moreXRCContainer:"_moreXRCContainer_1i550_85",moreXrcContainer:"_moreXRCContainer_1i550_85",showMoreTitle:"_showMoreTitle_1i550_89",moreAssetsLogos:"_moreAssetsLogos_1i550_95",moreAssetsLogo:"_moreAssetsLogo_1i550_95",expandContainer:"_expandContainer_1i550_106",expandContainer_title:"_expandContainer_title_1i550_110",expandContainerTitle:"_expandContainer_title_1i550_110",expandContainer_leftTotal:"_expandContainer_leftTotal_1i550_116",expandContainerLeftTotal:"_expandContainer_leftTotal_1i550_116",expandContainer_icon:"_expandContainer_icon_1i550_123",expandContainerIcon:"_expandContainer_icon_1i550_123"};var ao="inputInfo",Mn="outputInfo",We={xrcAsset:10,utxo:50},wr=({coinId:t,data:e={},currentAddr:o})=>{let[n,r]=(0,T.useState)({}),[,s]=Zo(t,{withPrice:!0}),m=(0,T.useMemo)(()=>[ao,Mn].map(_=>{let g=e[_]||[],O=n[_]||!1;return g.map((b,L)=>{let P=n[`${_}-${L}`]||!1,F=b.xrcAssets||[];return b.xrcToShow=P?F:F.slice(0,We.xrcAsset),b.moreXRC=F.slice(We.xrcAsset),b}),{key:_,exploreUrl:e.exploreUrl,allData:g,dataToShow:O?g:g.slice(0,We.utxo),moreData:g.slice(We.utxo)}}),[e,n]),d=(0,T.useCallback)((c=[])=>c.reduce((_,{amount:g})=>E.add(_,g),0),[]),f=(0,T.useCallback)(c=>{switch(c){case ao:return i("wallet_extension_asset_input_inputs_num",{amount:m[0].allData.length});case Mn:return i("wallet_extension_asset_outputs",{amount:m[1].allData.length});default:return""}},[m]),M=(0,T.useCallback)(c=>{r(_=>({..._,[c]:!0}))},[]),C=c=>{let{protocolType:_}=c||{};return ro(_)?c.logo||Wo:c.logo||Uo},N=T.default.memo(({xrcAssets:c=[]})=>T.default.createElement(p.FlexBox,{align:p.ALIGN.center,className:B.moreAssetsLogos},c.slice(0,3).map(_=>T.default.createElement("img",{className:B.moreAssetsLogo,src:_.logo||"",alt:_.symbol}))));return T.default.createElement(Me,{copyable:!1,title:i("wallet_extension_asset_btn_transaction_details")},m.map((c,_)=>{let g=_;return T.default.createElement("div",{key:g,className:(0,fe.default)(B.content,c.key===ao?B.input:"",c.dataToShow.length===0?B.none:"")},T.default.createElement("div",{className:(0,fe.default)(B.title)},f(c.key)),c.dataToShow.map((O,b)=>{let L=`${g}-${b}`;return T.default.createElement(T.default.Fragment,null,T.default.createElement(p.FlexBox,{key:L,align:p.ALIGN.center,justify:"space-between",className:(0,fe.default)(B.utxoContainer,o===O.address[0]?B.isCurrentAddr:"")},T.default.createElement("div",{className:(0,fe.default)(B.addrContainer)},T.default.createElement(io,{addresses:O.address,exploreUrl:c.exploreUrl},T.default.createElement("div",{className:B.address},O.address.length>1?i("wallet_extension_asset_title_multisig"):Lo(O.address[0]))),T.default.createElement(Io,{className:B.signTag,size:Ke.SIZE.sm},i("wallet_extension_asset_tag_sign"))),T.default.createElement("div",{className:B.amount},T.default.createElement(h.DisplayAmount,{noStyle:!0,amount:O.amount,mode:h.CRYPTO,symbol:s?.symbol,decimals:s?.decimals,precision:s?.decimals,isStableCoin:s?.stableCoin}))),O.xrcToShow.length>0&&T.default.createElement("div",{className:B.xrcAssetsContainer},T.default.createElement(h.Text,{size:h.SIZE.xs,className:B.xrcAssetsTitle},i("wallet_extension_asset_include_asset")),O.xrcToShow.map(P=>T.default.createElement(p.FlexBox,{align:p.ALIGN.center,className:B.xrcAssetContainer},T.default.createElement("img",{className:(0,fe.default)(B.logo,ro(P.protocolType)?B.isNFT:""),src:C(P),alt:P.symbol}),T.default.createElement(h.Text,{nowrap:!0,size:h.SIZE.xs,ellipsis:{tooltip:!0},className:B.amountText},`${P.amount} ${P.symbol}`),T.default.createElement(yo,{className:B.protocol,size:Ke.SIZE.sm},P.protocolName))),O.moreXRC.length>0&&!n[`${c.key}-${b}`]?T.default.createElement(p.FlexBox,{align:p.ALIGN.center,onClick:()=>{M(`${c.key}-${b}`)},className:B.moreXRCContainer},T.default.createElement(N,{xrcAssets:O.moreXRC}),T.default.createElement("div",{className:B.showMoreTitle},i("wallet_extension_asset_btn_show_num_asset",{amount:E.thousandFormat(O.moreXRC.length)})),T.default.createElement(rt,{icon:"okx-wallet-plugin-arrow-small-down",size:rt.SIZE.xs})):null))}),c.moreData.length>0&&!n[c.key]?T.default.createElement("div",{className:B.expandContainer,onClick:()=>{M(c.key)}},T.default.createElement(p.FlexBox,{align:p.ALIGN.center,justify:"space-between"},T.default.createElement("div",{className:B.expandContainer_title},i("wallet_extension_asset_more_amount_inputs",{amount:E.thousandFormat(c.moreData.length)})),T.default.createElement(p.FlexBox,null,T.default.createElement("div",{className:B.expandContainer_leftTotal},T.default.createElement(h.DisplayAmount,{noStyle:!0,amount:d(c.moreData),mode:h.CRYPTO,symbol:s?.symbol,decimals:s?.decimals,precision:s?.displayPrecision,isStableCoin:s?.stableCoin})),T.default.createElement(rt,{icon:"okx-wallet-plugin-arrow-small-down",size:Go.xs,className:B.expandContainer_icon})))):null)}))},On=wr;a();l();var $=x(D()),vn=x(Ve());ot();a();l();var mt={main:"_main_asg9r_1",title:"_title_asg9r_8",scrollArea:"_scrollArea_asg9r_17",item:"_item_asg9r_22",subTitle:"_subTitle_asg9r_25",content:"_content_asg9r_32",loading:"_loading_asg9r_38",arrow:"_arrow_asg9r_43",icon:"_icon_asg9r_48"};function Sr({psbts:t=[],loading:e,onClick:o}){let n=(0,$.useCallback)(s=>{o(s)},[o]),r=()=>e?$.default.createElement("div",{className:mt.scrollArea},$.default.createElement("div",{className:mt.loading},$.default.createElement(xo.Circle,null))):t.length===0?$.default.createElement(Co.State,{className:mt.empty}):$.default.createElement("div",{className:mt.scrollArea},(t||[]).map((s,m)=>$.default.createElement(p.FlexBox,{className:mt.item,align:p.ALIGN.center,key:s,onClick:()=>{n(m)}},$.default.createElement(p.FlexBox,{className:mt.content,direction:p.DIRECTION.vertical},$.default.createElement("div",{className:mt.subTitle},i("wallet_extension_asset_transaction_confirmation",{amount:to(m+1)})),$.default.createElement("div",{className:mt.content},Po(s))),$.default.createElement("div",{className:mt.arrow},$.default.createElement(rt,{className:(0,vn.default)("okx-wallet-plugin-arrow-small-right",mt.icon)})))));return $.default.createElement(p.FlexBox,{className:mt.main},$.default.createElement("div",{className:mt.title},i("",{number:to(t.length)})),r())}var Dn=(0,$.memo)(Sr);a();l();var lo=x(D());var Nr=t=>{let{loading:e,dappInfo:o,analyzeRet:n,showDappInfo:r=!0,noFold:s=!1}=t,{assetChange:m=[]}=n;return e?lo.default.createElement(xn,null):lo.default.createElement(gn,{assetChange:m,dappInfo:o,showDappInfo:r,noFold:s})},Ye=Nr;ie();se();a();l();var xt=x(D());ot();a();l();var Rt={main:"_main_1h9ym_1",box:"_box_1h9ym_6",tipImg:"_tipImg_1h9ym_12",tipImgIcon:"_tipImgIcon_1h9ym_21",tipImgPic:"_tipImgPic_1h9ym_25",title:"_title_1h9ym_29",decs:"_decs_1h9ym_37",w100:"_w100_1h9ym_43",footerWrap:"_footerWrap_1h9ym_46"};var Er=({visible:t,onCancel:e,onConfirm:o,headerProps:n,psbtHasMultiXRCAsset:r,paymentUseXRCAsset:s,assetInversion:m})=>{let d=(0,xt.useMemo)(()=>r?i("wallet_extension_tip_multiple_inscription_use"):s?i("wallet_extension_desc_inscription_asset"):m?i("wallet_extension_bot_desc_nft_high_pay"):"",[m,s,r]),f=Qe({light:"/cdn/assets/imgs/254/1A753CC7A4597254.png",dark:"/cdn/assets/imgs/254/5A6525A2E28CDA88.png"}),M=Qe({light:"/cdn/assets/imgs/2411/435A510ADAEB8439.png",dark:"/cdn/assets/imgs/2411/FF2841348F871214.png"});return xt.default.createElement(re,{visible:t,alignBottom:!0,noMargin:!0,maskClosable:!0,noContentPadding:!0,transitionProps:{type:"slide",placement:"bottom",timeout:300},confirmBtnProps:{size:at.SIZE.lg},cancelBtnProps:{size:at.SIZE.lg},cancelText:i("wallet_extension_function_btn_continue_transaction"),confirmText:i("wallet_extension_mid_dialog_btn_cancel"),onCancel:e,onConfirm:o,onClose:e},xt.default.createElement(p.FlexBox,{className:Rt.main,direction:p.DIRECTION.vertical},xt.default.createElement(p.Box,{className:Rt.box},xt.default.createElement(p.Box,{className:Rt.tipImg},xt.default.createElement(fo,{src:m?f:M,className:Rt.tipImgPic})),xt.default.createElement(h.Text,{className:Rt.title,align:h.ALIGN.center},m?i("wallet_extension_bot_title_high_valuediff"):i("wallet_extension_title_transaction_risk")),xt.default.createElement(h.Text,{className:Rt.decs,size:h.SIZE.sm,align:h.ALIGN.center},d)),xt.default.createElement(p.Box,{className:Rt.w100},xt.default.createElement(Ye,{...n,showDappInfo:!1,loading:!1,noFold:!0}))))},Un=Er;a();l();_r();dr();var Re=x(D());var Ar=()=>{let[t,e]=(0,Re.useState)(""),o=async()=>{let{data:n}=await So(ho.getSignPrompt);n.assetReminder?e(n.assetReminder):e(null)};return(0,Re.useEffect)(()=>{o()},[]),{assetReminder:t}},Wn=Ar;a();l();var Yn=x(D());ot();var kr=({onConfirm:t})=>(0,Yn.useCallback)(()=>{re.warn({title:i("wallet_extension_asset_alertbanner_title_alert"),alignBottom:!1,maskClosable:!1,hideCloseBtn:!0,text:i("wallet_extension_asset_alertbanner_desc_utxo_lost"),confirmBtnProps:{type:at.TYPE.outline,size:at.SIZE.lg},cancelBtnProps:{type:at.TYPE.highlight,size:at.SIZE.lg},onConfirm(e){e.destroy(),t()},async onCancel(e){e.destroy()},cancelText:i("commonall_text_btn_cancel"),confirmText:i("wallet_extension_asset_btn_continue")})},[t]),Rn=kr;a();l();var xe=x(D());a();l();var R=x(D()),mo=x(Ve());a();l();var Ct={main:"_main_1fewt_1",box:"_box_1fewt_6",isPureScreen:"_isPureScreen_1fewt_12",tipImg:"_tipImg_1fewt_15",tipImgIcon:"_tipImgIcon_1fewt_24",title:"_title_1fewt_28",decs:"_decs_1fewt_36",extLink:"_extLink_1fewt_42",footerWrap:"_footerWrap_1fewt_46",screenOneButtons:"_screenOneButtons_1fewt_49",extButton:"_extButton_1fewt_53"};var Gn=t=>{let{children:e,desc:o,title:n,isPureScreen:r}=t;return R.default.createElement(p.FlexBox,{className:Ct.main,direction:p.DIRECTION.vertical},R.default.createElement(p.Box,{className:(0,mo.default)(Ct.box,{[Ct.isPureScreen]:r})},R.default.createElement(p.Box,{className:Ct.tipImg},R.default.createElement(_o,{className:(0,mo.default)("okx-wallet-plugin-risk-trading",Ct.tipImgIcon)})),R.default.createElement(h.Text,{className:Ct.title,align:h.ALIGN.center},n),R.default.createElement(h.Text,{className:Ct.decs,size:h.SIZE.sm,align:h.ALIGN.center},o)),R.default.createElement(p.Box,{className:Ct.footerWrap},e))},br=({modalParams:t,handleCancel:e,handleNext:o})=>{let{screenOne:n,screenTwo:r}=t,[s,m]=(0,R.useState)(!1),d=async()=>{m(!0),await e(),m(!1)};return R.default.createElement(Gn,{desc:n.desc,title:n.title},R.default.createElement(p.Box,{className:Ct.screenOneButtons},R.default.createElement(at,{block:!0,loading:s,size:at.SIZE.lg,onClick:d,type:at.TYPE.highlight,category:at.CATEGORY.fill},n.mainBtnText),r?R.default.createElement(p.Box,{className:Ct.extButton,onClick:o},n.subBtnText):null))},Br=({handleCancel:t,handleNext:e,modalParams:o})=>{let{screenTwo:n={}}=o,{loading:r,onClick:s}=tt(e),{loading:m,onClick:d}=tt(t),f=[{loading:r,actionType:W.ACTION_TYPE.CANCEL,btnText:n.subBtnText,onClick:s},{loading:m,actionType:W.ACTION_TYPE.CONFIRM,btnText:n.mainBtnText,onClick:d}];return R.default.createElement(Gn,{isPureScreen:!0,desc:n.desc,title:n.title},R.default.createElement(p.Box,{className:Ct.screenTwoButtons},R.default.createElement(W,{buttonGroup:f})))},Lr=({handleCancel:t,closeModal:e,modalParams:o})=>{let[n,r]=(0,R.useState)(1);return n===2?R.default.createElement(Br,{modalParams:o,handleCancel:t,handleNext:e}):R.default.createElement(br,{modalParams:o,handleCancel:t,handleNext:()=>{r(2)}})},zn=Lr;a();l();var qn=x(D());ot();a();l();var Xn={extLink:"_extLink_1eb1z_1"};var Pr=()=>{let t=$o(),e=r=>({title:i("wallet_extension_fractal_title_transaction_risky"),desc:i(r,{case:qn.default.createElement(zo,{className:Xn.extLink,href:t?.scamsUrl},i("wallet_extension_function_link_case"))}),mainBtnText:i("wallet_extension_function_btn_cancel"),subBtnText:i("wallet_extension_function_btn_advanced")}),o={title:i("wallet_extension_fractal_title_transaction_risky"),desc:i("wallet_extension_function_desc_developer_continue"),mainBtnText:i("wallet_extension_mid_dialog_btn_cancel"),subBtnText:i("wallet_extension_function_btn_continue_transaction")};return{getUTXONotFoundModalParams:()=>({screenOne:e("wallet_extension_fractal_desc_transaction_risky"),screenTwo:o})}},Hn=Pr;var Fr=({psbtsInfoErr:t,handleCancel:e})=>{let{getUTXONotFoundModalParams:o}=Hn(),n=(0,xe.useRef)(),r=s=>{n.current||(n.current=re.action({hideCloseBtn:!0,maskClosable:!1,noContentPadding:!0,children:xe.default.createElement(zn,{modalParams:s,handleCancel:async()=>{await e(),n.current.destroy(),n.current=null},closeModal:()=>{n.current.destroy(),n.current=null}})}))};(0,xe.useEffect)(()=>{t?.code==At.UTXO_NOT_FOUND&&r(o())},[t])},Zn=Fr;a();l();ot();a();l();var co=x(wo());var $n=t=>{try{return co.Psbt.fromHex(t).toBase64()}catch{return co.Psbt.fromBase64(t),t}};var Ge=x(wo());var kt={LIST:"list",UNLIST:"unlist",TRADE:"trade",RUNES:"runes"},Vn=t=>{try{let e=Ge.Psbt.fromBase64($n(t)),o=e?.data?.inputs||[],n=e?.data?.globalMap?.unsignedTx?.tx?.outs||[],r=[];return o.forEach((s,m)=>{if(s.witnessUtxo)r.push({...s,value:s.witnessUtxo.value});else if(s.nonWitnessUtxo){let d=Ge.Transaction.fromBuffer(s.nonWitnessUtxo),f=e?.data?.globalMap?.unsignedTx?.tx?.ins||[],C=d.outs[f[m]?.index]?.value;r.push({...s,value:C})}}),{inputs:r,outputs:n}}catch{return{inputs:[],outputs:[]}}},Gt=(t,e=0,o)=>!Array.isArray(t)||o===0?0:t.slice(e,o?e+o:void 0).reduce((n,{value:r})=>E.add(n,r),0);var Jn=({unapproved:t})=>{let{psbt:e,psbts:o,type:n,from:r,amount:s=1,psbtOpts:m,broadcast:d=!1}=t.params.transaction,{origin:f,method:M}=t,C=t.method===Q.SIGNPSBTS,N=t?.walletId,c=t?.localType,g=ft({localType:c})?.coinId;g===void 0&&(g=St(c));let O=le(N),b=me(N),L=_e(N),{loading:P,data:F,error:I}=Ln({address:r,hexStringList:C?o:[e],chainIndex:Ot(c)}),[k,G]=(0,u.useState)(!1),[z,ct]=(0,u.useState)(0),K=(0,u.useMemo)(()=>C&&!k,[C,k]),S=(0,u.useMemo)(()=>F[z]||{},[F,z]),{assetReminder:X}=Wn(),Y=(0,jn.useDispatch)(),Nt=(0,Kn.useHistory)(),gt=rn(t),{name:ut,icon:st,host:Lt}=gt,{inputs:jt,outputs:J}=Vn(C?o[z]:e),it=(0,u.useMemo)(()=>E.sub(Gt(jt),Gt(J)),[jt,J]),Et=_n(),Kt=(0,u.useMemo)(()=>{if(n!==kt.TRADE&&n!==kt.RUNES)return null;let j=Number(s);if(n===kt.RUNES){let oe=Gt(J,1,j),ne=E.add(Gt(J,0,1),Gt(J,J.length-j+1,j-1));return`${E.sub(ne,E.add(oe,it))}`}let Tt=Gt(J,j+1,j),Mt=Gt(J,1,j);return`${E.sub(Mt,E.add(Tt,it))}`},[s,it,J,n]),ht=(0,u.useCallback)(async()=>{await Y(dt(t.id)),await nt(Y)},[Y,t.id]),{addressCheckError:wt,addressCheckLoading:Pt}=Yt({handleCancel:ht,from:r,method:M,chainIndex:Ot(c)}),et=(0,u.useMemo)(()=>O&&C?{type:Z.TIP_TYPE.COMMON_ERROR,message:i("extension_wallet_contractual_interaction_wallet_unavailable")}:b?{type:Z.TIP_TYPE.COMMON_ERROR,message:i("wallet_extension_top_toast_dapp_comingsoon")}:wt?{type:Z.TIP_TYPE.COMMON_ERROR,message:wt}:I?{type:qt.TYPE.warn,message:i("wallet_extension_asset_alert_trust_network")}:X&&!f?.includes("okx.com")?{type:qt.TYPE.warn,message:X}:{},[O,C,b,I,X,f,wt]),Ft=(0,u.useCallback)(async()=>{let j=No(c);try{let Tt=await Xo(C?o:e,r,N,{localType:j,isPsbts:C},m);await Y(lt(t.id,{signedTx:Tt,broadcast:d}))}catch(Tt){await Et({id:t.id,error:Tt?.message||"Error"})}await nt(Y)},[Nt,r,Et,Y,C,c,e,m,o,t.id,N]);Zn({psbtsInfoErr:I,handleCancel:ht});let Jt=Rn({onConfirm:Ft}),[Qt,V]=(0,u.useState)(!1),zt=(0,u.useMemo)(()=>{let j=S?.inputInfo||[],Tt=S?.outputInfo||[],Mt=j.filter(pt=>pt.address?.includes(r)),oe=Tt.filter(pt=>pt.address?.includes(r)),ne=[],Se=[];return Mt.forEach(pt=>{pt.xrcAssets&&pt.xrcAssets.forEach(_t=>{ne.some(Te=>Te.symbol===_t.symbol&&Te.protocolId===_t.protocolId)||ne.push({symbol:_t.symbol,protocolId:_t.protocolId})})}),oe.forEach(pt=>{pt.xrcAssets&&pt.xrcAssets.forEach(_t=>{Se.some(Te=>Te.symbol===_t.symbol&&Te.protocolId===_t.protocolId)||Se.push({symbol:_t.symbol,protocolId:_t.protocolId})})}),ne.length>0&&Se.length>0?!ne.every(pt=>Se.some(_t=>pt.symbol===_t.symbol&&pt.protocolId===_t.protocolId)):!1},[S,r]),te=(0,u.useMemo)(()=>{let j=S.inputInfo||[],Tt=S.outputInfo||[];return[...j,...Tt].some(Mt=>!!(Mt.xrcAssets&&Mt.xrcAssets.length>1))},[S]),Ce=(0,u.useMemo)(()=>F.some(j=>{let Tt=j.inputInfo||[],Mt=j.outputInfo||[];return[...Tt,...Mt].some(oe=>!!(oe.xrcAssets&&oe.xrcAssets.length>1))}),[F]);(0,u.useEffect)(()=>{K||(te||zt||S.assetInversion)&&V(!0)},[F,K,te,zt,S.assetInversion]);let Ie=(0,u.useCallback)(()=>{if(!Ce||!K){Ft();return}Jt()},[Ce,Ft,Jt,K]),he=(0,u.useCallback)(j=>{G(!0),ct(j)},[G]),{loading:we,onClick:q}=tt(ht),{loading:Xt,onClick:ge}=tt(Ie),He=(0,u.useMemo)(()=>[{loading:we,actionType:W.ACTION_TYPE.CANCEL,btnText:K?i("wallet_extension_asset_btn_cancel_all"):i("wallet_dapp_connection_btn_reject"),onClick:q},{disabled:b||P||et.type===Z.TIP_TYPE.COMMON_ERROR,actionType:W.ACTION_TYPE.CONFIRM,btnText:K?i("wallet_extension_asset_btn_confirm_all"):i("extension_transactions_btn_confirm"),onClick:ge,loading:Xt||Pt}],[b,we,Xt,q,et,ge,K,P,Pt]),Ze=(0,u.useMemo)(()=>{switch(n){case kt.LIST:return i("extension_wallet_transfer_maintitle_list");case kt.UNLIST:return i("extension_wallet_transfer_maintitle_cancel_listing");case kt.TRADE:return i("extension_wallet_transfer_maintitle_transaction");default:return i("extension_wallet_transfer_maintitle_transaction")}},[n]),ee=(0,u.useMemo)(()=>n==="list"||S&&!S.isShowFee?!1:E.gt(S.gasFee,0)||E.gt(it,0),[it,S,n]),ur=(0,u.useMemo)(()=>!I||I===At.EXECUTE_ERROR&&S.status!==At.PSBT_ANALYSIS_FAILED,[I,S]),pr=(0,u.useMemo)(()=>I&&I!==At.EXECUTE_ERROR||S?.status===At.PSBT_ANALYSIS_FAILED,[I,S]);return u.default.createElement(p.Container,null,u.default.createElement(Ut,{title:Ze,backable:C&&k,closeable:!1,onBack:()=>{G(!1)}}),K?u.default.createElement("div",null,u.default.createElement(H,null,u.default.createElement(eo,{summaryList:[{title:ut,desc:Lt,icon:{src:st}}],title:i("extension_contract_interaction_maintitle_request_from")})),u.default.createElement(Dn,{psbts:o,loading:P,onClick:he})):null,K?null:u.default.createElement(u.default.Fragment,null,ur&&u.default.createElement(Ye,{coinId:g,txType:U.TRANS_OUT,loading:P,dappInfo:{name:ut,host:Lt,icon:st},analyzeRet:S}),pr&&u.default.createElement(H,null,(n===kt.TRADE||n===kt.RUNES)&&u.default.createElement(pe,{summaryList:[{coinId:g,coinAmount:Kt}],tooltip:i("extension_infor_tooltip_asset_changestips"),title:i("extension_contract_interaction_maintitle_asset_changes")}),u.default.createElement(eo,{summaryList:[{title:ut,desc:Lt,icon:{src:st}}],title:i("extension_contract_interaction_maintitle_request_from")})),ee&&u.default.createElement(H,null,u.default.createElement(ue,{coinId:g,networkFee:S.gasFee||it})),u.default.createElement(H,null,u.default.createElement($t,{title:i("wallet_extension_network_address_title_walletused"),address:r,walletId:N,onCopyCallback:()=>{L({trade:"approve",all_confirmation:"wallet_used_address"})}})),!ee&&u.default.createElement(H,null,u.default.createElement(fn,{coinId:g})),u.default.createElement(H,null,u.default.createElement(On,{coinId:g,data:S,currentAddr:r})),u.default.createElement(H,null,u.default.createElement(Me,{data:C?o[z]:e,copyable:{hideDesc:!0}}))),k?null:u.default.createElement(ce,{placeholder:!0,offsetBottom:0,borderTop:!0},u.default.createElement(Z,{coinId:g,...et}),u.default.createElement(W,{buttonGroup:He})),u.default.createElement(Un,{visible:Qt,onCancel:()=>{V(!1)},onConfirm:()=>{V(!1),ht()},headerProps:{coinId:g,txType:U.TRANS_OUT,analyzeRet:S},psbtHasMultiXRCAsset:te,paymentUseXRCAsset:zt,assetInversion:S.assetInversion}))};a();l();var A=x(D()),Qn=x(ae()),tr=x(Dt());ot();ie();se();var er=({unapproved:t})=>{let e=t.walletId,{localType:o,method:n}=t,r=ft({localType:o}),s=r?.coinId;s===void 0&&(s=St(o));let m=me(e),{memo:d,value:f,memoPos:M,to:C,satBytes:N,from:c,extraParams:_}=t.params.transaction,g=Wt(s),[O,{toggle:b}]=(0,tr.useBoolean)(!1),[L,P]=(0,A.useState)(N?{level:vt.CUSTOM,satBytes:N}:{}),F=L?.satBytes,I=(0,Qn.useDispatch)(),[,k]=ke({coinId:s,address:c,chainId:g?.chainId}),G=k?.transferReminder;(0,A.useEffect)(()=>{if(!F&&k?.normal&&P({level:vt.STANDARD,satBytes:k?.normal}),F&&L?.level!==vt.CUSTOM){let V=k[Pe[L?.level]?.satBytes];P({...L,satBytes:V})}},[k]);let[z,ct]=Be({coinId:s,walletId:e,address:c,satBytes:F},{}),K=_e(e),[S,X,Y]=en({coinId:s,toAddr:C,walletId:e,fromAddr:c,satBytes:F,coinAmount:f,canTransferAmount:ct},{}),Nt=(0,A.useMemo)(()=>ct===void 0||X===void 0?!0:E.gte(ct,E.add(X,f)),[ct,f,X]),gt=Le({coinId:s,txType:U.TRANS_OUT,address:c}),ut=on({memo:d,memoPos:M,coinId:s,toAddr:C,walletId:e,coinAmount:f,fromAddr:c,localType:g?.localType,dustSize:k?.minOutput,networkFee:X,satBytes:L.satBytes}),st=Jo({coinId:s,walletId:e,satBytes:F,address:c,utxoType:Zt.TRANSFER}),Lt=le(e),[jt,J]=(0,A.useState)(!1),it=(0,A.useCallback)(async()=>{await I(dt(t.id)),await I(yt()),await nt(I),J(!1)},[I,t.id]),Et=(0,A.useCallback)(async()=>{let V=await st(f,X);await gt(V,()=>{it()}),J(!0);let zt=await ut({utxoList:V});t.id&&(await I(lt(t.id,{signedTx:zt,coinAmount:f,serviceCharge:X,satPerByte:F,coinId:s,..._})),await I(yt())),J(!1)},[gt,f,I,X,_,st,it,F,ut,t.id]),{loading:Kt,onClick:ht}=tt(it),{loading:wt,onClick:Pt}=tt(Et),{addressCheckError:et,addressCheckLoading:Ft}=Yt({method:n,from:c,handleCancel:ht,chainIndex:r?.chainId||Ne}),Jt=(0,A.useMemo)(()=>m?{type:Z.TIP_TYPE.COMMON_ERROR,message:i("wallet_extension_top_toast_dapp_comingsoon")}:Nt?Y?{type:Z.TIP_TYPE.FEE_ERROR}:et?{type:Z.TIP_TYPE.COMMON_ERROR,message:et}:{type:qt.TYPE.warn,message:G}:{type:Z.TIP_TYPE.FEE_BALANCE_INSUFFICIENT},[Y,m,Nt,G,et]),Qt=(0,A.useMemo)(()=>{let V=[{actionType:W.ACTION_TYPE.CANCEL,btnText:i("wallet_dapp_connection_btn_reject"),onClick:ht,loading:Kt}];return Nt?V=[...V,{disabled:z||S||Y||m||!Number(X)||!!et,actionType:W.ACTION_TYPE.CONFIRM,onClick:Pt,loading:wt||Ft}]:V=[...V,{coinId:s,address:c,walletId:e,actionType:W.ACTION_TYPE.FILL_UP}],V},[Kt,s,wt,X,Y,S,c,m,Nt,z,ht,Pt,e,Ft,et]);return A.default.createElement(p.Container,null,A.default.createElement(Ut,{title:i("wallet_trade_maintitle_transaction_confirm"),backable:!1,closeable:!1}),A.default.createElement(H,null,A.default.createElement(pe,{title:i("wallet_extension_send_colored_send"),summaryList:[{coinId:s,coinAmount:f}]})),A.default.createElement(H,null,A.default.createElement($t,{walletId:e,address:c,title:i("extension_send_mid_text_from"),onCopyCallback:()=>{K({trade:"send",all_confirmation:"wallet_used_address"})}},!!ct&&A.default.createElement(Oe,{coinBalance:ct,coinId:s})),A.default.createElement($t,{address:C,title:i("extension_send_mid_text_to"),onCopyCallback:()=>{K({trade:"send",all_confirmation:"to_address"})}})),A.default.createElement(H,{bordered:!1},A.default.createElement(ue,{coinId:s,loading:S,estimateFailed:Y,networkFee:X,level:L?.level,onClick:()=>{b(),K({trade:"send",all_confirmation:"network_fee"})}})),A.default.createElement(ce,{placeholder:!0,offsetBottom:0,borderTop:!0},A.default.createElement(Z,{coinId:s,...Jt}),A.default.createElement(W,{buttonGroup:Qt})),A.default.createElement(Fe,{coinId:s,visible:O,signInfo:k,value:L,estimatedFee:X,onChange:P,onToggleVisible:b}),A.default.createElement(ve,{visible:Lt&&jt}))};a();l();var ye=x(D()),ir=x(Dt());Ee();se();a();l();function or(t){try{return[JSON.parse(t),null]}catch{return[null,new Error("Illegal JSON string")]}}a();l();var qe=x(D()),rr=x(ae());ot();ie();se();a();l();var v=x(D());ot();var Xe=x(Dt());a();l();var bt={"inscription-preview":"_inscription-preview_yy6vc_1",inscriptionPreview:"_inscription-preview_yy6vc_1","inscription-preview__inner":"_inscription-preview__inner_yy6vc_13",inscriptionPreviewInner:"_inscription-preview__inner_yy6vc_13","inscription-preview-text":"_inscription-preview-text_yy6vc_21",inscriptionPreviewText:"_inscription-preview-text_yy6vc_21","inscription-preview-image":"_inscription-preview-image_yy6vc_26",inscriptionPreviewImage:"_inscription-preview-image_yy6vc_26","inscription-item__content":"_inscription-item__content_yy6vc_30",inscriptionItemContent:"_inscription-item__content_yy6vc_30","inscription-exceedTip":"_inscription-exceedTip_yy6vc_34",inscriptionExceedTip:"_inscription-exceedTip_yy6vc_34","inscription-extend":"_inscription-extend_yy6vc_39",inscriptionExtend:"_inscription-extend_yy6vc_39","inscription-extend__icon":"_inscription-extend__icon_yy6vc_43",inscriptionExtendIcon:"_inscription-extend__icon_yy6vc_43"};var uo=24,ze={TEXT:"text",IMAGE:"image"},Mr=v.default.memo(({type:t,contentType:e,body:o})=>{let[{inscriptionType:n,inscriptionContent:r},s]=(0,Xe.useSetState)({inscriptionType:ze.TEXT,inscriptionContent:o});return(0,v.useEffect)(()=>{if(t===U.ORDINAL_NFT||e?.startsWith("image/"))try{let m=URL.createObjectURL(new Blob([o]));s({inscriptionType:ze.IMAGE,inscriptionContent:m})}catch{s({inscriptionType:ze.TEXT,inscriptionContent:o})}finally{s({initing:!1})}},[o,e,s,t]),v.default.createElement(p.Box,{className:bt["inscription-preview"]},n===ze.IMAGE?v.default.createElement("img",{alt:"",src:r,className:bt["inscription-preview-image"]}):v.default.createElement(p.Box,{className:bt["inscription-preview__inner"]},v.default.createElement(h.Text,{forceWrap:!0,className:bt["inscription-preview-text"]},r)))}),Or=({type:t,contentType:e,body:o,rawBody:n})=>{let r=(0,v.useMemo)(()=>{let d=o?.length;return E.lt(d,1024)?`${d} B`:`${E.floorTruncate(E.div(d,1024),3)} KB`},[o?.length]),s=t===U.ORDINAL_NFT||e?.startsWith("image/"),m=s?n?.slice(0,200):n;return v.default.createElement(p.FlexBox,null,v.default.createElement(Mr,{type:t,body:o,contentType:e}),v.default.createElement(p.FlexBox,{direction:p.DIRECTION.vertical,className:bt["inscription-item__content"]},v.default.createElement(h.Text,{strong:!0,ellipsis:{tooltip:!s},size:h.SIZE.xs},m),v.default.createElement(h.Text,{size:h.SIZE.xs,type:h.TYPE.secondary},r)))},vr=({type:t,dataSource:e=[]})=>{let o=e?.length||0,[n,{toggle:r}]=(0,Xe.useBoolean)(!1),s=(0,v.useMemo)(()=>n?e?.slice(0,uo):e?.slice(0,3),[e,n]),m=(0,v.useMemo)(()=>Mo(t),[t]);return v.default.createElement(nn,{space:16,title:i(m,{num:o})},v.default.createElement(Ho,{space:24,renderEmpty:!1,dataSource:s,renderItem:d=>v.default.createElement(Or,{...d,type:t})}),n&&o>uo&&v.default.createElement(h.Text,{size:h.SIZE.xs,type:h.TYPE.secondary,className:bt["inscription-exceedTip"]},i("wallet_info_dialog_desc_replicate_hide",{num:E.sub(o,uo)})),o>3&&v.default.createElement(p.FlexBox,{justify:"center",className:bt["inscription-extend"],onClick:r},v.default.createElement(rt,{size:rt.SIZE.xs,className:bt["inscription-extend__icon"],icon:n?"okx-wallet-plugin-arrow-small-up":"okx-wallet-plugin-add-arrow-chevrons"})))},nr=vr;function Dr({unapproved:t}){let e=(0,rr.useDispatch)(),{id:o}=t,{type:n}=t.params?.transaction||{},r=Fo[n],{localType:s}=t,d=ft({localType:s})?.coinId;d===void 0&&(d=St(s));let f=async()=>{await e(yt()),await e(dt(t.id)),await nt(e)},M=async N=>{await e(lt(t.id,N)),await e(yt())},{inscriptions:C}=an();return qe.default.createElement(ln,{txId:o,headerProps:{title:r?i(r):null,closeable:!1,backable:!1},confirmButtonProps:{onCancel:f,onConfirm:M},slot:{top:qe.default.createElement(H,null,qe.default.createElement(nr,{type:n,dataSource:C}))},netWorkCoinId:d})}var sr=Dr;var Ur=[U.BRC20_MINT,U.BRC20_INSCRIBE,U.BRC20_DEPLOY],Wr=[U.RUNES_ETCH];function Yr(t,e){let o=bo(e);return Ur.includes(t)?o=ko(e):Wr.includes(t)&&(o=Bo(e)),o}function Rr(t,e){return e.map(({contentType:o,body:n})=>{let r=n;try{(t===U.ORDINAL_NFT||typeof t!="number"&&o?.startsWith("image/"))&&(r=y.Buffer.from(n,"hex"))}catch{}return{contentType:o,body:r,rawBody:n}})}function Gr({unapproved:t}){let{tick:e,type:o,from:n,to:r,txSource:s,inscriptions:m=[],amount:d,mintType:f=Oo.parallel,noBroadCast:M=!1}=t.params?.transaction||{},{localType:C}=t,N=(0,ye.useMemo)(()=>Rr(o,m),[o,m]),c=ft({localType:C}),_=c?.netWorkId;_===void 0?_=Ot(C):_=+_;let g=c?.coinId;g===void 0&&(g=St(C));let O=(0,ir.useCreation)(()=>{if(o===U.RUNES_ETCH){let[I,k]=or(m[0]?.body);if(k)return{chainId:_,coinType:Je(_),symbol:e,address:"btc-runesMain-invalid-inscriptions"};let G=I?.id||"";return{chainId:_,coinType:Je(_),symbol:e,address:`btc-runesMain-${G}`}}return e?{chainId:_,coinType:Ae(_),symbol:e}:null},[e,o,_]),b=Yr(o,_),L=Wt(void 0,{},O),P=(I,k)=>{let G=0;if(o===U.RUNES_ETCH){I.coinAmount=$e(d,10**L?.decimals),I.coinId=L?.coinId||g,I.txSource=s||Ht.DAPP;return}d&&L?.decimals&&(G=$e(d,10**L?.decimals)),I.coinAmount=G,I.coinId=k?g:L?.coinId||g,I.txSource=s||Ht.DAPP},F=(I,k)=>(I&&P(I,!0),Array.isArray(k)&&k.forEach(G=>{P(G,!1)}),M);return ye.default.createElement(mn,{params:{walletId:t.walletId,utxoType:Zt.INSCRIPTION_USE_NFT_UTXO,from:n,to:r,inscriptions:N,txType:o,protocolId:b,mintType:f,netWorkCoinId:g},lifecycle:{beforePostTx:F}},ye.default.createElement(sr,{unapproved:t}))}var ar=Gr;a();l();var lr=x(D()),mr=x(ae()),po=x(Dt());ot();ie();var zr=({unapproved:t})=>{let e=(0,mr.useDispatch)(),{targetCoin:o}=t.params||{},n={image:o.logo,decimals:o.decimals,name:o.name,address:o.contractAddress,symbol:o.symbol},r=_e(),s=(0,po.useMemoizedFn)(async()=>{r({all_confirmation:"cancel",trade:"add_token"}),await e(dt(t.id)),await nt(e)}),{loading:m,onClick:d}=tt(s),f={actionType:W.ACTION_TYPE.CANCEL,btnText:i("wallet_dapp_connection_btn_reject"),onClick:d,loading:m},M=(0,po.useMemoizedFn)(async()=>{try{r({all_confirmation:"confirm",trade:"add_token"}),await qo(o),await e(lt(t.id)),await nt(e)}catch(g){To.error(g?.data?.originalError?.msg||i("wallet_extenshion_toast_add_failed"))}}),{loading:C,onClick:N}=tt(M),c={actionType:W.ACTION_TYPE.CONFIRM,onClick:N,loading:C},_=[f,c];return lr.default.createElement(dn,{token:n,networkName:o.blockChain||o.localType,buttonGroup:_})},cr=zr;var gu=({unapproved:t})=>{switch(t.method){case Q.TRANSFER_NFT:case Q.SEND_INSCRIPTION:return Bt.default.createElement(yn,{unapproved:t});case Q.SPLITUTXO:return Bt.default.createElement(hn,{unapproved:t});case Q.INSCRIBE:case Q.INSCRIBE_TRANSFER:return Bt.default.createElement(kn,{unapproved:t});case Q.SIGNPSBT:case Q.SIGNPSBTS:return Bt.default.createElement(Jn,{unapproved:t});case Q.SIGN_MESSAGE:return Bt.default.createElement(Sn,{unapproved:t});case Q.MINT:return Bt.default.createElement(ar,{unapproved:t});case Q.WATCHASSET:return Bt.default.createElement(cr,{unapproved:t});case Q.SEND:case Q.SEND_BTC:return Bt.default.createElement(er,{unapproved:t});default:return""}};export{gu as default};
//# sourceMappingURL=Bitcoin-5WAVWH52.js.map
