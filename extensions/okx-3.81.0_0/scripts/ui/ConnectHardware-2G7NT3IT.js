import{a as Mr}from"./chunk-BNAJU2TX.js";import{a as to}from"./chunk-PQGL6H5C.js";import"./chunk-XIS6W7VE.js";import"./chunk-JHEMUHSU.js";import"./chunk-GXEP5BK5.js";import"./chunk-3BSFGGCJ.js";import"./chunk-6C2G522Z.js";import{a as Sr}from"./chunk-I4EML244.js";import"./chunk-TJIPZMF7.js";import"./chunk-57D6LCV2.js";import{a as Ar}from"./chunk-S7VT2TWF.js";import"./chunk-BNS5ABAB.js";import"./chunk-UFGJXE4D.js";import{a as M}from"./chunk-7QX2TXNH.js";import{d as X}from"./chunk-ZDHJHPQ5.js";import{a as br}from"./chunk-NI73NP7N.js";import{a as Lr}from"./chunk-WY5R5HAR.js";import"./chunk-GTQ5U6DA.js";import{b as Er}from"./chunk-A6POGSHU.js";import{b as wr,c as Rt,d as Cr,e as Tr,f as Ir,g as Br,h as No}from"./chunk-E4OWYVFY.js";import"./chunk-IZUTUDUM.js";import{c as eo}from"./chunk-IEVBF5LG.js";import"./chunk-PFJL2XWX.js";import"./chunk-GFFOVUC5.js";import"./chunk-7THBEIEJ.js";import"./chunk-QFKKFFVA.js";import"./chunk-YGZYVSPD.js";import"./chunk-4RX5BQ36.js";import"./chunk-VFMCFONI.js";import"./chunk-O3KHH6JI.js";import{b as Xt}from"./chunk-7R6RXU4S.js";import"./chunk-V3ZL5FH4.js";import"./chunk-QRGSOGHH.js";import{a as kr}from"./chunk-F2SPBGOT.js";import"./chunk-V7ZNWTMX.js";import"./chunk-MSP5TDR3.js";import"./chunk-VWGNVM37.js";import{h as ut}from"./chunk-QKBWJPY2.js";import"./chunk-XFPD3Q2E.js";import"./chunk-AFJBSSNA.js";import"./chunk-3ZKJXYZ4.js";import{a as Nr}from"./chunk-EBRJSEEJ.js";import"./chunk-PA7QUJH7.js";import"./chunk-MC7IOE6A.js";import"./chunk-N4IVZOUG.js";import"./chunk-JWVIZID6.js";import"./chunk-47LIW52M.js";import{Fa as dr,j as _r,y as Ht}from"./chunk-MSFAPAHB.js";import"./chunk-33XRMYWN.js";import"./chunk-ZOKF3EKQ.js";import"./chunk-MDBKHBHQ.js";import"./chunk-WRVJM3F3.js";import"./chunk-NYBKFEEM.js";import"./chunk-XVSXMJ3S.js";import"./chunk-KQ66JTF7.js";import{c as ve}from"./chunk-OOYDFTEF.js";import"./chunk-JNIP4OYT.js";import"./chunk-XRCQOGA2.js";import"./chunk-SWUBCABA.js";import"./chunk-EEIYH3NC.js";import"./chunk-ITDLKQAF.js";import"./chunk-U7IWD6UB.js";import"./chunk-CZBL7QEK.js";import"./chunk-PAJAZXOA.js";import"./chunk-7MCLPJAH.js";import"./chunk-WAIJPY5X.js";import{a as ko,b as xr,e as tt,g as Jt}from"./chunk-YGMRSF47.js";import"./chunk-6XGS36TZ.js";import{a as Bo}from"./chunk-M2YY6A5T.js";import"./chunk-XLG73W5Q.js";import{a as re,ja as pr,pb as Vt,q as $t,r as et,s as pe,t as jt,u as Yt}from"./chunk-GCS2RK7E.js";import"./chunk-OIPQWTNV.js";import{c as qt,e as zt}from"./chunk-VJI6MZK4.js";import"./chunk-5PRURJ2O.js";import{u as A}from"./chunk-FGAB46RQ.js";import"./chunk-47ZMUKCZ.js";import{o as Je}from"./chunk-Z62JX42S.js";import{$ as Ft,Aa as pt,C as Io,Fa as mr,Na as ie,ba as Ut,da as Kt,ea as ir}from"./chunk-2QHGKEME.js";import"./chunk-HAHRUU64.js";import"./chunk-B624VS3G.js";import{a as Qt,b as Zt,f as gr,g as yt}from"./chunk-W4SQ6335.js";import"./chunk-YDSDBRIT.js";import{a as se}from"./chunk-6PA65BO3.js";import{b as Oe}from"./chunk-OIXGC4LI.js";import"./chunk-MAAUVUWY.js";import"./chunk-4X64L7DZ.js";import"./chunk-WU2LB6XB.js";import"./chunk-GLL4BXR6.js";import"./chunk-4L5HWMAA.js";import{a as Re}from"./chunk-EZS2GR7E.js";import{j as Ze,q as Eo}from"./chunk-NUN72MDU.js";import"./chunk-BFWVIVOY.js";import"./chunk-S3FOFXM7.js";import{m as Wt,n as Pt,p as lr}from"./chunk-YIFLUVTR.js";import{c as Me,e as cr}from"./chunk-EN2WHAVL.js";import{h as ft}from"./chunk-CP2RIMI2.js";import{d as Gt}from"./chunk-3QLLFUC4.js";import{B as Ro,C as er,h as Lt}from"./chunk-EFOY37CC.js";import{c as r}from"./chunk-HMTT52FG.js";import"./chunk-45NMMWRA.js";import{c as g,d as ee,e as $,g as xe,h as ur,j as fr,k as yr,n as hr}from"./chunk-E4OV5WXB.js";import"./chunk-GR7YC6C3.js";import{g as Se,i as bt,k as Mt}from"./chunk-O33H5V3V.js";import"./chunk-DJN2J7J5.js";import"./chunk-35ANKHOJ.js";import"./chunk-BI4OEIFC.js";import{B as Zo,Db as rr,Fb as sr,J as Jo,Sb as To,Ub as nr,Yb as dt,_b as ar,la as R,na as Qe,p as Qo,ra as Ot,ta as vt,tb as Ae,ub as be,vb as or,wb as Dt}from"./chunk-COF7YKSN.js";import{A as i,K as k,o as Xo}from"./chunk-VZKEX7KP.js";import"./chunk-QCEQQDCM.js";import{A as Le,E as At,I as v,e as le,f as Ne,o as Xe,r as tr,x as St}from"./chunk-BJKBO23H.js";import"./chunk-IO3ALUOJ.js";import"./chunk-AHVVUOFF.js";import"./chunk-ZUJLXC72.js";import"./chunk-DJSNVDZI.js";import"./chunk-K336SGW3.js";import{I as Co,_ as Vo,aa as Nt,f as Et,m as Yo,p as kt,va as he}from"./chunk-XFTQD4B2.js";import"./chunk-FOOC6LB7.js";import"./chunk-DHKS44RQ.js";import"./chunk-4DBVFCYR.js";import"./chunk-2IGQWLAB.js";import{a as _t}from"./chunk-GVV6OTQP.js";import{t as J,u as Ve,z as I}from"./chunk-ZFVABNQN.js";import"./chunk-VYWNZTTM.js";import"./chunk-LBWWOQL4.js";import{a as ge}from"./chunk-4QGZDIBD.js";import{b as T}from"./chunk-73B6GL3S.js";import"./chunk-LVJGLJNA.js";import"./chunk-Z7PBP7IJ.js";import"./chunk-5F7M5EJ4.js";import"./chunk-RQWEJ5N6.js";import"./chunk-RNWGOGLT.js";import"./chunk-UGJ3FMEQ.js";import"./chunk-OPJRP6YV.js";import"./chunk-H6JAOQCX.js";import"./chunk-OJXBW2YQ.js";import"./chunk-Z2AIGJGI.js";import"./chunk-A3W4ZDEQ.js";import"./chunk-VBZ4JSJ6.js";import"./chunk-LBYXY63E.js";import"./chunk-M4ANCDMF.js";import"./chunk-J6KTJ3IN.js";import"./chunk-5CQODPK7.js";import"./chunk-C5XO4JMZ.js";import"./chunk-HI3LE734.js";import"./chunk-RX4V72AK.js";import{f as _,o as n,q as a}from"./chunk-Y5OH3DDZ.js";n();a();var de=_(T()),ae=_(se());n();a();var U=_(T()),no=_(ie()),Hr=_(se()),Gr=_(Je());he();k();cr();n();a();var we=_(T()),Or=_(ge());he();k();n();a();var ht=_(T());k();n();a();var oo={root:"_root_v9tdu_1",importedRoot:"_importedRoot_v9tdu_9",tag:"_tag_v9tdu_13"};var j="SELECTED",W="IMPORTED",Hs=({selectType:e})=>e===W?ht.default.createElement(r.FlexBox,{className:oo.importedRoot,align:r.ALIGN.center},ht.default.createElement(r.Box,{className:oo.tag},i("wallet_extension_card_label_added"))):ht.default.createElement(r.FlexBox,{className:oo.root,align:r.ALIGN.center},ht.default.createElement(tr,{checked:e===j,circle:!0})),me=Hs;n();a();var De={root:"_root_gwbd5_1",SELECTED:"_SELECTED_gwbd5_10",selected:"_SELECTED_gwbd5_10",IMPORTED:"_IMPORTED_gwbd5_13",imported:"_IMPORTED_gwbd5_13",selector:"_selector_gwbd5_16",main:"_main_gwbd5_19",name:"_name_gwbd5_23",assets:"_assets_gwbd5_29"};var Gs=e=>{let{account:t,children:o,setSelected:s,selectType:l,badgeSlot:m=null}=e,c=Jt()?.length;return we.default.createElement(r.Box,{className:(0,Or.default)(De.root,De[l]),onClick:()=>{l!==W&&s(d=>l===j?d.filter(f=>f.index!==t.index):c+d.length>=1e3?(v.error({title:i("wallet_extension_hardware_wallet_notif_max_account",{num:1e3})}),d):[...d,t])}},we.default.createElement(r.FlexBox,{className:De.selector,align:r.ALIGN.center},we.default.createElement(r.FlexBox,{justify:r.ALIGN.center,direction:r.DIRECTION.vertical,className:De.main},we.default.createElement(r.FlexBox,{align:r.ALIGN.center},we.default.createElement(r.Box,{className:De.name},i("wallet_extension_card_title_account",{value:`${Vo(`${t.index+1}`,2,"0")}`})),m),!!t.balance&&we.default.createElement(A.DisplayAmount,{ellipsis:!0,symbol:"$",mode:A.LEGAL,useApproximate:!1,className:De.assets},t.balance)),we.default.createElement(me,{selectType:l})),o)},ot=Gs;n();a();var b=_(T()),Lo=_(ge());k();Ae();n();a();var F={root:"_root_7hr89_1",tip:"_tip_7hr89_8",icon:"_icon_7hr89_13",info:"_info_7hr89_19",desc:"_desc_7hr89_23",entry:"_entry_7hr89_28",dialogRoot:"_dialogRoot_7hr89_34",title:"_title_7hr89_37",listWrap:"_listWrap_7hr89_42",pathItem:"_pathItem_7hr89_42",recommendItem:"_recommendItem_7hr89_51",SELECTED:"_SELECTED_7hr89_54",selected:"_SELECTED_7hr89_54",recommend:"_recommend_7hr89_51",detail:"_detail_7hr89_69",path:"_path_7hr89_42",address:"_address_7hr89_80",balance:"_balance_7hr89_88"};var vr=(0,b.memo)(({account:e,selectType:t,updateAddressType:o})=>{let{mainnet:s,addressType:l,addressTypeUpdated:m}=e,c=l[R],[d,f]=(0,b.useState)(!1),h=Object.values(s).filter(({balance:C})=>Xo.gt(C,0)),y=C=>{f(!1),o(e,C,R)},x=(0,b.useMemo)(()=>t===W||m?i("wallet_extension_hardware_wallet_notif_current_address",{network:"EVM",address:Io(s[c].address)}):i("wallet_extension_card_alert_default_option",{network:"EVM",address:Io(s[c].address)}),[m,t,c,s]);return h.length<=1||h.length===2&&h[0].address===h[1].address?null:b.default.createElement(r.Box,{className:F.root,onClick:C=>{C.stopPropagation()}},b.default.createElement(r.FlexBox,{className:F.tip},b.default.createElement(J,{className:(0,Lo.default)("okx-wallet-plugin-information-circle",F.icon)}),b.default.createElement(r.Box,{className:F.info},b.default.createElement(r.Box,{className:F.desc},x),b.default.createElement(r.Box,{className:F.entry,onClick:()=>{f(!0)}},i("wallet_extension_card_textbtn_change_network",{network:"EVM"})))),b.default.createElement(Xe.Action,{noContentPadding:!0,visible:d,alignBottom:!0,onClose:()=>{f(!1)}},b.default.createElement(r.Box,{className:F.dialogRoot},b.default.createElement(r.Box,{className:F.title},i("wallet_extension_top_title_change_evm",{network:"EVM"})),b.default.createElement(r.Box,{className:F.listWrap},Rt(e.index).map(C=>{let B=c===C.type;return b.default.createElement(r.FlexBox,{className:(0,Lo.default)(F.pathItem,{[F.recommendItem]:C.recommend,[F.SELECTED]:B}),onClick:()=>{B||y(C.type)},align:r.ALIGN.center},!!C.recommend&&b.default.createElement(r.Box,{className:F.recommend},i("wallet_extension_top_tag_recommended")),b.default.createElement(r.Box,{className:F.detail},b.default.createElement(r.Box,{className:F.path},C.pathName),b.default.createElement(r.Box,{className:F.address},s[C.type].address),b.default.createElement(A.DisplayAmount,{ellipsis:!0,symbol:"$",mode:A.LEGAL,useApproximate:!1,className:F.balance},s[C.type].balance)),b.default.createElement(me,{selectType:B?j:""}))})))))});n();a();var Dr=_(T());To();var qs=(e,t)=>{let o=e.index;return o!==void 0&&o===t.index},zs=(e,t)=>{let o=t?.[be]?.address;return!!o&&e?.account?.[be]===o},$s=(e,t)=>(0,Dr.useCallback)(o=>{let s=e.some(m=>m.index===o.index);return t.some(m=>qs(m,o)||zs(m,o))?W:s?j:""},[e,t]),rt=$s;n();a();var so=_(T()),gt=_(ie()),Wr=_(se());k();Eo();n();a();he();cr();var So={[$.addAccount]({hardware:e,account:t,baseChain:o,walletId:s}){return Bo(),Me().addHardwareWalletAccount(e,t,o,s)},[$.addChain]({account:e,baseChain:t,walletId:o}){return Me().addChainForHardwareWallet(e,t,o)},others({hardware:e,account:t,baseChain:o}){return Bo(),Me().importHardwareWalletAccount(e,t,o)}},js={async[g.ledger](e){let{otherInfo:t}=e,{ledgerInfo:o}=t;e.hardwareWalletModel=o.productName||xe[g.ledger]},[g.trezor](e){e.hardwareWalletModel=xe[g.trezor]},[g.keystone](e){let{otherInfo:t}=e,{keystoneInfo:o}=t;e.hardwareWalletModel=o.device||xe[g.keystone]},[g.onekey](e){let{otherInfo:t}=e,{onekeyInfo:o}=t,s=o?.deviceType?`${ee[g.onekey]} ${Yo(o?.deviceType)}`:"";e.hardwareWalletModel=s||xe[g.onekey]}},ro=({accounts:e,hardware:t,baseChain:o,walletId:s,type:l,...m})=>async()=>{let c;for(let d=0;d<e.length;d++){let f=kt(e[d]);f.otherInfo=m,await js[t](f),f.hardwareWalletType=xe[t];let p=So[l];p||(c?.walletId?(l=$.addAccount,s=c.walletId,p=So[l]):p=So.others);let h=await p({hardware:t,account:f,baseChain:o,walletId:s});c??=h}return c};lr();var Ys=(e,t)=>{let o={[g.onekey](){let{onekeyInfo:s}=t,l=s?.deviceType;return l?`${e}_${l}`:e},[g.keystone](){let{keystoneInfo:s}=t;return s?.device||e},[g.trezor](){return ee[g.trezor]}};return o[e]?o[e]():"unknown"},Vs=({hardware:e,selected:t,walletId:o,walletInfo:s={}})=>{let[l,m]=(0,so.useState)(!1),c=(0,Wr.useHistory)(),d=(0,gt.useDispatch)(),f=M(),p=(0,gt.useSelector)(Kt),h=(0,gt.useSelector)(Ft),y=(0,so.useCallback)(async()=>{try{let x={hardware:e,walletId:o,accounts:t,...s};if(o&&(x.type=$.addAccount),!p){d(Xt(x)),c.push(`${Vt}?from=${to.HARDWARE}`);return}if(!h){v.error({title:i("wallet_extension_hardware_wallet_notif_please_unlock")});return}m(!0),Ht({hardwarewallet_brand:e,device_name:Ys(e,s)}),await d(ro(x)),await Ze(d),m(!1),$.addAccount===f.get("type")?(v.success({title:i("wallet_addacount_toast_account_created")}),d(ut()),e===g.trezor?globalThis.platform.openExtensionInPopup(re):c.go(-1)):globalThis.platform.openExtensionInPopup(re)}catch(x){m(!1),x.message===Pt&&v.error(i("extension_wallet_addwallet_toast_wallets_added",{amount:1e3})),x.message===Wt&&v.error(i("wallet_home_toast_network_error"))}},[f,c,t,e,o,d,s,h,p]);return[l,y]},st=Vs;Eo();Ae();n();a();var Ao=_(T());k();n();a();var Pr={root:"_root_14fge_1"};var Xs=({selected:e,isSubmiting:t,handleSubmit:o})=>Ao.default.createElement(r.Box,{className:Pr.root},Ao.default.createElement(I,{block:!0,loading:t,category:I.CATEGORY.fill,type:I.TYPE.highlight,size:I.SIZE.lg,disabled:!e.length,onClick:o},e.length?i("wallet_extension_footer_btn_connecting",{value:e.length}):i("wallet_extension_footer_btn_connect"))),nt=Xs;n();a();var oe=_(T());he();n();a();var te={"retina-border-basic":"_retina-border-basic_1f1rt_1",retinaBorderBasic:"_retina-border-basic_1f1rt_1",root:"_root_1f1rt_29",header:"_header_1f1rt_38",back:"_back_1f1rt_75",close:"_close_1f1rt_76",title:"_title_1f1rt_80",content:"_content_1f1rt_84",selectorTitle:"_selectorTitle_1f1rt_87",selector:"_selector_1f1rt_87",item:"_item_1f1rt_97",lock:"_lock_1f1rt_101",button:"_button_1f1rt_106"};var Qs=({handleClick:e=Et,visible:t=!0})=>t?oe.default.createElement(r.Box,{className:te.root,onClick:e},oe.default.createElement(r.FlexBox,{justify:"space-between",className:te.header},oe.default.createElement(le.Input,{active:!0,className:te.back}),oe.default.createElement(le.Input,{active:!0,className:te.title}),oe.default.createElement(le.Input,{active:!0,className:te.close})),oe.default.createElement(r.Box,{className:te.content},oe.default.createElement(le.Input,{active:!0,className:te.selectorTitle}),oe.default.createElement(le.Input,{active:!0,className:te.selector}),oe.default.createElement(le.Input,{active:!0,className:te.selectorTitle}),oe.default.createElement(le.Input,{active:!0,className:te.item}),oe.default.createElement(le.Input,{active:!0,className:te.lock})),oe.default.createElement(le.Input,{active:!0,className:te.button})):null,Ce=Qs;n();a();var We={wrap:"_wrap_i44ji_1",root:"_root_i44ji_6",navigator:"_navigator_i44ji_11",title:"_title_i44ji_20",desc:"_desc_i44ji_26"};n();a();he();var Fr=_(ie()),Te=_(T());var Zs=e=>{let o=M().get("walletId"),s=(0,Fr.useSelector)(Ut),[l,m]=(0,Te.useState)(()=>o?s.find(h=>(h.walletIdentities||[]).some(x=>x.walletId===o))||{}:{});(0,Te.useEffect)(()=>{if(e&&Co(l)){let h=s.find(y=>y.masterFingerprint===e);h&&!Co(h)&&m(h)}},[s,e,l]);let[c,d]=(0,Te.useState)([]);(0,Te.useEffect)(()=>{let h=l?.walletIdentities||[];d(h)},[l]);let[f,p]=(0,Te.useState)(o);return(0,Te.useEffect)(()=>{let h=c?.[0];p(h?.walletId||"")},[c]),{targetKeyringIdentity:l,targetWalletIdentities:c,targetWalletId:f}},Ur=Zs;n();a();var Pe=_(T());he();k();var Js=e=>{let t=(0,Pe.useRef)(),o=(0,Pe.useRef)(),[s,l]=(0,Pe.useState)("");return(0,Pe.useEffect)(()=>{if(!(t.current&&o.current))return Et;let m=new IntersectionObserver(([c])=>{c.isIntersecting?l(""):l(i("wallet_extension_top_title_select_account"))},{root:t.current});return m.observe(o.current),()=>{m.disconnect()}},[e]),{title:s,wrapRef:t,titleRef:o}},Kr=Js;var qr=()=>{let e=(0,Hr.useHistory)(),[t,o]=(0,U.useState)(""),s=(0,no.useSelector)(mr),l=s[t]||{},{targetKeyringIdentity:m,targetWalletIdentities:c,targetWalletId:d}=Ur(t),[f,p]=(0,U.useState)([]),h=(0,no.useDispatch)(),y=(0,U.useCallback)(async L=>{await Me().setScanedKeyStone(L),await Ze(h)},[h]),{hasDangerKeystoneScaned:x}=br(),C=(0,U.useCallback)(async L=>{o(L.masterFingerprint);let Y=await Ir(L),V=await wr(Y);await y({...L,accountsWithBalance:V});let{device:ke,deviceVersion:je}=L;ke===Cr&&(!je||Tr(je,"1.0.4")===-1)&&(x||(h(qt("hasDangerKeystoneScaned",!0)),No.showUpdateModal()))},[y]),B=L=>{let Y=s[L];C(Y)},N=async()=>{let L=await No.openModal(Br.getAccounts,{onBackBtnClick(){e.goBack()}}),Y=s[L.masterFingerprint];Y&&(L.accountsWithBalance=Y.accountsWithBalance),C(L)};(0,Gr.useMount)(()=>{m?.masterFingerprint?B(m?.masterFingerprint):N()});let O=l?.accountsWithBalance,{title:K,wrapRef:E,titleRef:D}=Kr(O),Ee=rt(f,c),[$e,jo]=st({walletInfo:{keystoneInfo:Nt(l,["device","deviceId","masterFingerprint"])},selected:f,walletId:d,hardware:g.keystone}),Ps=async(L,Y,V=R)=>{let ke=c.find(Ye=>Ye.index===L.index);ke&&await Me().updateWalletAddress(ke.walletId,{[V]:Y});let{accountsWithBalance:je}=l,Us=je.map(Ye=>{if(L.index===Ye.index){let{addressType:Ks}=Ye;return{...Ye,addressType:{...Ks,[V]:Y},addressTypeUpdated:!0}}return Ye});y({...l,accountsWithBalance:Us})},Fs=((L={})=>Y=>{let V=Y?.addressType?.[R];if(L[V])return L[V];let ke=Rt(0).find(je=>je.type===V)?.pathName||"";return ke?L[V]=ke.split("|")?.[0]?.trim():L[V]="",L[V]})();return U.default.createElement(r.Box,{className:We.wrap},O?.length?U.default.createElement(r.FlexBox,{className:We.root,align:r.ALIGN.unset,direction:r.DIRECTION.vertical},U.default.createElement(X,{closeable:!1,bordered:!1,title:K,className:We.navigator}),U.default.createElement(r.FlexBox,{direction:r.DIRECTION.vertical,className:We.wrap,ref:E},U.default.createElement(r.Box,{className:We.title,ref:D},i("wallet_extension_top_title_select_account")),U.default.createElement(r.Box,{className:We.desc},i("extension_wallet_hardware_wallet_text_multi_net")),O.map(L=>{let Y=Ee(L),V=Fs(L);return U.default.createElement(ot,{account:L,selectType:Y,setSelected:p,badgeSlot:V?U.default.createElement(Ne,{type:Ne.TYPE.rect},V):null},U.default.createElement(vr,{account:L,selectType:Y,updateAddressType:Ps}))})),U.default.createElement(nt,{selected:f,isSubmiting:$e,handleSubmit:jo})):U.default.createElement(Ce,null))};n();a();k();var $r=_(ie());var jr=_(se());var w=_(T());n();a();var Fe=_(T()),bo=_(ge());k();n();a();var Ie={root:"_root_14nif_1",closeWrap:"_closeWrap_14nif_5",closeIcon:"_closeIcon_14nif_13",closeText:"_closeText_14nif_17",stepWrap:"_stepWrap_14nif_23",stepItem:"_stepItem_14nif_30",active:"_active_14nif_37"};var Rs=e=>{let{currentStep:t,handleClose:o}=e;return Fe.default.createElement(r.Box,{className:Ie.root},Fe.default.createElement(r.Box,{className:Ie.closeWrap},Fe.default.createElement(J,{onClick:o,className:(0,bo.default)("okx-wallet-plugin-close",Ie.closeIcon)}),t!==3?Fe.default.createElement(r.Box,{onClick:o,className:Ie.closeText},i("wallet_extension_top_textbtn_skip")):null),Fe.default.createElement(r.Box,{className:Ie.stepWrap},Array(4).fill(" ").map((s,l)=>Fe.default.createElement(r.Box,{key:l,className:(0,bo.default)(Ie.stepItem,{[Ie.active]:t===l})}))))},xt=Rs;n();a();var Mo=_(T());n();a();var zr={root:"_root_6z8ot_1"};var en=({handleNext:e})=>Mo.default.createElement(r.FlexBox,{className:zr.root,align:r.ALIGN.center,justify:r.ALIGN.center,onClick:e},Mo.default.createElement(J,{className:"okx-wallet-plugin-to"})),ao=en;n();a();var P={root:"_root_15mve_1",wrap:"_wrap_15mve_9",title:"_title_15mve_13",titleColorfulGreen:"_titleColorfulGreen_15mve_22",titleColorfulYellow:"_titleColorfulYellow_15mve_25",desc:"_desc_15mve_28",firstScreenImg:"_firstScreenImg_15mve_36",secondAndFourthScreenImg:"_secondAndFourthScreenImg_15mve_42",thirdScreenImg:"_thirdScreenImg_15mve_45",footerWrap:"_footerWrap_15mve_48"};var tn=e=>{let{handleNext:t,handleClose:o}=e,s=ft({light:"/cdn/assets/imgs/245/AB118B1F7E00FCCF.png",dark:"/cdn/assets/imgs/245/46D15BEDF89AD94E.png"});return w.default.createElement(w.default.Fragment,null,w.default.createElement(xt,{currentStep:0,handleClose:o}),w.default.createElement(r.Box,{className:P.wrap},w.default.createElement(r.Box,{className:P.title},w.default.createElement("span",null,i("wallet_extension_top_title_added_seed_phrase1",{seedPhrase:i("wallet_extension_top_title_added_seed_phrase2")}))),w.default.createElement(A.Text,{className:P.desc},i("wallet_extension_top_maintitle_added_seed_phrase")),w.default.createElement(_t,{className:P.firstScreenImg,src:s})),w.default.createElement(ao,{handleNext:t}))},on=e=>{let{handleNext:t,handleClose:o}=e,s=ft({light:"/cdn/assets/imgs/245/4A7B68AABB586801.png",dark:"/cdn/assets/imgs/245/46C68B7C7B93F25B.png"});return w.default.createElement(w.default.Fragment,null,w.default.createElement(xt,{currentStep:1,handleClose:o}),w.default.createElement(r.Box,{className:P.wrap},w.default.createElement(r.Box,{className:P.title},i("wallet_extension_top_title_unlock_hardware")),w.default.createElement(A.Text,{className:P.desc},i("wallet_extension_top_subtitle_confirm_unlock")),w.default.createElement(_t,{src:s,className:P.secondAndFourthScreenImg})),w.default.createElement(ao,{handleNext:t}))},rn=e=>{let{handleNext:t,handleClose:o}=e,s=ft({light:"/cdn/assets/imgs/245/21F0D08062856488.png",dark:"/cdn/assets/imgs/245/D8A2A5141B0A6F22.png"});return w.default.createElement(w.default.Fragment,null,w.default.createElement(xt,{currentStep:2,handleClose:o}),w.default.createElement(r.Box,{className:P.wrap},w.default.createElement(r.Box,{className:P.title},i("wallet_extension_top_title_usb_connected")),w.default.createElement(A.Text,{className:P.desc},i("wallet_extension_top_subtitle_after_connected")),w.default.createElement(_t,{src:s,className:P.thirdScreenImg})),w.default.createElement(ao,{handleNext:t}))},sn=e=>{let{handleClose:t}=e,o=ft({light:"/cdn/assets/imgs/245/21F0D08062856488.png",dark:"/cdn/assets/imgs/245/D8A2A5141B0A6F22.png"});return w.default.createElement(w.default.Fragment,null,w.default.createElement(xt,{currentStep:3,handleClose:t}),w.default.createElement(r.Box,{className:P.wrap},w.default.createElement(r.Box,{className:P.title},i("wallet_extension_top_title_asset_allocation1",{app:i("wallet_extension_top_title_asset_allocation2")})),w.default.createElement(A.Text,{className:P.desc},i("wallet_extension_top_subtitle_turnon_ledger")),w.default.createElement(_t,{src:o,className:P.secondAndFourthScreenImg})),w.default.createElement(r.Box,{className:P.footerWrap},w.default.createElement(I,{category:I.CATEGORY.fill,type:I.TYPE.highlight,size:I.SIZE.lg,className:"wallet-management__button",onClick:t},i("wallet_extension_footer_btn_connect1"))))},nn=[tn,on,rn,sn],an=()=>{let e=(0,$r.useDispatch)(),t=(0,jr.useHistory)(),[o,s]=(0,w.useState)(0),l=nn[o],m=(0,w.useCallback)(()=>{s(d=>++d)},[]),c=(0,w.useCallback)(()=>{t.replace(et)},[t]);return(0,w.useEffect)(()=>{e(qt("isLedgerImported",!0))},[e]),w.default.createElement(r.Container,{className:P.root},w.default.createElement(l,{handleNext:m,handleClose:c}))},Yr=an;n();a();var Z=_(T()),Ct=_(se());k();n();a();var _e=_(T()),ss=_(Je());k();Ae();n();a();var Be=_(T()),Vr=_(ge());k();ar();Mt();n();a();var ue={root:"_root_f2f0f_1",SELECTED:"_SELECTED_f2f0f_8",selected:"_SELECTED_f2f0f_8",IMPORTED:"_IMPORTED_f2f0f_11",imported:"_IMPORTED_f2f0f_11",addressBox:"_addressBox_f2f0f_14",block:"_block_f2f0f_18",tag:"_tag_f2f0f_29",assets:"_assets_f2f0f_40",address:"_address_f2f0f_14"};var Oo=({account:e,onSelect:t,selectType:o,baseCoin:s})=>Be.default.createElement(r.FlexBox,{align:r.ALIGN.center,className:(0,Vr.default)(ue.root,{[ue.SELECTED]:o===j,[ue.IMPORTED]:o===W}),onClick:()=>{o!==W&&t(e)}},Be.default.createElement(r.Box,{className:ue.addressBox},dt.map((l,m)=>{let c=m;return Be.default.createElement(r.Box,{className:ue.block,key:c},Be.default.createElement(r.Box,{className:ue.tag},i(nr[l])),Be.default.createElement(A.DisplayAmount,{className:ue.assets,mode:A.CRYPTO,symbol:s.symbol,decimals:s.decimals,ellipsis:{tooltip:!0},precision:s.displayPrecision,isStableCoin:s.stableCoin},e[l]?.coinAmount),Be.default.createElement(r.Box,{className:ue.address},e[l]?.address))})),Be.default.createElement(me,{selectType:o}));Oo.pickAssetAccounts=e=>{let t=[];return Se(e)&&e.forEach(o=>{o?.hasAsset&&t.push(o)}),t};Oo.getSelectType=({account:e,selected:t,selectedAddressesInTargetIdentity:o,baseChain:s})=>{let l=m=>m.some(c=>{bt(c)&&(c=c?.address);let d=!1;return dt.forEach(f=>{Oe(e?.[f]?.address,c,{localType:s})&&(d=!0)}),d});return l(o)?W:l(t)?j:""};var Xr=Oo;n();a();var at=_(T()),Qr=_(ge());Mt();n();a();Mt();var lo=({account:e,selected:t,selectedAddressesInTargetIdentity:o=[],baseChain:s})=>{let l=m=>m.some(c=>(bt(c)&&(c=c?.address),Oe(c,e.address,{localType:s})));return l(o)?W:l(t)?j:""};n();a();var Ue={root:"_root_h2by8_1",SELECTED:"_SELECTED_h2by8_9",selected:"_SELECTED_h2by8_9",IMPORTED:"_IMPORTED_h2by8_12",imported:"_IMPORTED_h2by8_12",main:"_main_h2by8_15",asset:"_asset_h2by8_19",address:"_address_h2by8_26"};var vo=({account:e,onSelect:t,selectType:o,baseCoin:s})=>{let{symbol:l,decimals:m}=s,{address:c}=e,d=e?.coinAmount;return at.default.createElement(r.FlexBox,{align:r.ALIGN.center,className:(0,Qr.default)(Ue.root,{[Ue.SELECTED]:o===j,[Ue.IMPORTED]:o===W}),key:c,onClick:()=>{o!==W&&t(e)}},at.default.createElement(r.Box,{className:Ue.main},at.default.createElement(A.DisplayAmount,{className:Ue.asset,mode:A.CRYPTO,symbol:l,decimals:m,ellipsis:{tooltip:!0},precision:s?.displayPrecision,isStableCoin:s?.stableCoin},d),at.default.createElement(r.Box,{className:Ue.address},e.address)),at.default.createElement(me,{selectType:o}))};vo.pickAssetAccounts=e=>{let t=[];return Se(e)&&e.forEach(o=>{Lt(o?.coinAmount,0)&&t.push(o)}),t};vo.getSelectType=lo;var Do=vo;n();a();var S=_(T()),Zr=_(ie()),Wo=_(ge());he();k();Ae();Mt();n();a();var H={"retina-border-basic":"_retina-border-basic_t9fhu_1",retinaBorderBasic:"_retina-border-basic_t9fhu_1",root:"_root_t9fhu_29",SELECTED:"_SELECTED_t9fhu_37",selected:"_SELECTED_t9fhu_37",IMPORTED:"_IMPORTED_t9fhu_40",imported:"_IMPORTED_t9fhu_40",main:"_main_t9fhu_43",address:"_address_t9fhu_46",asset:"_asset_t9fhu_52",dontHaveAsset:"_dontHaveAsset_t9fhu_53",assetArrow:"_assetArrow_t9fhu_64",assetModal:"_assetModal_t9fhu_72",assetList:"_assetList_t9fhu_72",chainImage:"_chainImage_t9fhu_116",chainName:"_chainName_t9fhu_121",coinAmountDisplay:"_coinAmountDisplay_t9fhu_126",coinAmountDisplayText:"_coinAmountDisplayText_t9fhu_131",commonFooter:"_commonFooter_t9fhu_137"};var Po=({account:e,onSelect:t,selectType:o})=>{let[s,l]=(0,S.useState)(!1),m=(0,Zr.useSelector)(pt),c=Lr(),d=m.filter(y=>y.baseChain===R),{assetList:f=[]}=e,p=(0,S.useMemo)(()=>d.map(y=>{let{coinId:x}=y,C=kt(y),B=f.find(O=>O.coinId===x);C.coinAmount=B?.coinAmount||"0";let N=c[x];return N&&(C.decimals=N.decimals,C.symbol=N.symbol,C.displayPrecision=N.displayPrecision,C.stableCoin=N.stableCoin),C}).sort((y,x)=>x.coinAmount-y.coinAmount),[d,f,c]),{address:h}=e;return S.default.createElement(S.default.Fragment,null,S.default.createElement(r.FlexBox,{align:r.ALIGN.center,className:(0,Wo.default)(H.root,{[H.SELECTED]:o===j,[H.IMPORTED]:o===W}),key:h,onClick:()=>{o!==W&&t(e)}},S.default.createElement(r.Box,{className:H.main},S.default.createElement(r.Box,{className:H.address},e.address),e.hasAsset?S.default.createElement(r.Box,{className:H.asset,onClick:y=>{y.stopPropagation(),l(!0)}},S.default.createElement("span",null,i("wallet_extension_card_btn_view_assets")),S.default.createElement(J,{className:(0,Wo.default)("okx-wallet-plugin-right",H.assetArrow)})):S.default.createElement(r.Box,{className:H.dontHaveAsset},S.default.createElement("span",null,i("wallet_extension_card_btn_noearnings_yet")))),S.default.createElement(me,{selectType:o})),S.default.createElement(Xe.Action,{onClose:()=>{l(!1)},className:H.assetModal,visible:s,hideCloseBtn:!0,alignBottom:!0,whiteboard:!0,title:null},S.default.createElement(r.Box,{className:H.assetList},p.map((y,x)=>{let C=x;return S.default.createElement(r.FlexBox,{align:r.ALIGN.center,className:H.asset,key:C},S.default.createElement(At,{className:H.chainImage,src:y.image||Re}),S.default.createElement(r.Box,{className:H.chainName},S.default.createElement(Sr,{maxWidth:"192px",text:y.chainName})),S.default.createElement(r.Box,{className:H.coinAmountDisplay},S.default.createElement(A.DisplayAmount,{className:H.coinAmountDisplayText,mode:A.CRYPTO,symbol:y.symbol,decimals:y.decimals,precision:y.displayPrecision,isStableCoin:y.stableCoin,ellipsis:{tooltip:!0}},y?.coinAmount)))})),S.default.createElement(r.Box,{className:H.commonFooter},S.default.createElement(I,{category:I.CATEGORY.fill,type:I.TYPE.highlight,size:I.SIZE.lg,onClick:()=>l(!1),block:!0},i("wallet_extension_footer_btn_same_device_ok")))))};Po.pickAssetAccounts=e=>{let t=[];return Se(e)&&e.forEach(o=>{let{assetList:s=[]}=o||{};Se(s)&&s.some(l=>Lt(l?.coinAmount,0))&&(o.hasAsset=!0,t.push(o))}),t};Po.getSelectType=lo;var Jr=Po;n();a();var lt=_(T());k();n();a();var Fo={showAll:"_showAll_dqqdk_1",showAllText:"_showAllText_dqqdk_11"};var ln=({hasAssetAccounts:e,renderList:t,handleUnFold:o})=>lt.default.createElement(lt.default.Fragment,null,t(e),lt.default.createElement(r.Box,{className:Fo.showAll,onClick:o},lt.default.createElement("span",{className:Fo.showAllText},i("wallet_extension_top_dropdown_show_assets")),lt.default.createElement(J,{className:"okx-wallet-plugin-arrow-small-down"}))),Rr=ln;n();a();var Ke=_(T()),es=_(se());k();n();a();var Uo={title:"_title_1nhzx_1",selector:"_selector_1nhzx_7"};var mn=({basePath:e,setBasePath:t})=>{let{hardware:o}=(0,es.useParams)(),l=M().get("baseChain"),m=(0,Ke.useMemo)(()=>hr?.[o]?.[l],[l,o]);return m?Ke.default.createElement(Ke.default.Fragment,null,Ke.default.createElement(A.Text,{className:Uo.title},i("wallet_addwallet_subtitle_hardware_wallet_select_a_hd_path")),Ke.default.createElement(St,{value:e,className:Uo.selector,type:St.TYPE.input,options:m,onChange:({value:c})=>{t(c)},align:St.DIRECTION.right})):null},ts=mn;n();a();var ce=_(T()),io=_(Je());k();n();a();var Ko={loadMore:"_loadMore_15zyi_1",loadMoreText:"_loadMoreText_15zyi_9"};var os=8,cn=({renderList:e,scrollWrapRef:t,fetchAddress:o,firstPageAccounts:s})=>{let l=(0,ce.useRef)(),[m,c]=(0,ce.useState)(os),d=()=>{clearInterval(l.current),c(os),l.current=setInterval(()=>{c(y=>Math.max(y-1,0))},1e3)};(0,io.useUnmount)(()=>{clearInterval(l.current)});let{data:f,noMore:p}=(0,io.useInfiniteScroll)(async y=>{d();let x=y?.pageNo||1,C=await o(x);return x===1&&(C=[...s,...C]),{list:C,pageNo:x+1}},{target:t,isNoMore:y=>y?.list?.length>=1e3}),h=f?.list||s;return ce.default.createElement(ce.default.Fragment,null,e(h),p?null:ce.default.createElement(r.Box,{className:Ko.loadMore},ce.default.createElement(Ve,null),ce.default.createElement("span",{className:Ko.loadMoreText},m>0?i("wallet_extension_footer_loading_est_loading",{value:m}):i("wallet_extension_footer_loading_wait_amoment"))))},rs=cn;n();a();var mo={root:"_root_yoqwy_1",title:"_title_yoqwy_7",icon:"_icon_yoqwy_13"};var Ho={[R]:Jr,[Qe]:Xr,[Ot]:Do,[vt]:Do},_n=({baseChain:e,fetchAddress:t,basePath:o,setBasePath:s,firstPageAccounts:l,coinId:m,selected:c,selectedAddressesInTargetIdentity:d,...f})=>{let p=(0,_e.useRef)(),h=Ho[e],y=h.pickAssetAccounts(l),x=y.length,[C,{setFalse:B}]=(0,ss.useBoolean)(!!(x&&x!==l.length)),{baseCoin:N}=Ar(m,!0),O=K=>K.map(E=>{let D=h.getSelectType({account:E,selected:c,selectedAddressesInTargetIdentity:d,baseChain:e});return _e.default.createElement(h,{account:E,baseCoin:N,selectType:D,...f})});return _e.default.createElement(r.FlexBox,{ref:p,className:mo.root,align:r.ALIGN.unset,direction:r.DIRECTION.vertical},_e.default.createElement(ts,{basePath:o,setBasePath:s}),_e.default.createElement(A.Text,{className:mo.title},i("wallet_extension_top_title_select"),e===R?_e.default.createElement(ve,{className:mo.icon,icon:"okx-wallet-plugin-information-circle",tooltip:{title:i("wallet_extension_toast_tooltip_try_switch"),placement:Le.DIRECTION.bottom},size:ve.SIZE.xs}):null),C?_e.default.createElement(Rr,{renderList:O,handleUnFold:B,hasAssetAccounts:y}):_e.default.createElement(rs,{renderList:O,fetchAddress:t,scrollWrapRef:p,firstPageAccounts:l}))},ns=_n;n();a();var mt=_(T()),it=_(ie()),wt=_(se());k();Eo();Jo();lr();Ae();ar();var as=()=>{let e=M(),{hardware:t}=(0,wt.useParams)(),o=e.get("baseChain"),[s,l]=(0,mt.useState)(()=>t===g.ledger?o===Ot?yr:ur:fr);return[s,l]},ls=()=>{let e=[],t=M(),o=t.get("walletId"),s=t.get("baseChain");return((0,it.useSelector)(Ut).find(d=>(d.walletIdentities||[]).some(p=>p.walletId===o))?.walletIdentities||[]).forEach(d=>{let f=d?.account?.[s];f&&e.push(f)}),e},is=()=>{let e=M(),t=e.get("type"),o=e.get("baseChain"),s=Jt()?.length,[l,m]=(0,mt.useState)([]);return[l,d=>{m(f=>t===$.addChain?[d]:f.some(p=>Oe(p.address,d.address,{localType:o}))?f.filter(p=>!Oe(p.address,d.address,{localType:o})):s+f.length>=1e3?(v.error({title:i("wallet_extension_hardware_wallet_notif_max_account",{num:1e3})}),f):[...f,d])}]},ms=e=>{let[t,o]=(0,mt.useState)(!1),{hardware:s}=(0,wt.useParams)(),l=M(),m=l.get("type"),c=l.get("baseChain"),d=l.get("walletId"),f=(0,wt.useHistory)(),p=(0,it.useDispatch)(),h=(0,it.useSelector)(Kt),y=(0,it.useSelector)(Ft),x=(0,mt.useMemo)(()=>e.map(B=>{let N={};return N.path=B.path,N.address=B.address,c===Qe&&dt.forEach(O=>{let{address:K,path:E,publicKey:D}=B[O];N[O]={address:K,path:E,publicKey:D}}),N}),[e,c]);return[t,async()=>{try{let B={accounts:x,hardware:s,baseChain:c,walletId:d,type:m},N=xe[g.ledger],O=await gr()||{};if(O?.productName&&(N=`${ee[g.ledger]} ${O.productName}`),B.ledgerInfo={productName:N},!h){p(Xt(B)),f.push(`${Vt}?from=${to.HARDWARE}`);return}if(!y){v.error({title:i("wallet_extension_hardware_wallet_notif_please_unlock")});return}Ht({hardwarewallet_brand:s,device_name:N}),o(!0),await p(ro(B)),await Ze(p);let K=re;[$.addAccount,$.addChain].includes(m)&&(K=`${pr}?from=seedVerify`);let E=er()===Qo;if(m===$.addChain&&E){p(ut()),f.go(-2);return}if(m===$.addAccount&&E){p(ut()),f.go(-2);return}E?f.replace(K):globalThis.platform.openExtensionInPopup(K),o(!1)}catch(B){o(!1),B.message===Pt&&v.error(i("extension_wallet_addwallet_toast_wallets_added",{amount:1e3})),B.message===Wt&&v.error(i("wallet_home_toast_network_error"))}},p]};n();a();var co={wrap:"_wrap_jx54d_1",root:"_root_jx54d_6",footerWrap:"_footerWrap_jx54d_10",accountList:"_accountList_jx54d_15",account:"_account_jx54d_15",accountLeft:"_accountLeft_jx54d_28",address:"_address_jx54d_31",path:"_path_jx54d_38",assets:"_assets_jx54d_44",accountRight:"_accountRight_jx54d_49"};var dn=()=>{let{hardware:e}=(0,Ct.useParams)(),t=M(),o=t.get("hideBack"),s=t.get("baseChain"),l=ls(),[m,c]=as(),[d,f]=is(),p=Nr({baseChain:s})||[],{coinId:h}=p?.[0]||{},y=(0,Ct.useHistory)(),[x,C]=(0,Z.useState)([]),B=async Ee=>{if(!e)return[];try{return await kr({hardware:e,page:Ee,basePath:m,baseChain:s,coinId:h})}catch($e){switch($e.name){case"LockedDeviceError":Zt.openModal(Qt.lockedDevice,{baseChain:s,onButtonClick:()=>{window.location.reload()},onCloseBtnClick:()=>{y.goBack()}});break;case"InvalidStateError":case"TransportStatusError":Zt.openModal(Qt.wrongAppToGetAddress,{baseChain:s,onButtonClick:()=>{window.location.reload()},onCloseBtnClick:()=>{y.goBack()}});break;case"TransportError":break;default:Zt.openModal(Qt.connectError,{onButtonClick:async()=>{if($e.name==="TransportOpenUserCancelled"&&(await yt.requestLedgerDevice()).length){K();return}window.location.reload()},onCloseBtnClick:()=>{y.goBack()}});break}throw $e}},[N,O]=(0,Z.useState)(!0),K=async()=>{O(!0);let Ee=await B(0);C(Ee),O(!1)};(0,Z.useEffect)(()=>{h&&K()},[m,h]);let[E,D]=ms(d);return Z.default.createElement(r.Box,{className:co.wrap},N?Z.default.createElement(Ce,null):Z.default.createElement(r.FlexBox,{className:co.root,align:r.ALIGN.unset,direction:r.DIRECTION.vertical},Z.default.createElement(X,{closeable:!1,backable:!o,title:i("wallet_extension_top_maintitle_select_address")}),Z.default.createElement(ns,{basePath:m,setBasePath:c,firstPageAccounts:x,selected:d,selectedAddressesInTargetIdentity:l,baseChain:s,onSelect:f,coinId:h,fetchAddress:B}),Z.default.createElement(r.Box,{className:co.footerWrap},Z.default.createElement(I,{category:I.CATEGORY.fill,type:I.TYPE.highlight,size:I.SIZE.lg,className:"wallet-management__button",disabled:!d.length,loading:E,onClick:D},d.length?i("wallet_extension_footer_btn_connecting",{value:d.length}):i("wallet_extension_footer_btn_connect")))))},cs=e=>{let t=(0,Ct.useHistory)(),s=M().get("baseChain");return Object.keys(Ho).includes(s)?Z.default.createElement(dn,{...e}):(v.error(i("wallet_extension_top_error_parameters")),t.replace(re),null)};n();a();var ne=_(T());k();n();a();var ct=_(T()),_s=_(ge());k();n();a();var He={disabledButton:"_disabledButton_9hbfa_1",disabledButtonEvm:"_disabledButtonEvm_9hbfa_9",imported:"_imported_9hbfa_18",logo:"_logo_9hbfa_27",circle:"_circle_9hbfa_30"};function _o({children:e,image:t,chainName:o,selected:s,handleClick:l,imported:m}){let c=(0,_s.default)({[He.imported]:m},{"chains-choose-network-modal__chains-list-card":!0},{"chains-choose-network-modal__chains-list-card__selected":s});return ct.default.createElement("div",{className:c,onClick:l},e||ct.default.createElement("div",{className:"chains-choose-network-modal__chains-list-card__custom-wrap"},ct.default.createElement(At,{alt:"image",className:"chains-choose-network-modal__chains-list-card__chain-icon",src:t||Re}),ct.default.createElement("span",{className:"chains-choose-network-modal__chains-list-card__chain-name"},o),m&&ct.default.createElement(I,{type:"grey",size:"small",disabled:!0,className:He.disabledButton},i("extension_wallet_import_active_wallet"))))}n();a();var G=_(T());k();var pn=({chainsList:e=[],description:t=""})=>{let o=(0,G.useMemo)(()=>e.length?e.slice(0,5):[],[e]);return G.default.createElement("div",{className:"choose-network-list-card__logos-wrap"},G.default.createElement(Le,{title:t,maxWidth:260,placement:Le.DIRECTION.bottomLeft},o.map((s,l)=>G.default.createElement("img",{className:He.logo,alt:"",key:l,style:{zIndex:l},src:s.image||Re})),G.default.createElement(J,{className:"okx-wallet-plugin-more choose-network-list-card__more",style:{zIndex:o.length}})))};function Go({chainsList:e,imported:t,titleKey:o="wallet_extension_select_network_title_evm_network",remindKey:s="wallet_extension_select_network_toast_desc",descriptionKey:l,networkCountKey:m,hideRightIcon:c=!1}){let d=(0,G.useMemo)(()=>i(l,{network:e.map(p=>p.chainName).join(i("extension_wallet_text_punctuation_mark"))}),[e,l,i]),f;return m?typeof m=="function"?f=m(e):f=i(m,{number:e.length}):f=i("wallet_extension_select_network_text_support_network",{number:e.length}),G.default.createElement("div",{className:"choose-network-list-card__EVM-wrap"},G.default.createElement("div",{className:"choose-network-list-card__title"},G.default.createElement("span",null," ",i(o)),c?null:G.default.createElement(Le,{title:i(s),maxWidth:224,placement:Le.DIRECTION.bottom},G.default.createElement(J,{className:`okx-wallet-plugin-information-circle ${He.circle}`}))),G.default.createElement("p",{className:"choose-network-list-card__explain"},f),G.default.createElement("p",{className:"choose-network-list-card__logos-wrap"},G.default.createElement(pn,{chainsList:e,description:d})),t&&G.default.createElement(I,{type:"grey",size:"small",disabled:!0,className:He.disabledButtonEvm},i("extension_wallet_import_active_wallet")))}To();n();a();var Tt=_(T()),po=_(ie()),zo=_(se()),qo=_(ko());k();n();a();k();To();var un={[be]:{titleKey:"wallet_extension_select_network_title_evm_network",remindKey:"wallet_extension_select_network_toast_desc",networkCountKey:e=>i("wallet_extension_select_network_text_support_network",{number:e.length}),importPrivateKeyConfig:{supportNetworksKey:"wallet_extension_select_network_toast_desc2"},importLedgerConfig:{supportNetworksKey:"wallet_extension_hardware_tooltip_support_range"}},[rr]:{titleKey:"wallet_extension_aptos_tab_title_compatible_network",remindKey:"wallet_extension_aptos_tooltip_desc_compatible_network",networkCountKey:e=>i("wallet_extension_aptos_tab_desc_compatible_network",{num:e.length}),importPrivateKeyConfig:{supportNetworksKey:"wallet_extension_transaction_aptos_title_available_network"},importLedgerConfig:{supportNetworksKey:"wallet_extension_hardware_tooltip_support_range"}},[Dt]:{titleKey:"wallet_extension_solana_tab_title_network",remindKey:"wallet_extension_solana_tooltip_svm_network_address",networkCountKey:e=>i("wallet_extension_solana_tab_desc_network",{number:e.length}),importPrivateKeyConfig:{supportNetworksKey:"wallet_extension_solana_tooltip_support_networks"},importLedgerConfig:{supportNetworksKey:"wallet_extension_hardware_tooltip_support_range"}},[or]:{titleKey:"wallet_extension_btc_tab_title_network",remindKey:"wallet_extension_btc_tooltip_svm_network_address",networkCountKey:e=>i("wallet_extension_btc_tab_desc_network",{number:e.length}),importPrivateKeyConfig:{supportNetworksKey:"wallet_extension_btc_tooltip_support_networks"},importLedgerConfig:{supportNetworksKey:"wallet_extension_hardware_tooltip_support_range"}},[sr]:{titleKey:"wallet_extension_select_network_tab_cosmos",remindKey:"wallet_extension_select_network_toast_desc_cosmos",networkCountKey:e=>i("wallet_extension_select_network_text_support_cosmos",{num:e.length}),importPrivateKeyConfig:{supportNetworksKey:"wallet_extension_select_network_toast_cosmos_support"},importLedgerConfig:{supportNetworksKey:"wallet_extension_hardware_tooltip_support_range"}}},ds=Mr.map(e=>{let t=un[e];return t?{chain:e,...t}:null}).filter(Boolean);Ae();var ps=(e=!1)=>{let t=M(),o=(0,zo.useHistory)(),s=t.get("type"),l=t.get("walletId"),m=(0,po.useSelector)(ir),c=[];if(s==="addChain")if(m[l]){let{account:d}=m[l];c=Object.keys(d)}else e&&(v.error(i("wallet_extension_top_error_parameters")),o.replace(re));return c},us=()=>{let e=ps(!0),t=(0,po.useSelector)(pt);return(0,Tt.useMemo)(()=>ds.map(({chain:o,...s})=>({chain:o,config:s,allChains:t.filter(l=>l.baseChain===o),imported:e.includes(o)})),[e,t])},fs=()=>{let e=ps(),t=(0,po.useSelector)(pt);return(0,Tt.useMemo)(()=>[Qe,vt].map(s=>{let l=t.find(m=>m.baseChain===s);return{imported:e.includes(s),...l}}),[e,t])},ys=e=>{let t=(0,zo.useHistory)(),o=M(),s=o.get("type"),l=o.get("walletId");return(0,Tt.useCallback)(async()=>{let m=await yt.hasConnectedLedger(),c=!1;if(m||(c=(await yt.requestLedgerDevice()).length===0),c){[$.addAccount,$.addChain].includes(s)&&t.goBack();return}let d=`${pe}/${g.ledger}?${qo.default.stringify({baseChain:e})}`;s&&l&&(d+=`&${qo.default.stringify({type:s,walletId:l})}`),t.push(d)},[t,s,l,e])};n();a();var It={root:"_root_f8vjo_1",chainList:"_chainList_f8vjo_6",footerWrap:"_footerWrap_f8vjo_10"};var fn=[be,Dt],yn=()=>{let e=M(),t=e.get("type"),o=e.get("hideBack"),[s,l]=(0,ne.useState)(""),m=us(),c=fs(),d=ys(s),f=m?.filter(({chain:p})=>fn.includes(p))||[];return ne.default.createElement(r.FlexBox,{className:It.root,align:r.ALIGN.unset,direction:r.DIRECTION.vertical},ne.default.createElement(X,{closeable:!1,backable:!o,className:It.navigator,title:i("wallet_extension_top_maintitle_select_network")}),ne.default.createElement(r.Box,{className:It.chainList},f.map(({chain:p,config:h,allChains:y,imported:x})=>{let{titleKey:C,networkCountKey:B,importLedgerConfig:{supportNetworksKey:N}}=h;return ne.default.createElement(_o,{imported:x,selected:p===s,handleClick:()=>{x||l(p)}},ne.default.createElement(Go,{titleKey:C,networkCountKey:B,descriptionKey:N,chainsList:y,imported:x,hideRightIcon:!0}))}),c.map(p=>ne.default.createElement(_o,{imported:p.imported,key:p.chainName,selected:p.baseChain===s,handleClick:()=>{p.imported||l(p.baseChain)},...p}))),ne.default.createElement(r.Box,{className:It.footerWrap},ne.default.createElement(I,{category:I.CATEGORY.fill,type:I.TYPE.highlight,size:I.SIZE.lg,onClick:d,className:"wallet-management__button",disabled:!s},t==="addChain"?i("wallet_extension_footer_btn_add_network"):i("wallet_addwallet_btn_conncet_hardware_wallet"))))},hs=yn;n();a();var ye=_(T()),ws=_(ie()),ho=_(Je()),Cs=_(ko());k();n();a();var uo=(e,t)=>`${e}${t}`,gs=(e,t)=>!!(e?.connectId&&e.connectId===t.connectId&&e.firstEvmAddress===t.firstEvmAddress);n();a();var $o=_(ge());k();var fe=_(T());n();a();var Ge={root:"_root_r4apb_1",recommend:"_recommend_r4apb_21",brandInfo:"_brandInfo_r4apb_24",icon:"_icon_r4apb_29",name:"_name_r4apb_34",arrow:"_arrow_r4apb_39"};var hn=e=>{let{icon:t,wallet:o,onClick:s}=e,l=(0,fe.useCallback)(()=>{s(o)},[o,s]);return fe.default.createElement(r.Box,{onClick:l,className:Ge.root},fe.default.createElement(r.Box,{className:Ge.brandInfo},fe.default.createElement(ve,{className:(0,$o.default)(t,Ge.icon)}),fe.default.createElement(r.Box,{className:Ge.name},o.name),o.recommend?fe.default.createElement(Ne,{className:Ge.recommend,type:Ne.TYPE.rect,color:Ne.COLOR.green},i("wallet_onekey_tag_new")):null),fe.default.createElement(ve,{size:ve.SIZE.xs,className:(0,$o.default)("okx-wallet-plugin-right",Ge.arrow)}))},fo=hn;n();a();var yo={root:"_root_pxrbs_1",navigator:"_navigator_pxrbs_4",list:"_list_pxrbs_7"};var xs=new eo,gn=({history:e})=>{let[t,o]=(0,ye.useState)([]),s=(0,ye.useRef)(),l=async()=>{try{let p=await xs.searchDevices();p.length?(o(p),s.current=null):s.current=setTimeout(()=>{l()},3e3)}catch{e.goBack()}};(0,ho.useMount)(l),(0,ho.useUnmount)(()=>{s.current&&clearTimeout(s.current)});let m=tt(),c=(p,h)=>m.some(y=>{if(Gt(y.initialType)){let{onekeyInfo:x}=y;return gs(x,{connectId:p,firstEvmAddress:h})}return!1}),d=(0,ws.useDispatch)(),f=async({connectId:p,deviceId:h,deviceType:y})=>{try{let x=await xs.getFirstEvmAddress({dispatch:d,connectId:p,deviceId:h,deviceType:y});if(c(p,x)){v.error({title:i("wallet_extension_hardware_wallet_notif_hardware_already")});return}e.push(`${pe}/${g.onekey}?${Cs.default.stringify({firstEvmAddress:x,connectId:p})}`)}catch(x){console.log(x)}};return ye.default.createElement(r.Container,{className:yo.root,loading:t.length?!1:{loadingText:i("wallet_onekey_text_searching_for_equipment")}},ye.default.createElement(X,{stickyStyle:{zIndex:3},className:yo.navigator,closeable:!1,bordered:!1,title:i("wallet_onekey_title_connect_device")}),ye.default.createElement(r.Box,{className:yo.list},t.map(p=>ye.default.createElement(fo,{wallet:p,onClick:f,icon:"okx-wallet-plugin-equipment"}))))},Ts=gn;n();a();var q=_(T()),Bs=_(ie()),Es=_(se()),ks=_(Je());he();k();n();a();var go=_(T());var Is=e=>{let t=tt(),o=(0,go.useMemo)(()=>t?.find(m=>{if(Gt(m.initialType)){let{firstEvmAddress:c,connectId:d}=m?.onekeyInfo||{};return uo(d,c)===e}return!1})||{},[t,e]),s=(0,go.useMemo)(()=>o.walletIdentities||[],[o]),l=(0,go.useMemo)(()=>s.length?s[0].walletId:"",[s]);return{targetKeyringIdentity:o,targetWalletIdentities:s,targetWalletId:l}};n();a();var qe={wrap:"_wrap_19eua_1",root:"_root_19eua_6",list:"_list_19eua_10",desc:"_desc_19eua_16",loadMore:"_loadMore_19eua_22"};var xn=new eo,wn=()=>{let e=M(),t=e.get("connectId"),o=e.get("firstEvmAddress"),s=uo(t,o),{connectedOnekey:l}=(0,Bs.useSelector)(zt),m=l?.[s],c=(0,q.useRef)(),{data:d,noMore:f}=(0,ks.useInfiniteScroll)(async E=>{if(!m)return{list:[]};let D=E?.pageNo??0;return{list:await xn.getAccounts({page:D,onekeyInfo:m}),pageNo:D+1}},{target:c,isNoMore:E=>E?.list?.length>=1e3}),p=d?.list||m?.accountsWithBalance||[],[h,y]=(0,q.useState)([]),{targetWalletIdentities:x,targetWalletId:C}=Is(s),B=rt(h,x),[N,O]=st({walletInfo:{onekeyInfo:Nt(m,["connectId","deviceId","deviceType","firstEvmAddress"])},selected:h,walletId:C,hardware:g.onekey}),K=(0,Es.useHistory)();return(0,q.useEffect)(()=>{m||(v.error(i("wallet_extension_top_error_parameters")),K.replace(re))},[m,K,s]),q.default.createElement(r.Box,{className:qe.wrap},q.default.createElement(r.FlexBox,{direction:r.DIRECTION.vertical,className:qe.root},q.default.createElement(X,{bordered:!1,closeable:!1,className:qe.navigator,title:i("wallet_extension_onekey_title_import_account")}),q.default.createElement(r.Box,{ref:c,className:qe.list},q.default.createElement(r.Box,{className:qe.desc},i("extension_wallet_hardware_wallet_text_multi_net")),p?.map(E=>{let D=B(E);return q.default.createElement(ot,{account:E,selectType:D,setSelected:y})}),f?null:q.default.createElement(r.Box,{className:qe.loadMore},q.default.createElement(Ve,null))),q.default.createElement(nt,{selected:h,isSubmiting:N,handleSubmit:O})),q.default.createElement(Ce,{visible:!p?.length}))},Ns=wn;n();a();var Bt=_(T());k();Jo();n();a();n();a();var xo=_(T()),Ls=_(ie()),Ss=_(se()),As=_(ko());Ae();var bs=()=>{let e=(0,Ss.useHistory)(),{isLedgerImported:t}=(0,Ls.useSelector)(zt),o=(0,xo.useMemo)(()=>({[g.ledger](){t?e.push(et):e.push(jt)},[g.trezor](){e.push(`${pe}/${g.trezor}?${As.default.stringify({baseChain:R})}`)},[g.onekey](){e.push(Yt)},[g.keystone](){e.push(`${pe}/${g.keystone}`)}}),[t,e]);return(0,xo.useCallback)(({brand:l})=>{_r({hardwarewallet_brand:l}),dr(),o[l]()},[o])};n();a();var wo={root:"_root_gtfj8_1",navigator:"_navigator_gtfj8_4",wrap:"_wrap_gtfj8_7"};var Ms=Ro()===Zo,Cn=[{name:ee[g.keystone],icon:"okx-wallet-plugin-keystone",brand:g.keystone,recommend:!0},xr()?{name:ee[g.ledger],icon:"okx-wallet-plugin-ledger",brand:g.ledger,recommend:!1}:null,Ms?null:{name:ee[g.onekey],icon:"okx-wallet-plugin-onekey",brand:g.onekey,recommend:!1},Ms?null:{name:ee[g.trezor],icon:"okx-wallet-plugin-trezor",brand:g.trezor,recommend:!1}].filter(Boolean),Tn=()=>{let e=bs();return Bt.default.createElement(r.Container,{className:wo.root},Bt.default.createElement(X,{closeable:!1,backable:!1,bordered:!1,className:wo.navigator,title:i("wallet_addwallet_maintitle_connect_hareware_wallet")}),Bt.default.createElement(r.Box,{className:wo.wrap},Cn.map(t=>Bt.default.createElement(fo,{wallet:t,icon:t.icon,onClick:e}))))},Os=Tn;n();a();k();var vs=_(Je());var Ds=_(se()),z=_(T());n();a();var ze={wrap:"_wrap_174i9_1",root:"_root_174i9_6",list:"_list_174i9_10",desc:"_desc_174i9_16",loadMore:"_loadMore_174i9_22"};var In=new Er,Bn=()=>{let t=M().get("walletId"),[o,s]=(0,z.useState)(!1),l=async E=>{let D=E?.nextPage||0;return{list:await In.getAccounts({page:D}),nextPage:D+1}},m=(0,z.useRef)(),{data:c,loading:d,noMore:f}=(0,vs.useInfiniteScroll)(l,{target:m,isNoMore:E=>E?.list?.length>=1e3,onError:()=>{s(!0)}}),p=tt(),[h,y]=(0,z.useState)([]),x=p?.find(({walletIdentities:E})=>E.some(D=>D.walletId===t)),{walletIdentities:C=[]}=x||{},B=rt(h,C),[N,O]=st({selected:h,walletId:t,hardware:g.trezor}),K=(0,Ds.useHistory)();return z.default.createElement(r.Box,{className:ze.wrap},z.default.createElement(r.FlexBox,{direction:r.DIRECTION.vertical,className:ze.root},z.default.createElement(X,{bordered:!1,closeable:!1,className:ze.navigator,title:i("wallet_extension_onekey_title_import_account")}),z.default.createElement(r.Box,{ref:m,className:ze.list},z.default.createElement(r.Box,{className:ze.desc},i("extensions_hardware_support_text_evm_only",{brand:ee[g.trezor]})),c?.list?.map(E=>{let D=B(E);return z.default.createElement(ot,{account:E,selectType:D,setSelected:y})}),f?null:z.default.createElement(r.Box,{className:ze.loadMore},z.default.createElement(Ve,null))),z.default.createElement(nt,{selected:h,isSubmiting:N,handleSubmit:O})),z.default.createElement(Xe.Prompt,{btnFull:!0,visible:o,infoType:!1,alignBottom:!1,hideCloseBtn:!!t,title:i("wallet_add_wallet_maintitle_hardware_wallet_conncet_failed"),text:i("wallet_add_wallet_modal_hardware_wallet_conncet_failed_tip"),onConfirm:()=>{window.location.reload()},confirmBtnProps:{type:I.TYPE.highlight,size:I.SIZE.lg},confirmText:i("wallet_manage_wallet_btn_reconncet_hardware_wallet"),onClose:()=>{K.goBack()}}),z.default.createElement(Ce,{visible:d||o}))},Ws=Bn;var En={[g.keystone]:qr,[g.ledger]:cs,[g.onekey]:Ns,[g.trezor]:Ws},kn=()=>de.default.createElement(ae.Switch,null,de.default.createElement(ae.Route,{path:$t,component:Os,exact:!0}),de.default.createElement(ae.Route,{path:jt,component:Yr,exact:!0}),de.default.createElement(ae.Route,{path:et,component:hs,exact:!0}),de.default.createElement(ae.Route,{path:Yt,component:Ts,exact:!0}),de.default.createElement(ae.Route,{path:`${pe}/:hardware`,render:e=>{let t=e?.match?.params?.hardware,o=En[t];return o?de.default.createElement(o,null):de.default.createElement(ae.Redirect,{to:$t})},exact:!0}),de.default.createElement(ae.Redirect,{to:$t})),Zf=kn;export{Zf as default};
//# sourceMappingURL=ConnectHardware-2G7NT3IT.js.map
