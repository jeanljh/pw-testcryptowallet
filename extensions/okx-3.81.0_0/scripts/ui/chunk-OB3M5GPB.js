import{a as Xe,b as je,c as Je}from"./chunk-AQ4KTATJ.js";import{a as Qe,d as le}from"./chunk-ROS2ENQV.js";import{e as Ze}from"./chunk-SYOIP55B.js";import{a as W}from"./chunk-EBRJSEEJ.js";import{a as D}from"./chunk-JNIP4OYT.js";import{l as We,u as H}from"./chunk-FGAB46RQ.js";import{o as Y}from"./chunk-Z62JX42S.js";import{o as He,p as Bt}from"./chunk-YIFLUVTR.js";import{c as d}from"./chunk-HMTT52FG.js";import{b as Me,c as kt}from"./chunk-GR7YC6C3.js";import{A as Ke,J as yt}from"./chunk-O33H5V3V.js";import{b as Oe,n as Ct}from"./chunk-35ANKHOJ.js";import{Db as ze,Na as ee,Sb as Et,bb as qe,tb as Ce,ub as Fe,vb as Ye,wb as Ue}from"./chunk-COF7YKSN.js";import{A as o,K as F}from"./chunk-VZKEX7KP.js";import{A as Ve,H as R,o as $,q as V,y as Ne}from"./chunk-BJKBO23H.js";import{f as Ge,h as Nt}from"./chunk-K336SGW3.js";import{f as xe,fa as Le,pa as De,va as we}from"./chunk-XFTQD4B2.js";import{a as ae}from"./chunk-GVV6OTQP.js";import{t as ie,u as ke,z as T}from"./chunk-ZFVABNQN.js";import{a as he}from"./chunk-4QGZDIBD.js";import{b as G}from"./chunk-73B6GL3S.js";import{f as g,o as n,q as i}from"./chunk-Y5OH3DDZ.js";n();i();var z=g(G());n();i();var k=g(G()),st=g(Y());we();n();i();var Z={EDIT:"edit",ADD:"add"};n();i();var $e=g(Y());Ce();var Re=e=>{let[t]=W({chain:e});return t?.factionType!==ee?t?.baseChain:e},te=()=>(0,$e.useMemoizedFn)(e=>e?.factionType!==ee?e?.baseChain:e?.chain);n();i();var U=g(G());F();n();i();var de=g(G()),tt=g(Y());we();Ct();Nt();Ce();kt();yt();var et={[Ge.WAX]:async e=>{if(!e)return!1;let t={account:e,coinId:qe},r;try{r=await Ke(Me.queryAccountExist,t)}catch{xe()}return!!r?.data?.account},default:async(e,t,r)=>{let{validAddress:s}=await Oe(),{isValid:a}=await s(t.valueOf(),{address:e,hrp:r});return a}};function vt(){let[e,t]=(0,de.useState)(0),r=(0,de.useRef)(0),s=W(),a=e>0,_=(0,tt.useDebounce)(a,{wait:200});return{isLoading:a,isBetterLoading:_,validAddress:(m,C)=>{(async()=>{let p=++r.current,y=[];t(f=>f+1);try{await Promise.all(s.map(async({coinType:f,cosmosPrefix:E})=>{try{await(et[f]||et.default)(m,f,E)&&y.push(Number(f))}catch{xe()}}))}finally{p===r.current&&(t(0),C(y))}})()}}}var ot=vt;Et();var ye={[Fe]:{groupName:o("wallet_extension_function_title_all_chain",{chain:o("wallet_extension_function_eco_evm")}),groupTitle:o("wallet_extension_function_title_compatible_networks",{chain:o("wallet_extension_function_eco_evm")}),chainKey:"wallet_extension_function_eco_evm"},[Ye]:{groupName:o("wallet_extension_function_title_all_chain",{chain:o("wallet_extension_function_eco_bitcoin")}),groupTitle:o("wallet_extension_function_title_compatible_networks",{chain:o("wallet_extension_function_eco_bitcoin")}),chainKey:"wallet_extension_function_eco_bitcoin"},[Ue]:{groupName:o("wallet_extension_function_title_all_chain",{chain:o("wallet_extension_function_eco_svm")}),groupTitle:o("wallet_extension_function_title_compatible_networks",{chain:o("wallet_extension_function_eco_svm")}),chainKey:"wallet_extension_function_eco_svm"},[ze]:{groupName:o("wallet_extension_function_title_all_chain",{chain:o("wallet_extension_function_eco_aptos")}),groupTitle:o("wallet_extension_function_title_compatible_networks",{chain:o("wallet_extension_function_eco_aptos")}),chainKey:"wallet_extension_function_eco_aptos"}};function At(e){let[t,r]=(0,U.useState)(null),{isLoading:s,isBetterLoading:a,validAddress:_}=ot();(0,U.useEffect)(()=>{if(!e){r(null);return}_(e,c=>{r(c)})},[e]);let l=W(),m=(0,U.useMemo)(()=>l.filter(({coinType:c})=>t?.includes(c)),[t]),C=(0,U.useMemo)(()=>{if(!t)return null;let[c,p]=Qe.reduce(([y,f],E)=>{let A=f.filter(B=>B.baseChain===E);return A.length&&y.push({baseChain:E,type:"group",networks:A,groupInfo:ye[E]}),f=f.filter(B=>B.baseChain!==E),[y,f]},[[],[...m]]);return[...c,...p]},[m,t]);return{isLoading:s,isBetterLoading:a,validNetworks:C}}var rt=At;n();i();var nt=(0,k.createContext)(null),v=()=>{let e=(0,k.useContext)(nt);if(!e)throw new Error("useAddressEditContext must be used within an AddressEditProvider");return e},Tt=({type:e,data:t,onClose:r,onDelete:s,onChangeToEdit:a,children:_})=>{let l=e===Z.EDIT,[m,C]=(0,k.useState)("address"),[c,p]=(0,k.useState)("address"),[y,f]=(0,k.useState)({}),[E,A]=(0,k.useState)({}),[B,h]=(0,k.useState)(""),[S,O]=(0,k.useState)(""),[K,L]=(0,k.useState)(""),[se,ce]=(0,k.useState)(""),[ne,Q]=(0,k.useState)([]),{id:b,address:q,network:fe}=t||{},ge=Re(fe),Ie=le(q);(0,st.useMount)(()=>{if(l&&Ie){let{name:xt,networks:wt}=Ie,ht=De([...wt,ge].filter(Boolean));h(xt),L(q||""),Q(ht)}else Q(ge?[ge]:[]),L(q||""),h("")});let{isLoading:Se,isBetterLoading:be,validNetworks:Pe}=rt(K),gt=(0,k.useMemo)(()=>({id:b,isEdit:l,step:m,setStep:C,prevStep:c,setPrevStep:p,dialogProps:y,setDialogProps:f,groupChain:E,setGroupChain:A,type:e,data:t,selectedNetworks:ne,setSelectedNetworks:Q,isLoading:Se,isBetterLoading:be,validNetworks:Pe,onChangeToEdit:a,onClose:r,onDelete:s,nameInputValue:B,nameInputError:S,setNameInputValue:h,setNameInputError:O,addressInputValue:K,addressInputError:se,setAddressInputValue:L,setAddressInputError:ce}),[se,K,t,y,E,b,be,l,Se,S,B,a,r,s,ne,m,c,e,Pe]);return k.default.createElement(nt.Provider,{value:gt},_)},it=Tt;n();i();var I=g(G()),pe=g(Y());we();F();Bt();n();i();var M=g(G()),at=g(Y());F();n();i();var ue={root:"_root_7l4sg_1",error:"_error_7l4sg_1",action:"_action_7l4sg_9"};var It=()=>{let e=v(),{data:t,isEdit:r,isLoading:s,validNetworks:a,onChangeToEdit:_,isBetterLoading:l,addressInputValue:m,addressInputError:C,setSelectedNetworks:c,setAddressInputValue:p,setAddressInputError:y}=e,{id:f,address:E}=t||{},A=le(m),B=!!A?.id&&(!r||A?.id!==f),h=(0,M.useRef)(!1),S=C&&h.current?C:"",{run:O}=(0,at.useDebounceFn)(async()=>{let L="";m&&a&&!a.length&&(L=o("wallet_extension_addaddress_errortip_wrong_address")),B&&(L=o("wallet_extension_addaddress_errortip_address_exists")),h.current=!0,y(L)},{wait:50}),K=L=>{p(L.target.value),c([])};return(0,M.useEffect)(()=>{O()},[a]),M.default.createElement(d.Box,{className:ue.root},M.default.createElement(V.TextArea,{autoResize:!0,size:V.SIZE.xl,onChange:K,value:m,error:!s&&!!S,errorType:V.TIP_TYPE.always,disabled:!!(!r&&E),"data-testid":D.ADDRESS_BOOK.ADDRESS_INPUT,label:o("wallet_extension_addaddress_subtitle_address"),placeholder:o("wallet_extension_addaddress_input_enter_address"),suffix:l&&M.default.createElement(ke.Circle,{size:ke.SIZE.sm})}),S&&M.default.createElement("div",{className:ue.error},S,B&&M.default.createElement("span",{className:ue.action,onClick:()=>{_(A)}},o("wallet_extension_addaddress_anchor_go_to_edit"))))},lt=It;n();i();var N=g(G()),Ee=g(he());F();Ce();n();i();var X=g(G()),dt=g(he());F();n();i();var oe={root:"_root_8gl1e_1",imageUrl:"_imageUrl_8gl1e_5",more:"_more_8gl1e_14"};var St=({networks:e,maxCount:t})=>{let{setGroupChain:r,setStep:s,step:a,setPrevStep:_}=v();return e.length<=t?null:X.default.createElement(Ve,{noWrapper:!0,title:o("wallet_extension_function_bttmsheet_textbtn_show_all")},X.default.createElement(ie,{onClick:l=>{l.stopPropagation(),_(a),r({networks:e}),s("chainList")},className:(0,dt.default)("okx-wallet-plugin-more",oe.imageUrl,oe.more)}))},bt=({networks:e,maxCount:t=5})=>{let r=e.slice(0,t).map(({imageUrl:s})=>s);return X.default.createElement("div",{className:oe.root},r.map(s=>X.default.createElement("img",{alt:"",key:s,src:s,className:oe.imageUrl})),X.default.createElement(St,{networks:e,maxCount:t}))},_e=bt;n();i();var P={root:"_root_10afq_1",title:"_title_10afq_6",line:"_line_10afq_12",canClick:"_canClick_10afq_20",placeholder:"_placeholder_10afq_23",mainContent:"_mainContent_10afq_28",img:"_img_10afq_32",chainName:"_chainName_10afq_37",arrow:"_arrow_10afq_43",extText:"_extText_10afq_46"};var Pt=({selectedNetworks:e})=>{if(e.length===1){let{imageUrl:t,chainName:r}=e[0]||{};return N.default.createElement(d.Box,{className:P.mainContent},N.default.createElement("img",{className:P.img,src:t,alt:""}),N.default.createElement(d.Box,{className:P.chainName},r))}return N.default.createElement(d.Box,{className:P.mainContent},N.default.createElement(_e,{networks:e}))},Lt=({selectedNetworks:e,flattenSelectedNetworks:t})=>{if(e.length===0||t.length===1)return null;let r="",s=ye[e[0]];return e.length===1&&s?r=s.groupName:t.length===2?r=o("wallet_extension_function_title_network1_and_network2",{network1:t[0]?.chainName,network2:t[1]?.chainName}):r=o("wallet_extension_function_title_network_and_other_networks",{network:t[0]?.chainName}),N.default.createElement(H.Text,{className:P.extText},r)};function Be(){let{validNetworks:e,selectedNetworks:t,setSelectedNetworks:r,setStep:s}=v(),a=te(),_=(0,N.useMemo)(()=>t.reduce((m,C)=>{let c=e.filter(p=>a(p)===C).map(p=>p.type==="group"?p.networks:p).flat();return[...m,...c]},[]),[t,e,a]);(0,N.useEffect)(()=>{if(t?.length===0&&e?.length===1){let m=e[0];m.factionType===ee?r([m.chain]):r([m.baseChain])}},[e,r,t]);let l=e.length>1;return N.default.createElement(d.Box,{className:P.root},N.default.createElement(d.Box,{className:P.title},o("wallet_extension_addressbook_title_select_networks")),N.default.createElement(d.Box,{className:(0,Ee.default)(P.line,{[P.canClick]:l}),"data-testid":D.ADDRESS_BOOK.NETWORK_INPUT,onClick:()=>{l&&s("network")}},_.length>0?N.default.createElement(Pt,{selectedNetworks:_}):N.default.createElement(d.Box,{className:P.placeholder},o("commonall_title_placeholder_select_network")),l&&N.default.createElement(ie,{className:(0,Ee.default)("okds-arrow-chevron-right-centered-md",P.arrow)})),N.default.createElement(Lt,{selectedNetworks:t,flattenSelectedNetworks:_}))}n();i();var re={root:"_root_1mc1y_1",main:"_main_1mc1y_6",footerAction:"_footerAction_1mc1y_13",deleteButton:"_deleteButton_1mc1y_18"};var Dt=()=>{let e=v(),{onClose:t,onDelete:r,nameInputValue:s,nameInputError:a,setNameInputValue:_,setNameInputError:l,validNetworks:m,type:C,id:c,isEdit:p,selectedNetworks:y,addressInputValue:f,addressInputError:E,setDialogProps:A}=e,B=(0,I.useRef)(null),[h,S]=(0,I.useState)(!1),{run:O}=(0,pe.useDebounceFn)(()=>{S(!0),Le(s)>20?l(o("wallet_extension_addaddress_errortip_maximum_20")):l("")},{wait:50}),K=b=>{_(b.target.value),O()},L=f||s||y.length,se=()=>{if(!p&&L){let b=$.warn({maskClassName:"edit-address-confirm-dialog",title:o("wallet_extension_addaddress_modal_cancel_adding"),alignBottom:!1,cancelText:o("wallet_extension_addaddress_btn_no"),confirmText:o("wallet_extension_addaddress_btn_yes"),onCancel:()=>{b.destroy()},onConfirm:async()=>{t()}})}else t()},ce=s===""||a!==""||f===""||E!==""||!y.length,ne=async b=>{b.stopPropagation();let q={address:f,name:s,networks:y};if(p&&c)await je(c,q),R.success({title:o("wallet_extension_editaddress_toast_edit_saved")}),t(q);else try{await Xe(q),R.success({title:o("wallet_extension_addressbook_toast_address_added")}),t(q)}catch(fe){fe?.message===He&&R.error({title:o("wallet_extension_addressbook_toast_address_limit_reached")})}},Q=()=>{let b=$.warn({title:o("wallet_extension_editaddress_modal_detele_address"),alignBottom:!1,cancelText:o("wallet_extension_editaddress_btn_cancel"),confirmText:o("wallet_extension_editaddress_btn_detele"),onCancel:()=>{b.destroy()},onConfirm:async()=>{await Je(c),R.success({title:o("wallet_extension_addressbook_toast_address_deleted")}),r&&r(),t()}})};return(0,pe.useMount)(()=>{A({title:o(p?"wallet_extension_editaddress_title_edit_address":"wallet_extension_addaddress_title_add_address"),onClose:se,showBackBtn:!1,hideCloseBtn:!1}),B.current?.focus()}),I.default.createElement(d.Box,{className:re.root},I.default.createElement(d.Box,{className:re.main},I.default.createElement(V,{"data-testid":D.ADDRESS_BOOK.NAME_INPUT,placeholder:o("wallet_extension_addaddress_input_enter_name_limit"),label:o("wallet_extension_addaddress_subtitle_name"),value:s,error:h&&a,errorType:V.TIP_TYPE.always,size:V.SIZE.xl,onChange:K,maxLength:30,onRef:b=>{B.current=b}}),I.default.createElement(lt,null),!!m?.length&&!E&&I.default.createElement(Be,null)),I.default.createElement(d.Box,{className:re.footerAction},C===Z.EDIT&&I.default.createElement(T,{className:re.deleteButton,category:T.CATEGORY.fill,type:T.TYPE.gray,size:T.SIZE.lg,onClick:Q},o("commonall_resultpage_btn_delete")),I.default.createElement(T,{"data-testid":D.ADDRESS_BOOK.ADD_BUTTON,disabled:ce,category:T.CATEGORY.fill,type:T.TYPE.highlight,size:T.SIZE.lg,onClick:ne,block:!0},o("wallet_set_password_btn_confirm"))))},mt=Dt;n();i();var J=g(G()),ut=g(Y());F();n();i();var j={root:"_root_1qe4o_1",networkList:"_networkList_1qe4o_5",network:"_network_1qe4o_5",logo:"_logo_1qe4o_14",name:"_name_1qe4o_19"};var Gt=({scrollBoxHeight:e})=>{let{setDialogProps:t,setStep:r,groupChain:s,prevStep:a}=v();return(0,ut.useMount)(()=>{t({title:s?.groupInfo?.groupName||o("wallet_extension_function_bttmsheet_textbtn_show_all"),onBack(){r(a)},hideCloseBtn:!0,showBackBtn:!0})}),J.default.createElement(d.Box,{className:j.root},J.default.createElement(Ze,{virtualable:!0,height:e,className:j.networkList,dataSource:s.networks||[],renderItem:_=>J.default.createElement(d.Box,{className:j.network},J.default.createElement(ae,{src:_.imageUrl,className:j.logo}),J.default.createElement(H.Text,{className:j.name,ellipsis:{tooltip:!0}},_.chainName))}))},_t=Gt;n();i();var u=g(G()),pt=g(Y()),Ae=g(he());F();n();i();var x={root:"_root_cv1p1_1",main:"_main_cv1p1_6",search:"_search_cv1p1_14",networkList:"_networkList_cv1p1_21",groupNetwork:"_groupNetwork_cv1p1_28",active:"_active_cv1p1_34",groupTitle:"_groupTitle_cv1p1_37",chainsTip:"_chainsTip_cv1p1_44",matchedChainNames:"_matchedChainNames_cv1p1_50",extInfo:"_extInfo_cv1p1_53",seeAll:"_seeAll_cv1p1_57",text:"_text_cv1p1_63",icon:"_icon_cv1p1_67",singleNetwork:"_singleNetwork_cv1p1_71",logo:"_logo_cv1p1_83",name:"_name_cv1p1_88",empty:"_empty_cv1p1_95",footerAction:"_footerAction_cv1p1_98"};var ve=(e=[],t="")=>t?e.filter(({chainName:r})=>r?.toLowerCase().includes(t.toLowerCase())):e,Vt=({search:e,networks:t,tempNetworks:r,updateTempNetworks:s})=>{let{setStep:a,setGroupChain:_}=v();return t.map(l=>{let m=ve(l?.networks,e);if(!m.length)return null;let C=o("wallet_extension_function_bttmsheet_label_num_chain_networks",{num:l.networks.length,chain:o(l.groupInfo.chainKey)});if(e){let c=m.map(({chainName:p})=>p).join(o("extension_wallet_text_punctuation_mark"));C=o("wallet_extension_function_bttmsheet_label_networks_num_chain",{networks:u.default.createElement("span",{className:x.matchedChainNames},c),num:l.networks.length,chain:o(l.groupInfo.chainKey)})}return u.default.createElement(d.Box,{key:l.baseChain,"data-testid":D.ADDRESS_BOOK.NETWORK_ITEM,onClick:()=>{s(l)},className:(0,Ae.default)(x.groupNetwork,{[x.active]:r.includes(l.baseChain)})},u.default.createElement(d.Box,{className:x.groupTitle},l.groupInfo.groupTitle),u.default.createElement(d.Box,{className:x.chainsTip},C),u.default.createElement(d.Box,{className:x.extInfo},u.default.createElement(d.Box,{className:x.chainLogos},u.default.createElement(_e,{maxCount:3,networks:l.networks||[]})),u.default.createElement(d.Box,{className:x.seeAll,onClick:()=>{_(l),a("chainList")}},u.default.createElement("span",{className:x.text},o("wallet_extension_function_bttmsheet_textbtn_show_all")),u.default.createElement(We,{className:x.icon,icon:"okx-wallet-plugin-right"}))))})},Mt=({networks:e,tempNetworks:t,updateTempNetworks:r})=>{let s=te();return e.map(a=>u.default.createElement(d.Box,{key:a.baseChain,"data-testid":D.ADDRESS_BOOK.NETWORK_ITEM,onClick:()=>{r(a)},className:(0,Ae.default)(x.singleNetwork,{[x.active]:t.includes(s(a))})},u.default.createElement(ae,{src:a.imageUrl,className:x.logo}),u.default.createElement(H.Text,{className:x.name,ellipsis:{tooltip:!0}},a.chainName)))},Ot=()=>{let[e,t]=(0,u.useState)(""),{selectedNetworks:r,setStep:s,setDialogProps:a,setSelectedNetworks:_,validNetworks:l}=v(),[m,C]=(0,u.useState)(r),c=te(),p=h=>{C(S=>{let O=c(h);return S.includes(O)?S.filter(K=>K!==O):[...S,O]})},y=(l||[]).filter(h=>h.type==="group"),f=y.filter(h=>!!ve(h.networks,e).length).length,E=ve((l||[]).filter(h=>h.type!=="group"),e),A=E.length,B=f>0||A>0;return(0,pt.useMount)(()=>{a({title:o("wallet_extension_addressbook_title_select_networks"),showBackBtn:!0,hideCloseBtn:!0,onBack(){s("address")}})}),u.default.createElement(d.Box,{className:x.root},u.default.createElement(d.Box,{className:x.main},u.default.createElement(d.Box,{className:x.search},u.default.createElement(V.Search,{value:e,onChange:h=>t(h.target.value.trim()),placeholder:o("extension_wallet_list_input_text_name")})),f>0?u.default.createElement(Vt,{search:e,networks:y,tempNetworks:m,updateTempNetworks:p}):null,A>0?u.default.createElement(Mt,{networks:E,tempNetworks:m,updateTempNetworks:p}):null,B?null:u.default.createElement(Ne.State,{className:x.empty,type:Ne.State.TYPE.noResult,title:o("wallet_search_text_search_no_results")})),B?u.default.createElement(d.Box,{className:x.footerAction},u.default.createElement(T,{block:!0,size:T.SIZE.lg,type:T.TYPE.highlight,category:T.CATEGORY.fill,disabled:!m.length,onClick:()=>{_(m),s("address")},"data-testid":D.ADDRESS_BOOK.NETWORK_CONFIRM},o("wallet_set_password_btn_confirm"))):null)},ct=Ot;n();i();var Te={container:"_container_cya5b_1",scrollBox:"_scrollBox_cya5b_6"};var Kt={["address"]:mt,["network"]:ct,["chainList"]:_t},qt=()=>{let e=v(),{step:t,dialogProps:r}=e,[s,a]=(0,z.useState)(null),_=s?.clientHeight,l=Kt[t];return z.default.createElement($.Action,{isFull:!0,visible:!0,noContentPadding:!0,scrollBoxRef:a,containerClassName:Te.container,scrollBoxClassName:Te.scrollBox,...r},z.default.createElement(l,{scrollBoxHeight:_}))};function ft(e){let{visible:t,...r}=e;return t?z.default.createElement(it,{...r},z.default.createElement(qt,null)):null}ft.TYPE=Z;export{ft as a};
//# sourceMappingURL=chunk-OB3M5GPB.js.map
