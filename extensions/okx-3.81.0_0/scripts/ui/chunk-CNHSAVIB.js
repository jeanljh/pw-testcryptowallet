import{a as L}from"./chunk-P6XPPG3V.js";import{a as F}from"./chunk-4TVSOYI7.js";import{b as D}from"./chunk-S7VT2TWF.js";import{a as N}from"./chunk-3W4MTHFJ.js";import{b as A,c as C}from"./chunk-3ZKJXYZ4.js";import{a as k}from"./chunk-XRCQOGA2.js";import{Ca as E}from"./chunk-GCS2RK7E.js";import{a as j}from"./chunk-6PA65BO3.js";import{c as I,q as S}from"./chunk-WU2LB6XB.js";import{c as T,e as J}from"./chunk-EN2WHAVL.js";import{Ea as f,cb as c,tb as G}from"./chunk-COF7YKSN.js";import{A as i,K as v}from"./chunk-VZKEX7KP.js";import{I as p,o as w}from"./chunk-BJKBO23H.js";import{M as R,va as b}from"./chunk-XFTQD4B2.js";import{b as B}from"./chunk-73B6GL3S.js";import{f as x,o as y,q as h}from"./chunk-Y5OH3DDZ.js";y();h();var _=x(B()),P=x(j());b();v();J();G();var M=({address:r,targetCoinId:a,registerPath:o})=>{let u=(0,P.useHistory)(),g=D();return async({coinId:e})=>{let{coin:t,baseCoin:n}=await g(e,!0);if(![String(e),String(n.coinId)].includes(String(a)))return!0;try{let{status:s}=await N({chainId:t.chainId,address:r});if(s===S.NOT_STARTED){let l=w.warn({title:i("wallet_dialog_modal_not_registered"),text:i("wallet_dialog_modal_register_before_using"),confirmText:i("wallet_dialog_modal_registerbtn"),cancelText:i("wallet_dialog_modal_backbtn"),alignBottom:!1,onConfirm:()=>{l.destroy(),u.push(o)},onCancel:()=>{l.destroy()}});return!1}if(s===S.PROCESSING)return p.warn({title:i("wallet_extension_transaction_notif_address_registering",{net:t.chainName})}),!1}catch(s){let l=s?.error_message||i("wallet_extension_transaction_notif_address_register_fail",{net:t.chainName});return p.error(l),!1}return!0}},rt=()=>{let r=k(f);return M({address:r,targetCoinId:c,registerPath:E})},ot=r=>{let[a,o]=(0,_.useState)({isLoading:!0,isError:!1,nonce:"0",gasFee:{overallFee:"0"}}),u=async()=>(await A({coinId:c,fromAddr:r,toAddr:""}))?.info?.nonce,g=async e=>{let t={type:"deploy_account",nonce:e};return(await T().signTransaction(t,r,f))?.signature},m=async e=>{let{data:t={}}=await C({coinId:c,address:r,inputData:e});return t};return(0,_.useEffect)(()=>{(async()=>{try{let t=await u();if(R(t)){o(s=>({...s,isLoading:!1,isError:!0}));return}let n=await g(t),d=await m(n);o(s=>({...s,isLoading:!1,isError:!1,nonce:t,gasFee:{...d,resourceBounds:F(d)}}))}catch{o(n=>({...n,isLoading:!1,isError:!0}))}})()},[]),a},nt=({nonce:r,gasFee:a,address:o})=>{let u=L();return async()=>{let m={type:"deploy_account",nonce:r,resourceBounds:a?.resourceBounds},e=await T().signTransaction(m,o,f),t={type:"AccountActive",serviceChargeCoinId:c,nonce:r},n={signedTx:e?.signature,fromAdr:o,serviceCharge:a?.overallFee,toAdr:o,coinAmount:"0",coinId:c,txHash:e?.txId,txType:I.REGISTRATION,extJson:JSON.stringify(t)};return await u(n)}};export{rt as a,ot as b,nt as c};
//# sourceMappingURL=chunk-CNHSAVIB.js.map
