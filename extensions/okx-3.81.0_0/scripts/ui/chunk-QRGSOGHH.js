import{B as c}from"./chunk-EFOY37CC.js";import{A as d,B as f,J as m}from"./chunk-COF7YKSN.js";import{A as p,K as y}from"./chunk-VZKEX7KP.js";import{o as a,p as t,q as i}from"./chunk-Y5OH3DDZ.js";a();i();m();y();function l(r=64){return globalThis.crypto.getRandomValues(new Uint8Array(r))}async function b(){return!!(navigator.credentials&&!!navigator.credentials.create&&c()!==f&&c()!==d)}async function C(){if(PublicKeyCredential&&!!PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable)try{if(await PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable())return!0}catch{return!1}return!1}async function A(){let r=l(),o=p("wallet_extension_account_tips_dont_delete_passkey"),n={publicKey:{challenge:l(),rp:{name:"OKX-Wallet-Extension",id:window.location.hostname},user:{id:r,name:o,displayName:"OKX-Wallet-Extension"},pubKeyCredParams:[{type:"public-key",alg:-7},{type:"public-key",alg:-257},{type:"public-key",alg:-8}],authenticatorSelection:{requireResidentKey:!0,userVerification:"preferred"},timeout:2*60*1e3}},e=await navigator.credentials.create(n);if(!e)throw new Error("Missing credential");let s=t.Buffer.from(r).toString("hex"),u=t.Buffer.from(e.rawId).toString("hex"),g=e.response&&e.response.getTransports&&e.response.getTransports();return{password:s,credentialId:u,credential:{rawId:u,transports:g}}}async function _({credential:r,password:o}){let n={publicKey:{challenge:l(),allowCredentials:[{id:t.Buffer.from(r.rawId,"hex"),type:"public-key",transports:r.transports}],userVerification:"required"}},e=await navigator.credentials.get(n);if(!e)throw new Error("Missing credential");let s=e.response;if(!s.userHandle)throw new Error("Missing userHandle");if(!t.Buffer.from(o,"hex").equals(t.Buffer.from(s.userHandle)))throw new Error("Missing password");return!0}async function E(r){let o={publicKey:{challenge:l(),allowCredentials:[{id:t.Buffer.from(r,"hex"),type:"public-key"}],userVerification:"required"}},n=await navigator.credentials.get(o);if(!n)throw new Error("Auth error.");let e=n.response;if(!e.userHandle)throw new Error("Lost password.");return{password:t.Buffer.from(e.userHandle).toString("hex")}}async function K(){}a();i();export{l as a,b,C as c,A as d,_ as e,E as f,K as g};
//# sourceMappingURL=chunk-QRGSOGHH.js.map
