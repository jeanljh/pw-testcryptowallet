import{a as Re}from"./chunk-O44OX6MD.js";import{a as We}from"./chunk-CIE6HRPG.js";import{a as ze}from"./chunk-7QX2TXNH.js";import{d as Be}from"./chunk-ZDHJHPQ5.js";import{b as ve,c as j,d as z,e as ye,f as Ie,g as be,h as Ce,i as ke,j as Ne,k as Ee,l as D,m as O,n as G,o as Se,p as V,q as K,r as Te,s as Ue,t as De,u as Pe}from"./chunk-76H3GJ3E.js";import{F as $e}from"./chunk-ZOKF3EKQ.js";import"./chunk-MDBKHBHQ.js";import"./chunk-WRVJM3F3.js";import"./chunk-NYBKFEEM.js";import"./chunk-XVSXMJ3S.js";import"./chunk-KQ66JTF7.js";import{c as ie}from"./chunk-OOYDFTEF.js";import"./chunk-JNIP4OYT.js";import"./chunk-XRCQOGA2.js";import{a as he,c as H,e as U}from"./chunk-SWUBCABA.js";import{b as Ae}from"./chunk-7MCLPJAH.js";import"./chunk-WAIJPY5X.js";import"./chunk-YGMRSF47.js";import"./chunk-6XGS36TZ.js";import"./chunk-M2YY6A5T.js";import"./chunk-XLG73W5Q.js";import{Ha as xe,Z as we,a as ge}from"./chunk-GCS2RK7E.js";import"./chunk-OIPQWTNV.js";import"./chunk-VJI6MZK4.js";import"./chunk-5PRURJ2O.js";import"./chunk-FGAB46RQ.js";import"./chunk-47ZMUKCZ.js";import{o as _e}from"./chunk-Z62JX42S.js";import{Na as A}from"./chunk-2QHGKEME.js";import"./chunk-B624VS3G.js";import"./chunk-W4SQ6335.js";import"./chunk-YDSDBRIT.js";import{a as Le}from"./chunk-6PA65BO3.js";import"./chunk-OIXGC4LI.js";import{b as F}from"./chunk-MAAUVUWY.js";import"./chunk-4X64L7DZ.js";import"./chunk-GLL4BXR6.js";import"./chunk-4L5HWMAA.js";import{g as ue}from"./chunk-EZS2GR7E.js";import"./chunk-NUN72MDU.js";import"./chunk-BFWVIVOY.js";import"./chunk-S3FOFXM7.js";import"./chunk-YIFLUVTR.js";import"./chunk-EN2WHAVL.js";import"./chunk-CP2RIMI2.js";import"./chunk-3QLLFUC4.js";import"./chunk-EFOY37CC.js";import"./chunk-HMTT52FG.js";import"./chunk-45NMMWRA.js";import"./chunk-E4OV5WXB.js";import{b as me,c as sr}from"./chunk-GR7YC6C3.js";import{A as pe,C as ce,J as de}from"./chunk-O33H5V3V.js";import"./chunk-DJN2J7J5.js";import"./chunk-35ANKHOJ.js";import"./chunk-BI4OEIFC.js";import{Kb as fe,Sb as ar}from"./chunk-COF7YKSN.js";import{A as t,K as $}from"./chunk-VZKEX7KP.js";import"./chunk-QCEQQDCM.js";import{A as oe,d as te,q as v}from"./chunk-BJKBO23H.js";import"./chunk-IO3ALUOJ.js";import"./chunk-AHVVUOFF.js";import"./chunk-DJSNVDZI.js";import"./chunk-K336SGW3.js";import"./chunk-XFTQD4B2.js";import"./chunk-FOOC6LB7.js";import"./chunk-DHKS44RQ.js";import"./chunk-4DBVFCYR.js";import"./chunk-2IGQWLAB.js";import"./chunk-GVV6OTQP.js";import{t as le,u as k,z as N}from"./chunk-ZFVABNQN.js";import"./chunk-VYWNZTTM.js";import"./chunk-LBWWOQL4.js";import{a as nr}from"./chunk-4QGZDIBD.js";import{b as L}from"./chunk-73B6GL3S.js";import"./chunk-LVJGLJNA.js";import"./chunk-Z7PBP7IJ.js";import"./chunk-5F7M5EJ4.js";import"./chunk-RNWGOGLT.js";import"./chunk-UGJ3FMEQ.js";import"./chunk-H6JAOQCX.js";import"./chunk-Z2AIGJGI.js";import"./chunk-VBZ4JSJ6.js";import"./chunk-LBYXY63E.js";import"./chunk-M4ANCDMF.js";import"./chunk-J6KTJ3IN.js";import"./chunk-5CQODPK7.js";import"./chunk-C5XO4JMZ.js";import"./chunk-HI3LE734.js";import"./chunk-RX4V72AK.js";import{c as ir,f as x,o as g,p as b,q as w}from"./chunk-Y5OH3DDZ.js";var ne=ir((ur,Ze)=>{g();w();(function(o){"use strict";o.exports.is_uri=c,o.exports.is_http_uri=r,o.exports.is_https_uri=i,o.exports.is_web_uri=h,o.exports.isUri=c,o.exports.isHttpUri=r,o.exports.isHttpsUri=i,o.exports.isWebUri=h;var l=function(a){var e=a.match(/(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/);return e};function c(a){if(!!a&&!/[^a-z0-9\:\/\?\#\[\]\@\!\$\&\'\(\)\*\+\,\;\=\.\-\_\~\%]/i.test(a)&&!/%[^0-9a-f]/i.test(a)&&!/%[0-9a-f](:?[^0-9a-f]|$)/i.test(a)){var e=[],n="",_="",m="",p="",d="",f="";if(e=l(a),n=e[1],_=e[2],m=e[3],p=e[4],d=e[5],!!(n&&n.length&&m.length>=0)){if(_&&_.length){if(!(m.length===0||/^\//.test(m)))return}else if(/^\/\//.test(m))return;if(!!/^[a-z][a-z0-9\+\-\.]*$/.test(n.toLowerCase()))return f+=n+":",_&&_.length&&(f+="//"+_),f+=m,p&&p.length&&(f+="?"+p),d&&d.length&&(f+="#"+d),f}}}function r(a,e){if(!!c(a)){var n=[],_="",m="",p="",d="",f="",I="",s="";if(n=l(a),_=n[1],m=n[2],p=n[3],f=n[4],I=n[5],!!_){if(e){if(_.toLowerCase()!="https")return}else if(_.toLowerCase()!="http")return;if(!!m)return/:(\d+)$/.test(m)&&(d=m.match(/:(\d+)$/)[0],m=m.replace(/:\d+$/,"")),s+=_+":",s+="//"+m,d&&(s+=d),s+=p,f&&f.length&&(s+="?"+f),I&&I.length&&(s+="#"+I),s}}}function i(a){return r(a,!0)}function h(a){return r(a)||i(a)}})(Ze)});g();w();var u=x(L()),Je=x(A()),er=x(Le()),rr=x(_e()),tr=x(nr());$();g();w();var R=x(L()),Q=x(A());$();var Me=(0,R.memo)(o=>{let{disabled:l}=o,c=(0,Q.useDispatch)(),r=({target:{value:n}})=>{c(ke(n))},{name:i,nameErr:h}=(0,Q.useSelector)(ve),a=()=>{c(Ne(t(i?"":"developer_mode_network_errortip_cannotspace")))},e=t("extension_wallet_addnetwork_placeholder_network");return R.default.createElement("div",{className:"net-form__wrap-input"},R.default.createElement(v,{value:i,onBlur:a,disabled:l,size:v.SIZE.xl,errorType:v.TIP_TYPE.always,error:h,onChange:r,placeholder:e,label:t("wallet_transaction_history_subtitle_network_name")}))});g();w();var B=x(L()),M=x(A()),Ye=x(ne());$();g();w();g();w();de();async function qe(o,l,c=[]){let r=o,i={"Content-Type":"application/json"},{origin:h,pathname:a,username:e,password:n,search:_}=new URL(o);if(e&&n){let I=b.Buffer.from(`${e}:${n}`).toString("base64");i.Authorization=`Basic ${I}`,r=`${h}${a}${_}`}let m=await ce(r,{id:Date.now().toString(),jsonrpc:"2.0",method:l,params:c},{timeout:3e4,cache:"default",headers:i}),p=m?.data;try{p||(p=await m.clone().json())}catch{}if(!p||Array.isArray(p)||typeof p!="object")throw new Error(`RPC endpoint ${o} returned non-object response.`);let{error:d,result:f}=p;if(d)throw new Error(d?.message||d);return f}var X=o=>{try{let l=new URL(o);return l.protocol==="http:"||l.protocol==="https:"}catch{return!1}},J=((o={})=>l=>new Promise((c,r)=>o[l]?c(o[l]):qe(l,"eth_chainId").then(i=>{o[l]=i,c(i)}).catch(i=>{r(i)})))();var Fe=B.default.memo(o=>{let{disabled:l,modify:c}=o,r=(0,M.useDispatch)(),[i,h]=(0,B.useState)(!1),a=({target:{value:f}})=>{r(Ee(f.trim()))},{rpcUrl:e,rpcUrlErr:n}=(0,M.useSelector)(j),{rpcNetworks:_}=U(),{chainId:m}=(0,M.useSelector)(z),p=()=>{if(!e)return r(D(t("developer_mode_network_errortip_cannotspace")));if(!X(e))return r(D(t("developer_mode_infor_errortip_https")));if(!Ye.default.isWebUri(e))return r(D(t("developer_mode_infor_errortip_rpcurl")));let I=_.find(s=>s.rpcUrl===e);return I&&!c?r(D(t("developer_mode_infor_errortip_used_network",{network:I.name}))):(h(!0),J(e).then(s=>{try{if(s=parseInt(s,16).toString(10),Number.isNaN(+s)){h(!1),r(D(""));return}c?s!==m&&r(G({err:t("developer_mode_infor_errortip_chainid",{chainID:s}),validChainId:m})):r(O(s))}catch{}h(!1),r(D(""))}).catch(()=>{r(D(t("developer_mode_infor_errortip_rpcurl"))),h(!1)}))},d=t("extension_wallet_addnetwork_placeholder_prcurl");return B.default.createElement("div",{className:"net-form__wrap-input"},B.default.createElement(v,{value:e,onBlur:p,disabled:l,size:v.SIZE.xl,errorType:v.TIP_TYPE.always,error:n,onChange:a,placeholder:d,label:t("developer_mode_network_title_rpcurl"),suffix:i&&B.default.createElement(k.Circle,{size:k.SIZE.sm})}))});g();w();var P=x(L()),Z=x(A()),He=x(_e());$();sr();de();var lr=async o=>{let{data:l}=await pe(me.getRpcNetworkByChainId,{chainIds:[o]});return l?.[0]?.nativeCurrency?.symbol},je=P.default.memo(o=>{let{disabled:l,modify:c}=o,r=(0,Z.useDispatch)(),i=({target:{value:s}})=>{r(V(s.trim()))},{symbol:h,symbolErr:a,symbolTip:e}=(0,Z.useSelector)(ye),[n,_]=(0,P.useState)(!1),{chainId:m}=(0,Z.useSelector)(z),[p,d]=(0,P.useState)(!0),f=()=>{let s="";if(!m){r(K(s));return}h||(s=t("developer_mode_network_errortip_cannotspace"),r(K(s))),r(K(s))};(0,He.useDebounceEffect)(()=>{(async()=>{if(!m||c)return;let s;_(!0);try{r(V("")),s=await lr(m),r(V(s))}catch{}finally{d(s),_(!1)}})()},[m],{wait:500});let I=t("extension_wallet_addnetwork_placeholder_symbol");return P.default.createElement("div",{className:"net-form__wrap-input"},P.default.createElement(v,{value:h,disabled:l||c||p,onBlur:f,size:v.SIZE.xl,errorType:v.TIP_TYPE.always,error:a,tips:e,onChange:i,suffix:n&&P.default.createElement(k.Circle,{size:k.SIZE.sm}),placeholder:I,label:t("developer_mode_network_title_tokenname")}))});g();w();var C=x(L()),q=x(A());$();g();w();ar();function Oe(o){return Number.isSafeInteger(o)&&o>0&&o<=fe}var Ge=C.default.memo(o=>{let{disabled:l,modify:c}=o,r=(0,q.useDispatch)(),i=({target:{value:y}})=>{r(O(y.trim()))},[h,a]=(0,C.useState)(!1),{chainId:e,chainIdErr:n,chainIdTip:_,fieldUpdated:m}=(0,q.useSelector)(z),{rpcUrl:p}=(0,q.useSelector)(j),{rpcNetworks:d}=U(),f=(y,E,S=e)=>{r(G({err:y,validChainId:S})),r(Se({tip:E,validChainId:S}))},I=()=>{let y="",E="";if(!e)return y=t("developer_mode_network_errortip_cannotspace"),f(y,E);let S=e,se=10;if(!S.startsWith("0x"))try{S=`0x${F(S)}`}catch{y=t("developer_mode_infor_errortip_errorchainid")}let[ae]=d.filter(T=>T.chainId===S&&T.rpcUrl!==p);if(ae?E=t("developer_mode_infor_errortip_network",{network:ae.name}):e.startsWith("0x")?(se=16,/^0x[0-9a-f]+$/iu.test(e)||(y=t("developer_mode_infor_errortip_errornum"))):/^[0-9]+$/u.test(e)?e.startsWith("0")?y=t("developer_mode_infor_errortip_errornum"):Oe(parseInt(e,se))||(y=t("developer_mode_infor_errortip_errorchainid")):y=t("developer_mode_infor_errortip_errornum"),!p||h||y)return f(y,E);a(!0),J(p).then(T=>{if(S!==T){if(!e.startsWith("0x"))try{T=parseInt(T,16).toString(10)}catch(or){console.log(or)}y=t("developer_mode_infor_errortip_chainid",{chainID:T})}f(y,E,e),a(!1)}).catch(()=>{E=t("developer_mode_infor_errortip_rpcurl_confirm"),a(!1),f(y,E,e)})},s=t("extension_wallet_addnetwork_placeholder_chainid");return C.default.createElement("div",{className:"net-form__wrap-input"},C.default.createElement(v,{value:e,disabled:l||!!c,size:v.SIZE.xl,errorType:v.TIP_TYPE.always,error:n,onBlur:I,tips:_,onChange:i,suffix:h&&m&&C.default.createElement(k.Circle,{size:k.SIZE.sm}),placeholder:s,label:C.default.createElement(C.default.Fragment,null,t("developer_mode_network_title_chainid"),C.default.createElement(oe,{title:t("developer_mode_network_tooltip_display_decimal"),placement:oe.DIRECTION.topRight},C.default.createElement(le,{className:"okx-wallet-plugin-information-circle"})))}))});g();w();var W=x(L()),Y=x(A()),Ve=x(Le());$();g();w();var Ke=o=>{let{modify:l,uniqueId:c,onDeleteNet:r}=o,i=(0,Ve.useHistory)(),h=(0,Y.useSelector)(Ce),a=$e(),{rpcNetworks:e,updateRpcNetwork:n,addRpcNetwork:_}=U(),m=(0,Y.useDispatch)(),p=(0,Y.useSelector)(be),d=e.find(s=>H(s,{uniqueId:c}))||{},f=(0,W.useRef)(!1),I=async()=>{if(!f.current){if(f.current=!0,l){await n({...d,...p});let s={...p,chainId:`0x${F(p.chainId)}`};a(s),i.replace(`${we}?tab=2`)}else{let s=await _(p);await m(We({isRpcMode:!0,currentNetworkUniqueId:s?.uniqueId})),i.replace(xe)}f.current=!1}};return W.default.createElement(Ae.FooterActions,{usePortal:!0},l&&W.default.createElement(N,{category:N.CATEGORY.outline,type:N.TYPE.primary,size:N.SIZE.lg,onClick:r,className:"net-form__footer-delete-btn",contentClassName:"net-form__footer-delete-btn__text"},t("commonall_resultpage_btn_delete")),W.default.createElement(N,{disabled:h,category:N.CATEGORY.fill,type:N.TYPE.highlight,size:N.SIZE.lg,onClick:I},t("developer_mode_bot_btn_save")))};g();w();var ee=x(L()),re=x(A()),Qe=x(ne());$();var Xe=ee.default.memo(o=>{let{disabled:l}=o,c=(0,re.useDispatch)(),r=({target:{value:n}})=>{c(Te(n.trim()))},{explorerUrl:i,explorerUrlErr:h}=(0,re.useSelector)(Ie),a=()=>{let n="";i&&(Qe.default.isWebUri(i)||(X(i)?n=t("developer_mode_infor_errortip_invalidurl"):n=t("developer_mode_infor_errortip_https1"))),c(Ue(n))},e=t("extension_wallet_addnetwork_placeholder_blockchain");return ee.default.createElement("div",{className:"net-form__wrap-input"},ee.default.createElement(v,{value:i,onBlur:a,disabled:l,size:v.SIZE.xl,errorType:v.TIP_TYPE.always,error:h,onChange:r,placeholder:e,label:t("developer_mode_network_title_blockchain_explorer")}))});var jt=()=>{let o=(0,Je.useDispatch)(),l=(0,er.useHistory)(),c=ze(),r=c.get("modify"),i=r===he.CANT,h=decodeURIComponent(c.get("id")),{rpcNetworks:a}=U(),e=(0,u.useMemo)(()=>a.find(d=>H(d,{uniqueId:h}))||{},[a]);(0,u.useEffect)(()=>{let d={...e};d.chainId&&(d.chainId=`${Number.parseInt(d.chainId,16)}`),o(De(d))},[e]),(0,rr.useUnmount)(()=>{o(Pe())});let n=(0,u.useCallback)(()=>{l.action==="POP"?l.replace(ge):l.goBack()},[l]),_=Re(),m=(0,u.useCallback)(()=>{_({editRpcInfo:e,onDeleted:n})},[_,n,e]),p=(0,u.useMemo)(()=>u.default.createElement("div",{className:"net-form__title"},e.name?u.default.createElement(u.default.Fragment,null,u.default.createElement(ie,{size:ie.SIZE.md,src:e.icon,text:e.name,className:"net-form__title-icon",defaultIcon:ue}),u.default.createElement("div",{className:"net-form__title-text net-form__title-text-top"},e.name)):u.default.createElement("div",{className:"net-form__title-text"},t("wallet_extension_settings_header_custom_network"))),[e]);return u.default.createElement("div",{className:(0,tr.default)("net-form",{disabled:i})},u.default.createElement(Be,{onBack:n,closeable:!1}),i||r?null:u.default.createElement(te,{className:"net-form__warn",desc:t("developer_mode_network_errortip_trust_network"),type:te.TYPE.warn,closable:!1}),p,u.default.createElement("div",{className:"net-form__wrap"},u.default.createElement(Me,{disabled:i}),u.default.createElement(Fe,{disabled:i,modify:r}),u.default.createElement(Ge,{disabled:i,modify:r}),u.default.createElement(je,{disabled:i,modify:r}),u.default.createElement(Xe,{disabled:i}),!i&&u.default.createElement(Ke,{modify:r,uniqueId:h,onDeleteNet:m})))};export{jt as default};
//# sourceMappingURL=Form-MAKTSDBP.js.map
