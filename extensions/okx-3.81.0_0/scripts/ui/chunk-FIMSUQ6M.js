import{a as Ie}from"./chunk-JPDLWYEN.js";import{a as we}from"./chunk-OQPEUXN4.js";import{b as Ae}from"./chunk-7X2CMAJK.js";import{a as ve}from"./chunk-6C2G522Z.js";import{a as Te}from"./chunk-QXMLTUW3.js";import{c as ge,d as ye}from"./chunk-AQO2BBXJ.js";import{a as _e}from"./chunk-L2MGED7F.js";import{a as he}from"./chunk-L6EQYGXX.js";import{a as be}from"./chunk-SMB23TMJ.js";import{d as pe,e as de,h as fe,j as Ce}from"./chunk-V7ZNWTMX.js";import{a as ue}from"./chunk-EBRJSEEJ.js";import{x as ae}from"./chunk-MSFAPAHB.js";import{a as le}from"./chunk-NYBKFEEM.js";import{a as W}from"./chunk-JNIP4OYT.js";import{b as me}from"./chunk-QRAFULYC.js";import{a as q,f as B,u as ce}from"./chunk-FGAB46RQ.js";import{o as We}from"./chunk-Z62JX42S.js";import{C as se,I as K,J as ie,K as V,Na as He,g as G,oa as Y}from"./chunk-2QHGKEME.js";import{a as F}from"./chunk-EFOY37CC.js";import{c as I}from"./chunk-HMTT52FG.js";import{b as D,c as Be}from"./chunk-GR7YC6C3.js";import{A as E,E as ee,J as Pe}from"./chunk-O33H5V3V.js";import{Rb as ne,Sb as Me,Ub as te,Xb as oe,_b as Oe,ac as re,gb as O,nc as Ge,tb as Re}from"./chunk-COF7YKSN.js";import{A as b,K as Z,m as X,o as z,z as S}from"./chunk-VZKEX7KP.js";import{A as k,H as Q,f as L}from"./chunk-BJKBO23H.js";import{ia as R,va as Ee}from"./chunk-XFTQD4B2.js";import{t as j}from"./chunk-ZFVABNQN.js";import{a as J}from"./chunk-4QGZDIBD.js";import{b as M}from"./chunk-73B6GL3S.js";import{f as A,o as f,q as C}from"./chunk-Y5OH3DDZ.js";f();C();var y=A(M()),$=A(He()),H=A(We());Ee();Z();Ge();Re();Oe();f();C();Be();Pe();var tn=async e=>{try{let t=await E(D.getMarketMap,e);if(t?.data)return t.data}catch{}return""},Ne=async e=>{try{let{data:t={}}=await ee(D.getTonMintlessInfo,e);return t}catch{}return{}},on=async e=>E(D.getLatestPnl,e),rn=async e=>E(D.getCoinPriceCurveNew,e),sn=async()=>E(D.getPnlSupportedChainIds,{});function De(e,t,r="0",o={}){let{useApproximate:n=!0}=o,i={coinAmountDisplay:q(0,{isStableCoin:e.stableCoin,precision:e.displayPrecision,useLargeNumberPrecision:!0}).value,currencyAmountDisplay:B(0,{currencySign:t,useApproximate:n}).value,currencyAmountNoUnitDisplay:B(0,{currencySign:t}).value};if(!e.coinAmount)return i;let{coinAmount:s}=e,l=q(s,{isStableCoin:e.stableCoin,precision:e.displayPrecision,useLargeNumberPrecision:!0}).value,p=B(F(s,r),{currencySign:t,useApproximate:n}).value,m=B(F(s,r),{currencySign:t}).value;return i={coinAmountDisplay:l,currencyAmountDisplay:p,currencyAmountNoUnitDisplay:m},i}function Ue(e,t,r){return!Array.isArray(e)||!e?.length?[]:e.map(o=>{let{coinAmountDisplay:n,currencyAmountDisplay:i,currencyAmountNoUnitDisplay:s}=De(o,t,r?.[o.coinId]||0);return{...o,coinAmountDisplay:n,currencyAmountDisplay:i,currencyAmountNoUnitDisplay:s}})}function ze(e,t){if(!Array.isArray(e)||!e?.length)return[];let r=t.reduce((o,n)=>(o[n.coinId]=n,o),{});return e.map(o=>{let n=o.baseCoinId===0?o.coinId:o.baseCoinId,i=r[n]||{},{imageUrl:s,symbol:l}=i;return{...o,chainImage:s,chainSymbol:l}})}function Fe(e,t){return!Array.isArray(e)||!e?.length?[]:e.map(o=>{let n=ge(t,o.coinId);return{...o,...n}})}function je(e){if(!Array.isArray(e)||!e?.length)return{result:[],hasBalChainGte3:!1};let t=[],r=e.filter(n=>+n.coinAmount>0),o=r&&r.length>=3;if(r&&r.length>=2){t=[{symbol:e[0].symbol,image:e[0].image,chainImage:e[0].chainImage,coinAmount:0,currencyAmount:0,tokenType:"wallet_extension_dashboard_tab_overview",coinId:"",overview:!0,stableCoin:e[0]?.stableCoin,displayPrecision:e[0]?.displayPrecision}];let n=e[0];(K(n)||ie(n)||V(n))&&(t[0].coinId=e[0].coinId,t[0].addressType="")}return{result:t,hasBalChainGte3:o}}function Ke(e){if(!Array.isArray(e)||!e?.length)return[];let t=[];t=e.filter(n=>Boolean(n.localType)),t=R(R(R(t,n=>n.tokenSort),n=>-(Number(n.maxApy)||0)),n=>-n.coinAmount);let r=null;if(t=t.filter(n=>we(n)?(r=n,!1):!0),!r)return t;if(z.gt(r.coinAmount,0))t.unshift(r);else{let n=t.findIndex(i=>z.lte(i.coinAmount,0));n!==-1?t.splice(n,0,r):t.push(r)}return t}function Ve(e,t){return!Array.isArray(e)||!e?.length?[]:e.map(o=>{let n={...o};o.overview&&(n.tokenType=t(n.tokenType));let i=K(o)||V(o);if(i&&!o.overview){let{localType:s,addressType:l}=o,p=t(te[oe[s][l]]);n.chainName=p,n.tokenType=p}return!i&&!n.tokenType&&(n.tokenType=n.chainName),n})}function Sn({aggregation:e,coinSymbol:t,btcAggregation:r,nearAggregation:o,tonAggregation:n,coin:i}){let s=[],l=de(),p=pe(),m=(0,$.useSelector)(Y),d=fe(),u=Te(i),_=ue(),T=r||o||n;if(!e&&!T)return{tabList:s,hasBalChainGte3:!1};T?s=u:(s=l.find(h=>h.aggregation&&h.symbol===t)?.childrenCoin||[],s=Fe(s,p)),s=ze(s,_),s=Ue(s,m,d),s=Ke(s);let{result:v,hasBalChainGte3:w}=je(s);return s=[...v,...s],s=Ve(s,b),{tabList:s,hasBalChainGte3:w}}function Ln(e,t,r={}){let{amountDisplayOptions:o={}}=r,n=ye(e,t),i=(0,$.useSelector)(Y),s=Ce(e),l=De(n,i,s,o);return(0,H.useCreation)(()=>({...n,...l}),[n,l])}function kn(e,t,r){let{coinId:o,baseCoinId:n,symbol:i}=e,[s,l]=(0,y.useState)(null),p=(0,H.useLatest)(s),m=(0,y.useCallback)(async()=>{let{status:u,offlineAmount:_,expiredAt:T}=await Ne({coinId:o,address:t});l(u===1?{desc:b("wallet_extension_airdrop_toast_claim_before_expire_new",{num:_,token:i,time:X(T,{format:"yyyyMMddHHmmss",locale:r})}),closable:!1,showTonMessage:!0}:null)},[o,t]),d=me("wallet-asset",{onError:()=>{n===O&&p.current?.showTonMessage&&m()},pollingInterval:10*1e3});return(0,y.useEffect)(()=>{n===O&&o&&t&&m()},[n,o,t]),(0,y.useEffect)(()=>{let u=d?.data?.coinId;p.current?.showTonMessage&&u===o&&m()},[o,d]),s}function En(e,t){let r="isShowTonTipsAtCoinDetail",[o,n]=(0,y.useState)(null),i=S.get(r);return(0,y.useEffect)(()=>{!i&&t===re.MNEMONIC&&e?.coinId===O?n({desc:b("wallet_extension_alert_ton_asset"),onClose:()=>{S.set(r,!0),n(null)},closable:!0,showTonMessage:!0}):n(null)},[t,e?.coinId]),o}function xe({canChangeDefaultAddress:e}){let t="firstTimeOpenDetailPage",r=(0,y.useRef)(void 0);return(0,y.useEffect)(()=>{let o=S.get(t)!==!1;!e||!r.current||!o||(S.set(t,!1),setTimeout(()=>{r.current?.setVisible(!0)},500),setTimeout(()=>{r.current?.setVisible(!1)},3500))},[e,r]),r}f();C();var a=A(M()),U=A(J());f();C();var g={refreshWrapper:"_refreshWrapper_1sf7p_1",refreshIcon:"_refreshIcon_1sf7p_6",hidden:"_hidden_1sf7p_10",amount:"_amount_1sf7p_13",refreshAnimation:"_refreshAnimation_1sf7p_32",refresh:"_refresh_1sf7p_1",pointer:"_pointer_1sf7p_35",balance:"_balance_1sf7p_38",row:"_row_1sf7p_48",front:"_front_1sf7p_53",middle:"_middle_1sf7p_54",icon:"_icon_1sf7p_69",wrapped:"_wrapped_1sf7p_72"};function Ye(e,t,r){let o=(0,a.useRef)(null),n=(0,a.useRef)(null),i=(0,a.useRef)(null),s=(0,a.useRef)(null),[l,p]=(0,a.useState)(!1),m=()=>{let d=o.current,u=n.current,_=i.current,T=s.current;!d||!u||!_||requestAnimationFrame(()=>{let v=d.getBoundingClientRect().width,w=u.getBoundingClientRect().width,N=_.getBoundingClientRect().width,h=w+N,P=0;T&&(P=T.getBoundingClientRect().width);let ke=h+P>v;p(ke)})};return(0,a.useLayoutEffect)(()=>{m();let d=()=>m();window.addEventListener("resize",d);let u=new ResizeObserver(()=>m());o.current&&u.observe(o.current);let _=new MutationObserver(()=>m());return o.current&&_.observe(o.current,{childList:!0,subtree:!0,characterData:!0}),()=>{window.removeEventListener("resize",d),u.disconnect(),_.disconnect()}},[e,t,r]),{rowRef:o,frontRef:n,middleRef:i,iconRef:s,wrapped:l}}function qe({coinSymbol:e,amountDisplay:t,currencyDisplay:r,justify:o=I.ALIGN.center}){let[n,i]=(0,a.useState)("hidden"),[s,l]=le(),{rowRef:p,frontRef:m,middleRef:d,iconRef:u,wrapped:_}=Ye(e,t,r),T=()=>{i("hidden")},v=(0,a.useCallback)(()=>{n!=="loading"&&i("show")},[n]),w=(0,a.useCallback)(()=>{n!=="loading"&&i("hidden")},[n]),N=s?G:t,h=s?G:r,P=s?G:`${t} ${e}`;return a.default.createElement("div",{ref:p,className:"coin-detail-balance"},a.default.createElement(I.FlexBox,{align:I.ALIGN.center,justify:o,onMouseEnter:v,onMouseLeave:w,className:g.refreshWrapper},a.default.createElement(I.Box,{onClick:l,onAnimationEnd:T,className:(0,U.default)(g.refreshWrapper,g.pointer,{[g.refreshAnimation]:n==="success"})},a.default.createElement("div",{className:(0,U.default)(g.row,{[g.wrapped]:_})},a.default.createElement("div",{ref:m,className:g.front},a.default.createElement(ce.Text,{ellipsis:{tooltip:!0,customToolTipContent:P,placement:k.DIRECTION.bottom},className:g.balance},N)),r&&a.default.createElement("div",{ref:d,className:g.middle},a.default.createElement(I.FlexBox,{align:I.ALIGN.center,justify:o},a.default.createElement("div",{className:"coin-detail-balance__currency"},h))),!s&&a.default.createElement("div",{ref:u,className:g.icon},a.default.createElement(Ae,{className:(0,U.default)(g.refreshIcon,{[g.hidden]:n==="hidden"}),status:n,handleRefresh:i}))))))}var $e=qe;f();C();var c=A(M());Z();Me();function Xe({addressLabel:e,address:t,addressType:r,isDefaultAddress:o,baseCoin:n={},coin:i={},canChangeDefaultAddress:s,openAddressesDialog:l}){let p=xe({canChangeDefaultAddress:s}),[m,d]=Ie(),{isNotBackupWallet:u}=be(),_=he(),T=ne.includes(i?.localType),v=ve(ae),w=()=>{if(v({button_clicked:"copy_address"}),u){_();return}if(!m){d(t);let h=b("wallet_extension_overview_receive_address_copied");r&&(h=_e(b,r,n)),Q.success({title:h,desc:c.default.createElement("div",{className:"coin-detail-address__copy-message"},t)})}},N=()=>u?c.default.createElement("span",{className:"new-coin-detail-address-content-black"},se(t)):T?c.default.createElement("span",null,t):c.default.createElement(c.default.Fragment,null,c.default.createElement("span",{className:"new-coin-detail-address-content-black"},t));return c.default.createElement("div",{className:"new-coin-detail-address-wrapper"},c.default.createElement("div",{className:"new-coin-detail-address",onClick:w},c.default.createElement("div",{className:"new-coin-detail-address-title","data-testid":W.COIN_DETAIL_PAGE.ADDRESS_TITLE},b("extension_wallet_address_text_network_address",{network:e}),o&&s&&c.default.createElement(L,{className:"new-coin-detail-address-tag",size:L.SIZE.sm,type:L.TYPE.rounded,color:L.COLOR.grey},b("wallet_extension_btc_tag_default_address"))),c.default.createElement("div",{className:"new-coin-detail-address-inner"},c.default.createElement("div",{className:"new-coin-detail-address-content","data-testid":W.COIN_DETAIL_PAGE.ADDRESS_CONTENT},N()),c.default.createElement("div",{className:"new-coin-detail-address__icon"},c.default.createElement(j,{className:"okx-wallet-plugin-copy-1",style:{fontSize:"20px",color:u?"var(--okd-color-content-disabled)":"var(--okd-color-content-primary)"}})))),s&&c.default.createElement("div",{className:"new-coin-detail-address-wrapper__default-address"},c.default.createElement(k,{popupRef:p,placement:k.DIRECTION.topRight,title:b("wallet_extension_hover_change_address_format")},c.default.createElement("div",{onClick:()=>{v({button_clicked:"default_address"}),l()},className:"new-coin-detail-address-wrapper__address-content","data-testid":W.COIN_DETAIL_PAGE.SET_DEFAULT_ADDRESS_BUTTON},b("extension_wallet_settings_title_set_default"),c.default.createElement(j,{className:"okx-wallet-plugin-arrow-small-right coin-detail__body__overview-address__icon"})))))}var Ze=Xe;f();C();var Se=A(M()),Le=A(J());function Je({className:e,children:t}){return Se.default.createElement("div",{className:(0,Le.default)("coin-detail-overview-container",e)},t)}var Qe=Je;f();C();export{$e as a,tn as b,on as c,rn as d,sn as e,Sn as f,Ln as g,kn as h,En as i,xe as j,Ze as k,Qe as l};
//# sourceMappingURL=chunk-FIMSUQ6M.js.map
