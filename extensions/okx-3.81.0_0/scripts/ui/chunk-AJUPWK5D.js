import{a as ir}from"./chunk-WPH62D5K.js";import{a as or}from"./chunk-L2AWIRLM.js";import{a as rr}from"./chunk-EP773FEO.js";import{a as ar}from"./chunk-AOERXRJS.js";import{a as nr}from"./chunk-NCWD27TW.js";import{a as er}from"./chunk-OOD2ESRB.js";import{c as Vo}from"./chunk-HW7PF3XP.js";import{a as jo,b as qo,c as _n,d as ie,e as Ko,f as Go,g as Bn,h as Qo,i as Yo,j as Rt}from"./chunk-G42BVB67.js";import{a as Xo,c as Jo,d as $o,g as Zo}from"./chunk-SNS3QUAD.js";import{d as tr,e as dn}from"./chunk-LBF75ZOB.js";import{f as zo}from"./chunk-PQQFVOPL.js";import{d as Ro}from"./chunk-ZDHJHPQ5.js";import{a as we}from"./chunk-TE6AOABI.js";import{a as Z,b as Lo}from"./chunk-ITLEVVXJ.js";import{a as fe}from"./chunk-NZX52M3S.js";import{a as De,c as B}from"./chunk-K35GFLBJ.js";import{e as sn,f as So}from"./chunk-JBNHZ7EW.js";import{h as Fo}from"./chunk-GDQAWT2G.js";import{m as cn}from"./chunk-7HYQ2DGP.js";import{a as Oo}from"./chunk-JHO7RU36.js";import{a as Do,b as We}from"./chunk-PMO2NS5Q.js";import{b as Ho}from"./chunk-EBRJSEEJ.js";import{A as fo,G as go,Ra as ho,Xa as Ao,Z as bo,aa as wo,c as uo,e as mo,i as po}from"./chunk-MSFAPAHB.js";import{G as ln}from"./chunk-ZOKF3EKQ.js";import{g as Wo,i as Bo,j as Mo}from"./chunk-44SDMU5C.js";import{c as Uo}from"./chunk-U7IWD6UB.js";import{a as ge}from"./chunk-7MCLPJAH.js";import{d as Co,f as Eo,h as No,r as To}from"./chunk-YGMRSF47.js";import{a as vo}from"./chunk-GCS2RK7E.js";import{f as yo}from"./chunk-FGAB46RQ.js";import{g as Io}from"./chunk-47ZMUKCZ.js";import{o as ae}from"./chunk-Z62JX42S.js";import{Na as xo,la as lo}from"./chunk-2QHGKEME.js";import{a as ko}from"./chunk-6PA65BO3.js";import{c as ct,e as _o}from"./chunk-EN2WHAVL.js";import{h as tt}from"./chunk-CP2RIMI2.js";import{C as ao,a as ro}from"./chunk-EFOY37CC.js";import{c as Po}from"./chunk-HMTT52FG.js";import{b as pe,c as Wn}from"./chunk-GR7YC6C3.js";import{J as Aa}from"./chunk-O33H5V3V.js";import{$b as io,I as rn,J as oo,ac as so,nc as co,q as no}from"./chunk-COF7YKSN.js";import{A as s,F as Ht,K as $,j as Je,l as $e,o as to}from"./chunk-VZKEX7KP.js";import{H as Ut,I as Te,e as et,o as an}from"./chunk-BJKBO23H.js";import{E as Zn,K as tn,O as nn,W as on,_ as eo,e as Ee,f as $n,va as Ne}from"./chunk-XFTQD4B2.js";import{a as Ze}from"./chunk-2IGQWLAB.js";import{t as re,z as N}from"./chunk-ZFVABNQN.js";import{a as Oe}from"./chunk-4QGZDIBD.js";import{b as D}from"./chunk-73B6GL3S.js";import{b as ha}from"./chunk-Z7PBP7IJ.js";import{f as p,o as c,q as l}from"./chunk-Y5OH3DDZ.js";c();l();var M=p(D()),Yn=p(ae());Ne();$();c();l();var qe=p(D());c();l();var je={root:"_root_3vjsw_1",topRow:"_topRow_3vjsw_8",avatar:"_avatar_3vjsw_13",title:"_title_3vjsw_20",mainContent:"_mainContent_3vjsw_24",textRows:"_textRows_3vjsw_28",textLine1:"_textLine1_3vjsw_33",textLine2:"_textLine2_3vjsw_37"};c();l();var St=p(D());Ne();var sr=o=>{let[e,t]=(0,St.useState)(!1),n=(0,St.useRef)(null);return(0,St.useEffect)(()=>(n.current=setTimeout(()=>{t(!0)},o),()=>{tn(n.current)&&clearTimeout(n.current)}),[]),e};var cr=()=>sr(50)?qe.default.createElement("div",{className:je.root},qe.default.createElement(et.Avatar,{active:!0,size:et.SIZE.md,className:je.avatar,shape:"square"}),qe.default.createElement(et.Input,{active:!0,className:je.title}),qe.default.createElement(et.Input,{active:!0,className:je.mainContent}),qe.default.createElement("div",{className:je.textRows},qe.default.createElement(et.Input,{active:!0,className:je.textLine1}),qe.default.createElement(et.Input,{active:!0,className:je.textLine1}),qe.default.createElement(et.Input,{active:!0,className:je.textLine2}))):null;c();l();var j=p(D()),xt=p(ae()),pn=p(Oe());$();c();l();var lr=p(D()),_r=p(ae());var he=({fn:o,disabled:e})=>{let[t,n]=(0,lr.useState)(!1),a=(0,_r.useMemoizedFn)(async(...i)=>{if(t||e)return null;try{return n(!0),await o(...i)}finally{n(!1)}});return{loading:t,fn:a}};c();l();var un=p(D());c();l();function dr(o,e=1){if(!o||typeof o!="number")return!1;let t=Date.now(),n=24*60*60*1e3*e,a=o-t;return a>0&&a<n}var yt=({teeStatus:o})=>{let{isCreated:e,isActive:t,expiredTimestamp:n}=o,a=e&&!t,i=(0,un.useMemo)(()=>n?dr(n,1):!1,[n]),_=(0,un.useMemo)(()=>n?dr(n,2):!1,[n]);return{avatarStatus:(0,un.useMemo)(()=>t?_?1:0:2,[_,t]),withinOneDay:i,withinExpiringDays:_,isOutdated:a,isCreated:e,expiredTimestamp:n}};c();l();var mn=p(D()),ur=p(Oe());c();l();var Q={"period-sheet":"_period-sheet_1x330_1",periodSheet:"_period-sheet_1x330_1",contents:"_contents_1x330_7",title:"_title_1x330_10",subtitle:"_subtitle_1x330_16","options-container":"_options-container_1x330_23",optionsContainer:"_options-container_1x330_23","option-row":"_option-row_1x330_29",optionRow:"_option-row_1x330_29","option-title":"_option-title_1x330_39",optionTitle:"_option-title_1x330_39","enable-util":"_enable-util_1x330_44",enableUtil:"_enable-util_1x330_44","enable-util-title":"_enable-util-title_1x330_50",enableUtilTitle:"_enable-util-title_1x330_50","enable-util-value":"_enable-util-value_1x330_56",enableUtilValue:"_enable-util-value_1x330_56","confirm-btn":"_confirm-btn_1x330_62",confirmBtn:"_confirm-btn_1x330_62","active-btn":"_active-btn_1x330_67",activeBtn:"_active-btn_1x330_67"};var mr=({label:o,selected:e,value:t,onClick:n})=>mn.default.createElement("div",{className:Q["option-row"],onClick:n,"data-testid":`${B.PERIOD_OPTION}-${t}`},mn.default.createElement("p",{className:Q["option-title"]},o),e?mn.default.createElement(re,{className:(0,ur.default)("okx-wallet-plugin-check"),fontSize:"24px"}):null);var Mn=({visible:o,enableValue:e,expirePeriodOptions:t,shouldShowUpgrade:n,teeStatus:a,needSelectPeriodFirst:i,setEnableValue:_,setVisible:d,onRefresh:m,onEnable:b,onUpgrade:A})=>{let[u,I]=(0,j.useState)(e);(0,j.useEffect)(()=>{!u&&e&&I(e)},[e]),(0,j.useEffect)(()=>{o||I(e)},[o]);let P=(0,j.useMemo)(()=>u?$e.formatDateTime(new Date(Date.now()+u*24*60*60*1e3),{format:Je.SimpleDate}):"",[u]),E=(0,xt.useMemoizedFn)(()=>{u&&_(u)}),{isOutdated:y}=yt({teeStatus:a}),C=(0,xt.useMemoizedFn)(W=>{po({web3wallet_smartaccount_renew_days:W})}),{loading:X,fn:R}=he({fn:(0,xt.useMemoizedFn)(async()=>{if(!!u){if(E(),!i){d(!1);return}C(u),await b({expirePeriodDay:u}),d(!1)}})}),{loading:T,fn:z}=he({fn:(0,xt.useMemoizedFn)(async()=>{if(!!u){if(E(),!i){d(!1);return}C(u),await m({expirePeriodDay:u}),d(!1)}})}),{loading:te,fn:ue}=he({fn:(0,xt.useMemoizedFn)(async()=>{if(!!u){if(E(),!i){d(!1);return}C(u),await A({expirePeriodDay:u}),d(!1)}})}),U;n||y?U=j.default.createElement(N,{className:(0,pn.default)({[Q["confirm-btn"]]:!0,[Q["active-btn"]]:u}),onClick:ue,loading:te,type:N.TYPE.primary,"data-testid":B.PERIOD_CONFIRM_BTN,disabled:!u},s("wallet_extension_btn_general_confirm")):a.isCreated?U=j.default.createElement(N,{className:(0,pn.default)({[Q["confirm-btn"]]:!0,[Q["active-btn"]]:u}),onClick:z,type:N.TYPE.primary,loading:T,"data-testid":B.PERIOD_CONFIRM_BTN,disabled:!u},s("wallet_extension_account_bttmsheet_btn_renew")):U=j.default.createElement(N,{className:(0,pn.default)({[Q["confirm-btn"]]:!0,[Q["active-btn"]]:u}),onClick:R,loading:X,type:N.TYPE.primary,"data-testid":B.PERIOD_CONFIRM_BTN,disabled:!u},s("wallet_extension_btn_general_confirm"));let O,V;return a.isActive?(O=s("wallet_extension_account_bttmsheet_header_renew_sa"),V=s("wallet_extension_account_bttmsheet_label_renew_to")):(O=s("wallet_extension_account_bttmsheet_header_enable_period"),V=s("wallet_extension_account_bttmsheet_label_enable_until")),j.default.createElement(an.Action,{visible:o,onClose:()=>{d(!1)},showBackBtn:!1,hideCloseBtn:!1,mobileMode:!0},j.default.createElement("div",{className:Q["period-sheet"]},j.default.createElement("div",{className:Q.contents},j.default.createElement("p",{className:Q.title},O),j.default.createElement("div",{className:Q["options-container"]},t.map(W=>j.default.createElement(mr,{key:W.value,label:W.label,value:W.value,selected:W.value===u,onClick:()=>{I(W.value)}}))),j.default.createElement("div",{className:Q["enable-util"]},j.default.createElement("span",{className:Q["enable-util-title"]},V),j.default.createElement("span",{className:Q["enable-util-value"]},P))),U))};c();l();var pr=({accountId:o,teeId:e})=>(Vo({teeId:e,accountId:o}),null);c();l();var lt=p(D());var fr=(o,e)=>{let t=(0,lt.useMemo)(()=>o?jo(o):[],[o]),[n,a]=(0,lt.useState)(null);(0,lt.useEffect)(()=>{!o?.defaultExpirePeriodDay||!e||n===null&&a(e.extendExpirePeriodDay||o.defaultExpirePeriodDay||t[0]?.value)},[o,e]);let i=(0,lt.useMemo)(()=>n?t.find(_=>_.value===n)?.label??null:null,[t,n]);return{expirePeriodOptions:t,enableValue:n,displayEnableLabel:i,setEnableValue:a}};c();l();var gr=p(ko());var br=({isFromDex:o,showDelConfirm:e,showWelcome:t,isCreated:n,isCreating:a,isShowPageLoading:i,showUpgradeConfirm:_,upgradeLoading:d,showSelectAccount:m,onUpgradeConfirmBack:b,onDelConfirmBack:A,onSelectAccountBack:u,onClose:I,onBack:P})=>{let C=(0,gr.useHistory)().length>1||e;return{navigatorProps:(()=>{let T;return m?T={closeable:!1,backable:!0,onBack:u}:e?T={closeable:!1,backable:!0,onBack:A}:_?T={closeable:!1,backable:!0,onBack:b}:o||!C?T={backable:!1,closeable:!0,onClose:I,style:{flexDirection:"row-reverse"}}:t||!n?T={backable:!1,closeable:!0,onClose:P,style:{flexDirection:"row-reverse"}}:T={closeable:!1,backable:!0,onBack:P},t||_?{...T,sticky:!0,stickyStyle:{...T.style||{},position:"fixed",backgroundColor:"transparent",zIndex:10},style:{...T.style||{},backgroundColor:"transparent"}}:T})(),hideNavigator:a||i||d}};c();l();var wr=({from:o,actionType:e})=>{let t=o===1 .toString(),n=o===2 .toString(),a=o===4 .toString(),i=t&&e==="enable";return{isFromBanner:a,isFromDex:t,isFromWalletManageCreate:n,isDexEnableAction:i}};c();l();var hr=p(ko()),zt=p(ae());Ne();oo();var ya=ao()===no,Ar=({isFromDex:o,...e})=>{let t=(0,hr.useHistory)(),n=(0,zt.useMemoizedFn)(()=>{t.replace({search:ar(on(e,"from"))})}),a=(0,zt.useMemoizedFn)(()=>{t.replace({pathname:vo})}),i=(0,zt.useMemoizedFn)(()=>{t.goBack()}),_=(0,zt.useMemoizedFn)(()=>{if(o&&ya){globalThis.platform.closeCurrentWindow();return}i()});return{removeQueryFrom:n,handleExtensionClose:a,handleExtensionBack:i,handlePlatformBack:_}};c();l();var Ke=p(D()),se=p(ae());Ne();$();c();l();var xa=o=>new Promise(e=>{setTimeout(()=>{e()},o)}),fn=xa;_o();Wn();c();l();Wn();Aa();c();l();var ot=p(D());c();l();var nt={"info-dialog":"_info-dialog_wocv6_1",infoDialog:"_info-dialog_wocv6_1","body-content":"_body-content_wocv6_4",bodyContent:"_body-content_wocv6_4",title:"_title_wocv6_7",subtitle:"_subtitle_wocv6_13",footer:"_footer_wocv6_19","confirm-btn":"_confirm-btn_wocv6_24",confirmBtn:"_confirm-btn_wocv6_24","cancel-btn":"_cancel-btn_wocv6_36",cancelBtn:"_cancel-btn_wocv6_36"};var rt=({title:o,subTitle:e,confirmText:t,cancelText:n,onConfirm:a,onCancel:i,..._})=>{let d=an.show({hideCloseBtn:!0,..._,title:null,subTitle:null,footer:null,isShowHeader:!1,noContentPadding:!0,windowStyle:{backgroundColor:"var(--okd-color-background-surface-primary)"},maskClosable:!1,children:ot.default.createElement("div",{className:nt["info-dialog"]},ot.default.createElement("div",{className:nt["body-content"]},ot.default.createElement("p",{className:nt.title},o),ot.default.createElement("p",{className:nt.subtitle},e)),ot.default.createElement("div",{className:nt.footer},n?ot.default.createElement("div",{className:nt["cancel-btn"],onClick:i},n):null,ot.default.createElement("div",{className:nt["confirm-btn"],onClick:()=>{a?.(d)}},t)))});return d};c();l();var Sr=p(D());var yr=({accountId:o,supportedChainIndexList:e=[]})=>{let t=Uo(o),n=Ho({chainId:e},o),{accountMap:a}=t;return(0,Sr.useMemo)(()=>n.map(_=>({address:a[_.chain],chainId:_.chainId})).filter(Boolean),[a,n])};c();l();Ne();$();_o();c();l();Ne();c();l();var r;function Vt(o){let e=r.__externref_table_alloc();return r.__wbindgen_export_2.set(e,o),e}function vt(o,e){try{return o.apply(this,e)}catch(t){let n=Vt(t);r.__wbindgen_exn_store(n)}}var Er=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&Er.decode();var jt=null;function qt(){return(jt===null||jt.byteLength===0)&&(jt=new Uint8Array(r.memory.buffer)),jt}function H(o,e){return o=o>>>0,Er.decode(qt().subarray(o,o+e))}function va(o,e){return o=o>>>0,qt().subarray(o/1,o/1+e)}var h=0,gn=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},Ia=typeof gn.encodeInto=="function"?function(o,e){return gn.encodeInto(o,e)}:function(o,e){let t=gn.encode(o);return e.set(t),{read:o.length,written:t.length}};function S(o,e,t){if(t===void 0){let d=gn.encode(o),m=e(d.length,1)>>>0;return qt().subarray(m,m+d.length).set(d),h=d.length,m}let n=o.length,a=e(n,1)>>>0,i=qt(),_=0;for(;_<n;_++){let d=o.charCodeAt(_);if(d>127)break;i[a+_]=d}if(_!==n){_!==0&&(o=o.slice(_)),a=t(a,n,n=_+o.length*3,1)>>>0;let d=qt().subarray(a+_,a+n),m=Ia(o,d);_+=m.written,a=t(a,n,_,1)>>>0}return h=_,a}var _t=null;function xr(){return(_t===null||_t.buffer.detached===!0||_t.buffer.detached===void 0&&_t.buffer!==r.memory.buffer)&&(_t=new DataView(r.memory.buffer)),_t}function Ae(o){return o==null}function Nr(o,e){let t=S(o,r.__wbindgen_malloc,r.__wbindgen_realloc),n=h,a=S(e,r.__wbindgen_malloc,r.__wbindgen_realloc),i=h,_=r.newHpkeKeyPairFromSeedExtract(t,n,a,i);return Qt.__wrap(_)}function Tr(o,e,t,n){let a=S(o,r.__wbindgen_malloc,r.__wbindgen_realloc),i=h,_=S(e,r.__wbindgen_malloc,r.__wbindgen_realloc),d=h,m=S(t,r.__wbindgen_malloc,r.__wbindgen_realloc),b=h,A=S(n,r.__wbindgen_malloc,r.__wbindgen_realloc),u=h,I=r.hpkeSeal(a,i,_,d,m,b,A,u);return Xt.__wrap(I)}function Dr(o,e,t,n,a){let i=S(o,r.__wbindgen_malloc,r.__wbindgen_realloc),_=h,d=S(e,r.__wbindgen_malloc,r.__wbindgen_realloc),m=h,b=S(t,r.__wbindgen_malloc,r.__wbindgen_realloc),A=h,u=S(n,r.__wbindgen_malloc,r.__wbindgen_realloc),I=h,P=S(a,r.__wbindgen_malloc,r.__wbindgen_realloc),E=h,y=r.hpkeOpen(i,_,d,m,b,A,u,I,P,E);return Yt.__wrap(y)}function Lr(o,e){let t,n;try{let a=S(o,r.__wbindgen_malloc,r.__wbindgen_realloc),i=h,_=S(e,r.__wbindgen_malloc,r.__wbindgen_realloc),d=h,m=r.rsaPemEncryptChunks(a,i,_,d);return t=m[0],n=m[1],H(m[0],m[1])}finally{r.__wbindgen_free(t,n,1)}}function Fr(o,e,t){let n=S(o,r.__wbindgen_malloc,r.__wbindgen_realloc),a=h,i=S(e,r.__wbindgen_malloc,r.__wbindgen_realloc),_=h,d=S(t,r.__wbindgen_malloc,r.__wbindgen_realloc),m=h;return r.rsaPemVerify(n,a,i,_,d,m)!==0}function ka(o,e){if(!(o instanceof e))throw new Error(`expected instance of ${e.name}`)}function Or(o,e){let t=S(o,r.__wbindgen_malloc,r.__wbindgen_realloc),n=h;ka(e,at);var a=e.__destroy_into_raw();let i=r.parseAndValidateAttestationDoc(t,n,a);return Gt.__wrap(i)}function Wr(o,e,t,n,a,i,_,d){let m=S(n,r.__wbindgen_malloc,r.__wbindgen_realloc),b=h,A=S(a,r.__wbindgen_malloc,r.__wbindgen_realloc),u=h,I=S(i,r.__wbindgen_malloc,r.__wbindgen_realloc),P=h,E=S(_,r.__wbindgen_malloc,r.__wbindgen_realloc),y=h,C=r.argon2id_hash(o,e,t,m,b,A,u,I,P,E,y,d);return Kt.__wrap(C)}var vr=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(o=>r.__wbg_argon2idresult_free(o>>>0,1)),Kt=class{static __wrap(e){e=e>>>0;let t=Object.create(Kt.prototype);return t.__wbg_ptr=e,vr.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,vr.unregister(this),e}free(){let e=this.__destroy_into_raw();r.__wbg_argon2idresult_free(e,0)}get succ(){return r.__wbg_get_argon2idresult_succ(this.__wbg_ptr)!==0}set succ(e){r.__wbg_set_argon2idresult_succ(this.__wbg_ptr,e)}get errMsg(){let e,t;try{let n=r.__wbg_get_argon2idresult_errMsg(this.__wbg_ptr);return e=n[0],t=n[1],H(n[0],n[1])}finally{r.__wbindgen_free(e,t,1)}}set errMsg(e){let t=S(e,r.__wbindgen_malloc,r.__wbindgen_realloc),n=h;r.__wbg_set_argon2idresult_errMsg(this.__wbg_ptr,t,n)}get hashHex(){let e,t;try{let n=r.__wbg_get_argon2idresult_hashHex(this.__wbg_ptr);return e=n[0],t=n[1],H(n[0],n[1])}finally{r.__wbindgen_free(e,t,1)}}set hashHex(e){let t=S(e,r.__wbindgen_malloc,r.__wbindgen_realloc),n=h;r.__wbg_set_argon2idresult_hashHex(this.__wbg_ptr,t,n)}},Ir=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(o=>r.__wbg_docparsingresult_free(o>>>0,1)),Gt=class{static __wrap(e){e=e>>>0;let t=Object.create(Gt.prototype);return t.__wbg_ptr=e,Ir.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,Ir.unregister(this),e}free(){let e=this.__destroy_into_raw();r.__wbg_docparsingresult_free(e,0)}get valid(){return r.__wbg_get_docparsingresult_valid(this.__wbg_ptr)!==0}set valid(e){r.__wbg_set_docparsingresult_valid(this.__wbg_ptr,e)}get pubkeyHex(){let e,t;try{let n=r.__wbg_get_docparsingresult_pubkeyHex(this.__wbg_ptr);return e=n[0],t=n[1],H(n[0],n[1])}finally{r.__wbindgen_free(e,t,1)}}set pubkeyHex(e){let t=S(e,r.__wbindgen_malloc,r.__wbindgen_realloc),n=h;r.__wbg_set_docparsingresult_pubkeyHex(this.__wbg_ptr,t,n)}get userDataHex(){let e,t;try{let n=r.__wbg_get_docparsingresult_userDataHex(this.__wbg_ptr);return e=n[0],t=n[1],H(n[0],n[1])}finally{r.__wbindgen_free(e,t,1)}}set userDataHex(e){let t=S(e,r.__wbindgen_malloc,r.__wbindgen_realloc),n=h;r.__wbg_set_docparsingresult_userDataHex(this.__wbg_ptr,t,n)}get nonceHex(){let e,t;try{let n=r.__wbg_get_docparsingresult_nonceHex(this.__wbg_ptr);return e=n[0],t=n[1],H(n[0],n[1])}finally{r.__wbindgen_free(e,t,1)}}set nonceHex(e){let t=S(e,r.__wbindgen_malloc,r.__wbindgen_realloc),n=h;r.__wbg_set_docparsingresult_nonceHex(this.__wbg_ptr,t,n)}get pcr0Hex(){let e,t;try{let n=r.__wbg_get_docparsingresult_pcr0Hex(this.__wbg_ptr);return e=n[0],t=n[1],H(n[0],n[1])}finally{r.__wbindgen_free(e,t,1)}}set pcr0Hex(e){let t=S(e,r.__wbindgen_malloc,r.__wbindgen_realloc),n=h;r.__wbg_set_docparsingresult_pcr0Hex(this.__wbg_ptr,t,n)}},kr=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(o=>r.__wbg_hpkekeypair_free(o>>>0,1)),Qt=class{static __wrap(e){e=e>>>0;let t=Object.create(Qt.prototype);return t.__wbg_ptr=e,kr.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,kr.unregister(this),e}free(){let e=this.__destroy_into_raw();r.__wbg_hpkekeypair_free(e,0)}get pkHex(){let e,t;try{let n=r.__wbg_get_hpkekeypair_pkHex(this.__wbg_ptr);return e=n[0],t=n[1],H(n[0],n[1])}finally{r.__wbindgen_free(e,t,1)}}set pkHex(e){let t=S(e,r.__wbindgen_malloc,r.__wbindgen_realloc),n=h;r.__wbg_set_hpkekeypair_pkHex(this.__wbg_ptr,t,n)}get skHex(){let e,t;try{let n=r.__wbg_get_hpkekeypair_skHex(this.__wbg_ptr);return e=n[0],t=n[1],H(n[0],n[1])}finally{r.__wbindgen_free(e,t,1)}}set skHex(e){let t=S(e,r.__wbindgen_malloc,r.__wbindgen_realloc),n=h;r.__wbg_set_hpkekeypair_skHex(this.__wbg_ptr,t,n)}},Pr=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(o=>r.__wbg_hpkeopenresult_free(o>>>0,1)),Yt=class{static __wrap(e){e=e>>>0;let t=Object.create(Yt.prototype);return t.__wbg_ptr=e,Pr.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,Pr.unregister(this),e}free(){let e=this.__destroy_into_raw();r.__wbg_hpkeopenresult_free(e,0)}get succ(){return r.__wbg_get_hpkeopenresult_succ(this.__wbg_ptr)!==0}set succ(e){r.__wbg_set_hpkeopenresult_succ(this.__wbg_ptr,e)}get errMsg(){let e,t;try{let n=r.__wbg_get_hpkeopenresult_errMsg(this.__wbg_ptr);return e=n[0],t=n[1],H(n[0],n[1])}finally{r.__wbindgen_free(e,t,1)}}set errMsg(e){let t=S(e,r.__wbindgen_malloc,r.__wbindgen_realloc),n=h;r.__wbg_set_hpkekeypair_pkHex(this.__wbg_ptr,t,n)}get plaintextHex(){let e,t;try{let n=r.__wbg_get_hpkeopenresult_plaintextHex(this.__wbg_ptr);return e=n[0],t=n[1],H(n[0],n[1])}finally{r.__wbindgen_free(e,t,1)}}set plaintextHex(e){let t=S(e,r.__wbindgen_malloc,r.__wbindgen_realloc),n=h;r.__wbg_set_hpkekeypair_skHex(this.__wbg_ptr,t,n)}},Fs=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(o=>r.__wbg_hpkepkresult_free(o>>>0,1));var Cr=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(o=>r.__wbg_hpkesealresult_free(o>>>0,1)),Xt=class{static __wrap(e){e=e>>>0;let t=Object.create(Xt.prototype);return t.__wbg_ptr=e,Cr.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,Cr.unregister(this),e}free(){let e=this.__destroy_into_raw();r.__wbg_hpkesealresult_free(e,0)}get succ(){return r.__wbg_get_hpkesealresult_succ(this.__wbg_ptr)!==0}set succ(e){r.__wbg_set_hpkesealresult_succ(this.__wbg_ptr,e)}get errMsg(){let e,t;try{let n=r.__wbg_get_hpkesealresult_errMsg(this.__wbg_ptr);return e=n[0],t=n[1],H(n[0],n[1])}finally{r.__wbindgen_free(e,t,1)}}set errMsg(e){let t=S(e,r.__wbindgen_malloc,r.__wbindgen_realloc),n=h;r.__wbg_set_hpkekeypair_pkHex(this.__wbg_ptr,t,n)}get ciphertextHex(){let e,t;try{let n=r.__wbg_get_hpkesealresult_ciphertextHex(this.__wbg_ptr);return e=n[0],t=n[1],H(n[0],n[1])}finally{r.__wbindgen_free(e,t,1)}}set ciphertextHex(e){let t=S(e,r.__wbindgen_malloc,r.__wbindgen_realloc),n=h;r.__wbg_set_hpkekeypair_skHex(this.__wbg_ptr,t,n)}get encapKeyHex(){let e,t;try{let n=r.__wbg_get_hpkesealresult_encapKeyHex(this.__wbg_ptr);return e=n[0],t=n[1],H(n[0],n[1])}finally{r.__wbindgen_free(e,t,1)}}set encapKeyHex(e){let t=S(e,r.__wbindgen_malloc,r.__wbindgen_realloc),n=h;r.__wbg_set_hpkesealresult_encapKeyHex(this.__wbg_ptr,t,n)}},Hn=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(o=>r.__wbg_jspcrhexes_free(o>>>0,1)),at=class{static __wrap(e){e=e>>>0;let t=Object.create(at.prototype);return t.__wbg_ptr=e,Hn.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,Hn.unregister(this),e}free(){let e=this.__destroy_into_raw();r.__wbg_jspcrhexes_free(e,0)}get pcr0Hex(){let e=r.__wbg_get_jspcrhexes_pcr0Hex(this.__wbg_ptr),t;return e[0]!==0&&(t=H(e[0],e[1]).slice(),r.__wbindgen_free(e[0],e[1]*1,1)),t}set pcr0Hex(e){var t=Ae(e)?0:S(e,r.__wbindgen_malloc,r.__wbindgen_realloc),n=h;r.__wbg_set_jspcrhexes_pcr0Hex(this.__wbg_ptr,t,n)}get pcr1Hex(){let e=r.__wbg_get_jspcrhexes_pcr1Hex(this.__wbg_ptr),t;return e[0]!==0&&(t=H(e[0],e[1]).slice(),r.__wbindgen_free(e[0],e[1]*1,1)),t}set pcr1Hex(e){var t=Ae(e)?0:S(e,r.__wbindgen_malloc,r.__wbindgen_realloc),n=h;r.__wbg_set_jspcrhexes_pcr1Hex(this.__wbg_ptr,t,n)}get pcr2Hex(){let e=r.__wbg_get_jspcrhexes_pcr2Hex(this.__wbg_ptr),t;return e[0]!==0&&(t=H(e[0],e[1]).slice(),r.__wbindgen_free(e[0],e[1]*1,1)),t}set pcr2Hex(e){var t=Ae(e)?0:S(e,r.__wbindgen_malloc,r.__wbindgen_realloc),n=h;r.__wbg_set_jspcrhexes_pcr2Hex(this.__wbg_ptr,t,n)}get pcr8Hex(){let e=r.__wbg_get_jspcrhexes_pcr8Hex(this.__wbg_ptr),t;return e[0]!==0&&(t=H(e[0],e[1]).slice(),r.__wbindgen_free(e[0],e[1]*1,1)),t}set pcr8Hex(e){var t=Ae(e)?0:S(e,r.__wbindgen_malloc,r.__wbindgen_realloc),n=h;r.__wbg_set_jspcrhexes_pcr8Hex(this.__wbg_ptr,t,n)}constructor(e,t,n,a){var i=Ae(e)?0:S(e,r.__wbindgen_malloc,r.__wbindgen_realloc),_=h,d=Ae(t)?0:S(t,r.__wbindgen_malloc,r.__wbindgen_realloc),m=h,b=Ae(n)?0:S(n,r.__wbindgen_malloc,r.__wbindgen_realloc),A=h,u=Ae(a)?0:S(a,r.__wbindgen_malloc,r.__wbindgen_realloc),I=h;let P=r.jspcrhexes_new(i,_,d,m,b,A,u,I);return this.__wbg_ptr=P>>>0,Hn.register(this,this.__wbg_ptr,this),this}static empty(){let e=r.jspcrhexes_empty();return at.__wrap(e)}};async function Pa(o,e){if(typeof Response=="function"&&o instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(o,e)}catch(n){if(o.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",n);else throw n}let t=await o.arrayBuffer();return await WebAssembly.instantiate(t,e)}else{let t=await WebAssembly.instantiate(o,e);return t instanceof WebAssembly.Instance?{instance:t,module:o}:t}}function Br(){let o={};return o.wbg={},o.wbg.__wbg_buffer_609cc3eee51ed158=function(e){return e.buffer},o.wbg.__wbg_call_672a4d21634d4a24=function(){return vt(function(e,t){return e.call(t)},arguments)},o.wbg.__wbg_call_7cccdd69e0791ae2=function(){return vt(function(e,t,n){return e.call(t,n)},arguments)},o.wbg.__wbg_crypto_574e78ad8b13b65f=function(e){return e.crypto},o.wbg.__wbg_error_2668c8a93bdcea89=function(e,t){console.error(H(e,t))},o.wbg.__wbg_error_7534b8e9a36f1ab4=function(e,t){let n,a;try{n=e,a=t,console.error(H(e,t))}finally{r.__wbindgen_free(n,a,1)}},o.wbg.__wbg_getRandomValues_3c9c0d586e575a16=function(){return vt(function(e,t){globalThis.crypto.getRandomValues(va(e,t))},arguments)},o.wbg.__wbg_getRandomValues_b8f5dbd5f3995a9e=function(){return vt(function(e,t){e.getRandomValues(t)},arguments)},o.wbg.__wbg_msCrypto_a61aeb35a24c1329=function(e){return e.msCrypto},o.wbg.__wbg_new_8a6f238a6ece86ea=function(){return new Error},o.wbg.__wbg_new_a12002a7f91c75be=function(e){return new Uint8Array(e)},o.wbg.__wbg_newnoargs_105ed471475aaf50=function(e,t){return new Function(H(e,t))},o.wbg.__wbg_newwithbyteoffsetandlength_d97e637ebe145a9a=function(e,t,n){return new Uint8Array(e,t>>>0,n>>>0)},o.wbg.__wbg_newwithlength_a381634e90c276d4=function(e){return new Uint8Array(e>>>0)},o.wbg.__wbg_node_905d3e251edff8a2=function(e){return e.node},o.wbg.__wbg_now_d2e63c3e978c7ede=function(){return Date.now()},o.wbg.__wbg_process_dc0fbacc7c1c06f7=function(e){return e.process},o.wbg.__wbg_randomFillSync_ac0988aba3254290=function(){return vt(function(e,t){e.randomFillSync(t)},arguments)},o.wbg.__wbg_require_60cc747a6bc5215a=function(){return vt(function(){return module.require},arguments)},o.wbg.__wbg_set_65595bdd868b3009=function(e,t,n){e.set(t,n>>>0)},o.wbg.__wbg_stack_0ed75d68575b0f3c=function(e,t){let n=t.stack,a=S(n,r.__wbindgen_malloc,r.__wbindgen_realloc),i=h;xr().setInt32(e+4*1,i,!0),xr().setInt32(e+4*0,a,!0)},o.wbg.__wbg_static_accessor_GLOBAL_88a902d13a557d07=function(){let e=typeof globalThis>"u"?null:globalThis;return Ae(e)?0:Vt(e)},o.wbg.__wbg_static_accessor_GLOBAL_THIS_56578be7e9f832b0=function(){let e=typeof globalThis>"u"?null:globalThis;return Ae(e)?0:Vt(e)},o.wbg.__wbg_static_accessor_SELF_37c5d418e4bf5819=function(){let e=typeof self>"u"?null:self;return Ae(e)?0:Vt(e)},o.wbg.__wbg_static_accessor_WINDOW_5de37043a91a9c40=function(){let e=typeof window>"u"?null:window;return Ae(e)?0:Vt(e)},o.wbg.__wbg_subarray_aa9065fa9dc5df96=function(e,t,n){return e.subarray(t>>>0,n>>>0)},o.wbg.__wbg_versions_c01dfd4722a88165=function(e){return e.versions},o.wbg.__wbindgen_init_externref_table=function(){let e=r.__wbindgen_export_2,t=e.grow(4);e.set(0,void 0),e.set(t+0,void 0),e.set(t+1,null),e.set(t+2,!0),e.set(t+3,!1)},o.wbg.__wbindgen_is_function=function(e){return typeof e=="function"},o.wbg.__wbindgen_is_object=function(e){let t=e;return typeof t=="object"&&t!==null},o.wbg.__wbindgen_is_string=function(e){return typeof e=="string"},o.wbg.__wbindgen_is_undefined=function(e){return e===void 0},o.wbg.__wbindgen_memory=function(){return r.memory},o.wbg.__wbindgen_string_new=function(e,t){return H(e,t)},o.wbg.__wbindgen_throw=function(e,t){throw new Error(H(e,t))},o}function Mr(o,e){return r=o.exports,Ca.__wbindgen_wasm_module=e,_t=null,jt=null,r.__wbindgen_start(),r}function Hr(o){if(r!==void 0)return r;typeof o<"u"&&(Object.getPrototypeOf(o)===Object.prototype?{module:o}=o:console.warn("using deprecated parameters for `initSync()`; pass a single object instead"));let e=Br();o instanceof WebAssembly.Module||(o=new WebAssembly.Module(o));let t=new WebAssembly.Instance(o,e);return Mr(t,o)}async function Ca(o){if(r!==void 0)return r;typeof o<"u"&&(Object.getPrototypeOf(o)===Object.prototype?{module_or_path:o}=o:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof o>"u"&&(o=new URL("index_bg.wasm",import.meta.url));let e=Br();(typeof o=="string"||typeof Request=="function"&&o instanceof Request||typeof URL=="function"&&o instanceof URL)&&(o=fetch(o));let{instance:t,module:n}=await Pa(await o,e);return Mr(t,n)}c();l();var bn=()=>({v1:`-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAlYEjT/0eL0aqRBPfwjDi
GDJSRqljSV+f7cawC8czRuJRaRS32sab6JRb/7cNpkID1zuI68g9xQ+4khy6v/iA
7kFqPhsafOXzJO31lJe9+eU7BR6QA1emwsrWsLvhv+UST+0E4kf72OzHhoowe7eI
bcuy3D7Mh8ORbc6bQSZyHYfdfQng0sZ7Ovx3DUKnVHnL65ghOq7sz5lIPOoyRLVt
/aWDV9deGqg+K4zBdQaVlSRSX2dpGXXc2GJ2bIOa/vaxLorX9T7k/aMiK9eIB5Pu
Do6820ZA3BgMlsIRPzazFImt/mO9DnVLfiVl40K34YqOl80RnqsMIfnwyWJX5n/S
lQIDAQAB
-----END PUBLIC KEY-----`,v2:`-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAoKEJQAzgV+XbBLvQqlVj
yqci4h/Qlp2+Lfi/RfVoFmaURcuJDArN6GBMQl6z033K3AxVzLtn7hx00UzlJC1b
g49nDVd+filR57uxB3OVoBN7nA6rewbkF2WOYboSTQwojiJbIdcIdkhRjiPnEy1I
7c0JZqfZ8PFFaagHcgxUcVzGe930kTK36X/6ofXw0Qqq81W4xhKNBQd2xQ33TgQX
TW5NCtmDloYmOrpaj1RvEevVGgBR5uhG1pntnsoGWc11NoIvczmDzYMCrICyb8Bu
bUbtLgPGvPuYgW3SbAF5yIO3LRqMZRScd1sTn/QL4PVzySglcMgqFNSVQ6LYzEpR
wQIDAQAB
-----END PUBLIC KEY-----`});c();l();Ne();Wn();var Ur="0x",Rr=()=>fetch("/static/tee-sdk.wasm").then(e=>e.arrayBuffer()),zr=async()=>Do(pe.postSAAttestation,{method:"POST",params:{frontendPubkeyVersionList:Object.keys(bn()).join($o)}}),Vr=o=>{let e=Zn(o)?o:JSON.stringify(o);if(e.startsWith(Ur))return e;let n=new TextEncoder().encode(e),a="";for(let i=0;i<n.length;i++){let _=n[i].toString(16).padStart(2,"0");a+=_}return`${Ur}${a}`};var Un,Rn=bn(),It=class{constructor(e){this.ARGON_2_ID_VARIABLES={mem_cost_kb:32,iteration:4,parallism:1,assoc_data_key_of_passcode:"tee-wallet-passcode-hash",assoc_data_key_of_hype_pair:"tee-wallet-hpke-pair-hash",app_public_salt:"tee-wallet-argon-2-id",hash_len:32};this.SmartAccountSalt="OKX-TEE-WALLET-IDENTITY";this.ready=!1;this.receiverPk="";this.publickeyVersion="v2";this.initPromise=this.initialize(),e?.attestation&&this.parseAndValidateAttestationDoc(e.attestation).then(t=>{this.receiverPk=t}).catch(()=>{})}static getInstance(e){return nn(Un)&&(Un=new It(e)),Un}async initialize(){try{if(this.initPromise)return await this.initPromise;let e=await Rr();return Hr({module:e})}catch{throw new Error(De.INITIALIZE_FAILED)}finally{this.ready=!0}}async parseAndValidateAttestationDoc(e){this.ready||await this.initPromise;let t=e.trim(),{valid:n,userDataHex:a}=Or(t,at.empty());if(!n)throw new Error(De.PARSE_ATTESTATION_FAILED);return a}toHex(e){return Vr(e)}async rawIntoHashHex(e,t,n){return this.ready||await this.initPromise,Wr(this.ARGON_2_ID_VARIABLES.mem_cost_kb,this.ARGON_2_ID_VARIABLES.iteration,this.ARGON_2_ID_VARIABLES.parallism,this.toHex(n),this.toHex(e),this.toHex(t),this.toHex(this.ARGON_2_ID_VARIABLES.app_public_salt),this.ARGON_2_ID_VARIABLES.hash_len).hashHex}async generateHpkeKeyPairByPrivateKey(e){return this.ready||await this.initPromise,Nr(e,this.SmartAccountSalt)}async hpkeSeal({cipherHex:e,adHex:t,receiverHpkePk:n,senderSk:a}){return this.ready||await this.initPromise,Tr(e,t,n,a??"")}async hpkeOpen(...e){return this.ready||await this.initPromise,Dr(...e)}async encryptWithRSA(e){this.ready||await this.initPromise;let t=Rn[this.publickeyVersion];return Lr(t,e)}async initializeAttestationDoc(e){if(!this.receiverPk){let t,n,a;if(e&&e.signData&&e.backendSignature&&e.frontendPubkeyVersionSelected)t=e.signData,n=e.backendSignature,a=e.frontendPubkeyVersionSelected;else{let d=await zr();if(!d?.data)throw new Error(De.FETCH_ATTESTATION_FAILED);t=d.data.signData,n=d.data.backendSignature,a=d.data.frontendPubkeyVersionSelected}if(!Rn[a])throw new Error(De.RSA_PEM_VERSION_NOT_SUPPORTED);let i=Rn[a];if(!Fr(i,t,n))throw new Error(De.RSA_PEM_VERIFY_FAILED);this.receiverPk=await this.parseAndValidateAttestationDoc(t),this.publickeyVersion=a}return this.receiverPk}async sealData(e){let t=await this.initializeAttestationDoc(),n=this.toHex(e.adData),a=await this.hpkeSeal({cipherHex:this.toHex(e.cipherData),adHex:n,receiverHpkePk:t});return{ciphertextHex:a.ciphertextHex,encapKeyHex:a.encapKeyHex,adHex:n}}async openData(e){return this.hpkeOpen(e.cipherHex,e.associatedDataHex,e.encapKeyHex,e.receiver_sk_hex,e.hpkeSk)}};var zn,kt=class{constructor(){this.hpkeService=It.getInstance()}static getInstance(){return nn(zn)&&(zn=new kt),zn}async reverifyWalletPublicKeyStatus(e){let t=await ct().getWalletTypeCreated(e),[n,a]=await Ht(ct().verifyWalletPublicKeyStatus({walletId:e,walletType:t}));if(n||!a?.success){Z("_REVERIFY_WALLET_PUBLIC_KEY_STATUS_FAILED",{error:n,params:{accountId:e,walletType:t}});let i=a?.err?.msg||a?.err?.error_message;if(i)return Ut.error({key:i,title:i,duration:fe,placement:Ut.DIRECTION.top}),{success:!1,hideToast:!0}}return{success:Boolean(a?.success),hideToast:!1}}async prepareEnableSARequest(e,t,n,a){let{accountId:i,teeId:_,expirePeriodDay:d,currentExpiredTimestamp:m}=e,b=a.supportChainIndexList,[A,u]=await Ht(ct().getSAKeyPair(e.accountId,b));if(A)throw Z("_GET_PRIVATE_KEY_LIST_FAILED",{error:u,params:{accountId:i}}),A;if(!u)throw new Error(De.NO_PRIVATE_KEY_FOUND);if(!e.forceUpgrade){let O=t.filter(V=>!n.includes(V));if(O.length){Z("_UPLOAD_LESS_CHAIN_INDEX_LIST",{params:{uploadedChainIndexList:t,currentChainIndexList:n,accountId:i,teeId:_}});let V=O.map(J=>a.chainNameMapping[J]),W;V.length<=5?W=V.join(","):W=`${V.slice(0,5).join(",")}...`;let ye=new Error(W);throw ye.name=De.CHAIN_INDEX_NOT_SUPPORTED,ye}}let I=u.pair,P=await this.hpkeService.initializeAttestationDoc(),E=Date.now(),y;d===null&&m?y=m:y=E+(d??15)*24*60*60*1e3;let C={teeId:_,teeType:1,identityPKHex:I.pkHex,expiredTimestamp:y,timestamp:E,command:"upgradeTee"},X=u.privateKeyListHex,R=this.hpkeService.toHex(C),T,z,te;try{let O=await this.hpkeService.hpkeSeal({cipherHex:X,adHex:R,receiverHpkePk:P,senderSk:I.skHex});T=O.encapKeyHex,z=O.ciphertextHex,te=await this.hpkeService.encryptWithRSA(z)}catch(O){throw Z("_HPKE_SEAL_FAILED",{error:O,params:{accountId:i,teeId:_}}),O}return{reqParams:{teeId:_,accountId:i,timestamp:E,expireTimestamp:y,chainIndexList:b,hpkeInfo:{AD:R,encapsulatedKey:T,ciphertext:te}},openData:async({ciphertext:O,encapsulatedKey:V,ad:W})=>this.hpkeService.hpkeOpen(O,W,V,I.skHex,P)}}async prepareEnableSASignature(e,t,n){let a={accountId:e.accountId,teeId:e.teeId,timestamp:e.timestamp,command:"upgradeTee",chainIndexList:e.chainIndexList,hpkeInfoHash:qo(e.hpkeInfo)},[i,_]=await Ht(_n(t,a,n));if(i)throw Z("_SIGN_TEE_FAILED",{error:i,params:on(a,"hpkeInfoHash")}),i;return{signatureBase64:_,signatureMetaData:a}}async prepareRemoveSARequest(e,t){let{walletId:n,teeId:a}=t,i=Date.now(),_={teeId:a,timestamp:i,command:"removeTee"},d=JSON.stringify(_),[m,b]=await Ht(_n(e,d,t));if(m)throw Z("_SIGN_TEE_DISABLE_FAILED",{error:m,params:_}),m;return{accountId:n,teeRequest:{payload:d,signature:b}}}async prepareExtendSARequest(e,t,n){let{walletId:a,teeId:i}=t,_=Date.now(),d={teeId:i,timestamp:_,command:"extendTee",expiredTimestamp:_+n*24*60*60*1e3},m=await _n(e,d,t);return{requestList:[{accountId:a,payload:JSON.stringify(d),signature:m}]}}async notifyAccountsChanged(e){let{walletIdentity:t}=e,n=ct(),a=await n.getState(),i=Wo({metamask:a},t.walletId).filter(_=>!(!_.isOkx||Bo({metamask:a},_.origin)!==t.walletId));!i.length||i.forEach(_=>{n.notifyAccountsChanged(_.origin,[t.walletId])})}};var it=kt.getInstance(),jr=({isFromDex:o,isSmartAccountActivatedOnce:e,walletIdentity:t,showWelcome:n,isValidating:a,walletCreated:i,createWalletName:_,requestUpgrade:d,showUpgradeConfirm:m,markActivated:b,setShowWelcome:A,setIsCreating:u,setIsValidating:I,handlePlatformBack:P,handleToastTeeNetError:E,setShowEnableDone:y,handleToastReEnableSuccess:C,handleToastReactivateOrders:X,onReenableSuccess:R,onDisableSuccess:T,handleToastExtendSuccess:z,onExtendSuccess:te,handleToastAccountAddedAndEnabled:ue,handleToastSAEnableFailed:U,handleToastReEnableFailed:O,handleToastExtendFailed:V,handleToastTeeMaintenance:W,handleAutoConnectDapp:ye})=>{let{data:J,runAsync:xe}=We(pe.getSATeeMetadata,{catchMode:"toastAll"},{cacheKey:Lo,staleTime:1e3,cacheTime:-1,onError(f){Z("_GET_SA_METADATA_FAILED",{error:f,params:{teeId:t?.teeId,accountId:t?.walletId}})},manual:!0,refreshOnWindowFocus:!1}),ve=J?.data??null,{data:me,runAsync:Ie}=We(pe.getSATeeStatus,{catchMode:"toastAll"},{cacheKey:Yo(t?.walletId),staleTime:1e3,cacheTime:-1,manual:!0,refreshOnWindowFocus:!1,ready:Boolean(t?.teeId&&t.walletId),onError(f,[k]){Z("_GET_TEE_STATUS_FAILED",{params:{teeId:k.teeId,accountId:k.accountId},error:f})},onSuccess(f){!f?.data||(f.data.teeStatus.isCreated&&(e||setTimeout(()=>{b()}),n&&A(!1)),a&&i&&f?.data?.teeStatus.isCreated&&(ue(_,f.data.teeStatus.isActive),P()))}}),Ue=(0,se.useMemoizedFn)(()=>{if(!t)return null;let{teeId:f,walletId:k}=t;return Ie({teeId:f,accountId:k,eip7702Status:!1,needChainList:!0})}),ne=(0,Ke.useMemo)(()=>me?.data&&me.data.accountId&&me.data.accountId===t?.walletId?me.data.teeStatus:null,[me?.data,t?.walletId]),Re=(0,Ke.useMemo)(()=>me?.data?.chainIndexList??[],[me?.data?.chainIndexList]),Ye=me?.data?.addressVerifyStatus??null,G=ne?.isCreated??!1,{data:ut,runAsync:ke}=We(pe.getSAUpgradeStatus,{catchMode:"toastAll"},{cacheKey:Rt(t?.teeId),staleTime:1e3,cacheTime:-1,manual:!0,refreshOnWindowFocus:!1,onError(f){Z("_GET_TEE_UPGRADE_STATUS_FAILED",{params:{teeId:t?.teeId,accountId:t?.walletId},error:f})}}),oe=ut?.data?.upgradeStatus??null,Tt=(0,se.useMemoizedFn)(async()=>t?.teeId?ke({teeId:t.teeId}):null),Pe=(0,se.useMemoizedFn)(async f=>{let[k,K,_e]=await Promise.allSettled([xe(),Ue(),f?.skipUpgradeStatus?null:Tt()]);if(K.status==="fulfilled"&&K?.value){let Ve=K.value.data?.teeStatus;if(t?.walletId&&K.value.data?.accountId===t.walletId)try{await ct().updateAccountTeeStatus(t.walletId,Ve)}catch{}}if(!f?.silent){if(k.status==="fulfilled"&&k.value?.data?.isTeeServiceMaintenance){W();return}if(k.status==="fulfilled"&&k?.value&&K.status==="fulfilled"&&K?.value&&_e.status==="fulfilled"&&_e?.value){I(!1),u(!1);return}E()}}),mt=(0,se.useMemoizedFn)(async()=>{!t||it.notifyAccountsChanged({walletIdentity:t})}),{data:pt,runAsync:Cn}=We(pe.postSAActivate,{method:"POST",catchMode:"toastAll",config:{walletSignParams:{needXClientSign:!0,walletId:t?.walletId}}},{manual:!0,async onError(f,[k]){Z("_TEE_ACTIVATE_FAILED",{params:{teeId:k.teeId,accountId:k.accountId},error:f}),await Pe({silent:!0})},async onSuccess(f){!f?.data||(b(),y(!0),await Pe({silent:!0,skipUpgradeStatus:!0}),(0,se.clearCache)(Rt(t?.teeId)),mt())}}),Dt=zo({walletId:t?.walletId}),ft=yr({accountId:t?.walletId,supportedChainIndexList:ve?.supportChainIndexList??[]}),gt=(0,Ke.useMemo)(()=>ft.map(f=>f.address),[ft]),bt=(0,Ke.useMemo)(()=>ft.map(f=>f.chainId),[ft]),$t=(0,Ke.useMemo)(()=>!ne||bt.length===0?!1:bt.some(f=>!Re.includes(f)),[Re,bt,ne]),[wt,En]=(0,Ke.useState)(!1),Lt=(0,Ke.useMemo)(()=>!ve?.supportChainIndexList?.length||!ne?.isActive||wt?!1:!!(oe===0||d&&$t),[wt,d,oe,ve?.supportChainIndexList,$t,ne?.isActive]),{data:Zt,runAsync:Nn}=We(pe.postDexStrategyOrderNum,{method:"POST",catchMode:"noToast"},{onError(f,[k]){Z("_POST_DEX_STRATEGY_ORDER_NUM_FAILED",{params:{accountId:k.accountId,walletAddressList:gt,orderStatusList:[4]},error:f})},manual:!0}),Tn=(0,se.useMemoizedFn)(async()=>tn(Zt?.data?.orderNum)?Zt?.data?.orderNum??0:(await Nn({accountId:t?.walletId,walletAddressList:gt,orderStatusList:[4]}))?.data?.orderNum??0),{data:ze}=We(pe.postDexStrategyOrderNum,{params:{accountId:t?.walletId,walletAddressList:gt,orderStatusList:[-3,0,2,3,4]},method:"POST",catchMode:"noToast"},{ready:Boolean(t?.walletId&&gt.length)}),le=ze?.data?.orderNum??0,ht=(0,se.useMemoizedFn)(async f=>{if(!ve||!ne||!t)throw new Error("impossible to reach");if(Ye?.isVerify===!1){let{success:Xe,hideToast:Bt}=await it.reverifyWalletPublicKeyStatus(t.walletId);if(!Xe){if(Bt)return null;throw new Error("reverifyWalletPublicKeyStatus failed")}}let k=await it.prepareEnableSARequest({accountId:t.walletId,teeId:t.teeId,expirePeriodDay:f.expirePeriodDay,forceUpgrade:f.forceUpgrade,currentExpiredTimestamp:ne.expiredTimestamp},Re,bt,ve).catch(async Xe=>{if(Xe instanceof Error&&Xe.name===De.CHAIN_INDEX_NOT_SUPPORTED){go();let Bt=s("wallet_extension_account_dialog_desc_sa_networkfail_update",{chain:Xe.message}),Mt=rt({subTitle:Bt,confirmText:s("wallet_extension_account_dialog_btn_continue_anyway"),cancelText:s("wallet_extension_btn_general_cancel"),onCancel:()=>{Mt.destroy()},onConfirm:()=>{Ft({...f,forceUpgrade:!0}),Mt.destroy()}});return null}throw Xe});if(!k)return null;let{reqParams:K,openData:_e}=k,{signatureBase64:Ve,signatureMetaData:Fn}=await it.prepareEnableSASignature(K,Dt,t);return{openData:_e,reqParams:K,signatureBase64:Ve,signatureMetaData:Fn}}),{runAsync:en}=We(pe.postSABatchAuthorize,{method:"POST",catchMode:"toastAllExceptBizErr",config:{walletSignParams:{needXClientSign:!0,walletId:t?.walletId}}},{manual:!0,async onError(f,[k]){Z("_TEE_BATCH_AUTH_FAILED",{params:{teeId:k.accountList?.[0].teeId,accountId:k.accountList?.[0].accountId},error:f}),O(),await Pe({silent:!0})},async onSuccess(f){if(!f?.data)return;En(!0),!o&&!Lt?C():o&&await ye(),b(),mt();let k=ne?.isActive??!1,K=async()=>{m||(Ee(R)?await R():o&&P())};(0,se.clearCache)(Rt(t?.teeId)),await Pe({silent:!0,skipUpgradeStatus:!0});let[_e]=await Promise.all([Tn()]);!k&&_e>0?X({orderNum:_e,onConfirm:K}):await K()}}),Ft=(0,se.useMemoizedFn)(async f=>{let k=await ht(f).catch(()=>(O(),null));if(!k)return null;let{reqParams:K,signatureBase64:_e,signatureMetaData:Ve}=k;return en({accountList:[{...K,signature:_e,signMsg:JSON.stringify(Ve)}],frontendPubkeyVersionSelected:it.hpkeService.publickeyVersion})}),Dn=(0,se.useMemoizedFn)(async f=>{let k=await ht(f).catch(()=>(U(),null));if(!k)return null;let{reqParams:K,signatureBase64:_e,signatureMetaData:Ve}=k;return Cn({...K,signature:_e,signMsg:JSON.stringify(Ve),frontendPubkeyVersionSelected:it.hpkeService.publickeyVersion})}),{runAsync:Ot}=We(pe.postSARemove,{method:"POST",config:{walletSignParams:{needXClientSign:!0,walletId:t?.walletId}},catchMode:"toastAllExceptBizErr"},{manual:!0,async onError(f,[k]){Z("_TEE_DISABLE_FAILED",{params:{teeId:k.accountId,accountId:k.accountId},error:f}),await Pe({silent:!0}),Te.error(s("wallet_extension_notifications_desc_sa_disable_fail"))},async onSuccess(f){!f?.data||(Te.success({title:s("wallet_extension_account_notifications_desc_sa_disabled"),desc:s("wallet_extension_notifications_desc_sa_disabled_order_update"),duration:fe}),mt(),await Pe({silent:!0,skipUpgradeStatus:!0}),(0,se.clearCache)(Rt(t?.teeId)),Ee(T)?await T():P())}}),At=(0,se.useMemoizedFn)(async()=>{if(!t)return null;let f=await it.prepareRemoveSARequest(Dt,t);return Ot(f)}),{runAsync:Wt}=We(pe.postSABatchExtend,{method:"POST",config:{walletSignParams:{needXClientSign:!0,walletId:t?.walletId}},catchMode:"toastAllExceptBizErr"},{manual:!0,async onError(f){V(),Z("_POST_SA_BATCH_EXTEND_FAILED",{params:{teeId:t?.teeId,accountId:t?.walletId},error:f}),await Pe({silent:!0})},async onSuccess(f){!f?.data||(z(f?.data?.teeResultList[0]?.expireTimestamp),b(),mt(),await Promise.all([Pe({silent:!0}),fn(fe*1e3)]),Ee(te)?await te():o&&P())}}),Ln=(0,se.useMemoizedFn)(async f=>{if(!t||!f.expirePeriodDay)return null;if(Lt)return Ft(f);let k=await it.prepareExtendSARequest(Dt,t,f.expirePeriodDay).catch(()=>(V(),null));return k?Wt(k):null});return{metadata:ve,teeStatus:ne,isCreated:G,upgradeStatusResponse:ut,saActivateRes:pt,dexOpenOrderNum:le,shouldShowUpgrade:Lt,handleEnable:Dn,handleReEnable:Ft,handleDel:At,handleFetchSAData:Pe,handleRefresh:Ln}};c();l();var Vn=p(D());c();l();var Pt=p(D()),qr=p(ae()),Kr=p(ha());var Gr=o=>{let{runAsync:e}=Zo(),{displayMaintenanceNotificationList:t,markDisplayed:n}=Jo(),a=o?.maintenanceEventList,i=(0,Pt.useMemo)(()=>{if(!a?.length)return null;let b=a.filter(A=>{let u=Bn(A);return Go(A.eventTimestamp)&&A.eventType===2&&!t.includes(u)});return(0,Kr.maxBy)(b,"eventTimestamp")??null},[a,t]),_=(0,qr.useMemoizedFn)(async()=>{let b=await e();return Qo(b)}),d=(0,Pt.useRef)(!1),m=we();(0,Pt.useEffect)(()=>{i&&!d.current&&_().then(b=>{b&&(nr(i.eventType,m.smartAccountWhatAreServiceUpgradesMaintenance),d.current=!0,n(Bn(i)))}).catch(()=>{})},[i])};var Qr=({metadata:o,isValidating:e,isCreating:t,newlyCreatedWalletId:n,handleCreateWallet:a,handleFetchSAData:i})=>{(0,Vn.useEffect)(()=>{!t||a()},[t]),(0,Vn.useEffect)(()=>{t&&!n||!e||i()},[e,t,n]),Gr(o)};c();l();var Le=p(D());var Na=({isFromDex:o,isSmartAccountActivatedOnce:e,isFromWalletManageCreate:t,showFeature:n})=>{let a;e?a=!1:o?a=Boolean(n):a=!0;let i;t&&!a?i=!0:i=!1;let _;return t?_=!1:_=!0,{showWelcome:a,isCreating:i,isValidating:_}},Yr=({isSmartAccountActivatedOnce:o,isFromDex:e,isFromWalletManageCreate:t,showFeature:n})=>{let a=(0,Le.useRef)();a.current||(a.current=Na({isFromDex:e,isSmartAccountActivatedOnce:o,isFromWalletManageCreate:t,showFeature:n}));let[i,_]=(0,Le.useState)(!1),[d,m]=(0,Le.useState)(a.current.showWelcome),[b,A]=(0,Le.useState)(a.current.isCreating),[u,I]=(0,Le.useState)(!1),[P,E]=(0,Le.useState)(!1),[y,C]=(0,Le.useState)(!1),[X,R]=(0,Le.useState)(!1),[T,z]=(0,Le.useState)(a.current.isValidating);return{isFromDex:e,isFromWalletManageCreate:t,showWelcome:d,isCreating:b,isValidating:T,showDelConfirm:u,showEnableDone:P,showPeriodSheet:i,showUpgradeConfirm:y,showSelectAccount:X,setIsCreating:A,setShowWelcome:m,setIsValidating:z,setShowDelConfirm:I,setShowEnableDone:E,setShowPeriodSheet:_,setShowUpgradeConfirm:C,setShowSelectAccount:R}};c();l();var Fe=p(ae());$();var Xr=({walletCreated:o,createWalletName:e,handlePlatformBack:t,onExit:n})=>{let a=(0,Fe.useMemoizedFn)(y=>{Te.success({title:s("wallet_extension_account_notification_title_account_added",{account:y}),desc:s("wallet_extension_account_notification_subtitle_account_only"),duration:fe})}),i=we(),_=(0,Fe.useMemoizedFn)(()=>{let y=rt({subTitle:s("wallet_extension_home_dialog_desc_sa_network_issue"),confirmText:s("wallet_extension_btn_general_gotit"),onConfirm:async()=>{await n?.(),y.destroy(),t(),o&&a(e)}})}),d=(0,Fe.useMemoizedFn)(()=>{rt({title:s("wallet_extension_account_dialog_title_sa_maintenance"),subTitle:s("wallet_extension_account_dialog_desc_sa_maintenance"),confirmText:s("wallet_extension_btn_general_gotit"),cancelText:i.smartAccountWhatAreServiceUpgradesMaintenance?s("wallet_extension_home_link_learn_more"):void 0,onCancel:()=>{!i.smartAccountWhatAreServiceUpgradesMaintenance||ie(i.smartAccountWhatAreServiceUpgradesMaintenance)},onConfirm:async y=>{await n?.(),y.destroy(),t(),o&&a(e)}})}),m=(0,Fe.useMemoizedFn)(()=>{Te.error({title:s("wallet_extension_account_dialog_title_sa_enable_fail"),desc:s("wallet_extension_account_notifications_desc_try_again"),duration:fe})}),b=(0,Fe.useMemoizedFn)(()=>{Te.error({title:s("wallet_account_notifications_title_reactivation_fail"),desc:s("wallet_extension_account_notifications_desc_try_again"),duration:fe})}),A=(0,Fe.useMemoizedFn)(()=>{Te.error({title:s("wallet_extension_account_notifications_title_sa_renew_fail"),desc:s("wallet_extension_account_notifications_desc_try_again"),duration:fe})}),u=(0,Fe.useMemoizedFn)(()=>{Te.success({title:s("wallet_extension_account_notification_title_sa_enabled"),duration:fe})}),I=(0,Fe.useMemoizedFn)(y=>{let C;y&&(C=s("wallet_extension_account_notifications_desc_sa_renewed",{date:$e.formatDateTime(new Date(y),{format:Je.SimpleDate})})),Te.success({title:s("wallet_extension_account_notifications_sa_renewed"),desc:C,duration:fe})}),P=(0,Fe.useMemoizedFn)(async y=>{rt({title:s("wallet_extension_account_dialog_title_reactivate_orders"),subTitle:s("wallet_extension_account_dialog_desc_reactivate_orders_sa",{num:y.orderNum}),confirmText:s("wallet_extension_btn_general_ok"),onConfirm:async C=>{C.destroy(),await y.onConfirm()}})}),E=(0,Fe.useMemoizedFn)((y,C=!0)=>{Te.success({title:s("wallet_extension_account_notification_title_account_added",{account:y}),desc:C?s("wallet_extension_account_notification_subtitle_smart_enabled"):s("wallet_extension_account_notification_subtitle_enable_again"),duration:fe})});return{handleToastTeeNetError:_,handleToastReEnableSuccess:u,handleToastExtendSuccess:I,handleToastReactivateOrders:P,handleToastAccountAddedButNotEnable:a,handleToastAccountAddedAndEnabled:E,handleToastSAEnableFailed:m,handleToastReEnableFailed:b,handleToastExtendFailed:A,handleToastTeeMaintenance:d}};c();l();var Be=p(D()),Ct=p(xo()),jn=p(ae());Ne();$();c();l();var Jr=p(D());var $r=o=>{let[,e]=ln(null),t=No(),n=o||t;return(0,Jr.useMemo)(()=>{let a=null,i=null;for(let _=0;_<e.length;_++){let d=e[_];for(let m=0;m<d.walletIdentities.length;m++){let b=d.walletIdentities[m];if(b.walletId===n){a=d,i=b;break}}if(a&&i)break}return{keyringIdentity:a,walletIdentity:i}},[e,n])};var Zr=({walletId:o,origin:e,isFromDex:t,keyringId:n,setIsValidating:a,removeQueryFrom:i,handlePlatformBack:_})=>{let[d,m]=(0,Be.useState)(null),[b,A]=(0,Be.useState)(""),[u,I]=(0,Be.useState)(),E=(0,Ct.useSelector)(Fo).origin||e,{latestAccountId:y,approvedAccountList:C}=(0,Ct.useSelector)(J=>Mo(J,E)),X=o||d||u||(t?y:void 0),{walletIdentity:R,keyringIdentity:T}=$r(X);(0,Be.useEffect)(()=>{R&&a(!0)},[R?.walletId]);let z=Eo(T?.keyringId??""),te=(0,Ct.useSelector)(Io),ue=To(),U=(0,Be.useRef)(!1),O=(0,Be.useMemo)(()=>{let J=Number(R?.walletAsset);return!Number.isNaN(J)},[R?.walletAsset]),V=(0,jn.useMemoizedFn)(async()=>{if(te||!T?.keyringId)return;let J=z?.walletIdentities.length??0;A(`${s("wallet_manage_wallet_top_account_default_name")} ${eo((J+1).toString(),2,"0")}`),ue(n??T.keyringId,{hideToast:!0}).then(xe=>{m(xe),U.current=!0,i()}).catch(xe=>{xe.message===Co&&Ut.error({title:s("wallet_extension_error_reminder_system_busy")}),_()})}),W=(0,Ct.useDispatch)(),ye=(0,jn.useMemoizedFn)(async()=>{if(!t||!E||!C.length||!u)return;let J=C.includes(u);W(cn.setSelectAccounts([u])),await W(sn(u,!0)),J||await W(So(E,u))});return{isFundReady:O,createWalletName:b,walletIdentity:R,keyringIdentity:T,walletCreated:U.current,newlyCreatedWalletId:d,selectedWalletId:u,setSelectedWalletId:I,handleCreateWallet:V,handleAutoConnectDapp:ye}};c();l();var de=p(D()),hn=p(ae());$();c();l();var qn=p(D()),Kn=p(Oe());c();l();var st={"bot-avatar":"_bot-avatar_oue8c_1",botAvatar:"_bot-avatar_oue8c_1","bot-icon":"_bot-icon_oue8c_6",botIcon:"_bot-icon_oue8c_6","content-enabled":"_content-enabled_oue8c_9",contentEnabled:"_content-enabled_oue8c_9","content-expiring":"_content-expiring_oue8c_12",contentExpiring:"_content-expiring_oue8c_12","content-expired":"_content-expired_oue8c_15",contentExpired:"_content-expired_oue8c_15","bg-enabled":"_bg-enabled_oue8c_18",bgEnabled:"_bg-enabled_oue8c_18","bg-expiring":"_bg-expiring_oue8c_21",bgExpiring:"_bg-expiring_oue8c_21","bg-expired":"_bg-expired_oue8c_24",bgExpired:"_bg-expired_oue8c_24",center:"_center_oue8c_27"};var wn=({status:o})=>qn.default.createElement("div",{className:(0,Kn.default)(st.center,st["bot-avatar"],{[st["bg-enabled"]]:o===0||o===1,[st["bg-expired"]]:o===2}),"data-testid":B.LARGE_BOT_AVATAR},qn.default.createElement(re,{className:(0,Kn.default)("okx-wallet-plugin-bot-filled",st["bot-icon"],{[st["content-enabled"]]:o===0||o===1,[st["content-expired"]]:o===2})}));c();l();var Me={container:"_container_xvobc_1","page-title":"_page-title_xvobc_7",pageTitle:"_page-title_xvobc_7","page-description":"_page-description_xvobc_14",pageDescription:"_page-description_xvobc_14","page-description-link":"_page-description-link_xvobc_21",pageDescriptionLink:"_page-description-link_xvobc_21","order-container":"_order-container_xvobc_28",orderContainer:"_order-container_xvobc_28","order-title":"_order-title_xvobc_37",orderTitle:"_order-title_xvobc_37","order-count":"_order-count_xvobc_43",orderCount:"_order-count_xvobc_43","arr-icon":"_arr-icon_xvobc_49",arrIcon:"_arr-icon_xvobc_49",footer:"_footer_xvobc_53","confirm-btn":"_confirm-btn_xvobc_53",confirmBtn:"_confirm-btn_xvobc_53"};var ea=({orderCount:o,teeStatus:e,onDel:t})=>{let[n,a]=(0,de.useState)(!1),i=(0,hn.useMemoizedFn)(async()=>{if(!n)try{a(!0),await t()}finally{a(!1)}}),{avatarStatus:_}=yt({teeStatus:e});(0,hn.useMount)(()=>{bo()});let d=we();return de.default.createElement("div",{className:Me.container},de.default.createElement(wn,{status:_}),de.default.createElement("div",{className:Me["page-title"]},s("wallet_extension_account_details_header_disable_sa")),de.default.createElement("div",{className:Me["page-description"]},s("wallet_extension_account_details_text_disable_cancel",{learn:d.smartAccountActivationAndDisableGuide?de.default.createElement("span",{className:Me["page-description-link"],onClick:ie.bind(null,d.smartAccountActivationAndDisableGuide)},s("wallet_extension_home_link_learn_more")):""})),o?de.default.createElement("div",{className:Me["order-container"]},de.default.createElement("div",{className:Me["order-title"]},s("wallet_extension_account_details_label_open_orders")),de.default.createElement("div",null,de.default.createElement("span",{className:Me["order-count"]},o))):null,de.default.createElement(ge,{className:Me.footer},de.default.createElement(N,{type:N.TYPE.red,onClick:i,loading:n,className:Me["confirm-btn"],"data-testid":B.DEL_CONFIRM_BTN},s("wallet_extension_account_details_btn_disable_sa"))))};c();l();var F=p(D()),An=p(ae()),ta=p(Oe());$();c();l();var Y={"enable-done-container":"_enable-done-container_os8zm_1",enableDoneContainer:"_enable-done-container_os8zm_1","avatar-container":"_avatar-container_os8zm_8",avatarContainer:"_avatar-container_os8zm_8","avatar-animation":"_avatar-animation_os8zm_16",avatarAnimation:"_avatar-animation_os8zm_16",avatar:"_avatar_os8zm_8","account-row":"_account-row_os8zm_30",accountRow:"_account-row_os8zm_30","account-name":"_account-name_os8zm_38",accountName:"_account-name_os8zm_38","account-icon":"_account-icon_os8zm_43",accountIcon:"_account-icon_os8zm_43","page-title":"_page-title_os8zm_47",pageTitle:"_page-title_os8zm_47","page-subtitle":"_page-subtitle_os8zm_55",pageSubtitle:"_page-subtitle_os8zm_55","footer-container":"_footer-container_os8zm_63",footerContainer:"_footer-container_os8zm_63","border-wrapper":"_border-wrapper_os8zm_63",borderWrapper:"_border-wrapper_os8zm_63","top-border-container":"_top-border-container_os8zm_67",topBorderContainer:"_top-border-container_os8zm_67","top-border":"_top-border_os8zm_67",topBorder:"_top-border_os8zm_67","footer-contents":"_footer-contents_os8zm_76",footerContents:"_footer-contents_os8zm_76","tos-container":"_tos-container_os8zm_82",tosContainer:"_tos-container_os8zm_82","tos-content":"_tos-content_os8zm_89",tosContent:"_tos-content_os8zm_89","confirm-btn":"_confirm-btn_os8zm_96",confirmBtn:"_confirm-btn_os8zm_96"};var na=({onConfirm:o,walletIdentity:e,activateRes:t,handleAutoConnectDapp:n})=>{let a=(0,F.useMemo)(()=>t?.expireTimestamp?$e.formatDateTime(new Date(t.expireTimestamp),{format:Je.SimpleDate}):"",[t?.expireTimestamp]),i=tt({light:"/static/images/smart-account/enable-sa-succ-light.json",dark:"/static/images/smart-account/enable-sa-succ-dark.json"}),[_,d]=(0,F.useState)(!1);(0,An.useMount)(()=>{mo(),n().catch(()=>{}).finally(()=>{d(!0)})});let m=(0,F.useRef)(null),b=(0,An.useMemoizedFn)(async()=>{let u=m.current;if(!u)return;let I=u.getDuration(),P=u.getDuration(!0);if(!I||!P)return;let E=I*1e3,y=Math.floor(1e3/E*P),C=Math.floor(2817/E*P);u.play(),await fn(1e3),u.pause(),u.playSegments([y,C],!0)}),{fn:A}=he({fn:o,disabled:!_});return F.default.createElement(F.default.Fragment,null,F.default.createElement("div",{className:Y["enable-done-container"]},F.default.createElement("div",{className:Y["avatar-container"]},F.default.createElement("div",{className:Y["avatar-animation"]},F.default.createElement(Ze,{path:i,autoplay:!1,animationRef:m,onDOMLoaded:b})),F.default.createElement(dn,{walletIdentity:e,className:Y.avatar})),F.default.createElement("div",{className:Y["account-row"]},F.default.createElement("div",{className:Y["account-name"]},e.walletName),F.default.createElement(re,{className:(0,ta.default)("okx-wallet-plugin-bot-filled",Y["account-icon"])})),F.default.createElement("div",{className:Y["page-title"]},s("wallet_extension_account_title_account_enabled")),a?F.default.createElement("div",{className:Y["page-subtitle"],"data-testid":B.DONE_EXPIRE_DATE},s("wallet_extension_account_subtitle_enabled_until",{date:a})):null),F.default.createElement(ge,{className:Y["footer-container"]},F.default.createElement("div",null,F.default.createElement("div",{className:Y["top-border-container"]},F.default.createElement("div",{className:Y["top-border"]})),F.default.createElement("div",{className:Y["footer-contents"]},F.default.createElement("div",{className:Y["tos-container"]},F.default.createElement("div",{className:Y["tos-content"]},s("wallet_extension_account_bot_text_renew_account"))),F.default.createElement(N,{className:Y["confirm-btn"],onClick:A,type:N.TYPE.primary,"data-testid":B.DONE_BTN},s("wallet_extension_complete_btn_done"))))))};c();l();var x=p(D()),Sn=p(xo()),Qe=p(ae()),Ge=p(Oe());Ne();$();oo();c();l();co();var Ta=1e4,oa=(o,e)=>{let t=o?.initialType===io.HD_KEYRING,n=o?.needBackup===0,a=Number(o?.walletAsset??"0"),i=!Number.isNaN(a),_=e.upgradeAssetThreshold||Ta,d=i&&a>_;return{isAvailable:Boolean(i&&t&&n&&!d),isAssetValid:i,isAssetOverLimit:d,isMnemonicWallet:t,hasBackup:n}};c();l();var v={enable:"_enable_piytr_1","page-title":"_page-title_piytr_7",pageTitle:"_page-title_piytr_7","page-description":"_page-description_piytr_13",pageDescription:"_page-description_piytr_13","alert-row":"_alert-row_piytr_20",alertRow:"_alert-row_piytr_20","alert-text":"_alert-text_piytr_30",alertText:"_alert-text_piytr_30",pointer:"_pointer_piytr_35","primary-text":"_primary-text_piytr_38",primaryText:"_primary-text_piytr_38","underline-tip-text":"_underline-tip-text_piytr_41",underlineTipText:"_underline-tip-text_piytr_41",card:"_card_piytr_48","select-another-row":"_select-another-row_piytr_56",selectAnotherRow:"_select-another-row_piytr_56","select-another-row-icon":"_select-another-row-icon_piytr_62",selectAnotherRowIcon:"_select-another-row-icon_piytr_62","select-another-row-text":"_select-another-row-text_piytr_65",selectAnotherRowText:"_select-another-row-text_piytr_65","info-block":"_info-block_piytr_71",infoBlock:"_info-block_piytr_71","info-block-avatar":"_info-block-avatar_piytr_77",infoBlockAvatar:"_info-block-avatar_piytr_77","info-block-right":"_info-block-right_piytr_81",infoBlockRight:"_info-block-right_piytr_81","account-name-container":"_account-name-container_piytr_87",accountNameContainer:"_account-name-container_piytr_87","account-name":"_account-name_piytr_87",accountName:"_account-name_piytr_87","account-name-active":"_account-name-active_piytr_97",accountNameActive:"_account-name-active_piytr_97","account-name-expiring":"_account-name-expiring_piytr_100",accountNameExpiring:"_account-name-expiring_piytr_100","account-bot-icon":"_account-bot-icon_piytr_103",accountBotIcon:"_account-bot-icon_piytr_103","account-bot-icon-active":"_account-bot-icon-active_piytr_107",accountBotIconActive:"_account-bot-icon-active_piytr_107","account-bot-icon-expiring":"_account-bot-icon-expiring_piytr_110",accountBotIconExpiring:"_account-bot-icon-expiring_piytr_110","account-bot-icon-disabled":"_account-bot-icon-disabled_piytr_113",accountBotIconDisabled:"_account-bot-icon-disabled_piytr_113","account-balance":"_account-balance_piytr_116",accountBalance:"_account-balance_piytr_116","gap-container":"_gap-container_piytr_122",gapContainer:"_gap-container_piytr_122","gap-line":"_gap-line_piytr_126",gapLine:"_gap-line_piytr_126","enable-container":"_enable-container_piytr_131",enableContainer:"_enable-container_piytr_131","enable-label":"_enable-label_piytr_138",enableLabel:"_enable-label_piytr_138","select-enable-row":"_select-enable-row_piytr_144",selectEnableRow:"_select-enable-row_piytr_144","footer-container":"_footer-container_piytr_152",footerContainer:"_footer-container_piytr_152","footer-contents":"_footer-contents_piytr_152",footerContents:"_footer-contents_piytr_152","confirm-btn":"_confirm-btn_piytr_158",confirmBtn:"_confirm-btn_piytr_158","ok-btn":"_ok-btn_piytr_163",okBtn:"_ok-btn_piytr_163","active-btn":"_active-btn_piytr_166",activeBtn:"_active-btn_piytr_166"};var ra=({walletIdentity:o,metadata:e,teeStatus:t,isFromDex:n,isFromBanner:a,displayEnableLabel:i,enableValue:_,setShowSelectAccount:d,setShowPeriodSheet:m,onEnableSuccess:b,onExit:A,handleExtensionBack:u,handleEnable:I,handleReEnable:P,handleAutoConnectDapp:E})=>{let{isAvailable:y,isAssetValid:C,isAssetOverLimit:X,isMnemonicWallet:R,hasBackup:T}=oa(o,e),z=(0,Sn.useSelector)(lo),te=n||a,ue=t.isCreated,U=t.isActive,O=(0,x.useMemo)(()=>{let G="";if(X){let ut=!z||z.isoCode.toUpperCase()===rn,ke,oe=to.showTruncation(e.upgradeAssetThreshold,0);if(ut)ke=`${oe} ${rn}`;else{let Tt=yo(ro(e.upgradeAssetThreshold,z.usdToThisRate),{currencySign:z.symbol}).value;ke=`${oe} ${rn} (${Tt})`}G=s("wallet_extension_account_mid_tips_enable_value_limit",{num:ke})}else R?T||(G=s("wallet_extension_account_mid_tips_enable_back_up_first")):G=s("wallet_extension_account_mid_tips_enable_seed_phrase");return G},[X,R,T,e]),V=(0,Qe.useMemoizedFn)(async()=>{m(!0)}),W=(0,Qe.useMemoizedFn)(()=>{d(!0),uo()});(0,Qe.useMount)(()=>{ho({button:y?"Enable":"Ok"})});let ye=(0,Qe.useMemoizedFn)(()=>{let G=rt({title:s("wallet_extension_account_dialog_title_enable_period"),subTitle:s("wallet_extension_account_dialog_desc_enable_period"),confirmText:s("wallet_extension_btn_general_ok"),onConfirm:()=>{G.destroy()}})}),{fn:J,loading:xe}=he({fn:(0,Qe.useMemoizedFn)(async()=>ue?P({expirePeriodDay:_}):I({expirePeriodDay:_}))}),ve=C&&!y,me=!C,Ie=we(),Ue=(0,Sn.useDispatch)(),{fn:ne}=he({fn:(0,Qe.useMemoizedFn)(async()=>{n?await E():a&&(Ue(cn.setSelectAccounts([o.walletId])),Ue(sn(o.walletId,!0))),Ee(b)?b():u()})}),{fn:Re}=he({fn:(0,Qe.useMemoizedFn)(async()=>{Ee(A)?await A():u()})}),Ye="";return U||(ue?Ye=Ie.smartAccountHowToTradeWithSmartAccount?x.default.createElement("span",{className:v["primary-text"],onClick:ie.bind(null,Ie.smartAccountHowToTradeWithSmartAccount)},s("wallet_extension_home_link_learn_more")):"":y?Ye=Ie.smartAccountWhatIsSmartAccount?x.default.createElement("span",{className:v["primary-text"],onClick:ie.bind(null,Ie.smartAccountWhatIsSmartAccount)},s("wallet_extension_home_link_learn_more")):"":Ye=Ie.smartAccountHowToTradeWithSmartAccount?x.default.createElement("span",{className:v["primary-text"],onClick:ie.bind(null,Ie.smartAccountHowToTradeWithSmartAccount)},s("wallet_extension_home_link_learn_more")):""),x.default.createElement(x.default.Fragment,null,x.default.createElement("div",{className:v.enable},x.default.createElement("div",{className:v["page-title"]},s(U?"wallet_extension_account_header_sa_enabled":"wallet_extension_account_header_enable_smart_account")),x.default.createElement("div",{className:v["page-description"]},U?s("wallet_extension_account_subheader_sa_enabled"):s("wallet_extension_account_subheader_enable_sa_faq",{learn:Ye})),x.default.createElement("div",{className:v.card},x.default.createElement("div",{className:v["info-block"]},x.default.createElement(dn,{size:tr.md,walletIdentity:o,className:v["info-block-avatar"]}),x.default.createElement("div",{className:v["info-block-right"]},x.default.createElement("div",{className:v["account-name-container"]},x.default.createElement("div",{className:(0,Ge.default)({[v["account-name"]]:!0,[v["account-name-active"]]:U})},o.walletName),ue?x.default.createElement(re,{className:(0,Ge.default)({"okx-wallet-plugin-bot-filled":!0,[v["account-bot-icon-active"]]:U,[v["account-bot-icon-disabled"]]:!U,[v["account-bot-icon"]]:!0})}):null),x.default.createElement(rr,{walletAsset:o.walletAsset}))),y&&!U?x.default.createElement(x.default.Fragment,null,x.default.createElement("div",{className:v["gap-container"]},x.default.createElement("div",{className:v["gap-line"]})),x.default.createElement("div",{className:v["enable-container"]},x.default.createElement("div",{className:(0,Ge.default)(v["enable-label"],v["underline-tip-text"]),onClick:ye},s("wallet_extension_account_mid_label_enable_for")),x.default.createElement("div",{className:(0,Ge.default)(v["select-enable-row"],v.pointer),onClick:V,"data-testid":B.PERIOD_SELECT_BTN},x.default.createElement("span",null,i),x.default.createElement(re,{className:"okx-wallet-plugin-down-1"})))):null,O?x.default.createElement("div",{className:v["alert-row"]},x.default.createElement("div",{className:v["alert-text"]},O)):null),te?x.default.createElement("div",{className:(0,Ge.default)(v.card,v.pointer),onClick:W},x.default.createElement("div",{className:v["select-another-row"]},x.default.createElement(re,{className:(0,Ge.default)("okx-wallet-plugin-wire-transfer",v["select-another-row-icon"])}),x.default.createElement("div",{className:v["select-another-row-text"]},s("wallet_extension_account_mid_textbtn_select_another_account")))):null),x.default.createElement(ge,{className:v["footer-container"]},x.default.createElement("div",{className:v["footer-contents"]},ve?x.default.createElement(N,{type:N.TYPE.primary,onClick:Re,className:v["ok-btn"]},s("wallet_extension_btn_cancel")):U?x.default.createElement(N,{type:N.TYPE.primary,onClick:ne,className:(0,Ge.default)(v["confirm-btn"],v["active-btn"])},s("wallet_extension_footer_btn_continue")):x.default.createElement(N,{className:(0,Ge.default)({[v["confirm-btn"]]:!0,[v["active-btn"]]:!me}),loading:xe,onClick:J,disabled:me,type:N.TYPE.primary,"data-testid":B.ENABLE_BTN},s("wallet_extension_account_smart_btn_enable")))))};c();l();var dt=p(D());c();l();var Et={"loading-container":"_loading-container_1imw9_1",loadingContainer:"_loading-container_1imw9_1","circle-container":"_circle-container_1imw9_9",circleContainer:"_circle-container_1imw9_9","abs-container":"_abs-container_1imw9_17",absContainer:"_abs-container_1imw9_17","wallet-icon":"_wallet-icon_1imw9_24",walletIcon:"_wallet-icon_1imw9_24","add-title":"_add-title_1imw9_27",addTitle:"_add-title_1imw9_27",description:"_description_1imw9_35"};var aa=({title:o,description:e})=>{let t=tt({light:"/static/images/smart-account/create-account-loading-light.json",dark:"/static/images/smart-account/create-account-loading-dark.json"});return dt.default.createElement("div",{className:Et["loading-container"]},dt.default.createElement("div",{className:Et["circle-container"]},dt.default.createElement("div",{className:Et["abs-container"]},dt.default.createElement(Ze,{path:t}))),dt.default.createElement("div",{className:Et["add-title"]},o),dt.default.createElement("div",{className:Et.description},e))};c();l();var ia=p(D()),sa=p(ae());Ne();co();var ca=({accountId:o,setShowSelectAccount:e,setSelectedWalletId:t})=>{let[,n]=ln({keyringType:so.MNEMONIC}),{keyringIdentitiesWithSA:a}=or(n),i=(0,sa.useMemoizedFn)(async _=>{t(_.walletId),e(!1)});return ia.default.createElement(ir,{keyringIdentities:a,currentWalletId:o,onSelectAccount:i,onAccountCreation:$n})};c();l();var L=p(D()),Nt=p(ae()),vn=p(Oe());$();c();l();var yn=p(D()),xn=p(Oe());$();c();l();var w={status:"_status_88ayl_1",center:"_center_88ayl_9","page-title":"_page-title_88ayl_14",pageTitle:"_page-title_88ayl_14","gap-top-sm":"_gap-top-sm_88ayl_21",gapTopSm:"_gap-top-sm_88ayl_21","gap-top-lg":"_gap-top-lg_88ayl_24",gapTopLg:"_gap-top-lg_88ayl_24","info-card":"_info-card_88ayl_27",infoCard:"_info-card_88ayl_27","info-card-row":"_info-card-row_88ayl_32",infoCardRow:"_info-card-row_88ayl_32","info-card-row-label":"_info-card-row-label_88ayl_39",infoCardRowLabel:"_info-card-row-label_88ayl_39","info-card-row-primary":"_info-card-row-primary_88ayl_45",infoCardRowPrimary:"_info-card-row-primary_88ayl_45","info-card-row-value":"_info-card-row-value_88ayl_51",infoCardRowValue:"_info-card-row-value_88ayl_51","info-card-row-content":"_info-card-row-content_88ayl_59",infoCardRowContent:"_info-card-row-content_88ayl_59","info-card-row-disable":"_info-card-row-disable_88ayl_66",infoCardRowDisable:"_info-card-row-disable_88ayl_66","info-card-divider":"_info-card-divider_88ayl_69",infoCardDivider:"_info-card-divider_88ayl_69","underline-tip-text":"_underline-tip-text_88ayl_74",underlineTipText:"_underline-tip-text_88ayl_74","tip-contents":"_tip-contents_88ayl_81",tipContents:"_tip-contents_88ayl_81","tip-link":"_tip-link_88ayl_88",tipLink:"_tip-link_88ayl_88","gap-line-container":"_gap-line-container_88ayl_95",gapLineContainer:"_gap-line-container_88ayl_95","gap-line":"_gap-line_88ayl_95",gapLine:"_gap-line_88ayl_95","disable-now":"_disable-now_88ayl_103",disableNow:"_disable-now_88ayl_103","disable-button":"_disable-button_88ayl_106",disableButton:"_disable-button_88ayl_106",footer:"_footer_88ayl_113","confirm-btn":"_confirm-btn_88ayl_113",confirmBtn:"_confirm-btn_88ayl_113",pointer:"_pointer_88ayl_126","expiring-container":"_expiring-container_88ayl_129",expiringContainer:"_expiring-container_88ayl_129","expiring-text":"_expiring-text_88ayl_134",expiringText:"_expiring-text_88ayl_134","expiring-tip":"_expiring-tip_88ayl_137",expiringTip:"_expiring-tip_88ayl_137","new-label":"_new-label_88ayl_143",newLabel:"_new-label_88ayl_143"};var la=({onClick:o})=>yn.default.createElement("div",{className:(0,xn.default)(w["info-card"],w["gap-top-sm"],w.pointer),onClick:o,"data-testid":B.STATUS_DISABLE_BTN},yn.default.createElement("div",{className:(0,xn.default)(w["info-card-row"])},yn.default.createElement("div",{className:(0,xn.default)(w["info-card-row-label"],w["info-card-row-disable"])},s("wallet_extension_account_regularcell_textbtn_disable"))));c();l();var Jt=p(D());$();var _a=({shouldShowUpgrade:o,teeStatus:e,links:t,withinExpiringDays:n})=>o?s("wallet_extension_account_reminder_text_sa_upgrading",{learn:t.smartAccountWhatAreServiceUpgradesMaintenance?Jt.default.createElement("span",{className:w["tip-link"],onClick:ie.bind(null,t.smartAccountWhatAreServiceUpgradesMaintenance)},s("wallet_extension_home_link_learn_more")):""}):e.isActive?n?s("wallet_extension_account_reminder_text_renew_in_time",{learn:t.smartAccountActivationAndDisableGuide?Jt.default.createElement("span",{className:w["tip-link"],onClick:ie.bind(null,t.smartAccountActivationAndDisableGuide)},s("wallet_extension_home_link_learn_more")):""}):e.isActive?s("wallet_extension_account_reminder_text_always_renew",{learn:t.smartAccountHowToTradeWithSmartAccount?Jt.default.createElement("span",{className:w["tip-link"],onClick:ie.bind(null,t.smartAccountHowToTradeWithSmartAccount)},s("wallet_extension_home_link_learn_more")):""}):null:s("wallet_extension_account_reminder_text_sa_disabled",{learn:t.smartAccountHowToTradeWithSmartAccount?Jt.default.createElement("span",{className:w["tip-link"],onClick:ie.bind(null,t.smartAccountHowToTradeWithSmartAccount)},s("wallet_extension_home_link_learn_more")):""});c();l();var He=p(D()),Gn=p(Oe());$();var da=({onClick:o,shouldShowUpgrade:e})=>He.default.createElement("div",{className:(0,Gn.default)(w["info-card"],w["gap-top-lg"],w.pointer),onClick:o,"data-testid":B.RENEW_BTN},He.default.createElement("div",{className:(0,Gn.default)(w["info-card-row"])},He.default.createElement("div",{className:w["info-card-row-main"]},s(e?"wallet_extension_account_regularcell_textbtn_service_upgrade_required":"wallet_extension_account_regularcell_textbtn_renew")),He.default.createElement("div",{className:w["info-card-row-content"]},e?He.default.createElement(He.default.Fragment,null,He.default.createElement("span",{className:w["new-label"]},s("wallet_extension_tag_expand_new")),He.default.createElement(re,{className:"okx-wallet-plugin-chevron-right",fontSize:"12px",style:{color:"var(--okd-color-content-contrast)"}})):He.default.createElement(re,{className:"okx-wallet-plugin-chevron-right"}))));c();l();var Se=p(D());$();var ua=({isOutdated:o,withinExpiringDays:e,withinOneDay:t,expiredTimestamp:n,onCountdownFinish:a})=>{let i=(0,Se.useMemo)(()=>$e.formatDateTime(new Date(n),{format:Je.SimpleDate}),[n]);return o?Se.default.createElement("span",{className:w["info-card-row-disable"]},s("wallet_extension_account_details_status_disabled")):t?Se.default.createElement("div",{className:w["expiring-container"]},Se.default.createElement("div",{className:w["expiring-text"]},Se.default.createElement("span",null,Se.default.createElement(er,{remainingTime:n-Date.now(),expiredTimestamp:n,style:{fontWeight:400,lineHeight:"20px"},timeOnly:!0,onFinish:a}))),Se.default.createElement("div",{className:w["expiring-tip"]},s("wallet_extension_account_tag_expiring_soon"))):e?Se.default.createElement("div",{className:w["expiring-container"]},Se.default.createElement("div",{className:w["expiring-text"]},i),Se.default.createElement("div",{className:w["expiring-tip"]},s("wallet_extension_account_tag_expiring_soon"))):i};var ma=({walletIdentity:o,teeStatus:e,shouldShowUpgrade:t,setShowDelConfirm:n,setShowPeriodSheet:a,setShowUpgradeConfirm:i,handleFetchSAData:_})=>{let{isOutdated:d,withinExpiringDays:m,avatarStatus:b,expiredTimestamp:A,withinOneDay:u}=yt({teeStatus:e});(0,Nt.useMount)(()=>{wo({tee_status:Ko(d,m)})});let I=we(),P=(0,Nt.useMemoizedFn)(()=>{t?i(!0):a(!0)}),E=(0,Nt.useMemoizedFn)(()=>{n(!0)}),y=(0,Nt.useMemoizedFn)(()=>{_({silent:!0})});return L.default.createElement(L.default.Fragment,null,L.default.createElement("div",{className:w.status},L.default.createElement(wn,{status:b}),L.default.createElement("div",{className:w["page-title"]},s("wallet_extension_account_header_smart_account_status")),L.default.createElement("div",{className:(0,vn.default)(w["info-card"],w["gap-top-sm"])},L.default.createElement("div",{className:w["info-card-row"]},L.default.createElement("div",{className:w["info-card-row-label"]},s("wallet_extension_account_details_label_account")),L.default.createElement("div",{className:w["info-card-row-content"]},o.walletName)),L.default.createElement("div",{className:w["info-card-divider"]}),L.default.createElement("div",{className:w["info-card-row"]},L.default.createElement("div",{className:(0,vn.default)(w["info-card-row-label"])},s("wallet_extension_account_details_label_status")),L.default.createElement("div",{className:(0,vn.default)({[w["info-card-row-content"]]:!0,[w["info-card-row-disable"]]:!e.isActive})},s(e.isActive?"wallet_extension_account_details_status_enabled":"wallet_extension_account_details_status_disabled"))),e.isActive?L.default.createElement(L.default.Fragment,null,L.default.createElement("div",{className:w["info-card-divider"]}),L.default.createElement("div",{className:w["info-card-row"]},L.default.createElement("div",{className:w["info-card-row-label"]},s(u?"wallet_extension_account_regularcell_label_renew_in":"wallet_extension_account_regularcell_label_enabled_until")),L.default.createElement("div",{className:w["info-card-row-content"],"data-testid":B.STATUS_EXPIRE_LABEL},L.default.createElement(ua,{isOutdated:d,withinExpiringDays:m,expiredTimestamp:A,withinOneDay:u,onCountdownFinish:y})))):null),e.isActive?L.default.createElement(L.default.Fragment,null,L.default.createElement(da,{shouldShowUpgrade:t,onClick:P}),L.default.createElement(la,{onClick:E})):null,L.default.createElement("div",{className:w["tip-contents"]},L.default.createElement(_a,{shouldShowUpgrade:t,teeStatus:e,links:I,withinExpiringDays:m}))),e.isActive?null:L.default.createElement(ge,{className:w.footer},L.default.createElement(N,{className:w["confirm-btn"],onClick:()=>{a(!0)},type:N.TYPE.primary,"data-testid":B.STATUS_ENABLE_BTN},s("wallet_extension_account_smart_btn_enable"))))};c();l();var be=p(D()),Qn=p(ae()),In=p(Oe());Ne();$();c();l();var ce={"upgrade-confirm":"_upgrade-confirm_1a0jo_1",upgradeConfirm:"_upgrade-confirm_1a0jo_1","page-title":"_page-title_1a0jo_7",pageTitle:"_page-title_1a0jo_7","page-subtitle":"_page-subtitle_1a0jo_12",pageSubtitle:"_page-subtitle_1a0jo_12","gap-top-sm":"_gap-top-sm_1a0jo_18",gapTopSm:"_gap-top-sm_1a0jo_18","upgrade-success":"_upgrade-success_1a0jo_21",upgradeSuccess:"_upgrade-success_1a0jo_21",animation:"_animation_1a0jo_29","success-title":"_success-title_1a0jo_33",successTitle:"_success-title_1a0jo_33","footer-container":"_footer-container_1a0jo_38",footerContainer:"_footer-container_1a0jo_38","confirm-btn":"_confirm-btn_1a0jo_38",confirmBtn:"_confirm-btn_1a0jo_38","loading-btn":"_loading-btn_1a0jo_41",loadingBtn:"_loading-btn_1a0jo_41","active-btn":"_active-btn_1a0jo_47",activeBtn:"_active-btn_1a0jo_47"};var pa=({handleReEnable:o,setShowUpgradeConfirm:e,onReenableSuccess:t,upgradeLoading:n})=>{let[a,i]=(0,be.useState)(!1),_=tt({dark:"/static/images/dapp/success-dark.json",light:"/static/images/dapp/success-light.json"}),d=(0,Qn.useMemoizedFn)(()=>{Ee(t)?t():e(!1)}),m=(0,Qn.useMemoizedFn)(async()=>{if(n)return;(await o({expirePeriodDay:null}))?.data&&i(!0)});return a?be.default.createElement("div",{className:ce["upgrade-success"]},be.default.createElement(Ze,{className:ce.animation,path:_,loop:!1}),be.default.createElement("div",{className:ce["success-title"]},s("wallet_extension_function_toast_upgrade_success")),be.default.createElement(ge,{className:ce["footer-container"]},be.default.createElement(N,{className:(0,In.default)(ce["confirm-btn"],ce["active-btn"]),onClick:d,loadingText:s("wallet_extension_function_btn_upgrading"),type:N.TYPE.primary},s("wallet_extension_complete_btn_done")))):be.default.createElement("div",{className:ce["upgrade-confirm"]},be.default.createElement("div",{className:ce["page-title"]},s("wallet_extension_account_header_sa_service_upgrade_required")),be.default.createElement("div",{className:(0,In.default)(ce["page-subtitle"],ce["gap-top-sm"])},s("wallet_extension_account_text_sa_service_upgrade")),be.default.createElement(ge,{className:ce["footer-container"]},be.default.createElement(N,{className:(0,In.default)({[ce["confirm-btn"]]:!0,[ce["active-btn"]]:!n,[ce["loading-btn"]]:n}),loaderProps:{color:"var(--okd-color-content-disabled)"},onClick:m,loading:n,loadingText:s("wallet_extension_function_btn_upgrading"),type:n?N.TYPE.gray:N.TYPE.primary},s("wallet_extension_function_btn_upgrade"))))};c();l();var q=p(D()),Pn=p(ae()),kn=p(Oe());$();c();l();var ee={welcome:"_welcome_1mhs3_1","header-container":"_header-container_1mhs3_9",headerContainer:"_header-container_1mhs3_9",contents:"_contents_1mhs3_14",title:"_title_1mhs3_18","des-item":"_des-item_1mhs3_24",desItem:"_des-item_1mhs3_24","des-icon":"_des-icon_1mhs3_30",desIcon:"_des-icon_1mhs3_30","des-content":"_des-content_1mhs3_40",desContent:"_des-content_1mhs3_40","des-title":"_des-title_1mhs3_45",desTitle:"_des-title_1mhs3_45","des-text":"_des-text_1mhs3_51",desText:"_des-text_1mhs3_51","underline-link":"_underline-link_1mhs3_57",underlineLink:"_underline-link_1mhs3_57",footer:"_footer_1mhs3_63","confirm-btn":"_confirm-btn_1mhs3_63",confirmBtn:"_confirm-btn_1mhs3_63","popup-header":"_popup-header_1mhs3_76",popupHeader:"_popup-header_1mhs3_76","popup-contents":"_popup-contents_1mhs3_83",popupContents:"_popup-contents_1mhs3_83"};var Da=({onConfirm:o})=>{(0,Pn.useMount)(()=>{fo()});let e=(0,Pn.useMemoizedFn)(()=>{o(),Ao()}),t=tt({light:"/static/images/smart-account/welcome-light.json",dark:"/static/images/smart-account/welcome-dark.json"}),n=(0,q.useMemo)(()=>Oo(),[]),a=we(),i=[{icon:"okx-wallet-plugin-rade-simple",title:s("wallet_extension_popup_title_advanced_strat"),description:s("wallet_extension_popup_subtitle_advanced_strat")},{icon:"okx-wallet-plugin-security-completed-filled",title:s("wallet_extension_popup_title_maintain_selfcustody"),description:s("wallet_extension_popup_subtitle_tee_selfcustody",{learn:a.smartAccountWhatIsSmartAccount?q.default.createElement("span",{className:ee["underline-link"],onClick:ie.bind(null,a.smartAccountWhatIsSmartAccount)},s("wallet_extension_home_link_learn_more")):""})}];return q.default.createElement(q.default.Fragment,null,q.default.createElement("div",{className:ee.welcome},q.default.createElement("div",{className:(0,kn.default)({[ee["header-container"]]:!0,[ee["popup-header"]]:n})},q.default.createElement(Ze,{path:t,loop:!1})),q.default.createElement("div",{className:(0,kn.default)({[ee.contents]:!0,[ee["popup-contents"]]:n})},q.default.createElement("div",{className:ee.title},s("wallet_extension_popup_header_smart_account")),q.default.createElement("div",{className:ee.des},i.map(_=>q.default.createElement("div",{className:ee.desItem,key:_.title},q.default.createElement("div",{className:ee["des-icon"]},q.default.createElement(re,{className:(0,kn.default)(_.icon)})),q.default.createElement("div",{className:ee["des-content"]},q.default.createElement("div",{className:ee.desTitle},_.title),q.default.createElement("div",{className:ee["des-text"]},_.description))))))),q.default.createElement(ge,{className:ee.footer},q.default.createElement(N,{className:ee["confirm-btn"],onClick:e,type:N.TYPE.primary,"data-testid":B.WELCOME_BTN},s("wallet_extension_popup_btn_get_started"))))},fa=Da;var La=({onEnableSuccess:o,onExtendSuccess:e,onReenableSuccess:t,onDisableSuccess:n,onExit:a,...i})=>{let{from:_,actionType:d,requestUpgrade:m,showFeature:b}=i,{isFromDex:A,isFromBanner:u,isFromWalletManageCreate:I,isDexEnableAction:P}=wr({from:_,actionType:d}),{isSmartAccountActivatedOnce:E,markActivated:y}=Xo(),{handlePlatformBack:C,handleExtensionClose:X,removeQueryFrom:R,handleExtensionBack:T}=Ar({isFromDex:A,...i}),{showWelcome:z,isCreating:te,isValidating:ue,showDelConfirm:U,showEnableDone:O,showPeriodSheet:V,showUpgradeConfirm:W,showSelectAccount:ye,setIsValidating:J,setShowWelcome:xe,setIsCreating:ve,setShowEnableDone:me,setShowDelConfirm:Ie,setShowPeriodSheet:Ue,setShowUpgradeConfirm:ne,setShowSelectAccount:Re}=Yr({isSmartAccountActivatedOnce:E,isFromDex:A,isFromWalletManageCreate:I,showFeature:b}),{isFundReady:Ye,walletIdentity:G,keyringIdentity:ut,walletCreated:ke,createWalletName:oe,newlyCreatedWalletId:Tt,selectedWalletId:Pe,handleCreateWallet:mt,handleAutoConnectDapp:pt,setSelectedWalletId:Cn}=Zr({...i,isFromDex:A,setIsValidating:J,removeQueryFrom:R,handlePlatformBack:C}),{handleToastTeeNetError:Dt,handleToastReEnableSuccess:ft,handleToastExtendSuccess:gt,handleToastReactivateOrders:bt,handleToastAccountAddedButNotEnable:$t,handleToastAccountAddedAndEnabled:wt,handleToastSAEnableFailed:En,handleToastReEnableFailed:Lt,handleToastExtendFailed:Zt,handleToastTeeMaintenance:Nn}=Xr({isFromDex:A,walletCreated:ke,createWalletName:oe,handlePlatformBack:C,onExit:a}),Tn=Boolean(m),{metadata:ze,teeStatus:le,saActivateRes:ht,isCreated:en,dexOpenOrderNum:Ft,upgradeStatusResponse:Dn,shouldShowUpgrade:Ot,handleReEnable:At,handleEnable:Wt,handleDel:Ln,handleFetchSAData:f,handleRefresh:k}=jr({isFromDex:A,isSmartAccountActivatedOnce:E,walletIdentity:G,showWelcome:z,isValidating:ue,walletCreated:ke,createWalletName:oe,requestUpgrade:Tn,showUpgradeConfirm:W,setIsCreating:ve,setIsValidating:J,markActivated:y,setShowWelcome:xe,handlePlatformBack:C,setShowEnableDone:me,handleExtensionClose:X,handleToastTeeNetError:Dt,handleToastReEnableSuccess:ft,handleToastReactivateOrders:bt,handleToastExtendSuccess:gt,handleToastAccountAddedAndEnabled:wt,handleToastSAEnableFailed:En,handleToastReEnableFailed:Lt,handleToastExtendFailed:Zt,handleToastTeeMaintenance:Nn,onDisableSuccess:n,onExtendSuccess:e,onReenableSuccess:t,handleAutoConnectDapp:pt});Qr({metadata:ze,isCreating:te,isValidating:ue,newlyCreatedWalletId:Tt,handleCreateWallet:mt,handleFetchSAData:f});let K=le===null||ze===null||!Dn||!le.isCreated&&!Ye,{loading:_e,fn:Ve}=he({fn:At}),{hideNavigator:Fn,navigatorProps:Xe}=br({isFromDex:A,showWelcome:z,isCreated:en,showDelConfirm:U,isCreating:te,isShowPageLoading:K,showUpgradeConfirm:W,upgradeLoading:_e,showSelectAccount:ye,onDelConfirmBack:Ie.bind(null,!1),onUpgradeConfirmBack:ne.bind(null,!1),onSelectAccountBack:Re.bind(null,!1),onClose:async()=>{await a?.(),X()},onBack:async()=>{let Jn=ht?.data?.isActive??!1;ke&&oe&&Jn&&O?wt(oe):ke&&oe&&!Jn&&$t(oe),await a?.(),T()}}),Bt=(0,Yn.useMemoizedFn)(()=>{I?(xe(!1),ve(!0)):xe(!1)}),{expirePeriodOptions:Mt,enableValue:On,displayEnableLabel:ga,setEnableValue:Xn}=fr(ze,le),ba=(0,Yn.useMemoizedFn)(async()=>{await pt(),Ee(o)?o():(ke&&oe&&wt(oe),C())}),wa=(0,M.useMemo)(()=>I||z?!1:A?!0:le&&le.isCreated===!1,[z,I,le]),Ce;return!G||!ut?null:(te?Ce=M.default.createElement(aa,{title:s("wallet_extension_account_cell_nav_title_adding_account",{account:oe}),description:s("wallet_extension_account_cell_nav_subtitle_stay_on_page")}):ye?Ce=M.default.createElement(ca,{accountId:G.walletId,setShowSelectAccount:Re,setSelectedWalletId:Cn}):K?Ce=M.default.createElement(cr,null):O&&ht?.data?Ce=M.default.createElement(na,{onConfirm:ba,walletIdentity:G,activateRes:ht.data,handleAutoConnectDapp:pt}):z?Ce=M.default.createElement(fa,{onConfirm:Bt}):W?Ce=M.default.createElement(pa,{handleReEnable:Ve,setShowUpgradeConfirm:ne,upgradeLoading:_e,onReenableSuccess:t}):!ze||!le?Ce=null:U?Ce=M.default.createElement(ea,{orderCount:Ft,teeStatus:le,onDel:Ln}):en&&!P&&!Pe?Ce=M.default.createElement(M.default.Fragment,null,M.default.createElement(ma,{walletIdentity:G,teeStatus:le,shouldShowUpgrade:Ot,setShowPeriodSheet:Ue,setShowUpgradeConfirm:ne,setShowDelConfirm:Ie,handleFetchSAData:f}),M.default.createElement(Mn,{needSelectPeriodFirst:!0,visible:V,enableValue:On,expirePeriodOptions:Mt,setEnableValue:Xn,setVisible:Ue,metadata:ze,teeStatus:le,onRefresh:k,onEnable:Wt,onUpgrade:At,shouldShowUpgrade:Ot})):Ce=M.default.createElement(M.default.Fragment,null,M.default.createElement(ra,{walletIdentity:G,metadata:ze,teeStatus:le,onEnableSuccess:o,onExit:a,handleExtensionBack:T,isFromBanner:u,isFromDex:A,setShowSelectAccount:Re,setShowPeriodSheet:Ue,displayEnableLabel:ga,handleAutoConnectDapp:pt,handleEnable:Wt,handleReEnable:At,enableValue:On}),M.default.createElement(Mn,{needSelectPeriodFirst:!1,visible:V,enableValue:On,expirePeriodOptions:Mt,setEnableValue:Xn,setVisible:Ue,metadata:ze,teeStatus:le,onRefresh:k,onEnable:Wt,onUpgrade:At,shouldShowUpgrade:Ot})),M.default.createElement(M.default.Fragment,null,M.default.createElement(Po.Container,{style:{display:"flex",flexDirection:"column"}},Fn?null:M.default.createElement(Ro,{bordered:!1,...Xe}),M.default.createElement("div",{style:{flex:1,display:"flex",flexDirection:"column"}},Ce)),wa?M.default.createElement(pr,{accountId:G.walletId,teeId:G.teeId}):null))},ep=La;export{ep as a};
//# sourceMappingURL=chunk-AJUPWK5D.js.map
