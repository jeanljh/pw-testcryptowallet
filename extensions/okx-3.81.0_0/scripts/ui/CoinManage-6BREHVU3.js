import{a as Me}from"./chunk-SBTBASYY.js";import{a as W,c as H}from"./chunk-LY5BPYXI.js";import{b as Fe}from"./chunk-6S2Q4SIT.js";import{a as Ee,b as Te}from"./chunk-YRSRYUIR.js";import"./chunk-3NE3KUUV.js";import{a as Ne}from"./chunk-T4MGJ7E6.js";import"./chunk-QGIEUVEJ.js";import{a as N}from"./chunk-WEPJKKBH.js";import{a as ke}from"./chunk-5QYLVV6H.js";import"./chunk-S7VT2TWF.js";import"./chunk-BNS5ABAB.js";import{d as be}from"./chunk-ZDHJHPQ5.js";import"./chunk-WY5R5HAR.js";import{c as we,d as D}from"./chunk-AP337SRV.js";import"./chunk-TF4QEXO7.js";import"./chunk-CHMHYYPI.js";import"./chunk-GDQAWT2G.js";import"./chunk-JHO7RU36.js";import"./chunk-5A7EFNRM.js";import"./chunk-NA6P5YCH.js";import"./chunk-F2SPBGOT.js";import{e as h}from"./chunk-SYOIP55B.js";import"./chunk-V7ZNWTMX.js";import"./chunk-MSP5TDR3.js";import"./chunk-VWGNVM37.js";import"./chunk-QKBWJPY2.js";import"./chunk-XFPD3Q2E.js";import"./chunk-AFJBSSNA.js";import{Q as fe}from"./chunk-3ZKJXYZ4.js";import{c as Ie}from"./chunk-EBRJSEEJ.js";import"./chunk-PA7QUJH7.js";import"./chunk-MC7IOE6A.js";import"./chunk-N4IVZOUG.js";import"./chunk-JWVIZID6.js";import"./chunk-33XRMYWN.js";import"./chunk-ZOKF3EKQ.js";import"./chunk-MDBKHBHQ.js";import"./chunk-WRVJM3F3.js";import{a as ve}from"./chunk-NYBKFEEM.js";import"./chunk-XVSXMJ3S.js";import"./chunk-KQ66JTF7.js";import{c as Ae}from"./chunk-OOYDFTEF.js";import{a as V}from"./chunk-JNIP4OYT.js";import"./chunk-XRCQOGA2.js";import"./chunk-SWUBCABA.js";import"./chunk-EEIYH3NC.js";import"./chunk-ITDLKQAF.js";import"./chunk-44SDMU5C.js";import"./chunk-U7IWD6UB.js";import"./chunk-CZBL7QEK.js";import"./chunk-PAJAZXOA.js";import{b as xe}from"./chunk-7MCLPJAH.js";import"./chunk-WAIJPY5X.js";import{h as Se}from"./chunk-YGMRSF47.js";import"./chunk-6XGS36TZ.js";import"./chunk-M2YY6A5T.js";import"./chunk-XLG73W5Q.js";import{I as Le,J as z,a as ye}from"./chunk-GCS2RK7E.js";import"./chunk-OIPQWTNV.js";import{f as ge}from"./chunk-VJI6MZK4.js";import"./chunk-5PRURJ2O.js";import{u as x}from"./chunk-FGAB46RQ.js";import"./chunk-47ZMUKCZ.js";import{o as k}from"./chunk-Z62JX42S.js";import{C as ce,H as ue,Na as mo,O as pe}from"./chunk-2QHGKEME.js";import"./chunk-B624VS3G.js";import"./chunk-W4SQ6335.js";import"./chunk-YDSDBRIT.js";import{a as he}from"./chunk-6PA65BO3.js";import"./chunk-OIXGC4LI.js";import"./chunk-MAAUVUWY.js";import"./chunk-4X64L7DZ.js";import"./chunk-WU2LB6XB.js";import{l as Ce}from"./chunk-GLL4BXR6.js";import"./chunk-4L5HWMAA.js";import"./chunk-EZS2GR7E.js";import"./chunk-NUN72MDU.js";import"./chunk-BFWVIVOY.js";import"./chunk-S3FOFXM7.js";import"./chunk-YIFLUVTR.js";import"./chunk-EN2WHAVL.js";import"./chunk-CP2RIMI2.js";import"./chunk-3QLLFUC4.js";import"./chunk-EFOY37CC.js";import{c as A}from"./chunk-HMTT52FG.js";import"./chunk-45NMMWRA.js";import"./chunk-E4OV5WXB.js";import{b as me,c as io}from"./chunk-GR7YC6C3.js";import{E as _e,J as ao}from"./chunk-O33H5V3V.js";import"./chunk-DJN2J7J5.js";import"./chunk-35ANKHOJ.js";import"./chunk-BI4OEIFC.js";import{Mb as le,Sb as so}from"./chunk-COF7YKSN.js";import{A as c,K as F}from"./chunk-VZKEX7KP.js";import"./chunk-QCEQQDCM.js";import{q as Q,y as de}from"./chunk-BJKBO23H.js";import"./chunk-IO3ALUOJ.js";import"./chunk-AHVVUOFF.js";import"./chunk-DJSNVDZI.js";import"./chunk-K336SGW3.js";import"./chunk-XFTQD4B2.js";import"./chunk-FOOC6LB7.js";import"./chunk-DHKS44RQ.js";import"./chunk-4DBVFCYR.js";import"./chunk-2IGQWLAB.js";import"./chunk-GVV6OTQP.js";import{t as se,u as B}from"./chunk-ZFVABNQN.js";import"./chunk-VYWNZTTM.js";import"./chunk-LBWWOQL4.js";import{a as ae}from"./chunk-4QGZDIBD.js";import{b as C}from"./chunk-73B6GL3S.js";import"./chunk-LVJGLJNA.js";import"./chunk-Z7PBP7IJ.js";import"./chunk-5F7M5EJ4.js";import"./chunk-RQWEJ5N6.js";import"./chunk-RNWGOGLT.js";import"./chunk-UGJ3FMEQ.js";import"./chunk-OPJRP6YV.js";import"./chunk-H6JAOQCX.js";import"./chunk-OJXBW2YQ.js";import"./chunk-Z2AIGJGI.js";import"./chunk-VBZ4JSJ6.js";import"./chunk-LBYXY63E.js";import"./chunk-M4ANCDMF.js";import"./chunk-J6KTJ3IN.js";import"./chunk-5CQODPK7.js";import"./chunk-C5XO4JMZ.js";import"./chunk-HI3LE734.js";import"./chunk-RX4V72AK.js";import{f as s,o as r,q as n}from"./chunk-Y5OH3DDZ.js";r();n();var d=s(C()),Xe=s(he()),eo=s(ae());F();r();n();var q=s(C());F();r();n();var y={"list-title":"_list-title_6m0y6_1",listTitle:"_list-title_6m0y6_1","empty-box":"_empty-box_6m0y6_6",emptyBox:"_empty-box_6m0y6_6","search-text":"_search-text_6m0y6_10",searchText:"_search-text_6m0y6_10","coin-box":"_coin-box_6m0y6_13",coinBox:"_coin-box_6m0y6_13","icon-add":"_icon-add_6m0y6_13",iconAdd:"_icon-add_6m0y6_13","icon-remove":"_icon-remove_6m0y6_16",iconRemove:"_icon-remove_6m0y6_16","icon-not-remove":"_icon-not-remove_6m0y6_20",iconNotRemove:"_icon-not-remove_6m0y6_20","clear-icon":"_clear-icon_6m0y6_24",clearIcon:"_clear-icon_6m0y6_24"};var Be=({renderCoin:e,list:o})=>o?.length?q.default.createElement(A.Box,null,q.default.createElement(x.Text,{className:y.listTitle,size:x.SIZE.xs,type:x.TYPE.secondary},c("wallet_manage_crypto_list_added_crypto")),q.default.createElement(h,{itemKey:"coinId",renderEmpty:!1,renderItem:e,dataSource:o})):null;r();n();var G=s(C()),Pe=s(k());F();so();var X=({coin:e,deleteAddedCoinAbled:o,onAction:t,isSearchStatus:a})=>{let[i]=ve(),m="",_="",u=Te(),p=e?.aggregation;e?.added?o?(m="okx-wallet-plugin-take",_="icon-remove"):(m="okx-wallet-plugin-take",_="icon-not-remove"):(m="okx-wallet-plugin-add",_="icon-add");let g=ue({coinId:e?.baseCoinId})&&!!e?.address,w=a&&!p&&!g&&!!e?.address,S=(0,Pe.useCreation)(()=>u(e),[e?.coinId,u]);return G.default.createElement(h.Coin,{className:y["coin-box"],hovered:!1,name:e?.coinId===le?e?.chainName:e?.name,icon:e.image,symbol:e.symbol,address:w&&`${c("wallet_manage_crypto_label_contract_address")}: ${ce(e?.address)}`,tag:p?c("wallet_manage_crypto_labels_crypto_multichain"):e.tokenType,hidden:i,balance:S?e.coinAmount:void 0,market:S?e.currencyAmount:void 0,displayPrecision:e?.displayPrecision??e?.childrenCoin?.[0]?.displayPrecision,stableCoin:e?.stableCoin??e?.childrenCoin?.[0]?.stableCoin},!S&&e?.added?G.default.createElement(Ee,{coinId:e?.coinId,from:Le}):G.default.createElement(Ae.IconButton,{className:y[_],disabled:e?.added&&!o,onClick:()=>{t(e)},icon:{icon:m}}))};r();n();var Z=s(C()),Ue=s(ae());var Oe=Z.default.memo(({search:e,setSearch:o,spinLoading:t})=>!e||e.length===0?null:t?Z.default.createElement(B.Circle,{size:B.SIZE.sm}):Z.default.createElement(se,{className:(0,Ue.default)("okx-wallet-plugin-clear-filled",y.clearIcon),onClick:()=>{o("")}}));r();n();var ee=s(C());r();n();var Re=s(C()),ze=s(he());F();var De=()=>{let e=(0,ze.useHistory)();return Re.default.createElement(de.State,{className:y["empty-box"],title:c("wallet_search_text_search_no_results"),buttonText:c("wallet_manage_crypto_text_add_custom_crypto"),onButtonClick:()=>{e.push(z)}})};var We=({loadingMore:e,searchCoins:o,renderCoin:t,spinLoading:a})=>ee.default.createElement(h,{itemKey:"coinId",dataSource:o,renderItem:t,loadingMore:e,renderEmpty:()=>a?null:ee.default.createElement(De,null)});r();n();var E=s(C());F();var He=(0,E.forwardRef)(({unAddedLoadingMore:e,renderCoin:o,unAddedList:t})=>t.length===0?null:E.default.createElement(A.Box,null,E.default.createElement(x.Text,{className:y.listTitle,size:x.SIZE.xs,type:x.TYPE.secondary},c("wallet_manage_crypto_subtitle_popular_crypto")),E.default.createElement(h,{itemKey:"coinId",renderEmpty:!1,renderItem:o,dataSource:t,loadingMore:e})));r();n();var te=s(k());r();n();var oe=s(C()),qe=s(k());function K(e,o){let t=(0,oe.useRef)(null),a=(0,oe.useRef)(Date.now());return(0,qe.useMemoizedFn)((...m)=>{t.current||(e(...m),a.current=Date.now(),t.current=setTimeout(()=>{t.current=null},o))})}r();n();var Y=(e,o)=>{if(e.aggregation){let t=o(e.childrenCoin);return{...e,childrenCoin:t}}return e};var $=()=>{let e=ke(),o=N();return(0,te.useCreation)(()=>Ce(e,o).map(i=>({...i,added:!0})),[e])},j=(e=[])=>(0,te.useCreation)(()=>new Set(e.map(o=>o.aggregation?o.symbol:o.coinId)),[e]),Ge=()=>{let e=W();return K(async o=>{let t=Y(o,e);await D(t)},500)};r();n();var Ze=s(C()),Ke=s(mo());var Ye=()=>{let{currentNetworkUniqueId:e}=(0,Ke.useSelector)(ge),o=Ie({netWorkId:e?String(e):void 0}),{supportNetworkList:t,loading:a,run:i}=Fe(),m=(0,Ze.useMemo)(()=>{if(!t||t.length===0)return!1;let p=o?.coinId;return p?t.some(g=>g.coinId===p):!0},[t,o?.coinId]),_="";if(e!==""){let p=o?.coinId;_=(t||[]).find(g=>g.coinId===p)?.name||""}let u=`${z}?network=${_}`;return{supportCustomCoin:m,customCryptoPath:u,supportNetworkListLoading:a,reloadSupportNetworkData:i}};r();n();var b=s(C()),P=s(k());var $e=()=>{let e=N(),[o,t]=(0,b.useState)(""),a=(0,P.useDebounce)(o,{wait:500}),i=(0,b.useCallback)(v=>{t(v.target.value)},[]),m=$(),[_,u]=(0,b.useState)(!0),p=j(m),g=(0,P.useCreation)(()=>a?m.filter(v=>v.symbol?.toLowerCase().includes(a.toLowerCase())||v.address?.toLowerCase()===a.toLowerCase()):[],[m,a]);(0,b.useEffect)(()=>{u(!!o)},[o]);let{data:w,loadingMore:S,listRef:f}=H({symbolLike:a,aggregation:!0,chainIds:e?[Number(e)]:void 0},{reloadDeps:[a],enableEmptyAccountCoins:!0,beforeRequest:()=>{if(!a)return{list:[],pageNo:0,isNoMore:!0}},onFinally(){u(!1)}}),I=(0,P.useCreation)(()=>{let T=(w?.list??[]).filter(L=>!p.has(L.aggregation?L.symbol:L.coinId));return[...g,...T]},[w?.list,g]);return{searchListRef:f,search:o,searchCoins:I,searchLoading:_,searchLoadingMore:S,onSearch:i,setSearch:t}};r();n();r();n();var je=s(k());ao();io();function Je(){let e=Se();return(0,je.useMemoizedFn)(async o=>{try{let{code:t}=await _e(me.registerCustomCoinAddr,{coinAddrRegisterList:[{accountId:e,coinId:o}]},{needSign:!0});return t===0}catch{return!1}})}var Qe=()=>{let e=W(),o=Je();return K(async t=>{let a=pe(t),i;if(a){if(i=await fe(t),!i)return}else i=t;i=Y(i,e),t.added?await D(i):await o(i.coinId)&&await we(i)},500)};r();n();var U=s(C()),O=s(k());var Ve=(e=[],o)=>{let t=N(),a=Ne(),i=j(e),m=(0,O.useCreation)(()=>Array.from(new Set(Me(e).map(L=>L.coinId))),[e]),{data:_,loading:u,loadingMore:p,listRef:g,reload:w}=H({aggregation:!0,chainIds:t?[Number(t)]:void 0,excludeCoinIds:m},{enable:!a,reloadDeps:[t],enableEmptyAccountCoins:!0}),S=(0,O.usePrevious)(i.size),f=i.size<S;(0,U.useEffect)(()=>{!o&&f&&w()},[f,i.size,o]);let I=(0,O.useCreation)(()=>_?.list?.filter(M=>!i.has(M.aggregation?M.symbol:M.coinId))??[],[_?.list,e])??[],[v,T]=(0,U.useState)(!0);return(0,U.useEffect)(()=>{u||T(!1)},[u]),{unAddedList:I,unAddedListRef:g,unAddedLoading:v,unAddedLoadingMore:p}};r();n();var R={"wallet-coin__manage":"_wallet-coin__manage_1imve_1",walletCoinManage:"_wallet-coin__manage_1imve_1","wallet-coin__manage__search":"_wallet-coin__manage__search_1imve_4",walletCoinManageSearch:"_wallet-coin__manage__search_1imve_4","wallet-coin__manage__spin":"_wallet-coin__manage__spin_1imve_8",walletCoinManageSpin:"_wallet-coin__manage__spin_1imve_8","wallet-coin__manage__spin__hidden":"_wallet-coin__manage__spin__hidden_1imve_11",walletCoinManageSpinHidden:"_wallet-coin__manage__spin__hidden_1imve_11","wallet-coin__manage__spin__auto":"_wallet-coin__manage__spin__auto_1imve_14",walletCoinManageSpinAuto:"_wallet-coin__manage__spin__auto_1imve_14","wallet-coin__manage__spin__custom":"_wallet-coin__manage__spin__custom_1imve_17",walletCoinManageSpinCustom:"_wallet-coin__manage__spin__custom_1imve_17","wallet-coin__manage__tag__title":"_wallet-coin__manage__tag__title_1imve_21",walletCoinManageTagTitle:"_wallet-coin__manage__tag__title_1imve_21","fade-enter":"_fade-enter_1imve_25",fadeEnter:"_fade-enter_1imve_25","fade-added-enter":"_fade-added-enter_1imve_26",fadeAddedEnter:"_fade-added-enter_1imve_26","fade-enter-active":"_fade-enter-active_1imve_30",fadeEnterActive:"_fade-enter-active_1imve_30","fade-added-enter-active":"_fade-added-enter-active_1imve_31",fadeAddedEnterActive:"_fade-added-enter-active_1imve_31",fade:"_fade_1imve_25","fade-added":"_fade-added_1imve_26",fadeAdded:"_fade-added_1imve_26","fade-leave-active":"_fade-leave-active_1imve_41",fadeLeaveActive:"_fade-leave-active_1imve_41","fade-added-leave-active":"_fade-added-leave-active_1imve_42",fadeAddedLeaveActive:"_fade-added-leave-active_1imve_42"};var _o=()=>{let e=(0,Xe.useHistory)(),{customCryptoPath:o,supportCustomCoin:t,supportNetworkListLoading:a,reloadSupportNetworkData:i}=Ye(),{searchListRef:m,search:_,searchCoins:u,onSearch:p,searchLoading:g,searchLoadingMore:w,setSearch:S}=$e(),f=!!_,I=$(),{unAddedList:v,unAddedListRef:T,unAddedLoading:L,unAddedLoadingMore:M}=Ve(I,f),oo=Ge(),re=I?.length>1,to=Qe();(0,d.useEffect)(()=>{i()},[]);let ro=J=>d.default.createElement(X,{isSearchStatus:f,coin:J,onAction:oo,deleteAddedCoinAbled:re}),ne=J=>d.default.createElement(X,{isSearchStatus:f,coin:J,deleteAddedCoinAbled:re,onAction:to}),ie=_?g:L,no=c("wallet_manage_crypto_placeholder_search_coin");return d.default.createElement(A.Container,{className:"wallet-coin__manage"},d.default.createElement(xe,{offsetTop:0,style:{zIndex:100}},d.default.createElement(be,{sticky:!1,closeable:!1,onBack:()=>{e.push(ye)},title:c("wallet_manage_crypto_maintitle_manage_crypto")}),d.default.createElement(A.Box,{className:R["wallet-coin__manage__search"]},d.default.createElement(Q.Search,{value:_,size:Q.SIZE.md,placeholder:no,onChange:p,cleanable:!1,suffix:d.default.createElement(Oe,{search:_,setSearch:S,spinLoading:ie}),"data-testid":V.COIN_MANAGEMENT_PAGE.SEARCH_INPUT}))),d.default.createElement(A.Spin,{ref:f?m:T,className:(0,eo.default)(R["wallet-coin__manage__spin"],R["wallet-coin__manage__spin__auto"]),loading:!1,size:B.SIZE.lg},!f&&!!t&&d.default.createElement(A.Spin,{loading:a&&!L},d.default.createElement(h.Cell,{"data-testid":V.COIN_MANAGEMENT_PAGE.CUSTOM_COIN,className:R["wallet-coin__manage__spin__custom"],isLink:!0,to:o,title:c("wallet_manage_crypto_text_custom_crypto")})),f&&d.default.createElement(We,{itemKey:"coinId",searchCoins:u,renderCoin:ne,spinLoading:ie,loadingMore:w}),!f&&d.default.createElement(Be,{list:I,renderCoin:ro}),!f&&d.default.createElement(He,{unAddedList:v,unAddedLoading:L,unAddedLoadingMore:M,renderCoin:ne})))},Mr=d.default.memo(_o);export{Mr as default};
//# sourceMappingURL=CoinManage-6BREHVU3.js.map
