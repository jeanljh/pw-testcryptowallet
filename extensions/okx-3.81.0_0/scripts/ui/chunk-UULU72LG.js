import{c as $e}from"./chunk-ARK47WR5.js";import{e as _}from"./chunk-BF6TFHGA.js";import{b as h}from"./chunk-F57QKCZQ.js";import{I as g,J as p,S as $,T as He,e as We,j as ve,k as Pe,l as Ve,m as P,ma as Ge}from"./chunk-HIVYZXF3.js";import{a as Fe}from"./chunk-4Y52FA3V.js";import{a as Be}from"./chunk-ZYYACLV7.js";import{a as Je}from"./chunk-ANWN6BF6.js";import{c as qe,d as Ke,e as Ye}from"./chunk-A2QIZMPL.js";import{b as J}from"./chunk-7I4OPLNV.js";import{d as De,t as O}from"./chunk-FGRS6VIX.js";import{A as he,Bc as Le,Cc as xe,Dc as be,Ec as Q,Fb as Y,Fc as ye,Ga as T,Gc as Oe,Hb as ge,Hc as ke,Ic as Me,K,Mb as c,Nc as Ne,P as y,Pb as Ce,Tb as Te,Wb as _e,Zb as Se,ac as X,bc as Ie,ea as fe,fa as f,ga as v,hd as we,mc as Ee,nc as j,oc as Ae,pc as Re,rb as A,ud as Ue}from"./chunk-INIQCRIO.js";import{d as Xe,g as je,h as Qe}from"./chunk-2P6PTKAN.js";import{a as q}from"./chunk-6Z5HVUBK.js";import{F as pe,G as W,c as b,d as ue,da as E,k as D,n as me}from"./chunk-ZBDGRK4Q.js";import{a as dt}from"./chunk-HAHRUU64.js";import{K as lt,a as G}from"./chunk-VZKEX7KP.js";import{E as ce,j as I,pa as F,va as H}from"./chunk-XFTQD4B2.js";import{b as w}from"./chunk-73B6GL3S.js";import{f as x,h as r,o as s,q as n}from"./chunk-Y5OH3DDZ.js";s();n();s();n();lt();var ct=G()?()=>{}:()=>document.body,_t=G()?void 0:window.getComputedStyle;s();n();s();n();s();n();s();n();s();n();s();n();var ze=x(w());function mt({children:i,...e}){return ze.default.createElement(pe,{fetchConfig:Ue.fetchConfig,...e},i)}s();n();s();n();H();s();n();var U=[A.BTC_MAINNET,A.TON_MAINNET];s();n();var Ze=(i,e)=>{let t=i.split(".").map(Number),o=e.split(".").map(Number),a=Math.max(t.length,o.length);for(let d=0;d<a;d++){let u=t[d]||0,m=o[d]||0;if(u>m)return 1;if(u<m)return-1}return 0};var k=class{constructor(){r(this,"commonStore",null);r(this,"userForbiddenWithBridge",K);r(this,"setUserForbiddenBridge",e=>{this.userForbiddenWithBridge=e});r(this,"defaultWalletConfig",ge);r(this,"walletConfig",this.defaultWalletConfig);r(this,"hasInitWalletInfo",!1);r(this,"setHasInitWalletInfo",e=>{this.hasInitWalletInfo=e});r(this,"chainId",_);r(this,"setChainId",e=>{this.chainId=e});r(this,"fromChainId",_);r(this,"setFromChainId",e=>{this.fromChainId=e});r(this,"addressType","");r(this,"setAddressType",e=>{this.addressType=e});r(this,"walletSupportMev",!1);r(this,"setWalletSupportMev",e=>{this.walletSupportMev=e});r(this,"checkOkxVersion",async()=>{let e="2.82.31",t=this.walletConfig.isOkxWallet;if(this.isConnectedWallet&&t&&window?.okxwallet?.getVersion){let o=await window.okxwallet.getVersion(),d=Ze(o,e)>=0;this.setWalletSupportMev(d)}else this.setWalletSupportMev(!1)});r(this,"signWalletChainId",A.ETHEREUM_MAINNET)}getDeviceId(){}getChainId(){}get scanAppType(){throw new Error("scanAppType is not defined")}get walletType(){throw new Error("walletType is not defined")}get address(){return _}get computedForbiddenBridge(){let{computedIsCrossChain:e}=I(this.rootStore,"fromToStore",{});return e?this.userForbiddenWithBridge:K}get computedAccountId(){let{walletConfig:e}=this;return e.walletId}setWalletConfig(e={}){this.walletConfig=e}getAddressByChainId(){}get isConnectedWallet(){return!!this.walletConfig.walletId}get computedNonsupportChain(){return!this.isConnectedWallet||!O(this.fromChainId)?!1:!this.address}get computedAccountWalletAddresses(){return F(I(this,"walletConfig.address",[])).join(",")||this.address}get computedAccountWalletAddressesArray(){return F(I(this,"walletConfig.address",[]))||[this.address]}get computedMultiAddresses(){let e=[],t=[];return U.forEach(o=>{let a=this.getAddressByChainId(o);a&&(e.push(o),t.push(a))}),{targetChainId:e.join(),targetWalletAddress:t.join()}}setSignWalletChainId(e){this.signWalletChainId=e}get computedSignWalletAddress(){let e=this.computedAccountWalletAddressesArray;return e?.length===1?e[0]:this.getAddressByChainId(this.signWalletChainId)}cleanWalletConfig(){this.walletConfig=this.defaultWalletConfig,this.hasInitWalletInfo=!1}};s();n();s();n();function M(i=[],e=[]){let t={};i.forEach(a=>{t[a]=b});let o={};return e.forEach(a=>{o[a]=ue}),{...t,...o}}var et=M(["walletConfig","chainId","hasInitWalletInfo","fromChainId","addressType"],["computedAccountId","isConnectedWallet","computedNonsupportChain","computedAccountWalletAddresses","computedAccountWalletAddressesArray","address","computedMultiAddresses"]);var z=class extends k{constructor(t){super();r(this,"formatWalletType",()=>{let{walletInfo:t}=E,{isHARDWARE:o,isMNEMONIC:a,isMPC:d,isPRIVATE:u}=t?.walletType||{};return o?y.HARDWARE:a?y.MNEMONIC:d?y.MPC:u?y.PRIVATE_KEY:null});r(this,"formatWalletAccount",t=>{let o=Object.values(t.account);return{...t,OKXWalletType:this.formatWalletType(),address:o}});r(this,"keyringIdentityTypeEnum",{});r(this,"walletList",[]);r(this,"addressBookList",[]);r(this,"hasInitWalletInfo",!1);r(this,"getAddressByChainId",t=>{if(!O(t))return _;let o=this.getWalletChainName(t);return this.walletConfig.account?.[o]||_});this.rootStore=t,this.commonStore=t.commonStore,D(this,et)}async getDeviceId(){let{devid:t}=await E.localStore.get("devid");return t}getCurrentChainAddress(t){let o=this.rootStore?.fromToStore.from.chainId;if(!O(o))return _;let a=this.getWalletChainName(o);return t.account[a]}getWalletChainName(t){return E.getNetWorkName(t)}replaceAddressByType(t){if(this.addressType){let o={};return U.forEach(a=>{let d=this.getWalletChainName(a);if(t.account?.[d]){let m=t.accountsMap?.[d]?.[this.addressType]?.address;m&&(o[d]=m)}}),{...t,account:{...t.account,...o}}}return t}setWalletConfig(t){this.walletConfig=this.formatWalletAccount(this.replaceAddressByType(t)),this.hasInitWalletInfo=!0}webSwapHistoryDetailViewMore(){}setAddressBookList(t){this.addressBookList=t}setWalletList(t){this.walletList=t.map(o=>o.walletId===this.computedAccountId?this.replaceAddressByType(o):o)}setKeyringIdentityTypeEnum(t){this.keyringIdentityTypeEnum=t}get address(){return this.getAddressByChainId(this.fromChainId)}},Fr=z;s();n();s();n();var ee=x(w());H();s();n();var Xr={FROM:"FROM",TO:"TO"},jr={COMMON:"COMMON",COLLECTION:"COLLECTION"},C={COLLECT_LIST:"COLLECT_LIST",ALL_NETWORK:"ALL_NETWORK",CHAIN_LIST:"CHAIN_LIST",SEARCH:"SEARCH",ALL_TOKENS:"ALL_TOKENS",HISTORY_LIST:"HISTORY_LIST"},pt={[C.COLLECT_LIST]:{[c.SWAP]:Q,[c.LIMIT_ORDER]:Q,[c.BRIDGE]:ye},[C.ALL_NETWORK]:{[c.SWAP]:xe,[c.LIMIT_ORDER]:Le,[c.BRIDGE]:be},[C.SEARCH]:{[c.SWAP]:ke,[c.LIMIT_ORDER]:Oe,[c.BRIDGE]:Me},[C.CHAIN_LIST]:{[c.ORDERS]:j,[c.SWAP]:j,[c.LIMIT_ORDER]:Re,[c.BRIDGE]:Ae},[C.ALL_TOKENS]:{[c.SWAP]:X,[c.LIMIT_ORDER]:X,[c.BRIDGE]:Ie},[C.HISTORY_LIST]:{[c.SWAP]:Te,[c.LIMIT_ORDER]:_e,[c.BRIDGE]:Se}},Z=(i,e)=>pt[i]?.[e]??"";var N=class{constructor(e){r(this,"watchTopDomRef",(0,ee.createRef)());r(this,"watchBottomDomRef",(0,ee.createRef)());r(this,"rootStore",null);r(this,"userUniqueId",We.initUniqueId());r(this,"chainListFreshCount",0);r(this,"chainList",[]);r(this,"setChainList",e=>{this.chainList=e,this.chainListFreshCount+=1});r(this,"transactionLoading",!1);r(this,"setTransactionLoading",e=>{this.transactionLoading=e});r(this,"nowCurrencyUnit",{});r(this,"tokenModalVisible",!1);r(this,"safemoonSlippage",0);r(this,"getChainListUrl",({isHistory:e,currentTab:t})=>{let o=Z(C.CHAIN_LIST,this.currentTab||t);return e&&(o=Z(C.CHAIN_LIST,t||this.currentTab)),o});r(this,"fetchChainList",async({businessLine:e=1,isLimit:t=!1,isHistory:o=!1,currentTab:a,chainIdConfig:d={}})=>{if(me())return[];let u=this.getChainListUrl({isHistory:o,isLimit:t,currentTab:a}),[m,R]=await W(h.get(u,{params:{businessLine:t?Ce.LIMIT_ORDER:e,...d}}));if(m)return p.error(g.CHAIN_LIST_LOAD_ERROR,{error:m}),[];let S=R?.data||[];return S.length||p.info(g.TOKEN_LIST_FETCH_RESULT_EMPTY,{data:{isLimit:t,isHistory:o,currentTab:a}}),!o&&this.setChainList(S),this.setCurrentTabChainList({[a||this.currentTab]:S}),S});r(this,"currentTabChainList",{});r(this,"setCurrentTabChainList",e=>{this.currentTabChainList={...this.currentTabChainList,...e}});r(this,"getTradeType",()=>this.rootStore?.fromToStore?.computedIsCrossChain?Y.MULTI:Y.SINGLE);r(this,"globalMessages",null);r(this,"setGlobalMessage",e=>{this.globalMessages=e});r(this,"cleanGlobalMessage",()=>{this.globalMessages=null});r(this,"socketStatus",!1);r(this,"balancePushSocketStatus",!1);r(this,"resetFromToByTabChange",!1);r(this,"setResetFromToByTabChange",e=>{this.resetFromToByTabChange=e});r(this,"portal",f.DEX);r(this,"setPortal",e=>{this.portal=e});r(this,"currencyConversion",e=>{let{usdToThisRate:t}=this.nowCurrencyUnit,o=q.BigNumber(e);return!t||o.isNaN()?"":o.multipliedBy(t)});r(this,"currencyReConversion",e=>{let{usdToThisRate:t}=this.nowCurrencyUnit,o=q.BigNumber(e);return!t||o.isNaN()?"":o.dividedBy(t).toString()});r(this,"isSensitiveChain",e=>this.computedSensitiveChainIds.some(t=>String(t)===String(e)));r(this,"getTokenAddress",e=>qe(e,this.isSensitiveChain(e?.chainId)));r(this,"equalsChainId",(e,t)=>Ke(e,t));r(this,"equalsToken",(e,t)=>{let o=this.isSensitiveChain(e?.chainId);return Ye(e,t,o)});r(this,"fromFillToken",!1);r(this,"currentTab","");r(this,"setCurrentTab",(e,t)=>{this.currentTab!==e&&(this.setResetFromToByTabChange(!0),this.rootStore?.fromToStore?.clearFromTo()),this.currentTab=e,this.fromFillToken=!!t});r(this,"forceUpdateFromToByHash",0);r(this,"forceUpdateFromTo",()=>{this.forceUpdateFromToByHash+=1});r(this,"isFirstInit",!0);r(this,"visibleAddFunds",!1);r(this,"setAddFundsVisible",e=>{this.visibleAddFunds=e});r(this,"currencyConversionWithSymbol",(e,t={})=>{let o=this.currencyConversion(e).toString(),a=this.computedNowCurrencySymbol;return De(o,a,t)});r(this,"disclaimerVisible",$e());r(this,"setDisclaimerVisible",e=>{this.disclaimerVisible=e});r(this,"buySellAmountChangedCount",0);r(this,"triggerBuySellAmountChanged",()=>{this.buySellAmountChangedCount+=1});r(this,"tradeTokenChangeMsg",{fromModule:"",tradeDirection:"",token:{},msgId:""});r(this,"sendTradeTokenChangeMsg",({fromModule:e,tradeDirection:t,token:o})=>{this.tradeTokenChangeMsg={fromModule:e,tradeDirection:t,token:o,msgId:`${e}-${t}-${new Date().getTime()}`}});this.rootStore=e,Je&&this.setPortal(f.LEDGER)}setChainType(){}get computedReserveGas(){let{chainList:e}=this,t=I(this.rootStore,"fromToStore.from.chainId");return e.find(a=>Number(a.chainId)===Number(t))?.reserveGas||""}getChainByID(e){return this.chainList.find(t=>(this.computedCurrentTabIsLimit||t.chainUsed)&&t.chainId===Number(e))}getUserUnit(){}get computedRealSlippageValue(){return I(this,"rootStore.slippageStore",{}).computedRealSlippageValue||0}setSocketStatus(e){this.socketStatus=e}setBalanceSocketStatus(e){this.balancePushSocketStatus=e}get computedIsWalletEnv(){return this.portal===f.OKX_WALLET_EXTENSION}get computedIsWalletDashBoard(){return this.portal===f.WALLET_DASHBOARD}get computedIsMarket(){return this.portal===f.MARKET}get computedNotThirdBiz(){return this.portal===f.OKX_WALLET_EXTENSION||this.portal===f.DEX||this.portal===f.MARKET}get computedNowCurrencySymbol(){return this.nowCurrencyUnit.symbol||""}get computedSensitiveChainIds(){return this.chainList.map(e=>Number(e.isSensitive)===he.YES?e.chainId:null).filter(Boolean)}get computedCurrentTabIsLimit(){return this.currentTab===c.LIMIT_ORDER}get computedIsUrlFillSwap(){return this.computedIsWalletDashBoard||this.computedIsWalletEnv}setIsFirstInit(e){this.isFirstInit=e}get computedTradeTokenChangeMsgId(){return this.tradeTokenChangeMsg.msgId}};s();n();var tt=M(["userUniqueId","chainList","transactionLoading","nowCurrencyUnit","tokenModalVisible","safemoonSlippage","globalMessages","socketStatus","balancePushSocketStatus","portal","currentTab","currentTabChainList","forceUpdateFromToByHash","isFirstInit","visibleAddFunds","disclaimerVisible","buySellAmountChangedCount","tradeTokenChangeMsg"],["computedReserveGas","computedNowCurrencySymbol","computedSensitiveChainIds","computedIsWalletEnv","computedCurrentTabIsLimit","computedTradeTokenChangeMsgId"]);var te=class extends N{constructor(t){super(t);r(this,"swapCollapse",!1);r(this,"setSwapCollapse",t=>{this.swapCollapse=t});r(this,"chainListLoadError",!1);r(this,"setChainListLoadError",t=>{this.chainListLoadError=t});D(this,{...tt,swapCollapse:b,chainListLoadError:b}),this.setPortal(fe)}getUserUnit(t){this.nowCurrencyUnit=t}};s();n();s();n();var re=class{constructor(e){r(this,"updateTxHash",e=>(p.info(g.UPDATE_HASH,{...e,tags:{orderId:e.orderId,status:e?.status||1}}),h.post(Ee,e).catch(t=>{p.info(g.UPDATE_HASH_ERROR,{...e,error:t,tags:{orderId:e.orderId}})})));r(this,"cancelOrder",e=>(p.info(g.CANCEL_ORDER,{tags:{orderId:e}}),h.get(Ne,{params:{id:e}})));r(this,"cancelLimitOrder",()=>{});this.rootStore=e}},rt=re;var oe=class extends rt{constructor(){super(...arguments);r(this,"sendTransaction",async(...t)=>$(...t));r(this,"sendTransactionEnhance",async(...t)=>$(...t));r(this,"signTransaction",async(t,o)=>{let[a,d]=await W(He(t,o));return[a,d]})}},Uo=oe;s();n();var V=x(w());s();n();var B=x(dt());async function ht(i,e){let{devid:t}=await i.get("devid");return(o,a)=>{B.setDeviceId(t);let d=B.newInstance({site:"okex",product:o});return d.setApiEndpoint(`${e}/amplitude`),d.setCommonParams(P()),a(d),d}}async function se(i,e){(await ht(i,e))("web3_trade",Fe)}var ft=()=>{let[i,e]=(0,V.useState)(!1);return(0,V.useEffect)(()=>{let{getApiHostname:t}=E.global;se(E.localStore,t()).then(()=>e(!0)).catch(()=>{})},[]),{initialized:i}},Jo=ft;s();n();var es=i=>String(i?.isLeveraged)==="1",ts=i=>String(i?.isHoneypot)==="1",rs=i=>String(i?.isSafeMoonToken)==="1";s();n();s();n();var ot=()=>{if(v()){let t={home:Be()?T.TGAPP:T.PLUGIN,coinDetail:T.WALLET,bot:T.COMMAND,coin_info_dialog:T.COIN_INFO_DIALOG},o=J.get("pageSource");return{orderSource:t[o]}}let e=P()?.source;if(e===T.MARKET){let t=J.get(ve);e=Pe[t]||T.MARKET}return{orderSource:e}};var gt=i=>{let e=i[0];return{fromAdr:e.from,toAdr:e.to,inputData:e.inputData}},Ct=async({walletId:i,swapParams:e,signedTransactions:t,txArray:o,enableJito:a,isMemeMode:d=!1,orderId:u,isWalletInstantTrade:m=!1})=>{let R=o.length>1,{signedTx:S,transactionHash:ae}=await je(t,{isMemeMode:d,isWidgetEnv:Ve(),isWallet:v()||Ge.isExtensionEnv,isWalletInstantTrade:m}),L="";R?L=JSON.stringify(S):L=S[0];let le=ae[0],nt=R?{mev:"Jito",jitoHash:ae[1]}:{},it=gt(o),at=Qe(o),de={...e,enableJito:a,...ot()};return a&&(de.mevInfo="jito"),{updateMultiOrderInfo:{transactionHash:le,walletTxData:{extJson:JSON.stringify({...nt,rent:at,txSource:3,feeType:4,multiTag:0,isMainTx:!1,coinAmount:0,serviceCharge:0,signedTx:R?JSON.parse(L):L}),isMainTx:!1,serviceCharge:0,txHash:le,walletId:i,txSource:3,coinAmount:0,walletType:2,signedTx:L,...it},orderId:u},dexMultiMetaSaveOrderParam:de}},As=async({signedTransactions:i,swapParams:e,walletId:t,txArray:o,enableJito:a,orderId:d})=>{let u=await Ct({walletId:t,signedTransactions:i,swapParams:e,txArray:o,enableJito:a,orderId:d});return h.post(we,u)};s();n();H();var ne=class{constructor(){r(this,"txData",async e=>{let t;return ce(e)?t=JSON.parse(e):t=e,Xe(t)})}};r(ne,"chainId",A.SOLANA_MAINNET);s();n();var st=x(w());var ie=class extends st.PureComponent{constructor(e){super(e),this.state={hasError:!1,error:void 0,errorInfo:{}}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t}),this.props.isMainEntry?p.error("fatal rendering error",{error:e,errorInfo:t,level:"fatal"}):p.error(g.ERROR_BOUNDARY,{error:e,errorInfo:t}),this.props.onError&&this.props.onError(e,t)}onRetry(){this.setState({hasError:!1})}render(){let{error:e,errorInfo:t,hasError:o}=this.state;return o?this.props.fallbackComponent({error:e,errorInfo:t,onRetry:()=>this.onRetry()}):this.props.children}};s();n();async function Bs(i,e){return await h.post("/priapi/v6/dx/trade/multi/preCheck",i,e)}async function Vs(i,e){return await h.post("/priapi/v6/dx/trade/multi/broadcast",i,e)}export{ie as a,se as b,mt as c,M as d,Fr as e,Xr as f,jr as g,C as h,Z as i,te as j,es as k,ts as l,rs as m,Uo as n,ot as o,Ct as p,As as q,ne as r,Jo as s,Bs as t,Vs as u};
//# sourceMappingURL=chunk-UULU72LG.js.map
