import{o as m}from"./chunk-3ZKJXYZ4.js";import{H as E}from"./chunk-WU2LB6XB.js";import{a as C,b as f,g as H,v as P}from"./chunk-EFOY37CC.js";import{E as _,J as w}from"./chunk-COF7YKSN.js";import{f as S,i as L,u as O,w as A}from"./chunk-JLNZTUPO.js";import{a as M}from"./chunk-ZUJLXC72.js";import{f as I,o as s,p as T,q as c}from"./chunk-Y5OH3DDZ.js";s();c();w();var D={CANCEL:"cancel",RETRY:"retry",TOKEN_METHOD_TRANSFER:"transfer",TOKEN_METHOD_TRANSFER_FROM:"transferfrom",TOKEN_METHOD_APPROVE:"approve",TOKEN_METHOD_INCREASE_ALLOWANCE:"increaseAllowance",INCOMING:"incoming",SENT_ETHER:"sentEther",CONTRACT_INTERACTION:"contractInteraction",DEPLOY_CONTRACT:"contractDeployment",SWAP:"swap",SWAP_APPROVAL:"swapApproval",SIGN:_.ETH_SIGN,SIGN_TYPED_DATA:_.ETH_SIGN_TYPED_DATA,PERSONAL_SIGN:_.PERSONAL_SIGN,ETH_DECRYPT:_.ETH_DECRYPT,ETH_GET_ENCRYPTION_PUBLIC_KEY:_.ETH_GET_ENCRYPTION_PUBLIC_KEY,EIP_5792:"eip5792"},r={UNAPPROVED:"unapproved",APPROVED:"approved",REJECTED:"rejected",SIGNED:"signed",SUBMITTED:"submitted",FAILED:"failed",DROPPED:"dropped",CONFIRMED:"confirmed",PKGING:"PKGING",CONFIRMING:"CONFIRMING",ERROR:"ERROR",SUCCESS:"SUCCESS"};var d={SEND:"send",RECEIVE:"receive",INTERACTION:"interaction",APPROVAL:"approval",SIGNATURE_REQUEST:"signature-request",SWAP:"swap"},B=[null,d.RECEIVE,d.SEND,d.INTERACTION,d.APPROVAL],k=[null,r.PKGING,r.CONFIRMING,r.ERROR,r.SUCCESS],y={[r.UNAPPROVED]:!0,[r.APPROVED]:!0,[r.SUBMITTED]:!0,[r.PKGING]:!0,[r.CONFIRMING]:!0},v={[r.FAILED]:!0,[r.DROPPED]:!0,[r.REJECTED]:!0,[r.ERROR]:!0},X={[r.SUCCESS]:!0,[r.CONFIRMED]:!0},W={...y,[r.CONFIRMED]:!0},q={[D.TOKEN_METHOD_APPROVE]:!0,[D.TOKEN_METHOD_TRANSFER]:!0,[D.TOKEN_METHOD_TRANSFER_FROM]:!0},J={CARRY_ALL_REMAINING_BALANCE:128,CARRY_ALL_REMAINING_INCOMING_VALUE:64,DESTROY_ACCOUNT_IF_ZERO:32,PAY_GAS_SEPARATELY:1,IGNORE_ERRORS:2,NONE:0},Q={TON_ADDR:"ton_addr",TON_PROOF:"ton_proof"},Z={MAINNET:"-239",TESTNET:"-3"},j={UNKNOWN_ERROR:0,BAD_REQUEST_ERROR:1,MANIFEST_NOT_FOUND_ERROR:2,MANIFEST_CONTENT_ERROR:3,UNKNOWN_APP_ERROR:100,USER_REJECTS_ERROR:300,METHOD_NOT_SUPPORTED:400},g={Transaction:"legacy",VersionedTransaction:0},$={EIP_5792:"EVM_OKX7702WALLET_EXECUTEFROMSELF"},ee={TX:"tx"},te="wallet_inner_transfer";s();c();var G=I(M());s();c();var x=I(M());var z=(e,t="base58")=>t==="base58"?x.default.encode(e):T.Buffer.from(e).toString("base64"),U=(e,t="base58")=>t==="base58"?x.default.decode(e):T.Buffer.from(e,"base64");var F=(e,t=E.TRANSACTION,n="base58")=>{let o=t===E.TRANSACTION?e.serialize({requireAllSignatures:!1,verifySignatures:!1}):e.serialize();return z(o,n)},_e=(e,t,n="base58")=>{let o=U(e,n);if(t)return t===E.TRANSACTION?O.from(o):A.deserialize(o);try{return O.from(o)}catch{return A.deserialize(o)}},b=e=>{switch(e?.version){case g.Transaction:case g.VersionedTransaction:return E.VERSIONED_TRANSACTION;default:return E.TRANSACTION}};var Re=e=>e?new S(e):null,Se=(e,t)=>({publicKey:e,signature:G.default.decode(t)}),Oe=(e,t="base58")=>(t==="base58"?G.default.decode(e):T.Buffer.from(e,"base64")).length>L;s();c();var i=I(M());function K(e,t){return P(f(C(t||"0",e||"0"),10**6),0)}function me(e,t="0",n="0"){let o=K(t,n);if(!e||H(o,e))return{priorityFee:o,priorityGasPrice:t,priorityGasLimit:n};let N=P(f(C(e,10**6),n),0);return{priorityFee:K(N,n),priorityGasPrice:N,priorityGasLimit:n}}var Me=async({coinId:e,fromAddress:t,instanceType:n,serializedMessage:o,needToReplaceRecentBlockhash:N,onSign:h})=>{let R="",a,p="";if(n===E.TRANSACTION){if(a=O.from(i.default.decode(o)),N){let u=await m({coinId:e,fromAddr:t});a.recentBlockhash=u}let l=i.default.encode(a.serializeMessage());R=await h({finalizedMessage:l}),a.addSignature(new S(t),i.default.decode(R)),p=F(a,n)}else{a=A.deserialize(i.default.decode(o));let l=a.message;if(N){let Y=await m({coinId:e,fromAddr:t});l.recentBlockhash=Y}let u=i.default.encode(l.serialize());R=await h({finalizedMessage:u}),a.addSignature(new S(t),i.default.decode(R)),p=F(a,n)}return{signature:R,tx:a,serializedTransaction:p,type:n}};export{D as a,J as b,Q as c,Z as d,j as e,$ as f,ee as g,te as h,F as i,_e as j,b as k,Re as l,Se as m,Oe as n,K as o,me as p,Me as q};
//# sourceMappingURL=chunk-UOWKDFTX.js.map
