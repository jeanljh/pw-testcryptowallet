import{a as Eo}from"./chunk-ELXRV4IW.js";import{a as Je}from"./chunk-T4CFY3IH.js";import{f as fo,g as _o,i as dt,j as Po,k as Ao,l as No,q as Io}from"./chunk-6PSK4535.js";import{a as Fo,b as bo}from"./chunk-GCPFAJKK.js";import{a as vo}from"./chunk-V7XA3BQU.js";import{e as mo,f as xo,h as To,j as go,l as ho}from"./chunk-WD3IVQAU.js";import{b as ro}from"./chunk-KPUXAS7Z.js";import{d as Co,e as wo}from"./chunk-PQQFVOPL.js";import{a as ko}from"./chunk-5QYLVV6H.js";import{a as ao,d as pt}from"./chunk-LS6URCUV.js";import{a as ut}from"./chunk-XDEC3ZLT.js";import{b as yo}from"./chunk-RGPNT5G7.js";import{B as po,b as so,l as mt}from"./chunk-Q7DF5H6O.js";import{g as uo}from"./chunk-AQO2BBXJ.js";import{a as io,b as Qe,t as ae}from"./chunk-2VUOGSTW.js";import{b as lo}from"./chunk-S7VT2TWF.js";import{d as co}from"./chunk-HBNZZZEG.js";import{d as Fe}from"./chunk-BNS5ABAB.js";import{d as no}from"./chunk-ZDHJHPQ5.js";import{a as Ze,d as jt}from"./chunk-A5U7X3LN.js";import{a as $t,b as Kt}from"./chunk-AP337SRV.js";import{a as Xt,d as Qt,e as ct}from"./chunk-7HYQ2DGP.js";import{a as qe,f as Xe,g as qt}from"./chunk-UOWKDFTX.js";import{h as oo}from"./chunk-V7ZNWTMX.js";import{a as Ut,d as Rt}from"./chunk-3ZKJXYZ4.js";import{b as to}from"./chunk-EBRJSEEJ.js";import{Ha as zt}from"./chunk-MSFAPAHB.js";import{n as Jt}from"./chunk-ZOKF3EKQ.js";import{c as Ee}from"./chunk-OOYDFTEF.js";import{b as eo}from"./chunk-7MCLPJAH.js";import{a as Yt,f as Vt,g as In,u as xe}from"./chunk-FGAB46RQ.js";import{o as lt}from"./chunk-Z62JX42S.js";import{C as Mt,Na as Nn,la as Ot}from"./chunk-2QHGKEME.js";import{b as Zt}from"./chunk-OIXGC4LI.js";import{a as R}from"./chunk-MAAUVUWY.js";import{E as Be,Y as je,_ as V,c as Ve,da as ne,e as Ht,l as Wt}from"./chunk-WU2LB6XB.js";import{F as At,a as it,b as Et,c as Ie,d as Ye,f as Ft,h as ke,i as bt,p as Pt}from"./chunk-EFOY37CC.js";import{c as k}from"./chunk-HMTT52FG.js";import{b as Bt,c as Fn}from"./chunk-GR7YC6C3.js";import{E as Dt,J as bn}from"./chunk-O33H5V3V.js";import{bc as Gt,la as Lt,nc as An,tb as Pn}from"./chunk-COF7YKSN.js";import{A as m,K as oe,o as J}from"./chunk-VZKEX7KP.js";import{H as Se,I as St,c as kt,o as se,q as st}from"./chunk-BJKBO23H.js";import{M as rt,e as wt,va as vt}from"./chunk-XFTQD4B2.js";import{t as It,z as S}from"./chunk-ZFVABNQN.js";import{a as Nt}from"./chunk-4QGZDIBD.js";import{b as te}from"./chunk-73B6GL3S.js";import{f as B,o as a,q as r}from"./chunk-Y5OH3DDZ.js";a();r();var le=B(te());a();r();var De={root:"_root_1gj3g_1",tools:"_tools_1gj3g_1",mevWrap:"_mevWrap_1gj3g_9",txExplainWrap:"_txExplainWrap_1gj3g_12",data:"_data_1gj3g_15"};var kn=({txTypeInfo:e,children:t,...o})=>{let{txExplain1:n={},baseInfo:i={}}=e,x;i?.title?.text&&(x={...i,title:i.title.text});let u=le.Children.toArray(t)?.filter(Boolean)?.length;return le.default.createElement(fo,{injectInfo:x,needChildrenPadding:u,...o},le.default.createElement(k.Box,{className:De.root},le.default.createElement(k.Box,{className:De.tools},n?.title?le.default.createElement(k.Box,{className:De.txExplainWrap},le.default.createElement(_o,{txExplain:n})):null),le.default.createElement(k.Box,{className:De.data},t)))},So=kn;a();r();oe();a();r();oe();a();r();var Le=B(te());a();r();var $e={content:"_content_18w99_1",title:"_title_18w99_4",text:"_text_18w99_10"};a();r();a();r();var j=B(te()),Bo=B(Nn());oe();a();r();var $={title:"_title_1xthp_1",subtitle:"_subtitle_1xthp_9",fee:"_fee_1xthp_15",feeTitle:"_feeTitle_1xthp_21",feeDetail:"_feeDetail_1xthp_26",speedDetail:"_speedDetail_1xthp_33",gasDetail:"_gasDetail_1xthp_36"};var Sn=()=>{let e=lo(),t=uo(),o=oo(),n=(0,Bo.useSelector)(Ot),i=ro(),x=Co(),d=async(c,f,p,g=0)=>{let{baseCoin:T}=await e(p,!0),C=o?.[T.coinId]||"0",v=it(c,f),_=Yt(Ie(v,g),{symbol:T.symbol,useContractPrecision:!0,contractPrecision:{decimals:T.decimals},precision:T.displayPrecision}).value,w=Vt(it(Et(Ie(v,g),10**T.decimals),C),{currencySign:n.symbol,useApproximate:!0}).value;return`${_} ${w}`},u=(c,f)=>{let p=i(c);return m("wallet_extension_transaction_confirmation_gas_detail",{gasPrice:J.thousandFormat(p),gasLimit:J.thousandFormat(f)})},l=async(c,f)=>{try{return await x({...c,coinId:f})}catch{return""}},s=({userGasInfo:c,updateGasInfo:f,fetchParams:p})=>{let{gasPrice:g,maxFeePerGas:T,maxPriorityFeePerGas:C}=f,{supportEip1559:v,gasLimit:_,gasPrice:w,maxFeePerGas:E,maxPriorityFeePerGas:N}=c;return v?(delete p.gasPrice,{...p,value:p?.amount,maxFeePerGas:T||E,maxPriorityFeePerGas:C||N,gasLimit:_}):{...p,value:p?.amount,gasPrice:g||w,gasLimit:_}};return async({coinId:c,baseCoinAmountUse:f,userGasInfo:p,updateGasInfo:g,serverSignInfo:T,fetchParams:C})=>{let{gasPrice:v,maxFeePerGas:_}=g,{supportEip1559:w,gasLimit:E,gasPrice:N,maxFeePerGas:K}=p,W=0;T?.needExtFee&&(W=await l(s({userGasInfo:p,updateGasInfo:g,fetchParams:C}),c));let L=w?K:N,U=await d(L,E,c),z=u(L,E),G=w?_:v,Z=await d(G,E,c,W),re=u(G,E);return new Promise((q,M)=>{let D=se.prompt({hideCloseBtn:!1,alignBottom:!1,titleCenter:!1,infoType:null,confirmText:m("extension_toast_btn_confirmgasfee"),confirmBtnProps:{type:S.TYPE.highlight,size:S.SIZE.lg},onConfirm:async()=>{D.destroy();let{baseCoin:Y}=await e(c,!0),{coinAmountInt:O}=t(Y.coinId),X=Ye(O,f);ho({userGasInfo:p,updateGasInfo:g,baseCoinAmountAvailable:X,L1FEE:W})?(Se.error({title:m("extension_toast_text_insufficient_balance")}),M(new Error(ae))):q(g)},onClose:()=>{D.destroy(),M(new Error(ae))},renderContent:Y=>j.default.createElement(Y,null,j.default.createElement("div",{className:$.title},m("extension_toast_title_transaction_replace")),j.default.createElement("div",{className:$.subtitle},m("extension_toast_subtitle_gasincrease")),j.default.createElement("div",{className:$.feeTitle},m("extension_toast_title_current_transaction")),j.default.createElement("div",{className:$.fee},j.default.createElement("div",{className:$.feeDetail},U),j.default.createElement("div",{className:$.gasDetail},z)),j.default.createElement("div",{className:$.feeTitle},m("extension_toast_title_gasprice")),j.default.createElement("div",{className:$.fee},j.default.createElement("div",{className:$.speedDetail},Z),j.default.createElement("div",{className:$.gasDetail},re)))})})}},Do=Sn;var Bn=()=>{let e=Do();return async({coinId:o,baseCoinAmountUse:n,userGasInfo:i,serverGasInfo:x,serverSignInfo:d,originTxGasInfo:u,fetchParams:l})=>{let s=go({userGasInfo:i,serverGasInfo:x,originTxGasInfo:u});return s?.gasPrice||s?.maxFeePerGas?(await e({coinId:o,baseCoinAmountUse:n,userGasInfo:i,updateGasInfo:s,serverSignInfo:d,fetchParams:l}),Promise.resolve(s)):Promise.resolve()}},Lo=Bn;var Dn=({onCancel:e,getDialog:t,resolve:o,reject:n,newNonce:i})=>()=>{if(e){e(t(),{resolve:o,reject:n});return}t().destroy(),o({nonce:i})},Ln=({updateGasInfo:e,resolve:t,onChainNonce:o})=>{t(e?{nonce:o,updateGasInfo:e}:{nonce:o})},Gn=()=>{let e=Lo();return async({coinId:o,baseCoinAmountUse:n="0",showSelectNonceDialog:i=!1,onChainNonce:x="0",newNonce:d="0",userGasInfo:u={},serverGasInfo:l={},serverSignInfo:s={},originTxGasInfo:y={},fetchParams:c={},title:f="",text:p="",confirmText:g="",cancelText:T="",onConfirm:C,onCancel:v})=>new Promise((_,w)=>{if(i){let E=se.prompt({hideCloseBtn:!0,alignBottom:!1,titleCenter:!1,infoType:null,cancelBtnProps:{category:S.CATEGORY.outline,size:S.SIZE.lg},confirmBtnProps:{type:S.TYPE.highlight,size:S.SIZE.lg},confirmText:g,cancelText:T,onConfirm:async()=>{if(C){await C(E,{resolve:_,reject:w});return}E.destroy();try{let N=await e({coinId:o,baseCoinAmountUse:n,userGasInfo:u,serverGasInfo:l,serverSignInfo:s,originTxGasInfo:y,fetchParams:c});Ln({updateGasInfo:N,resolve:_,onChainNonce:x})}catch(N){w(N)}},onCancel:Dn({onCancel:v,resolve:_,reject:w,newNonce:d,getDialog:()=>E}),renderContent:N=>Le.default.createElement(N,null,Le.default.createElement("div",{className:$e.content},Le.default.createElement("div",{className:$e.title},f),Le.default.createElement("div",{className:$e.text},p)))})}else _({nonce:d})})},be=Gn;var Mn=()=>{let e=be();return async({coinId:o,baseCoinAmountUse:n,hasFailedTx:i,onChainNonce:x,newNonce:d,userGasInfo:u,serverGasInfo:l,originTxGasInfo:s,serverSignInfo:y,fetchParams:c,txToastCheckData:f})=>{let p=f?.find(_=>_?.checkType===ne.OVERWRITTEN)||{},{popUpTitle:g,popUpDesc:T,primaryButtonName:C,secondaryButtonName:v}=p||{};return e({coinId:o,baseCoinAmountUse:n,showSelectNonceDialog:i,onChainNonce:x,newNonce:d,userGasInfo:u,serverGasInfo:l,serverSignInfo:y,originTxGasInfo:s,fetchParams:c,title:g||m("wallet_extension_transaction_popup_failed_transaction"),text:T||m("wallet_extension_transaction_popup_replace_failed_transaction"),confirmText:C||m("wallet_extension_transaction_popup_btn_replace"),cancelText:v||m("wallet_extension_transaction_popup_btn_skip")})}},Go=Mn;a();r();var On=()=>{let e=be();return async({coinId:o,baseCoinAmountUse:n,hasPending7702Tx:i,onChainNonce:x,newNonce:d,userGasInfo:u,serverGasInfo:l,originTxGasInfo:s,serverSignInfo:y,fetchParams:c,txToastCheckData:f})=>{let p=f?.find(_=>_?.checkType===ne.OVERWRITTEN)||{},{popUpTitle:g,popUpDesc:T,primaryButtonName:C,secondaryButtonName:v}=p||{};return e({coinId:o,baseCoinAmountUse:n,showSelectNonceDialog:i,onChainNonce:x,newNonce:d,userGasInfo:u,serverGasInfo:l,serverSignInfo:y,fetchParams:c,originTxGasInfo:s,title:g,text:T,confirmText:C,cancelText:v,onConfirm:(_,{resolve:w})=>{_.destroy(),w({nonce:d})},onCancel:(_,{reject:w})=>{_.destroy(),w(new Error(ae))}})}},Mo=On;a();r();oe();var Hn=()=>{let e=be();return async({coinId:o,baseCoinAmountUse:n,hasPendingTx:i,onChainNonce:x,newNonce:d,userGasInfo:u,serverGasInfo:l,originTxGasInfo:s,serverSignInfo:y,fetchParams:c,txToastCheckData:f})=>{let p=f?.find(_=>_?.checkType===ne.OVERWRITTEN)||{},{popUpTitle:g,popUpDesc:T,primaryButtonName:C,secondaryButtonName:v}=p||{};return e({coinId:o,baseCoinAmountUse:n,showSelectNonceDialog:i,onChainNonce:x,newNonce:d,userGasInfo:u,serverGasInfo:l,serverSignInfo:y,fetchParams:c,originTxGasInfo:s,title:g||m("wallet_extension_transaction_popup_pending_transaction"),text:T||m("wallet_extension_transaction_popup_replace_pending_transaction"),confirmText:C||m("wallet_extension_transaction_popup_btn_replace"),cancelText:v||m("wallet_extension_transaction_popup_btn_continue_wait")})}},Oo=Hn;a();r();oe();vt();var Wn=()=>async({isRepeat:t,onCancel:o})=>new Promise((n,i)=>{if(t){let x=se.prompt({alignBottom:!1,hideCloseBtn:!0,infoType:se.Prompt.INFO_TYPE.warn,confirmBtnProps:{type:S.TYPE.highlight,size:S.SIZE.lg},cancelBtnProps:{category:S.CATEGORY.outline,size:S.SIZE.lg},title:m("wallet_extension_popup_repeat_order"),confirmText:m("wallet_extension_popup_repeat_order_btn_continue"),cancelText:o?m("wallet_extension_popup_repeat_order_btn_viewhistory"):null,text:m("wallet_extension_popup_repeat_order_desc"),onConfirm:()=>{x.destroy(),n()},onCancel:()=>{x.destroy(),wt(o)&&o(),i(new Error(ae))}})}else n()}),Ho=Wn;var Wo=()=>{let e=Go(),t=Oo(),o=Ho(),n=Mo(),i=async({coinId:u,from:l,to:s,amount:y,gasPrice:c,authorizationList:f,stateOverrideList:p})=>{let[{data:g=[]},{data:T={}}]=await Promise.all([Rt({checkTypes:[ne.REPEAT,ne.OVERWRITTEN],coinId:u,from:l,to:s,amount:y,gasPrice:c,authorizationList:f,stateOverrideList:p}),Ut({coinId:u,fromAddr:l,scenario:Wt.SCENARIO_SEND_COIN})]);return{txToastCheckData:g,signInfoData:T}},x=u=>{let{hasFailedTx:l,hasPendingTx:s,hasPending7702Tx:y,nonce:c,newNonce:f,originGasPrice:p,originPriorityFee:g}=To(u),T=xo(u,ne.REPEAT);return{hasFailedTx:l,hasPendingTx:s,hasPending7702Tx:y,nonce:c,newNonce:f,originGasPrice:p,originPriorityFee:g,isRepeat:T}};return async({coinId:u,from:l,to:s,amount:y,gasPrice:c,authorizationList:f,stateOverrideList:p,baseCoinAmountUse:g,userGasInfo:T,whetherCheckRepeat:C,onRepeatCancel:v})=>{let _=[],w={};try{let D=await i({coinId:u,from:l,to:s,amount:y,gasPrice:c,authorizationList:f,stateOverrideList:p});if(!Array.isArray(D.txToastCheckData)||typeof D.signInfoData!="object")throw new Error(m("wallet_home_toast_network_error"));_=D.txToastCheckData,w=D.signInfoData?.info||{}}catch(D){throw new Error(D?.msg||m("wallet_home_toast_network_error"))}let E=x(_),{nonce:N,newNonce:K,originGasPrice:W,originPriorityFee:L,hasFailedTx:U,hasPendingTx:z,hasPending7702Tx:G,isRepeat:Z}=E,re={originGasPrice:W,originPriorityFee:L},q={coinId:u,baseCoinAmountUse:g,onChainNonce:N,newNonce:K,userGasInfo:T,serverGasInfo:w.gasPrice,serverSignInfo:w,originTxGasInfo:re,fetchParams:{amount:y,coinId:u,from:l,gasPrice:c,to:s}},M={nonce:K};return U?M=await e({...q,hasFailedTx:U,txToastCheckData:_}):z?M=await t({...q,hasPendingTx:z,txToastCheckData:_}):G&&(M=await n({...q,hasPending7702Tx:G,txToastCheckData:_})),C&&await o({isRepeat:Z,onCancel:v}),M}};a();r();var I=B(te()),ge=B(lt());vt();oe();a();r();var Ge=B(te()),Te=B(Nt());oe();a();r();var ue={root:"_root_wpiv5_1",title:"_title_wpiv5_4",header:"_header_wpiv5_8",icon:"_icon_wpiv5_12",content:"_content_wpiv5_16",textarea:"_textarea_wpiv5_19",errorTip:"_errorTip_wpiv5_22",errorBordered:"_errorBordered_wpiv5_29"};function Un({className:e,value:t,onChange:o,error:n,titleClass:i,errorTipClass:x,headerClassName:d,contentClassName:u,...l}){return Ge.default.createElement(kt,{defaultExpanded:!0,className:(0,Te.default)(ue.root,e),titleClass:(0,Te.default)(ue.title,i),headerClassName:(0,Te.default)(ue.header,d),contentClassName:(0,Te.default)(ue.content,u),customHeaderIcon:s=>Ge.default.createElement(Ee,{icon:"okx-wallet-plugin-arrow-small-down",size:Ee.SIZE.xs,className:(0,Te.default)({"okui-accordion-header-icon-expanded":s},ue.icon)}),title:m("wallet_extension_inscription_text_hex_data_optional")},Ge.default.createElement(st.TextArea,{...l,inputClassName:ue.textarea,errorType:st.TIP_TYPE.always,error:!!n,value:t,onChange:s=>{let y=s.target.value||"";o?.(y.trim())}}),!!n&&Ge.default.createElement(xe.Text,{className:(0,Te.default)(ue.errorTip,x)},n))}var Uo=Un;a();r();oe();function Ro(e){return!!e&&(e.toLowerCase()==="0x"||!jt(e)||e.length%2!==0)?m("wallet_extension_inscription_text_input_formatting_error"):null}a();r();var zo=[{constant:!0,inputs:[],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"spender",type:"address"},{name:"value",type:"uint256"}],name:"approve",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"totalSupply",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"from",type:"address"},{name:"to",type:"address"},{name:"value",type:"uint256"}],name:"transferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"spender",type:"address"},{name:"addedValue",type:"uint256"}],name:"increaseAllowance",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[],name:"unpause",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"account",type:"address"}],name:"isPauser",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"paused",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[],name:"renouncePauser",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"owner",type:"address"}],name:"balanceOf",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"account",type:"address"}],name:"addPauser",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[],name:"pause",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"symbol",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"spender",type:"address"},{name:"subtractedValue",type:"uint256"}],name:"decreaseAllowance",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"to",type:"address"},{name:"value",type:"uint256"}],name:"transfer",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"owner",type:"address"},{name:"spender",type:"address"}],name:"allowance",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{inputs:[{name:"name",type:"string"},{name:"symbol",type:"string"},{name:"decimals",type:"uint8"},{name:"totalSupply",type:"uint256"}],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,name:"account",type:"address"}],name:"Paused",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"account",type:"address"}],name:"Unpaused",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"}],name:"PauserAdded",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"}],name:"PauserRemoved",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Approval",type:"event"}];a();r();var h=B(te()),ce=B(lt()),Vo=B(Nt()),jo=B(In());oe();a();r();var P={root:"_root_cnpwt_1",icon:"_icon_cnpwt_1",editApproveAmountModal:"_editApproveAmountModal_cnpwt_10",content:"_content_cnpwt_22",txTypeInfo:"_txTypeInfo_cnpwt_25",editArea:"_editArea_cnpwt_28",unlimitedText:"_unlimitedText_cnpwt_33",unlimitedSymbol:"_unlimitedSymbol_cnpwt_43",symbolClassName:"_symbolClassName_cnpwt_60",quickHandler:"_quickHandler_cnpwt_63",balanceWrap:"_balanceWrap_cnpwt_70",balance:"_balance_cnpwt_70",maxBalance:"_maxBalance_cnpwt_92",unlimited:"_unlimited_cnpwt_33",text:"_text_cnpwt_105",authQuantityWarnTip:"_authQuantityWarnTip_cnpwt_112",danger:"_danger_cnpwt_119",info:"_info_cnpwt_122",approveTip:"_approveTip_cnpwt_125",footerActions:"_footerActions_cnpwt_133",copy:"_copy_cnpwt_136",spenderAddress:"_spenderAddress_cnpwt_144"};var Yo=J.toPlainString(10**40),Rn=e=>{typeof e!="string"&&(e=e.toString());let t=e?.length;return t<=9?36:t>=10&&t<12?32:t===12?30:t>=13&&t<=15?24:t>=16&&t<=18?20:t>=19&&t<=24?16:12},Zo=({address:e,coins:t,baseCoinId:o})=>{if(Array.isArray(t))return t.find(n=>n?.baseCoinId===o&&Zt(n?.address,e,{baseCoinId:o})||Zo({address:e,baseCoinId:o,coins:n?.childrenCoin}))},zn=({txTypeInfo:e,walletAccount:t,approve:o,baseCoin:n,updateApproveInfo:i,showApproveAddressAtPopup:x})=>{let{walletId:d}=t,{tokenInfo:u,index:l,amount:s,authQuantity:y,spender:c}=o||{},{autoEdit:f,defaultAmount:p,warnTip:g}=y||{},{address:T,decimals:C,symbol:v}=u,{address:_}=c||{},w=No(v,12),[E,N]=(0,h.useState)(null);(0,h.useEffect)(()=>{E&&E.focus()},[E]);let[K,W]=(0,h.useState)(!1),[L,U]=(0,h.useState)(!1),[z,G]=(0,h.useState)(0),Z=(0,ce.useMemoizedFn)((A=s)=>{U(ct(A)),G(Fo(A,C)),W(!0)}),re=(0,ce.useMemoizedFn)(()=>{U(A=>!A),G(0)}),q=(0,ce.useMemoizedFn)(()=>{U(!0),G(0)}),M=(0,h.useMemo)(()=>g?{type:P.info,text:g}:L&&!ct(p)?{type:P.danger,text:m("wallet_extension_approve_alert_high_risk_unlimited")}:{type:P.info,text:m("wallet_extension_approvals_new_approval_amount")},[g,L,p,z]),{chainId:D}=n||{},{coinId:Y}=Fe(void 0,void 0,{chainId:D,address:T})||{},O=Je(Y,d)?.coinAmount,X=J.thousandFormat(O),ee=(0,ce.useMemoizedFn)(()=>{U(!1),G(O)}),ie=(0,ce.useMemoizedFn)(()=>{let A=L?Qt:bo(z||0,C);i(l,{amount:A}),W(!1),N(null)}),he=ko(),de=to({},d),Ce=(0,h.useMemo)(()=>de?.find(A=>A.localType===n?.localType),[n?.localType,de?.length]),we=(0,ce.useMemoizedFn)(async(A=0)=>{if(!Zo({address:T,coins:he,baseCoinId:n?.coinId}))try{let F=await $t({contractAddress:T,chainInfo:Ce});await Kt(F)}catch(F){++A<3?we(A):St.error({title:F?.msg||m("wallet_home_toast_network_error")})}}),fe=()=>{(0,jo.default)(_),Se.success({desc:h.default.createElement(xe.Text,{inherit:!0,forceWrap:!0},_),placement:Se.DIRECTION.top,title:m("wallet_receive_toast_address_copied")})};return(0,ce.useMount)(()=>{f&&Z(p),we()}),h.default.createElement(k.Box,{className:P.root},h.default.createElement(k.Box,{className:P.icon,onClick:()=>{Z()}},h.default.createElement(It,{className:"okx-wallet-plugin-draw-20"})),h.default.createElement(se.Action,{hideCloseBtn:!0,noContentPadding:!0,visible:K},h.default.createElement(k.Box,{className:P.editApproveAmountModal},h.default.createElement(k.Box,{className:P.content},h.default.createElement(So,{bordered:!1,txTypeInfo:e,className:P.txTypeInfo}),h.default.createElement(k.Box,{className:P.editArea},L?h.default.createElement(xe.Text,{onClick:re,className:P.unlimitedText},m("wallet_extension_transfer_title_unlimited_amount",{token:h.default.createElement(xe.Text,{className:P.unlimitedSymbol},w)})):h.default.createElement(co,{clickSymbolFocus:!0,onRef:N,symbol:w,autoSize:Rn,placeholder:"0",max:Yo,decimals:C,value:z,onChange:A=>{Ft(A,Yo)&&G(A)},style:{fontWeight:700,height:"42px"},symbolClassName:P.symbolClassName})),h.default.createElement(k.Box,{className:P.quickHandler},!!Number(O)&&h.default.createElement(k.Box,{className:P.balanceWrap},h.default.createElement(xe.Text,{className:P.balance,ellipsis:{tooltip:X}},m("wallet_extension_approve_label_balance",{amount:X})),h.default.createElement(k.Box,{className:P.maxBalance,onClick:ee},m("commonall_enterfield_btn_max"))),h.default.createElement(k.Box,{onClick:q,className:P.unlimited},h.default.createElement(k.Box,{className:P.text},m("wallet_extension_transfer_dialog_checkbox_set_to_unlimited")))),!!M&&h.default.createElement(k.Box,{className:(0,Vo.default)(P.authQuantityWarnTip,M.type)},M.text),x&&_&&h.default.createElement(k.Box,{className:P.spenderAddress},m("wallet_extension_approvals_mid_label_approval_address_var",{address:Mt(_)}),h.default.createElement(Ee.IconButton,{hovered:!0,onClick:fe,size:Ee.SIZE.sm,tooltip:m("wallet_extension_top_copy_address"),icon:"okx-wallet-plugin-web3-copy",className:P.copy}))),h.default.createElement(k.Box,{className:P.approveTip},m("wallet_extension_approve_desc_dapp_right")),h.default.createElement(eo,{affixStyle:{position:"none"},placeholder:!1,className:P.footerActions},h.default.createElement(S,{block:!0,category:S.CATEGORY.fill,type:S.TYPE.primary,size:S.SIZE.lg,onClick:ie},m("wallet_extension_approve_btn_amount_confirmation"))))))},qo=zn;a();r();var Ke=B(te()),Xo=B(lt());An();Pn();var Yn=({coinId:e,txParams:t,networkFee:o,modifiedData:n,mevInfo:i,isMev:x,gasReturnActivity:d})=>({coinId:e,toAddr:t?.to,fromAddr:t?.from,txSource:Gt.DAPP,coinAmount:(Ze(t?.value)?R(t?.value):t?.value)||0,serviceCharge:o,inputData:n,mevSuppliers:x?i?.mevSuppliers:[],activityId:d?.activityId}),Vn=({mergedParams:e,gasType:t})=>JSON.stringify({to:e?.to,gasType:t,from:e?.from,value:Ze(e?.value)?R(e?.value):e?.value,nonce:Ze(e?.nonce)?R(e?.nonce):e?.nonce,data:e?.data,gas:e?.gasLimit,oldTxHash:"",gasPrice:e?.supportEip1559?e?.maxFeePerGas:e?.gasPrice,repeatTxType:Ht.CONFIRMING,priorityFee:e?.supportEip1559?e.maxPriorityFeePerGas:0,authorizationList:e?.authorizationList}),jn=({coinId:e,txType:t,txParams:o,isMev:n,mevInfo:i,localType:x,modifiedData:d,walletAccount:u,customGasInfo:l,gasReturnActivity:s,modifiedDataError:y,isSufficientGas:c,isSufficientBalance:f,reportGasReturnActivityDataInConfirm:p,confirmBtnText:g,cancelBtnText:T,canConfirm:C,silentLoading:v,onBeforeSign:_,onBeforePublish:w,onCancel:E,onConfirm:N,onConfirmReplace:K,isBalanceLoadError:W,preExecInfo:L,isOutputLoading:U,txToastCheckParams:z})=>{let{walletId:G}=u||{},Z=Wo(),{networkFee:re,gasType:q,gasPrice:M}=l||{},D=wo({coinId:e,walletId:G,localType:x,fromAddr:o?.from}),Y=po(Yn({coinId:e,txParams:o,networkFee:re,modifiedData:d,mevInfo:i,isMev:n,gasReturnActivity:s})),O=(0,Ke.useMemo)(()=>l?.isNetworkFeeLoading||Qe(l,t)||W||y||v||C===!1||!c||!f,[v,l,t,y,C,c,f,W]),X=(0,Xo.useMemoizedFn)(async()=>{if(K&&typeof N=="function")return N({preExecInfo:L,isMev:n,coinId:e,mevInfo:i,txParams:o,customGasInfo:l,modifiedData:d,gasReturnActivity:s,reportGasReturnActivityDataInConfirm:p});let fe,A;try{let F=await Z({to:o?.to,from:o?.from,authorizationList:o?.authorizationList,coinId:e,gasPrice:M,userGasInfo:l,amount:R(o?.value)||0,baseCoinAmountUse:R(o?.value||0),...z||{}});fe=F.nonce,A=F.updateGasInfo}catch(F){if(F?.message===ae)return null;throw F}p();let pe={...o,...l,...A||{},nonce:fe,data:d,withSignParams:!0};_&&(pe=_(pe,{txParams:o,customGasInfo:l,updateGasInfo:A}));try{let{signedTx:F,signParams:me}=await D(pe),Q=await so(Lt,F),Oe={};w&&(Oe=(await w({signedTx:F,txHash:Q,signParams:me,preExecInfo:L}))?.publishParams||{});let tt=await Y(F,{txHash:Q,extJson:Vn({mergedParams:{...pe,authorizationList:me?.authorizationList},gasType:q}),...Oe});return N?.({txHash:Q,txId:tt})}catch(F){return N?.({error:F})}}),{loading:ee,onClick:ie}=ut(X),he=(0,Ke.useMemo)(()=>({disabled:O,loading:ee||U,actionType:mt.ACTION_TYPE.CONFIRM,onClick:ie,btnText:g}),[O,ie,ee,U,g]),{loading:de,onClick:Ce}=ut(E);return[(0,Ke.useMemo)(()=>({loading:de,onClick:Ce,actionType:mt.ACTION_TYPE.CANCEL,btnText:T}),[de,Ce,T]),he]},Qo=jn;a();r();var et=B(te());oe();var Zn=e=>{let[t,o]=(0,et.useState)({isNetworkFeeLoading:!0,isGasLimitLoading:!0,gasLimit:"0",gasPrice:"0",maxFeePerGas:"0",maxPriorityFeePerGas:"0",supportEip1559:!1,gasType:V.STANDARD}),{gasLimitInfo:n={},gasLimit:i,gasPrice:x,maxFeePerGas:d,gasType:u,supportEip1559:l,customConfirmed:s,isGasLimitLoading:y,isNetworkFeeLoading:c,networkFee:f,maxPriorityFeePerGas:p,gasPriceInfo:g,extFee:T,useDefaultGas:C}=t,{minGasFee:v}=io({gasLimit:i,gasPrice:x,maxPriorityFeePerGas:p,maxFeePerGas:d,supportEip1559:l,extFee:T,gasPriceInfo:g,gasLimitInfo:n,gasType:u}),_=(0,et.useMemo)(()=>u===V.CUSTOM&&!s&&!C?m("extension_send_mid_text_dapps_suggested_fee"):u||V.STANDARD,[s,u,C]),w=Qe(t,e),E=c&&y&&!n?.gasLimit;return{level:_,estimateFailed:w,customGasInfo:t,loading:c,networkFee:E?void 0:v,maxNetworkFee:E?void 0:f,onCustomGasInfoChange:o}},Jo=Zn;a();r();var Pe=B(te());var qn=({txType:e,walletId:t,coinId:o,txParams:n,customGasInfo:i,preExecuteLoading:x})=>{let[d,u]=(0,Pe.useState)(""),l=Fe(o),{from:s,to:y}=n||{},[c,f]=(0,Pe.useState)("");(0,Pe.useEffect)(()=>{x||(dt(e)||Po(e)?(u(pt.approval),f(dt(e)?"approve":"revoke_approve")):(u(pt.dapp),f("Contract interaction")))},[x,e]);let p=ao({walletId:t,coinId:o,fromAddress:s,toAddress:y,txType:d,fee:Pt(i?.networkFee),disabled:!y,unavailable:i.gasType===V.CUSTOM&&i.customConfirmed}),{status:g,activity:T,activityId:C,tip:v,clear:_}=p,w=()=>{At({activityId:C,activity:T,status:g,tip:v,walletId:t,address:s})},E=T?.errorCode;return(0,Pe.useEffect)(()=>{!c||E===0&&zt({wallet_address:s,interactive_address:y,chain_id:l?.chainId,transaction_type:c})},[E,c,s,y,l?.chainId]),{gasReturnActivity:p,clearGasReturnInfo:_,reportGasReturnActivityDataInConfirm:w}},$o=qn;a();r();var Me=B(te());a();r();Fn();bn();async function Ko(e){return(await Dt(Bt.generate5792Data,e)).data.callData}function Xn({chainIndex:e,setModifiedData:t}){let[o,n]=(0,Me.useState)(!1),i=(0,Me.useRef)(0),[x,d]=(0,Me.useState)(!1),u=async(l,s)=>{try{let y=l.map(f=>f?.data?.eip5792Call),c=await Ko({type:1,chainIndex:e,calls:y});s===i.current&&(n(!1),t(c),d(!1))}catch{d(!0),n(!1)}};return{loading:o,error:x,onDataChange:l=>{let s=(l.moduleList||[]).filter(c=>c?.data?.moduleType==="tx"),{strategyType:y}=l.txTypeInfo||{};y===Xe.EIP_5792?(n(!0),i.current+=1,u(s,i.current)):(n(!1),d(!1),t(s[0]?.data?.modifiedData))}}}var en=Xn;a();r();var Qn=e=>{let{txParams:t={}}=e,{gasPrice:o,maxFeePerGas:n,maxPriorityFeePerGas:i}=t,x=t.gas||t.gasLimit,d=V.STANDARD,u,l,s,y=R(x),c=R(o),f=R(n),p=R(i);return ke(c,0)&&(d=V.CUSTOM,u=c),ke(f,0)&&ke(p,0)&&bt(f,p)&&(d=V.CUSTOM,l=f,s=p),ke(y,0)&&(d=V.CUSTOM),!t.to&&t.data&&(d=V.CUSTOM),{initialGasType:d,initialCustomMaxPriorityFee:s,initialCustomGasLimit:y,initialCustomGasPrice:u,initialCustomMaxBaseFee:Ye(l,s)}},tn=Qn;a();r();var ft={"data-input":"_data-input_1k4cq_1",dataInput:"_data-input_1k4cq_1","data-input-error-tip":"_data-input-error-tip_1k4cq_5",dataInputErrorTip:"_data-input-error-tip_1k4cq_5"};var Jn=e=>Number(e)===Ve.INCREASE_ALLOWANCE?zo:[],$n=e=>{let{txId:t,chainId:o,walletId:n,txParams:i,gasLimitParams:x={},txToastCheckParams:d,preExecParams:u,interactAddress:l,dappInfo:s={},needMev:y=!1,openMev:c,coinId:f,isShowBlockSwapMevTooltip:p,onMevChange:g,onConfirm:T,onConfirmReplace:C,onCancel:v,onBeforeSign:_,onBeforePublish:w,backable:E=!1,onBack:N,asPage:K,confirmBtnText:W,cancelBtnText:L,showApproveAddressAtPopup:U,onDataChange:z,reserveValue:G="0",method:Z=Be.SIGN_TRANSACTION}=e||{},[re,q]=(0,ge.useSetState)({mevInfo:{},isMev:c}),[M,{toggle:D}]=(0,ge.useBoolean)(!1),{from:Y,to:O,value:X="0x0",data:ee,typeInt:ie,authorizationList:he,extParams:de}=i||{},{isSilentSign:Ce}=de||{},we=l!==!1&&(l||O),fe=(0,I.useMemo)(()=>[je.FeeDelegatedValueTransfer,je.FeeDelegatedValueTransferMemo,je.FeeDelegatedSmartContractExecution].includes(ie),[ie]),[A,pe]=(0,I.useState)(""),F=Fe(f,void 0,{chainId:o}),me=F?.coinId,[Q,Oe]=(0,I.useState)({}),tt=Q.loading,Ae=(0,I.useMemo)(()=>{if(!O&&ee)return qe.DEPLOY_CONTRACT;let{strategyType:H}=Q?.txTypeInfo||{};return H===Xe.EIP_5792?qe.EIP_5792:(Q?.moduleList||[]).find(({data:Ne})=>Ne?.moduleType===qt.TX)?.data?.approveInfoList?.[0]?.spender?.approvalType||""},[O,ee,Q]),_e=Jt(F?.localType,n),ot=Ie(R(X),G),on=tn({txParams:i}),nn=vo(_e.walletId),an=(0,I.useMemo)(()=>Ro(A),[A]),{isMev:He,mevInfo:nt}=re,We=A||ee||"",rn=(0,I.useMemo)(()=>({dappData:JSON.stringify({to:O,from:Y,value:X,data:We,typeInt:ie}),from:Y,authorizationList:he,dappInfo:s,chainIndex:F?.chainId,method:Z===Be.ONLY_SIGN_TRANSACTION?Be.ONLY_SIGN_TRANSACTION:Be.SIGN_TRANSACTION,...u||{}}),[F?.chainId,Y,We,O,X,he,u]),sn=(0,ge.useMemoizedFn)((H,ye)=>{q({isMev:H,mevInfo:ye}),g?.(H,ye)}),{level:ln,networkFee:cn,maxNetworkFee:pn,customGasInfo:_t,estimateFailed:yt,loading:mn,onCustomGasInfoChange:un}=Jo(Ae),{gasReturnActivity:xt,reportGasReturnActivityDataInConfirm:dn}=$o({txType:Ae,coinId:me,txParams:i,customGasInfo:_t,preExecuteLoading:tt,walletId:_e.walletId}),Tt=Je(me,n),{coinAmountInt:ve,isBalanceLoadError:fn,isBalanceLoading:_n}=Tt,Ue=fe?"0":pn,gt=(0,I.useMemo)(()=>rt(ve)||J.gte(ve,Ue),[ve,Ue]),ht=(0,I.useMemo)(()=>!J.eq(ot,0)&&!rt(ve)?J.lte(ot,J.sub(ve,Ue)):!0,[ve,Ue,ot]),{loading:yn,error:xn,onDataChange:Tn}=en({chainIndex:F?.chainId,setModifiedData:H=>{pe(H),z&&z(H)}}),at=xn||an,gn=Qo({coinId:me,txType:Ae,txParams:i,isMev:He,mevInfo:nt,isBalanceLoadError:fn,isOutputLoading:_n||yn,canConfirm:Q?.canConfirm,silentLoading:Q?.silentLoading,isSufficientGas:gt,isSufficientBalance:ht,walletAccount:_e,customGasInfo:_t,gasReturnActivity:xt,modifiedDataError:at,localType:F?.localType,modifiedData:We,walletId:_e?.walletId,reportGasReturnActivityDataInConfirm:dn,onBeforeSign:_,onBeforePublish:w,onCancel:v,preExecInfo:Q,onConfirm:T,onConfirmReplace:C,confirmBtnText:W,cancelBtnText:L,txToastCheckParams:d}),hn=(0,ge.useMemoizedFn)((H,ye,Ne)=>{let Re=Jn(H),ze=Xt(ye,Re);return ze?Ao(i?.data,{approveAmount:Ne},ze):null});return I.default.createElement(I.default.Fragment,null,I.default.createElement(no,{title:"",noContent:!0,onBack:N,asPage:K,closeable:!1,backable:E}),I.default.createElement(Io,{handleCancel:v,preExecParams:rn,walletAccount:_e,confirmBtnText:W,cancelBtnText:L,buttonGroup:gn,onUpdatePreExecInfo:Oe,txState:{txId:t,baseCoin:F,estimateFailed:yt,isSufficientBalance:ht,isSufficientGas:gt,coinWithBalance:Tt},localType:F?.localType,mevProps:{isMev:He,needMev:y,onMevChange:sn,isShowBlockSwapMevTooltip:p},networkFeeProps:{isFree:fe,level:ln,coinId:me,networkFee:cn,loading:mn,estimateFailed:yt,onClick:()=>{D(),nn({trade:"contract_interaction",all_confirmation:"network_fee"})}},onDataChange:Tn,slot:{interactWith:!!we&&I.default.createElement(yo,{address:we,title:m("wallet_extension_popup_text_interact_with")}),advancedEntry:!ee&&I.default.createElement(Uo,{value:A,error:at,onChange:pe,className:ft["data-input"],errorTipClass:ft["data-input-error-tip"]}),bottom:!!Ce&&I.default.createElement(Eo,{walletAccount:_e})},renderEditApproveAmount:(H,ye)=>{let Ne=H?.authQuantity?.canEdit,Re=H?.spender?.approvalType,ze=H?.eip5792Call,Cn=H?.txTitle?.data;return[Ve.INCREASE_ALLOWANCE,Ve.AUTHORIZATION].includes(Re)&&Ne?I.default.createElement(qo,{showApproveAddressAtPopup:U,txTypeInfo:{baseInfo:Cn},walletAccount:_e,approve:H,baseCoin:F,updateApproveInfo:(wn,Ct)=>{let vn=Ae===qe.EIP_5792?ze?.data:i.data,En=hn(Re,vn,Ct.amount);ye(wn,Ct,En)}}):null}}),I.default.createElement(mo,{method:Z,dappInfo:s,typeInt:ie,visible:M,coinId:me,address:Y,inputData:We,tokenAddress:O,value:R(X),onBack:D,onClose:null,initialGasData:on,onGasChange:un,minimumGasLimit:He?nt.gas:0,isMev:He,mevInfo:nt,gasReturn:xt,gasLimitParams:x,gasLimitOptions:{disabled:at}}))},sl=$n;export{So as a,Wo as b,Uo as c,Ro as d,Ko as e,sl as f};
//# sourceMappingURL=chunk-GNGB7SWC.js.map
