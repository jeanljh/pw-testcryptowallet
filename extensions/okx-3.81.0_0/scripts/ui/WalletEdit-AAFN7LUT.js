import{a as he}from"./chunk-L2AWIRLM.js";import{a as X}from"./chunk-EP773FEO.js";import{a as ye}from"./chunk-257KUBOE.js";import{a as b,b as Te,d as Z}from"./chunk-BYWN7GZE.js";import{a as V}from"./chunk-7P6PQ2A4.js";import"./chunk-JG2G3PLS.js";import"./chunk-WEPJKKBH.js";import{a as Ie}from"./chunk-IVH24YWV.js";import"./chunk-SNS3QUAD.js";import{b as Le,e as le}from"./chunk-LBF75ZOB.js";import"./chunk-JUPTKFJB.js";import"./chunk-5AGWELXA.js";import"./chunk-GXEP5BK5.js";import{d as Ce}from"./chunk-ZDHJHPQ5.js";import"./chunk-GTQ5U6DA.js";import{b as ue}from"./chunk-GR44ZN4M.js";import"./chunk-K35GFLBJ.js";import"./chunk-5A7EFNRM.js";import"./chunk-NA6P5YCH.js";import"./chunk-47LIW52M.js";import{G as De}from"./chunk-ZOKF3EKQ.js";import"./chunk-MDBKHBHQ.js";import"./chunk-WRVJM3F3.js";import{a as Y}from"./chunk-NYBKFEEM.js";import"./chunk-XVSXMJ3S.js";import"./chunk-KQ66JTF7.js";import{c as I}from"./chunk-OOYDFTEF.js";import{a as z}from"./chunk-JNIP4OYT.js";import"./chunk-XRCQOGA2.js";import"./chunk-SWUBCABA.js";import"./chunk-44SDMU5C.js";import{b as ke}from"./chunk-7MCLPJAH.js";import"./chunk-WAIJPY5X.js";import{h as Ne,t as Ee,u as Ae,v as we}from"./chunk-YGMRSF47.js";import"./chunk-6XGS36TZ.js";import"./chunk-M2YY6A5T.js";import"./chunk-XLG73W5Q.js";import{ja as ge,la as fe,ma as xe}from"./chunk-GCS2RK7E.js";import"./chunk-OIPQWTNV.js";import{f as U}from"./chunk-VJI6MZK4.js";import"./chunk-5PRURJ2O.js";import{u as $}from"./chunk-FGAB46RQ.js";import"./chunk-47ZMUKCZ.js";import{o as ve}from"./chunk-Z62JX42S.js";import{Na as pe}from"./chunk-2QHGKEME.js";import"./chunk-B624VS3G.js";import"./chunk-W4SQ6335.js";import{a as q}from"./chunk-YDSDBRIT.js";import{a as Ue}from"./chunk-6PA65BO3.js";import"./chunk-OIXGC4LI.js";import"./chunk-MAAUVUWY.js";import"./chunk-4X64L7DZ.js";import"./chunk-GLL4BXR6.js";import"./chunk-4L5HWMAA.js";import"./chunk-EZS2GR7E.js";import"./chunk-NUN72MDU.js";import"./chunk-BFWVIVOY.js";import"./chunk-S3FOFXM7.js";import"./chunk-YIFLUVTR.js";import"./chunk-EN2WHAVL.js";import"./chunk-CP2RIMI2.js";import{f as _e}from"./chunk-3QLLFUC4.js";import"./chunk-EFOY37CC.js";import{c as t}from"./chunk-HMTT52FG.js";import"./chunk-45NMMWRA.js";import"./chunk-E4OV5WXB.js";import"./chunk-GR7YC6C3.js";import"./chunk-O33H5V3V.js";import"./chunk-DJN2J7J5.js";import"./chunk-35ANKHOJ.js";import"./chunk-BI4OEIFC.js";import{ac as D,nc as ce}from"./chunk-COF7YKSN.js";import{A as M,K as ae}from"./chunk-VZKEX7KP.js";import"./chunk-QCEQQDCM.js";import{I as G,u as v}from"./chunk-BJKBO23H.js";import"./chunk-IO3ALUOJ.js";import"./chunk-AHVVUOFF.js";import"./chunk-DJSNVDZI.js";import"./chunk-K336SGW3.js";import{J as de,f as ie,p as me,va as re}from"./chunk-XFTQD4B2.js";import"./chunk-FOOC6LB7.js";import"./chunk-DHKS44RQ.js";import"./chunk-4DBVFCYR.js";import"./chunk-2IGQWLAB.js";import"./chunk-GVV6OTQP.js";import{z as K}from"./chunk-ZFVABNQN.js";import"./chunk-VYWNZTTM.js";import"./chunk-LBWWOQL4.js";import{a as ne}from"./chunk-4QGZDIBD.js";import{b as B}from"./chunk-73B6GL3S.js";import"./chunk-LVJGLJNA.js";import"./chunk-Z7PBP7IJ.js";import"./chunk-5F7M5EJ4.js";import"./chunk-RNWGOGLT.js";import"./chunk-UGJ3FMEQ.js";import"./chunk-H6JAOQCX.js";import"./chunk-Z2AIGJGI.js";import"./chunk-VBZ4JSJ6.js";import"./chunk-LBYXY63E.js";import"./chunk-M4ANCDMF.js";import"./chunk-J6KTJ3IN.js";import"./chunk-5CQODPK7.js";import"./chunk-C5XO4JMZ.js";import"./chunk-HI3LE734.js";import"./chunk-RX4V72AK.js";import{f as E,o as n,q as l}from"./chunk-Y5OH3DDZ.js";n();l();var A=E(B()),He=E(Ue());re();ae();n();l();var se=E(B());ae();var Ye=({isLoading:o,onDone:i})=>se.default.createElement(ke.FooterActions,{placeholder:!0},se.default.createElement(K,{onClick:i,category:K.CATEGORY.fill,type:K.TYPE.primary,size:K.SIZE.lg,block:!0,disabled:o},M("wallet_manage_btn_edit_done"))),Se=Ye;n();l();var r=E(B()),Oe=E(pe()),ee=E(ne());ce();n();l();var j=E(B()),We=E(ne());n();l();var F={handler:"_handler_18xte_1",disabled:"_disabled_18xte_4",keyring:"_keyring_18xte_7",wallet:"_wallet_18xte_11",icon:"_icon_18xte_16",noHandler:"_noHandler_18xte_23"};var qe=({type:o,canDrag:i,listeners:m,disabled:w,getHandlerRef:x})=>i?j.default.createElement(t.Box,{ref:x,...m,className:(0,We.default)(F.handler,F[o],{[F.disabled]:w})},j.default.createElement(I.IconButton,{className:F.icon,icon:"okx-wallet-plugin-hamburger","data-testid":z.WALLET_MANAGEMENT_PAGE.DRAG_AREA_ICON})):j.default.createElement(t.Box,{ref:x,...m,className:F.noHandler}),J=qe;n();l();var s=E(B()),R=E(pe()),Q=E(ne());re();ce();n();l();var g={item:"_item_kxzo4_1",dragging:"_dragging_kxzo4_9",children:"_children_kxzo4_13",wrapper:"_wrapper_kxzo4_16",wallet:"_wallet_kxzo4_20",canDrag:"_canDrag_kxzo4_23",delete:"_delete_kxzo4_26",avatar:"_avatar_kxzo4_34",name:"_name_kxzo4_38",draw:"_draw_kxzo4_44",text:"_text_kxzo4_47","text--enabled":"_text--enabled_kxzo4_53",textEnabled:"_text--enabled_kxzo4_53","text--expiring":"_text--expiring_kxzo4_56",textExpiring:"_text--expiring_kxzo4_56",drawIcon:"_drawIcon_kxzo4_67",more:"_more_kxzo4_70"};var $e=({keyringIdentity:o,editIdentityName:i,onDragWalletStart:m,onDragWalletEnd:w,editKeyringIdentities:x})=>{let u=o?.walletIdentities||[],N=(0,R.useDispatch)(),{isRpcMode:c}=(0,R.useSelector)(U),_=V(),[d]=Y(),T=(0,s.useCallback)(()=>{m(o.keyringId)},[m,o]),k=(0,s.useCallback)(a=>{let p=me(x),C=p.find(({keyringId:W})=>W===o.keyringId);C.walletIdentities=a,w(p)},[x,o,w]),y=Z(),S=u.length>1;return s.default.createElement(v.Sortable,{uniqueKey:"walletId",itemClassName:g.item,onDragStart:T,itemChildrenClassName:g.children,itemDraggingClassName:g.dragging,itemWrapperClassName:g.wrapper,onDragEnd:k,dataSource:u,withOverlay:!1,renderHandler:({getHandlerRef:a,listeners:p})=>s.default.createElement(J,{type:"wallet",canDrag:S,listeners:p,getHandlerRef:a})},u.map(a=>{let p=Le(a?.teeStatus);return s.default.createElement(t.FlexBox,{align:t.ALIGN.center,className:(0,Q.default)(g.wallet,{[g.canDrag]:S}),key:a.walletId},s.default.createElement(t.Box,{className:g.delete},s.default.createElement(I,{className:"okx-wallet-plugin-delete",onClick:()=>{let C=p==="enabled"||p==="expiring";if([D.MNEMONIC,D.HARDWARE].includes(o.keyringIdentityType)&&u.length>1){N(ue({type:"REMOVE_ACCOUNT",accountId:a.walletId,keyringType:o.keyringIdentityType,isSA:C}));return}y({saAccountLen:C?1:void 0,groupId:a.groupId,keyringType:o.keyringIdentityType,keyringId:o.keyringId})}})),s.default.createElement(le,{size:le.SIZE.sm,className:g.avatar,walletIdentity:a}),s.default.createElement(t.FlexBox,{align:t.ALIGN.center,direction:t.DIRECTION.vertical,className:g.name,onClick:()=>{i({type:b.WALLETACCOUNT,identity:a,initialName:a.walletName,otherNames:u.map(({walletName:C,walletId:W})=>a.keyringId===W?"":C).filter(Boolean)})}},s.default.createElement(t.FlexBox,{align:t.ALIGN.center,style:{width:"100%"}},s.default.createElement($.Text,{ellipsis:!0,className:(0,Q.default)(g.text,{[g["text--enabled"]]:p==="enabled"||p==="expiring"})},a.walletName),p!=="not_enabled"?s.default.createElement(Ie,{status:p}):null,s.default.createElement(t.Box,{className:g.draw},s.default.createElement(I,{className:(0,Q.default)("okx-wallet-plugin-draw",g.drawIcon)}))),s.default.createElement(X,{isRpcMode:c,currentRpcNetwork:_,hiddenAssets:d,walletAsset:a?.walletAsset,unsopportCurrentNetwork:a?.unsupported})),s.default.createElement(q,{className:g.more,to:`${xe}?walletId=${a?.walletId}`},s.default.createElement(I.IconButton,{icon:"okx-wallet-plugin-more"})))}))},Be=$e;n();l();var Me=E(B());var be=()=>{(0,Me.useLayoutEffect)(()=>{let o=document.querySelector('[data-selected="true"]');setTimeout(()=>{o.scrollIntoView({behavior:"auto",block:"center"})},100)},[])};n();l();var f={item:"_item_1os1d_1",children:"_children_1os1d_8",dragging:"_dragging_1os1d_11",wrap:"_wrap_1os1d_15",disabled:"_disabled_1os1d_22",showBottomLine:"_showBottomLine_1os1d_25",keyring:"_keyring_1os1d_35",canDrag:"_canDrag_1os1d_38",delete:"_delete_1os1d_41",name:"_name_1os1d_49",canEdit:"_canEdit_1os1d_53",draw:"_draw_1os1d_56",text:"_text_1os1d_59",more:"_more_1os1d_74"};var Fe=E(ve());var Ve=({editIdentityName:o,editKeyringIdentities:i,setEditKeyringIdentities:m})=>{let w=Ne(),{isRpcMode:x}=(0,Oe.useSelector)(U),u=V(),[N]=Y(),c=Z(),_=(0,r.useCallback)(({keyringIdentityType:e})=>e===D.MNEMONIC||e===D.MPC||e===D.TON_MNEMONIC,[]),d=(0,r.useCallback)(({keyringIdentityType:e})=>e===D.MNEMONIC||_e(e)||e===D.MPC||e===D.TON_MNEMONIC,[]),[T,k]=(0,r.useState)(""),y=(0,r.useCallback)(({id:e})=>{k(e)},[]),S=(0,r.useCallback)(e=>{k(""),m(e)},[m]),[a,p]=(0,r.useState)(""),C=(0,r.useCallback)(e=>{p(e)},[]),W=(0,r.useCallback)(e=>{p(""),m(e)},[m]),H=i.length>1;be();let{keyringIdentitiesWithSA:O}=he(i),Pe=(0,Fe.useMemoizedFn)(e=>O.find(L=>L.keyringId===e)?.walletIdentities.filter(L=>L.teeStatus?.isActive).length);return r.default.createElement(v.Sortable,{uniqueKey:"keyringId",itemClassName:f.item,itemChildrenClassName:f.children,itemDraggingClassName:f.dragging,onDragStart:y,onDragEnd:S,dataSource:O,withOverlay:!1,renderHandler:({getHandlerRef:e,listeners:P})=>r.default.createElement(J,{type:"keyring",canDrag:H,listeners:P,disabled:a,getHandlerRef:e})},O.map((e,P)=>r.default.createElement(t.Box,{className:(0,ee.default)(f.wrap,{[f.disabled]:a&&a!==e.keyringId,[f.showBottomLine]:P!==O.length-1}),"data-selected":e.walletIdentities.some(L=>L.walletId===w),key:e.keyringId},r.default.createElement(t.FlexBox,{align:t.ALIGN.center,className:(0,ee.default)(f.keyring,{[f.canDrag]:H})},_(e)?r.default.createElement(t.Box,{className:f.delete},r.default.createElement(I,{icon:"okx-wallet-plugin-delete",onClick:()=>{let L=e?.walletIdentities?.[0].groupId;if(!L)return;let te=Pe(e.keyringId);c({saAccountLen:te,groupId:L,keyringType:e.keyringIdentityType,keyringId:e.keyringId})}})):null,r.default.createElement(t.FlexBox,{align:t.ALIGN.center,direction:t.DIRECTION.vertical,className:(0,ee.default)(f.name,{[f.canEdit]:d(e)}),onClick:()=>{d(e)&&o({type:b.WALLET,identity:e,initialName:e.keyringName,otherNames:O.map(({keyringName:L,keyringId:te})=>e.keyringId===te?"":L).filter(Boolean)})}},r.default.createElement(t.FlexBox,{align:t.ALIGN.center,style:{width:"100%"}},r.default.createElement($.Text,{ellipsis:!0,className:f.text,"data-testid":z.WALLET_MANAGEMENT_PAGE.WALLET_ACCOUNT_NAME},e.keyringName),d(e)?r.default.createElement(t.Box,{className:f.draw},r.default.createElement(I,{icon:"okx-wallet-plugin-draw"})):null),r.default.createElement(X,{isRpcMode:x,currentRpcNetwork:u,hiddenAssets:N,walletAsset:e?.walletAsset})),[D.PRIVATE_KEY].includes(e.keyringIdentityType)?null:r.default.createElement(q,{className:f.more,to:`${fe}?keyringId=${e?.keyringId}`,testId:z.WALLET_MANAGEMENT_PAGE.KEYRING_MORE_BUTTON},r.default.createElement(I.IconButton,{icon:"okx-wallet-plugin-more"}))),T===e.keyringId?null:r.default.createElement(Be,{keyringIdentity:e,editIdentityName:o,onDragWalletStart:C,onDragWalletEnd:W,editKeyringIdentities:O}))))},Ke=Ve;n();l();var oe=E(B());re();ae();var Xe=o=>{let i=Te(),m=Ee(),w=Ae(),x=(0,oe.useMemo)(()=>({async[b.WALLET](u,N){let c=u?.keyringId;if(c)try{await m(c,N),o(_=>_.map(d=>d.keyringId===c?{...d,keyringName:N}:d)),G.success(M("wallet_edit_wallet_toast_renamed_success"))}catch(_){console.log(_)}},async[b.WALLETACCOUNT](u,N){let c=u?.walletId;if(c)try{await w(c,N),o(_=>_.map(d=>{let T=d?.walletIdentities??[];return{...d,walletIdentities:T.map(k=>k.walletId===c?{...k,walletName:N}:k)}})),G.success(M("wallet_edit_wallet_toast_renamed_success"))}catch(_){console.log(_)}}}),[w,m,o]);return(0,oe.useCallback)(({identity:u,...N})=>{i(N).then(c=>{let{type:_}=N,d=x[_];d&&d(u,c)}).catch(ie)},[x,i])},Ge=Xe;n();l();var ze={root:"_root_nqk5m_1",headerDone:"_headerDone_nqk5m_1"};var Ze=()=>{let[,o]=De(null),[i,m]=(0,A.useState)(o),w=Ge(m),[x,u]=(0,A.useState)(!1),N=y=>{m(y),u(!0)},c=(0,He.useHistory)(),_=we(),[d,T]=(0,A.useState)(!1),k=(0,A.useCallback)(async()=>{if(x){T(!0);try{let y={},S={};i.forEach(({keyringId:a,walletIdentities:p},C)=>{y[a]=C,p.forEach(({walletId:W},H)=>{S[W]=H})}),await _(y,S)}catch{G.error({title:M("extension_wallet_toast_sorting_failure")})}}c.push(`${ge}?from=seedVerify`)},[c,_,i,x]);return(0,A.useEffect)(()=>{!de(o,i)&&!x&&m(o)},[o,i]),A.default.createElement(t.Container,{className:ze.root},A.default.createElement(Ce,{backable:{icon:"okx-wallet-plugin-close"},bordered:!1,closeable:!1}),A.default.createElement(Ke,{editIdentityName:w,editKeyringIdentities:i,setEditKeyringIdentities:N}),A.default.createElement(Se,{isLoading:d,onDone:k}),A.default.createElement(ye,null))},er=Ze;export{er as default};
//# sourceMappingURL=WalletEdit-AAFN7LUT.js.map
