import{a as rt}from"./chunk-ZD6ZRVEI.js";import{b as nt}from"./chunk-SNS3QUAD.js";import{a as _t}from"./chunk-LBF75ZOB.js";import{a as st}from"./chunk-42XTLCCX.js";import{a as lt}from"./chunk-TE6AOABI.js";import{a as at}from"./chunk-NZX52M3S.js";import{Ga as Y}from"./chunk-MSFAPAHB.js";import{c as it}from"./chunk-OOYDFTEF.js";import{a as I}from"./chunk-JNIP4OYT.js";import{d as et,r as ot}from"./chunk-YGMRSF47.js";import{zb as R}from"./chunk-GCS2RK7E.js";import{g as tt}from"./chunk-47ZMUKCZ.js";import{Na as Lt}from"./chunk-2QHGKEME.js";import{a as Et}from"./chunk-6PA65BO3.js";import{A as p,D as m,K as j}from"./chunk-VZKEX7KP.js";import{A as G,H as Q,I as $,o as Z,p as q,s as J}from"./chunk-BJKBO23H.js";import{j as X,k as kt}from"./chunk-XFTQD4B2.js";import{t as v,u as B}from"./chunk-ZFVABNQN.js";import{a as bt}from"./chunk-4QGZDIBD.js";import{b as O}from"./chunk-73B6GL3S.js";import{f as x,o as i,q as a}from"./chunk-Y5OH3DDZ.js";i();a();var t=x(O()),b=x(bt());j();i();a();var n=x(O()),ct=x(Lt()),mt=x(Et());kt();j();i();a();var dt=(_,f,d=2)=>{let r=(0,mt.useHistory)(),c=ot(),w=(0,ct.useSelector)(tt),[L,E]=(0,n.useState)(!1),[T,y]=(0,n.useState)(""),{saFeatureEnabled:D}=rt(),C=(0,n.useMemo)(()=>{if(!D)return!1;let o=X(_,"walletIdentities.0");return _t(o)},[_,D]);(0,n.useEffect)(()=>{if(!T)return;let o=_.walletIdentities.find(h=>h.walletId===T);if(!o)return;!(o.teeStatus?.isCreated??!1)||!C?$.success({title:p("wallet_extension_account_notification_title_account_added",{account:o.walletName})}):$.success({title:p("wallet_extension_account_notification_title_account_added",{account:o.walletName}),desc:o?.teeStatus?.isActive?p("wallet_extension_account_notification_subtitle_already_sa"):p("wallet_extension_account_notification_subtitle_enable_again"),duration:at}),y("")},[T,_,C]);let S=(0,n.useCallback)(o=>{y(o),f&&f(o)},[f]),A=(0,n.useCallback)(async o=>{E(!0);try{let u=await c(_?.keyringId,{hideToast:!0});return E(!1),o&&o(u),u&&S(u),u}catch(u){throw u.message===et&&Q.error({title:p("wallet_extension_error_reminder_system_busy")}),E(!1),u}},[_,c,S]),g=(0,n.useCallback)(async()=>{r.push(`${R}?from=${d}&keyringId=${_?.keyringId}`)},[r,_,d]),k=(0,n.useCallback)(async o=>{o==="normal_account"?await A():o==="smart_account"&&await g()},[A,g,C]),W=(0,n.useMemo)(()=>w||L,[w,L]),U=(0,n.useMemo)(()=>{if(w)return p("wallet_extension_addaccount_text_feature_unavailable")},[w]);return{loading:L,isDisabled:W,tooltipTitle:U,canAddSmartAccount:C,createNormalAccount:A,createSmartAccount:g,handleCreateAccount:k,handleAccountCreationSuccess:S}};i();a();var e=x(O());j();i();a();var l={list:"_list_1oudy_1",list__item:"_list__item_1oudy_7",listItem:"_list__item_1oudy_7",list__item__content:"_list__item__content_1oudy_17",listItemContent:"_list__item__content_1oudy_17",list__item__icon:"_list__item__icon_1oudy_23",listItemIcon:"_list__item__icon_1oudy_23",list__item__textWrapper:"_list__item__textWrapper_1oudy_31",listItemTextWrapper:"_list__item__textWrapper_1oudy_31",list__item__title:"_list__item__title_1oudy_36",listItemTitle:"_list__item__title_1oudy_36",list__item__desc:"_list__item__desc_1oudy_42",listItemDesc:"_list__item__desc_1oudy_42",list__item__arrow:"_list__item__arrow_1oudy_48",listItemArrow:"_list__item__arrow_1oudy_48"};var ut=({visible:_,onBack:f,onAddAccount:d})=>e.default.createElement(Z.Action,{visible:_,onClose:f,title:m("wallet_manage_wallet_btn_add_acoount"),maskClosable:!0,windowStyle:{overflow:"hidden"},zIndex:1e3,alignBottom:!0,noContentPadding:!0},e.default.createElement("div",{className:l.list},e.default.createElement("div",{className:l.list__item,onClick:()=>d("normal_account"),"data-testid":I.WALLET_MANAGEMENT_PAGE.ADD_ACCOUNT_INNER_BUTTON},e.default.createElement("div",{className:l.list__item__content},e.default.createElement("div",{className:l.list__item__icon},e.default.createElement(v,{className:"okx-wallet-plugin-seed-phrase",fontSize:"32px"})),e.default.createElement("div",{className:l.list__item__textWrapper},e.default.createElement("span",{className:l.list__item__title},m("wallet_extension_account_bttmsheet_title_add_account")),e.default.createElement("span",{className:l.list__item__desc},m("wallet_extension_account_bttmsheet_subtitle_add_account")))),e.default.createElement("div",{className:l.list__item__arrow},e.default.createElement(v,{className:"okx-wallet-plugin-chevron-right",fontSize:"20px"}))),e.default.createElement("div",{className:l.list__item,onClick:()=>(Y(),d("smart_account")),"data-testid":I.WALLET_MANAGEMENT_PAGE.ADD_ACCOUNT_AND_ENABLE_SA_BUTTON},e.default.createElement("div",{className:l.list__item__content},e.default.createElement("div",{className:l.list__item__icon},e.default.createElement(v,{className:"okx-wallet-plugin-trading-bot",fontSize:"32px"})),e.default.createElement("div",{className:l.list__item__textWrapper},e.default.createElement("span",{className:l.list__item__title},m("wallet_extension_account_bttmsheet_title_smart_account")),e.default.createElement("span",{className:l.list__item__desc},m("wallet_extension_account_bttmsheet_subtitle_smart_account")))),e.default.createElement("div",{className:l.list__item__arrow},e.default.createElement(v,{className:"okx-wallet-plugin-chevron-right",fontSize:"20px"})))));i();a();var ft=x(O());j();i();a();var pt={coachmark:"_coachmark_1m4o3_1"};var At=({actionRef:_,isShow:f,hideCancel:d,onConfirm:r,onCancel:c})=>{if(!_?.current)return null;let w=d?{}:{cancelText:m("wallet_extension_home_link_learn_more"),onCancel:c};return ft.default.createElement(J,{mask:!0,className:pt.coachmark,referenceRef:_.current,placement:q.DIRECTION.bottomLeft,offset:[12,0],arrowPointAtCenter:!1,arrowAlignBoundary:()=>({transform:"translateX(12px)"}),highlightedPadding:0,title:m("wallet_extension_account_coachmark_title_smart_account"),description:m("wallet_extension_account_coachmark_desc_smart_account"),show:f,onConfirm:r,confirmText:m("wallet_extension_btn_general_gotit"),...w})};i();a();var s={container:"_container_e2uje_1","container--disabled":"_container--disabled_e2uje_10",containerDisabled:"_container--disabled_e2uje_10","container--detail-list":"_container--detail-list_e2uje_15",containerDetailList:"_container--detail-list_e2uje_15","container--wallet-list":"_container--wallet-list_e2uje_26",containerWalletList:"_container--wallet-list_e2uje_26","icon-wrapper":"_icon-wrapper_e2uje_41",iconWrapper:"_icon-wrapper_e2uje_41","icon-wrapper--wallet-list":"_icon-wrapper--wallet-list_e2uje_48",iconWrapperWalletList:"_icon-wrapper--wallet-list_e2uje_48","icon-wrapper--detail-list":"_icon-wrapper--detail-list_e2uje_53",iconWrapperDetailList:"_icon-wrapper--detail-list_e2uje_53",icon:"_icon_e2uje_41","icon--wallet-list":"_icon--wallet-list_e2uje_61",iconWalletList:"_icon--wallet-list_e2uje_61","icon--detail-list":"_icon--detail-list_e2uje_64",iconDetailList:"_icon--detail-list_e2uje_64",text:"_text_e2uje_67","text--wallet-list":"_text--wallet-list_e2uje_74",textWalletList:"_text--wallet-list_e2uje_74","text--detail-list":"_text--detail-list_e2uje_78",textDetailList:"_text--detail-list_e2uje_78","loader--wallet-list":"_loader--wallet-list_e2uje_82",loaderWalletList:"_loader--wallet-list_e2uje_82","loader--detail-list":"_loader--detail-list_e2uje_86",loaderDetailList:"_loader--detail-list_e2uje_86"};var vt=t.default.forwardRef(({keyringIdentity:_,onAccountCreated:f,onAddAccountClick:d,canAddSmartAccount:r=!1,variant:c="wallet-list",tooltip:w,className:L,children:E,SACoachMarkFeatureEnable:T=!1},y)=>{let[D,C]=(0,t.useState)(!1),[S,A]=(0,t.useState)(!1),[g,k]=(0,t.useState)(!1),W=lt(),{loading:U,isDisabled:o,tooltipTitle:u,canAddSmartAccount:h,createNormalAccount:z,handleCreateAccount:H}=dt(_,f,2),wt=S||U,P=S||o,{isShowSACoachMarkOnce:V,markShown:Ct}=nt();(0,t.useEffect)(()=>{T&&r&&h&&(V||setTimeout(()=>{k(!0),Ct()}))},[T,r,h,V]);let ht=(0,t.useCallback)(async()=>{if(!P){A(!0);try{r&&h?C(!0):(await z(),A(!1))}catch(M){throw A(!1),M}}},[P,r,h,z]),xt=(0,t.useCallback)(async M=>{try{C(!1),await H(M)}finally{A(!1)}},[H]),Nt=(0,t.useCallback)(()=>{C(!1),A(!1)},[]),Tt=(0,t.useCallback)(()=>{k(!1)},[r,h]),St=(0,t.useCallback)(()=>{k(!1),globalThis.platform.openTab({url:W.smartAccountWhatIsSmartAccount})},[]),gt=()=>{k(!1),d&&d(),st({confirmText:p("wallet_extension_onboard_checkbox_i_understand"),callback:ht})};return t.default.createElement(t.default.Fragment,null,(()=>{let M=E||t.default.createElement(t.default.Fragment,null,t.default.createElement("div",{className:(0,b.default)(s["icon-wrapper"],s[`icon-wrapper--${c}`])},wt?t.default.createElement(B.Circle,{className:(0,b.default)(s.loader,s[`loader--${c}`]),size:B.SIZE.md}):t.default.createElement(it,{icon:"okx-wallet-plugin-plus",className:(0,b.default)(s.icon,s[`icon--${c}`])})),t.default.createElement("div",{className:(0,b.default)(s.text,s[`text--${c}`])},p("wallet_manage_wallet_btn_add_acoount"))),F=t.default.createElement("div",{ref:y,className:(0,b.default)(L,s.container,{[s["container--disabled"]]:P,[s["container--detail-list"]]:c==="detail-list",[s["container--wallet-list"]]:c==="wallet-list"}),"data-testid":I.WALLET_MANAGEMENT_PAGE.ADD_ACCOUNT_BUTTON,onClick:gt},M),K=w||u;return K?t.default.createElement(G,{title:K,placement:G.DIRECTION.top,maxWidth:328},F):F})(),g&&t.default.createElement(At,{isShow:g,actionRef:y,onConfirm:Tt,onCancel:St,hideCancel:!W.smartAccountWhatIsSmartAccount}),r&&t.default.createElement(ut,{visible:D,onBack:Nt,onAddAccount:xt}))}),$e=t.default.memo(vt);export{$e as a};
//# sourceMappingURL=chunk-H4KXECK4.js.map
