import{b as M}from"./chunk-F57QKCZQ.js";import{J as k,ma as w,q as v}from"./chunk-HIVYZXF3.js";import{Mb as c,ga as S,jd as P}from"./chunk-INIQCRIO.js";import{G as F,da as y,n as U,s as I}from"./chunk-ZBDGRK4Q.js";import{O as x}from"./chunk-BJKBO23H.js";import{j as _,va as J}from"./chunk-XFTQD4B2.js";import{b as V}from"./chunk-73B6GL3S.js";import{f as A,n as process,o as r,q as i}from"./chunk-Y5OH3DDZ.js";r();i();var G=A(V());J();var H=e=>Number(e)===1,K=async()=>{let[,e]=await F(M.get(P,{}));return{loaded:!0,state:_(e,"data.state"),isLimitRegion:H(_(e,"data.isLimitRegion")),maintenanceChains:_(e,"data.maintenanceChains")}},te=e=>{(0,G.useEffect)(()=>{K().then(t=>(typeof e=="function"&&e(t),t)).catch(()=>{})},[e])};r();i();r();i();var f=()=>[c.SWAP,c.BRIDGE];r();i();var Y=[c.SWAP,c.BRIDGE,c.LIMIT_ORDER],z=()=>{let e=f(),t=e.includes(c.SWAP),n=e.includes(c.BRIDGE),s=e.includes(c.LIMIT_ORDER);return{[c.SWAP]:t,[c.BRIDGE]:n,[c.LIMIT_ORDER]:s,allSupported:t&&n&&s}},Ee=()=>S()?!0:!z().allSupported,W=()=>{let e=f();return e.length===1&&Y.includes(e[0])},Te=e=>{let t=f();return W()?{tabsSetting:{show:!1,size:x.SIZE.xxl,textShow:e}}:{tabsSetting:{show:!e,size:x.SIZE.xxl,textShow:e},supportBusinessLines:t}},Re=e=>{let t=f();return W()?{tabsSetting:{show:!1,textShow:!e},isFullTab:e,supportBusinessLines:t}:{tabsSetting:{show:e,textShow:!e},isFullTab:e,supportBusinessLines:t}};r();i();r();i();var l={JWT:"jwt",SUBSCRIBE:"subscribe",UNSUBSCRIBE:"unsubscribe",PING:"ping",PONG:"pong",LOGIN:"login",LOGOUT:"logout"},E=()=>{};r();i();function p(e,t){!e||e.forEach(n=>{n(t)})}function T(e,t){e?.has(t)&&e.delete(t)}function C(e,t){return U()||e.add(t),()=>T(e,t)}function R(e){return Array.isArray(e)?e:[e]}function g(e){if(!e)return"";let t={};return Object.keys(e).sort().forEach(n=>{t[n]=e[n]}),JSON.stringify(t)}var L=e=>e?e.split(",").map(n=>({token:n})):[];function b(e){switch(e){case"dex-token-candle1m":case"dex-token-candle15m":case"dex-token-candle4H":return e;default:return""}}r();i();r();i();var{SUBSCRIBE:D,UNSUBSCRIBE:X,PING:Z}=l,m=class{constructor(){this.wsInstance=null;this.initDone=!1;this.authenticated=!0;this.disconnected=!1;this.dataFnsMap=new Map;this.channelCache=new Map;this.wsDataCache={};this.errorFnsList=new Set}connect(){if(this.initDone)return;this.initDone=!0;let t=this.getWsUrl();this.wsInstance=new v({connectUrl:t,reconnectTime:1e4,maxPendingTime:2e4}),this.wsInstance.onSocketConnected(this.connectedCallback.bind(this)),this.wsInstance.setPushDataResolver(this.dataCallback.bind(this)),this.wsInstance.onSocketError(this.errorCallback.bind(this)),this.wsInstance.onStatusChange(this.statusCallback.bind(this)),this.wsInstance.onPushDiscontinue(()=>{this.wsInstance.sendChannel(Z)}),this.wsInstance.connect()}subscribe(t,{needLogin:n}={needLogin:!1}){let s=R(t),o=[];if(s.forEach(a=>{let u=g(a),d=this.channelCache.get(u);if(d){this.channelCache.set(u,d+1);let{channel:j}=a,N=b(j),B=this.wsDataCache[N]?.[u];B&&p(this.dataFnsMap.get(N),B);return}this.channelCache.set(u,1),o.push(a)}),!this.initDone){this.connect();return}!this.isConnected()||n&&!this.authenticated||this.sendChannel({op:D,args:o})}unsubscribe(t){let n=R(t),s=[];n.forEach(o=>{let a=g(o),u=this.channelCache.get(a);if(u>1){this.channelCache.set(a,u-1);return}this.channelCache.delete(a),s.push(o);let d=b(o.channel);d&&delete this.wsDataCache[d]?.[a]}),!(!this.initDone||!this.isConnected())&&this.sendChannel({op:X,args:s})}sendChannel({op:t,args:n=[]}){this.isConnected()&&n.length&&this.wsInstance.sendChannel(JSON.stringify({op:t,args:n}))}dataCallback(t={}){let{arg:n}=t;if(!n?.channel)return;p(this.dataFnsMap.get(n.channel),t);let s=b(n?.channel);if(!s)return;let o=g(n);this.wsDataCache[s]?this.wsDataCache[s][o]=t:this.wsDataCache[s]={[o]:t}}addListenerData(t,n,s){let{argsParam:o}=s||{},a=g(o);return this.channelCache.get(a)>1&&n({event:D}),this.dataFnsMap.get(t)||this.dataFnsMap.set(t,new Set),this.wsDataCache[t]&&Object.values(this.wsDataCache[t]).forEach(d=>{n(d)}),C(this.dataFnsMap.get(t),n)}remoteListenerData(t,n){return T(this.dataFnsMap.get(t),n)}addListenerError(t){return C(this.errorFnsList,t)}errorCallback(t){this.disconnected=!0,p(this.errorFnsList,t)}connectedCallback(){let t=[];this.channelCache.forEach((n,s)=>{try{t.push(JSON.parse(s))}catch{}}),this.sendChannel({op:D,args:t})}statusCallback(){}isConnected(){return!!this.wsInstance?.isConnected()}getWsUrl(){return""}};var O=class extends m{constructor(){super(...arguments);this.connectedFnsList=new Set;this.authenticated=!1;this.loginResolveFn=E;this.loginRejectFn=E;this.tokens=""}connectedCallback(){super.connectedCallback(),this.tokens&&this.login(this.tokens).then(()=>{this.authenticated=!0,super.connectedCallback(),p(this.connectedFnsList,{disconnected:this.disconnected})}).catch(()=>{k.stuff("ws login fail")})}addListenerConnected(n){return C(this.connectedFnsList,n)}dataCallback(n){let{event:s,code:o}=n;if(s===l.LOGIN){if(Number(o)===0){this.loginResolveFn();return}this.loginRejectFn()}else super.dataCallback(n)}login(n){return new Promise((s,o)=>{this.wsInstance.sendChannel(JSON.stringify({op:l.LOGIN,args:L(n)})),this.loginResolveFn=s,this.loginRejectFn=o})}logout(n){!this.authenticated||!this.isConnected()||(this.authenticated=!1,this.wsInstance.sendChannel(JSON.stringify({op:l.LOGOUT,args:L(n)})))}getWsUrl(){let n=localStorage.getItem("dev_ct_wsPress"),s="",o=y.global?.getWssHostname?.(),a=w.global?.getWssHostname?.();return S()||w.isExtensionEnv?s=`wss://${o||a}`:s=I.socketBaseUrls?.dex,s||k.error("SOCKET_BASE_URL_EMPTY",{oldWallet:o,newWallet:a,webDev:process.env.SOCKET_URL_DEX,web:I.socketBaseUrls?.dex}),n||`${s}/ws/v5/iprivate`}},st=new O;export{l as a,p as b,C as c,R as d,m as e,st as f,K as g,te as h,Ee as i,Te as j,Re as k};
//# sourceMappingURL=chunk-7Q4IDC7V.js.map
