import{l as et}from"./chunk-LVDNG6XA.js";import{a as K}from"./chunk-2FN5XB3U.js";import{b as rt}from"./chunk-34YDQARM.js";import{a as j}from"./chunk-3YSB4TUI.js";import{a as nt}from"./chunk-JQ73YYWR.js";import{a as J}from"./chunk-RNB6EWQY.js";import{a as B}from"./chunk-ZZ5BEB5E.js";import{a as lo}from"./chunk-ELXRV4IW.js";import{a as tt}from"./chunk-T4CFY3IH.js";import{p as po,q as uo}from"./chunk-6PSK4535.js";import{a as Qo}from"./chunk-EDJJACNG.js";import{a as b}from"./chunk-V7XA3BQU.js";import{f as co,g as Xo,h as Ro,i as ot}from"./chunk-PQQFVOPL.js";import{a as N,d as Z}from"./chunk-KQ6OPOXD.js";import{a as S}from"./chunk-XDEC3ZLT.js";import{a as P,b as mo}from"./chunk-RGPNT5G7.js";import{l as f}from"./chunk-Q7DF5H6O.js";import{d as V}from"./chunk-ZDHJHPQ5.js";import{c as vo}from"./chunk-SOSR34AP.js";import{a as oo}from"./chunk-EBRJSEEJ.js";import{q as Vo}from"./chunk-ZOKF3EKQ.js";import{a as Uo}from"./chunk-NYBKFEEM.js";import{c as So}from"./chunk-OOYDFTEF.js";import{e as Ho}from"./chunk-SWUBCABA.js";import{a as $o}from"./chunk-CIVR4FUI.js";import{d as Ko,i as Jo}from"./chunk-44SDMU5C.js";import{b as U}from"./chunk-7MCLPJAH.js";import{p as Zo,t as jo,u as q}from"./chunk-FGAB46RQ.js";import{o as eo}from"./chunk-Z62JX42S.js";import{Na as ro,S as R,aa as Oo,ea as Yo}from"./chunk-2QHGKEME.js";import{a as zo}from"./chunk-MAAUVUWY.js";import{c as qo,e as At}from"./chunk-EN2WHAVL.js";import{j as Mo}from"./chunk-EFOY37CC.js";import{c as k}from"./chunk-HMTT52FG.js";import{E as G,J as ko,Sb as Et,la as ao,tb as Go,ub as so}from"./chunk-COF7YKSN.js";import{A as s,K as v}from"./chunk-VZKEX7KP.js";import{H as Po,d as To}from"./chunk-BJKBO23H.js";import{e as Do,va as bt}from"./chunk-XFTQD4B2.js";import{a as Lo}from"./chunk-GVV6OTQP.js";import{t as Wo,z as W}from"./chunk-ZFVABNQN.js";import{a as Fo}from"./chunk-4QGZDIBD.js";import{b as A}from"./chunk-73B6GL3S.js";import{f as u,o as m,q as c}from"./chunk-Y5OH3DDZ.js";m();c();var h=u(A()),it=u(eo());v();ko();var Nt=({unapproved:o})=>{let[t,{cancel:e,approve:i}]=et(o),r=B(t),{rpcNetworks:a}=Ho(),n=a.find(x=>x.rpcUrl===t.rpcUrl),{loading:l,onClick:p}=S(e),d=(0,h.useMemo)(()=>({actionType:f.ACTION_TYPE.CANCEL,onClick:p,loading:l}),[l,p]),g=(0,it.useMemoizedFn)(async()=>{await i(),Po.success({duration:1.5,title:s("developer_mode_home_toast_added"),placement:Po.DIRECTION.top})}),{loading:y,onClick:I}=S(g),D=(0,h.useMemo)(()=>({loading:y,disabled:!!n,actionType:f.ACTION_TYPE.CONFIRM,btnText:s("developer_mode_add_network_btn_approve"),onClick:I}),[n,y,I]),E=[d,D];return h.default.createElement(k.Container,null,h.default.createElement(V,{title:s("developer_mode_add_network_maintitle_add_network"),backable:!1,closeable:!1}),h.default.createElement(N,null,h.default.createElement(J,{...r})),h.default.createElement(N,{bordered:!1},h.default.createElement(P,{title:s("developer_mode_add_network_title_network_name"),tooltip:s("wallet_dapp_conncetion_add_network_subtitle_network_name_tips")},t.type||t.chainName),t.switchType===G.ADD_ETHEREUM_CHAIN&&[h.default.createElement(P,{title:s("developer_mode_add_network_title_networkurl"),tooltip:s("wallet_dapp_conncetion_add_network_subtitle_network_url_tips")},t.rpcUrl),h.default.createElement(P,{title:s("developer_mode_add_network_title_chainid"),tooltip:s("wallet_dapp_conncetion_add_network_subtitle_chain_id_tips")},t.chainIdToDisplay),h.default.createElement(P,{title:s("developer_mode_add_network_title_currency_symbol"),tooltip:s("wallet_dapp_conncetion_add_network_subtitle_currency_symbol_tips")},t.ticker),h.default.createElement(P,{title:s("developer_mode_add_network_title_block_explorerurl"),tooltip:s("wallet_dapp_conncetion_add_network_subtitle_explorer_url_tips")},t.explorers||t.blockExplorerUrl)]),h.default.createElement(U,{placeholder:!0,offsetBottom:0,borderTop:!0},h.default.createElement(Z,{type:n?To.TYPE.error:To.TYPE.warn,message:n?s("developer_mode_infor_errortip_used_network",{network:n.name}):s("developer_mode_add_network_errortip_risk_aware")}),h.default.createElement(f,{buttonGroup:E})))},_e=Nt;m();c();var xo=u(A());ko();m();c();var $=u(A()),mt=u(ro());bt();ko();Go();m();c();var no=u(A());var Bt=o=>{let[t,e]=(0,no.useState)(null),[i,r]=(0,no.useState)(!1),a=oo();return(0,no.useEffect)(()=>{if(a?.length){let n=a.find(l=>l.realChainIdHex===o);n?(e(n?.chainId),r(!1)):(e(+zo(o)),r(!0))}},[a,o]),{chainIndex:t,isRpcChain:i}},fo=Bt;m();c();var io=u(ro());Et();var M=(o,t)=>{let e=(0,io.useSelector)(Yo),i=(0,io.useSelector)(Ko),r=(0,io.useSelector)(Oo),a=(0,io.useSelector)(p=>Jo(p,o)),n=p=>({...p,address:t});if(i[o]?.includes(r)&&e[r]?.account[so]===t)return n(e[r]||{});if(i[o]?.includes(a)&&e[a]?.account[so]===t)return n(e[a]);let l=i[o]?.find(p=>e[p]?.account[so]===t);return l?n(e[l]):{}};m();c();m();c();var at=u(ro());var Dt=o=>{let t=(0,at.useSelector)(R),e=$o(),i=(r,a)=>e.find(n=>n.appBaseChain==="ethereum"?a&&n.localType===a||Mo(n.realChainId,r):!1)||{};return o?i(o):i(t.chainId,t.type)},F=Dt;var Mt=o=>{let t=K(),{walletId:e}=M(o.origin,o.msgParams?.from),i=b(e),r=F(o?.chainId);return async()=>{i({all_confirmation:"cancel",trade:"sign",dapp_url:o.origin,network:r?.chainName});let{id:a}=o;await t({id:a})}},Ft=o=>{let t=j(),{walletId:e}=M(o.origin,o.msgParams?.from),i=co({walletId:e}),r=b(e),a=F(o?.chainId);return async()=>{let{id:n,msgParams:l,type:p}=o;try{r({all_confirmation:"confirm",trade:"sign",dapp_url:o.origin,network:a?.chainName});let d=await i({msgParams:l,baseChain:o.localType,type:p});await t({id:n,result:d})}catch(d){t({id:n,error:d?.message||"Failed"})}}},Wt=({unapproved:o,preExecInfo:t={}})=>{let e=Mt(o),{loading:i,onClick:r}=S(e),a={actionType:f.ACTION_TYPE.CANCEL,onClick:r,loading:i},n=Ft(o),{loading:l,onClick:p}=S(n),d={actionType:f.ACTION_TYPE.CONFIRM,disabled:t?.canConfirm===!1,onClick:p,loading:l};return{buttonGroup:[a,d],handleCancel:e}},st=Wt;var Lt=({unapproved:o={}})=>{let[t,e]=(0,$.useState)({}),i=B(o),{buttonGroup:r,handleCancel:a}=st({unapproved:o,preExecInfo:t}),{type:n,msgParams:l,chainId:p}=o,{chainId:d}=(0,mt.useSelector)(R),g=p||d,{from:y,isSilentSign:I}=l,D=(0,$.useMemo)(()=>{let z=o.msgParams?.data,H={[G.ETH_SIGN](){return[{value:z}]},[G.PERSONAL_SIGN](){return[{value:vo(z)}]},[G.ETH_SIGN_TYPED_DATA](){return z}};return Do(H[n])?H[n]():[]},[n,o.msgParams?.data]),E=M(o.origin,y)||{},x=fo(g),w=(0,$.useMemo)(()=>({method:n,dappData:JSON.stringify(l),dappInfo:i,from:y,message:D,...x}),[x?.chainIndex]),[Y={}]=oo({chainId:x?.chainIndex})||[];return $.default.createElement(uo,{needPreExecFn:()=>n!==G.PERSONAL_SIGN,txType:po.signMessage,handleCancel:a,preExecParams:w,walletAccount:E,buttonGroup:r,localType:ao,onUpdatePreExecInfo:e,networkFeeProps:{network:Y},slot:{bottom:!!I&&$.default.createElement(lo,{walletAccount:E})}})},ct=Lt;m();c();var Q=u(A()),_t=u(ro());Go();m();c();var C=u(A());v();m();c();var bo=u(A()),lt=u(ro());var Gt=({unapproved:o,walletAccount:t,preExecInfo:e={}})=>{let i=(0,lt.useDispatch)(),{walletId:r}=t,a=b(r),n=F(o.chainId),l=j(),p=K(),d=co({walletId:r}),g=(0,bo.useCallback)(async()=>{let{id:H}=o;a({trade:"sign",all_confirmation:"cancel",network:n?.chainName,dapp_url:o?.origin}),await p({id:H})},[n?.chainName,p,a,i,o]),y=(0,bo.useCallback)(async()=>{let{msgParams:H,id:Bo,localType:Pt,type:St}=o;try{a({trade:"sign",all_confirmation:"confirm",network:n?.chainName,dapp_url:o?.origin});let wo=await d({msgParams:H,baseChain:Pt,type:St});await l({id:Bo,result:wo})}catch(wo){l({id:Bo,error:wo?.message||"Failed"})}},[o,a,r,i,g,n?.chainName,d,l]),{loading:I,onClick:D}=S(g),E={actionType:f.ACTION_TYPE.CANCEL,onClick:D,loading:I},{loading:x,onClick:w}=S(y),Y={actionType:f.ACTION_TYPE.CONFIRM,type:W.TYPE.highlight,disabled:e?.canConfirm===!1,onClick:w,loading:x};return{buttonGroup:[E,Y],handleCancel:g}},_o=Gt;m();c();var go=u(A());m();c();var Co={root:"_root_szca8_1",icon:"_icon_szca8_5",showValue:"_showValue_szca8_11"};var Ot=({icon:o,amount:t,symbol:e})=>go.default.createElement(k.Box,{className:Co.root},go.default.createElement(Lo,{src:o,className:Co.icon}),go.default.createElement(q.AdaptiveText,{autoSize:nt,ellipsis:{tooltip:!0},className:Co.showValue},"- ",t," ",e)),pt=Ot;m();c();var ho=u(A()),ut=u(Fo()),dt=u(eo());m();c();var yo={root:"_root_1wji9_1",price:"_price_1wji9_4",switchIcon:"_switchIcon_1wji9_11"};var Yt=({fromSymbol:o,toSymbol:t,price:e,reversePrice:i})=>{let[r,{toggle:a}]=(0,dt.useBoolean)(!1),n=r?t:o,l=r?o:t,p=r?i:e;return ho.default.createElement(k.FlexBox,{className:yo.root},ho.default.createElement(q.Text,{size:q.SIZE.sm,ellipsis:{tooltip:!0},className:yo.price},"1 ",n," = ",p," ",l),ho.default.createElement(So,{size:So.SIZE.xs,className:(0,ut.default)("okx-wallet-plugin-switch",yo.switchIcon),onClick:a}))},Eo=Yt;var qt={CREATE:"10",REVOCATION:"20"},zt=({unapproved:o={}})=>{let t=F(o.chainId),{dexExtraData:e}=JSON.parse(o.msgParams.data),i=B(o),r=M(o.origin,o.msgParams?.from),{buttonGroup:a}=_o({unapproved:o,walletAccount:r}),{expiration:n,order:l,predictPriceFormat:p,reversePredictPrice:d,sellTokenAmountFormat:g,sellTokenImage:y,sellTokenSymbol:I,type:D}=e,E={icon:y,symbol:I,amount:g},{fromSymbol:x,toSymbol:w,priceFormat:Y,reversePrice:z}=l,H=b(r.walletId);return C.default.createElement(k.Container,null,C.default.createElement(V,{title:D===qt.CREATE?s("swaptrade_limit_title_place_limit_order"):s("swaptrade_limit_title_cancel_limit_order"),closeable:!1,backable:!1}),C.default.createElement(N,null,C.default.createElement(P,{title:s("extension_contract_interaction_maintitle_asset_changes"),tooltip:s("extension_infor_tooltip_asset_changestips")},C.default.createElement(pt,{...E})),C.default.createElement(J,{...i})),C.default.createElement(N,null,C.default.createElement(mo,{title:s("wallet_extension_network_address_title_walletused"),address:r.address,walletId:r.walletId,onCopyCallback:()=>{H({trade:"contract_interaction",all_confirmation:"wallet_used_address"})}})),C.default.createElement(N,{bordered:!1},C.default.createElement(P,{title:s("swaptrade_limit_text_limit_price")},C.default.createElement(Eo,{toSymbol:w,price:Y,fromSymbol:x,reversePrice:z})),C.default.createElement(P,{title:s("swaptrade_limit_text_est_execution_price"),tooltip:s("swaptrade_limit_tooltip_estimated_price")},C.default.createElement(Eo,{toSymbol:w,fromSymbol:x,price:p,reversePrice:d})),C.default.createElement(P,{title:s("swaptrade_limit_text_expiry_time")},C.default.createElement(jo,{size:Zo.sm,dateTime:n,format:"yyyyMMddHHmm"})),C.default.createElement(rt,{coinId:t?.coinId})),C.default.createElement(U,{placeholder:!0,offsetBottom:0,borderTop:!0},C.default.createElement(f,{buttonGroup:a})))},ft=zt;var Ht=({unapproved:o})=>{let[t,e]=(0,Q.useState)({}),{chainId:i,msgParams:{version:r,data:a,from:n,isSilentSign:l}}=o,{chainId:p}=(0,_t.useSelector)(R),g=fo(i||p),y=B(o),I=M(o.origin,n)||{},{buttonGroup:D,handleCancel:E}=_o({unapproved:o,preExecInfo:t,walletAccount:I}),x=(0,Q.useMemo)(()=>({dappInfo:y,dappData:JSON.stringify(o?.msgParams),from:n,method:`eth_signTypedData_${r.toLowerCase()}`,...g}),[g?.chainIndex]),[w={}]=oo({chainId:g?.chainIndex})||[];if(r==="V4"){let Y={};try{Y=JSON.parse(a)}catch(z){console.log(z)}if(Y.dexExtraData)return Q.default.createElement(ft,{unapproved:o})}return Q.default.createElement(uo,{txType:po.signTypedData,handleCancel:E,preExecParams:x,walletAccount:I,buttonGroup:D,localType:ao,onUpdatePreExecInfo:e,networkFeeProps:{network:w},slot:{bottom:!!l&&Q.default.createElement(lo,{walletAccount:I})}})},Ct=Ht;m();c();var L=u(A());v();m();c();var X=u(A());v();var vt=({walletAccount:o,children:t,chainId:e})=>{let[i]=Uo(),{walletAsset:r}=Vo(o.walletId),a=b(o.walletId),n=F(e);return tt(n?.coinId,o.walletId),X.default.createElement(X.default.Fragment,null,X.default.createElement(N,null,X.default.createElement(mo,{title:s("wallet_extension_network_address_title_walletused"),address:o.address,walletId:o.walletId,onCopyCallback:()=>{a({trade:"contract_interaction",all_confirmation:"wallet_used_address"})}})),X.default.createElement(N,{bordered:!1},X.default.createElement(P,{title:s("wallet_dapp_connection_subtitle_balance")},X.default.createElement(q.DisplayAmount,{ellipsis:!0,size:q.SIZE.sm,mode:q.LEGAL,useApproximate:!1,hidden:i?"***":!1},r)),t))},Io=vt;m();c();var T=u(A()),gt=u(Fo());v();m();c();var to={root:"_root_1xv1e_1",msgWrap:"_msgWrap_1xv1e_12",decrypted:"_decrypted_1xv1e_20",copyMsg:"_copyMsg_1xv1e_23",decryptMsg:"_decryptMsg_1xv1e_28"};var Ut=({rawData:o})=>{let t=Qo({showDesc:!1});return T.default.createElement(W,{rect:!0,size:W.SIZE.xxs,type:W.TYPE.primary,category:W.CATEGORY.outline,className:to.copyMsg,onClick:()=>{t(o)}},T.default.createElement(Wo,{className:"okx-wallet-plugin-copy"}),T.default.createElement(k.Box,null,s("wallet_extension_encrypted_text_copy")))},Vt=({unapproved:o,decryptCb:t,walletAccount:e})=>{let i=Ro(),r=(0,T.useCallback)(async()=>{let{msgParams:a}=o,n=await i(e?.walletId,a);t(n)},[t,i,o,e?.walletId]);return T.default.createElement(W,{className:to.decryptMsg,size:W.SIZE.sm,type:W.TYPE.primary,category:W.CATEGORY.outline,icon:"okx-wallet-plugin-lock-1",iconType:W.ICON_POSITION.leading,onClick:r},s("wallet_dapp_conncetion_subtitle_decrypt_metamask_information"))},Zt=({unapproved:o={},walletAccount:t})=>{let[e,i]=(0,T.useState)(!1),[r,a]=(0,T.useState)(o.msgParams?.data),[n,l]=(0,T.useState)(!1),p=d=>{d.error?(l(!0),a(s("wallet_dapp_conncetion_errortip_decrypt_error",{errorMessage:d.error}))):a(d.rawData),i(!0)};return T.default.createElement(P,{title:s("wallet_extension_encrypted_text_encrypted_message")},T.default.createElement(k.Box,{className:to.root},T.default.createElement(k.Box,{className:(0,gt.default)(to.msgWrap,{[to.decrypted]:e})},r),e?!n&&T.default.createElement(Ut,{rawData:r}):T.default.createElement(Vt,{unapproved:o,decryptCb:p,walletAccount:t})))},yt=Zt;m();c();var Ao=u(eo());v();var jt=(o,t)=>{let{id:e}=o,i=b(t?.walletId),r=F(),a=K(),n=(0,Ao.useMemoizedFn)(async()=>{i({all_confirmation:"cancel",trade:"decrypt_message",dapp_url:o.origin,network:r?.chainName}),await a({id:e})}),{loading:l,onClick:p}=S(n),d={loading:l,actionType:f.ACTION_TYPE.CANCEL,btnText:s("wallet_dapp_connection_btn_reject"),onClick:p},g=ot(),y=j(),I=(0,Ao.useMemoizedFn)(async()=>{try{i({all_confirmation:"confirm",trade:"decrypt_message",dapp_url:o.origin,network:r?.chainName});let{msgParams:w}=o,Y=await g(t?.walletId,w);await y({id:e,result:Y})}catch(w){console.log(w),y({id:e,error:"Failed"})}}),{loading:D,onClick:E}=S(I),x={loading:D,actionType:f.ACTION_TYPE.CONFIRM,onClick:E};return[d,x]},ht=jt;var Kt=({unapproved:o})=>{let t=B(o),e=M(o.origin,o.msgParams?.from),i=B(o),r=ht(o,e),a=(0,L.useMemo)(()=>({type:Z.TIP_TYPE.NORMAL,message:s("wallet_dapp_conncetion_notify_decrypt_message",{siteName:i.name||i.host})}),[i]);return L.default.createElement(k.Container,null,L.default.createElement(V,{title:s("wallet_dapp_conncetion_subtitle_decrypt_request"),closeable:!1,backable:!1}),L.default.createElement(N,null,L.default.createElement(J,{...t})),L.default.createElement(Io,{walletAccount:e,chainId:o.chainId},L.default.createElement(yt,{unapproved:o,walletAccount:e})),L.default.createElement(U,{placeholder:!0,offsetBottom:0,borderTop:!0},L.default.createElement(Z,{...a}),L.default.createElement(f,{buttonGroup:r})))},It=Kt;m();c();var O=u(A()),wt=u(eo());v();m();c();var No=u(eo());v();var Jt=(o,t)=>{let{id:e}=o,i=b(t?.walletId),r=F(),a=K(),n=(0,No.useMemoizedFn)(async()=>{i({all_confirmation:"cancel",trade:"get_public_key",dapp_url:o?.origin,network:r?.chainName}),await a({id:e})}),{loading:l,onClick:p}=S(n),d={actionType:f.ACTION_TYPE.CANCEL,btnText:s("wallet_dapp_connection_btn_reject"),onClick:p,loading:l},g=Xo(),y=j(),I=(0,No.useMemoizedFn)(async()=>{try{i({all_confirmation:"confirm",trade:"get_public_key",dapp_url:o?.origin,network:r?.chainName});let w=await g(t?.walletId,o.msgParams);y({id:e,result:w})}catch(w){console.log(w),y({id:e,error:"Failed"})}}),{loading:D,onClick:E}=S(I),x={actionType:f.ACTION_TYPE.CONFIRM,btnText:s("wallet_dapp_conncetion_btn_provide"),onClick:E,loading:D};return[d,x]},xt=Jt;var $t=({unapproved:o})=>{let t=M(o.origin,o.msgParams),e=xt(o,t),i=B(o),r=B(o),a=b(t?.walletId);(0,wt.useMount)(()=>{a({all_confirmation:"confirm",trade:"get_public_key",dapp_url:o?.origin})});let n=(0,O.useMemo)(()=>({type:Z.TIP_TYPE.NORMAL,message:s("wallet_dapp_conncetion_notify_public_key_notice",{siteName:r.name||r.host})}),[r]);return O.default.createElement(k.Container,null,O.default.createElement(V,{title:s("wallet_dapp_conncetion_notify_public_key_request"),closeable:!1,backable:!1}),O.default.createElement(N,null,O.default.createElement(J,{...i})),O.default.createElement(Io,{walletAccount:t,chainId:o.chainId}),O.default.createElement(U,{placeholder:!0,offsetBottom:0,borderTop:!0},O.default.createElement(Z,{...n}),O.default.createElement(f,{buttonGroup:e})))},kt=$t;var Qt=o=>{let{msgParams:{version:t},type:e}=o;return e===G.ETH_GET_ENCRYPTION_PUBLIC_KEY?kt:e===G.ETH_DECRYPT?It:e===G.ETH_SIGN_TYPED_DATA&&["V3","V4"].includes(t)?Ct:ct},Xt=(0,xo.memo)(o=>{let{unapproved:t={}}=o,e=Qt(t);return xo.default.createElement(e,{unapproved:t})}),ma=Xt;m();c();var Tt=u(A());At();var Rt=()=>(0,Tt.useCallback)(async(o,t)=>{await qo().handleErc20Token(o,t)},[]),da=Rt;export{_e as a,da as b,M as c,F as d,ma as e};
//# sourceMappingURL=chunk-37NOBJJN.js.map
