import{b as Ie}from"./chunk-73B6GL3S.js";import{f as je,o as Y,q as ee}from"./chunk-Y5OH3DDZ.js";Y();ee();var fe=je(Ie(),1);var I=class de extends Error{constructor(t,n,o){super(typeof n=="object"?n.message:n||t,{cause:typeof n=="object"?n.cause:o}),this.type=t,Object.setPrototypeOf(this,de.prototype)}};function Le(e){return e.replace(/_[a-z]/g,t=>t[1].toUpperCase())}var Ne="ERR_INVALID_VALUE",$e="ERR_UNEXPECTED_VALUE",qe="ERR_UNEXPECTED_TYPE",Ue="ERR_PARSE";function He(e){let t=e;if(typeof t=="string")try{t=JSON.parse(t)}catch(n){throw new I(Ne,{cause:n})}if(typeof t!="object"||!t||Array.isArray(t))throw new I($e);return t}function k(e,t){return n=>{let o=r=>{if(!(n&&r===void 0))try{return t(r)}catch(s){throw new I(Ue,{message:`"${e}" transformer failed to parse the value`,cause:s})}};return Object.assign(o,{isValid(r){try{return o(r),!0}catch{return!1}}})}}function Z(e){throw new I(qe,`Unexpected value received: ${JSON.stringify(e)}`)}var sn=k("boolean",e=>{if(typeof e=="boolean")return e;let t=String(e);if(t==="1"||t==="true")return!0;if(t==="0"||t==="false")return!1;Z(e)}),We=k("string",e=>{if(typeof e=="string"||typeof e=="number")return e.toString();Z(e)}),ze=k("number",e=>{if(typeof e=="number")return e;if(typeof e=="string"){let t=Number(e);if(!Number.isNaN(t))return t}Z(e)}),an=k("date",e=>e instanceof Date?e:new Date(ze()(e)*1e3));function _e(e){return/^#[\da-f]{6}$/i.test(e)}function Ge(e){return/^#[\da-f]{3}$/i.test(e)}function Je(e){let t=e.replace(/\s/g,"").toLowerCase();if(_e(t))return t;if(Ge(t)){let o="#";for(let r=0;r<3;r+=1)o+=t[1+r].repeat(2);return o}let n=t.match(/^rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/)||t.match(/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),\d{1,3}\)$/);if(!n)throw new Error(`Value "${e}" does not satisfy any of known RGB formats.`);return n.slice(1).reduce((o,r)=>{let s=parseInt(r,10).toString(16);return o+(s.length===1?"0":"")+s},"#")}var Fe=k("rgb",e=>Je(We()(e))),un=k("themeParams",e=>{let t=Fe(!0);return Object.entries(He(e)).reduce((n,[o,r])=>(n[Le(o)]=t(r),n),{})});var V=class be extends Error{constructor(t,n,o){super(typeof n=="object"?n.message:n||t,{cause:typeof n=="object"?n.cause:o}),this.type=t,Object.setPrototypeOf(this,be.prototype)}};function Ze(e){return e.replace(/_[a-z]/g,t=>t[1].toUpperCase())}var Ke="ERR_INVALID_VALUE",Xe="ERR_UNEXPECTED_VALUE",Qe="ERR_UNEXPECTED_TYPE",he="ERR_PARSE";function Ye(e,t){let n={};for(let o in e){let r=e[o];if(!r)continue;let s,a;typeof r=="function"?(s=o,a=r):[s,a]=r;try{let i=a(t(s));i!==void 0&&(n[o]=i)}catch(i){throw new V(he,`Parser for "${o}" property failed${s===o?"":`. Source field: "${s}"`}`,i)}}return n}function me(e){let t=e;if(typeof t=="string")try{t=JSON.parse(t)}catch(n){throw new V(Ke,{cause:n})}if(typeof t!="object"||!t||Array.isArray(t))throw new V(Xe);return t}function w(e,t){return n=>{let o=r=>{if(!(n&&r===void 0))try{return t(r)}catch(s){throw new V(he,{message:`"${e}" transformer failed to parse the value`,cause:s})}};return Object.assign(o,{isValid(r){try{return o(r),!0}catch{return!1}}})}}function y(e,t){return w(t||"object",n=>{let o=me(n);return Ye(e,r=>o[r])})}function $(e){throw new V(Qe,`Unexpected value received: ${JSON.stringify(e)}`)}var te=w("boolean",e=>{if(typeof e=="boolean")return e;let t=String(e);if(t==="1"||t==="true")return!0;if(t==="0"||t==="false")return!1;$(e)}),C=w("string",e=>{if(typeof e=="string"||typeof e=="number")return e.toString();$(e)}),J=w("number",e=>{if(typeof e=="number")return e;if(typeof e=="string"){let t=Number(e);if(!Number.isNaN(t))return t}$(e)}),cn=w("date",e=>e instanceof Date?e:new Date(J()(e)*1e3));function et(e){return/^#[\da-f]{6}$/i.test(e)}function tt(e){return/^#[\da-f]{3}$/i.test(e)}function nt(e){let t=e.replace(/\s/g,"").toLowerCase();if(et(t))return t;if(tt(t)){let o="#";for(let r=0;r<3;r+=1)o+=t[1+r].repeat(2);return o}let n=t.match(/^rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/)||t.match(/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),\d{1,3}\)$/);if(!n)throw new Error(`Value "${e}" does not satisfy any of known RGB formats.`);return n.slice(1).reduce((o,r)=>{let s=parseInt(r,10).toString(16);return o+(s.length===1?"0":"")+s},"#")}var ot=w("rgb",e=>nt(C()(e))),pn=w("themeParams",e=>{let t=ot(!0);return Object.entries(me(e)).reduce((n,[o,r])=>(n[Ze(o)]=t(r),n),{})});var rt=y({eventType:C(),eventData:e=>e},"miniAppsMessage"),ge=w("fn",e=>{if(typeof e=="function")return e;$(e)});var st=y({TelegramWebviewProxy:y({postEvent:ge()})()});function at(e){return st().isValid(e)}function it(){try{return window.self!==window.top}catch{return!0}}var ut=Object.defineProperty,ct=(e,t,n)=>t in e?ut(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,we=(e,t,n)=>ct(e,typeof t!="symbol"?t+"":t,n),_=class ye extends Error{constructor(t,n,o){super(typeof n=="object"?n.message:n||t,{cause:typeof n=="object"?n.cause:o}),this.type=t,Object.setPrototypeOf(this,ye.prototype)}};function F(e,t,n){return e.addEventListener(t,n),()=>e.removeEventListener(t,n)}function q(...e){let t=e.flat(1);return[t.push.bind(t),()=>{t.forEach(n=>{n()})}]}function pt(e,t){return e instanceof _&&e.type===t}function K(e){return t=>pt(t,e)}var Ee="ERR_ABORTED",ve="ERR_CANCELED",Se="ERR_TIMED_OUT";function ne(e){return new _(Ee,{cause:e})}var ln=K(Se),fn=K(Ee),dn=K(ve);function oe(e,t){return e.reject=t.reject,e}var m=class extends Promise{constructor(t,n){let o,r;typeof t=="function"?(o=t,r=n):r=t;let s,a;super((i,c)=>{r||(r={});let{abortSignal:u}=r;if(u&&u.aborted)return c(ne(u.reason));let[p,d]=q(),h=T=>(...Ve)=>(d(),T(...Ve)),R=new AbortController,{signal:S}=R;a=h(T=>{R.abort(T),c(T)}),s=h(i),u&&p(F(u,"abort",()=>{a(ne(u.reason))}));let{timeout:H}=r;if(H){let T=setTimeout(()=>{a(new _(Se,`Timeout reached: ${H}ms`))},H);p(()=>{clearTimeout(T)})}o&&o(s,a,S)}),we(this,"reject"),this.reject=a}static withFn(t,n){return new m((o,r,s)=>{try{let a=t(s);return a instanceof Promise?a.then(o,r):o(a)}catch(a){r(a)}},n)}static resolve(t){return new m(n=>{n(t)})}static reject(t){return new m((n,o)=>{o(t)})}cancel(){this.reject(new _(ve))}catch(t){return this.then(void 0,t)}finally(t){return oe(super.finally(t),this)}then(t,n){return oe(super.then(t,n),this)}};function re(e,t){return e.resolve=t.resolve,e}var A=class extends m{constructor(t,n){let o,r;typeof t=="function"?(o=t,r=n):r=t;let s;super((a,i,c)=>{s=a,o&&o(a,i,c)},r),we(this,"resolve"),this.resolve=s}static withFn(t,n){return new A((o,r,s)=>m.withFn(t,{abortSignal:s}).then(o,r),n)}static resolve(t){return new A(n=>{n(t)})}static reject(t){return new A((n,o)=>{o(t)})}catch(t){return this.then(void 0,t)}finally(t){return re(super.finally(t),this)}then(t,n){return re(super.then(t,n),this)}};function Ce(e){return`tapps/${e}`}function lt(e,t){sessionStorage.setItem(Ce(e),JSON.stringify(t))}function ft(e){let t=sessionStorage.getItem(Ce(e));try{return t?JSON.parse(t):void 0}catch{}}function dt(e,t){t||(t={});let{textColor:n,bgColor:o,shouldLog:r=!0}=t;function s(a,...i){if(!r||typeof r=="function"&&!r())return;let c="font-weight:bold;padding:0 5px;border-radius:5px";console[a](`%c${Intl.DateTimeFormat("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,timeZone:"UTC"}).format(new Date)}%c / %c${e}`,`${c};background-color: lightblue;color:black`,"",`${c};${n?`color:${n};`:""}${o?`background-color:${o}`:""}`,...i)}return[function(...a){s("log",...a)},function(...a){s("error",...a)}]}function _t(e,t){t()}function O(e,t){t||(t={});let n=t.equals||Object.is,o=[],r=e,s=u=>{if(!n(r,u)){let p=r;r=u,_t(c,()=>{[...o].forEach(([d,h])=>{d(u,p),h&&i(d,!0)})})}};function a(u){let p=typeof u!="object"?{once:u}:u;return{once:p.once||!1,signal:p.signal||!1}}let i=(u,p)=>{let d=a(p),h=o.findIndex(([R,S])=>R===u&&S.once===d.once&&S.signal===d.signal);h>=0&&o.splice(h,1)},c=Object.assign(function(){return bt(c),r},{destroy(){o=[]},set:s,reset(){s(e)},sub(u,p){return o.push([u,a(p)]),()=>i(u,p)},unsub:i,unsubAll(){o=o.filter(u=>u[1].signal)}});return c}var W=[];function bt(e){W.length&&W[W.length-1].add(e)}var ht=O(!1),[Ae,mt]=dt("Bridge",{bgColor:"#9147ff",textColor:"white",shouldLog:ht}),gt={clipboard_text_received:y({req_id:C(),data:e=>e===null?e:C(!0)(e)},"clipboard_text_received"),custom_method_invoked:y({req_id:C(),result:e=>e,error:C(!0)},"custom_method_invoked"),popup_closed:w("popup_closed",e=>e?y({button_id:t=>t==null?void 0:C()(t)})()(e):{}),viewport_changed:y({height:J(),width:e=>e==null?window.innerWidth:J()(e),is_state_stable:te(),is_expanded:te()},"viewport_changed")};function wt(e){let t=window,[,n]=q(F(t,"resize",()=>{e(["viewport_changed",{width:window.innerWidth,height:window.innerHeight,is_state_stable:!0,is_expanded:!0}])}),F(t,"message",o=>{if(o.source!==t.parent)return;let r;try{r=rt()(o.data)}catch{return}let{eventType:s,eventData:a}=r,i=gt[s];try{let c=i?i()(a):a;Ae("Event received:",c?{eventType:s,eventData:c}:{eventType:s}),e([s,c])}catch(c){mt([`An error occurred processing the "${s}" event from the Telegram application.`,"Please, file an issue here:","https://github.com/Telegram-Mini-Apps/telegram-apps/issues/new/choose"].join(`
`),r,c)}}));return n}var se=O(),ae=O();function yt(){return ae()||ae.set(wt(se.set)),se}var z=O({});function Be(e){let t=z()[e];return t||(t=O(void 0,{equals(){return!1}}),yt().sub(n=>{n&&n[0]===e&&t.set(n[1])}),z.set({...z(),[e]:t})),t}function L(e,t,n){return Be(e).sub(t,n)}var Et="ERR_UNKNOWN_ENV";var vt=O("https://web.telegram.org");function Pe(e,t){Ae("Posting event:",t?{eventType:e,eventData:t}:{eventType:e});let n=window;if(at(n)){n.TelegramWebviewProxy.postEvent(e,JSON.stringify(t));return}let o=JSON.stringify({eventType:e,eventData:t});if(it())return n.parent.postMessage(o,vt());let{external:r}=n;if(y({notify:ge()})().isValid(r)){r.notify(o);return}throw new _(Et)}function St(e,t,n){n||(n={});let{capture:o}=n,[r,s]=q();return new m(a=>{(Array.isArray(t)?t:[t]).forEach(i=>{r(L(i,c=>{(!o||(Array.isArray(t)?o({event:i,payload:c}):o(c)))&&a(c)}))}),(n.postEvent||Pe)(e,n.params)},n).finally(s)}function Ct(e,t,n){Be(e).unsub(t,n)}function ie(e){return e.split(".").map(Number)}function At(e,t){let n=ie(e),o=ie(t),r=Math.max(n.length,o.length);for(let s=0;s<r;s+=1){let a=n[s]||0,i=o[s]||0;if(a!==i)return a>i?1:-1}return 0}function f(e,t){return At(e,t)<=0}function X(e,t,n){if(typeof n=="string"){if(e==="web_app_open_link"){if(t==="try_instant_view")return f("6.4",n);if(t==="try_browser")return f("7.6",n)}if(e==="web_app_set_header_color"&&t==="color")return f("6.9",n);if(e==="web_app_close"&&t==="return_back")return f("7.6",n);if(e==="web_app_setup_main_button"&&t==="has_shine_effect")return f("7.10",n)}switch(e){case"web_app_open_tg_link":case"web_app_open_invoice":case"web_app_setup_back_button":case"web_app_set_background_color":case"web_app_set_header_color":case"web_app_trigger_haptic_feedback":return f("6.1",t);case"web_app_open_popup":return f("6.2",t);case"web_app_close_scan_qr_popup":case"web_app_open_scan_qr_popup":case"web_app_read_text_from_clipboard":return f("6.4",t);case"web_app_switch_inline_query":return f("6.7",t);case"web_app_invoke_custom_method":case"web_app_request_write_access":case"web_app_request_phone":return f("6.9",t);case"web_app_setup_settings_button":return f("6.10",t);case"web_app_biometry_get_info":case"web_app_biometry_open_settings":case"web_app_biometry_request_access":case"web_app_biometry_request_auth":case"web_app_biometry_update_token":return f("7.2",t);case"web_app_setup_swipe_behavior":return f("7.7",t);case"web_app_setup_secondary_button":case"web_app_set_bottom_bar_color":return f("7.10",t);default:return["iframe_ready","iframe_will_reload","web_app_close","web_app_data_send","web_app_expand","web_app_open_link","web_app_ready","web_app_request_theme","web_app_request_viewport","web_app_setup_main_button","web_app_setup_closing_behavior"].includes(e)}}function Bt(){return performance.getEntriesByType("navigation")[0]}function Pt(){let e=Bt();return!!e&&e.type==="reload"}var ue;function Rt(e,t){ue&&ue.set(e,t)||t()}function b(e,t){t||(t={});let n=t.equals||Object.is,o=[],r=e,s=u=>{if(!n(r,u)){let p=r;r=u,Rt(c,()=>{[...o].forEach(([d,h])=>{d(u,p),h&&i(d,!0)})})}};function a(u){let p=typeof u!="object"?{once:u}:u;return{once:p.once||!1,signal:p.signal||!1}}let i=(u,p)=>{let d=a(p),h=o.findIndex(([R,S])=>R===u&&S.once===d.once&&S.signal===d.signal);h>=0&&o.splice(h,1)},c=Object.assign(function(){return Tt(c),r},{destroy(){o=[]},set:s,reset(){s(e)},sub(u,p){return o.push([u,a(p)]),()=>i(u,p)},unsub:i,unsubAll(){o=o.filter(u=>u[1].signal)}});return c}var M=[];function Tt(e){M.length&&M[M.length-1].add(e)}function E(e,t){let n=new Set,o=b(s(),t);function r(){o.set(s())}function s(){n.forEach(c=>c.unsub(r,{signal:!0}));let a=new Set,i;M.push(a);try{i=e()}finally{M.pop()}return a.forEach(c=>{c.sub(r,{signal:!0})}),n=a,i}return Object.assign(function(){return o()},{destroy:o.destroy,sub:o.sub,unsub:o.unsub,unsubAll:o.unsubAll})}var kt=b(Pe),Q=b("0.0");var Ot=(e,t,n)=>(n||(n={}),n.postEvent||(n.postEvent=j),St(e,t,n)),j=(e,t)=>kt()(e,t);function xt(e,t){t(),e.sub(t)}var Re="web_app_setup_back_button",Te="back_button_pressed",ke="backButton";function Dt(){B.set(!1)}function Mt(){return X(Re,Q())}var B=b(!1),N=b(!1);function Vt(){N()||(B.set(Pt()&&ft(ke)||!1),xt(B,Oe),N.set(!0))}function Oe(){let e=B();j(Re,{is_visible:e}),lt(ke,e)}function jt(e){return L(Te,e)}function It(e){Ct(Te,e)}function Lt(){B.set(!0)}function Nt(){B.unsub(Oe),N.set(!1)}var _n=Object.freeze(Object.defineProperty({__proto__:null,hide:Dt,isMounted:N,isSupported:Mt,isVisible:B,mount:Vt,offClick:It,onClick:jt,show:Lt,unmount:Nt},Symbol.toStringTag,{value:"Module"})),x="ERR_POPUP_INVALID_PARAMS",$t="ERR_INVALID_HOSTNAME";var xe="ERR_ALREADY_CALLED";var qt=b(void 0);function g(e){return E(()=>{let t=qt();return t?t[e]:void 0})}var bn=g("authDate"),hn=g("canSendAfter");var mn=g("chat"),gn=g("chatType"),wn=g("chatInstance"),yn=g("hash"),En=g("queryId");var vn=g("receiver");var Sn=g("startParam"),Cn=g("user");var Ut=b({});function l(e){return E(()=>Ut()[e])}var An=l("accentTextColor"),Ht=l("bgColor"),De=l("buttonColor"),Wt=l("buttonTextColor"),zt=l("bottomBarBgColor"),Bn=l("destructiveTextColor"),Pn=l("headerBgColor"),Rn=l("hintColor");var Tn=l("linkColor"),ce=l("secondaryBgColor"),kn=l("sectionBgColor"),On=l("sectionHeaderTextColor"),xn=l("sectionSeparatorColor"),Dn=l("subtitleTextColor"),Mn=l("textColor");function P(e){return E(()=>Jt()[e])}var Gt=b({hasShineEffect:!1,isEnabled:!0,isLoaderVisible:!1,isVisible:!1,text:"Continue"}),Jt=E(()=>{let e=Gt();return{...e,backgroundColor:e.backgroundColor||De()||"#2481cc",textColor:e.textColor||Wt()||"#ffffff"}});var Vn=P("backgroundColor"),jn=P("hasShineEffect"),In=P("isEnabled"),Ln=P("isLoaderVisible"),Nn=P("isVisible"),$n=P("text"),qn=P("textColor");var Ft=b("bottom_bar_bg_color"),Zt=E(()=>{let e=Ft();return _e(e)?e:e==="bottom_bar_bg_color"?zt()||ce():e==="secondary_bg_color"?ce():Ht()});function Kt(e){let t=e.message.trim(),n=(e.title||"").trim(),o=e.buttons||[];if(n.length>64)throw new _(x,`Invalid title: ${n}`);if(!t||t.length>256)throw new _(x,`Invalid message: ${t}`);if(o.length>3)throw new _(x,`Invalid buttons count: ${o.length}`);return{title:n,message:t,buttons:o.length?o.map((r,s)=>{let a=r.id||"";if(a.length>64)throw new _(x,`Button with index ${s} has invalid id: ${a}`);if(!r.type||r.type==="default"||r.type==="destructive"){let i=r.text.trim();if(!i||i.length>64)throw new _(x,`Button with index ${s} has invalid text: ${i}`);return{type:r.type,text:i,id:a}}return{type:r.type,id:a}}):[{type:"close",id:""}]}}var Xt="web_app_open_popup";var G=b(!1);async function Un(e){if(G())throw new _(xe);G.set(!0);try{let{button_id:t=null}=await Ot(Xt,"popup_closed",{...e,params:Kt(e)});return t}finally{G.set(!1)}}var Qt="web_app_close_scan_qr_popup",Me="web_app_open_scan_qr_popup",Yt="scan_qr_popup_closed",en="qr_text_received";function pe(){D.set(!1),j(Qt)}var D=b(!1);function Hn(){return X(Me,Q())}function Wn(e){return m.withFn(t=>{if(D())throw new _(xe);D.set(!0),e||(e={});let{onCaptured:n,text:o,capture:r}=e,[,s]=q(D.sub(()=>{a.resolve()}),L(Yt,()=>{D.set(!1)}),L(en,i=>{n?n(i.data):r&&r(i.data)&&(a.resolve(i.data),pe())})),a=new A({abortSignal:t}).catch(pe).finally(s);return(e.postEvent||j)(Me,{text:o}),a},e)}function v(e){return E(()=>nn()[e])}var tn=b({hasShineEffect:!1,isEnabled:!0,isLoaderVisible:!1,isVisible:!1,position:"left",text:"Cancel"}),nn=E(()=>{let e=tn();return{...e,backgroundColor:e.backgroundColor||Zt()||"#000000",textColor:e.textColor||De()||"#2481cc"}});var zn=v("backgroundColor"),Gn=v("hasShineEffect"),Jn=v("isEnabled"),Fn=v("isLoaderVisible"),Zn=v("isVisible"),Kn=v("position"),Xn=v("text"),Qn=v("textColor");var on=b({height:0,width:0,isExpanded:!1,stableHeight:0});function U(e){return E(()=>on()[e])}var Yn=U("height"),eo=U("isExpanded");var to=U("stableHeight"),no=U("width");var le="web_app_open_tg_link";function oo(e){let{hostname:t,pathname:n,search:o}=new URL(e,"https://t.me");if(t!=="t.me")throw new _($t);if(!X(le,Q())){window.location.href=e;return}j(le,{path_full:n+o})}export{_n as a,Un as b,pe as c,Hn as d,Wn as e,oo as f};
//# sourceMappingURL=chunk-MJKLSIQL.js.map
