import{c as Se,i as Ie}from"./chunk-V7ZNWTMX.js";import{a as ue,k as he,m as Ce}from"./chunk-MSP5TDR3.js";import{a as re,c as oe}from"./chunk-XFPD3Q2E.js";import{a as ge}from"./chunk-MC7IOE6A.js";import{a as le}from"./chunk-33XRMYWN.js";import{v as me}from"./chunk-FVCINJIW.js";import{a as H,b as fe}from"./chunk-QRAFULYC.js";import{b as E}from"./chunk-ITDLKQAF.js";import{a as Ae}from"./chunk-CIVR4FUI.js";import{a as pe}from"./chunk-U7IWD6UB.js";import{f as de}from"./chunk-VJI6MZK4.js";import{o as Ee}from"./chunk-Z62JX42S.js";import{Na as we,a as te,aa as j,b as ne,d as Pe,f as ie,la as ce}from"./chunk-2QHGKEME.js";import{a as xe}from"./chunk-6PA65BO3.js";import{a as ee,c as z}from"./chunk-EFOY37CC.js";import{b as se,c as Ue}from"./chunk-GR7YC6C3.js";import{E as ae,J as ye}from"./chunk-O33H5V3V.js";import{J,f as X,n as P,qa as Q,va as Y}from"./chunk-XFTQD4B2.js";import{b as Z}from"./chunk-73B6GL3S.js";import{f as _,o as h,q as C}from"./chunk-Y5OH3DDZ.js";h();C();h();C();var ve="content_script_message",ze={goToDexSwapMemeMode:"goToDexSwapMemeMode",notifyRedirect:"notifyRedirect",storeIframeAuthToken:"storeIframeAuthToken",getWebWidgetStatus:"getWebWidgetStatus",minimizeIframe:"minimizeIframe",resizeIframe:"resizeIframe",caScrapingResult:"caScrapingResult"},L="redirect_param_",Te="redirect_pathname",Re="redirect_search_params";var $e=n=>Object.entries(n).map(([t,e])=>{let s=Array.isArray(e)?encodeURIComponent(e.join(",")):encodeURIComponent(e);return`${t}=${s}`}).join("&"),qe=n=>{let t=new URLSearchParams(n),e=t.get(Te),s=t.get(Re),a={};return s&&s.split("&").filter(l=>l.includes(L)).forEach(l=>{let[m,g]=l.split("="),p=m.replace(L,""),d=decodeURIComponent(g);d.includes(",")?a[p]=d.split(",").map(f=>f.trim()):a[p]=d}),{redirectPathname:e,redirectSearchParams:a}};h();C();var be=_(Z()),x=_(xe());var Be=()=>{let n=(0,x.useHistory)(),t=(0,x.useLocation)();return(0,be.useCallback)((s,a={})=>{let{overrideCurrentPath:l=!1,clearSearchParams:m=!1,preserveState:g=!0,replaceInsteadOfPush:p=!1,removeExistingSearchKeys:d=[],newSearchParams:f=""}=a,{search:S}=t,I=new URLSearchParams(S);d&&d.forEach(T=>{I.delete(T)}),n.replace({pathname:l||t.pathname,search:m?"":I.toString(),state:g?t.state:null}),n[p?"replace":"push"]({pathname:s,search:f||""})},[n,t])},Je=Be;h();C();Y();var k=_(Pe());var We=(0,k.createSelectorCreator)(k.defaultMemoize,J),Fe=We(n=>{let{createdMap:t={},needSyncMap:e={}}=n.metamask;return{createdMap:t,needSyncMap:e}},j,({createdMap:n,needSyncMap:t},e)=>{let s=Boolean(n[e]),a=Boolean(t[e]);return!(!s||a)}),B="--",y=(n,t)=>n??t,Ne=(n,t,e)=>{let{tokenTotalAssetsUSD:s,defiTotalAssetsUSD:a,nftTotalAssetsUSD:l,platformTotalAssetsUSD:m}=n,g=l??"0",p=a??"0",d=s??"0",f=m??"0",S=s,I=t?z(S,g):S,b=z(I,a);return{walletAsset:ee(b,e?.usdToThisRate??"1"),walletAssetUSD:b,platformAssetUSD:f,nftBalanceUSD:g,defiBalanceUSD:p,tokenBalanceUSD:d}},Oe=(0,k.createSelector)(Fe,Ce,j,n=>de(n)?.currentNetworkUniqueId||"",ce,me,he,te,ne,ie,re,(n,t,e,s,a,l,m,g,p,d,f)=>{let S=d?.length&&t?.[e]&&!t?.[e]?.loading,{open:I,amount:b}=f,T=S?oe({isReady:!!t[e]?.coins&&n,defaultBaseCoinsCoinIds:m.size>0?Array.from(m):[],addedCoins:y(g[e],[]),reducedCoins:y(p[e],[]),balanceCoins:y(t[e]?.coins,[]),defi:y(t[e]?.defi,null),nft:y(t[e]?.nft,null),networks:d.map(o=>({chainId:o})),walletId:e,coinsMap:null,hiddenSmallAssets:I,smallAssetsAmount:b,customFilter:({chainId:o})=>s===""||o===Number(s)}):null;if(!T)return{walletAsset:B,walletAssetUSD:B,platformAssetUSD:B,nftBalanceUSD:B};let{walletAsset:W,walletAssetUSD:F,platformAssetUSD:N,nftBalanceUSD:O,defiBalanceUSD:i,tokenBalanceUSD:A}=Ne(T,l,a);return{walletAsset:W,walletAssetUSD:F,platformAssetUSD:N,nftBalanceUSD:O,defiBalanceUSD:i,tokenBalanceUSD:A,smallTotalAssetsUSD:T.smallTotalAssetsUSD,walletId:e}}),mt=Oe;h();C();var U=_(Z()),De=_(we()),u=_(Ee());Y();Ue();ye();var G=300,Pt=()=>{let n=pe(),t=(0,De.useDispatch)(),e=Se(n),s=Ae(),a=(0,U.useRef)({}),l=(0,U.useRef)({}),m=(0,U.useRef)({}),{data:g,set:p}=ge(le.coinTickers),d=Ie();(0,U.useEffect)(()=>{t(ue(d))},[t,d]);let f=i=>{p({...g,...i})},S=(0,u.useMemoizedFn)(async i=>{let A=P(i,G),o=[];try{(await Promise.all(A.map(c=>{let $=c.filter(M=>m.current[M]),R={coinIds:c,aggregationCoinIdList:$},D={headers:{currency:"usd"}};return ae(se.postMarketUrl,R,D)})))?.forEach(c=>{Array.isArray(c?.data)&&(o=o.concat(c.data))})}catch{X()}o.forEach(r=>{r?.coinId&&(l.current[r.coinId]={coinToUSDRate:r?.currencyAmount,coinPriceChangePercent24h:r?.priceChangePercent24h,priceCoinId:r?.priceCoinId,anchorStatus:r?.anchorStatus??null})}),f(l.current)}),{needFetchCoinIds:I,needFetchData:b}=(0,u.useCreation)(()=>{if(e.length||s.length){let i=e.concat(s).filter(r=>Boolean(r?.coinId));return Q(i,"coinId").reduce((r,c)=>(r.needFetchCoinIds.push(c.coinId),r.needFetchData.push({coinId:c.coinId,baseCoinId:c?.baseCoinId,chainIndex:c?.chainId,tokenAddress:c?.address,aggregation:c?.aggregation}),r),{needFetchCoinIds:[],needFetchData:[]})}return{needFetchCoinIds:[],needFetchData:[]}},[e,s]),T=(0,u.useMemoizedFn)(i=>{if(!i?.length)return;let{coinIdToInstIdMap:A,coinIdAggregationMap:o}=i.reduce((R,D)=>{let{coinIdToInstIdMap:M,coinIdAggregationMap:q}=R,{coinId:K,baseCoinId:Me,chainIndex:V,tokenAddress:_e,aggregation:ke}=D,v="";return Me===0?v=`${V}`:v=`${V}-${_e}`,M[K]=v,q[K]=ke,{coinIdToInstIdMap:M,coinIdAggregationMap:q}},{coinIdToInstIdMap:{},coinIdAggregationMap:{}});m.current=o;let r=[],c=Object.entries(A).reduce((R,[D,M])=>(a.current[D]||(a.current[D]=M,r.push(D),R.push({channel:E,instId:M})),R),[]);P(c,G).forEach(R=>{H.sendChannel({op:"subscribe",args:R})}),r.length&&S(r)}),{run:W}=(0,u.useDebounceFn)(T,{wait:200}),{run:F}=(0,u.useDebounceFn)(()=>{f(l.current)},{wait:1e3}),N=(0,u.useMemoizedFn)(()=>{S(Object.keys(a.current))}),O=(0,u.useMemoizedFn)(i=>{if(!i||!Array.isArray(i?.data))return;let{data:A}=i,o=A[0];if(o?.coinId){let r=o.coinId,c=l.current[r];l.current[r]={...c,coinToUSDRate:o.price,coinPriceChangePercent24h:o.priceChangePercent24h},F()}});fe(E,{onError:N,onSuccess:O,pollingInterval:30*1e3}),(0,u.useDeepCompareEffect)(()=>{W(b)},[I]),(0,u.useUnmount)(()=>{let i=Object.values(a.current).map(o=>({channel:E,instId:o}));P(i,G).forEach(o=>{H.sendChannel({op:"unsubscribe",args:o})}),a.current={}})};export{ve as a,ze as b,$e as c,qe as d,Je as e,Pt as f,Fe as g,B as h,mt as i};
//# sourceMappingURL=chunk-TS6QJPGP.js.map
