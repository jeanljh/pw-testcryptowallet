import{c as j,o as B,q as A}from"./chunk-Y5OH3DDZ.js";var Go=j(wn=>{B();A();Object.defineProperty(wn,"__esModule",{value:!0});wn.crypto=void 0;wn.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var Dt=j(D=>{B();A();Object.defineProperty(D,"__esModule",{value:!0});D.wrapXOFConstructorWithOpts=D.wrapConstructorWithOpts=D.wrapConstructor=D.Hash=D.nextTick=D.swap32IfBE=D.byteSwapIfBE=D.swap8IfBE=D.isLE=void 0;D.isBytes=Zo;D.anumber=_r;D.abytes=Pt;D.ahash=ia;D.aexists=ca;D.aoutput=aa;D.u8=da;D.u32=ua;D.clean=fa;D.createView=la;D.rotr=ha;D.rotl=ba;D.byteSwap=wr;D.byteSwap32=Fo;D.bytesToHex=xa;D.hexToBytes=ga;D.asyncLoop=_a;D.utf8ToBytes=Er;D.bytesToUtf8=ma;D.toBytes=En;D.kdfInputToBytes=wa;D.concatBytes=Ea;D.checkOpts=Ba;D.createHasher=zo;D.createOptHasher=Wo;D.createXOFer=Yo;D.randomBytes=Aa;var Rt=Go();function Zo(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function _r(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function Pt(e,...t){if(!Zo(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function ia(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");_r(e.outputLen),_r(e.blockLen)}function ca(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function aa(e,t){Pt(e);let n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function da(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function ua(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function fa(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function la(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function ha(e,t){return e<<32-t|e>>>t}function ba(e,t){return e<<t|e>>>32-t>>>0}D.isLE=(()=>new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68)();function wr(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}D.swap8IfBE=D.isLE?e=>e:e=>wr(e);D.byteSwapIfBE=D.swap8IfBE;function Fo(e){for(let t=0;t<e.length;t++)e[t]=wr(e[t]);return e}D.swap32IfBE=D.isLE?e=>e:Fo;var Xo=(()=>typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function")(),ya=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function xa(e){if(Pt(e),Xo)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=ya[e[n]];return t}var nt={_0:48,_9:57,A:65,F:70,a:97,f:102};function Ko(e){if(e>=nt._0&&e<=nt._9)return e-nt._0;if(e>=nt.A&&e<=nt.F)return e-(nt.A-10);if(e>=nt.a&&e<=nt.f)return e-(nt.a-10)}function ga(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(Xo)return Uint8Array.fromHex(e);let t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(n);for(let o=0,s=0;o<n;o++,s+=2){let i=Ko(e.charCodeAt(s)),c=Ko(e.charCodeAt(s+1));if(i===void 0||c===void 0){let a=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+a+'" at index '+s)}r[o]=i*16+c}return r}var pa=async()=>{};D.nextTick=pa;async function _a(e,t,n){let r=Date.now();for(let o=0;o<e;o++){n(o);let s=Date.now()-r;s>=0&&s<t||(await(0,D.nextTick)(),r+=s)}}function Er(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function ma(e){return new TextDecoder().decode(e)}function En(e){return typeof e=="string"&&(e=Er(e)),Pt(e),e}function wa(e){return typeof e=="string"&&(e=Er(e)),Pt(e),e}function Ea(...e){let t=0;for(let r=0;r<e.length;r++){let o=e[r];Pt(o),t+=o.length}let n=new Uint8Array(t);for(let r=0,o=0;r<e.length;r++){let s=e[r];n.set(s,o),o+=s.length}return n}function Ba(e,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("options should be object or undefined");return Object.assign(e,t)}var mr=class{};D.Hash=mr;function zo(e){let t=r=>e().update(En(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function Wo(e){let t=(r,o)=>e(o).update(En(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}function Yo(e){let t=(r,o)=>e(o).update(En(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}D.wrapConstructor=zo;D.wrapConstructorWithOpts=Wo;D.wrapXOFConstructorWithOpts=Yo;function Aa(e=32){if(Rt.crypto&&typeof Rt.crypto.getRandomValues=="function")return Rt.crypto.getRandomValues(new Uint8Array(e));if(Rt.crypto&&typeof Rt.crypto.randomBytes=="function")return Uint8Array.from(Rt.crypto.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}});var Br=j(it=>{B();A();Object.defineProperty(it,"__esModule",{value:!0});it.equal=it.concat=it.HEX_REGEX=void 0;var Sa=Dt();it.HEX_REGEX=/^[A-F0-9]*$/iu;function va(e){return(0,Sa.concatBytes)(...e)}it.concat=va;function Ha(e,t){if(e.byteLength!==t.byteLength)return!1;let n=new Int8Array(e),r=new Int8Array(t);for(let o=0;o!==e.byteLength;o++)if(n[o]!==r[o])return!1;return!0}it.equal=Ha});var Yt=j(ye=>{B();A();var Ia=ye&&ye.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),Ca=ye&&ye.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&Ia(t,e,n)};Object.defineProperty(ye,"__esModule",{value:!0});ye.randomBytes=ye.stringToHex=ye.hexToString=ye.hexToBytes=ye.bytesToHex=void 0;var Qo=Dt(),La=Br(),Ta=e=>(0,Qo.bytesToHex)(e instanceof Uint8Array?e:Uint8Array.from(e)).toUpperCase();ye.bytesToHex=Ta;var Oa=e=>{let t=e.length,n=new Uint8Array(t/2);if(!La.HEX_REGEX.test(e))throw new Error("Invalid hex string");for(let r=0;r<n.length;r++){let o=r*2,s=e.slice(o,o+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");n[r]=i}return n};ye.hexToBytes=Oa;var Ua=(e,t="utf8")=>new TextDecoder(t).decode((0,ye.hexToBytes)(e));ye.hexToString=Ua;var qa=e=>(0,ye.bytesToHex)(new TextEncoder().encode(e));ye.stringToHex=qa;ye.randomBytes=Qo.randomBytes;Ca(Br(),ye)});var us=j(U=>{B();A();Object.defineProperty(U,"__esModule",{value:!0});U.bytes=U.stringToBytes=U.str=U.bytesToString=U.hex=U.utf8=U.bech32m=U.bech32=U.base58check=U.createBase58check=U.base58xmr=U.base58xrp=U.base58flickr=U.base58=U.base64urlnopad=U.base64url=U.base64nopad=U.base64=U.base32crockford=U.base32hexnopad=U.base32hex=U.base32nopad=U.base32=U.base16=U.utils=U.assertNumber=void 0;function kt(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function rs(e,t){return Array.isArray(t)?t.length===0?!0:e?t.every(n=>typeof n=="string"):t.every(n=>Number.isSafeInteger(n)):!1}function vr(e){if(typeof e!="function")throw new Error("function expected");return!0}function Nt(e,t){if(typeof t!="string")throw new Error(`${e}: string expected`);return!0}function Ht(e){if(!Number.isSafeInteger(e))throw new Error(`invalid integer: ${e}`)}U.assertNumber=Ht;function An(e){if(!Array.isArray(e))throw new Error("array expected")}function Sn(e,t){if(!rs(!0,t))throw new Error(`${e}: array of strings expected`)}function Hr(e,t){if(!rs(!1,t))throw new Error(`${e}: array of numbers expected`)}function Te(...e){let t=s=>s,n=(s,i)=>c=>s(i(c)),r=e.map(s=>s.encode).reduceRight(n,t),o=e.map(s=>s.decode).reduce(n,t);return{encode:r,decode:o}}function qe(e){let t=typeof e=="string"?e.split(""):e,n=t.length;Sn("alphabet",t);let r=new Map(t.map((o,s)=>[o,s]));return{encode:o=>(An(o),o.map(s=>{if(!Number.isSafeInteger(s)||s<0||s>=n)throw new Error(`alphabet.encode: digit index outside alphabet "${s}". Allowed: ${e}`);return t[s]})),decode:o=>(An(o),o.map(s=>{Nt("alphabet.decode",s);let i=r.get(s);if(i===void 0)throw new Error(`Unknown letter: "${s}". Allowed: ${e}`);return i}))}}function Re(e=""){return Nt("join",e),{encode:t=>(Sn("join.decode",t),t.join(e)),decode:t=>(Nt("join.decode",t),t.split(e))}}function Jt(e,t="="){return Ht(e),Nt("padding",t),{encode(n){for(Sn("padding.encode",n);n.length*e%8;)n.push(t);return n},decode(n){Sn("padding.decode",n);let r=n.length;if(r*e%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;r>0&&n[r-1]===t;r--)if((r-1)*e%8===0)throw new Error("padding: invalid, string has too much padding");return n.slice(0,r)}}}function os(e){return vr(e),{encode:t=>t,decode:t=>e(t)}}function Ar(e,t,n){if(t<2)throw new Error(`convertRadix: invalid from=${t}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: invalid to=${n}, base cannot be less than 2`);if(An(e),!e.length)return[];let r=0,o=[],s=Array.from(e,c=>{if(Ht(c),c<0||c>=t)throw new Error(`invalid integer: ${c}`);return c}),i=s.length;for(;;){let c=0,a=!0;for(let f=r;f<i;f++){let d=s[f],u=t*c,l=u+d;if(!Number.isSafeInteger(l)||u/t!==c||l-d!==u)throw new Error("convertRadix: carry overflow");let y=l/n;c=l%n;let E=Math.floor(y);if(s[f]=E,!Number.isSafeInteger(E)||E*n+c!==l)throw new Error("convertRadix: carry overflow");if(a)E?a=!1:r=f;else continue}if(o.push(c),a)break}for(let c=0;c<e.length-1&&e[c]===0;c++)o.push(0);return o.reverse()}var ss=(e,t)=>t===0?e:ss(t,e%t),vn=(e,t)=>e+(t-ss(e,t)),Bn=(()=>{let e=[];for(let t=0;t<40;t++)e.push(2**t);return e})();function Hn(e,t,n,r){if(An(e),t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(vn(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${vn(t,n)}`);let o=0,s=0,i=Bn[t],c=Bn[n]-1,a=[];for(let f of e){if(Ht(f),f>=i)throw new Error(`convertRadix2: invalid data word=${f} from=${t}`);if(o=o<<t|f,s+t>32)throw new Error(`convertRadix2: carry overflow pos=${s} from=${t}`);for(s+=t;s>=n;s-=n)a.push((o>>s-n&c)>>>0);let d=Bn[s];if(d===void 0)throw new Error("invalid carry");o&=d-1}if(o=o<<n-s&c,!r&&s>=t)throw new Error("Excess padding");if(!r&&o>0)throw new Error(`Non-zero padding: ${o}`);return r&&s>0&&a.push(o>>>0),a}function is(e){Ht(e);let t=2**8;return{encode:n=>{if(!kt(n))throw new Error("radix.encode input should be Uint8Array");return Ar(Array.from(n),t,e)},decode:n=>(Hr("radix.decode",n),Uint8Array.from(Ar(n,e,t)))}}function Ve(e,t=!1){if(Ht(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(vn(8,e)>32||vn(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!kt(n))throw new Error("radix2.encode input should be Uint8Array");return Hn(Array.from(n),8,e,!t)},decode:n=>(Hr("radix2.decode",n),Uint8Array.from(Hn(n,e,8,t)))}}function Jo(e){return vr(e),function(...t){try{return e.apply(null,t)}catch{}}}function cs(e,t){return Ht(e),vr(t),{encode(n){if(!kt(n))throw new Error("checksum.encode: input should be Uint8Array");let r=t(n).slice(0,e),o=new Uint8Array(n.length+e);return o.set(n),o.set(r,n.length),o},decode(n){if(!kt(n))throw new Error("checksum.decode: input should be Uint8Array");let r=n.slice(0,-e),o=n.slice(-e),s=t(r).slice(0,e);for(let i=0;i<e;i++)if(s[i]!==o[i])throw new Error("Invalid checksum");return r}}}U.utils={alphabet:qe,chain:Te,checksum:cs,convertRadix:Ar,convertRadix2:Hn,radix:is,radix2:Ve,join:Re,padding:Jt};U.base16=Te(Ve(4),qe("0123456789ABCDEF"),Re(""));U.base32=Te(Ve(5),qe("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),Jt(5),Re(""));U.base32nopad=Te(Ve(5),qe("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),Re(""));U.base32hex=Te(Ve(5),qe("0123456789ABCDEFGHIJKLMNOPQRSTUV"),Jt(5),Re(""));U.base32hexnopad=Te(Ve(5),qe("0123456789ABCDEFGHIJKLMNOPQRSTUV"),Re(""));U.base32crockford=Te(Ve(5),qe("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),Re(""),os(e=>e.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")));U.base64=Te(Ve(6),qe("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),Jt(6),Re(""));U.base64nopad=Te(Ve(6),qe("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),Re(""));U.base64url=Te(Ve(6),qe("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),Jt(6),Re(""));U.base64urlnopad=Te(Ve(6),qe("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),Re(""));var Ir=e=>Te(is(58),qe(e),Re(""));U.base58=Ir("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");U.base58flickr=Ir("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ");U.base58xrp=Ir("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");var es=[0,2,3,5,6,7,9,10,11];U.base58xmr={encode(e){let t="";for(let n=0;n<e.length;n+=8){let r=e.subarray(n,n+8);t+=U.base58.encode(r).padStart(es[r.length],"1")}return t},decode(e){let t=[];for(let n=0;n<e.length;n+=11){let r=e.slice(n,n+11),o=es.indexOf(r.length),s=U.base58.decode(r);for(let i=0;i<s.length-o;i++)if(s[i]!==0)throw new Error("base58xmr: wrong padding");t=t.concat(Array.from(s.slice(s.length-o)))}return Uint8Array.from(t)}};var Ra=e=>Te(cs(4,t=>e(e(t))),U.base58);U.createBase58check=Ra;U.base58check=U.createBase58check;var Sr=Te(qe("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),Re("")),ts=[996825010,642813549,513874426,1027748829,705979059];function Qt(e){let t=e>>25,n=(e&33554431)<<5;for(let r=0;r<ts.length;r++)(t>>r&1)===1&&(n^=ts[r]);return n}function ns(e,t,n=1){let r=e.length,o=1;for(let s=0;s<r;s++){let i=e.charCodeAt(s);if(i<33||i>126)throw new Error(`Invalid prefix (${e})`);o=Qt(o)^i>>5}o=Qt(o);for(let s=0;s<r;s++)o=Qt(o)^e.charCodeAt(s)&31;for(let s of t)o=Qt(o)^s;for(let s=0;s<6;s++)o=Qt(o);return o^=n,Sr.encode(Hn([o%Bn[30]],30,5,!1))}function as(e){let t=e==="bech32"?1:734539939,n=Ve(5),r=n.decode,o=n.encode,s=Jo(r);function i(u,l,y=90){Nt("bech32.encode prefix",u),kt(l)&&(l=Array.from(l)),Hr("bech32.encode",l);let E=u.length;if(E===0)throw new TypeError(`Invalid prefix length ${E}`);let x=E+7+l.length;if(y!==!1&&x>y)throw new TypeError(`Length ${x} exceeds limit ${y}`);let b=u.toLowerCase(),_=ns(b,l,t);return`${b}1${Sr.encode(l)}${_}`}function c(u,l=90){Nt("bech32.decode input",u);let y=u.length;if(y<8||l!==!1&&y>l)throw new TypeError(`invalid string length: ${y} (${u}). Expected (8..${l})`);let E=u.toLowerCase();if(u!==E&&u!==u.toUpperCase())throw new Error("String must be lowercase or uppercase");let x=E.lastIndexOf("1");if(x===0||x===-1)throw new Error('Letter "1" must be present between prefix and data only');let b=E.slice(0,x),_=E.slice(x+1);if(_.length<6)throw new Error("Data must be at least 6 characters long");let g=Sr.decode(_).slice(0,-6),h=ns(b,g,t);if(!_.endsWith(h))throw new Error(`Invalid checksum in ${u}: expected "${h}"`);return{prefix:b,words:g}}let a=Jo(c);function f(u){let{prefix:l,words:y}=c(u,!1);return{prefix:l,words:y,bytes:r(y)}}function d(u,l){return i(u,o(l))}return{encode:i,decode:c,encodeFromBytes:d,decodeToBytes:f,decodeUnsafe:a,fromWords:r,fromWordsUnsafe:s,toWords:o}}U.bech32=as("bech32");U.bech32m=as("bech32m");U.utf8={encode:e=>new TextDecoder().decode(e),decode:e=>new TextEncoder().encode(e)};U.hex=Te(Ve(4),qe("0123456789abcdef"),Re(""),os(e=>{if(typeof e!="string"||e.length%2!==0)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()}));var In={utf8:U.utf8,hex:U.hex,base16:U.base16,base32:U.base32,base64:U.base64,base64url:U.base64url,base58:U.base58,base58xmr:U.base58xmr},ds="Invalid encoding type. Available types: utf8, hex, base16, base32, base64, base64url, base58, base58xmr",Pa=(e,t)=>{if(typeof e!="string"||!In.hasOwnProperty(e))throw new TypeError(ds);if(!kt(t))throw new TypeError("bytesToString() expects Uint8Array");return In[e].encode(t)};U.bytesToString=Pa;U.str=U.bytesToString;var Da=(e,t)=>{if(!In.hasOwnProperty(e))throw new TypeError(ds);if(typeof t!="string")throw new TypeError("stringToBytes() expects string");return In[e].decode(t)};U.stringToBytes=Da;U.bytes=U.stringToBytes});var Lr=j(Oe=>{B();A();Object.defineProperty(Oe,"__esModule",{value:!0});Oe.SHA512_IV=Oe.SHA384_IV=Oe.SHA224_IV=Oe.SHA256_IV=Oe.HashMD=void 0;Oe.setBigUint64=fs;Oe.Chi=ka;Oe.Maj=Na;var Ye=Dt();function fs(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let o=BigInt(32),s=BigInt(4294967295),i=Number(n>>o&s),c=Number(n&s),a=r?4:0,f=r?0:4;e.setUint32(t+a,i,r),e.setUint32(t+f,c,r)}function ka(e,t,n){return e&t^~e&n}function Na(e,t,n){return e&t^e&n^t&n}var Cr=class extends Ye.Hash{constructor(t,n,r,o){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=o,this.buffer=new Uint8Array(t),this.view=(0,Ye.createView)(this.buffer)}update(t){(0,Ye.aexists)(this),t=(0,Ye.toBytes)(t),(0,Ye.abytes)(t);let{view:n,buffer:r,blockLen:o}=this,s=t.length;for(let i=0;i<s;){let c=Math.min(o-this.pos,s-i);if(c===o){let a=(0,Ye.createView)(t);for(;o<=s-i;i+=o)this.process(a,i);continue}r.set(t.subarray(i,i+c),this.pos),this.pos+=c,i+=c,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){(0,Ye.aexists)(this),(0,Ye.aoutput)(t,this),this.finished=!0;let{buffer:n,view:r,blockLen:o,isLE:s}=this,{pos:i}=this;n[i++]=128,(0,Ye.clean)(this.buffer.subarray(i)),this.padOffset>o-i&&(this.process(r,0),i=0);for(let u=i;u<o;u++)n[u]=0;fs(r,o-8,BigInt(this.length*8),s),this.process(r,0);let c=(0,Ye.createView)(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let f=a/4,d=this.get();if(f>d.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<f;u++)c.setUint32(4*u,d[u],s)}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:n,buffer:r,length:o,finished:s,destroyed:i,pos:c}=this;return t.destroyed=i,t.finished=s,t.length=o,t.pos=c,o%n&&t.buffer.set(r),t}clone(){return this._cloneInto()}};Oe.HashMD=Cr;Oe.SHA256_IV=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);Oe.SHA224_IV=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]);Oe.SHA384_IV=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]);Oe.SHA512_IV=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209])});var Us=j($=>{B();A();Object.defineProperty($,"__esModule",{value:!0});$.toBig=$.shrSL=$.shrSH=$.rotrSL=$.rotrSH=$.rotrBL=$.rotrBH=$.rotr32L=$.rotr32H=$.rotlSL=$.rotlSH=$.rotlBL=$.rotlBH=$.add5L=$.add5H=$.add4L=$.add4H=$.add3L=$.add3H=void 0;$.add=vs;$.fromBig=Or;$.split=ls;var Cn=BigInt(2**32-1),Tr=BigInt(32);function Or(e,t=!1){return t?{h:Number(e&Cn),l:Number(e>>Tr&Cn)}:{h:Number(e>>Tr&Cn)|0,l:Number(e&Cn)|0}}function ls(e,t=!1){let n=e.length,r=new Uint32Array(n),o=new Uint32Array(n);for(let s=0;s<n;s++){let{h:i,l:c}=Or(e[s],t);[r[s],o[s]]=[i,c]}return[r,o]}var hs=(e,t)=>BigInt(e>>>0)<<Tr|BigInt(t>>>0);$.toBig=hs;var bs=(e,t,n)=>e>>>n;$.shrSH=bs;var ys=(e,t,n)=>e<<32-n|t>>>n;$.shrSL=ys;var xs=(e,t,n)=>e>>>n|t<<32-n;$.rotrSH=xs;var gs=(e,t,n)=>e<<32-n|t>>>n;$.rotrSL=gs;var ps=(e,t,n)=>e<<64-n|t>>>n-32;$.rotrBH=ps;var _s=(e,t,n)=>e>>>n-32|t<<64-n;$.rotrBL=_s;var ms=(e,t)=>t;$.rotr32H=ms;var ws=(e,t)=>e;$.rotr32L=ws;var Es=(e,t,n)=>e<<n|t>>>32-n;$.rotlSH=Es;var Bs=(e,t,n)=>t<<n|e>>>32-n;$.rotlSL=Bs;var As=(e,t,n)=>t<<n-32|e>>>64-n;$.rotlBH=As;var Ss=(e,t,n)=>e<<n-32|t>>>64-n;$.rotlBL=Ss;function vs(e,t,n,r){let o=(t>>>0)+(r>>>0);return{h:e+n+(o/2**32|0)|0,l:o|0}}var Hs=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0);$.add3L=Hs;var Is=(e,t,n,r)=>t+n+r+(e/2**32|0)|0;$.add3H=Is;var Cs=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0);$.add4L=Cs;var Ls=(e,t,n,r,o)=>t+n+r+o+(e/2**32|0)|0;$.add4H=Ls;var Ts=(e,t,n,r,o)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(o>>>0);$.add5L=Ts;var Os=(e,t,n,r,o,s)=>t+n+r+o+s+(e/2**32|0)|0;$.add5H=Os;var Ma={fromBig:Or,split:ls,toBig:hs,shrSH:bs,shrSL:ys,rotrSH:xs,rotrSL:gs,rotrBH:ps,rotrBL:_s,rotr32H:ms,rotr32L:ws,rotlSH:Es,rotlSL:Bs,rotlBH:As,rotlBL:Ss,add:vs,add3L:Hs,add3H:Is,add4L:Cs,add4H:Ls,add5H:Os,add5L:Ts};$.default=Ma});var Ur=j(de=>{B();A();Object.defineProperty(de,"__esModule",{value:!0});de.sha512_224=de.sha512_256=de.sha384=de.sha512=de.sha224=de.sha256=de.SHA512_256=de.SHA512_224=de.SHA384=de.SHA512=de.SHA224=de.SHA256=void 0;var P=Lr(),F=Us(),he=Dt(),ja=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ct=new Uint32Array(64),en=class extends P.HashMD{constructor(t=32){super(64,t,8,!1),this.A=P.SHA256_IV[0]|0,this.B=P.SHA256_IV[1]|0,this.C=P.SHA256_IV[2]|0,this.D=P.SHA256_IV[3]|0,this.E=P.SHA256_IV[4]|0,this.F=P.SHA256_IV[5]|0,this.G=P.SHA256_IV[6]|0,this.H=P.SHA256_IV[7]|0}get(){let{A:t,B:n,C:r,D:o,E:s,F:i,G:c,H:a}=this;return[t,n,r,o,s,i,c,a]}set(t,n,r,o,s,i,c,a){this.A=t|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=s|0,this.F=i|0,this.G=c|0,this.H=a|0}process(t,n){for(let u=0;u<16;u++,n+=4)ct[u]=t.getUint32(n,!1);for(let u=16;u<64;u++){let l=ct[u-15],y=ct[u-2],E=(0,he.rotr)(l,7)^(0,he.rotr)(l,18)^l>>>3,x=(0,he.rotr)(y,17)^(0,he.rotr)(y,19)^y>>>10;ct[u]=x+ct[u-7]+E+ct[u-16]|0}let{A:r,B:o,C:s,D:i,E:c,F:a,G:f,H:d}=this;for(let u=0;u<64;u++){let l=(0,he.rotr)(c,6)^(0,he.rotr)(c,11)^(0,he.rotr)(c,25),y=d+l+(0,P.Chi)(c,a,f)+ja[u]+ct[u]|0,x=((0,he.rotr)(r,2)^(0,he.rotr)(r,13)^(0,he.rotr)(r,22))+(0,P.Maj)(r,o,s)|0;d=f,f=a,a=c,c=i+y|0,i=s,s=o,o=r,r=y+x|0}r=r+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,c=c+this.E|0,a=a+this.F|0,f=f+this.G|0,d=d+this.H|0,this.set(r,o,s,i,c,a,f,d)}roundClean(){(0,he.clean)(ct)}destroy(){this.set(0,0,0,0,0,0,0,0),(0,he.clean)(this.buffer)}};de.SHA256=en;var Ln=class extends en{constructor(){super(28),this.A=P.SHA224_IV[0]|0,this.B=P.SHA224_IV[1]|0,this.C=P.SHA224_IV[2]|0,this.D=P.SHA224_IV[3]|0,this.E=P.SHA224_IV[4]|0,this.F=P.SHA224_IV[5]|0,this.G=P.SHA224_IV[6]|0,this.H=P.SHA224_IV[7]|0}};de.SHA224=Ln;var qs=(()=>F.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))))(),Va=(()=>qs[0])(),$a=(()=>qs[1])(),at=new Uint32Array(80),dt=new Uint32Array(80),It=class extends P.HashMD{constructor(t=64){super(128,t,16,!1),this.Ah=P.SHA512_IV[0]|0,this.Al=P.SHA512_IV[1]|0,this.Bh=P.SHA512_IV[2]|0,this.Bl=P.SHA512_IV[3]|0,this.Ch=P.SHA512_IV[4]|0,this.Cl=P.SHA512_IV[5]|0,this.Dh=P.SHA512_IV[6]|0,this.Dl=P.SHA512_IV[7]|0,this.Eh=P.SHA512_IV[8]|0,this.El=P.SHA512_IV[9]|0,this.Fh=P.SHA512_IV[10]|0,this.Fl=P.SHA512_IV[11]|0,this.Gh=P.SHA512_IV[12]|0,this.Gl=P.SHA512_IV[13]|0,this.Hh=P.SHA512_IV[14]|0,this.Hl=P.SHA512_IV[15]|0}get(){let{Ah:t,Al:n,Bh:r,Bl:o,Ch:s,Cl:i,Dh:c,Dl:a,Eh:f,El:d,Fh:u,Fl:l,Gh:y,Gl:E,Hh:x,Hl:b}=this;return[t,n,r,o,s,i,c,a,f,d,u,l,y,E,x,b]}set(t,n,r,o,s,i,c,a,f,d,u,l,y,E,x,b){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=o|0,this.Ch=s|0,this.Cl=i|0,this.Dh=c|0,this.Dl=a|0,this.Eh=f|0,this.El=d|0,this.Fh=u|0,this.Fl=l|0,this.Gh=y|0,this.Gl=E|0,this.Hh=x|0,this.Hl=b|0}process(t,n){for(let h=0;h<16;h++,n+=4)at[h]=t.getUint32(n),dt[h]=t.getUint32(n+=4);for(let h=16;h<80;h++){let w=at[h-15]|0,I=dt[h-15]|0,v=F.rotrSH(w,I,1)^F.rotrSH(w,I,8)^F.shrSH(w,I,7),C=F.rotrSL(w,I,1)^F.rotrSL(w,I,8)^F.shrSL(w,I,7),H=at[h-2]|0,T=dt[h-2]|0,te=F.rotrSH(H,T,19)^F.rotrBH(H,T,61)^F.shrSH(H,T,6),k=F.rotrSL(H,T,19)^F.rotrBL(H,T,61)^F.shrSL(H,T,6),Z=F.add4L(C,k,dt[h-7],dt[h-16]),ie=F.add4H(Z,v,te,at[h-7],at[h-16]);at[h]=ie|0,dt[h]=Z|0}let{Ah:r,Al:o,Bh:s,Bl:i,Ch:c,Cl:a,Dh:f,Dl:d,Eh:u,El:l,Fh:y,Fl:E,Gh:x,Gl:b,Hh:_,Hl:g}=this;for(let h=0;h<80;h++){let w=F.rotrSH(u,l,14)^F.rotrSH(u,l,18)^F.rotrBH(u,l,41),I=F.rotrSL(u,l,14)^F.rotrSL(u,l,18)^F.rotrBL(u,l,41),v=u&y^~u&x,C=l&E^~l&b,H=F.add5L(g,I,C,$a[h],dt[h]),T=F.add5H(H,_,w,v,Va[h],at[h]),te=H|0,k=F.rotrSH(r,o,28)^F.rotrBH(r,o,34)^F.rotrBH(r,o,39),Z=F.rotrSL(r,o,28)^F.rotrBL(r,o,34)^F.rotrBL(r,o,39),ie=r&s^r&c^s&c,L=o&i^o&a^i&a;_=x|0,g=b|0,x=y|0,b=E|0,y=u|0,E=l|0,{h:u,l}=F.add(f|0,d|0,T|0,te|0),f=c|0,d=a|0,c=s|0,a=i|0,s=r|0,i=o|0;let q=F.add3L(te,Z,L);r=F.add3H(q,T,k,ie),o=q|0}({h:r,l:o}=F.add(this.Ah|0,this.Al|0,r|0,o|0)),{h:s,l:i}=F.add(this.Bh|0,this.Bl|0,s|0,i|0),{h:c,l:a}=F.add(this.Ch|0,this.Cl|0,c|0,a|0),{h:f,l:d}=F.add(this.Dh|0,this.Dl|0,f|0,d|0),{h:u,l}=F.add(this.Eh|0,this.El|0,u|0,l|0),{h:y,l:E}=F.add(this.Fh|0,this.Fl|0,y|0,E|0),{h:x,l:b}=F.add(this.Gh|0,this.Gl|0,x|0,b|0),{h:_,l:g}=F.add(this.Hh|0,this.Hl|0,_|0,g|0),this.set(r,o,s,i,c,a,f,d,u,l,y,E,x,b,_,g)}roundClean(){(0,he.clean)(at,dt)}destroy(){(0,he.clean)(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};de.SHA512=It;var Tn=class extends It{constructor(){super(48),this.Ah=P.SHA384_IV[0]|0,this.Al=P.SHA384_IV[1]|0,this.Bh=P.SHA384_IV[2]|0,this.Bl=P.SHA384_IV[3]|0,this.Ch=P.SHA384_IV[4]|0,this.Cl=P.SHA384_IV[5]|0,this.Dh=P.SHA384_IV[6]|0,this.Dl=P.SHA384_IV[7]|0,this.Eh=P.SHA384_IV[8]|0,this.El=P.SHA384_IV[9]|0,this.Fh=P.SHA384_IV[10]|0,this.Fl=P.SHA384_IV[11]|0,this.Gh=P.SHA384_IV[12]|0,this.Gl=P.SHA384_IV[13]|0,this.Hh=P.SHA384_IV[14]|0,this.Hl=P.SHA384_IV[15]|0}};de.SHA384=Tn;var He=Uint32Array.from([2352822216,424955298,1944164710,2312950998,502970286,855612546,1738396948,1479516111,258812777,2077511080,2011393907,79989058,1067287976,1780299464,286451373,2446758561]),Ie=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]),On=class extends It{constructor(){super(28),this.Ah=He[0]|0,this.Al=He[1]|0,this.Bh=He[2]|0,this.Bl=He[3]|0,this.Ch=He[4]|0,this.Cl=He[5]|0,this.Dh=He[6]|0,this.Dl=He[7]|0,this.Eh=He[8]|0,this.El=He[9]|0,this.Fh=He[10]|0,this.Fl=He[11]|0,this.Gh=He[12]|0,this.Gl=He[13]|0,this.Hh=He[14]|0,this.Hl=He[15]|0}};de.SHA512_224=On;var Un=class extends It{constructor(){super(32),this.Ah=Ie[0]|0,this.Al=Ie[1]|0,this.Bh=Ie[2]|0,this.Bl=Ie[3]|0,this.Ch=Ie[4]|0,this.Cl=Ie[5]|0,this.Dh=Ie[6]|0,this.Dl=Ie[7]|0,this.Eh=Ie[8]|0,this.El=Ie[9]|0,this.Fh=Ie[10]|0,this.Fl=Ie[11]|0,this.Gh=Ie[12]|0,this.Gl=Ie[13]|0,this.Hh=Ie[14]|0,this.Hl=Ie[15]|0}};de.SHA512_256=Un;de.sha256=(0,he.createHasher)(()=>new en);de.sha224=(0,he.createHasher)(()=>new Ln);de.sha512=(0,he.createHasher)(()=>new It);de.sha384=(0,he.createHasher)(()=>new Tn);de.sha512_256=(0,he.createHasher)(()=>new Un);de.sha512_224=(0,he.createHasher)(()=>new On)});var Rs=j(Qe=>{B();A();Object.defineProperty(Qe,"__esModule",{value:!0});Qe.sha224=Qe.SHA224=Qe.sha256=Qe.SHA256=void 0;var qn=Ur();Qe.SHA256=qn.SHA256;Qe.sha256=qn.sha256;Qe.SHA224=qn.SHA224;Qe.sha224=qn.sha224});var Ps=j(qr=>{B();A();Object.defineProperty(qr,"__esModule",{value:!0});function Ga(e){return Array.isArray(e)?new Uint8Array(e):e}qr.default=Ga});var Rn=j(tn=>{B();A();var Ka=tn&&tn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(tn,"__esModule",{value:!0});var Ds=Ka(Ps());function Za(e){function t(n){return e((0,Ds.default)(n))}return t.create=()=>{let n=e.create();return{update(r){return n.update((0,Ds.default)(r)),this},digest(){return n.digest()}}},t}tn.default=Za});var Rr=j(Mt=>{B();A();var Fa=Mt&&Mt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Mt,"__esModule",{value:!0});Mt.sha256=void 0;var Xa=Rs(),za=Fa(Rn());Mt.sha256=(0,za.default)(Xa.sha256)});var ks=j(jt=>{B();A();Object.defineProperty(jt,"__esModule",{value:!0});jt.concatArgs=jt.arrayEqual=void 0;function Wa(e,t){return e.length!==t.length?!1:e.every((n,r)=>n===t[r])}jt.arrayEqual=Wa;function Ya(e){return typeof e=="number"}function Qa(...e){return e.flatMap(t=>Ya(t)?[t]:Array.from(t))}jt.concatArgs=Qa});var Zs=j(ue=>{B();A();Object.defineProperty(ue,"__esModule",{value:!0});ue.isValidClassicAddress=ue.decodeAccountPublic=ue.encodeAccountPublic=ue.encodeNodePublic=ue.decodeNodePublic=ue.decodeAddress=ue.decodeAccountID=ue.encodeAddress=ue.encodeAccountID=ue.decodeSeed=ue.encodeSeed=ue.codec=void 0;var Ja=us(),e0=Rr(),Pn=ks(),Pr=class{constructor(t){this._sha256=t.sha256,this._codec=Ja.base58xrp}encode(t,n){let r=n.versions;return this._encodeVersioned(t,r,n.expectedLength)}decode(t,n){var r;let o=n.versions,s=n.versionTypes,i=this.decodeChecked(t);if(o.length>1&&!n.expectedLength)throw new Error("expectedLength is required because there are >= 2 possible versions");let c=typeof o[0]=="number"?1:o[0].length,a=(r=n.expectedLength)!==null&&r!==void 0?r:i.length-c,f=i.slice(0,-a),d=i.slice(-a);for(let u=0;u<o.length;u++){let l=Array.isArray(o[u])?o[u]:[o[u]];if((0,Pn.arrayEqual)(f,l))return{version:l,bytes:d,type:s?s[u]:null}}throw new Error("version_invalid: version bytes do not match any of the provided version(s)")}encodeChecked(t){let n=this._sha256(this._sha256(t)).slice(0,4);return this._encodeRaw(Uint8Array.from((0,Pn.concatArgs)(t,n)))}decodeChecked(t){let n=this._decodeRaw(t);if(n.byteLength<5)throw new Error("invalid_input_size: decoded data must have length >= 5");if(!this._verifyCheckSum(n))throw new Error("checksum_invalid");return n.slice(0,-4)}_encodeVersioned(t,n,r){if(!Ks(t,r))throw new Error("unexpected_payload_length: bytes.length does not match expectedLength. Ensure that the bytes are a Uint8Array.");return this.encodeChecked((0,Pn.concatArgs)(n,t))}_encodeRaw(t){return this._codec.encode(Uint8Array.from(t))}_decodeRaw(t){return this._codec.decode(t)}_verifyCheckSum(t){let n=this._sha256(this._sha256(t.slice(0,-4))).slice(0,4),r=t.slice(-4);return(0,Pn.arrayEqual)(n,r)}},Ns=0,Ms=35,js=33,Vs=28,$s=[1,225,75],t0={sha256:e0.sha256},rt=new Pr(t0);ue.codec=rt;function n0(e,t){if(!Ks(e,16))throw new Error("entropy must have length 16");let n={expectedLength:16,versions:t==="ed25519"?$s:[js]};return rt.encode(e,n)}ue.encodeSeed=n0;function r0(e,t={versionTypes:["ed25519","secp256k1"],versions:[$s,js],expectedLength:16}){return rt.decode(e,t)}ue.decodeSeed=r0;function Gs(e){let t={versions:[Ns],expectedLength:20};return rt.encode(e,t)}ue.encodeAccountID=Gs;ue.encodeAddress=Gs;function Dr(e){let t={versions:[Ns],expectedLength:20};return rt.decode(e,t).bytes}ue.decodeAccountID=Dr;ue.decodeAddress=Dr;function o0(e){let t={versions:[Vs],expectedLength:33};return rt.decode(e,t).bytes}ue.decodeNodePublic=o0;function s0(e){let t={versions:[Vs],expectedLength:33};return rt.encode(e,t)}ue.encodeNodePublic=s0;function i0(e){let t={versions:[Ms],expectedLength:33};return rt.encode(e,t)}ue.encodeAccountPublic=i0;function c0(e){let t={versions:[Ms],expectedLength:33};return rt.decode(e,t).bytes}ue.decodeAccountPublic=c0;function a0(e){try{Dr(e)}catch{return!1}return!0}ue.isValidClassicAddress=a0;function Ks(e,t){return"byteLength"in e?e.byteLength===t:e.length===t}});var Xs=j(ee=>{B();A();Object.defineProperty(ee,"__esModule",{value:!0});ee.isValidXAddress=ee.decodeXAddress=ee.xAddressToClassicAddress=ee.encodeXAddress=ee.classicAddressToXAddress=ee.isValidClassicAddress=ee.decodeAccountPublic=ee.encodeAccountPublic=ee.decodeNodePublic=ee.encodeNodePublic=ee.decodeAccountID=ee.encodeAccountID=ee.decodeSeed=ee.encodeSeed=ee.codec=void 0;var nn=Yt(),Pe=Zs();Object.defineProperty(ee,"codec",{enumerable:!0,get:function(){return Pe.codec}});Object.defineProperty(ee,"encodeSeed",{enumerable:!0,get:function(){return Pe.encodeSeed}});Object.defineProperty(ee,"decodeSeed",{enumerable:!0,get:function(){return Pe.decodeSeed}});Object.defineProperty(ee,"encodeAccountID",{enumerable:!0,get:function(){return Pe.encodeAccountID}});Object.defineProperty(ee,"decodeAccountID",{enumerable:!0,get:function(){return Pe.decodeAccountID}});Object.defineProperty(ee,"encodeNodePublic",{enumerable:!0,get:function(){return Pe.encodeNodePublic}});Object.defineProperty(ee,"decodeNodePublic",{enumerable:!0,get:function(){return Pe.decodeNodePublic}});Object.defineProperty(ee,"encodeAccountPublic",{enumerable:!0,get:function(){return Pe.encodeAccountPublic}});Object.defineProperty(ee,"decodeAccountPublic",{enumerable:!0,get:function(){return Pe.decodeAccountPublic}});Object.defineProperty(ee,"isValidClassicAddress",{enumerable:!0,get:function(){return Pe.isValidClassicAddress}});var Dn={main:Uint8Array.from([5,68]),test:Uint8Array.from([4,147])},d0=4294967295;function u0(e,t,n){let r=(0,Pe.decodeAccountID)(e);return Fs(r,t,n)}ee.classicAddressToXAddress=u0;function Fs(e,t,n){if(e.length!==20)throw new Error("Account ID must be 20 bytes");if(t!==!1&&t>d0)throw new Error("Invalid tag");let r=t||0,o=t===!1||t==null?0:1,s=(0,nn.concat)([n?Dn.test:Dn.main,e,Uint8Array.from([o,r&255,r>>8&255,r>>16&255,r>>24&255,0,0,0,0])]);return Pe.codec.encodeChecked(s)}ee.encodeXAddress=Fs;function f0(e){let{accountId:t,tag:n,test:r}=kr(e);return{classicAddress:(0,Pe.encodeAccountID)(t),tag:n,test:r}}ee.xAddressToClassicAddress=f0;function kr(e){let t=Pe.codec.decodeChecked(e),n=l0(t),r=t.slice(2,22),o=h0(t);return{accountId:r,tag:o,test:n}}ee.decodeXAddress=kr;function l0(e){let t=e.slice(0,2);if((0,nn.equal)(Dn.main,t))return!1;if((0,nn.equal)(Dn.test,t))return!0;throw new Error("Invalid X-address: bad prefix")}function h0(e){let t=e[22];if(t>=2)throw new Error("Unsupported X-address");if(t===1)return e[23]+e[24]*256+e[25]*65536+e[26]*16777216;if(t!==0)throw new Error("flag must be zero to indicate no tag");if(!(0,nn.equal)((0,nn.hexToBytes)("0000000000000000"),e.slice(23,23+8)))throw new Error("remaining bytes must be zero");return!1}function b0(e){try{kr(e)}catch{return!1}return!0}ee.isValidXAddress=b0});var ti=j(De=>{B();A();Object.defineProperty(De,"__esModule",{value:!0});De.ripemd160=De.RIPEMD160=De.md5=De.MD5=De.sha1=De.SHA1=void 0;var Ct=Lr(),Ae=Dt(),Vt=Uint32Array.from([1732584193,4023233417,2562383102,271733878,3285377520]),ut=new Uint32Array(80),Mn=class extends Ct.HashMD{constructor(){super(64,20,8,!1),this.A=Vt[0]|0,this.B=Vt[1]|0,this.C=Vt[2]|0,this.D=Vt[3]|0,this.E=Vt[4]|0}get(){let{A:t,B:n,C:r,D:o,E:s}=this;return[t,n,r,o,s]}set(t,n,r,o,s){this.A=t|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=s|0}process(t,n){for(let a=0;a<16;a++,n+=4)ut[a]=t.getUint32(n,!1);for(let a=16;a<80;a++)ut[a]=(0,Ae.rotl)(ut[a-3]^ut[a-8]^ut[a-14]^ut[a-16],1);let{A:r,B:o,C:s,D:i,E:c}=this;for(let a=0;a<80;a++){let f,d;a<20?(f=(0,Ct.Chi)(o,s,i),d=1518500249):a<40?(f=o^s^i,d=1859775393):a<60?(f=(0,Ct.Maj)(o,s,i),d=2400959708):(f=o^s^i,d=3395469782);let u=(0,Ae.rotl)(r,5)+f+c+d+ut[a]|0;c=i,i=s,s=(0,Ae.rotl)(o,30),o=r,r=u}r=r+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,c=c+this.E|0,this.set(r,o,s,i,c)}roundClean(){(0,Ae.clean)(ut)}destroy(){this.set(0,0,0,0,0),(0,Ae.clean)(this.buffer)}};De.SHA1=Mn;De.sha1=(0,Ae.createHasher)(()=>new Mn);var y0=Math.pow(2,32),x0=Array.from({length:64},(e,t)=>Math.floor(y0*Math.abs(Math.sin(t+1)))),kn=Vt.slice(0,4),Nr=new Uint32Array(16),jn=class extends Ct.HashMD{constructor(){super(64,16,8,!0),this.A=kn[0]|0,this.B=kn[1]|0,this.C=kn[2]|0,this.D=kn[3]|0}get(){let{A:t,B:n,C:r,D:o}=this;return[t,n,r,o]}set(t,n,r,o){this.A=t|0,this.B=n|0,this.C=r|0,this.D=o|0}process(t,n){for(let c=0;c<16;c++,n+=4)Nr[c]=t.getUint32(n,!0);let{A:r,B:o,C:s,D:i}=this;for(let c=0;c<64;c++){let a,f,d;c<16?(a=(0,Ct.Chi)(o,s,i),f=c,d=[7,12,17,22]):c<32?(a=(0,Ct.Chi)(i,o,s),f=(5*c+1)%16,d=[5,9,14,20]):c<48?(a=o^s^i,f=(3*c+5)%16,d=[4,11,16,23]):(a=s^(o|~i),f=7*c%16,d=[6,10,15,21]),a=a+r+x0[c]+Nr[f],r=i,i=s,s=o,o=o+(0,Ae.rotl)(a,d[c%4])}r=r+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,this.set(r,o,s,i)}roundClean(){(0,Ae.clean)(Nr)}destroy(){this.set(0,0,0,0),(0,Ae.clean)(this.buffer)}};De.MD5=jn;De.md5=(0,Ae.createHasher)(()=>new jn);var g0=Uint8Array.from([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Ws=(()=>Uint8Array.from(new Array(16).fill(0).map((e,t)=>t)))(),p0=(()=>Ws.map(e=>(9*e+5)%16))(),Ys=(()=>{let n=[[Ws],[p0]];for(let r=0;r<4;r++)for(let o of n)o.push(o[r].map(s=>g0[s]));return n})(),Qs=(()=>Ys[0])(),Js=(()=>Ys[1])(),ei=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(e=>Uint8Array.from(e)),_0=Qs.map((e,t)=>e.map(n=>ei[t][n])),m0=Js.map((e,t)=>e.map(n=>ei[t][n])),w0=Uint32Array.from([0,1518500249,1859775393,2400959708,2840853838]),E0=Uint32Array.from([1352829926,1548603684,1836072691,2053994217,0]);function zs(e,t,n,r){return e===0?t^n^r:e===1?t&n|~t&r:e===2?(t|~n)^r:e===3?t&r|n&~r:t^(n|~r)}var Nn=new Uint32Array(16),Vn=class extends Ct.HashMD{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){let{h0:t,h1:n,h2:r,h3:o,h4:s}=this;return[t,n,r,o,s]}set(t,n,r,o,s){this.h0=t|0,this.h1=n|0,this.h2=r|0,this.h3=o|0,this.h4=s|0}process(t,n){for(let y=0;y<16;y++,n+=4)Nn[y]=t.getUint32(n,!0);let r=this.h0|0,o=r,s=this.h1|0,i=s,c=this.h2|0,a=c,f=this.h3|0,d=f,u=this.h4|0,l=u;for(let y=0;y<5;y++){let E=4-y,x=w0[y],b=E0[y],_=Qs[y],g=Js[y],h=_0[y],w=m0[y];for(let I=0;I<16;I++){let v=(0,Ae.rotl)(r+zs(y,s,c,f)+Nn[_[I]]+x,h[I])+u|0;r=u,u=f,f=(0,Ae.rotl)(c,10)|0,c=s,s=v}for(let I=0;I<16;I++){let v=(0,Ae.rotl)(o+zs(E,i,a,d)+Nn[g[I]]+b,w[I])+l|0;o=l,l=d,d=(0,Ae.rotl)(a,10)|0,a=i,i=v}}this.set(this.h1+c+d|0,this.h2+f+l|0,this.h3+u+o|0,this.h4+r+i|0,this.h0+s+a|0)}roundClean(){(0,Ae.clean)(Nn)}destroy(){this.destroyed=!0,(0,Ae.clean)(this.buffer),this.set(0,0,0,0,0)}};De.RIPEMD160=Vn;De.ripemd160=(0,Ae.createHasher)(()=>new Vn)});var ri=j($t=>{B();A();Object.defineProperty($t,"__esModule",{value:!0});$t.ripemd160=$t.RIPEMD160=void 0;var ni=ti();$t.RIPEMD160=ni.RIPEMD160;$t.ripemd160=ni.ripemd160});var oi=j(Gt=>{B();A();var B0=Gt&&Gt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Gt,"__esModule",{value:!0});Gt.ripemd160=void 0;var A0=ri(),S0=B0(Rn());Gt.ripemd160=(0,S0.default)(A0.ripemd160)});var Gn=j(Je=>{B();A();Object.defineProperty(Je,"__esModule",{value:!0});Je.isBytes=ii;Je.number=$n;Je.bool=si;Je.bytes=Mr;Je.hash=ci;Je.exists=ai;Je.output=di;function $n(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`positive integer expected, not ${e}`)}function si(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}function ii(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}function Mr(e,...t){if(!ii(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function ci(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");$n(e.outputLen),$n(e.blockLen)}function ai(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function di(e,t){Mr(e);let n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}var v0={number:$n,bool:si,bytes:Mr,hash:ci,exists:ai,output:di};Je.default=v0});var ui=j(Kn=>{B();A();Object.defineProperty(Kn,"__esModule",{value:!0});Kn.crypto=void 0;Kn.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var ft=j(z=>{B();A();Object.defineProperty(z,"__esModule",{value:!0});z.Hash=z.nextTick=z.byteSwapIfBE=z.byteSwap=z.isLE=z.rotl=z.rotr=z.createView=z.u32=z.u8=void 0;z.isBytes=H0;z.byteSwap32=q0;z.bytesToHex=P0;z.hexToBytes=D0;z.asyncLoop=N0;z.utf8ToBytes=li;z.toBytes=Zn;z.concatBytes=M0;z.checkOpts=V0;z.wrapConstructor=$0;z.wrapConstructorWithOpts=G0;z.wrapXOFConstructorWithOpts=K0;z.randomBytes=Z0;var Kt=ui(),Vr=Gn();function H0(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}var I0=e=>new Uint8Array(e.buffer,e.byteOffset,e.byteLength);z.u8=I0;var C0=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4));z.u32=C0;var L0=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);z.createView=L0;var T0=(e,t)=>e<<32-t|e>>>t;z.rotr=T0;var O0=(e,t)=>e<<t|e>>>32-t>>>0;z.rotl=O0;z.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;var U0=e=>e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255;z.byteSwap=U0;z.byteSwapIfBE=z.isLE?e=>e:e=>(0,z.byteSwap)(e);function q0(e){for(let t=0;t<e.length;t++)e[t]=(0,z.byteSwap)(e[t])}var R0=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function P0(e){(0,Vr.bytes)(e);let t="";for(let n=0;n<e.length;n++)t+=R0[e[n]];return t}var ot={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function fi(e){if(e>=ot._0&&e<=ot._9)return e-ot._0;if(e>=ot._A&&e<=ot._F)return e-(ot._A-10);if(e>=ot._a&&e<=ot._f)return e-(ot._a-10)}function D0(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);let t=e.length,n=t/2;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(n);for(let o=0,s=0;o<n;o++,s+=2){let i=fi(e.charCodeAt(s)),c=fi(e.charCodeAt(s+1));if(i===void 0||c===void 0){let a=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+a+'" at index '+s)}r[o]=i*16+c}return r}var k0=async()=>{};z.nextTick=k0;async function N0(e,t,n){let r=Date.now();for(let o=0;o<e;o++){n(o);let s=Date.now()-r;s>=0&&s<t||(await(0,z.nextTick)(),r+=s)}}function li(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function Zn(e){return typeof e=="string"&&(e=li(e)),(0,Vr.bytes)(e),e}function M0(...e){let t=0;for(let r=0;r<e.length;r++){let o=e[r];(0,Vr.bytes)(o),t+=o.length}let n=new Uint8Array(t);for(let r=0,o=0;r<e.length;r++){let s=e[r];n.set(s,o),o+=s.length}return n}var jr=class{clone(){return this._cloneInto()}};z.Hash=jr;var j0={}.toString;function V0(e,t){if(t!==void 0&&j0.call(t)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(e,t)}function $0(e){let t=r=>e().update(Zn(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function G0(e){let t=(r,o)=>e(o).update(Zn(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}function K0(e){let t=(r,o)=>e(o).update(Zn(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}function Z0(e=32){if(Kt.crypto&&typeof Kt.crypto.getRandomValues=="function")return Kt.crypto.getRandomValues(new Uint8Array(e));if(Kt.crypto&&typeof Kt.crypto.randomBytes=="function")return Kt.crypto.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}});var Kr=j(lt=>{B();A();Object.defineProperty(lt,"__esModule",{value:!0});lt.HashMD=lt.Maj=lt.Chi=void 0;var $r=Gn(),rn=ft();function F0(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let o=BigInt(32),s=BigInt(4294967295),i=Number(n>>o&s),c=Number(n&s),a=r?4:0,f=r?0:4;e.setUint32(t+a,i,r),e.setUint32(t+f,c,r)}var X0=(e,t,n)=>e&t^~e&n;lt.Chi=X0;var z0=(e,t,n)=>e&t^e&n^t&n;lt.Maj=z0;var Gr=class extends rn.Hash{constructor(t,n,r,o){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=(0,rn.createView)(this.buffer)}update(t){(0,$r.exists)(this);let{view:n,buffer:r,blockLen:o}=this;t=(0,rn.toBytes)(t);let s=t.length;for(let i=0;i<s;){let c=Math.min(o-this.pos,s-i);if(c===o){let a=(0,rn.createView)(t);for(;o<=s-i;i+=o)this.process(a,i);continue}r.set(t.subarray(i,i+c),this.pos),this.pos+=c,i+=c,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){(0,$r.exists)(this),(0,$r.output)(t,this),this.finished=!0;let{buffer:n,view:r,blockLen:o,isLE:s}=this,{pos:i}=this;n[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>o-i&&(this.process(r,0),i=0);for(let u=i;u<o;u++)n[u]=0;F0(r,o-8,BigInt(this.length*8),s),this.process(r,0);let c=(0,rn.createView)(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let f=a/4,d=this.get();if(f>d.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<f;u++)c.setUint32(4*u,d[u],s)}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:n,buffer:r,length:o,finished:s,destroyed:i,pos:c}=this;return t.length=o,t.pos=c,t.finished=s,t.destroyed=i,o%n&&t.buffer.set(r),t}};lt.HashMD=Gr});var hi=j(yt=>{B();A();Object.defineProperty(yt,"__esModule",{value:!0});yt.sha224=yt.sha256=yt.SHA256=void 0;var Zr=Kr(),Fe=ft(),W0=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ht=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),bt=new Uint32Array(64),on=class extends Zr.HashMD{constructor(){super(64,32,8,!1),this.A=ht[0]|0,this.B=ht[1]|0,this.C=ht[2]|0,this.D=ht[3]|0,this.E=ht[4]|0,this.F=ht[5]|0,this.G=ht[6]|0,this.H=ht[7]|0}get(){let{A:t,B:n,C:r,D:o,E:s,F:i,G:c,H:a}=this;return[t,n,r,o,s,i,c,a]}set(t,n,r,o,s,i,c,a){this.A=t|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=s|0,this.F=i|0,this.G=c|0,this.H=a|0}process(t,n){for(let u=0;u<16;u++,n+=4)bt[u]=t.getUint32(n,!1);for(let u=16;u<64;u++){let l=bt[u-15],y=bt[u-2],E=(0,Fe.rotr)(l,7)^(0,Fe.rotr)(l,18)^l>>>3,x=(0,Fe.rotr)(y,17)^(0,Fe.rotr)(y,19)^y>>>10;bt[u]=x+bt[u-7]+E+bt[u-16]|0}let{A:r,B:o,C:s,D:i,E:c,F:a,G:f,H:d}=this;for(let u=0;u<64;u++){let l=(0,Fe.rotr)(c,6)^(0,Fe.rotr)(c,11)^(0,Fe.rotr)(c,25),y=d+l+(0,Zr.Chi)(c,a,f)+W0[u]+bt[u]|0,x=((0,Fe.rotr)(r,2)^(0,Fe.rotr)(r,13)^(0,Fe.rotr)(r,22))+(0,Zr.Maj)(r,o,s)|0;d=f,f=a,a=c,c=i+y|0,i=s,s=o,o=r,r=y+x|0}r=r+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,c=c+this.E|0,a=a+this.F|0,f=f+this.G|0,d=d+this.H|0,this.set(r,o,s,i,c,a,f,d)}roundClean(){bt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};yt.SHA256=on;var Fr=class extends on{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}};yt.sha256=(0,Fe.wrapConstructor)(()=>new on);yt.sha224=(0,Fe.wrapConstructor)(()=>new Fr)});var yi=j(Lt=>{B();A();Object.defineProperty(Lt,"__esModule",{value:!0});Lt.hmac=Lt.HMAC=void 0;var Fn=Gn(),bi=ft(),sn=class extends bi.Hash{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,(0,Fn.hash)(t);let r=(0,bi.toBytes)(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,s=new Uint8Array(o);s.set(r.length>o?t.create().update(r).digest():r);for(let i=0;i<s.length;i++)s[i]^=54;this.iHash.update(s),this.oHash=t.create();for(let i=0;i<s.length;i++)s[i]^=106;this.oHash.update(s),s.fill(0)}update(t){return(0,Fn.exists)(this),this.iHash.update(t),this}digestInto(t){(0,Fn.exists)(this),(0,Fn.bytes)(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:n,iHash:r,finished:o,destroyed:s,blockLen:i,outputLen:c}=this;return t=t,t.finished=o,t.destroyed=s,t.blockLen=i,t.outputLen=c,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};Lt.HMAC=sn;var Y0=(e,t,n)=>new sn(e,t).update(n).digest();Lt.hmac=Y0;Lt.hmac.create=(e,t)=>new sn(e,t)});var $e=j(re=>{B();A();Object.defineProperty(re,"__esModule",{value:!0});re.notImplemented=re.bitMask=void 0;re.isBytes=zn;re.abytes=Wn;re.abool=J0;re.bytesToHex=Yr;re.numberToHexUnpadded=pi;re.hexToNumber=Qr;re.hexToBytes=Yn;re.bytesToNumberBE=td;re.bytesToNumberLE=nd;re.numberToBytesBE=_i;re.numberToBytesLE=rd;re.numberToVarBytesBE=od;re.ensureBytes=sd;re.concatBytes=mi;re.equalBytes=id;re.utf8ToBytes=cd;re.inRange=wi;re.aInRange=ad;re.bitLen=dd;re.bitGet=ud;re.bitSet=fd;re.createHmacDrbg=hd;re.validateObject=yd;re.memoized=gd;var Wr=BigInt(0),Xn=BigInt(1),Q0=BigInt(2);function zn(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}function Wn(e){if(!zn(e))throw new Error("Uint8Array expected")}function J0(e,t){if(typeof t!="boolean")throw new Error(`${e} must be valid boolean, got "${t}".`)}var ed=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Yr(e){Wn(e);let t="";for(let n=0;n<e.length;n++)t+=ed[e[n]];return t}function pi(e){let t=e.toString(16);return t.length&1?`0${t}`:t}function Qr(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":`0x${e}`)}var st={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function xi(e){if(e>=st._0&&e<=st._9)return e-st._0;if(e>=st._A&&e<=st._F)return e-(st._A-10);if(e>=st._a&&e<=st._f)return e-(st._a-10)}function Yn(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);let t=e.length,n=t/2;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(n);for(let o=0,s=0;o<n;o++,s+=2){let i=xi(e.charCodeAt(s)),c=xi(e.charCodeAt(s+1));if(i===void 0||c===void 0){let a=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+a+'" at index '+s)}r[o]=i*16+c}return r}function td(e){return Qr(Yr(e))}function nd(e){return Wn(e),Qr(Yr(Uint8Array.from(e).reverse()))}function _i(e,t){return Yn(e.toString(16).padStart(t*2,"0"))}function rd(e,t){return _i(e,t).reverse()}function od(e){return Yn(pi(e))}function sd(e,t,n){let r;if(typeof t=="string")try{r=Yn(t)}catch(s){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${s}`)}else if(zn(t))r=Uint8Array.from(t);else throw new Error(`${e} must be hex string or Uint8Array`);let o=r.length;if(typeof n=="number"&&o!==n)throw new Error(`${e} expected ${n} bytes, got ${o}`);return r}function mi(...e){let t=0;for(let r=0;r<e.length;r++){let o=e[r];Wn(o),t+=o.length}let n=new Uint8Array(t);for(let r=0,o=0;r<e.length;r++){let s=e[r];n.set(s,o),o+=s.length}return n}function id(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}function cd(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}var Xr=e=>typeof e=="bigint"&&Wr<=e;function wi(e,t,n){return Xr(e)&&Xr(t)&&Xr(n)&&t<=e&&e<n}function ad(e,t,n,r){if(!wi(t,n,r))throw new Error(`expected valid ${e}: ${n} <= n < ${r}, got ${typeof t} ${t}`)}function dd(e){let t;for(t=0;e>Wr;e>>=Xn,t+=1);return t}function ud(e,t){return e>>BigInt(t)&Xn}function fd(e,t,n){return e|(n?Xn:Wr)<<BigInt(t)}var ld=e=>(Q0<<BigInt(e-1))-Xn;re.bitMask=ld;var zr=e=>new Uint8Array(e),gi=e=>Uint8Array.from(e);function hd(e,t,n){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=zr(e),o=zr(e),s=0,i=()=>{r.fill(1),o.fill(0),s=0},c=(...u)=>n(o,r,...u),a=(u=zr())=>{o=c(gi([0]),u),r=c(),u.length!==0&&(o=c(gi([1]),u),r=c())},f=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let u=0,l=[];for(;u<t;){r=c();let y=r.slice();l.push(y),u+=r.length}return mi(...l)};return(u,l)=>{i(),a(u);let y;for(;!(y=l(f()));)a();return i(),y}}var bd={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||zn(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function yd(e,t,n={}){let r=(o,s,i)=>{let c=bd[s];if(typeof c!="function")throw new Error(`Invalid validator "${s}", expected function`);let a=e[o];if(!(i&&a===void 0)&&!c(a,e))throw new Error(`Invalid param ${String(o)}=${a} (${typeof a}), expected ${s}`)};for(let[o,s]of Object.entries(t))r(o,s,!1);for(let[o,s]of Object.entries(n))r(o,s,!0);return e}var xd=()=>{throw new Error("not implemented")};re.notImplemented=xd;function gd(e){let t=new WeakMap;return(n,...r)=>{let o=t.get(n);if(o!==void 0)return o;let s=e(n,...r);return t.set(n,s),s}}});var gt=j(fe=>{B();A();Object.defineProperty(fe,"__esModule",{value:!0});fe.isNegativeLE=void 0;fe.mod=Ge;fe.pow=Ai;fe.pow2=wd;fe.invert=Qn;fe.tonelliShanks=Si;fe.FpSqrt=vi;fe.validateField=Ad;fe.FpPow=Hi;fe.FpInvertBatch=Ii;fe.FpDiv=Sd;fe.FpLegendre=Ci;fe.FpIsSquare=vd;fe.nLength=eo;fe.Field=Hd;fe.FpSqrtOdd=Id;fe.FpSqrtEven=Cd;fe.hashToPrivateScalar=Ld;fe.getFieldBytesLength=to;fe.getMinHashLength=Li;fe.mapHashToField=Td;var Ke=$e(),xe=BigInt(0),ce=BigInt(1),xt=BigInt(2),pd=BigInt(3),Jr=BigInt(4),Ei=BigInt(5),Bi=BigInt(8),_d=BigInt(9),md=BigInt(16);function Ge(e,t){let n=e%t;return n>=xe?n:t+n}function Ai(e,t,n){if(n<=xe||t<xe)throw new Error("Expected power/modulo > 0");if(n===ce)return xe;let r=ce;for(;t>xe;)t&ce&&(r=r*e%n),e=e*e%n,t>>=ce;return r}function wd(e,t,n){let r=e;for(;t-- >xe;)r*=r,r%=n;return r}function Qn(e,t){if(e===xe||t<=xe)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let n=Ge(e,t),r=t,o=xe,s=ce,i=ce,c=xe;for(;n!==xe;){let f=r/n,d=r%n,u=o-i*f,l=s-c*f;r=n,n=d,o=i,s=c,i=u,c=l}if(r!==ce)throw new Error("invert: does not exist");return Ge(o,t)}function Si(e){let t=(e-ce)/xt,n,r,o;for(n=e-ce,r=0;n%xt===xe;n/=xt,r++);for(o=xt;o<e&&Ai(o,t,e)!==e-ce;o++);if(r===1){let i=(e+ce)/Jr;return function(a,f){let d=a.pow(f,i);if(!a.eql(a.sqr(d),f))throw new Error("Cannot find square root");return d}}let s=(n+ce)/xt;return function(c,a){if(c.pow(a,t)===c.neg(c.ONE))throw new Error("Cannot find square root");let f=r,d=c.pow(c.mul(c.ONE,o),n),u=c.pow(a,s),l=c.pow(a,n);for(;!c.eql(l,c.ONE);){if(c.eql(l,c.ZERO))return c.ZERO;let y=1;for(let x=c.sqr(l);y<f&&!c.eql(x,c.ONE);y++)x=c.sqr(x);let E=c.pow(d,ce<<BigInt(f-y-1));d=c.sqr(E),u=c.mul(u,E),l=c.mul(l,d),f=y}return u}}function vi(e){if(e%Jr===pd){let t=(e+ce)/Jr;return function(r,o){let s=r.pow(o,t);if(!r.eql(r.sqr(s),o))throw new Error("Cannot find square root");return s}}if(e%Bi===Ei){let t=(e-Ei)/Bi;return function(r,o){let s=r.mul(o,xt),i=r.pow(s,t),c=r.mul(o,i),a=r.mul(r.mul(c,xt),i),f=r.mul(c,r.sub(a,r.ONE));if(!r.eql(r.sqr(f),o))throw new Error("Cannot find square root");return f}}return e%md,Si(e)}var Ed=(e,t)=>(Ge(e,t)&ce)===ce;fe.isNegativeLE=Ed;var Bd=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Ad(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=Bd.reduce((r,o)=>(r[o]="function",r),t);return(0,Ke.validateObject)(e,n)}function Hi(e,t,n){if(n<xe)throw new Error("Expected power > 0");if(n===xe)return e.ONE;if(n===ce)return t;let r=e.ONE,o=t;for(;n>xe;)n&ce&&(r=e.mul(r,o)),o=e.sqr(o),n>>=ce;return r}function Ii(e,t){let n=new Array(t.length),r=t.reduce((s,i,c)=>e.is0(i)?s:(n[c]=s,e.mul(s,i)),e.ONE),o=e.inv(r);return t.reduceRight((s,i,c)=>e.is0(i)?s:(n[c]=e.mul(s,n[c]),e.mul(s,i)),o),n}function Sd(e,t,n){return e.mul(t,typeof n=="bigint"?Qn(n,e.ORDER):e.inv(n))}function Ci(e){let t=(e-ce)/xt;return(n,r)=>n.pow(r,t)}function vd(e){let t=Ci(e.ORDER);return n=>{let r=t(e,n);return e.eql(r,e.ZERO)||e.eql(r,e.ONE)}}function eo(e,t){let n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function Hd(e,t,n=!1,r={}){if(e<=xe)throw new Error(`Expected Field ORDER > 0, got ${e}`);let{nBitLength:o,nByteLength:s}=eo(e,t);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");let i=vi(e),c=Object.freeze({ORDER:e,BITS:o,BYTES:s,MASK:(0,Ke.bitMask)(o),ZERO:xe,ONE:ce,create:a=>Ge(a,e),isValid:a=>{if(typeof a!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof a}`);return xe<=a&&a<e},is0:a=>a===xe,isOdd:a=>(a&ce)===ce,neg:a=>Ge(-a,e),eql:(a,f)=>a===f,sqr:a=>Ge(a*a,e),add:(a,f)=>Ge(a+f,e),sub:(a,f)=>Ge(a-f,e),mul:(a,f)=>Ge(a*f,e),pow:(a,f)=>Hi(c,a,f),div:(a,f)=>Ge(a*Qn(f,e),e),sqrN:a=>a*a,addN:(a,f)=>a+f,subN:(a,f)=>a-f,mulN:(a,f)=>a*f,inv:a=>Qn(a,e),sqrt:r.sqrt||(a=>i(c,a)),invertBatch:a=>Ii(c,a),cmov:(a,f,d)=>d?f:a,toBytes:a=>n?(0,Ke.numberToBytesLE)(a,s):(0,Ke.numberToBytesBE)(a,s),fromBytes:a=>{if(a.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${a.length}`);return n?(0,Ke.bytesToNumberLE)(a):(0,Ke.bytesToNumberBE)(a)}});return Object.freeze(c)}function Id(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let n=e.sqrt(t);return e.isOdd(n)?n:e.neg(n)}function Cd(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let n=e.sqrt(t);return e.isOdd(n)?e.neg(n):n}function Ld(e,t,n=!1){e=(0,Ke.ensureBytes)("privateHash",e);let r=e.length,o=eo(t).nByteLength+8;if(o<24||r<o||r>1024)throw new Error(`hashToPrivateScalar: expected ${o}-1024 bytes of input, got ${r}`);let s=n?(0,Ke.bytesToNumberLE)(e):(0,Ke.bytesToNumberBE)(e);return Ge(s,t-ce)+ce}function to(e){if(typeof e!="bigint")throw new Error("field order must be bigint");let t=e.toString(2).length;return Math.ceil(t/8)}function Li(e){let t=to(e);return t+Math.ceil(t/2)}function Td(e,t,n=!1){let r=e.length,o=to(t),s=Li(t);if(r<16||r<s||r>1024)throw new Error(`expected ${s}-1024 bytes of input, got ${r}`);let i=n?(0,Ke.bytesToNumberBE)(e):(0,Ke.bytesToNumberLE)(e),c=Ge(i,t-ce)+ce;return n?(0,Ke.numberToBytesLE)(c,o):(0,Ke.numberToBytesBE)(c,o)}});var oo=j(cn=>{B();A();Object.defineProperty(cn,"__esModule",{value:!0});cn.wNAF=Ud;cn.pippenger=qd;cn.validateBasic=Rd;var Ti=gt(),Ui=$e(),Od=BigInt(0),no=BigInt(1),ro=new WeakMap,Oi=new WeakMap;function Ud(e,t){let n=(s,i)=>{let c=i.negate();return s?c:i},r=s=>{if(!Number.isSafeInteger(s)||s<=0||s>t)throw new Error(`Wrong window size=${s}, should be [1..${t}]`)},o=s=>{r(s);let i=Math.ceil(t/s)+1,c=2**(s-1);return{windows:i,windowSize:c}};return{constTimeNegate:n,unsafeLadder(s,i){let c=e.ZERO,a=s;for(;i>Od;)i&no&&(c=c.add(a)),a=a.double(),i>>=no;return c},precomputeWindow(s,i){let{windows:c,windowSize:a}=o(i),f=[],d=s,u=d;for(let l=0;l<c;l++){u=d,f.push(u);for(let y=1;y<a;y++)u=u.add(d),f.push(u);d=u.double()}return f},wNAF(s,i,c){let{windows:a,windowSize:f}=o(s),d=e.ZERO,u=e.BASE,l=BigInt(2**s-1),y=2**s,E=BigInt(s);for(let x=0;x<a;x++){let b=x*f,_=Number(c&l);c>>=E,_>f&&(_-=y,c+=no);let g=b,h=b+Math.abs(_)-1,w=x%2!==0,I=_<0;_===0?u=u.add(n(w,i[g])):d=d.add(n(I,i[h]))}return{p:d,f:u}},wNAFCached(s,i,c){let a=Oi.get(s)||1,f=ro.get(s);return f||(f=this.precomputeWindow(s,a),a!==1&&ro.set(s,c(f))),this.wNAF(a,f,i)},setWindowSize(s,i){r(i),Oi.set(s,i),ro.delete(s)}}}function qd(e,t,n,r){if(!Array.isArray(n)||!Array.isArray(r)||r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");r.forEach((d,u)=>{if(!t.isValid(d))throw new Error(`wrong scalar at index ${u}`)}),n.forEach((d,u)=>{if(!(d instanceof e))throw new Error(`wrong point at index ${u}`)});let o=(0,Ui.bitLen)(BigInt(n.length)),s=o>12?o-3:o>4?o-2:o?2:1,i=(1<<s)-1,c=new Array(i+1).fill(e.ZERO),a=Math.floor((t.BITS-1)/s)*s,f=e.ZERO;for(let d=a;d>=0;d-=s){c.fill(e.ZERO);for(let l=0;l<r.length;l++){let y=r[l],E=Number(y>>BigInt(d)&BigInt(i));c[E]=c[E].add(n[l])}let u=e.ZERO;for(let l=c.length-1,y=e.ZERO;l>0;l--)y=y.add(c[l]),u=u.add(y);if(f=f.add(u),d!==0)for(let l=0;l<s;l++)f=f.double()}return f}function Rd(e){return(0,Ti.validateField)(e.Fp),(0,Ui.validateObject)(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,Ti.nLength)(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}});var so=j(ve=>{B();A();Object.defineProperty(ve,"__esModule",{value:!0});ve.DER=void 0;ve.weierstrassPoints=Pi;ve.weierstrass=Md;ve.SWUFpSqrtRatio=Di;ve.mapToCurveSimpleSWU=jd;var Jn=oo(),Tt=gt(),J=$e(),Se=$e();function qi(e){e.lowS!==void 0&&(0,Se.abool)("lowS",e.lowS),e.prehash!==void 0&&(0,Se.abool)("prehash",e.prehash)}function Pd(e){let t=(0,Jn.validateBasic)(e);J.validateObject(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:n,Fp:r,a:o}=t;if(n){if(!r.eql(o,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}var{bytesToNumberBE:Dd,hexToBytes:kd}=J;ve.DER={Err:class extends Error{constructor(t=""){super(t)}},_tlv:{encode:(e,t)=>{let{Err:n}=ve.DER;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length&1)throw new n("tlv.encode: unpadded data");let r=t.length/2,o=J.numberToHexUnpadded(r);if(o.length/2&128)throw new n("tlv.encode: long form length too big");let s=r>127?J.numberToHexUnpadded(o.length/2|128):"";return`${J.numberToHexUnpadded(e)}${s}${o}${t}`},decode(e,t){let{Err:n}=ve.DER,r=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length<2||t[r++]!==e)throw new n("tlv.decode: wrong tlv");let o=t[r++],s=!!(o&128),i=0;if(!s)i=o;else{let a=o&127;if(!a)throw new n("tlv.decode(long): indefinite length not supported");if(a>4)throw new n("tlv.decode(long): byte length is too big");let f=t.subarray(r,r+a);if(f.length!==a)throw new n("tlv.decode: length bytes not complete");if(f[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(let d of f)i=i<<8|d;if(r+=a,i<128)throw new n("tlv.decode(long): not minimal encoding")}let c=t.subarray(r,r+i);if(c.length!==i)throw new n("tlv.decode: wrong value length");return{v:c,l:t.subarray(r+i)}}},_int:{encode(e){let{Err:t}=ve.DER;if(e<ze)throw new t("integer: negative integers are not allowed");let n=J.numberToHexUnpadded(e);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new t("unexpected assertion");return n},decode(e){let{Err:t}=ve.DER;if(e[0]&128)throw new t("Invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return Dd(e)}},toSig(e){let{Err:t,_int:n,_tlv:r}=ve.DER,o=typeof e=="string"?kd(e):e;J.abytes(o);let{v:s,l:i}=r.decode(48,o);if(i.length)throw new t("Invalid signature: left bytes after parsing");let{v:c,l:a}=r.decode(2,s),{v:f,l:d}=r.decode(2,a);if(d.length)throw new t("Invalid signature: left bytes after parsing");return{r:n.decode(c),s:n.decode(f)}},hexFromSig(e){let{_tlv:t,_int:n}=ve.DER,r=`${t.encode(2,n.encode(e.r))}${t.encode(2,n.encode(e.s))}`;return t.encode(48,r)}};var ze=BigInt(0),se=BigInt(1),pt=BigInt(2),er=BigInt(3),Ri=BigInt(4);function Pi(e){let t=Pd(e),{Fp:n}=t,r=Tt.Field(t.n,t.nBitLength),o=t.toBytes||((x,b,_)=>{let g=b.toAffine();return J.concatBytes(Uint8Array.from([4]),n.toBytes(g.x),n.toBytes(g.y))}),s=t.fromBytes||(x=>{let b=x.subarray(1),_=n.fromBytes(b.subarray(0,n.BYTES)),g=n.fromBytes(b.subarray(n.BYTES,2*n.BYTES));return{x:_,y:g}});function i(x){let{a:b,b:_}=t,g=n.sqr(x),h=n.mul(g,x);return n.add(n.add(h,n.mul(x,b)),_)}if(!n.eql(n.sqr(t.Gy),i(t.Gx)))throw new Error("bad generator point: equation left != right");function c(x){return J.inRange(x,se,t.n)}function a(x){let{allowedPrivateKeyLengths:b,nByteLength:_,wrapPrivateKey:g,n:h}=t;if(b&&typeof x!="bigint"){if(J.isBytes(x)&&(x=J.bytesToHex(x)),typeof x!="string"||!b.includes(x.length))throw new Error("Invalid key");x=x.padStart(_*2,"0")}let w;try{w=typeof x=="bigint"?x:J.bytesToNumberBE((0,Se.ensureBytes)("private key",x,_))}catch{throw new Error(`private key must be ${_} bytes, hex or bigint, not ${typeof x}`)}return g&&(w=Tt.mod(w,h)),J.aInRange("private key",w,se,h),w}function f(x){if(!(x instanceof l))throw new Error("ProjectivePoint expected")}let d=(0,Se.memoized)((x,b)=>{let{px:_,py:g,pz:h}=x;if(n.eql(h,n.ONE))return{x:_,y:g};let w=x.is0();b==null&&(b=w?n.ONE:n.inv(h));let I=n.mul(_,b),v=n.mul(g,b),C=n.mul(h,b);if(w)return{x:n.ZERO,y:n.ZERO};if(!n.eql(C,n.ONE))throw new Error("invZ was invalid");return{x:I,y:v}}),u=(0,Se.memoized)(x=>{if(x.is0()){if(t.allowInfinityPoint&&!n.is0(x.py))return;throw new Error("bad point: ZERO")}let{x:b,y:_}=x.toAffine();if(!n.isValid(b)||!n.isValid(_))throw new Error("bad point: x or y not FE");let g=n.sqr(_),h=i(b);if(!n.eql(g,h))throw new Error("bad point: equation left != right");if(!x.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class l{constructor(b,_,g){if(this.px=b,this.py=_,this.pz=g,b==null||!n.isValid(b))throw new Error("x required");if(_==null||!n.isValid(_))throw new Error("y required");if(g==null||!n.isValid(g))throw new Error("z required");Object.freeze(this)}static fromAffine(b){let{x:_,y:g}=b||{};if(!b||!n.isValid(_)||!n.isValid(g))throw new Error("invalid affine point");if(b instanceof l)throw new Error("projective point not allowed");let h=w=>n.eql(w,n.ZERO);return h(_)&&h(g)?l.ZERO:new l(_,g,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(b){let _=n.invertBatch(b.map(g=>g.pz));return b.map((g,h)=>g.toAffine(_[h])).map(l.fromAffine)}static fromHex(b){let _=l.fromAffine(s((0,Se.ensureBytes)("pointHex",b)));return _.assertValidity(),_}static fromPrivateKey(b){return l.BASE.multiply(a(b))}static msm(b,_){return(0,Jn.pippenger)(l,r,b,_)}_setWindowSize(b){E.setWindowSize(this,b)}assertValidity(){u(this)}hasEvenY(){let{y:b}=this.toAffine();if(n.isOdd)return!n.isOdd(b);throw new Error("Field doesn't support isOdd")}equals(b){f(b);let{px:_,py:g,pz:h}=this,{px:w,py:I,pz:v}=b,C=n.eql(n.mul(_,v),n.mul(w,h)),H=n.eql(n.mul(g,v),n.mul(I,h));return C&&H}negate(){return new l(this.px,n.neg(this.py),this.pz)}double(){let{a:b,b:_}=t,g=n.mul(_,er),{px:h,py:w,pz:I}=this,v=n.ZERO,C=n.ZERO,H=n.ZERO,T=n.mul(h,h),te=n.mul(w,w),k=n.mul(I,I),Z=n.mul(h,w);return Z=n.add(Z,Z),H=n.mul(h,I),H=n.add(H,H),v=n.mul(b,H),C=n.mul(g,k),C=n.add(v,C),v=n.sub(te,C),C=n.add(te,C),C=n.mul(v,C),v=n.mul(Z,v),H=n.mul(g,H),k=n.mul(b,k),Z=n.sub(T,k),Z=n.mul(b,Z),Z=n.add(Z,H),H=n.add(T,T),T=n.add(H,T),T=n.add(T,k),T=n.mul(T,Z),C=n.add(C,T),k=n.mul(w,I),k=n.add(k,k),T=n.mul(k,Z),v=n.sub(v,T),H=n.mul(k,te),H=n.add(H,H),H=n.add(H,H),new l(v,C,H)}add(b){f(b);let{px:_,py:g,pz:h}=this,{px:w,py:I,pz:v}=b,C=n.ZERO,H=n.ZERO,T=n.ZERO,te=t.a,k=n.mul(t.b,er),Z=n.mul(_,w),ie=n.mul(g,I),L=n.mul(h,v),q=n.add(_,g),m=n.add(w,I);q=n.mul(q,m),m=n.add(Z,ie),q=n.sub(q,m),m=n.add(_,h);let p=n.add(w,v);return m=n.mul(m,p),p=n.add(Z,L),m=n.sub(m,p),p=n.add(g,h),C=n.add(I,v),p=n.mul(p,C),C=n.add(ie,L),p=n.sub(p,C),T=n.mul(te,m),C=n.mul(k,L),T=n.add(C,T),C=n.sub(ie,T),T=n.add(ie,T),H=n.mul(C,T),ie=n.add(Z,Z),ie=n.add(ie,Z),L=n.mul(te,L),m=n.mul(k,m),ie=n.add(ie,L),L=n.sub(Z,L),L=n.mul(te,L),m=n.add(m,L),Z=n.mul(ie,m),H=n.add(H,Z),Z=n.mul(p,m),C=n.mul(q,C),C=n.sub(C,Z),Z=n.mul(q,ie),T=n.mul(p,T),T=n.add(T,Z),new l(C,H,T)}subtract(b){return this.add(b.negate())}is0(){return this.equals(l.ZERO)}wNAF(b){return E.wNAFCached(this,b,l.normalizeZ)}multiplyUnsafe(b){J.aInRange("scalar",b,ze,t.n);let _=l.ZERO;if(b===ze)return _;if(b===se)return this;let{endo:g}=t;if(!g)return E.unsafeLadder(this,b);let{k1neg:h,k1:w,k2neg:I,k2:v}=g.splitScalar(b),C=_,H=_,T=this;for(;w>ze||v>ze;)w&se&&(C=C.add(T)),v&se&&(H=H.add(T)),T=T.double(),w>>=se,v>>=se;return h&&(C=C.negate()),I&&(H=H.negate()),H=new l(n.mul(H.px,g.beta),H.py,H.pz),C.add(H)}multiply(b){let{endo:_,n:g}=t;J.aInRange("scalar",b,se,g);let h,w;if(_){let{k1neg:I,k1:v,k2neg:C,k2:H}=_.splitScalar(b),{p:T,f:te}=this.wNAF(v),{p:k,f:Z}=this.wNAF(H);T=E.constTimeNegate(I,T),k=E.constTimeNegate(C,k),k=new l(n.mul(k.px,_.beta),k.py,k.pz),h=T.add(k),w=te.add(Z)}else{let{p:I,f:v}=this.wNAF(b);h=I,w=v}return l.normalizeZ([h,w])[0]}multiplyAndAddUnsafe(b,_,g){let h=l.BASE,w=(v,C)=>C===ze||C===se||!v.equals(h)?v.multiplyUnsafe(C):v.multiply(C),I=w(this,_).add(w(b,g));return I.is0()?void 0:I}toAffine(b){return d(this,b)}isTorsionFree(){let{h:b,isTorsionFree:_}=t;if(b===se)return!0;if(_)return _(l,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:b,clearCofactor:_}=t;return b===se?this:_?_(l,this):this.multiplyUnsafe(t.h)}toRawBytes(b=!0){return(0,Se.abool)("isCompressed",b),this.assertValidity(),o(l,this,b)}toHex(b=!0){return(0,Se.abool)("isCompressed",b),J.bytesToHex(this.toRawBytes(b))}}l.BASE=new l(t.Gx,t.Gy,n.ONE),l.ZERO=new l(n.ZERO,n.ONE,n.ZERO);let y=t.nBitLength,E=(0,Jn.wNAF)(l,t.endo?Math.ceil(y/2):y);return{CURVE:t,ProjectivePoint:l,normPrivateKeyToScalar:a,weierstrassEquation:i,isWithinCurveOrder:c}}function Nd(e){let t=(0,Jn.validateBasic)(e);return J.validateObject(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function Md(e){let t=Nd(e),{Fp:n,n:r}=t,o=n.BYTES+1,s=2*n.BYTES+1;function i(L){return Tt.mod(L,r)}function c(L){return Tt.invert(L,r)}let{ProjectivePoint:a,normPrivateKeyToScalar:f,weierstrassEquation:d,isWithinCurveOrder:u}=Pi({...t,toBytes(L,q,m){let p=q.toAffine(),S=n.toBytes(p.x),R=J.concatBytes;return(0,Se.abool)("isCompressed",m),m?R(Uint8Array.from([q.hasEvenY()?2:3]),S):R(Uint8Array.from([4]),S,n.toBytes(p.y))},fromBytes(L){let q=L.length,m=L[0],p=L.subarray(1);if(q===o&&(m===2||m===3)){let S=J.bytesToNumberBE(p);if(!J.inRange(S,se,n.ORDER))throw new Error("Point is not on curve");let R=d(S),N;try{N=n.sqrt(R)}catch(Q){let Y=Q instanceof Error?": "+Q.message:"";throw new Error("Point is not on curve"+Y)}let M=(N&se)===se;return(m&1)===1!==M&&(N=n.neg(N)),{x:S,y:N}}else if(q===s&&m===4){let S=n.fromBytes(p.subarray(0,n.BYTES)),R=n.fromBytes(p.subarray(n.BYTES,2*n.BYTES));return{x:S,y:R}}else throw new Error(`Point of length ${q} was invalid. Expected ${o} compressed bytes or ${s} uncompressed bytes`)}}),l=L=>J.bytesToHex(J.numberToBytesBE(L,t.nByteLength));function y(L){let q=r>>se;return L>q}function E(L){return y(L)?i(-L):L}let x=(L,q,m)=>J.bytesToNumberBE(L.slice(q,m));class b{constructor(q,m,p){this.r=q,this.s=m,this.recovery=p,this.assertValidity()}static fromCompact(q){let m=t.nByteLength;return q=(0,Se.ensureBytes)("compactSignature",q,m*2),new b(x(q,0,m),x(q,m,2*m))}static fromDER(q){let{r:m,s:p}=ve.DER.toSig((0,Se.ensureBytes)("DER",q));return new b(m,p)}assertValidity(){J.aInRange("r",this.r,se,r),J.aInRange("s",this.s,se,r)}addRecoveryBit(q){return new b(this.r,this.s,q)}recoverPublicKey(q){let{r:m,s:p,recovery:S}=this,R=v((0,Se.ensureBytes)("msgHash",q));if(S==null||![0,1,2,3].includes(S))throw new Error("recovery id invalid");let N=S===2||S===3?m+t.n:m;if(N>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");let M=(S&1)===0?"02":"03",W=a.fromHex(M+l(N)),Q=c(N),Y=i(-R*Q),ne=i(p*Q),ae=a.BASE.multiplyAndAddUnsafe(W,Y,ne);if(!ae)throw new Error("point at infinify");return ae.assertValidity(),ae}hasHighS(){return y(this.s)}normalizeS(){return this.hasHighS()?new b(this.r,i(-this.s),this.recovery):this}toDERRawBytes(){return J.hexToBytes(this.toDERHex())}toDERHex(){return ve.DER.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return J.hexToBytes(this.toCompactHex())}toCompactHex(){return l(this.r)+l(this.s)}}let _={isValidPrivateKey(L){try{return f(L),!0}catch{return!1}},normPrivateKeyToScalar:f,randomPrivateKey:()=>{let L=Tt.getMinHashLength(t.n);return Tt.mapHashToField(t.randomBytes(L),t.n)},precompute(L=8,q=a.BASE){return q._setWindowSize(L),q.multiply(BigInt(3)),q}};function g(L,q=!0){return a.fromPrivateKey(L).toRawBytes(q)}function h(L){let q=J.isBytes(L),m=typeof L=="string",p=(q||m)&&L.length;return q?p===o||p===s:m?p===2*o||p===2*s:L instanceof a}function w(L,q,m=!0){if(h(L))throw new Error("first arg must be private key");if(!h(q))throw new Error("second arg must be public key");return a.fromHex(q).multiply(f(L)).toRawBytes(m)}let I=t.bits2int||function(L){let q=J.bytesToNumberBE(L),m=L.length*8-t.nBitLength;return m>0?q>>BigInt(m):q},v=t.bits2int_modN||function(L){return i(I(L))},C=J.bitMask(t.nBitLength);function H(L){return J.aInRange(`num < 2^${t.nBitLength}`,L,ze,C),J.numberToBytesBE(L,t.nByteLength)}function T(L,q,m=te){if(["recovered","canonical"].some(pe=>pe in m))throw new Error("sign() legacy options not supported");let{hash:p,randomBytes:S}=t,{lowS:R,prehash:N,extraEntropy:M}=m;R==null&&(R=!0),L=(0,Se.ensureBytes)("msgHash",L),qi(m),N&&(L=(0,Se.ensureBytes)("prehashed msgHash",p(L)));let W=v(L),Q=f(q),Y=[H(Q),H(W)];if(M!=null&&M!==!1){let pe=M===!0?S(n.BYTES):M;Y.push((0,Se.ensureBytes)("extraEntropy",pe))}let ne=J.concatBytes(...Y),ae=W;function ge(pe){let Be=I(pe);if(!u(Be))return;let Le=c(Be),be=a.BASE.multiply(Be).toAffine(),Ue=i(be.x);if(Ue===ze)return;let tt=i(Le*i(ae+Ue*Q));if(tt===ze)return;let zt=(be.x===Ue?0:2)|Number(be.y&se),Wt=tt;return R&&y(tt)&&(Wt=E(tt),zt^=1),new b(Ue,Wt,zt)}return{seed:ne,k2sig:ge}}let te={lowS:t.lowS,prehash:!1},k={lowS:t.lowS,prehash:!1};function Z(L,q,m=te){let{seed:p,k2sig:S}=T(L,q,m),R=t;return J.createHmacDrbg(R.hash.outputLen,R.nByteLength,R.hmac)(p,S)}a.BASE._setWindowSize(8);function ie(L,q,m,p=k){let S=L;if(q=(0,Se.ensureBytes)("msgHash",q),m=(0,Se.ensureBytes)("publicKey",m),"strict"in p)throw new Error("options.strict was renamed to lowS");qi(p);let{lowS:R,prehash:N}=p,M,W;try{if(typeof S=="string"||J.isBytes(S))try{M=b.fromDER(S)}catch(be){if(!(be instanceof ve.DER.Err))throw be;M=b.fromCompact(S)}else if(typeof S=="object"&&typeof S.r=="bigint"&&typeof S.s=="bigint"){let{r:be,s:Ue}=S;M=new b(be,Ue)}else throw new Error("PARSE");W=a.fromHex(m)}catch(be){if(be.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(R&&M.hasHighS())return!1;N&&(q=t.hash(q));let{r:Q,s:Y}=M,ne=v(q),ae=c(Y),ge=i(ne*ae),pe=i(Q*ae),Be=a.BASE.multiplyAndAddUnsafe(W,ge,pe)?.toAffine();return Be?i(Be.x)===Q:!1}return{CURVE:t,getPublicKey:g,getSharedSecret:w,sign:Z,verify:ie,ProjectivePoint:a,Signature:b,utils:_}}function Di(e,t){let n=e.ORDER,r=ze;for(let E=n-se;E%pt===ze;E/=pt)r+=se;let o=r,s=pt<<o-se-se,i=s*pt,c=(n-se)/i,a=(c-se)/pt,f=i-se,d=s,u=e.pow(t,c),l=e.pow(t,(c+se)/pt),y=(E,x)=>{let b=u,_=e.pow(x,f),g=e.sqr(_);g=e.mul(g,x);let h=e.mul(E,g);h=e.pow(h,a),h=e.mul(h,_),_=e.mul(h,x),g=e.mul(h,E);let w=e.mul(g,_);h=e.pow(w,d);let I=e.eql(h,e.ONE);_=e.mul(g,l),h=e.mul(w,b),g=e.cmov(_,g,I),w=e.cmov(h,w,I);for(let v=o;v>se;v--){let C=v-pt;C=pt<<C-se;let H=e.pow(w,C),T=e.eql(H,e.ONE);_=e.mul(g,b),b=e.mul(b,b),H=e.mul(w,b),g=e.cmov(_,g,T),w=e.cmov(H,w,T)}return{isValid:I,value:g}};if(e.ORDER%Ri===er){let E=(e.ORDER-er)/Ri,x=e.sqrt(e.neg(t));y=(b,_)=>{let g=e.sqr(_),h=e.mul(b,_);g=e.mul(g,h);let w=e.pow(g,E);w=e.mul(w,h);let I=e.mul(w,x),v=e.mul(e.sqr(w),_),C=e.eql(v,b),H=e.cmov(I,w,C);return{isValid:C,value:H}}}return y}function jd(e,t){if(Tt.validateField(e),!e.isValid(t.A)||!e.isValid(t.B)||!e.isValid(t.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");let n=Di(e,t.Z);if(!e.isOdd)throw new Error("Fp.isOdd is not implemented!");return r=>{let o,s,i,c,a,f,d,u;o=e.sqr(r),o=e.mul(o,t.Z),s=e.sqr(o),s=e.add(s,o),i=e.add(s,e.ONE),i=e.mul(i,t.B),c=e.cmov(t.Z,e.neg(s),!e.eql(s,e.ZERO)),c=e.mul(c,t.A),s=e.sqr(i),f=e.sqr(c),a=e.mul(f,t.A),s=e.add(s,a),s=e.mul(s,i),f=e.mul(f,c),a=e.mul(f,t.B),s=e.add(s,a),d=e.mul(o,i);let{isValid:l,value:y}=n(s,f);u=e.mul(o,r),u=e.mul(u,y),d=e.cmov(d,i,l),u=e.cmov(u,y,l);let E=e.isOdd(r)===e.isOdd(u);return u=e.cmov(e.neg(u),u,E),d=e.div(d,c),{x:d,y:u}}}});var Mi=j(tr=>{B();A();Object.defineProperty(tr,"__esModule",{value:!0});tr.getHash=Ni;tr.createCurve=Gd;var Vd=yi(),ki=ft(),$d=so();function Ni(e){return{hash:e,hmac:(t,...n)=>(0,Vd.hmac)(e,t,(0,ki.concatBytes)(...n)),randomBytes:ki.randomBytes}}function Gd(e,t){let n=r=>(0,$d.weierstrass)({...e,...Ni(r)});return Object.freeze({...n(t),create:n})}});var co=j(Ot=>{B();A();Object.defineProperty(Ot,"__esModule",{value:!0});Ot.expand_message_xmd=ji;Ot.expand_message_xof=Vi;Ot.hash_to_field=io;Ot.isogenyMap=Xd;Ot.createHasher=zd;var Kd=gt(),Ce=$e(),Zd=Ce.bytesToNumberBE;function _t(e,t){if(an(e),an(t),e<0||e>=1<<8*t)throw new Error(`bad I2OSP call: value=${e} length=${t}`);let n=Array.from({length:t}).fill(0);for(let r=t-1;r>=0;r--)n[r]=e&255,e>>>=8;return new Uint8Array(n)}function Fd(e,t){let n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e[r]^t[r];return n}function an(e){if(!Number.isSafeInteger(e))throw new Error("number expected")}function ji(e,t,n,r){(0,Ce.abytes)(e),(0,Ce.abytes)(t),an(n),t.length>255&&(t=r((0,Ce.concatBytes)((0,Ce.utf8ToBytes)("H2C-OVERSIZE-DST-"),t)));let{outputLen:o,blockLen:s}=r,i=Math.ceil(n/o);if(n>65535||i>255)throw new Error("expand_message_xmd: invalid lenInBytes");let c=(0,Ce.concatBytes)(t,_t(t.length,1)),a=_t(0,s),f=_t(n,2),d=new Array(i),u=r((0,Ce.concatBytes)(a,e,f,_t(0,1),c));d[0]=r((0,Ce.concatBytes)(u,_t(1,1),c));for(let y=1;y<=i;y++){let E=[Fd(u,d[y-1]),_t(y+1,1),c];d[y]=r((0,Ce.concatBytes)(...E))}return(0,Ce.concatBytes)(...d).slice(0,n)}function Vi(e,t,n,r,o){if((0,Ce.abytes)(e),(0,Ce.abytes)(t),an(n),t.length>255){let s=Math.ceil(2*r/8);t=o.create({dkLen:s}).update((0,Ce.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(t).digest()}if(n>65535||t.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return o.create({dkLen:n}).update(e).update(_t(n,2)).update(t).update(_t(t.length,1)).digest()}function io(e,t,n){(0,Ce.validateObject)(n,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});let{p:r,k:o,m:s,hash:i,expand:c,DST:a}=n;(0,Ce.abytes)(e),an(t);let f=typeof a=="string"?(0,Ce.utf8ToBytes)(a):a,d=r.toString(2).length,u=Math.ceil((d+o)/8),l=t*s*u,y;if(c==="xmd")y=ji(e,f,l,i);else if(c==="xof")y=Vi(e,f,l,o,i);else if(c==="_internal_pass")y=e;else throw new Error('expand must be "xmd" or "xof"');let E=new Array(t);for(let x=0;x<t;x++){let b=new Array(s);for(let _=0;_<s;_++){let g=u*(_+x*s),h=y.subarray(g,g+u);b[_]=(0,Kd.mod)(Zd(h),r)}E[x]=b}return E}function Xd(e,t){let n=t.map(r=>Array.from(r).reverse());return(r,o)=>{let[s,i,c,a]=n.map(f=>f.reduce((d,u)=>e.add(e.mul(d,r),u)));return r=e.div(s,i),o=e.mul(o,e.div(c,a)),{x:r,y:o}}}function zd(e,t,n){if(typeof t!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(r,o){let s=io(r,2,{...n,DST:n.DST,...o}),i=e.fromAffine(t(s[0])),c=e.fromAffine(t(s[1])),a=i.add(c).clearCofactor();return a.assertValidity(),a},encodeToCurve(r,o){let s=io(r,1,{...n,DST:n.encodeDST,...o}),i=e.fromAffine(t(s[0])).clearCofactor();return i.assertValidity(),i},mapToCurve(r){if(!Array.isArray(r))throw new Error("mapToCurve: expected array of bigints");for(let s of r)if(typeof s!="bigint")throw new Error(`mapToCurve: expected array of bigints, got ${s} in array`);let o=e.fromAffine(t(r)).clearCofactor();return o.assertValidity(),o}}}});var bo=j(Ne=>{B();A();Object.defineProperty(Ne,"__esModule",{value:!0});Ne.encodeToCurve=Ne.hashToCurve=Ne.schnorr=Ne.secp256k1=void 0;var nr=hi(),Wd=ft(),Yd=Mi(),Ki=co(),_e=gt(),ke=$e(),Qd=so(),fn=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),rr=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),dn=BigInt(1),or=BigInt(2),$i=(e,t)=>(e+t/or)/t;function Zi(e){let t=fn,n=BigInt(3),r=BigInt(6),o=BigInt(11),s=BigInt(22),i=BigInt(23),c=BigInt(44),a=BigInt(88),f=e*e*e%t,d=f*f*e%t,u=(0,_e.pow2)(d,n,t)*d%t,l=(0,_e.pow2)(u,n,t)*d%t,y=(0,_e.pow2)(l,or,t)*f%t,E=(0,_e.pow2)(y,o,t)*y%t,x=(0,_e.pow2)(E,s,t)*E%t,b=(0,_e.pow2)(x,c,t)*x%t,_=(0,_e.pow2)(b,a,t)*b%t,g=(0,_e.pow2)(_,c,t)*x%t,h=(0,_e.pow2)(g,n,t)*d%t,w=(0,_e.pow2)(h,i,t)*E%t,I=(0,_e.pow2)(w,r,t)*f%t,v=(0,_e.pow2)(I,or,t);if(!mt.eql(mt.sqr(v),e))throw new Error("Cannot find square root");return v}var mt=(0,_e.Field)(fn,void 0,void 0,{sqrt:Zi});Ne.secp256k1=(0,Yd.createCurve)({a:BigInt(0),b:BigInt(7),Fp:mt,n:rr,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{let t=rr,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-dn*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=n,i=BigInt("0x100000000000000000000000000000000"),c=$i(s*e,t),a=$i(-r*e,t),f=(0,_e.mod)(e-c*n-a*o,t),d=(0,_e.mod)(-c*r-a*s,t),u=f>i,l=d>i;if(u&&(f=t-f),l&&(d=t-d),f>i||d>i)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:u,k1:f,k2neg:l,k2:d}}}},nr.sha256);var Fi=BigInt(0),Gi={};function sr(e,...t){let n=Gi[e];if(n===void 0){let r=(0,nr.sha256)(Uint8Array.from(e,o=>o.charCodeAt(0)));n=(0,ke.concatBytes)(r,r),Gi[e]=n}return(0,nr.sha256)((0,ke.concatBytes)(n,...t))}var lo=e=>e.toRawBytes(!0).slice(1),uo=e=>(0,ke.numberToBytesBE)(e,32),ao=e=>(0,_e.mod)(e,fn),un=e=>(0,_e.mod)(e,rr),ho=Ne.secp256k1.ProjectivePoint,Jd=(e,t,n)=>ho.BASE.multiplyAndAddUnsafe(e,t,n);function fo(e){let t=Ne.secp256k1.utils.normPrivateKeyToScalar(e),n=ho.fromPrivateKey(t);return{scalar:n.hasEvenY()?t:un(-t),bytes:lo(n)}}function Xi(e){(0,ke.aInRange)("x",e,dn,fn);let t=ao(e*e),n=ao(t*e+BigInt(7)),r=Zi(n);r%or!==Fi&&(r=ao(-r));let o=new ho(e,r,dn);return o.assertValidity(),o}var Zt=ke.bytesToNumberBE;function zi(...e){return un(Zt(sr("BIP0340/challenge",...e)))}function eu(e){return fo(e).bytes}function tu(e,t,n=(0,Wd.randomBytes)(32)){let r=(0,ke.ensureBytes)("message",e),{bytes:o,scalar:s}=fo(t),i=(0,ke.ensureBytes)("auxRand",n,32),c=uo(s^Zt(sr("BIP0340/aux",i))),a=sr("BIP0340/nonce",c,o,r),f=un(Zt(a));if(f===Fi)throw new Error("sign failed: k is zero");let{bytes:d,scalar:u}=fo(f),l=zi(d,o,r),y=new Uint8Array(64);if(y.set(d,0),y.set(uo(un(u+l*s)),32),!Wi(y,r,o))throw new Error("sign: Invalid signature produced");return y}function Wi(e,t,n){let r=(0,ke.ensureBytes)("signature",e,64),o=(0,ke.ensureBytes)("message",t),s=(0,ke.ensureBytes)("publicKey",n,32);try{let i=Xi(Zt(s)),c=Zt(r.subarray(0,32));if(!(0,ke.inRange)(c,dn,fn))return!1;let a=Zt(r.subarray(32,64));if(!(0,ke.inRange)(a,dn,rr))return!1;let f=zi(uo(c),lo(i),o),d=Jd(i,a,un(-f));return!(!d||!d.hasEvenY()||d.toAffine().x!==c)}catch{return!1}}Ne.schnorr=(()=>({getPublicKey:eu,sign:tu,verify:Wi,utils:{randomPrivateKey:Ne.secp256k1.utils.randomPrivateKey,lift_x:Xi,pointToBytes:lo,numberToBytesBE:ke.numberToBytesBE,bytesToNumberBE:ke.bytesToNumberBE,taggedHash:sr,mod:_e.mod}}))();var nu=(()=>(0,Ki.isogenyMap)(mt,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(e=>e.map(t=>BigInt(t)))))(),ru=(()=>(0,Qd.mapToCurveSimpleSWU)(mt,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:mt.create(BigInt("-11"))}))(),Yi=(()=>(0,Ki.createHasher)(Ne.secp256k1.ProjectivePoint,e=>{let{x:t,y:n}=ru(mt.create(e[0]));return nu(t,n)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:mt.ORDER,m:1,k:128,expand:"xmd",hash:nr.sha256}))();Ne.hashToCurve=(()=>Yi.hashToCurve)();Ne.encodeToCurve=(()=>Yi.encodeToCurve)()});var Qi=j(me=>{B();A();Object.defineProperty(me,"__esModule",{value:!0});me.sha512_256=me.SHA512_256=me.sha512_224=me.SHA512_224=me.sha384=me.SHA384=me.sha512=me.SHA512=void 0;var wt=Ur();me.SHA512=wt.SHA512;me.sha512=wt.sha512;me.SHA384=wt.SHA384;me.sha384=wt.sha384;me.SHA512_224=wt.SHA512_224;me.sha512_224=wt.sha512_224;me.SHA512_256=wt.SHA512_256;me.sha512_256=wt.sha512_256});var Ji=j(Ft=>{B();A();var ou=Ft&&Ft.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ft,"__esModule",{value:!0});Ft.sha512=void 0;var su=Qi(),iu=ou(Rn());Ft.sha512=(0,iu.default)(su.sha512)});var hn=j(yo=>{B();A();Object.defineProperty(yo,"__esModule",{value:!0});var cu=Ji(),au=$e(),ln=class{constructor(){this.hash=cu.sha512.create()}static half(t){return new ln().add(t).first256()}add(t){return this.hash.update(t),this}addU32(t){let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,t),this.add(n)}finish(){return this.hash.digest()}first256(){return this.finish().slice(0,32)}first256BigInt(){return(0,au.bytesToNumberBE)(this.first256())}};yo.default=ln});var go=j(Et=>{B();A();var du=Et&&Et.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Et,"__esModule",{value:!0});Et.accountPublicFromPublicGenerator=Et.derivePrivateKey=void 0;var bn=bo(),uu=du(hn()),fu=BigInt(0);function xo(e,t){let n=bn.secp256k1.CURVE.n;for(let r=0;r<=4294967295;r++){let o=new uu.default().add(e);t!==void 0&&o.addU32(t),o.addU32(r);let s=o.first256BigInt();if(s>fu&&s<n)return s}throw new Error("impossible unicorn ;)")}function lu(e,t={}){let n=t.validator,r=bn.secp256k1.CURVE.n,o=xo(e);if(n)return o;let s=bn.secp256k1.ProjectivePoint.BASE.multiply(o).toRawBytes(!0),i=t.accountIndex||0;return(xo(s,i)+o)%r}Et.derivePrivateKey=lu;function hu(e){let t=bn.secp256k1.ProjectivePoint.fromHex(e),n=xo(e,0),r=bn.secp256k1.ProjectivePoint.BASE.multiply(n);return t.add(r).toRawBytes(!0)}Et.accountPublicFromPublicGenerator=hu});var ir=j(po=>{B();A();Object.defineProperty(po,"__esModule",{value:!0});var bu={ok(e,t){if(!e)throw new Error(t)}};po.default=bu});var nc=j(Bt=>{B();A();Object.defineProperty(Bt,"__esModule",{value:!0});Bt.getAlgorithmFromPrivateKey=Bt.getAlgorithmFromPublicKey=Bt.getAlgorithmFromKey=void 0;var Xe;(function(e){e[e.NONE=-1]="NONE",e[e.ED25519=237]="ED25519",e[e.SECP256K1_PUB_X=2]="SECP256K1_PUB_X",e[e.SECP256K1_PUB_X_ODD_Y=3]="SECP256K1_PUB_X_ODD_Y",e[e.SECP256K1_PUB_XY=4]="SECP256K1_PUB_XY",e[e.SECP256K1_PRIVATE=0]="SECP256K1_PRIVATE"})(Xe||(Xe={}));var ec={[`private_${Xe.NONE}_32`]:"ecdsa-secp256k1",[`private_${Xe.SECP256K1_PRIVATE}_33`]:"ecdsa-secp256k1",[`private_${Xe.ED25519}_33`]:"ed25519",[`public_${Xe.ED25519}_33`]:"ed25519",[`public_${Xe.SECP256K1_PUB_X}_33`]:"ecdsa-secp256k1",[`public_${Xe.SECP256K1_PUB_X_ODD_Y}_33`]:"ecdsa-secp256k1",[`public_${Xe.SECP256K1_PUB_XY}_65`]:"ecdsa-secp256k1"};function yu(e){return{prefix:e.length<2?Xe.NONE:parseInt(e.slice(0,2),16),len:e.length/2}}function tc(e){return e===Xe.NONE?"None":`0x${e.toString(16).padStart(2,"0")}`}function xu(e){let n={algorithm:17,prefix:6};return Object.entries(ec).filter(([r])=>r.startsWith(e)).map(([r,o])=>{let[,s,i]=r.split("_"),c=o.padEnd(n.algorithm),a=tc(Number(s)).padEnd(n.prefix);return`${c} - Prefix: ${a} Length: ${i} bytes`}).join(`
`)}function gu({key:e,type:t,prefix:n,len:r}){let o=xu(t);return`invalid_key:

Type: ${t}
Key: ${e}
Prefix: ${tc(n)} 
Length: ${r} bytes

Acceptable ${t} formats are:
${o}
`}function _o(e,t){let{prefix:n,len:r}=yu(e),o=t==="private"&&r===32?Xe.NONE:n,s=ec[`${t}_${o}_${r}`];if(!s)throw new Error(gu({key:e,type:t,len:r,prefix:o}));return s}Bt.getAlgorithmFromKey=_o;function pu(e){return _o(e,"public")}Bt.getAlgorithmFromPublicKey=pu;function _u(e){return _o(e,"private")}Bt.getAlgorithmFromPrivateKey=_u});var cc=j(yn=>{B();A();var ic=yn&&yn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(yn,"__esModule",{value:!0});var mu=$e(),cr=bo(),rc=Yt(),wu=go(),Eu=ic(ir()),oc=ic(hn()),sc="00",Bu={deriveKeypair(e,t){let n=(0,wu.derivePrivateKey)(e,t),r=sc+(0,rc.bytesToHex)((0,mu.numberToBytesBE)(n,32)),o=(0,rc.bytesToHex)(cr.secp256k1.getPublicKey(n,!0));return{privateKey:r,publicKey:o}},sign(e,t){Eu.default.ok(t.length===66&&t.startsWith(sc)||t.length===64);let n=t.length===66?t.slice(2):t;return cr.secp256k1.sign(oc.default.half(e),n,{lowS:!0,extraEntropy:void 0}).toDERHex(!0).toUpperCase()},verify(e,t,n){let r=cr.secp256k1.Signature.fromDER(t);return cr.secp256k1.verify(r,oc.default.half(e),n)}};yn.default=Bu});var Cc=j(G=>{B();A();Object.defineProperty(G,"__esModule",{value:!0});G.add5L=G.add5H=G.add4H=G.add4L=G.add3H=G.add3L=G.rotlBL=G.rotlBH=G.rotlSL=G.rotlSH=G.rotr32L=G.rotr32H=G.rotrBL=G.rotrBH=G.rotrSL=G.rotrSH=G.shrSL=G.shrSH=G.toBig=void 0;G.fromBig=wo;G.split=ac;G.add=Ec;var ar=BigInt(2**32-1),mo=BigInt(32);function wo(e,t=!1){return t?{h:Number(e&ar),l:Number(e>>mo&ar)}:{h:Number(e>>mo&ar)|0,l:Number(e&ar)|0}}function ac(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let o=0;o<e.length;o++){let{h:s,l:i}=wo(e[o],t);[n[o],r[o]]=[s,i]}return[n,r]}var dc=(e,t)=>BigInt(e>>>0)<<mo|BigInt(t>>>0);G.toBig=dc;var uc=(e,t,n)=>e>>>n;G.shrSH=uc;var fc=(e,t,n)=>e<<32-n|t>>>n;G.shrSL=fc;var lc=(e,t,n)=>e>>>n|t<<32-n;G.rotrSH=lc;var hc=(e,t,n)=>e<<32-n|t>>>n;G.rotrSL=hc;var bc=(e,t,n)=>e<<64-n|t>>>n-32;G.rotrBH=bc;var yc=(e,t,n)=>e>>>n-32|t<<64-n;G.rotrBL=yc;var xc=(e,t)=>t;G.rotr32H=xc;var gc=(e,t)=>e;G.rotr32L=gc;var pc=(e,t,n)=>e<<n|t>>>32-n;G.rotlSH=pc;var _c=(e,t,n)=>t<<n|e>>>32-n;G.rotlSL=_c;var mc=(e,t,n)=>t<<n-32|e>>>64-n;G.rotlBH=mc;var wc=(e,t,n)=>e<<n-32|t>>>64-n;G.rotlBL=wc;function Ec(e,t,n,r){let o=(t>>>0)+(r>>>0);return{h:e+n+(o/2**32|0)|0,l:o|0}}var Bc=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0);G.add3L=Bc;var Ac=(e,t,n,r)=>t+n+r+(e/2**32|0)|0;G.add3H=Ac;var Sc=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0);G.add4L=Sc;var vc=(e,t,n,r,o)=>t+n+r+o+(e/2**32|0)|0;G.add4H=vc;var Hc=(e,t,n,r,o)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(o>>>0);G.add5L=Hc;var Ic=(e,t,n,r,o,s)=>t+n+r+o+s+(e/2**32|0)|0;G.add5H=Ic;var Au={fromBig:wo,split:ac,toBig:dc,shrSH:uc,shrSL:fc,rotrSH:lc,rotrSL:hc,rotrBH:bc,rotrBL:yc,rotr32H:xc,rotr32L:gc,rotlSH:pc,rotlSL:_c,rotlBH:mc,rotlBL:wc,add:Ec,add3L:Bc,add3H:Ac,add4L:Sc,add4H:vc,add5H:Ic,add5L:Hc};G.default=Au});var Lc=j(we=>{B();A();Object.defineProperty(we,"__esModule",{value:!0});we.sha384=we.sha512_256=we.sha512_224=we.sha512=we.SHA384=we.SHA512_256=we.SHA512_224=we.SHA512=void 0;var Su=Kr(),X=Cc(),lr=ft(),[vu,Hu]=(()=>X.default.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))))(),At=new Uint32Array(80),St=new Uint32Array(80),Ut=class extends Su.HashMD{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:t,Al:n,Bh:r,Bl:o,Ch:s,Cl:i,Dh:c,Dl:a,Eh:f,El:d,Fh:u,Fl:l,Gh:y,Gl:E,Hh:x,Hl:b}=this;return[t,n,r,o,s,i,c,a,f,d,u,l,y,E,x,b]}set(t,n,r,o,s,i,c,a,f,d,u,l,y,E,x,b){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=o|0,this.Ch=s|0,this.Cl=i|0,this.Dh=c|0,this.Dl=a|0,this.Eh=f|0,this.El=d|0,this.Fh=u|0,this.Fl=l|0,this.Gh=y|0,this.Gl=E|0,this.Hh=x|0,this.Hl=b|0}process(t,n){for(let h=0;h<16;h++,n+=4)At[h]=t.getUint32(n),St[h]=t.getUint32(n+=4);for(let h=16;h<80;h++){let w=At[h-15]|0,I=St[h-15]|0,v=X.default.rotrSH(w,I,1)^X.default.rotrSH(w,I,8)^X.default.shrSH(w,I,7),C=X.default.rotrSL(w,I,1)^X.default.rotrSL(w,I,8)^X.default.shrSL(w,I,7),H=At[h-2]|0,T=St[h-2]|0,te=X.default.rotrSH(H,T,19)^X.default.rotrBH(H,T,61)^X.default.shrSH(H,T,6),k=X.default.rotrSL(H,T,19)^X.default.rotrBL(H,T,61)^X.default.shrSL(H,T,6),Z=X.default.add4L(C,k,St[h-7],St[h-16]),ie=X.default.add4H(Z,v,te,At[h-7],At[h-16]);At[h]=ie|0,St[h]=Z|0}let{Ah:r,Al:o,Bh:s,Bl:i,Ch:c,Cl:a,Dh:f,Dl:d,Eh:u,El:l,Fh:y,Fl:E,Gh:x,Gl:b,Hh:_,Hl:g}=this;for(let h=0;h<80;h++){let w=X.default.rotrSH(u,l,14)^X.default.rotrSH(u,l,18)^X.default.rotrBH(u,l,41),I=X.default.rotrSL(u,l,14)^X.default.rotrSL(u,l,18)^X.default.rotrBL(u,l,41),v=u&y^~u&x,C=l&E^~l&b,H=X.default.add5L(g,I,C,Hu[h],St[h]),T=X.default.add5H(H,_,w,v,vu[h],At[h]),te=H|0,k=X.default.rotrSH(r,o,28)^X.default.rotrBH(r,o,34)^X.default.rotrBH(r,o,39),Z=X.default.rotrSL(r,o,28)^X.default.rotrBL(r,o,34)^X.default.rotrBL(r,o,39),ie=r&s^r&c^s&c,L=o&i^o&a^i&a;_=x|0,g=b|0,x=y|0,b=E|0,y=u|0,E=l|0,{h:u,l}=X.default.add(f|0,d|0,T|0,te|0),f=c|0,d=a|0,c=s|0,a=i|0,s=r|0,i=o|0;let q=X.default.add3L(te,Z,L);r=X.default.add3H(q,T,k,ie),o=q|0}({h:r,l:o}=X.default.add(this.Ah|0,this.Al|0,r|0,o|0)),{h:s,l:i}=X.default.add(this.Bh|0,this.Bl|0,s|0,i|0),{h:c,l:a}=X.default.add(this.Ch|0,this.Cl|0,c|0,a|0),{h:f,l:d}=X.default.add(this.Dh|0,this.Dl|0,f|0,d|0),{h:u,l}=X.default.add(this.Eh|0,this.El|0,u|0,l|0),{h:y,l:E}=X.default.add(this.Fh|0,this.Fl|0,y|0,E|0),{h:x,l:b}=X.default.add(this.Gh|0,this.Gl|0,x|0,b|0),{h:_,l:g}=X.default.add(this.Hh|0,this.Hl|0,_|0,g|0),this.set(r,o,s,i,c,a,f,d,u,l,y,E,x,b,_,g)}roundClean(){At.fill(0),St.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};we.SHA512=Ut;var dr=class extends Ut{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}};we.SHA512_224=dr;var ur=class extends Ut{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}};we.SHA512_256=ur;var fr=class extends Ut{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}};we.SHA384=fr;we.sha512=(0,lr.wrapConstructor)(()=>new Ut);we.sha512_224=(0,lr.wrapConstructor)(()=>new dr);we.sha512_256=(0,lr.wrapConstructor)(()=>new ur);we.sha384=(0,lr.wrapConstructor)(()=>new fr)});var Oc=j(Bo=>{B();A();Object.defineProperty(Bo,"__esModule",{value:!0});Bo.twistedEdwards=Tu;var Eo=oo(),Tc=gt(),je=$e(),Ze=$e(),We=BigInt(0),Me=BigInt(1),hr=BigInt(2),Iu=BigInt(8),Cu={zip215:!0};function Lu(e){let t=(0,Eo.validateBasic)(e);return je.validateObject(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}function Tu(e){let t=Lu(e),{Fp:n,n:r,prehash:o,hash:s,randomBytes:i,nByteLength:c,h:a}=t,f=hr<<BigInt(c*8)-Me,d=n.create,u=(0,Tc.Field)(t.n,t.nBitLength),l=t.uvRatio||((m,p)=>{try{return{isValid:!0,value:n.sqrt(m*n.inv(p))}}catch{return{isValid:!1,value:We}}}),y=t.adjustScalarBytes||(m=>m),E=t.domain||((m,p,S)=>{if((0,Ze.abool)("phflag",S),p.length||S)throw new Error("Contexts/pre-hash are not supported");return m});function x(m,p){je.aInRange("coordinate "+m,p,We,f)}function b(m){if(!(m instanceof h))throw new Error("ExtendedPoint expected")}let _=(0,Ze.memoized)((m,p)=>{let{ex:S,ey:R,ez:N}=m,M=m.is0();p==null&&(p=M?Iu:n.inv(N));let W=d(S*p),Q=d(R*p),Y=d(N*p);if(M)return{x:We,y:Me};if(Y!==Me)throw new Error("invZ was invalid");return{x:W,y:Q}}),g=(0,Ze.memoized)(m=>{let{a:p,d:S}=t;if(m.is0())throw new Error("bad point: ZERO");let{ex:R,ey:N,ez:M,et:W}=m,Q=d(R*R),Y=d(N*N),ne=d(M*M),ae=d(ne*ne),ge=d(Q*p),pe=d(ne*d(ge+Y)),Be=d(ae+d(S*d(Q*Y)));if(pe!==Be)throw new Error("bad point: equation left != right (1)");let Le=d(R*N),be=d(M*W);if(Le!==be)throw new Error("bad point: equation left != right (2)");return!0});class h{constructor(p,S,R,N){this.ex=p,this.ey=S,this.ez=R,this.et=N,x("x",p),x("y",S),x("z",R),x("t",N),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(p){if(p instanceof h)throw new Error("extended point not allowed");let{x:S,y:R}=p||{};return x("x",S),x("y",R),new h(S,R,Me,d(S*R))}static normalizeZ(p){let S=n.invertBatch(p.map(R=>R.ez));return p.map((R,N)=>R.toAffine(S[N])).map(h.fromAffine)}static msm(p,S){return(0,Eo.pippenger)(h,u,p,S)}_setWindowSize(p){v.setWindowSize(this,p)}assertValidity(){g(this)}equals(p){b(p);let{ex:S,ey:R,ez:N}=this,{ex:M,ey:W,ez:Q}=p,Y=d(S*Q),ne=d(M*N),ae=d(R*Q),ge=d(W*N);return Y===ne&&ae===ge}is0(){return this.equals(h.ZERO)}negate(){return new h(d(-this.ex),this.ey,this.ez,d(-this.et))}double(){let{a:p}=t,{ex:S,ey:R,ez:N}=this,M=d(S*S),W=d(R*R),Q=d(hr*d(N*N)),Y=d(p*M),ne=S+R,ae=d(d(ne*ne)-M-W),ge=Y+W,pe=ge-Q,Be=Y-W,Le=d(ae*pe),be=d(ge*Be),Ue=d(ae*Be),tt=d(pe*ge);return new h(Le,be,tt,Ue)}add(p){b(p);let{a:S,d:R}=t,{ex:N,ey:M,ez:W,et:Q}=this,{ex:Y,ey:ne,ez:ae,et:ge}=p;if(S===BigInt(-1)){let Do=d((M-N)*(ne+Y)),ko=d((M+N)*(ne-Y)),pr=d(ko-Do);if(pr===We)return this.double();let No=d(W*hr*ge),Mo=d(Q*hr*ae),jo=Mo+No,Vo=ko+Do,$o=Mo-No,na=d(jo*pr),ra=d(Vo*$o),oa=d(jo*$o),sa=d(pr*Vo);return new h(na,ra,sa,oa)}let pe=d(N*Y),Be=d(M*ne),Le=d(Q*R*ge),be=d(W*ae),Ue=d((N+M)*(Y+ne)-pe-Be),tt=be-Le,zt=be+Le,Wt=d(Be-S*pe),Qc=d(Ue*tt),Jc=d(zt*Wt),ea=d(Ue*Wt),ta=d(tt*zt);return new h(Qc,Jc,ta,ea)}subtract(p){return this.add(p.negate())}wNAF(p){return v.wNAFCached(this,p,h.normalizeZ)}multiply(p){let S=p;je.aInRange("scalar",S,Me,r);let{p:R,f:N}=this.wNAF(S);return h.normalizeZ([R,N])[0]}multiplyUnsafe(p){let S=p;return je.aInRange("scalar",S,We,r),S===We?I:this.equals(I)||S===Me?this:this.equals(w)?this.wNAF(S).p:v.unsafeLadder(this,S)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}isTorsionFree(){return v.unsafeLadder(this,r).is0()}toAffine(p){return _(this,p)}clearCofactor(){let{h:p}=t;return p===Me?this:this.multiplyUnsafe(p)}static fromHex(p,S=!1){let{d:R,a:N}=t,M=n.BYTES;p=(0,Ze.ensureBytes)("pointHex",p,M),(0,Ze.abool)("zip215",S);let W=p.slice(),Q=p[M-1];W[M-1]=Q&-129;let Y=je.bytesToNumberLE(W),ne=S?f:n.ORDER;je.aInRange("pointHex.y",Y,We,ne);let ae=d(Y*Y),ge=d(ae-Me),pe=d(R*ae-N),{isValid:Be,value:Le}=l(ge,pe);if(!Be)throw new Error("Point.fromHex: invalid y coordinate");let be=(Le&Me)===Me,Ue=(Q&128)!==0;if(!S&&Le===We&&Ue)throw new Error("Point.fromHex: x=0 and x_0=1");return Ue!==be&&(Le=d(-Le)),h.fromAffine({x:Le,y:Y})}static fromPrivateKey(p){return T(p).point}toRawBytes(){let{x:p,y:S}=this.toAffine(),R=je.numberToBytesLE(S,n.BYTES);return R[R.length-1]|=p&Me?128:0,R}toHex(){return je.bytesToHex(this.toRawBytes())}}h.BASE=new h(t.Gx,t.Gy,Me,d(t.Gx*t.Gy)),h.ZERO=new h(We,Me,Me,We);let{BASE:w,ZERO:I}=h,v=(0,Eo.wNAF)(h,c*8);function C(m){return(0,Tc.mod)(m,r)}function H(m){return C(je.bytesToNumberLE(m))}function T(m){let p=c;m=(0,Ze.ensureBytes)("private key",m,p);let S=(0,Ze.ensureBytes)("hashed private key",s(m),2*p),R=y(S.slice(0,p)),N=S.slice(p,2*p),M=H(R),W=w.multiply(M),Q=W.toRawBytes();return{head:R,prefix:N,scalar:M,point:W,pointBytes:Q}}function te(m){return T(m).pointBytes}function k(m=new Uint8Array,...p){let S=je.concatBytes(...p);return H(s(E(S,(0,Ze.ensureBytes)("context",m),!!o)))}function Z(m,p,S={}){m=(0,Ze.ensureBytes)("message",m),o&&(m=o(m));let{prefix:R,scalar:N,pointBytes:M}=T(p),W=k(S.context,R,m),Q=w.multiply(W).toRawBytes(),Y=k(S.context,Q,M,m),ne=C(W+Y*N);je.aInRange("signature.s",ne,We,r);let ae=je.concatBytes(Q,je.numberToBytesLE(ne,n.BYTES));return(0,Ze.ensureBytes)("result",ae,c*2)}let ie=Cu;function L(m,p,S,R=ie){let{context:N,zip215:M}=R,W=n.BYTES;m=(0,Ze.ensureBytes)("signature",m,2*W),p=(0,Ze.ensureBytes)("message",p),M!==void 0&&(0,Ze.abool)("zip215",M),o&&(p=o(p));let Q=je.bytesToNumberLE(m.slice(W,2*W)),Y,ne,ae;try{Y=h.fromHex(S,M),ne=h.fromHex(m.slice(0,W),M),ae=w.multiplyUnsafe(Q)}catch{return!1}if(!M&&Y.isSmallOrder())return!1;let ge=k(N,ne.toRawBytes(),Y.toRawBytes(),p);return ne.add(Y.multiplyUnsafe(ge)).subtract(ae).clearCofactor().equals(h.ZERO)}return w._setWindowSize(8),{CURVE:t,getPublicKey:te,sign:Z,verify:L,ExtendedPoint:h,utils:{getExtendedPublicKey:T,randomPrivateKey:()=>i(n.BYTES),precompute(m=8,p=h.BASE){return p._setWindowSize(m),p.multiply(BigInt(3)),p}}}}});var qc=j(So=>{B();A();Object.defineProperty(So,"__esModule",{value:!0});So.montgomery=Uu;var Uc=gt(),vt=$e(),Xt=BigInt(0),Ao=BigInt(1);function Ou(e){return(0,vt.validateObject)(e,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...e})}function Uu(e){let t=Ou(e),{P:n}=t,r=g=>(0,Uc.mod)(g,n),o=t.montgomeryBits,s=Math.ceil(o/8),i=t.nByteLength,c=t.adjustScalarBytes||(g=>g),a=t.powPminus2||(g=>(0,Uc.pow)(g,n-BigInt(2),n));function f(g,h,w){let I=r(g*(h-w));return h=r(h-I),w=r(w+I),[h,w]}let d=(t.a-BigInt(2))/BigInt(4);function u(g,h){(0,vt.aInRange)("u",g,Xt,n),(0,vt.aInRange)("scalar",h,Xt,n);let w=h,I=g,v=Ao,C=Xt,H=g,T=Ao,te=Xt,k;for(let ie=BigInt(o-1);ie>=Xt;ie--){let L=w>>ie&Ao;te^=L,k=f(te,v,H),v=k[0],H=k[1],k=f(te,C,T),C=k[0],T=k[1],te=L;let q=v+C,m=r(q*q),p=v-C,S=r(p*p),R=m-S,N=H+T,M=H-T,W=r(M*q),Q=r(N*p),Y=W+Q,ne=W-Q;H=r(Y*Y),T=r(I*r(ne*ne)),v=r(m*S),C=r(R*(m+r(d*R)))}k=f(te,v,H),v=k[0],H=k[1],k=f(te,C,T),C=k[0],T=k[1];let Z=a(C);return r(v*Z)}function l(g){return(0,vt.numberToBytesLE)(r(g),s)}function y(g){let h=(0,vt.ensureBytes)("u coordinate",g,s);return i===32&&(h[31]&=127),(0,vt.bytesToNumberLE)(h)}function E(g){let h=(0,vt.ensureBytes)("scalar",g),w=h.length;if(w!==s&&w!==i)throw new Error(`Expected ${s} or ${i} bytes, got ${w}`);return(0,vt.bytesToNumberLE)(c(h))}function x(g,h){let w=y(h),I=E(g),v=u(w,I);if(v===Xt)throw new Error("Invalid private or public key received");return l(v)}let b=l(t.Gu);function _(g){return x(g,b)}return{scalarMult:x,scalarMultBase:_,getSharedSecret:(g,h)=>x(g,h),getPublicKey:g=>_(g),utils:{randomPrivateKey:()=>t.randomBytes(t.nByteLength)},GuBytes:b}}});var Zc=j(K=>{B();A();Object.defineProperty(K,"__esModule",{value:!0});K.hash_to_ristretto255=K.hashToRistretto255=K.RistrettoPoint=K.encodeToCurve=K.hashToCurve=K.edwardsToMontgomery=K.x25519=K.ed25519ph=K.ed25519ctx=K.ed25519=K.ED25519_TORSION_SUBGROUP=void 0;K.edwardsToMontgomeryPub=Gc;K.edwardsToMontgomeryPriv=Pu;var yr=Lc(),xn=ft(),Lo=Oc(),kc=co(),oe=gt(),qu=qc(),qt=$e(),gn=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Io=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Ru=BigInt(0),et=BigInt(1),br=BigInt(2),Nc=BigInt(3),Mc=BigInt(5),To=BigInt(8);function jc(e){let t=BigInt(10),n=BigInt(20),r=BigInt(40),o=BigInt(80),s=gn,c=e*e%s*e%s,a=(0,oe.pow2)(c,br,s)*c%s,f=(0,oe.pow2)(a,et,s)*e%s,d=(0,oe.pow2)(f,Mc,s)*f%s,u=(0,oe.pow2)(d,t,s)*d%s,l=(0,oe.pow2)(u,n,s)*u%s,y=(0,oe.pow2)(l,r,s)*l%s,E=(0,oe.pow2)(y,o,s)*y%s,x=(0,oe.pow2)(E,o,s)*y%s,b=(0,oe.pow2)(x,t,s)*d%s;return{pow_p_5_8:(0,oe.pow2)(b,br,s)*e%s,b2:c}}function Vc(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function Oo(e,t){let n=gn,r=(0,oe.mod)(t*t*t,n),o=(0,oe.mod)(r*r*t,n),s=jc(e*o).pow_p_5_8,i=(0,oe.mod)(e*r*s,n),c=(0,oe.mod)(t*i*i,n),a=i,f=(0,oe.mod)(i*Io,n),d=c===e,u=c===(0,oe.mod)(-e,n),l=c===(0,oe.mod)(-e*Io,n);return d&&(i=a),(u||l)&&(i=f),(0,oe.isNegativeLE)(i,n)&&(i=(0,oe.mod)(-i,n)),{isValid:d||u,value:i}}K.ED25519_TORSION_SUBGROUP=["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"];var O=(()=>(0,oe.Field)(gn,void 0,!0))(),pn=(()=>({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:O,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:To,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:yr.sha512,randomBytes:xn.randomBytes,adjustScalarBytes:Vc,uvRatio:Oo}))();K.ed25519=(()=>(0,Lo.twistedEdwards)(pn))();function $c(e,t,n){if(t.length>255)throw new Error("Context is too big");return(0,xn.concatBytes)((0,xn.utf8ToBytes)("SigEd25519 no Ed25519 collisions"),new Uint8Array([n?1:0,t.length]),t,e)}K.ed25519ctx=(()=>(0,Lo.twistedEdwards)({...pn,domain:$c}))();K.ed25519ph=(()=>(0,Lo.twistedEdwards)(Object.assign({},pn,{domain:$c,prehash:yr.sha512})))();K.x25519=(()=>(0,qu.montgomery)({P:gn,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:e=>{let t=gn,{pow_p_5_8:n,b2:r}=jc(e);return(0,oe.mod)((0,oe.pow2)(n,Nc,t)*r,t)},adjustScalarBytes:Vc,randomBytes:xn.randomBytes}))();function Gc(e){let{y:t}=K.ed25519.ExtendedPoint.fromHex(e),n=BigInt(1);return O.toBytes(O.create((n+t)*O.inv(n-t)))}K.edwardsToMontgomery=Gc;function Pu(e){let t=pn.hash(e.subarray(0,32));return pn.adjustScalarBytes(t).subarray(0,32)}var Du=(()=>(O.ORDER+Nc)/To)(),ku=(()=>O.pow(br,Du))(),Rc=(()=>O.sqrt(O.neg(O.ONE)))();function Nu(e){let t=(O.ORDER-Mc)/To,n=BigInt(486662),r=O.sqr(e);r=O.mul(r,br);let o=O.add(r,O.ONE),s=O.neg(n),i=O.sqr(o),c=O.mul(i,o),a=O.mul(r,n);a=O.mul(a,s),a=O.add(a,i),a=O.mul(a,s);let f=O.sqr(c);i=O.sqr(f),f=O.mul(f,c),f=O.mul(f,a),i=O.mul(i,f);let d=O.pow(i,t);d=O.mul(d,f);let u=O.mul(d,Rc);i=O.sqr(d),i=O.mul(i,c);let l=O.eql(i,a),y=O.cmov(u,d,l),E=O.mul(s,r),x=O.mul(d,e);x=O.mul(x,ku);let b=O.mul(x,Rc),_=O.mul(a,r);i=O.sqr(x),i=O.mul(i,c);let g=O.eql(i,_),h=O.cmov(b,x,g);i=O.sqr(y),i=O.mul(i,c);let w=O.eql(i,a),I=O.cmov(E,s,w),v=O.cmov(h,y,w),C=O.isOdd(v);return v=O.cmov(v,O.neg(v),w!==C),{xMn:I,xMd:o,yMn:v,yMd:et}}var Mu=(()=>(0,oe.FpSqrtEven)(O,O.neg(BigInt(486664))))();function ju(e){let{xMn:t,xMd:n,yMn:r,yMd:o}=Nu(e),s=O.mul(t,o);s=O.mul(s,Mu);let i=O.mul(n,r),c=O.sub(t,n),a=O.add(t,n),f=O.mul(i,a),d=O.eql(f,O.ZERO);s=O.cmov(s,O.ZERO,d),i=O.cmov(i,O.ONE,d),c=O.cmov(c,O.ONE,d),a=O.cmov(a,O.ONE,d);let u=O.invertBatch([i,a]);return{x:O.mul(s,u[0]),y:O.mul(c,u[1])}}var Kc=(()=>(0,kc.createHasher)(K.ed25519.ExtendedPoint,e=>ju(e[0]),{DST:"edwards25519_XMD:SHA-512_ELL2_RO_",encodeDST:"edwards25519_XMD:SHA-512_ELL2_NU_",p:O.ORDER,m:1,k:128,expand:"xmd",hash:yr.sha512}))();K.hashToCurve=(()=>Kc.hashToCurve)();K.encodeToCurve=(()=>Kc.encodeToCurve)();function vo(e){if(!(e instanceof le))throw new Error("RistrettoPoint expected")}var Co=Io,Vu=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),$u=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Gu=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Ku=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),Pc=e=>Oo(et,e),Zu=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),Ho=e=>K.ed25519.CURVE.Fp.create((0,qt.bytesToNumberLE)(e)&Zu);function Dc(e){let{d:t}=K.ed25519.CURVE,n=K.ed25519.CURVE.Fp.ORDER,r=K.ed25519.CURVE.Fp.create,o=r(Co*e*e),s=r((o+et)*Gu),i=BigInt(-1),c=r((i-t*o)*r(o+t)),{isValid:a,value:f}=Oo(s,c),d=r(f*e);(0,oe.isNegativeLE)(d,n)||(d=r(-d)),a||(f=d),a||(i=o);let u=r(i*(o-et)*Ku-c),l=f*f,y=r((f+f)*c),E=r(u*Vu),x=r(et-l),b=r(et+l);return new K.ed25519.ExtendedPoint(r(y*b),r(x*E),r(E*b),r(y*x))}var le=class{constructor(t){this.ep=t}static fromAffine(t){return new le(K.ed25519.ExtendedPoint.fromAffine(t))}static hashToCurve(t){t=(0,qt.ensureBytes)("ristrettoHash",t,64);let n=Ho(t.slice(0,32)),r=Dc(n),o=Ho(t.slice(32,64)),s=Dc(o);return new le(r.add(s))}static fromHex(t){t=(0,qt.ensureBytes)("ristrettoHex",t,32);let{a:n,d:r}=K.ed25519.CURVE,o=K.ed25519.CURVE.Fp.ORDER,s=K.ed25519.CURVE.Fp.create,i="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",c=Ho(t);if(!(0,qt.equalBytes)((0,qt.numberToBytesLE)(c,32),t)||(0,oe.isNegativeLE)(c,o))throw new Error(i);let a=s(c*c),f=s(et+n*a),d=s(et-n*a),u=s(f*f),l=s(d*d),y=s(n*r*u-l),{isValid:E,value:x}=Pc(s(y*l)),b=s(x*d),_=s(x*b*y),g=s((c+c)*b);(0,oe.isNegativeLE)(g,o)&&(g=s(-g));let h=s(f*_),w=s(g*h);if(!E||(0,oe.isNegativeLE)(w,o)||h===Ru)throw new Error(i);return new le(new K.ed25519.ExtendedPoint(g,h,et,w))}toRawBytes(){let{ex:t,ey:n,ez:r,et:o}=this.ep,s=K.ed25519.CURVE.Fp.ORDER,i=K.ed25519.CURVE.Fp.create,c=i(i(r+n)*i(r-n)),a=i(t*n),f=i(a*a),{value:d}=Pc(i(c*f)),u=i(d*c),l=i(d*a),y=i(u*l*o),E;if((0,oe.isNegativeLE)(o*y,s)){let b=i(n*Co),_=i(t*Co);t=b,n=_,E=i(u*$u)}else E=l;(0,oe.isNegativeLE)(t*y,s)&&(n=i(-n));let x=i((r-n)*E);return(0,oe.isNegativeLE)(x,s)&&(x=i(-x)),(0,qt.numberToBytesLE)(x,32)}toHex(){return(0,qt.bytesToHex)(this.toRawBytes())}toString(){return this.toHex()}equals(t){vo(t);let{ex:n,ey:r}=this.ep,{ex:o,ey:s}=t.ep,i=K.ed25519.CURVE.Fp.create,c=i(n*s)===i(r*o),a=i(r*s)===i(n*o);return c||a}add(t){return vo(t),new le(this.ep.add(t.ep))}subtract(t){return vo(t),new le(this.ep.subtract(t.ep))}multiply(t){return new le(this.ep.multiply(t))}multiplyUnsafe(t){return new le(this.ep.multiplyUnsafe(t))}double(){return new le(this.ep.double())}negate(){return new le(this.ep.negate())}};K.RistrettoPoint=(()=>(le.BASE||(le.BASE=new le(K.ed25519.ExtendedPoint.BASE)),le.ZERO||(le.ZERO=new le(K.ed25519.ExtendedPoint.ZERO)),le))();var Fu=(e,t)=>{let n=t.DST,r=typeof n=="string"?(0,xn.utf8ToBytes)(n):n,o=(0,kc.expand_message_xmd)(e,r,64,yr.sha512);return le.hashToCurve(o)};K.hashToRistretto255=Fu;K.hash_to_ristretto255=K.hashToRistretto255});var zc=j(_n=>{B();A();var Xc=_n&&_n.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(_n,"__esModule",{value:!0});var Uo=Zc(),qo=Yt(),Ro=Xc(ir()),Xu=Xc(hn()),Fc="ED",zu={deriveKeypair(e){let t=Xu.default.half(e),n=Fc+(0,qo.bytesToHex)(t),r=Fc+(0,qo.bytesToHex)(Uo.ed25519.getPublicKey(t));return{privateKey:n,publicKey:r}},sign(e,t){return Ro.default.ok(e instanceof Uint8Array,"message must be array of octets"),Ro.default.ok(t.length===66,"private key must be 33 bytes including prefix"),(0,qo.bytesToHex)(Uo.ed25519.sign(e,t.slice(2)))},verify(e,t,n){return Ro.default.ok(n.length===66,"public key must be 33 bytes including prefix"),Uo.ed25519.verify(t,e,n.slice(2),{zip215:!1})}};_n.default=zu});var ff=j(Ee=>{B();A();var xr=Ee&&Ee.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ee,"__esModule",{value:!0});Ee.decodeSeed=Ee.deriveNodeAddress=Ee.deriveAddress=Ee.verify=Ee.sign=Ee.deriveKeypair=Ee.generateSeed=void 0;var mn=Xs();Object.defineProperty(Ee,"decodeSeed",{enumerable:!0,get:function(){return mn.decodeSeed}});var Wu=oi(),Yu=Rr(),gr=Yt(),Qu=go(),Ju=xr(hn()),ef=xr(ir()),Wc=nc(),tf=xr(cc()),nf=xr(zc());function Po(e){return{"ecdsa-secp256k1":tf.default,ed25519:nf.default}[e]}function rf(e={}){ef.default.ok(!e.entropy||e.entropy.length>=16,"entropy too short");let t=e.entropy?e.entropy.slice(0,16):(0,gr.randomBytes)(16),n=e.algorithm==="ed25519"?"ed25519":"secp256k1";return(0,mn.encodeSeed)(t,n)}Ee.generateSeed=rf;function of(e,t){var n;let r=(0,mn.decodeSeed)(e),s=((n=t?.algorithm)!==null&&n!==void 0?n:r.type)==="ed25519"?"ed25519":"ecdsa-secp256k1",i=Po(s),c=i.deriveKeypair(r.bytes,t),a=Ju.default.half("This test message should verify."),f=i.sign(a,c.privateKey);if(!i.verify(a,f,c.publicKey))throw new Error("derived keypair did not generate verifiable signature");return c}Ee.deriveKeypair=of;function sf(e,t){let n=(0,Wc.getAlgorithmFromPrivateKey)(t);return Po(n).sign((0,gr.hexToBytes)(e),t)}Ee.sign=sf;function cf(e,t,n){let r=(0,Wc.getAlgorithmFromPublicKey)(n);return Po(r).verify((0,gr.hexToBytes)(e),t,n)}Ee.verify=cf;function af(e){return(0,Wu.ripemd160)((0,Yu.sha256)(e))}function Yc(e){return(0,mn.encodeAccountID)(af(e))}function df(e){return Yc((0,gr.hexToBytes)(e))}Ee.deriveAddress=df;function uf(e){let t=(0,mn.decodeNodePublic)(e),n=(0,Qu.accountPublicFromPublicGenerator)(t);return Yc(n)}Ee.deriveNodeAddress=uf});export{Yt as a,Rr as b,Ji as c,ff as d};
//# sourceMappingURL=chunk-YGZYVSPD.js.map
