import{A as Y,B as $,u as W}from"./chunk-HI3LE734.js";import{e as x}from"./chunk-RX4V72AK.js";import{c as v,n as process,o as f,q as i}from"./chunk-Y5OH3DDZ.js";var g=v((lr,I)=>{f();i();var j=Math.pow(2,30)-1;I.exports=function(r,e){if(typeof r!="number")throw new TypeError("Iterations not a number");if(r<0)throw new TypeError("Bad iterations");if(typeof e!="number")throw new TypeError("Key length not a number");if(e<0||e>j||e!==e)throw new TypeError("Bad key length")}});var C=v((mr,F)=>{f();i();var d;globalThis.process&&globalThis.process.browser?d="utf-8":globalThis.process&&globalThis.process.version?(K=parseInt(process.version.split(".")[0].slice(1),10),d=K>=6?"utf-8":"binary"):d="utf-8";var K;F.exports=d});var E=v((_r,U)=>{f();i();var y=x().Buffer;U.exports=function(r,e,t){if(y.isBuffer(r))return r;if(typeof r=="string")return y.from(r,e);if(ArrayBuffer.isView(r))return y.from(r.buffer);throw new TypeError(t+" must be a string, a Buffer, a typed array or a DataView")}});var P=v((Sr,N)=>{f();i();var rr=$(),er=W(),or=Y(),h=x().Buffer,tr=g(),k=C(),L=E(),nr=h.alloc(128),b={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function M(r,e,t){var a=ar(r),o=r==="sha512"||r==="sha384"?128:64;e.length>o?e=a(e):e.length<o&&(e=h.concat([e,nr],o));for(var n=h.allocUnsafe(o+b[r]),s=h.allocUnsafe(o+b[r]),u=0;u<o;u++)n[u]=e[u]^54,s[u]=e[u]^92;var c=h.allocUnsafe(o+t+4);n.copy(c,0,0,o),this.ipad1=c,this.ipad2=n,this.opad=s,this.alg=r,this.blocksize=o,this.hash=a,this.size=b[r]}M.prototype.run=function(r,e){r.copy(e,this.blocksize);var t=this.hash(e);return t.copy(this.opad,this.blocksize),this.hash(this.opad)};function ar(r){function e(a){return or(r).update(a).digest()}function t(a){return new er().update(a).digest()}return r==="rmd160"||r==="ripemd160"?t:r==="md5"?rr:e}function ur(r,e,t,a,o){tr(t,a),r=L(r,k,"Password"),e=L(e,k,"Salt"),o=o||"sha1";var n=new M(o,r,e.length),s=h.allocUnsafe(a),u=h.allocUnsafe(e.length+4);e.copy(u,0,0,e.length);for(var c=0,B=b[o],V=Math.ceil(a/B),w=1;w<=V;w++){u.writeUInt32BE(w,e.length);for(var S=n.run(u,n.ipad1),q=S,z=1;z<t;z++){q=n.run(q,n.ipad2);for(var m=0;m<B;m++)S[m]^=q[m]}S.copy(s,c),c+=B}return s}N.exports=ur});var Q=v((gr,J)=>{f();i();var X=x().Buffer,fr=g(),O=C(),R=P(),Z=E(),_,p=globalThis.crypto&&globalThis.crypto.subtle,ir={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},A=[];function sr(r){if(globalThis.process&&!globalThis.process.browser||!p||!p.importKey||!p.deriveBits)return Promise.resolve(!1);if(A[r]!==void 0)return A[r];_=_||X.alloc(8);var e=G(_,_,10,128,r).then(function(){return!0}).catch(function(){return!1});return A[r]=e,e}var l;function H(){return l||(globalThis.process&&globalThis.process.nextTick?l=globalThis.process.nextTick:globalThis.queueMicrotask?l=globalThis.queueMicrotask:globalThis.setImmediate?l=globalThis.setImmediate:l=globalThis.setTimeout,l)}function G(r,e,t,a,o){return p.importKey("raw",r,{name:"PBKDF2"},!1,["deriveBits"]).then(function(n){return p.deriveBits({name:"PBKDF2",salt:e,iterations:t,hash:{name:o}},n,a<<3)}).then(function(n){return X.from(n)})}function cr(r,e){r.then(function(t){H()(function(){e(null,t)})},function(t){H()(function(){e(t)})})}J.exports=function(r,e,t,a,o,n){typeof o=="function"&&(n=o,o=void 0),o=o||"sha1";var s=ir[o.toLowerCase()];if(!s||typeof globalThis.Promise!="function"){H()(function(){var u;try{u=R(r,e,t,a,o)}catch(c){return n(c)}n(null,u)});return}if(fr(t,a),r=Z(r,O,"Password"),e=Z(e,O,"Salt"),typeof n!="function")throw new Error("No callback provided to pbkdf2");cr(sr(s).then(function(u){return u?G(r,e,t,a,s):R(r,e,t,a,o)}),n)}});var hr=v(T=>{f();i();T.pbkdf2=Q();T.pbkdf2Sync=P()});export{hr as a};
//# sourceMappingURL=chunk-MOPSJFRZ.js.map
