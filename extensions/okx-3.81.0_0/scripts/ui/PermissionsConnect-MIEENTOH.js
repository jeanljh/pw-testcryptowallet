import{a as Bt}from"./chunk-23JC5SDF.js";import{a as Wt}from"./chunk-RNB6EWQY.js";import{a as $e}from"./chunk-FBYUYQL4.js";import{b as Ot}from"./chunk-LRK7A6MC.js";import{a as vt,b as Nt}from"./chunk-APWPXM2W.js";import{a as Ae}from"./chunk-4R74WMY3.js";import{a as At}from"./chunk-T4CFY3IH.js";import{a as Rt}from"./chunk-7OWNMKUE.js";import"./chunk-EDJJACNG.js";import{a as ue}from"./chunk-V7XA3BQU.js";import{a as Et}from"./chunk-PONOZOFT.js";import{a as B,d as A}from"./chunk-KQ6OPOXD.js";import"./chunk-X7ACMHNF.js";import{a as ce}from"./chunk-XDEC3ZLT.js";import{a as It,b as Fe}from"./chunk-RGPNT5G7.js";import{l as I}from"./chunk-Q7DF5H6O.js";import{e as bt}from"./chunk-G23O242T.js";import"./chunk-2VUOGSTW.js";import{a as Mt}from"./chunk-P4PGYDTS.js";import"./chunk-S7VT2TWF.js";import"./chunk-HBNZZZEG.js";import"./chunk-3W4MTHFJ.js";import"./chunk-L2MGED7F.js";import"./chunk-BNS5ABAB.js";import"./chunk-UFGJXE4D.js";import"./chunk-7QX2TXNH.js";import{d as xt}from"./chunk-ZDHJHPQ5.js";import{a as qt,b as Dt}from"./chunk-UKZ3XNLC.js";import"./chunk-DFPRATON.js";import"./chunk-WY5R5HAR.js";import"./chunk-TE6AOABI.js";import"./chunk-63UDTGAT.js";import"./chunk-AZ2KZKVQ.js";import"./chunk-VCDDTW7H.js";import"./chunk-UULU72LG.js";import"./chunk-3MTWCI34.js";import"./chunk-E6XUX33V.js";import"./chunk-VTMJYROY.js";import"./chunk-ARK47WR5.js";import"./chunk-BEIWULHW.js";import"./chunk-DOCYQV54.js";import"./chunk-6T3CLU73.js";import"./chunk-STXPU7A6.js";import"./chunk-PFSPFZNW.js";import"./chunk-2JC6L37N.js";import"./chunk-BF6TFHGA.js";import"./chunk-57F7LIJM.js";import"./chunk-7OXXN2FT.js";import"./chunk-RK7WST36.js";import"./chunk-7Q4IDC7V.js";import"./chunk-F57QKCZQ.js";import"./chunk-HIVYZXF3.js";import"./chunk-JALTSNOZ.js";import"./chunk-4Y52FA3V.js";import"./chunk-B6WLGAPL.js";import"./chunk-ZYYACLV7.js";import"./chunk-TQMC5UQS.js";import"./chunk-ANWN6BF6.js";import"./chunk-XNP3OGQC.js";import"./chunk-A2QIZMPL.js";import"./chunk-HKU7TMFJ.js";import"./chunk-YTR7GLCK.js";import"./chunk-7I4OPLNV.js";import"./chunk-J3UBL564.js";import"./chunk-YMYQJ726.js";import"./chunk-FGRS6VIX.js";import"./chunk-INIQCRIO.js";import"./chunk-2P6PTKAN.js";import"./chunk-ZFBXO46L.js";import"./chunk-6Z5HVUBK.js";import"./chunk-ZBDGRK4Q.js";import"./chunk-XIYYKWE3.js";import"./chunk-GN2NRAOV.js";import"./chunk-SFFRTMXL.js";import"./chunk-RLY3NWVP.js";import"./chunk-U3KULTRT.js";import"./chunk-55T2IW2N.js";import"./chunk-WVUOJIBP.js";import"./chunk-JBROAQ6E.js";import"./chunk-LBCITKCK.js";import"./chunk-O4O5AL3V.js";import{b as Ie}from"./chunk-TF4QEXO7.js";import{a as yt,b as Tt}from"./chunk-CHMHYYPI.js";import{e as lt}from"./chunk-JBNHZ7EW.js";import{c as wt}from"./chunk-GDQAWT2G.js";import{k as T,m as xe}from"./chunk-7HYQ2DGP.js";import"./chunk-G7XOYBNH.js";import"./chunk-JHO7RU36.js";import{c as dt}from"./chunk-UOWKDFTX.js";import"./chunk-5A7EFNRM.js";import"./chunk-NA6P5YCH.js";import"./chunk-F2SPBGOT.js";import"./chunk-SYOIP55B.js";import"./chunk-V7ZNWTMX.js";import"./chunk-MSP5TDR3.js";import"./chunk-VWGNVM37.js";import"./chunk-QKBWJPY2.js";import"./chunk-XFPD3Q2E.js";import"./chunk-AFJBSSNA.js";import"./chunk-3ZKJXYZ4.js";import"./chunk-EBRJSEEJ.js";import"./chunk-PA7QUJH7.js";import"./chunk-MC7IOE6A.js";import"./chunk-N4IVZOUG.js";import"./chunk-JWVIZID6.js";import{W as ut,b as ct}from"./chunk-MSFAPAHB.js";import"./chunk-33XRMYWN.js";import"./chunk-ZOKF3EKQ.js";import"./chunk-MDBKHBHQ.js";import"./chunk-WRVJM3F3.js";import"./chunk-NYBKFEEM.js";import"./chunk-XVSXMJ3S.js";import"./chunk-KQ66JTF7.js";import"./chunk-OOYDFTEF.js";import"./chunk-JNIP4OYT.js";import"./chunk-XRCQOGA2.js";import"./chunk-SWUBCABA.js";import"./chunk-EEIYH3NC.js";import"./chunk-ITDLKQAF.js";import"./chunk-4W7LQOP5.js";import"./chunk-CIVR4FUI.js";import"./chunk-H7WHTGUY.js";import{i as ht,k as Pt}from"./chunk-44SDMU5C.js";import"./chunk-U7IWD6UB.js";import"./chunk-CZBL7QEK.js";import"./chunk-PAJAZXOA.js";import{b as St}from"./chunk-7MCLPJAH.js";import"./chunk-WAIJPY5X.js";import{e as Ct,h as be,k as kt}from"./chunk-YGMRSF47.js";import"./chunk-6XGS36TZ.js";import"./chunk-M2YY6A5T.js";import"./chunk-XLG73W5Q.js";import{a as Ge,b as ft,i as R,jb as gt,k as W}from"./chunk-GCS2RK7E.js";import"./chunk-OIPQWTNV.js";import"./chunk-VJI6MZK4.js";import"./chunk-5PRURJ2O.js";import"./chunk-FGAB46RQ.js";import"./chunk-47ZMUKCZ.js";import{o as Se}from"./chunk-Z62JX42S.js";import{Na as M,aa as H,ca as rt,ta as st}from"./chunk-2QHGKEME.js";import"./chunk-HAHRUU64.js";import"./chunk-B624VS3G.js";import"./chunk-W4SQ6335.js";import"./chunk-YDSDBRIT.js";import{a as Me}from"./chunk-6PA65BO3.js";import"./chunk-OIXGC4LI.js";import"./chunk-MAAUVUWY.js";import"./chunk-4X64L7DZ.js";import{B as it}from"./chunk-WU2LB6XB.js";import"./chunk-GLL4BXR6.js";import"./chunk-4L5HWMAA.js";import{d as pt}from"./chunk-EZS2GR7E.js";import{j as O,o as mt,q as Pe}from"./chunk-NUN72MDU.js";import"./chunk-BFWVIVOY.js";import"./chunk-S3FOFXM7.js";import{q as he,s as Wo}from"./chunk-YIFLUVTR.js";import{c as ie,e as at}from"./chunk-EN2WHAVL.js";import{h as _t}from"./chunk-CP2RIMI2.js";import"./chunk-3QLLFUC4.js";import{C as we,j as ke}from"./chunk-EFOY37CC.js";import{c as ae}from"./chunk-HMTT52FG.js";import"./chunk-45NMMWRA.js";import"./chunk-E4OV5WXB.js";import"./chunk-GR7YC6C3.js";import{B as Je,J as Oo}from"./chunk-O33H5V3V.js";import"./chunk-DJN2J7J5.js";import"./chunk-35ANKHOJ.js";import"./chunk-BI4OEIFC.js";import{$b as tt,J as vo,Ja as N,Q as ye,V as Ze,ac as ot,fb as Te,ha as Qe,ja as et,ka as Le,nc as nt,q as Ce,tb as se}from"./chunk-COF7YKSN.js";import{A as g,K as v}from"./chunk-VZKEX7KP.js";import"./chunk-QCEQQDCM.js";import{I as Xe,d as Ke}from"./chunk-BJKBO23H.js";import"./chunk-IO3ALUOJ.js";import"./chunk-AHVVUOFF.js";import"./chunk-JLNZTUPO.js";import"./chunk-MSZOM4GC.js";import"./chunk-BYVN72KS.js";import"./chunk-ZUJLXC72.js";import"./chunk-DJSNVDZI.js";import"./chunk-K336SGW3.js";import{I as He,M as ge,f as fe,va as _e}from"./chunk-XFTQD4B2.js";import"./chunk-DIZF7D6Q.js";import"./chunk-JHCCLVAB.js";import"./chunk-W7AONC6R.js";import"./chunk-FOOC6LB7.js";import"./chunk-SEAUBLKM.js";import"./chunk-UP4BZFYG.js";import"./chunk-DHKS44RQ.js";import"./chunk-4DBVFCYR.js";import{a as ze}from"./chunk-2IGQWLAB.js";import"./chunk-GVV6OTQP.js";import{u as Ue}from"./chunk-ZFVABNQN.js";import"./chunk-VYWNZTTM.js";import"./chunk-LBWWOQL4.js";import{a as No}from"./chunk-4QGZDIBD.js";import{b as y}from"./chunk-73B6GL3S.js";import"./chunk-LVJGLJNA.js";import"./chunk-FYJQM2AY.js";import"./chunk-Z7PBP7IJ.js";import"./chunk-5F7M5EJ4.js";import"./chunk-RQWEJ5N6.js";import"./chunk-RNWGOGLT.js";import"./chunk-UGJ3FMEQ.js";import"./chunk-OPJRP6YV.js";import"./chunk-H6JAOQCX.js";import"./chunk-OJXBW2YQ.js";import"./chunk-PDRHBICP.js";import"./chunk-Z2AIGJGI.js";import"./chunk-SLQQVCPY.js";import"./chunk-ZRVP4J67.js";import"./chunk-YSKQ76UN.js";import"./chunk-A3W4ZDEQ.js";import"./chunk-VBZ4JSJ6.js";import"./chunk-LBYXY63E.js";import"./chunk-M4ANCDMF.js";import"./chunk-J6KTJ3IN.js";import"./chunk-5CQODPK7.js";import"./chunk-C5XO4JMZ.js";import"./chunk-HI3LE734.js";import"./chunk-RX4V72AK.js";import{f as m,n as process,o as r,q as s}from"./chunk-Y5OH3DDZ.js";r();s();var q=m(y()),ee=m(M()),D=m(Me()),te=m(Se());Pe();vo();r();s();var Ut=m(y());var Lt=(0,Ut.lazy)(()=>import("./Comp-UJZBDEGH.js"));r();s();var E=m(y());Le();r();s();var Jt=m(y());_e();r();s();var b=m(y()),$t=m(M()),Vt=m(Me());v();nt();r();s();var h=m(y()),Gt=m(Me());_e();v();Le();r();s();var Re={root:"_root_oli0p_1",multiAccount:"_multiAccount_oli0p_4",count:"_count_oli0p_9"};var Bo="account-selector",Uo=e=>{let t=(0,Gt.useHistory)(),{permissionsRequestId:o,request:n,dappSelectAccount:a,walletInfo:i={},connectable:c=!0,hiddenAddress:u=!1,disableSelectAccount:d=!1}=e,l=()=>{t.push({pathname:`${R}/${o}${W}`})},_=(0,h.useMemo)(()=>u?"":n?.providerType===Ze?g("wallet_extension_cosmos_text_cosmos_network"):i.address??"",[u,n?.providerType,i.address]),C=n?.method===Ae.walletRequestWallets&&n?.providerType===ye,f=()=>a.length<=1?C?h.default.createElement(B,{bordered:!1},h.default.createElement(Fe,{onClick:d?void 0:fe,hiddenAddress:u,copyable:!1,title:g("wallet_dapp_conncetion_requesr_subtitle_current_account"),walletId:i.walletId,address:g("wallet_extension_expand_all_networks")})):h.default.createElement(B,{bordered:!1},h.default.createElement(Fe,{onClick:d?void 0:fe,copyable:!1,title:g("wallet_dapp_conncetion_requesr_subtitle_current_account"),walletId:i.walletId,address:_,hiddenAddress:u,connectable:c})):h.default.createElement(B,{bordered:!1},h.default.createElement(It,{title:g("wallet_dapp_conncetion_requesr_subtitle_current_account")},h.default.createElement(ae.Box,{className:Re.multiAccount},h.default.createElement(ae.Box,{className:Re.count},g("wallet_extension_mid_text_accounts",{num:a.length})),h.default.createElement($e,{className:`${Bo}__info-arrow`,side:$e.SIDE.RIGHT}))));return h.default.createElement("div",{className:Re.root,onClick:d?fe:l},f())},Ft=Uo;function Lo({targetDomainMetadata:e,permissionsRequestId:t,request:o,walletInfo:n,connectable:a,tipMessage:i,buttonGroup:c,hiddenAddress:u,disableSelectAccount:d,RequestedNetworks:l,children:_,title:C}){let f=(0,Vt.useHistory)(),k=(0,$t.useSelector)(T),w=Ct();return b.default.createElement(ae.Container,null,b.default.createElement(xt,{backable:!1,closeable:!1,title:C??g("wallet_dapp_conncetion_maintitle_conncet_account")}),b.default.createElement(B,null,b.default.createElement(Wt,{...e})),b.default.createElement(Ft,{targetDomainMetadata:e,permissionsRequestId:t,request:o,dappSelectAccount:k,walletInfo:n,disableSelectAccount:d,hiddenAddress:u,connectable:a}),l&&b.default.createElement(l,{request:o}),_,b.default.createElement(St,{placeholder:!0,offsetBottom:0,borderTop:!0},b.default.createElement(A,{...i}),b.default.createElement(I,{buttonGroup:c})),n?.keyringIdentityType===ot.MPC&&b.default.createElement(vt,{keyringId:n.keyringId,customConfig:w?.length===1?{confirmText:g("wallet_extension_btn_general_gotit")}:{},actionMap:{["RECOVER"]:()=>{f.push(`${gt}?action=${Mt.RECOVER}&walletId=${n.walletId}`)},["SWITCH_WALLET"]:async()=>w?.length===1?(await c[0]?.onClick(),f.push(ft)):f.push({pathname:`${R}/${t}${W}`})}}))}var K=Lo;r();s();var Yt=m(M());Le();function Go(e,t){let o=be(),{baseChain:n,chainName:a}=Bt(t),c=(0,Yt.useSelector)(T)[0]||o,u=Et({walletId:c,localType:n}),d=t?.method===Ae.walletRequestWallets&&t?.providerType===ye,l=!!n&&(d||Boolean(u?.address)),_=Nt(c);return{targetWalletId:c,walletInfo:u,connectable:l,chainName:a,mpcConnectable:_}}var z=Go;r();s();var $=m(M()),jt=m(Me()),Ve=m(Se());v();Pe();function Ye({disabled:e,request:t,targetDomainMetadata:o,cancelPermissionsRequest:n,approvePermissionsRequest:a,connectSource:i,connectChains:c}){let u=(0,$.useDispatch)(),d=o?.origin,l=ue(),_=(0,$.useSelector)(T),C=(0,$.useSelector)(k=>Pt(k,d));return async()=>{if(e)return;l({trade:"connect_wallet",all_confirmation:"confirm"});let k={...t,permissions:{...t.permissions}};if(Object.keys(k.permissions).length>0){if(await a(k,_),_.length===1&&await u(lt(_[0],!0)),ut({dapp_url:d}),C?.lastConnectedWalletId&&C?.providerType){let w={dappurl:d??"",connect_method:i||C.providerType,dappname:o?.name,full_url:o?.url,version:process.env.APP_VERSION};c&&(w.chain=c),ct(w)}}else await n(k.metadata.id);await O(u)}}var Fo=({props:e,isMpcError:t,connectable:o,confirmBtnText:n,onConfirm:a,onCancel:i,connectSource:c,connectChains:u,disabledConfirmBtn:d=!1})=>{let l=(0,$.useDispatch)(),_=(0,jt.useHistory)(),C=(0,$.useSelector)(T),{permissionsRequestId:f,targetDomainMetadata:k,cancelPermissionsRequest:w,approvePermissionsRequest:P,request:U}=e,L=ue(),x=(0,Ve.useMemoizedFn)(async()=>{L({trade:"connect_wallet",all_confirmation:"cancel"}),i?await i(f):await w(f),await O(l)}),{loading:oe,onClick:ne}=ce(x),V={actionType:I.ACTION_TYPE.CANCEL,onClick:ne,loading:oe},Y=Ye({request:U,targetDomainMetadata:k,approvePermissionsRequest:P,cancelPermissionsRequest:w,connectSource:c,connectChains:u}),j=(0,Ve.useMemoizedFn)(async()=>{o?a?await a():await Y():_.push({pathname:`${R}/${f}${W}`})}),{loading:re,onClick:Be}=ce(j),de={actionType:I.ACTION_TYPE.CONFIRM,disabled:d||o&&(C.length===0||t),btnText:o?n||g("wallet_extension_connect_btn_connect"):g("wallet_extension_connect_btn_switch_wallet"),onClick:Be,loading:re};return[V,de]},X=Fo;r();s();var Ht=m(y()),Ee=m(M());function $o(e,t){let o=(0,Ee.useDispatch)(),n=(0,Ee.useSelector)(T),{connectable:a,mpcConnectable:i}=e;(0,Ht.useEffect)(()=>{if(!n.length&&a&&i&&t){let c=Array.isArray(t)?t:[t];o(xe.setSelectAccounts(c))}},[n,a,i,t])}var J=$o;r();s();var Kt=m(y());v();function Vo({isMpcError:e,connectable:t,chainName:o}){return(0,Kt.useMemo)(()=>e?{type:A.TIP_TYPE.COMMON_ERROR,message:g("extension_wallet_error_toast_not_supported")}:t?{type:A.TIP_TYPE.NORMAL,message:g("wallet_dapp_conncetion_notify_conncet_permission")}:{type:A.TIP_TYPE.COMMON_WARN,message:g("wallet_extension_connect_alert_text_doesnt_support_network",{network:o})},[e,t,o])}var qe=Vo;r();s();var Xt=m(y()),je=m(M());nt();r();s();var De=m(y());var zt=(e,t)=>{let[o,n]=(0,De.useState)(!1);return(0,De.useEffect)(()=>{(async()=>{if(e&&t){let{data:a}=await bt({dappUrl:e});n(a.result)}})()},[e,t]),o};function Yo(e){let t=(0,je.useSelector)(T),o=(0,je.useSelector)(rt),n=(0,Xt.useMemo)(()=>t.some(i=>o.find(c=>c.walletId===i)?.initialType===tt.MPC_KEYRING),[t,o]),a=zt(e?.host,n);return n&&!a}var Z=Yo;function jo(e){let{targetDomainMetadata:t,permissionsRequestId:o,request:n}=e,a=be(),i=z(t?.origin,n),{walletInfo:c,connectable:u,chainName:d}=i,l=Z(t),_=qe({isMpcError:l,connectable:u,chainName:d}),C=X({props:e,isMpcError:l,connectable:u});return J(i,a),He(n)?null:Jt.default.createElement(K,{targetDomainMetadata:t,permissionsRequestId:o,request:n,walletInfo:c,connectable:u,tipMessage:_,buttonGroup:C})}var Zt=jo;r();s();var oo=m(y()),no=m(M());se();r();s();_e();se();var Ho=({props:e,isMpcError:t,connectable:o,walletInfo:n={},nearAmount:a})=>{let{walletId:i,address:c}=n,u=X({props:e,isMpcError:t,connectable:o});return!ge(a)&&ke(a,0)&&(u[1]={actionType:I.ACTION_TYPE.FILL_UP,coinId:Te,walletId:i,address:c,receiveOnly:!0}),u},Qt=Ho;r();s();var eo=m(y());_e();v();function Ko({nearAmount:e,isMpcError:t,connectable:o,chainName:n}){return(0,eo.useMemo)(()=>!ge(e)&&ke(e,0)?{type:Ke.TYPE.warn,message:g("wallet_extension_conncetion_alert_add_more")}:t?{type:A.TIP_TYPE.COMMON_ERROR,message:g("extension_wallet_error_toast_not_supported")}:o?{type:A.TIP_TYPE.NORMAL,message:g("wallet_extension_conncetion_alert_check_balance")}:{type:A.TIP_TYPE.COMMON_WARN,message:g("wallet_extension_connect_alert_text_doesnt_support_network",{network:n})},[e,t,o,n])}var to=Ko;var zo=e=>{let{targetDomainMetadata:t,permissionsRequestId:o,request:n}=e,a=(0,no.useSelector)(H),i=z(t?.origin,n),{walletInfo:c,connectable:u,chainName:d,targetWalletId:l}=i,_=Z(t),C=At(Te,l)?.coinAmountInt,f=to({targetWalletId:l,isMpcError:_,connectable:u,chainName:d,nearAmount:C}),k=Qt({props:e,isMpcError:_,connectable:u,walletInfo:c,nearAmount:C});return J(i,a),oo.default.createElement(K,{targetDomainMetadata:t,permissionsRequestId:o,request:n,walletInfo:c,connectable:u,tipMessage:f,buttonGroup:k})},ro=zo;r();s();r();s();var Xo=()=>null,so=Xo;var io=so;r();s();var pe=m(y());v();r();s();var me=m(y()),co=m(No());r();s();var ao={item:"_item_11fx7_1"};function Jo({className:e,message:t}){return me.default.createElement(me.default.Fragment,null,me.default.createElement(B,{bordered:!1,className:(0,co.default)(ao.item,e)},me.default.createElement(Rt,{message:t})))}var uo=Jo;r();s();var Co=m(y());v();at();se();Wo();r();s();var mo=m(M()),lo=m(Se());Pe();function Zo({disabledSubmit:e,confirmBtnLoading:t,permissionsRequestId:o,cancelPermissionsRequest:n,request:a,targetDomainMetadata:i,approvePermissionsRequest:c}){let u=(0,mo.useDispatch)(),d=ue(),l=(0,lo.useMemoizedFn)(async()=>{d({trade:"connect_wallet",all_confirmation:"cancel"}),await n(o),await O(u)}),{loading:_,onClick:C}=ce(l),f={loading:_,actionType:I.ACTION_TYPE.CANCEL,onClick:C},k=Ye({request:a,targetDomainMetadata:i,approvePermissionsRequest:c,cancelPermissionsRequest:n}),w={loading:t,disabled:e,actionType:I.ACTION_TYPE.CONFIRM,onClick:k};return[f,w]}var po=Zo;r();s();var ve=m(y()),fo=m(Se());se();Oo();function Qo(e,t){let o=(0,ve.useRef)(t?.origin),a=(e?.providersExts?.[N]??e?.exts)?.message?.manifestUrl,[i,c]=(0,ve.useState)(!0);return(0,fo.useMount)(()=>{(async()=>{if(a)try{let d=await Je(a);if(d?.status===200){let l=d.data;typeof l?.url=="string"&&(o.current=l.url)}}finally{c(!1)}else c(!1)})()}),{loading:i,domain:o.current}}var go=Qo;r();s();var Oe=m(y()),Ne=m(M());function en(e){let t=(0,Ne.useSelector)(H),o=(0,Ne.useSelector)(T),n=(0,Ne.useSelector)(c=>ht(c,e?.origin)),[a,i]=(0,Oe.useState)(null);return(0,Oe.useEffect)(()=>{(async()=>{t&&o.includes(t)?i(t):n&&o.includes(n)?i(n):i(o[0])})()},[t,o,n]),a}var _o=en;var tn=({request:e,targetDomainMetadata:t,permissionsRequestId:o,approvePermissionsRequest:n,cancelPermissionsRequest:a,isSilentConnected:i})=>{let c=_o(t),{loading:u,domain:d}=go(e,t),l=kt(c,N),f=((e?.providersExts?.[N]??e?.exts)?.message?.items||[]).filter(({name:P})=>P===dt.TON_PROOF),k=f.length===1?`${f[0].payload||""}`:f.map(({payload:P})=>({value:P}));(0,Co.useEffect)(()=>{he("Sign Ton Proof UI",{tonAddress:l})},[l]);let w=po({disabledSubmit:u,permissionsRequestId:o,request:e,targetDomainMetadata:t,approvePermissionsRequest:async(P,U,L)=>{try{let x=Math.round(Date.now()/1e3),oe=new URL(d).host,ne=await Promise.all(f.map(async({payload:V})=>{let Y;try{he("Call Sign Ton Proof",{tonAddress:l}),Y=await ie().signTonProof({proof:{timestamp:x,domain:oe,payload:V}},l,c)}catch(j){throw he("Error Sign Ton Proof",{tonAddress:l,isReject:j?.message===it}),j}return{payload:V,signature:Y}}));P.resultParams={domain:d,timestamp:x,signatures:ne}}catch{return Xe.error({title:g("wallet_extension_ton_error_signature_support")}),null}return n(P,U,L,!i)},cancelPermissionsRequest:a});return{tonProofs:f,message:k,buttonGroup:w}},ko=tn;r();s();var le=m(y()),wo=m(M());at();se();function on({targetDomainMetadata:e,dappMetadata:t,alwaysNeedProof:o}){let n=(0,wo.useSelector)(H),[a,i]=(0,le.useState)(null),[c,u]=(0,le.useState)(!0);return(0,le.useEffect)(()=>{(async()=>{if(!o){u(!1);return}try{(await ie().getPermittedWallets(e?.origin,N,!1)).length>0&&i(await ie().getPermittedWallets(e?.origin,N,!0))}finally{u(!1)}})()},[o]),J(t,c?null:a||n),{loading:c,isSilentConnected:!!a}}var yo=on;r();s();var To={loading:"_loading_po7pc_1"};function nn(e){let{alwaysNeedProof:t,targetDomainMetadata:o,permissionsRequestId:n,request:a}=e,i=z(o?.origin,a),{walletInfo:c,connectable:u,chainName:d}=i,l=Z(o),_=qe({isMpcError:l,connectable:u,chainName:d}),C={props:e,isMpcError:l,connectable:u,connectSource:a?.exts?.connectSource},f=X(C),{loading:k,isSilentConnected:w}=yo({targetDomainMetadata:o,dappMetadata:i,alwaysNeedProof:t}),{tonProofs:P,message:U,buttonGroup:L}=ko({...e,isSilentConnected:w}),x=P?.length>0;return k?pe.default.createElement("div",{className:To.loading},pe.default.createElement(Ue.Circle,{size:Ue.SIZE.lg})):pe.default.createElement(K,{targetDomainMetadata:{...o,host:o.origin||o.host},permissionsRequestId:n,request:a,walletInfo:c,connectable:u,tipMessage:_,buttonGroup:x?L:f,title:x?g("wallet_extension_header_connect_sign"):void 0},pe.default.createElement(uo,{message:U}))}var ho=nn;r();s();r();s();var rn=()=>null,Po=rn;var So=Po;r();s();var Q=m(y());v();r();s();var We={root:"_root_h6iyb_1",animation:"_animation_h6iyb_14",text:"_text_h6iyb_17"};var sn=({onComplete:e})=>{let[t,o]=(0,Q.useState)(!1),n=_t({dark:"/static/images/dapp/success-dark.json",light:"/static/images/dapp/success-light.json"});return Q.default.createElement("div",{className:We.root},Q.default.createElement(ze,{className:We.animation,path:n,loop:!1,onDataReady:()=>{o(!0)},onComplete:e}),t?Q.default.createElement("span",{className:We.text},g("wallet_home_foot_dapp_connceted")):null)},xo=sn;var Mo=({chooseAccountProps:e,showAni:t})=>{let o=e?.request?.providerTypes,n=e?.request?.providersExts,a=e?.request?.exts?.alwaysNeedProof,i=e?.request?.providerType,c=!!o,u=e?.request?.exts?.isShowWalletConnect;return E.default.createElement(E.default.Fragment,null,(()=>{switch(!0){case u:return E.default.createElement(So,{providerTypes:o,providersExts:n,...e});case c:return E.default.createElement(io,{providerTypes:o,providersExts:n,...e});case(i===Qe&&a):return E.default.createElement(ro,{...e});case i===et:return E.default.createElement(ho,{alwaysNeedProof:a,...e});default:return E.default.createElement(Zt,{...e})}})(),t&&E.default.createElement(xo,{onComplete:()=>{e?.onComplete()}}))};r();s();r();s();var bo=m(M());Pe();function Io(){let e=(0,bo.useDispatch)();return()=>e(mt())}var Ao=Io;r();s();var an=({environmentType:e,history:t})=>{e!==Ce&&t.push(Ge)},cn=({dispatch:e,permissionsRequest:t,showAni:o,redirect:n})=>{let a=(0,te.usePrevious)(o);(0,te.useUpdateLayoutEffect)(()=>{a===void 0&&o===!1&&!t&&(e(Ie()),n())},[a,o,t])},un=({rejectPermissionsRequest:e,permissionsRequestId:t,optType:o})=>{let n=()=>{t&&o===yt.connect&&e(t,origin)};return{beforeUnload:n,addBeforeUnload:()=>{we()===Ce&&window.addEventListener("beforeunload",n)},removeBeforeUnload:()=>{we()===Ce&&window.removeEventListener("beforeunload",n)}}},mn=({rejectPermissionsRequest:e,dispatch:t,redirect:o,origin:n})=>async(i,c)=>{i&&(await e(i,n,c),await O(t),o())},ln=({permissionsRequest:e,history:t,getCurrentWindowTab:o,getRequestAccountTabIds:n,addBeforeUnload:a,clearSelectedWallet:i})=>{(0,te.useMount)(()=>{if(o(),n(),!e){t.push(Ge);return}a(),i()})},Ro=e=>e||{},pn=({showConnectSuccess:e,setShowAni:t,onComplete:o})=>{e?t(!0):o()},cc=()=>{let e=(0,ee.useDispatch)(),t=(0,D.useHistory)(),n=(0,D.useRouteMatch)().params.id,i=(0,ee.useSelector)(wt).find(S=>S.metadata.id===n),c=i?.providerTypes,[u,d]=(0,q.useState)(!1),l=(0,ee.useSelector)(Tt),_=(0,ee.useSelector)(st),{metadata:C={}}=i||{},{origin:f,url:k}=C,w=null;if(f)if(_[f])w={..._[f],origin:f,url:k},w.icon??=pt;else{let S=new URL(f);w={host:S.host,name:S.hostname,origin:f,url:k}}let P=`${R}/${n}`,U=`${R}/${n}${W}`,L=async(S,G,F)=>{await e(qt(S,G,F))},x=async(S,G,F)=>{await e(Dt(S,G,F)),await e(Ie())},oe=()=>e(Ot()),ne=Ao(),V=()=>e(xe.setSelectAccounts([])),{addBeforeUnload:Y,removeBeforeUnload:j}=un({rejectPermissionsRequest:x,permissionsRequestId:n,optType:l}),re=()=>{j();let S=we();return an({environmentType:S,history:t}),null},Be=mn({rejectPermissionsRequest:x,dispatch:e,redirect:re,origin:f}),de=()=>{d(!1),re(),e(Ie())};cn({dispatch:e,permissionsRequest:i,showAni:u,redirect:re}),ln({permissionsRequest:i,history:t,getCurrentWindowTab:ne,getRequestAccountTabIds:oe,addBeforeUnload:Y,clearSelectedWallet:V});let Eo=c;return q.default.createElement("div",{className:"page-container permissions-connect"},q.default.createElement(D.Switch,null,q.default.createElement(D.Route,{path:U,exact:!0,render:()=>q.default.createElement(Lt,{request:Ro(i),multi:!Eo})}),q.default.createElement(D.Route,{path:P,exact:!0,render:()=>{let S={request:Ro(i),cancelPermissionsRequest:(G,F)=>Be(G,F),permissionsRequestId:n,targetDomainMetadata:w,onComplete:de,approvePermissionsRequest:async(G,F,qo,Do=!0)=>{await L(G,F,qo),await O(e),pn({showConnectSuccess:Do,setShowAni:d,onComplete:de})}};return q.default.createElement(Mo,{chooseAccountProps:S,showAni:u})}})))};export{cc as default};
//# sourceMappingURL=PermissionsConnect-MIEENTOH.js.map
