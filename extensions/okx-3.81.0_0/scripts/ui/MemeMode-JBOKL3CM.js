import{a as Ct,b as oe,c as Mt,d as yt,e as At}from"./chunk-SK56UAUA.js";import{a as bt,d as vt,e as Bt}from"./chunk-7BGJL3MA.js";import{a as wt}from"./chunk-NFM2PBST.js";import{a as Dt,b as xt}from"./chunk-JQ4B2RAH.js";import{b as Rt}from"./chunk-SYP4PRCG.js";import{a as Pt,b as f}from"./chunk-QL63AAOK.js";import{a as Lt}from"./chunk-C627M2I3.js";import{b as It,d as Et}from"./chunk-HB3JXXNO.js";import{b as W}from"./chunk-KDWSU3J6.js";import{j as H}from"./chunk-QXEXAETB.js";import{a as mt,c as lt,e as ft,j as pt,m as Ie,n as St,p as gt,r as Tt,s as _t}from"./chunk-UULU72LG.js";import{a as te,d as ht}from"./chunk-ARK47WR5.js";import{a as ee,b as ut,c as ct,d as dt}from"./chunk-BF6TFHGA.js";import{h as kt}from"./chunk-7Q4IDC7V.js";import{a as F,b as L}from"./chunk-F57QKCZQ.js";import{I as Q,J as k,L as at,M as O,Z as it}from"./chunk-HIVYZXF3.js";import{$ as rt}from"./chunk-4Y52FA3V.js";import{a as ot}from"./chunk-ZYYACLV7.js";import"./chunk-ANWN6BF6.js";import{e as N}from"./chunk-A2QIZMPL.js";import{l as z,o as Z,v as st,w as nt}from"./chunk-HKU7TMFJ.js";import"./chunk-YTR7GLCK.js";import"./chunk-7I4OPLNV.js";import"./chunk-YMYQJ726.js";import{a as $}from"./chunk-FGRS6VIX.js";import{$a as J,$c as Xe,Za as Ge,_a as He,ab as We,bb as Ke,cc as Ye,cd as Je,dd as $e,ed as ze,fd as Ze,ga as Ve,gd as et,rb as je,vd as tt,xa as qe}from"./chunk-INIQCRIO.js";import"./chunk-2P6PTKAN.js";import"./chunk-ZFBXO46L.js";import{a as E}from"./chunk-6Z5HVUBK.js";import{$ as Fe,A as Me,G as M,K as ve,N as we,O as Be,W as q,X,Y as Qe,Z as Oe,_ as Ne,aa as Ue,da as G,l as I,m as D,q as Re,s as be}from"./chunk-ZBDGRK4Q.js";import"./chunk-GN2NRAOV.js";import"./chunk-SFFRTMXL.js";import"./chunk-RLY3NWVP.js";import"./chunk-U3KULTRT.js";import"./chunk-55T2IW2N.js";import"./chunk-WVUOJIBP.js";import"./chunk-JBROAQ6E.js";import"./chunk-LBCITKCK.js";import"./chunk-O4O5AL3V.js";import"./chunk-HAHRUU64.js";import"./chunk-B624VS3G.js";import{a as Y}from"./chunk-6PA65BO3.js";import"./chunk-VZKEX7KP.js";import"./chunk-QCEQQDCM.js";import{G as xe,H as Ce}from"./chunk-BJKBO23H.js";import"./chunk-IO3ALUOJ.js";import"./chunk-JLNZTUPO.js";import"./chunk-MSZOM4GC.js";import"./chunk-BYVN72KS.js";import"./chunk-ZUJLXC72.js";import{I as _e,c as Pe,j as u,s as De,va as b}from"./chunk-XFTQD4B2.js";import"./chunk-DIZF7D6Q.js";import"./chunk-SEAUBLKM.js";import"./chunk-DHKS44RQ.js";import"./chunk-4DBVFCYR.js";import"./chunk-2IGQWLAB.js";import"./chunk-GVV6OTQP.js";import"./chunk-ZFVABNQN.js";import"./chunk-VYWNZTTM.js";import"./chunk-LBWWOQL4.js";import{a as fo}from"./chunk-4QGZDIBD.js";import{b as g}from"./chunk-73B6GL3S.js";import"./chunk-LVJGLJNA.js";import"./chunk-FYJQM2AY.js";import"./chunk-5F7M5EJ4.js";import"./chunk-RX4V72AK.js";import{f as S,o as n,q as a}from"./chunk-Y5OH3DDZ.js";n();a();var Te=S(g());n();a();var A=S(g()),uo=S(Y());n();a();var v=S(g());n();a();var Ee=S(g());b();var Qt=()=>{let{buyStore:o,sellStore:e}=f(),{currentBuyPreset:t,setBuyValue:r,buyValue:s}=o,{currentSellPreset:i,setSellValue:m,sellValue:c}=e,{amountList:l=[]}=t,{amountList:p=[]}=i;(0,Ee.useEffect)(()=>{_e(l)||s.type==="custom"||r({value:l[s.index]||"0",type:"select",index:s.index})},[r,l]),(0,Ee.useEffect)(()=>{if(_e(p)||c.type==="custom")return;let h=p[c.index]||"0";m({value:h,type:"select",index:c.index})},[m,p])};var po=({inputAmount:o,custom:e,defaultBuyAmountList:t,buyStore:r,setAmountUsed:s,setCustomUsed:i})=>{e==="1"?(r.setBuyValue({value:"",type:"custom",index:3}),i(!0),H("custom")):o&&(t.includes(o)?(r.setBuyValue({value:o,type:"select",index:t.findIndex(m=>m===o)}),s(!0),H("inputAmount")):r.setBuyValue({value:t[0]||"0",type:"select",index:0}))},ho=({inputPercent:o,custom:e,defaultSellPercentList:t,sellStore:r,setPercentUsed:s,setCustomUsed:i})=>{e==="1"?(r.setSellValue({value:"",type:"custom",index:3}),r.setIsPercentMode(!0),i(!0),H("custom")):o&&(r.setIsPercentMode(!0),t.includes(o)?(r.setSellValue({value:o,type:"custom",index:3}),s(!0),H("inputPercent")):r.setSellValue({value:t[0]||"0",type:"select",index:0}))},Ot=()=>{let{queryParams:o}=xt(),{buyStore:e,sellStore:t,configStore:r}=f(),{currentMode:s}=r,{currentBuyPreset:i}=e,{currentSellPreset:m}=t,{amountList:c}=i,{amountList:l}=m,p=o?.get?.("inputAmount"),h=o?.get?.("inputPercent"),_=o?.get?.("custom"),[C,y]=(0,v.useState)(!1),[P,ke]=(0,v.useState)(!1),[B,j]=(0,v.useState)(!1);(0,v.useEffect)(()=>{s==="buy"&&!C&&!B&&po({inputAmount:p,custom:_,defaultBuyAmountList:c||[],buyStore:e,setAmountUsed:y,setCustomUsed:j})},[p,_,s,c,C,B]),(0,v.useEffect)(()=>{s==="sell"&&!P&&!B&&ho({inputPercent:h,custom:_,defaultSellPercentList:l||[],sellStore:t,setPercentUsed:ke,setCustomUsed:j})},[p,h,_,s,l,P,B]),Qt()};n();a();var Ut=S(g());n();a();var Nt=S(g());n();a();var re=S(g());var So=()=>{let{buyStore:o,sellStore:e,configStore:t}=f(),{currentMode:r}=t,s=(0,re.useCallback)(l=>{let p=l.coinAmountOriginalDec||l.amountNum,h={...l,amountNum:p};e.onSocketUpdateFromTokenBalance(h),o.onSocketUpdateFromTokenBalance(h)},[e,o]),i=e.fromToken?.tokenContractAddress,m=o.fromToken?.tokenContractAddress,c=(0,re.useMemo)(()=>r==="sell"?i:m,[i,m,r]);return{updateTokenBalance:s,currentTokenAddress:c}},se=So;var go=()=>{let{updateTokenBalance:o,currentTokenAddress:e}=se(),t=wt(),{chainId:r,accountId:s,userUniqueId:i,walletId:m,userWalletAddress:c,businessType:l}=t;return(0,Nt.useCallback)(async()=>{if(e&&r&&s&&i&&m&&c){let p=await vt({tokenAddress:e,chainId:r,accountId:s,userUniqueId:i,walletId:m,userWalletAddress:c,businessType:l});p&&o(p)}},[r,e,s,i,m,c,l,o])},Ft=go;var To=()=>{let{accountStore:o,memePositionStore:e,configStore:t,commonStore:r}=f(),{computedAccountId:s}=o,{userUniqueId:i}=r,{computedNativeTokenInfo:m}=t,{chainId:c}=m||{},{fetchPositionList:l}=e,p=bt(l,300),{updateTokenBalance:h}=se(),_=Ft();(0,Ut.useEffect)(()=>{let C=ee({isPri:!0,needLogin:!0,subscribeParams:[{channel:dt.WALLET_ASSET}],onListenData:y=>{!y||(p({chainId:c,accountId:s,userUniqueId:i}),h(y))},onListenError:_,onListenReconnected:_});return()=>{C()}},[c,s,i,p,h,_])},Vt=To;n();a();var qt=S(g());function Gt(){let{accountStore:o}=f(),{computedAccountWalletAddresses:e}=o;(0,qt.useEffect)(()=>{let t=()=>{};return e&&(t=ut(e)),()=>{t?.()}},[e])}n();a();n();a();var Kt=S(g());n();a();function ne(){let{buyStore:o,sellStore:e,configStore:t}=f(),{currentMode:r}=t;return(r==="sell"?e.fromToken:o.toToken)||{}}n();a();var Ht=(o,e)=>{let t={userUniqueId:o,tokenDetailList:[{chainId:e.chainId,contractAddress:e.tokenContractAddress,tokenSymbol:e.tokenSymbol,precision:e.decimals}]};return L.post(Ye,t)},Wt=o=>(Array.isArray(o)?o:[o]).map(t=>({channel:ct.DEX_MARKET_TX_CHANNEL,chainId:String(t?.chainId),tokenAddress:t?.tokenContractAddress}));var ko=()=>{let o=ne(),{commonStore:e}=f();(0,Kt.useEffect)(()=>{!o.tokenContractAddress||!o.chainId||!e.userUniqueId||Ht(e.userUniqueId,o)},[e.userUniqueId,o.tokenContractAddress,o.chainId])},jt=ko;n();a();var zt=S(g());n();a();var Jt=S(g());n();a();var Yt=async({tokenContractAddress:o,accountId:e=void 0,chainId:t,walletAddress:r=void 0})=>{let s=performance.now(),[i,m]=await M(L.get(Xe,{params:{tokenContractAddress:o,accountId:e,chainId:t,walletAddress:r}})),c=performance.now()-s;return Re.info(`[Market-API]: fetchLatestInfo: ${c?.toFixed?.(2)}ms`),!i&&m?m.data:{error:i}};n();a();var Xt=S(g());var _o=()=>{let{buyStore:o,sellStore:e,configStore:t}=f(),{currentMode:r}=t;return(0,Xt.useCallback)(s=>{let i={...s,chainId:Number(s.chainId)};r==="sell"?e.onSocketUpdateFromToken(i):o.onSocketUpdateToToken(i)},[r,e,o])},ae=_o;var Co=()=>{let{accountStore:o}=f(),{computedAccountId:e,computedSignWalletAddress:t}=o,r=ae();return(0,Jt.useCallback)(async s=>{let i=await Yt({tokenContractAddress:s.tokenContractAddress,chainId:s.chainId,accountId:e,walletAddress:t});if(i?.error)return;let m={...s,price:i.price,marketCap:i.marketCap};r(m)},[r,e])},$t=Co;var Mo=()=>{let o=ne(),e=ae(),t=$t();(0,zt.useEffect)(()=>{if(!o.tokenContractAddress||!o.chainId)return()=>{};let r=Wt(o),s=ee({subscribeParams:r,onListenData:i=>{e(i[0])},onListenError:()=>{t(o)},onListenReconnected:()=>{t(o)}});return()=>{s()}},[o.tokenContractAddress,o.chainId,e])},Zt=Mo;var Io=()=>{jt(),Zt()},eo=Io;n();a();var w=S(g()),to=S(Y());var Eo=({currency:o,currentWallet:e,walletInfo:t,keyringIdentityTypeEnum:r,addressBookList:s,walletList:i,t:m,dispatch:c,onBack:l})=>{let{commonStore:p,accountStore:h,reset:_}=f(),C=(0,to.useHistory)();(0,w.useEffect)(()=>{G.setRuntimeContext({history:C,toLocale:m,dispatch:c,walletInfo:t,onBack:l})},[m,C,c,t,l]),(0,w.useEffect)(()=>{e&&h.setWalletConfig(e)},[e]),(0,w.useEffect)(()=>(p.getUserUnit(o),()=>{_()}),[]),(0,w.useEffect)(()=>{h.setAddressBookList(s)},[s]),(0,w.useEffect)(()=>{h.setWalletList(i)},[i]),(0,w.useEffect)(()=>{h.setKeyringIdentityTypeEnum(r)},[r])},oo=Eo;n();a();var T=S(g()),V=S(Y());n();a();var x=S(g()),me=S(Y()),no=S(fo());n();a();var Le=S(g());var Lo=()=>Le.default.createElement("div",{className:"mt-50"},Le.default.createElement(xe,{pastDelay:!1,error:!0,delayTime:1e4,alt:"dexGenericError",retry:()=>{we(ve().pathname,"_self")}})),ro=Lo;n();a();var ie=S(g());var yo=()=>{let{commonStore:o,configStore:e}=f(),{currentMode:t}=e,{fromToken:r}=Bt(),{chainId:s,isNativeToken:i,tokenContractAddress:m}=r,{visibleAddFunds:c,setAddFundsVisible:l}=o,p=ot(),h=(0,ie.useMemo)(()=>p?!0:t==="sell",[p,t]);return ie.default.createElement(Ct,{visible:c,params:{chainId:s,tokenContractAddress:i?"":m,receiveOnly:h},onBack:()=>{l(!1)}})},so=D(yo);var Ao=[q,X],Po=({children:o,onBack:e})=>{let{commonStore:t,configStore:r,buyStore:s,sellStore:i}=f(),{showNavigator:m,title:c,closeable:l}=Mt({configStore:r,buyStore:s,sellStore:i}),p=(0,me.useLocation)(),h=(0,me.useHistory)(),{isTelegramMiniApp:_}=G.global,{Navigator:C}=G.components,{setAddFundsVisible:y}=t;(0,x.useEffect)(()=>{y(!1)},[]),Lt(),kt(At.setServiceState);let P=()=>{e?e(h.goBack,Ao.includes(p.pathname)):h.goBack()};return x.default.createElement(mt,{fallbackComponent:ro},x.default.createElement("div",{className:(0,no.default)("universe-swap background-base-primary",oe.wrapper)},m?x.default.createElement(C,{title:c,onBack:P,closeable:l}):null,x.default.createElement("div",{id:"meme-swap-container",className:_?oe.memeTelegramContainer:oe.extensionContainer},o)),x.default.createElement(so,null))},ao=D(Po);var io=(0,T.lazy)(()=>import("./Buy-UQ4AXAYA.js")),Do=(0,T.lazy)(()=>import("./Sell-LMNFG7NK.js")),xo=(0,T.lazy)(()=>import("./Configure-XHGKHTUG.js")),Ro=(0,T.lazy)(()=>import("./TokenList-IIIYVWHW.js")),bo=(0,T.lazy)(()=>import("./HighRisk-PKW3HTZR.js")),vo=(0,T.lazy)(()=>import("./Presets-3J5DXMXH.js")),wo=(0,T.lazy)(()=>import("./PresetEdit-EOBXBG3N.js")),Bo=({onBack:o})=>T.default.createElement(ao,{onBack:o},T.default.createElement(T.Suspense,null,T.default.createElement(V.Switch,null,[{path:q,component:io,exact:!0},{path:X,component:Do,exact:!0},{path:Oe,component:xo,exact:!0},{path:Qe,component:Ro,exact:!0},{path:Ne,component:bo,exact:!0},{path:Fe,component:vo,extract:!0},{path:Ue,component:wo,extract:!0}].map(t=>T.default.createElement(V.Route,{key:t.path,path:t.path,component:t.component,exact:t.exact})),T.default.createElement(V.Redirect,{from:q,to:{pathname:io,search:new Be().getAll()},strict:!0,exact:!0})))),mo=Bo;var Qo=({currency:o,currentWallet:e,keyringIdentityTypeEnum:t,addressBookList:r,walletList:s,walletInfo:i,onBack:m,t:c,dispatch:l})=>{oo({currency:o,currentWallet:e,walletInfo:i,keyringIdentityTypeEnum:t,addressBookList:r,walletList:s,t:c,dispatch:l,onBack:m}),Gt(),Vt(),eo();let{accountStore:{address:p,setFromChainId:h},configStore:{fetchConfig:_,computedConfig:C,setCurrentMode:y}}=f();(0,A.useEffect)(()=>{k.setTags({address:p})},[p]),(0,A.useEffect)(()=>{_()},[]);let P=(0,uo.useLocation)();(0,A.useEffect)(()=>{if(P){let{isBuyMode:B,isSellMode:j}=Dt(P);B?y("buy"):j&&y("sell")}},[P,y]),(0,A.useEffect)(()=>{C&&h(C?.nativeTokenInfo?.chainId)},[C]),Rt(),Ot();let{initialized:ke}=_t();return ke?A.default.createElement(mo,{onBack:m}):null},co=(0,A.memo)(D(Qo));n();a();n();a();b();var ue=class{constructor(){this.loading=!0;this.setLoading=e=>{this.loading=e};this.fromToken=null;this.setFromToken=e=>{this.fromToken=e};this.toToken=null;this.setToToken=e=>{this.toToken=e};this.onSocketUpdateToToken=e=>{N(e,this.toToken)&&this.setToToken({...this.toToken,...e})};this.onSocketUpdateFromTokenBalance=e=>{N(e,this.fromToken)&&this.setFromToken({...this.fromToken,amountNum:e.amountNum})};this.buyValue={value:"0",index:0,type:"select"};this.setBuyValue=e=>{this.buyValue=e};this.buyPresetList=[];this.setBuyPresetList=e=>{this.buyPresetList=e};this.currentBuyPresetId="";this.setCurrentBuyPresetId=e=>{this.currentBuyPresetId=e};this.buyPresetPageEditState=!1;this.setBuyPresetPageEditState=e=>{this.buyPresetPageEditState=e};this.editBuyPreset={isEdit:!0,value:{}};this.setEditBuyPreset=e=>{this.editBuyPreset=e};this.memeBtnStatus=z;this.setMemeBtnStatus=e=>{this.memeBtnStatus=e};I(this)}get computedBuyNumber(){if(this.buyValue.type==="custom"){let e=this.buyValue.value||"0";return $(e)?"0":new E.BigNumber(e).toString(10)}return this.currentBuyPreset?.amountList?.[this.buyValue.index]}get computedBuyTokenSymbol(){return u(this,"toToken.tokenSymbol")}get computedBuyNumberIsValid(){return new E.BigNumber(this.computedBuyNumber).gt(0)}get currentBuyPreset(){return this.buyPresetList.find(e=>e.id===this.currentBuyPresetId)||{}}};n();a();var ce=class{constructor(){this.initState=!1;this.setInitState=e=>{this.initState=e};this.positionList=[];this.setPositionList=e=>{this.positionList=W.filterHiddenTokenList(e)};this.fetchPositionLoading=!0;this.setFetchPositionLoading=e=>{this.fetchPositionLoading=e};this.cancelFetchRef=null;this.fetchPositionList=async({accountId:e,userUniqueId:t,chainId:r,minAmountThreshold:s})=>{if(!e||!t||!r)return;this.cancelFetchRef&&this.cancelFetchRef.abort(),this.setFetchPositionLoading(!0),this.cancelFetchRef=O();let[i,m]=await M(L.get(Je,{params:{accountId:e,userUniqueId:t,chainId:r,minAmountThreshold:s},signal:this.cancelFetchRef?.signal}));i&&k.stuff(i),m&&m.data&&this.setPositionList(m?.data),this.setFetchPositionLoading(!1),this.setInitState(!0)};I(this)}isCancel(e){return F(e)}};n();a();b();var de=class{constructor(){this.loading=!0;this.setLoading=e=>{this.loading=e};this.fromToken=null;this.setFromToken=e=>{this.fromToken=e};this.onSocketUpdateFromToken=e=>{N(e,this.fromToken)&&this.setFromToken({...this.fromToken,...e})};this.onSocketUpdateFromTokenBalance=e=>{N(e,this.fromToken)&&this.setFromToken({...this.fromToken,amountNum:e.amountNum})};this.toToken=null;this.setToToken=e=>{this.toToken=e};this.sellValue={value:"",type:"custom",index:0};this.setSellValue=e=>{this.sellValue=e};this.isPercentMode=!0;this.setIsPercentMode=e=>{this.isPercentMode=e};this.sellPresetList=[];this.setSellPresetList=e=>{this.sellPresetList=e};this.currentSellPresetId="";this.setCurrentSellPresetId=e=>{this.currentSellPresetId=e};this.sellPresetPageEditState=!1;this.setSellPresetPageEditState=e=>{this.sellPresetPageEditState=e};this.editSellPreset={isEdit:!0,value:{}};this.setEditSellPreset=e=>{this.editSellPreset=e};this.memeBtnStatus=z;this.setMemeBtnStatus=e=>{this.memeBtnStatus=e};I(this)}get computedSellNumber(){try{let e=Math.min(this.fromToken?.decimals||0,12);if(this.sellValue.type==="custom"&&!this.isPercentMode){let s=this.sellValue.value||"0";return $(s)?"0":new E.BigNumber(s).toString(10)}let t=this.fromToken?.amountNum||"0";if(this.sellValue.type==="custom"&&this.isPercentMode)return E.floorMul(E.div(this.sellValue.value||"0",100),t,e);let r=this.currentSellPreset?.amountList?.[this.sellValue.index];return E.floorMul(r,t,e)}catch(e){return k.stuff(e),"0"}}get computedSellTokenSymbol(){return u(this,"fromToken.tokenSymbol")}get computedSellTokenBalanceLessAmount(){return u(this,"fromToken.computedSellNumber")>u(this,"fromToken.amountNum")}get computedSellNumberIsValid(){return new E.BigNumber(this.computedSellNumber).gt(0)}get currentSellPreset(){return this.sellPresetList.find(e=>e.id===this.currentSellPresetId)||{}}};n();a();var le=class{constructor(){this.searchValue="";this.setSearchValue=e=>{this.searchValue=e};this.defaultSearchLoading=!0;this.setDefaultSearchLoading=e=>{this.defaultSearchLoading=e};this.searchLoading=!1;this.setSearchLoading=e=>{this.searchLoading=e};this.commonSearchState=!1;this.setCommonSearchState=e=>{this.commonSearchState=e};this.normalTokenList=[];this.unsupportedTokenList=[];this.fetchDefaultTokenList=async({chainId:e,computedAccountId:t,userUniqueId:r})=>{this.setDefaultSearchLoading(!0),this.setCommonSearchState(!1);let s={chainId:e,accountId:t,userUniqueId:r,minAmountThreshold:W.getMinAmountThresholdParam()},[i,m]=await M(L.get($e,{params:s}));if(this.searchValue){this.setDefaultSearchLoading(!1);return}i&&(k.stuff(i),this.normalTokenList=[],this.unsupportedTokenList=[]),m&&m.data&&(this.normalTokenList=W.filterHiddenTokenList(m?.data),this.unsupportedTokenList=[]),this.setDefaultSearchLoading(!1)};this.cancelSearchRef=null;this.fetchSearchTokenList=async({chainId:e,computedAccountId:t,userUniqueId:r})=>{if(!this.searchValue)return;this.cancelSearchRef&&this.cancelSearchRef.abort(),this.setSearchLoading(!0),this.setCommonSearchState(!0),this.cancelSearchRef=O();let[s,i]=await M(L.get(ze,{params:{chainId:e,accountId:t,userUniqueId:r,inputContent:this.searchValue},signal:this.cancelSearchRef?.signal}));if(!this.searchValue){this.setSearchLoading(!1);return}s&&!this.isCancel(s)&&(k.stuff(s),this.normalTokenList=[],this.unsupportedTokenList=[]),i&&i.data&&(this.normalTokenList=i?.data?.memeList,i?.data?.memeUnsupportList?this.unsupportedTokenList=i?.data?.memeUnsupportList.map(m=>{let c=m;return c.unSupportedMeme=!0,c}):this.unsupportedTokenList=[]),this.setSearchLoading(!1)};this.highRiskToken=null;this.setHighRiskToken=e=>{this.highRiskToken=e};this.highRiskCallBack=()=>{};this.setHighRiskCallBack=e=>{this.highRiskCallBack=e};I(this)}isCancel(e){return F(e)}};n();a();b();n();a();var fe=class{constructor(){this.currentMode="buy";this.setCurrentMode=e=>{this.currentMode=e};this.tradeScene=0;this.presetStorageKey=Z;this.currentChainID=je.SOLANA_MAINNET;this.initLoading=!0;this.setInitLoading=e=>{this.initLoading=e}}get computedIsBuy(){return this.currentMode==="buy"}get computedIsSell(){return this.currentMode==="sell"}};var pe=class extends fe{constructor(){super();this.configList=[];this.setConfigList=t=>{this.configList=t};this.fetchConfig=async()=>{let[t,r]=await M(It({sceneType:this.tradeScene}));if(t){k.error(Q.MEME_SWAP_PRE_EXECUTE_ERR,{error:t});return}r&&r.data&&(this.setConfigList(r.data),this.setInitLoading(!1))};te(this),this.tradeScene=0,this.presetStorageKey=Z}get computedConfig(){return this.configList.find(t=>Pe(t.chainId)===this.currentChainID&&t.sceneType===this.tradeScene)}get computedNativeTokenInfo(){return u(this.computedConfig,"nativeTokenInfo",{})}};n();a();b();n();a();b();n();a();var ye=class{constructor(){this.needOrderConfirm=!0;this.isOpen=!1;this.open=()=>{this.isOpen=!0};this.close=async()=>{this.isOpen=!1,this.handleReject&&this.handleReject(),this.handleResolve=null,this.handleReject=null};this.confirm=async()=>{this.isOpen=!1,this.handleResolve&&this.handleResolve(),this.handleResolve=null,this.handleReject=null};this.setNeedOrderConfirm=e=>{this.needOrderConfirm=e};this.quoteData={};this.cacheQuoteData=null;this.needUpdata=!1;this.updateQuoteData=e=>{if(this.cacheQuoteData){if(this.cacheQuoteData.toAmount===e.toAmount)return;this.needUpdata=!0,this.cacheQuoteData=e;return}this.quoteData=e,this.cacheQuoteData=e};this.update=()=>{this.quoteData=this.cacheQuoteData,this.needUpdata=!1};this.handleResolve=null;this.handleReject=null;I(this)}},Ae=new ye;var he=class{constructor(){this.QUOTE_TIMEOUT=5e3;this.quoteLoading=!1;this.quoteData=he.INIT_QUOTE_DATA;this.resetQuote=()=>{this.cleanQuoteTimer(),this.cacheParams=null,this.setQuoteData(he.INIT_QUOTE_DATA)};this.isAutoQuote=!1;this.cancelRef=null;this.initLoading=!0;this.timerRef=null;this.cacheParams=null;this.startingPoll=async(e,t)=>{if(this.cacheParams=e,this.timerRef&&clearTimeout(this.timerRef),!this.isQuoteImmediate(this.cacheParams||{})){this.setIsInitLoading(!1),this.resetQuote();return}await this.fetchQuoteAction(this.cacheParams,t),clearTimeout(this.timerRef),this.timerRef=setTimeout(async()=>{this.setIsAutoQuote(!0),await this.startingPoll(this.cacheParams,t)},this.QUOTE_TIMEOUT)};this.fetchQuote=De(this.startingPoll,qe)}setQuoteLoading(e){this.quoteLoading=e}setQuoteData(e){this.quoteData=e}setIsAutoQuote(e){this.isAutoQuote=e}cleanQuoteTimer(){this.cancelRef&&(this.cancelRef.abort(),this.cancelRef=null),this.timerRef&&clearTimeout(this.timerRef)}setIsInitLoading(e){this.initLoading=e}quoteStart(){this.setQuoteLoading(!0),this.cleanQuoteTimer()}quoteEnd(){this.setIsInitLoading(!1),this.setQuoteLoading(!1),this.setIsAutoQuote(!1)}getQuoteUrl(){return et}async fetchQuoteAction(e,t){this.quoteStart(),this.cancelRef=O();let[r,s]=await M(L.get(this.getQuoteUrl(),{params:e,signal:this.cancelRef.signal}));if(!F(r)&&r){let i=r||{};Ae.isOpen&&Ae?.close(),this.setQuoteData(i)}else this.setQuoteData(s||{}),t?.(s);this.quoteEnd()}isQuoteImmediate(e){return!!e?.chainId&&!!e?.fromTokenAddress&&!!e?.toTokenAddress&&new E.BigNumber(e?.amount).gt(0)}get computedQuoteCompleted(){return this.quoteData.error_code}get computedQuoteSuccuss(){return this.quoteData.error_code==="0"}get computedQuoteIsError(){return this.computedQuoteCompleted&&this.computedQuoteCompleted!=="0"&&this.computedQuoteCompleted!==Ke}get computedQuoteErrorMsg(){return u(this.quoteData,"error_message","")}get computedCustomQuoteLoading(){return!this.isAutoQuote&&this.quoteLoading}get computedQuoteNetworkError(){return this.quoteData.status==="ERR_NETWORK"}get computedQuoteIsBuyHoneypot(){return this.computedQuoteCompleted&&u(this.quoteData,"error_code")===We}get computedQuoteIsSellHoneypot(){return this.computedQuoteCompleted&&u(this.quoteData,"data.limitOrderInfo.code")===J}get computedQuoteIsBlackAddress(){return this.computedQuoteCompleted&&u(this.quoteData,"error_code")===Ge}get computedQuoteIsNewAddress(){return this.computedQuoteCompleted&&u(this.quoteData,"error_code")===He}},K=he;K.INIT_QUOTE_DATA={data:null,detailMsg:"",error_code:"",error_message:"",msg:"",status:""};var Se=class extends K{constructor(){super(),te(this)}getQuoteUrl(){return Ze}get jitoIsSuccess(){return u(this.quoteData,"data.memeModeCommonDexInfo.enableJito",!1)}get computedPriorityFeeInfo(){let e=u(this.quoteData,"data.memeModeCommonDexInfo.nonMevPriorityFeeInfo")??{};return{mevPriorityFeeInfo:u(this.quoteData,"data.memeModeCommonDexInfo.mevList[0]")??{},nonMevPriorityFeeInfo:e}}get computedFromTokenValue(){return u(this.quoteData,"data.memeModeCommonDexInfo.fromTokenPrice","0")}get computedToTokenAmount(){return u(this.quoteData,"data.memeModeSingleChainSwapInfo.receiveAmount","0")}get computedToTokenValue(){return u(this.quoteData,"data.memeModeSingleChainSwapInfo.toTokenPrice","0")}get quoteNetWorkFeeOfMoney(){return u(this.quoteData,"data.memeModeSingleChainSwapInfo.quoteNetWorkFeeOfMoney","")}get computedQuoteLiquidityError(){return this.computedQuoteCompleted&&!u(this.quoteData,"data.memeModeSingleChainSwapInfo")}get computedSwapOnOtherDapp(){let e=String(u(this.quoteData,"data.memeModeCommonDexInfo.isSupportDappTrade"))==="1";return this.computedQuoteCompleted&&e}get computedQuoteSafemoon(){if(this.computedQuoteCompleted){let e=u(this.quoteData,"data.memeModeCommonDexInfo.fromToken",{}),t=u(this.quoteData,"data.memeModeCommonDexInfo.toToken",{});if(Ie(e))return e?.tokenSymbol;if(Ie(t))return t?.tokenSymbol}return""}get computedGetRouterList(){return u(this.quoteData,"data.memeModeSingleChainSwapInfo.dexRouterList")}get computedGetEstimateGasFee(){return u(this.quoteData,"data.memeModeSingleChainSwapInfo.estimateGasFee")}get computedGetQuoteFrom(){return u(this.quoteData,"data.memeModeCommonDexInfo.fromToken",{})||{}}get computedGetQuoteTo(){return u(this.quoteData,"data.memeModeCommonDexInfo.toToken",{})||{}}get computedGetQuoteFromAmount(){return u(this.quoteData,"data.memeModeCommonDexInfo.fromTokenAmount")}get computedGetQuoteFromPrice(){return u(this.quoteData,"data.memeModeCommonDexInfo.fromTokenPrice")}get computedGetQuoteFromSinglePrice(){return Me.div(this.computedGetQuoteFromPrice,this.computedGetQuoteFromAmount).toString()}get computedGetQuoteToAmount(){return u(this.quoteData,"data.memeModeSingleChainSwapInfo.receiveAmount")}get computedGetQuoteToPrice(){return u(this.quoteData,"data.memeModeSingleChainSwapInfo.toTokenPrice")}get computedGetQuoteToSinglePrice(){return Me.div(this.computedGetQuoteToPrice,this.computedGetQuoteToAmount).toString()}get computedQuoteTraceData(){return u(this.quoteData,"data.traceData")}get computedGetQuoteTokenTax(){return u(this.quoteData,"data.memeModeCommonDexInfo.tokenTax","")}get computedQuoteIsInvalid(){return this.computedQuoteIsError||this.computedQuoteNetworkError||this.computedQuoteLiquidityError}get computedServiceFeeInfo(){return u(this.quoteData,"data.memeModeCommonDexInfo.serviceFeeInfo",{})}get computedAutoSlippage(){return u(this.quoteData,"data.memeModeSingleChainSwapInfo.autoSlippageInfo.referenceSlippage","")||u(this.quoteData,"data.memeModeSingleChainSwapInfo.autoSlippageInfo.autoSlippage","")}get mevUnstableShowLevel(){return u(this.quoteData,"data.memeModeCommonDexInfo.mevUnstableShowLevel",-1)}get solPrice(){return u(this.quoteData,"data.memeModeCommonDexInfo.nativeTokenPrice",0)}get quoteDiffValThreshold(){return u(this.quoteData,"data.memeModeSingleChainSwapInfo.quoteDiffValThreshold")}get quoteDiffPercentThreshold(){return u(this.quoteData,"data.memeModeSingleChainSwapInfo.quoteDiffPercentThreshold")}get computedValueDifference(){return ht({pay:this.computedFromTokenValue,receive:this.computedToTokenValue,quoteDiffValThreshold:this.quoteDiffValThreshold,quoteDiffPercentThreshold:this.quoteDiffPercentThreshold})}get computedQuoteIsSellHoneypot(){return this.computedQuoteCompleted&&u(this.quoteData,"data.memeModeCommonDexInfo.code")===J}};n();a();b();var ge=class{constructor(){this.isSwapLoading=!1;this.cacheVerifyCallDataResult=null;this.setCacheVerifyCallDataResult=e=>{this.cacheVerifyCallDataResult=e};this.checkCallData=async({chainId:e,responseData:t,requestParams:r,accountId:s,signWalletAddress:i})=>{let m=await it({callData:t?.callData?.data,chainId:e,hasReferralCommission:t?.hasReferralCommission,address:i});return m.success||this.setCacheVerifyCallDataResult({...m,walletId:s,requestCommissionAddress:r?.serviceFeeInfo?.referralCommissionAddress}),m};this.logVerifyCallDataResult=({txHash:e,orderId:t})=>{this.cacheVerifyCallDataResult&&!this.cacheVerifyCallDataResult.success&&(at({...this.cacheVerifyCallDataResult,txHash:e,orderId:t}),this.setCacheVerifyCallDataResult(null))};I(this,{},{autoBind:!0})}setIsSwapLoading(e){this.isSwapLoading=e}getSolanaUnsignedTx(e){let t=u(e,"calldataParams.enableJito"),r=e?.unsignedTx||"{}";try{return t?JSON.parse(r).array:[JSON.parse(r)]}catch(s){throw new Error(s)}}getJitoTxData(e){let t=new Tt,r=this.getSolanaUnsignedTx(e);return Promise.all(r.map(t.txData))}async onSolanaSwap({data:e,signedTransactions:t,txArray:r}){try{let s=u(e,"calldataParams.enableJito"),i=await gt({walletId:e.walletId,swapParams:e.calldataParams,signedTransactions:t,txArray:r,enableJito:s,isMemeMode:!0,orderId:e?.originData?.orderId});if(k.info(Q.MEME_SWAP_BROADCAST_PARAMS,{data:{...e,solanaBroadcastParams:i,unsignedTxArray:r,signedTransactions:t}}),!Ve()){let l=i?.dexMultiMetaSaveOrderParam?.chainId;rt({chain_id:l,chain_name:be.chainInfo?.[l]||"",tx_hash:i?.updateMultiOrderInfo?.transactionHash,trade_mode:st.MEME,terminal:nt.WEB})}let[m,c]=await M(Et(i));if(m){this.broadcastError(m,{...e,solanaBroadcastParams:i,unsignedTxArray:r,signedTransactions:t,broadcastRes:c,tags:{userWalletAddress:e.userWalletAddress}});return}return k.info(Q.MEME_SWAP_BROADCAST_SUCCESS,{data:{...e,solanaBroadcastParams:i,unsignedTxArray:r,signedTransactions:t,broadcastRes:c}}),this.logVerifyCallDataResult({txHash:c?.data?.broadcastResult?.data?.transactionHash,orderId:c?.data?.broadcastResult?.data?.orderId}),c}catch(s){throw this.broadcastError(s,{...e,unsignedTxArray:r,signedTransactions:t}),new Error(s?.error_message)}}broadcastError(e,t){Ce.error({title:e?.error_message||tt("swaptrade_home_toast_broadcast_failed"),placement:Ce.DIRECTION.top}),k.error(Q.MEME_SWAP_BROADCAST_ERROR,{error:e,...t})}};var R=class{constructor(){this.reset=()=>{this.commonStore=new pt(this),this.accountStore=new ft(this),this.sendTransactionStore=new St,this.configStore=new pe,this.buyStore=new ue,this.sellStore=new de,this.memePositionStore=new ce,this.quoteStore=new Se,this.memeTokenListStore=new le,this.memeSwapStore=new ge};this.reset()}static getInstance(){return R.instance||(R.instance=new R),R.instance}},lo=R;var No=({localeData:o,...e})=>(yt(),Te.default.createElement(lt,{localeData:o,isDev:!0,noRemoteData:!0,customRender:t=>t},Te.default.createElement(Pt.Provider,{value:lo.getInstance()},Te.default.createElement(co,{...e})))),wi=D(No);export{wi as default};
//# sourceMappingURL=MemeMode-JBOKL3CM.js.map
