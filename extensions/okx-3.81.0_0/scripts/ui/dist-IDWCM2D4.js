import{a as Vo}from"./chunk-76PX7FQZ.js";import"./chunk-4RX5BQ36.js";import{a as ni}from"./chunk-DJSNVDZI.js";import{a as Ko}from"./chunk-UHUR45QP.js";import"./chunk-5F7M5EJ4.js";import{b as Ue,d as Re}from"./chunk-SLQQVCPY.js";import"./chunk-ZRVP4J67.js";import"./chunk-YSKQ76UN.js";import"./chunk-A3W4ZDEQ.js";import"./chunk-VBZ4JSJ6.js";import{a as Mo}from"./chunk-LBYXY63E.js";import"./chunk-M4ANCDMF.js";import"./chunk-J6KTJ3IN.js";import"./chunk-5CQODPK7.js";import"./chunk-C5XO4JMZ.js";import"./chunk-HI3LE734.js";import"./chunk-RX4V72AK.js";import{b as Xr,c as $,d as ri,g as lt,o as j,p as L,q as M}from"./chunk-Y5OH3DDZ.js";var Jr=$(z=>{j();M();Object.defineProperty(z,"__esModule",{value:!0});z.estimateFee=z.validSignedTransaction=z.getRawTransaction=z.hardwareDerivePubKey=z.calcTxHash=z.getHardWareMessageHash=z.getHardWareSignedTransaction=z.getHardWareRawTransaction=z.getMPCSignedMessage=z.getMPCRawMessage=z.getMPCTransaction=z.getMPCRawTransaction=z.getAddressByPublicKey=z.getDerivedPath=z.signTransaction=z.ecRecover=z.verifyMessage=z.signMessage=z.validPrivateKey=z.validAddress=z.getNewAddress=z.getDerivedPrivateKey=z.getRandomPrivateKey=z.getMnemonic=z.unRegister=z.register=void 0;var ce=Re(),ps=Ue(),ve=new Map;function qo(e,t){ve.set(e,t)}z.register=qo;function Lo(e,t){ve.delete(e)}z.unRegister=Lo;async function ko(e){try{let t=ps.bip39.generateMnemonic(e);return Promise.resolve(t)}catch{return Promise.reject(ce.GenMnemonicError)}}z.getMnemonic=ko;async function Uo(e){let t=ve.get(e);return t!=null?await t.getRandomPrivateKey():Promise.reject(ce.NotImplementedError)}z.getRandomPrivateKey=Uo;async function Go(e,t){let r=ve.get(e);return r!=null?await r.getDerivedPrivateKey(t):Promise.reject(ce.NotImplementedError)}z.getDerivedPrivateKey=Go;async function zo(e,t){let r=ve.get(e);if(r!=null){if(!await r.validPrivateKey({privateKey:t.privateKey}))throw z.InvalidPrivateKeyError;return await r.getNewAddress(t)}return Promise.reject(ce.NotImplementedError)}z.getNewAddress=zo;async function Wo(e,t){let r=ve.get(e);return r!=null?await r.validAddress(t):Promise.reject(ce.NotImplementedError)}z.validAddress=Wo;async function Xo(e,t){let r=ve.get(e);return r!=null?await r.validPrivateKey(t):Promise.reject(ce.NotImplementedError)}z.validPrivateKey=Xo;async function Jo(e,t){let r=ve.get(e);return r!=null?await r.signMessage(t):Promise.reject(ce.NotImplementedError)}z.signMessage=Jo;async function $o(e,t){let r=ve.get(e);return r!=null?await r.verifyMessage(t):Promise.reject(ce.NotImplementedError)}z.verifyMessage=$o;async function Yo(e,t){let r=ve.get(e);if(r!=null){let n=t.signature,i=t.data;return await r.ecRecover(i,n)}return Promise.reject(ce.NotImplementedError)}z.ecRecover=Yo;async function Zo(e,t){let r=ve.get(e);return r!=null?await r.signTransaction(t):Promise.reject(ce.NotImplementedError)}z.signTransaction=Zo;async function Qo(e,t){let r=ve.get(e);return r!=null?await r.getDerivedPath(t):Promise.reject(ce.NotImplementedError)}z.getDerivedPath=Qo;async function eu(e,t){let r=ve.get(e);return r!=null?await r.getAddressByPublicKey(t):Promise.reject(ce.NotImplementedError)}z.getAddressByPublicKey=eu;async function tu(e,t){let r=ve.get(e);return r!=null?await r.getMPCRawTransaction(t):Promise.reject(ce.NotImplementedError)}z.getMPCRawTransaction=tu;async function ru(e,t){let r=ve.get(e);return r!=null?await r.getMPCTransaction(t):Promise.reject(ce.NotImplementedError)}z.getMPCTransaction=ru;async function nu(e,t){let r=ve.get(e);return r!=null?await r.getMPCRawMessage(t):Promise.reject(ce.NotImplementedError)}z.getMPCRawMessage=nu;async function iu(e,t){let r=ve.get(e);return r!=null?await r.getMPCSignedMessage(t):Promise.reject(ce.NotImplementedError)}z.getMPCSignedMessage=iu;async function su(e,t){let r=ve.get(e);return r!=null?await r.getHardWareRawTransaction(t):Promise.reject(ce.NotImplementedError)}z.getHardWareRawTransaction=su;async function au(e,t){let r=ve.get(e);return r!=null?await r.getHardWareSignedTransaction(t):Promise.reject(ce.NotImplementedError)}z.getHardWareSignedTransaction=au;async function ou(e,t){let r=ve.get(e);return r!=null?await r.getHardWareMessageHash(t):Promise.reject(ce.NotImplementedError)}z.getHardWareMessageHash=ou;async function uu(e,t){let r=ve.get(e);return r!=null?await r.calcTxHash(t):Promise.reject(ce.NotImplementedError)}z.calcTxHash=uu;async function cu(e,t){try{if(e.slice(0,4)!=="xpub"){let s=ce.base.fromBase58Check(e).slice(4);s=L.Buffer.concat([ce.base.fromHex("0488b21e"),s]),e=ce.base.toBase58Check(s)}let n=ps.bip32.fromBase58(e).derivePath(t);return Promise.resolve(ce.base.toHex(n.publicKey))}catch{return Promise.reject(ce.HardwareDerivePubKeyError)}}z.hardwareDerivePubKey=cu;async function hu(e,t){let r=ve.get(e);return r!=null?await r.getRawTransaction(t):Promise.reject(ce.NotImplementedError)}z.getRawTransaction=hu;async function fu(e,t){let r=ve.get(e);return r!=null?await r.validSignedTransaction(t):Promise.reject(ce.NotImplementedError)}z.validSignedTransaction=fu;async function lu(e,t){let r=ve.get(e);return r!=null?await r.estimateFee(t):Promise.reject(ce.NotImplementedError)}z.estimateFee=lu});function vs(e,t=!1,r=!0){let n="";return n=(i=>{let s=[];for(let a=0;a<i.length;a+=32768)s.push(String.fromCharCode.apply(null,i.subarray(a,a+32768)));return btoa(s.join(""))})(typeof e=="string"?new TextEncoder().encode(e):new Uint8Array(e)),t&&(n=function(i){return i.replace(/\+/g,"-").replace(/\//g,"_")}(n)),r||(n=n.replace(/=/g,"")),n}function ys(e,t=!1){{let r=!1;if(/^[0-9a-zA-Z_-]+={0,2}$/.test(e))r=!0;else if(!/^[0-9a-zA-Z+/]*={0,2}$/.test(e))throw new Error("Not a valid base64 input");r&&(e=e.replace(/-/g,"+").replace(/_/g,"/").replace(/=/g,""));let n=new Uint8Array(atob(e).split("").map(i=>i.charCodeAt(0)));return t?new TextDecoder().decode(n):n}}var ms=Xr(()=>{j();M()});var Pr={};ri(Pr,{base64ToBigint:()=>yu,bigintToBase64:()=>vu,bigintToBuf:()=>Ss,bigintToHex:()=>ws,bigintToText:()=>gu,bufToBigint:()=>xs,bufToHex:()=>As,bufToText:()=>bs,hexToBigint:()=>Es,hexToBuf:()=>ii,parseHex:()=>Qt,textToBigint:()=>pu,textToBuf:()=>Ps});function Qt(e,t=!1,r){let n=e.match(/^(0x)?([\da-fA-F]+)$/);if(n==null)throw new RangeError("input must be a hexadecimal string, e.g. '0x124fe3a' or '0214f1b2'");let i=n[2];if(r!==void 0){if(r<i.length/2)throw new RangeError(`expected byte length ${r} < input hex byte length ${Math.ceil(i.length/2)}`);i=i.padStart(2*r,"0")}return t?"0x"+i:i}function Ss(e,t=!1){if(e<0)throw RangeError("a should be a non-negative integer. Negative values are not supported");return ii(ws(e),t)}function xs(e){let t=8n;ArrayBuffer.isView(e)?t=BigInt(8*e.BYTES_PER_ELEMENT):e=new Uint8Array(e);let r=0n;for(let n of e.values())r=(r<<t)+BigInt(n);return r}function ws(e,t=!1,r){if(e<0)throw RangeError("a should be a non-negative integer. Negative values are not supported");return Qt(e.toString(16),t,r)}function Es(e){return BigInt(Qt(e,!0))}function gu(e){if(e<0)throw RangeError("a should be a non-negative integer. Negative values are not supported");return bs(ii(e.toString(16)))}function pu(e){return Es(As(Ps(e)))}function bs(e){return new TextDecoder().decode(new Uint8Array(e))}function Ps(e,t=!1){return new TextEncoder().encode(e).buffer}function As(e,t=!1,r){{let n="",i="0123456789abcdef";return(e=ArrayBuffer.isView(e)?new Uint8Array(e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)):new Uint8Array(e)).forEach(s=>{n+=i[s>>4]+i[15&s]}),Qt(n,t,r)}}function ii(e,t=!1){let r=Qt(e);return r=Qt(e,!1,Math.ceil(r.length/2)),Uint8Array.from(r.match(/[\da-fA-F]{2}/g).map(n=>parseInt(n,16))).buffer}function vu(e,t=!1,r=!0){return vs(Ss(e),t,r)}function yu(e){return xs(ys(e))}var Ar=Xr(()=>{j();M();ms()});var Qr={};ri(Qr,{abs:()=>kt,bitLength:()=>ai,crt:()=>Fs,eGcd:()=>$r,gcd:()=>Cs,isProbablyPrime:()=>si,lcm:()=>mu,max:()=>Su,min:()=>xu,modAdd:()=>wu,modInv:()=>Fr,modMultiply:()=>Eu,modPow:()=>Ut,phi:()=>Is,prime:()=>bu,primeSync:()=>Pu,randBetween:()=>Zr,randBits:()=>Rs,randBitsSync:()=>Gt,randBytes:()=>Ds,randBytesSync:()=>Yr,toZn:()=>Pt});function kt(e){return e>=0?e:-e}function ai(e){if(typeof e=="number"&&(e=BigInt(e)),e===1n)return 1;let t=1;do t++;while((e>>=1n)>1n);return t}function $r(e,t){if(typeof e=="number"&&(e=BigInt(e)),typeof t=="number"&&(t=BigInt(t)),e<=0n||t<=0n)throw new RangeError("a and b MUST be > 0");let r=0n,n=1n,i=1n,s=0n;for(;e!==0n;){let a=t/e,o=t%e,f=r-i*a,d=n-s*a;t=e,e=o,r=i,n=s,i=f,s=d}return{g:t,x:r,y:n}}function Pt(e,t){if(typeof e=="number"&&(e=BigInt(e)),typeof t=="number"&&(t=BigInt(t)),t<=0n)throw new RangeError("n must be > 0");let r=e%t;return r<0n?r+t:r}function Fr(e,t){let r=$r(Pt(e,t),t);if(r.g!==1n)throw new RangeError(`${e.toString()} does not have inverse modulo ${t.toString()}`);return Pt(r.x,t)}function Fs(e,t,r){if(e.length!==t.length)throw new RangeError("The remainders and modulos arrays should have the same length");let n=r??t.reduce((i,s)=>i*s,1n);return t.reduce((i,s,a)=>{let o=n/s;return Pt(i+o*Fr(o,s)%n*e[a]%n,n)},0n)}function Cs(e,t){let r=typeof e=="number"?BigInt(kt(e)):kt(e),n=typeof t=="number"?BigInt(kt(t)):kt(t);if(r===0n)return n;if(n===0n)return r;let i=0n;for(;(1n&(r|n))===0n;)r>>=1n,n>>=1n,i++;for(;(1n&r)===0n;)r>>=1n;do{for(;(1n&n)===0n;)n>>=1n;if(r>n){let s=r;r=n,n=s}n-=r}while(n!==0n);return r<<i}function mu(e,t){return typeof e=="number"&&(e=BigInt(e)),typeof t=="number"&&(t=BigInt(t)),e===0n&&t===0n?BigInt(0):kt(e/Cs(e,t)*t)}function Su(e,t){return e>=t?e:t}function xu(e,t){return e>=t?t:e}function wu(e,t){let r=BigInt(t);return Pt(e.map(n=>BigInt(n)%r).reduce((n,i)=>n+i%r,0n),r)}function Eu(e,t){let r=BigInt(t);return Pt(e.map(n=>BigInt(n)%r).reduce((n,i)=>n*i%r,1n),r)}function Is(e){return e.map(t=>t[0]**(t[1]-1n)*(t[0]-1n)).reduce((t,r)=>r*t,1n)}function Ut(e,t,r,n){if(typeof e=="number"&&(e=BigInt(e)),typeof t=="number"&&(t=BigInt(t)),typeof r=="number"&&(r=BigInt(r)),r<=0n)throw new RangeError("n must be > 0");if(r===1n)return 0n;if(e=Pt(e,r),t<0n)return Fr(Ut(e,kt(t),r,n),r);if(n!==void 0)return function(s,a,o,f){let d=f.map(h=>h[0]**h[1]),m=f.map(h=>Is([h])),p=m.map((h,c)=>Ut(s,a%h,d[c]));return Fs(p,d,o)}(e,t,r,function(s){let a={};return s.forEach(o=>{if(typeof o=="bigint"||typeof o=="number"){let f=String(o);a[f]===void 0?a[f]={p:BigInt(o),k:1n}:a[f].k+=1n}else{let f=String(o[0]);a[f]===void 0?a[f]={p:BigInt(o[0]),k:BigInt(o[1])}:a[f].k+=BigInt(o[1])}}),Object.values(a).map(o=>[o.p,o.k])}(n));let i=1n;for(;t>0;)t%2n===1n&&(i=i*e%r),t/=2n,e=e**2n%r;return i}function er(e){let t=0n;for(let r of e.values())t=(t<<8n)+BigInt(r);return t}function Ds(e,t=!1){if(e<1)throw new RangeError("byteLength MUST be > 0");return new Promise(function(r,n){{let i=new Uint8Array(e);if(e<=65536)self.crypto.getRandomValues(i);else for(let s=0;s<Math.ceil(e/65536);s++){let a=65536*s,o=a+65535<e?a+65535:e-1;self.crypto.getRandomValues(i.subarray(a,o))}t&&(i[0]=128|i[0]),r(i)}})}function Yr(e,t=!1){if(e<1)throw new RangeError("byteLength MUST be > 0");{let r=new Uint8Array(e);if(e<=65536)self.crypto.getRandomValues(r);else for(let n=0;n<Math.ceil(e/65536);n++){let i=65536*n,s=i+65535<e?i+65535:e-1;self.crypto.getRandomValues(r.subarray(i,s))}return t&&(r[0]=128|r[0]),r}}function Rs(e,t=!1){if(e<1)throw new RangeError("bitLength MUST be > 0");let r=Math.ceil(e/8),n=e%8;return new Promise((i,s)=>{Ds(r,!1).then(function(a){if(n!==0&&(a[0]=a[0]&2**n-1),t){let o=n!==0?2**(n-1):128;a[0]=a[0]|o}i(a)})})}function Gt(e,t=!1){if(e<1)throw new RangeError("bitLength MUST be > 0");let r=Yr(Math.ceil(e/8),!1),n=e%8;if(n!==0&&(r[0]=r[0]&2**n-1),t){let i=n!==0?2**(n-1):128;r[0]=r[0]|i}return r}function Zr(e,t=1n){if(e<=t)throw new RangeError("Arguments MUST be: max > min");let r=e-t,n=ai(r),i;do i=er(Gt(n));while(i>r);return i+t}function si(e,t=16,r=!1){if(typeof e=="number"&&(e=BigInt(e)),e<0n)throw RangeError("w MUST be >= 0");return new Promise((n,i)=>{let s=new Worker(_s());s.onmessage=o=>{o?.data?._bcu?.isPrime!==void 0&&(s.terminate(),n(o.data._bcu.isPrime))},s.onmessageerror=o=>{i(o)};let a={_bcu:{rnd:e,iterations:t,id:0}};s.postMessage(a)})}function oi(e,t){if(e===2n)return!0;if((1n&e)===0n||e===1n)return!1;let r=[3n,5n,7n,11n,13n,17n,19n,23n,29n,31n,37n,41n,43n,47n,53n,59n,61n,67n,71n,73n,79n,83n,89n,97n,101n,103n,107n,109n,113n,127n,131n,137n,139n,149n,151n,157n,163n,167n,173n,179n,181n,191n,193n,197n,199n,211n,223n,227n,229n,233n,239n,241n,251n,257n,263n,269n,271n,277n,281n,283n,293n,307n,311n,313n,317n,331n,337n,347n,349n,353n,359n,367n,373n,379n,383n,389n,397n,401n,409n,419n,421n,431n,433n,439n,443n,449n,457n,461n,463n,467n,479n,487n,491n,499n,503n,509n,521n,523n,541n,547n,557n,563n,569n,571n,577n,587n,593n,599n,601n,607n,613n,617n,619n,631n,641n,643n,647n,653n,659n,661n,673n,677n,683n,691n,701n,709n,719n,727n,733n,739n,743n,751n,757n,761n,769n,773n,787n,797n,809n,811n,821n,823n,827n,829n,839n,853n,857n,859n,863n,877n,881n,883n,887n,907n,911n,919n,929n,937n,941n,947n,953n,967n,971n,977n,983n,991n,997n,1009n,1013n,1019n,1021n,1031n,1033n,1039n,1049n,1051n,1061n,1063n,1069n,1087n,1091n,1093n,1097n,1103n,1109n,1117n,1123n,1129n,1151n,1153n,1163n,1171n,1181n,1187n,1193n,1201n,1213n,1217n,1223n,1229n,1231n,1237n,1249n,1259n,1277n,1279n,1283n,1289n,1291n,1297n,1301n,1303n,1307n,1319n,1321n,1327n,1361n,1367n,1373n,1381n,1399n,1409n,1423n,1427n,1429n,1433n,1439n,1447n,1451n,1453n,1459n,1471n,1481n,1483n,1487n,1489n,1493n,1499n,1511n,1523n,1531n,1543n,1549n,1553n,1559n,1567n,1571n,1579n,1583n,1597n];for(let o=0;o<r.length&&r[o]<=e;o++){let f=r[o];if(e===f)return!0;if(e%f===0n)return!1}let n=0n,i=e-1n,s=i;for(;s%2n===0n;)s/=2n,++n;let a=i/2n**n;do{let o=Ut(Zr(i,2n),a,e);if(o===1n||o===i)continue;let f=1;for(;f<n&&(o=Ut(o,2n,e),o!==i);){if(o===1n)return!1;f++}if(o!==i)return!1}while(--t!=0);return!0}function _s(){let e=`
  'use strict';
  const ${$r.name} = ${$r.toString()};
  const ${Fr.name} = ${Fr.toString()};
  const ${Ut.name} = ${Ut.toString()};
  const ${Pt.name} = ${Pt.toString()};
  const ${Gt.name} = ${Gt.toString()};
  const ${Yr.name} = ${Yr.toString()};
  const ${Zr.name} = ${Zr.toString()};
  const ${si.name} = ${oi.toString()};
  ${ai.toString()};
  ${er.toString()};`;return e+=`
  onmessage = async function(msg) {
    if (msg !== undefined && msg.data !== undefined && msg.data._bcu !== undefined && msg.data._bcu.id !== undefined && msg.data._bcu.iterations !== undefined && msg.data._bcu.rnd !== undefined) {
      const msgToParent = {
        _bcu: {
          isPrime: await ${si.name}(msg.data._bcu.rnd, msg.data._bcu.iterations),
          value: msg.data._bcu.rnd,
          id: msg.data._bcu.id
        }
      };
      postMessage(msgToParent);
    }
  }`,function(t){t=`(() => {${t}})()`;let r=new Blob([t],{type:"text/javascript"});return window.URL.createObjectURL(r)}(e)}function bu(e,t=16){if(e<1)throw new RangeError("bitLength MUST be > 0");if(!Bs){let r=0n;do r=er(Gt(e,!0));while(!oi(r,t));return new Promise(n=>{n(r)})}return new Promise((r,n)=>{let i=[],s=(a,o)=>{if(a._bcu.isPrime){for(let f=0;f<i.length;f++)i[f].terminate();for(;i.length>0;)i.pop();r(a._bcu.value)}else{let f=er(Gt(e,!0));try{let d={_bcu:{rnd:f,iterations:t,id:a._bcu.id}};o.postMessage(d)}catch{}}};{let a=_s();for(let o=0;o<self.navigator.hardwareConcurrency-1;o++){let f=new Worker(a);f.onmessage=d=>s(d.data,f),i.push(f)}}for(let a=0;a<i.length;a++)Rs(e,!0).then(function(o){let f=er(o);i[a].postMessage({_bcu:{rnd:f,iterations:t,id:a}})}).catch(n)})}function Pu(e,t=16){if(e<1)throw new RangeError("bitLength MUST be > 0");let r=0n;do r=er(Gt(e,!0));while(!oi(r,t));return r}var Bs,en=Xr(()=>{j();M();Bs=!1;self.Worker!==void 0&&(Bs=!0)});var $e=$(Se=>{j();M();var Au=Se&&Se.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Fu=Se&&Se.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Cu=Se&&Se.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Au(t,e,r);return Fu(t,e),t};Object.defineProperty(Se,"__esModule",{value:!0});Se.cvtBigintToUint8arrayNoPadding=Se.cvtBigintToUint8array=Se.cvtUint8arrayToBigint=Se.randomSafePrime=Se.RandomNum=Se.HmacSHA512Int=Se.SHA256Int=void 0;var Iu=(Ar(),lt(Pr)),tn=(en(),lt(Qr)),Ns=Re(),ui=Cu(ni());function Du(e){let t=Ns.base.sha256.create();for(let r of e){if(r<BigInt(0))throw new Error(`Cannot convert negative bigint to buffer. Given: ${r}`);let n=r.toString(16);n.length%2&&(n="0"+n),t.update(L.Buffer.from(n,"hex"))}return(0,Iu.bufToBigint)(t.digest())}Se.SHA256Int=Du;function Ru(e){return e.length%2!==0&&(e="0"+e),e}function Bu(e){let n=e.map(s=>Ru(new Ns.BN(s.toString()).toString(16))).map(s=>ui.enc.Hex.parse(s)).reduce((s,a)=>s.concat(a)),i=ui.HmacSHA512(n,"");return BigInt(`0x${ui.enc.Hex.stringify(i)}`)}Se.HmacSHA512Int=Bu;function _u(e){let t=BigInt(1),r=BigInt(2);if(e<=r)throw new Error("max has to be greater than two");return(0,tn.randBetween)(e-t,r)}Se.RandomNum=_u;async function Nu(e){let t=8*e-1;for(;;){let r=await(0,tn.prime)(t);for(;r<BigInt(3)<<BigInt(t-2);)r=await(0,tn.prime)(t);let n=2n*r+1n;if(await(0,tn.isProbablyPrime)(n))return n}}Se.randomSafePrime=Nu;function Tu(e){let t=BigInt(0);for(let r=0;r<e.length;r++)t=t*BigInt(256)+BigInt(e[r]);return t}Se.cvtUint8arrayToBigint=Tu;function Ou(e){let t=new Uint8Array(32),r=t.length-1;for(;e>0&&r>=0;)t[r]=Number(e%BigInt(256)),e=e/BigInt(256),r--;return t}Se.cvtBigintToUint8array=Ou;function Hu(e){let t=[];for(;e>0n;){let n=Number(e%256n);t.push(n),e/=256n}return new Uint8Array(t).reverse()}Se.cvtBigintToUint8arrayNoPadding=Hu});var Ts=$(Cr=>{j();M();Object.defineProperty(Cr,"__esModule",{value:!0});Cr.Commitment=void 0;var ci=$e(),ju;(function(e){function t(i){let s=(0,ci.RandomNum)(2n**256n);return i.unshift(s),{C:(0,ci.HmacSHA512Int)(i.slice()),Msg:i}}e.NewCommitment=t;function r(i){return n(i)?i.Msg.slice(1):null}e.Open=r;function n(i){let s=(0,ci.HmacSHA512Int)(i.Msg);return i.C==s}e.Verify=n})(ju=Cr.Commitment||(Cr.Commitment={}))});var dt=$(re=>{j();M();Object.defineProperty(re,"__esModule",{value:!0});re.GenRSAKeyPairError=re.DecodeRsaPublicKeyError=re.DecodeRSAPrivateKeyError=re.RSADecodeError=re.RSAEncodeError=re.AESDecryptError=re.AESEncryptError=re.Bip32DeriveError=re.Bip32NewChildKeyError=re.CommitmentDeCommitfail=re.SchnorrVerifyFail=re.SchnorrVerifyError=re.SchnorrProveError=re.CreatPailKeyError=re.MPCError=void 0;var hi=class extends Error{constructor(t,r){super(r.toString()),this.name=t}};re.MPCError=hi;var Mu="create paillier key error";re.CreatPailKeyError=Mu;var Ku="schnorr prove error";re.SchnorrProveError=Ku;var Vu="schnorr verify error";re.SchnorrVerifyError=Vu;var qu="schnorr verify fail";re.SchnorrVerifyFail=qu;var Lu="commitment DeCommit fail";re.CommitmentDeCommitfail=Lu;var ku="bip32 new child key error";re.Bip32NewChildKeyError=ku;var Uu="bip32 derive error";re.Bip32DeriveError=Uu;var Gu="aes encrypt error";re.AESEncryptError=Gu;var zu="aes decrypt error";re.AESDecryptError=zu;var Wu="rsa encode error";re.RSAEncodeError=Wu;var Xu="rsa decode error";re.RSADecodeError=Xu;var Ju="decode rsa private key error";re.DecodeRSAPrivateKeyError=Ju;var $u="decode rsa public key error";re.DecodeRsaPublicKeyError=$u;var Yu="gen rsa key pair error";re.GenRSAKeyPairError=Yu});var js=$(Ot=>{j();M();Object.defineProperty(Ot,"__esModule",{value:!0});Ot.createPailKeyPair=Ot.PailPrivKey=Ot.PailPubKey=void 0;var fi=$e(),Zu=(en(),lt(Qr)),gt=Re(),Os=dt(),rn=class{constructor(t){this.n=t}n2(){return this.n.sqr()}g(){return this.n.addn(1)}encryptWithR(t,r){let n=this.n2(),i=gt.BN.red(n),s=r.toRed(i),a=this.n.toRed(i).redMul(t.toRed(i)).addn(1),o=s.redPow(this.n);return a.redMul(o).fromRed()}encrypt(t){let r=BigInt(this.n.toString());for(;;){let n=new gt.BN((0,fi.RandomNum)(r).toString());if(n.gcd(this.n).eqn(1))return this.encryptWithR(t,n)}}HomoAdd(t,r){let n=gt.BN.red(this.n2());return t.toRed(n).redMul(r.toRed(n)).fromRed()}homomorphicAddPlain(t,r){let n=gt.BN.red(this.n2()),i=this.n.toRed(n).redMul(r.toRed(n)).addn(1);return t.toRed(n).redMul(i).fromRed()}homomorphicMulPlain(t,r){let n=gt.BN.red(this.n2());return t.toRed(n).redPow(r).fromRed()}};Ot.PailPubKey=rn;var nn=class{constructor(t,r){this.lambda=t,this.pailPubKey=r}decrypt(t){let r=this.pailPubKey.n2(),n=this.pailPubKey.n,i=this.pailPubKey.g(),s=t.toRed(gt.BN.red(r)).redPow(this.lambda),a=Hs(s.fromRed(),n),o=i.toRed(gt.BN.red(r)).redPow(this.lambda),d=Hs(o.fromRed(),n).toRed(gt.BN.red(n)).redInvm();return a.mul(d).mod(n)}};Ot.PailPrivKey=nn;function Hs(e,t){return e.subn(1).div(t)}async function Qu(e){try{let t=0n,r=0n;for(;t==r;)t=await(0,fi.randomSafePrime)(e/2),r=await(0,fi.randomSafePrime)(e/2);if(t<r){let m=t;t=r,r=m}let n=t*r,i=t-1n,s=r-1n,a=i*s,o=(0,Zu.eGcd)(i,s).g,f=a/o,d=new rn(new gt.BN(n.toString()));return[new nn(new gt.BN(f.toString()),d),d]}catch(t){return Promise.reject(new Os.MPCError(Os.CreatPailKeyError,t))}}Ot.createPailKeyPair=Qu});var li=$(at=>{j();M();var ec=at&&at.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),tc=at&&at.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),rc=at&&at.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&ec(t,e,r);return tc(t,e),t};Object.defineProperty(at,"__esModule",{value:!0});at.polynomial=void 0;var Ms=rc((en(),lt(Qr))),nc;(function(e){async function t(s,a,o){let f=new Array(o+1);f[0]=a;for(let d=1;d<=o;d++){let m=await Ms.prime(s.toString(2).length);f[d]=m}return{coefficients:f,qMod:s}}e.initPolynomial=t;function r(s,a){let o=s.coefficients[0],f=0n;for(let m=1;m<s.coefficients.length;m++){f*=a;let p=f*s.coefficients[m];o+=p}let d=s.qMod;return o=(o%d+d)%d,{id:a,y:o}}e.evaluatePolynomial=r;function n(s,a){let o=new Array(a.length);for(let d in a)o[d]=a[d].id;let f=0n;for(let d of a){let m=i(s,d.id,d.y,o);f+=m}return f=(f%s+s)%s,f}e.recoverSecret=n;function i(s,a,o,f){let d=o;for(let m=0;m<f.length;m++){let p=f[m];if(p===a)continue;let h=p-a;h=Ms.modInv(h,s),h*=p,d*=h}return d=(d%s+s)%s,d}e.calLagrangian=i})(nc=at.polynomial||(at.polynomial={}))});var Vs=$(an=>{j();M();Object.defineProperty(an,"__esModule",{value:!0});an.Feldman=void 0;var Ks=li(),sn=Ue(),di=class{constructor(t,r,n){if(!Number.isInteger(t))throw new Error("Expect integer threshold");if(t<2)throw new Error("Expect threshold >= 2");if(this.threshold=t,!Number.isInteger(r))throw new Error("Expect integer limit");if(r<t)throw new Error("Expect limit >= threshold");if(this.limit=r,n=="ed25519")this.primeOrder=sn.ed25519.CURVE.n;else if(n=="secp256k1")this.primeOrder=sn.secp256k1.CURVE.n;else throw new Error("Expect ed25519 or secp256k1 curve");this.curve=n}async evaluate(t){let r=await Ks.polynomial.initPolynomial(this.primeOrder,t,this.threshold-1),n=new Array(this.limit);for(let s=1;s<=this.limit;s++){let a=BigInt(s);n[s-1]=Ks.polynomial.evaluatePolynomial(r,a)}let i=new Array(r.coefficients.length);for(let s in r.coefficients)i[s]=await sn.ed25519.Point.fromPrivateKey(r.coefficients[s]);return{verifiers:i,shares:n}}async verify(t,r){if(r.length<this.threshold)throw new Error("not enough number of verifiers");let n=await sn.ed25519.Point.fromPrivateKey(t.y),i=1n,s=r[0];for(let a=1;a<=r.length;a++){i*=t.id;let o=r[a].multiply(i);s=s.add(o)}return n===s}};an.Feldman=di});var Ir=$(At=>{j();M();Object.defineProperty(At,"__esModule",{value:!0});At.Signature=At.ECPoint=At.CurveName=void 0;var tr=Ue(),qs=$e(),on;(function(e){e.Secp256k1="secp256k1",e.Ed25519="ed25519"})(on=At.CurveName||(At.CurveName={}));var rr=class{constructor(t,r,n){this.Curve=t,this.X=r,this.Y=n}toHex(){return this.Curve===on.Secp256k1?this.toEcdsaPoint().toHex(!0):this.toEd25519Point().toHex()}toEcdsaPoint(){return new tr.secp256k1.Point(this.X,this.Y)}toEd25519Point(){return new tr.ed25519.Point(this.X,this.Y)}static fromEcdsaPoint(t){return new rr(on.Secp256k1.toString(),t.x,t.y)}static fromEd25519Point(t){return new rr(on.Ed25519.toString(),t.x,t.y)}};At.ECPoint=rr;var nr=class{constructor(t,r){this.r=t,this.s=r}toEcdsaSignature(){return new tr.secp256k1.Signature(this.r,this.s)}toEd25519Signature(){let t=new Uint8Array((0,qs.cvtBigintToUint8array)(this.r)).reverse(),r=tr.ed25519.Point.fromHex(tr.ed25519.utils.bytesToHex(t));return new tr.ed25519.Signature(r,this.s)}static fromEcdsaSignature(t){return new nr(t.r,t.s)}static fromEd25519Signature(t){let r=new Uint8Array(t.r.toRawBytes()).reverse(),n=(0,qs.cvtUint8arrayToBigint)(r);return new nr(n,t.s)}};At.Signature=nr});var pi=$(Ht=>{j();M();Object.defineProperty(Ht,"__esModule",{value:!0});Ht.verify=Ht.prove=Ht.Proof=void 0;var Ls=Ir(),gi=$e(),zt=Ue(),un=dt(),cn=class{constructor(t,r){this.R=t,this.S=r}};Ht.Proof=cn;async function ic(e,t,r){try{let n=zt.secp256k1.CURVE.n,i=(0,gi.RandomNum)(n),s=zt.secp256k1.Point.fromPrivateKey(i),a=zt.secp256k1.Point.fromPrivateKey(BigInt(1)),o=(0,gi.SHA256Int)([e,a.x,a.y,r.x,r.y,s.x,s.y])%n,f=(i+o*t)%n;return new cn(new Ls.ECPoint(Ls.CurveName.Secp256k1,s.x,s.y),f)}catch(n){return Promise.reject(new un.MPCError(un.SchnorrProveError,n))}}Ht.prove=ic;function sc(e,t,r){try{let n=new zt.secp256k1.Point(t.R.X,t.R.Y),i=zt.secp256k1.CURVE.n,s=zt.secp256k1.Point.fromPrivateKey(BigInt(1)),a=(0,gi.SHA256Int)([e,s.x,s.y,r.x,r.y,n.x,n.y])%i,o=zt.secp256k1.Point.fromPrivateKey(BigInt(t.S.toString(10))),f=r.multiply(a);return n.add(f).equals(o)}catch(n){throw new un.MPCError(un.SchnorrVerifyError,n)}}Ht.verify=sc});var yi=$(pt=>{j();M();Object.defineProperty(pt,"__esModule",{value:!0});pt.verify=pt.prove=pt.Proof=pt.Ed25519Point=void 0;var vi=$e(),Dr=Ue(),hn=Ir(),fn=dt(),ln=class{constructor(t,r,n){this.Curve=t,this.X=r,this.Y=n}};pt.Ed25519Point=ln;var ir=class{constructor(t,r){this.R=t,this.S=r}JsonStringify(){let t=new ln("ed25519",this.R.X,this.R.Y);return JSON.stringify({R:t,S:this.S},(r,n)=>typeof n=="bigint"?n.toString():n)}static JsonParse(t){let r=JSON.parse(t),n=new hn.ECPoint(hn.CurveName.Ed25519.toString(),BigInt(r.R.X),BigInt(r.R.Y));return new ir(n,r.S)}};pt.Proof=ir;async function ac(e,t){try{let r=Dr.ed25519.CURVE.n,n=(0,vi.RandomNum)(r),i=BigInt(n.toString()),s=Dr.ed25519.Point.BASE.multiply(BigInt(n.toString())),a=(0,vi.SHA256Int)([t.x,t.y,s.x,s.y])%r,o=(i+a*e)%r;return new ir(new hn.ECPoint(hn.CurveName.Ed25519,s.x,s.y),o)}catch(r){return Promise.reject(new fn.MPCError(fn.SchnorrProveError,r))}}pt.prove=ac;function oc(e,t){try{let r=new Dr.ed25519.Point(e.R.X,e.R.Y),n=Dr.ed25519.CURVE.n,i=(0,vi.SHA256Int)([t.x,t.y,r.x,r.y])%n,s=BigInt(e.S.toString())%n,a=Dr.ed25519.Point.BASE.multiply(s),o=t.multiply(i);return r.add(o).equals(a)}catch(r){throw new fn.MPCError(fn.SchnorrVerifyError,r)}}pt.verify=oc});var sr=$(be=>{j();M();var ks=be&&be.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),uc=be&&be.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Rr=be&&be.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&ks(t,e,r)},Us=be&&be.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&ks(t,e,r);return uc(t,e),t};Object.defineProperty(be,"__esModule",{value:!0});be.ed25519Schnorr=be.ecdsaSchnorr=void 0;Rr(Ts(),be);Rr(js(),be);Rr(Vs(),be);Rr(li(),be);be.ecdsaSchnorr=Us(pi());be.ed25519Schnorr=Us(yi());Rr(Ir(),be)});var Ws=$(ar=>{j();M();Object.defineProperty(ar,"__esModule",{value:!0});ar.Ed25519Verify=ar.Ed25519Sign=void 0;var Br=sr(),vt=Ue(),Gs=$e(),cc=e=>e.length!==0&&e.length%2===0&&!/[^a-fA-F0-9]/u.test(e),hc=e=>Uint8Array.from(e.match(/.{1,2}/g).map(t=>parseInt(t,16))),mi=class{constructor(t,r,n,i,s,a){this.deviceNumber=t,this.threshold=r,this.partList=n,this.publicKey=s,this.message=a,this.roundNumber=1;let o=new Array(n.length);for(let f=0;f<n.length;f++)o[f]=BigInt(n[f]);this.wi=Br.polynomial.calLagrangian(vt.ed25519.CURVE.n,BigInt(t),i,o)}async signStep1(){if(this.roundNumber!=1)throw new Error("not in round 1");this.ki=(0,Gs.RandomNum)(vt.ed25519.CURVE.n);let t=vt.ed25519.Point.BASE.multiply(this.ki),r=Br.Commitment.NewCommitment([t.x,t.y]);this.cmtD=r.Msg,this.roundNumber=2;let n=new Map;for(let i of this.partList){if(i==this.deviceNumber)continue;let s={c:r.C},a={from:this.deviceNumber,to:i,data:s};n.set(i,a)}return n}async signStep2(t){if(this.roundNumber!=2)throw new Error("not in round 2");if(t.length!=this.threshold-1)throw new Error("message number error");this.commitmentMap=new Map;for(let s of t){if(s.to!=this.deviceNumber)throw new Error("message sending error");let a=s.data;this.commitmentMap.set(s.from,a.c)}let r=vt.ed25519.Point.BASE.multiply(this.ki),n=await Br.ed25519Schnorr.prove(this.ki,r);this.roundNumber=3;let i=new Map;for(let s of this.partList){if(s==this.deviceNumber)continue;let a={witness:this.cmtD,proof:n},o={from:this.deviceNumber,to:s,data:a};i.set(s,o)}return i}async signStep3(t){if(this.roundNumber!=3)throw new Error("not in round 3");if(t.length!=this.threshold-1)throw new Error("message number error");let r=vt.ed25519.Point.BASE.multiply(this.ki);for(let o of t){if(o.to!=this.deviceNumber)throw new Error("message sending error");let f=o.data,m={C:this.commitmentMap.get(o.from),Msg:f.witness},p=Br.Commitment.Open(m);if(!p)throw new Error("commitment DeCommit fail");let h=BigInt(p[0].toString()),c=BigInt(p[1].toString()),g=new vt.ed25519.Point(h,c),l=f.proof;if(!Br.ed25519Schnorr.verify(l,g))throw new Error("schnorr verify fail");r=r.add(g)}let n=lc(r.toRawBytes());if(!cc(this.message))throw new Error("stored message not hex");let i=await vt.ed25519.utils.sha512(r.toRawBytes(),this.publicKey.toRawBytes(),hc(this.message)),s=dc(i);return[zs(this.ki+s*this.wi,vt.ed25519.CURVE.n),n]}};ar.Ed25519Sign=mi;async function fc(e,t,r){let n=e.toEd25519Signature(),i=r.toEd25519Point(),s=await vt.ed25519.verify(n,t,i);return[e,s]}ar.Ed25519Verify=fc;function lc(e){let t=new Uint8Array(e);return t.reverse(),(0,Gs.cvtUint8arrayToBigint)(t)}function dc(e){let t=BigInt("0x"+pc(Uint8Array.from(e).reverse()));return zs(t,vt.ed25519.CURVE.l)}function zs(e,t){let r=e%t;return r>=BigInt(0)?r:t+r}var gc=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function pc(e){let t="";for(let r=0;r<e.length;r++)t+=gc[e[r]];return t}});var dn=$(or=>{j();M();Object.defineProperty(or,"__esModule",{value:!0});or.calPrivateOffset=or.TssKey=void 0;var $s=Ue(),_r=Re(),vc=$e(),Xs=dt(),Js=$s.secp256k1.CURVE,Nr=class{constructor(t,r,n){this.shareI=t,this.publicKey=r,this.chaincode=n,this.offsetSonPri=new _r.BN(0)}async NewChildKey(t){try{let r=L.Buffer.from((0,vc.cvtBigintToUint8arrayNoPadding)(this.publicKey.x)),n=Ys(r,this.chaincode,t),i=new _r.BN(n.slice(0,32)),s=$s.secp256k1.Point.fromPrivateKey(BigInt(i.toString(10))),a=this.publicKey.add(s),o=this.shareI;o!=null&&(o=o.add(i),o=o.mod(new _r.BN(Js.n.toString())));let f=this.offsetSonPri.add(i);f=f.mod(new _r.BN(Js.n.toString()));let d=new Nr(o,a,n.slice(32));return d.offsetSonPri=f,d}catch(r){return Promise.reject(new Xs.MPCError(Xs.Bip32NewChildKeyError,r))}}};or.TssKey=Nr;function Ys(e,t,r){let n=L.Buffer.allocUnsafe(4);n.writeUInt32BE(r,0);let i=L.Buffer.allocUnsafe(t.length+e.length+n.length);return t.copy(i,0),e.copy(i,t.length),n.copy(i,t.length+e.length),_r.base.hmacSHA512(L.Buffer.from(`Key share derivation:
`,"utf8"),i)}or.calPrivateOffset=Ys});var xi=$(pn=>{j();M();Object.defineProperty(pn,"__esModule",{value:!0});pn.TssKey=void 0;var Qs=Ue(),gn=Re(),yc=dn(),mc=$e(),Zs=dt(),Si=Qs.ed25519.CURVE,Tr=class{constructor(t,r,n){this.shareI=t,this.publicKey=r,this.chaincode=n,this.offsetSonPri=new gn.BN(0)}async NewChildKey(t){try{let r=L.Buffer.from((0,mc.cvtBigintToUint8arrayNoPadding)(this.publicKey.x)),n=(0,yc.calPrivateOffset)(r,this.chaincode,t),i=new gn.BN(n.slice(0,32)),s=Qs.ed25519.Point.BASE.multiply(BigInt(i.toString(10))%Si.n),a=this.publicKey.add(s),o=this.shareI;o!=null&&(o=o.add(i),o=o.mod(new gn.BN(Si.n.toString())));let f=this.offsetSonPri.add(i);f=f.mod(new gn.BN(Si.n.toString()));let d=new Tr(o,a,n.slice(32));return d.offsetSonPri=f,d}catch(r){return Promise.reject(new Zs.MPCError(Zs.Bip32NewChildKeyError,r))}}};pn.TssKey=Tr});var vn={};ri(vn,{abs:()=>Wt,bitLength:()=>Sc,crt:()=>ta,eGcd:()=>ea,gcd:()=>ra,lcm:()=>xc,max:()=>wc,min:()=>Ec,modAdd:()=>bc,modInv:()=>Ei,modMultiply:()=>Pc,modPow:()=>wi,phi:()=>na,toZn:()=>Xt});function Wt(e){return e>=0?e:-e}function Sc(e){if(typeof e=="number"&&(e=BigInt(e)),e===1n)return 1;let t=1;do t++;while((e>>=1n)>1n);return t}function ea(e,t){if(typeof e=="number"&&(e=BigInt(e)),typeof t=="number"&&(t=BigInt(t)),e<=0n||t<=0n)throw new RangeError("a and b MUST be > 0");let r=0n,n=1n,i=1n,s=0n;for(;e!==0n;){let a=t/e,o=t%e,f=r-i*a,d=n-s*a;t=e,e=o,r=i,n=s,i=f,s=d}return{g:t,x:r,y:n}}function Xt(e,t){if(typeof e=="number"&&(e=BigInt(e)),typeof t=="number"&&(t=BigInt(t)),t<=0n)throw new RangeError("n must be > 0");let r=e%t;return r<0n?r+t:r}function Ei(e,t){let r=ea(Xt(e,t),t);if(r.g!==1n)throw new RangeError(`${e.toString()} does not have inverse modulo ${t.toString()}`);return Xt(r.x,t)}function ta(e,t,r){if(e.length!==t.length)throw new RangeError("The remainders and modulos arrays should have the same length");let n=r??t.reduce((i,s)=>i*s,1n);return t.reduce((i,s,a)=>{let o=n/s;return Xt(i+o*Ei(o,s)%n*e[a]%n,n)},0n)}function ra(e,t){let r=typeof e=="number"?BigInt(Wt(e)):Wt(e),n=typeof t=="number"?BigInt(Wt(t)):Wt(t);if(r===0n)return n;if(n===0n)return r;let i=0n;for(;(1n&(r|n))===0n;)r>>=1n,n>>=1n,i++;for(;(1n&r)===0n;)r>>=1n;do{for(;(1n&n)===0n;)n>>=1n;if(r>n){let s=r;r=n,n=s}n-=r}while(n!==0n);return r<<i}function xc(e,t){return typeof e=="number"&&(e=BigInt(e)),typeof t=="number"&&(t=BigInt(t)),e===0n&&t===0n?BigInt(0):Wt(e/ra(e,t)*t)}function wc(e,t){return e>=t?e:t}function Ec(e,t){return e>=t?t:e}function bc(e,t){let r=BigInt(t);return Xt(e.map(n=>BigInt(n)%r).reduce((n,i)=>n+i%r,0n),r)}function Pc(e,t){let r=BigInt(t);return Xt(e.map(n=>BigInt(n)%r).reduce((n,i)=>n*i%r,1n),r)}function na(e){return e.map(t=>t[0]**(t[1]-1n)*(t[0]-1n)).reduce((t,r)=>r*t,1n)}function wi(e,t,r,n){if(typeof e=="number"&&(e=BigInt(e)),typeof t=="number"&&(t=BigInt(t)),typeof r=="number"&&(r=BigInt(r)),r<=0n)throw new RangeError("n must be > 0");if(r===1n)return 0n;if(e=Xt(e,r),t<0n)return Ei(wi(e,Wt(t),r,n),r);if(n!==void 0)return function(s,a,o,f){let d=f.map(h=>h[0]**h[1]),m=f.map(h=>na([h])),p=m.map((h,c)=>wi(s,a%h,d[c]));return ta(p,d,o)}(e,t,r,function(s){let a={};return s.forEach(o=>{if(typeof o=="bigint"||typeof o=="number"){let f=String(o);a[f]===void 0?a[f]={p:BigInt(o),k:1n}:a[f].k+=1n}else{let f=String(o[0]);a[f]===void 0?a[f]={p:BigInt(o[0]),k:BigInt(o[1])}:a[f].k+=BigInt(o[1])}}),Object.values(a).map(o=>[o.p,o.k])}(n));let i=1n;for(;t>0;)t%2n===1n&&(i=i*e%r),t/=2n,e=e**2n%r;return i}var yn=Xr(()=>{j();M()});var Pi=$(ur=>{j();M();Object.defineProperty(ur,"__esModule",{value:!0});ur.PaillierAffineVerify=ur.PaillierAffineProve=void 0;var Jt=Ue(),ia=Ir(),Ft=$e(),yt=(yn(),lt(vn)),mn=Jt.secp256k1.CURVE,V0=BigInt(2),bi=2*256,sa=3*256,Sn=3*256;function Ac(e,t,r){let n=t.N*t.N,i=1n<<BigInt(bi+Sn),s=1n<<BigInt(sa+Sn),a=1n<<BigInt(bi),o=(0,Ft.RandomNum)(i),f=(0,Ft.RandomNum)(s),d=(0,Ft.RandomNum)(t.N),m=(0,Ft.RandomNum)(i*e.Ntilde),p=(0,Ft.RandomNum)(a*e.Ntilde),h=(0,Ft.RandomNum)(i*e.Ntilde),c=(0,Ft.RandomNum)(a*e.Ntilde),g=(0,yt.modPow)(t.C,o,n);g=g*(0,yt.modPow)(1n+t.N,f,n)%n,g=g*(0,yt.modPow)(d,t.N,n)%n;let l=ia.ECPoint.fromEcdsaPoint(Jt.secp256k1.Point.fromPrivateKey(o%mn.n)),v=ia.ECPoint.fromEcdsaPoint(Jt.secp256k1.Point.fromPrivateKey(f%mn.n)),y=e.Commit(o,m),x=e.Commit(r.X,p),E=e.Commit(f,h),P=e.Commit(r.Y,c),R=(0,Ft.SHA256Int)([t.N,t.C,t.D,t.X.X,t.Y.X,g,l.X,v.X,y,x,E,P])%Jt.secp256k1.CURVE.n,T=o+R*r.X,S=f+R*r.Y,w=m+R*p,A=h+R*c,F=d*(0,yt.modPow)(r.Rho,R,t.N)%t.N;return{A:g,Bx:l,By:v,E:y,S:x,F:E,T:P,Z1:T,Z2:S,Z3:w,Z4:A,W:F,X:t.X,Y:t.Y}}ur.PaillierAffineProve=Ac;function Fc(e,t,r){let n=r.N*r.N,s=(0,Ft.SHA256Int)([r.N,r.C,r.D,r.X.X,r.Y.X,t.A,t.Bx.X,t.By.X,t.E,t.S,t.F,t.T])%Jt.secp256k1.CURVE.n,a=(0,yt.modPow)(r.C,t.Z1,n);a=a*(0,yt.modPow)(1n+r.N,t.Z2,n)%n*(0,yt.modPow)(t.W,r.N,n)%n;let o=t.A*(0,yt.modPow)(r.D,s,n)%n;if(a!==o)return!1;let f=Jt.secp256k1.Point.fromPrivateKey(t.Z1%mn.n),d=t.Bx.toEcdsaPoint().add(r.X.toEcdsaPoint().multiply(s));if(!f.equals(d))return!1;let m=Jt.secp256k1.Point.fromPrivateKey(t.Z2%mn.n),p=t.By.toEcdsaPoint().add(r.Y.toEcdsaPoint().multiply(s));if(!m.equals(p))return!1;let h=e.Commit(t.Z1,t.Z3),c=t.E*(0,yt.modPow)(t.S,s,e.Ntilde)%e.Ntilde;if(h!==c)return!1;let g=e.Commit(t.Z2,t.Z4),l=t.F*(0,yt.modPow)(t.T,s,e.Ntilde)%e.Ntilde;return!(g!==l||t.Z1>=1n<<BigInt(bi+Sn)||t.Z2>=1n<<BigInt(sa+Sn))}ur.PaillierAffineVerify=Fc});var ua=$(wn=>{j();M();Object.defineProperty(wn,"__esModule",{value:!0});wn.P1=void 0;var xn=Re(),Cc=(Ar(),lt(Pr)),Ai=sr(),Or=Ue(),aa=$e(),Ic=Pi(),Dc=Ai.Commitment.NewCommitment,oa=Or.secp256k1.CURVE,Fi=class{constructor(t,r,n,i,s){let a;try{a=(0,Cc.hexToBigint)(i)}catch{throw new Error(`message not hex: ${i}`)}this.sessionId=(0,aa.SHA256Int)([r.x,r.y,a]),this.k1=new xn.BN((0,aa.RandomNum)(oa.n).toString()),this.publicKey=r,this.paiPrivKey=n,this.message=i,this.cmtD=[],this.E_x1=t,this.ped=s}step1(){let t=Or.secp256k1.Point.fromPrivateKey(BigInt(this.k1.toString())),r=Dc([this.sessionId,t.x,t.y]);return this.cmtD=r.Msg,r.C}step2(t,r){let n=BigInt(this.k1.toString()),i=Or.secp256k1.Point.fromPrivateKey(n);if(!Ai.ecdsaSchnorr.verify(this.sessionId,t,r))throw new Error("schnorr verify fail");return this.R2=r,[Ai.ecdsaSchnorr.prove(this.sessionId,n,i),this.cmtD]}step3(t,r){let n={N:BigInt(this.paiPrivKey.pailPubKey.n.toString()),C:BigInt(this.E_x1.toString()),D:BigInt(t.toString()),X:r.X,Y:r.Y};if(!(0,Ic.PaillierAffineVerify)(this.ped,r,n))throw new Error("Paillier Affine verify fail");let s=new xn.BN(oa.n.toString()),o=this.R2?.multiply(BigInt(this.k1.toString()))?.x,f=new xn.BN(o.toString()).mod(new xn.BN(s)),d=this.paiPrivKey.decrypt(t),m=this.k1.invm(s),p=d.mul(m).mod(s),h=s.shrn(1);if(p.cmp(h)==1&&(p=s.sub(p)),p.isZero())throw new Error("calculated S is zero");let c=new Or.secp256k1.Signature(BigInt(f.toString()),BigInt(p.toString()));if(!Or.secp256k1.verify(c,this.message,this.publicKey))throw new Error("ecdsa sign verify fail");return[f,p]}};wn.P1=Fi});var la=$(mt=>{j();M();Object.defineProperty(mt,"__esModule",{value:!0});mt.truncateHash=mt.toU8=mt.bits2int_modN=void 0;var ca=2n**256n,Rc=ca-0x1000003d1n,Bc=ca-0x14551231950b75fc4402da1732fc9bebfn,_c=e=>Array.from(e).map(t=>Nc(t,2)).join(""),Nc=(e,t)=>e.toString(16).padStart(t,"0"),Tc=e=>BigInt(`0x${_c(e)||"0"}`),Oc=e=>{let t=e.length*8-256,r=Tc(e);return t>0?r>>BigInt(t):r},Hc=e=>jc(Oc(e),Bc);mt.bits2int_modN=Hc;var jc=(e,t=Rc)=>{let r=e%t;return r>=0n?r:t+r},ha=e=>typeof e=="string",Mc=(e,t)=>!(e instanceof Uint8Array)||typeof t=="number"&&t>0&&e.length!==t?Ci("Uint8Array expected"):e,fa=e=>new Uint8Array(e),Kc=(e,t)=>Mc(ha(e)?Vc(e):fa(e),t);mt.toU8=Kc;var Vc=e=>{let t=e.length;(!ha(e)||t%2)&&Ci("hex invalid 1");let r=fa(t/2);for(let n=0;n<r.length;n++){let i=n*2,s=e.slice(i,i+2),a=Number.parseInt(s,16);(Number.isNaN(a)||a<0)&&Ci("hex invalid 2"),r[n]=a}return r},Ci=(e="")=>{throw new Error(e)},qc=e=>(0,mt.bits2int_modN)((0,mt.toU8)(e,32));mt.truncateHash=qc});var ga=$(Pn=>{j();M();Object.defineProperty(Pn,"__esModule",{value:!0});Pn.P2=void 0;var cr=Re(),Lc=(Ar(),lt(Pr)),Hr=sr(),jr=Ue(),En=$e(),da=la(),kc=Pi(),Uc=(yn(),lt(vn)),bn=jr.secp256k1.CURVE,Ii=class{constructor(t,r,n,i,s,a){let o;try{o=(0,Lc.hexToBigint)(s)}catch{throw new Error(`message not hex: ${s}`)}this.sessionId=(0,En.SHA256Int)([i.x,i.y,o]),this.x2=t,this.E_x1=r,this.paiPub=n,this.publicKey=i,this.message=s,this.k2=new cr.BN((0,En.RandomNum)(bn.n).toString()),this.cmtC=0n,this.ped=a}step1(t){this.cmtC=t;let r=jr.secp256k1.Point.fromPrivateKey(BigInt(this.k2.toString()));return[Hr.ecdsaSchnorr.prove(this.sessionId,BigInt(this.k2.toString()),r),r]}step2(t,r){let n=new cr.BN(bn.n.toString()),i={C:this.cmtC,Msg:r},s=Hr.Commitment.Open(i);if(!s)throw new Error("commitment DeCommit fail");if(this.sessionId!==s[0])throw new Error("p2 Step2 commitment sessionId error");let a=new jr.secp256k1.Point(s[1],s[2]);if(!Hr.ecdsaSchnorr.verify(this.sessionId,t,a))throw new Error("schnorr verify fail");let d=a.multiply(BigInt(this.k2.toString()))?.x,m=new cr.BN(d.toString()).mod(n),p=this.k2.invm(n),h=Gc(this.message);h=h.mul(p);let g=new cr.BN((0,En.RandomNum)(bn.n*bn.n).toString()).mul(n),l=h.add(g),v=m.mul(p),y=l.add(v.mul(this.x2)),x=(0,En.RandomNum)(BigInt(this.paiPub.n.toString())),E=this.paiPub.homomorphicMulPlain(this.E_x1,v),P=this.paiPub.homomorphicAddPlain(E,y),b=BigInt(this.paiPub.n.toString()),R=BigInt(this.paiPub.n2().toString()),T=new cr.BN((0,Uc.modPow)(x,b,R).toString()),S=P.mul(T).mod(this.paiPub.n2()),w=Hr.ECPoint.fromEcdsaPoint(jr.secp256k1.Point.fromPrivateKey(BigInt(v.mod(n).toString()))),A=Hr.ECPoint.fromEcdsaPoint(jr.secp256k1.Point.fromPrivateKey(BigInt(y.mod(n).toString()))),F={N:BigInt(this.paiPub.n.toString()),C:BigInt(this.E_x1.toString()),D:BigInt(S.toString()),X:w,Y:A},I={X:BigInt(v.toString()),Y:BigInt(y.toString()),Rho:BigInt(x.toString())},N=(0,kc.PaillierAffineProve)(this.ped,F,I);return[S,N]}};Pn.P2=Ii;function Gc(e){let t=(0,da.bits2int_modN)((0,da.toU8)(e,32));return new cr.BN(t.toString())}});var ya=$(Be=>{j();M();var pa=Be&&Be.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),zc=Be&&Be.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Di=Be&&Be.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&pa(t,e,r)},va=Be&&Be.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&pa(t,e,r);return zc(t,e),t};Object.defineProperty(Be,"__esModule",{value:!0});Be.ed25519TssKey=Be.ecdsaTssKey=void 0;Di(Ws(),Be);Be.ecdsaTssKey=va(dn());Be.ed25519TssKey=va(xi());Di(ua(),Be);Di(ga(),Be)});var Sa=$(ma=>{j();M();Object.defineProperty(ma,"__esModule",{value:!0})});var Fn=$(An=>{j();M();Object.defineProperty(An,"__esModule",{value:!0});An.md5=void 0;function Wc(e){var t="0123456789abcdef";function r(b){var R,T="";for(R=0;R<=3;R++)T+=t.charAt(b>>R*8+4&15)+t.charAt(b>>R*8&15);return T}function n(b,R){var T=(b&65535)+(R&65535),S=(b>>16)+(R>>16)+(T>>16);return S<<16|T&65535}function i(b,R){return b<<R|b>>>32-R}function s(b,R,T,S,w,A){return n(i(n(n(R,b),n(S,A)),w),T)}function a(b,R,T,S,w,A,F){return s(R&T|~R&S,b,R,w,A,F)}function o(b,R,T,S,w,A,F){return s(R&S|T&~S,b,R,w,A,F)}function f(b,R,T,S,w,A,F){return s(R^T^S,b,R,w,A,F)}function d(b,R,T,S,w,A,F){return s(T^(R|~S),b,R,w,A,F)}function m(b){var R,T=(b.length+8>>6)+1,S=new Array(T*16);for(R=0;R<T*16;R++)S[R]=0;for(R=0;R<b.length;R++)S[R>>2]|=b.charCodeAt(R)<<R%4*8;return S[R>>2]|=128<<R%4*8,S[T*16-2]=b.length*8,S}var p,h=m(""+e),c=1732584193,g=-271733879,l=-1732584194,v=271733878,y,x,E,P;for(p=0;p<h.length;p+=16)y=c,x=g,E=l,P=v,c=a(c,g,l,v,h[p+0],7,-680876936),v=a(v,c,g,l,h[p+1],12,-389564586),l=a(l,v,c,g,h[p+2],17,606105819),g=a(g,l,v,c,h[p+3],22,-1044525330),c=a(c,g,l,v,h[p+4],7,-176418897),v=a(v,c,g,l,h[p+5],12,1200080426),l=a(l,v,c,g,h[p+6],17,-1473231341),g=a(g,l,v,c,h[p+7],22,-45705983),c=a(c,g,l,v,h[p+8],7,1770035416),v=a(v,c,g,l,h[p+9],12,-1958414417),l=a(l,v,c,g,h[p+10],17,-42063),g=a(g,l,v,c,h[p+11],22,-1990404162),c=a(c,g,l,v,h[p+12],7,1804603682),v=a(v,c,g,l,h[p+13],12,-40341101),l=a(l,v,c,g,h[p+14],17,-1502002290),g=a(g,l,v,c,h[p+15],22,1236535329),c=o(c,g,l,v,h[p+1],5,-165796510),v=o(v,c,g,l,h[p+6],9,-1069501632),l=o(l,v,c,g,h[p+11],14,643717713),g=o(g,l,v,c,h[p+0],20,-373897302),c=o(c,g,l,v,h[p+5],5,-701558691),v=o(v,c,g,l,h[p+10],9,38016083),l=o(l,v,c,g,h[p+15],14,-660478335),g=o(g,l,v,c,h[p+4],20,-405537848),c=o(c,g,l,v,h[p+9],5,568446438),v=o(v,c,g,l,h[p+14],9,-1019803690),l=o(l,v,c,g,h[p+3],14,-187363961),g=o(g,l,v,c,h[p+8],20,1163531501),c=o(c,g,l,v,h[p+13],5,-1444681467),v=o(v,c,g,l,h[p+2],9,-51403784),l=o(l,v,c,g,h[p+7],14,1735328473),g=o(g,l,v,c,h[p+12],20,-1926607734),c=f(c,g,l,v,h[p+5],4,-378558),v=f(v,c,g,l,h[p+8],11,-2022574463),l=f(l,v,c,g,h[p+11],16,1839030562),g=f(g,l,v,c,h[p+14],23,-35309556),c=f(c,g,l,v,h[p+1],4,-1530992060),v=f(v,c,g,l,h[p+4],11,1272893353),l=f(l,v,c,g,h[p+7],16,-155497632),g=f(g,l,v,c,h[p+10],23,-1094730640),c=f(c,g,l,v,h[p+13],4,681279174),v=f(v,c,g,l,h[p+0],11,-358537222),l=f(l,v,c,g,h[p+3],16,-722521979),g=f(g,l,v,c,h[p+6],23,76029189),c=f(c,g,l,v,h[p+9],4,-640364487),v=f(v,c,g,l,h[p+12],11,-421815835),l=f(l,v,c,g,h[p+15],16,530742520),g=f(g,l,v,c,h[p+2],23,-995338651),c=d(c,g,l,v,h[p+0],6,-198630844),v=d(v,c,g,l,h[p+7],10,1126891415),l=d(l,v,c,g,h[p+14],15,-1416354905),g=d(g,l,v,c,h[p+5],21,-57434055),c=d(c,g,l,v,h[p+12],6,1700485571),v=d(v,c,g,l,h[p+3],10,-1894986606),l=d(l,v,c,g,h[p+10],15,-1051523),g=d(g,l,v,c,h[p+1],21,-2054922799),c=d(c,g,l,v,h[p+8],6,1873313359),v=d(v,c,g,l,h[p+15],10,-30611744),l=d(l,v,c,g,h[p+6],15,-1560198380),g=d(g,l,v,c,h[p+13],21,1309151649),c=d(c,g,l,v,h[p+4],6,-145523070),v=d(v,c,g,l,h[p+11],10,-1120210379),l=d(l,v,c,g,h[p+2],15,718787259),g=d(g,l,v,c,h[p+9],21,-343485551),c=n(c,y),g=n(g,x),l=n(l,E),v=n(v,P);return r(c)+r(g)+r(l)+r(v)}An.md5=Wc});var wa=$(we=>{j();M();Object.defineProperty(we,"__esModule",{value:!0});we.sha256HexMsg=we.GetMapKeyTssSign=we.MpcVersion=we.Status=we.SignStep=we.FuncType=we.DeviceNumber=void 0;var Xc=Ue(),Jc=Re(),xa=(Ar(),lt(Pr)),$c=Fn(),Yc;(function(e){e[e.P1_No=1]="P1_No",e[e.P2_No=2]="P2_No",e[e.P3_No=3]="P3_No"})(Yc=we.DeviceNumber||(we.DeviceNumber={}));var Zc;(function(e){e[e.ShakeHands=0]="ShakeHands",e[e.KeyGen=1]="KeyGen",e[e.ReShare=2]="ReShare",e[e.TssSign=3]="TssSign"})(Zc=we.FuncType||(we.FuncType={}));var Qc;(function(e){e[e.Step1=1]="Step1",e[e.Step2=2]="Step2",e[e.Step3=3]="Step3"})(Qc=we.SignStep||(we.SignStep={}));var eh;(function(e){e[e.Success=1]="Success",e[e.Fail=2]="Fail"})(eh=we.Status||(we.Status={}));var th;(function(e){e[e.Version_v0=0]="Version_v0",e[e.Version_v1=1]="Version_v1"})(th=we.MpcVersion||(we.MpcVersion={}));function rh(e,t){let r=(0,$c.md5)(t);return`${e}-${r}`}we.GetMapKeyTssSign=rh;function nh(e){let t=Xc.secp256k1.CURVE.n,r=Jc.base.sha256(e),n=(0,xa.bufToBigint)(r)%t,i=(0,xa.bigintToHex)(n);return i.length%2&&(i="0"+i),i}we.sha256HexMsg=nh});var ba=$(Ye=>{j();M();Object.defineProperty(Ye,"__esModule",{value:!0});Ye.bigintStringify=Ye.cvtEd25519MapToObj=Ye.cvtObjToEd25519Map=Ye.cvtEcdsaMapToObj=Ye.cvtObjToEcdsaMap=void 0;var Ne=ot(),ih=pi(),sh=yi();function ah(e){let t=new Map;for(let r of Object.keys(e)){let n=e[r],i={};if(n.hasOwnProperty("CmtC")&&n.CmtC!==null&&(i.CmtC=e[r].CmtC),n.hasOwnProperty("Witness")&&n.Witness!==null){i.Witness=[];for(let s of n.Witness)i.Witness.push(s)}n.hasOwnProperty("Proof")&&n.Proof!==null&&(i.Proof=new ih.Proof(new Ne.ECPoint(Ne.CurveName.Secp256k1.toString(),BigInt(n.Proof.R.X),BigInt(n.Proof.R.Y)),n.Proof.S)),n.hasOwnProperty("R2")&&n.R2!==null&&(i.R2=new Ne.ECPoint(Ne.CurveName.Secp256k1.toString(),BigInt(n.R2.X),BigInt(n.R2.Y))),n.hasOwnProperty("E_k2_h_rx")&&n.E_k2_h_rx!==null&&(i.E_k2_h_rx=BigInt(n.E_k2_h_rx)),n.hasOwnProperty("Signature")&&n.Signature!==null&&(i.Signature=new Ne.Signature(BigInt(n.Signature.r),BigInt(n.Signature.s))),t.set(r,i)}return t}Ye.cvtObjToEcdsaMap=ah;function oh(e){let t=Object.fromEntries(e.entries()),r={};for(let n of Object.keys(t)){let i={},s=t[n];if(s.CmtC!=null&&(i.CmtC=s.CmtC.toString(10)),s.Witness!=null){i.Witness=[];for(let a of s.Witness)i.Witness.push(a.toString(10))}s.Proof!=null&&(i.Proof={R:{Curve:Ne.CurveName.Secp256k1,X:s.Proof.R.X,Y:s.Proof.R.Y},S:s.Proof.S.toString(10)}),s.R2!=null&&(i.R2={Curve:Ne.CurveName.Secp256k1,X:s.R2.X,Y:s.R2.Y}),s.E_k2_h_rx!=null&&(i.E_k2_h_rx=s.E_k2_h_rx.toString()),s.Signature!=null&&(i.Signature={r:s.Signature.r,s:s.Signature.s}),r[n]=i}return r}Ye.cvtEcdsaMapToObj=oh;function uh(e){let t=new Map;for(let r of Object.keys(e)){let n=e[r],i={};if(n.hasOwnProperty("OutputDataMap")&&n.OutputDataMap!=null){i.TssInput=[];for(let s of Object.keys(n.OutputDataMap))Number(s)===Ne.DeviceNumber.P2_No&&i.TssInput.push(ch(n.OutputDataMap[s]))}n.hasOwnProperty("Signature")&&n.Signature!=null&&(i.Signature=new Ne.Signature(BigInt(n.Signature.r),BigInt(n.Signature.s))),t.set(r,i)}return t}Ye.cvtObjToEd25519Map=uh;function ch(e){let t={};if(e==null)return t;t.from=e.From,t.to=e.To;let r=(0,Ne.JsonParseBigInt)(e.Data);if(t.data={},r.C!==void 0&&(t.data.c=r.C),r.Witness!==void 0){let n=[];if(r.hasOwnProperty("Witness"))for(let i of r.Witness)n.push(i);t.data.witness=n}return r.Proof!==void 0&&(t.data.proof=new sh.Proof(new Ne.ECPoint(Ne.CurveName.Ed25519.toString(),BigInt(r.Proof.R.X),BigInt(r.Proof.R.Y)),BigInt(r.Proof.S))),t}function hh(e){let t={};for(let[r,n]of e.entries()){let i={};if(n.OutputDataMap!=null){let s=[];for(let[a,o]of n.OutputDataMap.entries())a===Ne.DeviceNumber.P1_No&&s.push({From:Ne.DeviceNumber.P2_No,To:Ne.DeviceNumber.P1_No,Data:fh(o.data)});i.TssInput=s}n.Signature!=null&&(i.Signature={r:n.Signature.r,s:n.Signature.s}),t[r]=i}return t}Ye.cvtEd25519MapToObj=hh;function fh(e){let t={};if(e.c!==void 0)t.C=e.c.toString(10);else if(e.witness!==void 0&&e.proof!==void 0){let r=[];for(let n of e.witness)r.push(n.toString(10));t.Witness=r,t.Proof={R:{Curve:Ne.CurveName.Ed25519,X:e.proof.R.X,Y:e.proof.R.Y},S:e.proof.S}}return Ea(t)}function Ea(e){return JSON.stringify(e,(n,i)=>typeof i=="bigint"?i.toString():i).replace(/"(\d{16,})"/g,(n,i)=>i)}Ye.bigintStringify=Ea});var Wi=$(V=>{j();M();var Mr={};Mr.userAgent=!1;var hr={},lh="10.9.0",dh="jsrsasign(all) 10.9.0 (2023-11-27) (c) 2010-2023 Kenji Urushima | kjur.github.io/jsrsasign/license";var q=q||function(e,t){var r={},n=r.lib={},i=n.Base=function(){function c(){}return{extend:function(g){c.prototype=this;var l=new c;return g&&l.mixIn(g),l.hasOwnProperty("init")||(l.init=function(){l.$super.init.apply(this,arguments)}),l.init.prototype=l,l.$super=this,l},create:function(){var g=this.extend();return g.init.apply(g,arguments),g},init:function(){},mixIn:function(g){for(var l in g)g.hasOwnProperty(l)&&(this[l]=g[l]);g.hasOwnProperty("toString")&&(this.toString=g.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),s=n.WordArray=i.extend({init:function(c,g){c=this.words=c||[],g!=t?this.sigBytes=g:this.sigBytes=c.length*4},toString:function(c){return(c||o).stringify(this)},concat:function(c){var g=this.words,l=c.words,v=this.sigBytes,y=c.sigBytes;if(this.clamp(),v%4)for(var x=0;x<y;x++){var E=l[x>>>2]>>>24-x%4*8&255;g[v+x>>>2]|=E<<24-(v+x)%4*8}else for(var x=0;x<y;x+=4)g[v+x>>>2]=l[x>>>2];return this.sigBytes+=y,this},clamp:function(){var c=this.words,g=this.sigBytes;c[g>>>2]&=4294967295<<32-g%4*8,c.length=e.ceil(g/4)},clone:function(){var c=i.clone.call(this);return c.words=this.words.slice(0),c},random:function(c){for(var g=[],l=0;l<c;l+=4)g.push(e.random()*4294967296|0);return new s.init(g,c)}}),a=r.enc={},o=a.Hex={stringify:function(c){for(var g=c.words,l=c.sigBytes,v=[],y=0;y<l;y++){var x=g[y>>>2]>>>24-y%4*8&255;v.push((x>>>4).toString(16)),v.push((x&15).toString(16))}return v.join("")},parse:function(c){for(var g=c.length,l=[],v=0;v<g;v+=2)l[v>>>3]|=parseInt(c.substr(v,2),16)<<24-v%8*4;return new s.init(l,g/2)}},f=a.Latin1={stringify:function(c){for(var g=c.words,l=c.sigBytes,v=[],y=0;y<l;y++){var x=g[y>>>2]>>>24-y%4*8&255;v.push(String.fromCharCode(x))}return v.join("")},parse:function(c){for(var g=c.length,l=[],v=0;v<g;v++)l[v>>>2]|=(c.charCodeAt(v)&255)<<24-v%4*8;return new s.init(l,g)}},d=a.Utf8={stringify:function(c){try{return decodeURIComponent(escape(f.stringify(c)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(c){return f.parse(unescape(encodeURIComponent(c)))}},m=n.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(c){typeof c=="string"&&(c=d.parse(c)),this._data.concat(c),this._nDataBytes+=c.sigBytes},_process:function(c){var g=this._data,l=g.words,v=g.sigBytes,y=this.blockSize,x=y*4,E=v/x;c?E=e.ceil(E):E=e.max((E|0)-this._minBufferSize,0);var P=E*y,b=e.min(P*4,v);if(P){for(var R=0;R<P;R+=y)this._doProcessBlock(l,R);var T=l.splice(0,P);g.sigBytes-=b}return new s.init(T,b)},clone:function(){var c=i.clone.call(this);return c._data=this._data.clone(),c},_minBufferSize:0}),p=n.Hasher=m.extend({cfg:i.extend(),init:function(c){this.cfg=this.cfg.extend(c),this.reset()},reset:function(){m.reset.call(this),this._doReset()},update:function(c){return this._append(c),this._process(),this},finalize:function(c){c&&this._append(c);var g=this._doFinalize();return g},blockSize:512/32,_createHelper:function(c){return function(g,l){return new c.init(l).finalize(g)}},_createHmacHelper:function(c){return function(g,l){return new h.HMAC.init(c,l).finalize(g)}}}),h=r.algo={};return r}(Math);(function(e){var i=q,t=i.lib,r=t.Base,n=t.WordArray,i=i.x64={};i.Word=r.extend({init:function(s,a){this.high=s,this.low=a}}),i.WordArray=r.extend({init:function(s,a){s=this.words=s||[],this.sigBytes=a!=e?a:8*s.length},toX32:function(){for(var s=this.words,a=s.length,o=[],f=0;f<a;f++){var d=s[f];o.push(d.high),o.push(d.low)}return n.create(o,this.sigBytes)},clone:function(){for(var s=r.clone.call(this),a=s.words=this.words.slice(0),o=a.length,f=0;f<o;f++)a[f]=a[f].clone();return s}})})();q.lib.Cipher||function(e){var c=q,t=c.lib,r=t.Base,n=t.WordArray,i=t.BufferedBlockAlgorithm,s=c.enc.Base64,a=c.algo.EvpKDF,o=t.Cipher=i.extend({cfg:r.extend(),createEncryptor:function(l,v){return this.create(this._ENC_XFORM_MODE,l,v)},createDecryptor:function(l,v){return this.create(this._DEC_XFORM_MODE,l,v)},init:function(l,v,y){this.cfg=this.cfg.extend(y),this._xformMode=l,this._key=v,this.reset()},reset:function(){i.reset.call(this),this._doReset()},process:function(l){return this._append(l),this._process()},finalize:function(l){return l&&this._append(l),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(l){return{encrypt:function(v,y,x){return(typeof y=="string"?g:h).encrypt(l,v,y,x)},decrypt:function(v,y,x){return(typeof y=="string"?g:h).decrypt(l,v,y,x)}}}});t.StreamCipher=o.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var p=c.mode={},f=function(l,v,y){var x=this._iv;x?this._iv=e:x=this._prevBlock;for(var E=0;E<y;E++)l[v+E]^=x[E]},d=(t.BlockCipherMode=r.extend({createEncryptor:function(l,v){return this.Encryptor.create(l,v)},createDecryptor:function(l,v){return this.Decryptor.create(l,v)},init:function(l,v){this._cipher=l,this._iv=v}})).extend();d.Encryptor=d.extend({processBlock:function(l,v){var y=this._cipher,x=y.blockSize;f.call(this,l,v,x),y.encryptBlock(l,v),this._prevBlock=l.slice(v,v+x)}}),d.Decryptor=d.extend({processBlock:function(l,v){var y=this._cipher,x=y.blockSize,E=l.slice(v,v+x);y.decryptBlock(l,v),f.call(this,l,v,x),this._prevBlock=E}}),p=p.CBC=d,d=(c.pad={}).Pkcs7={pad:function(l,v){for(var y=4*v,y=y-l.sigBytes%y,x=y<<24|y<<16|y<<8|y,E=[],P=0;P<y;P+=4)E.push(x);y=n.create(E,y),l.concat(y)},unpad:function(l){l.sigBytes-=l.words[l.sigBytes-1>>>2]&255}},t.BlockCipher=o.extend({cfg:o.cfg.extend({mode:p,padding:d}),reset:function(){o.reset.call(this);var v=this.cfg,l=v.iv,v=v.mode;if(this._xformMode==this._ENC_XFORM_MODE)var y=v.createEncryptor;else y=v.createDecryptor,this._minBufferSize=1;this._mode=y.call(v,this,l&&l.words)},_doProcessBlock:function(l,v){this._mode.processBlock(l,v)},_doFinalize:function(){var l=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){l.pad(this._data,this.blockSize);var v=this._process(!0)}else v=this._process(!0),l.unpad(v);return v},blockSize:4});var m=t.CipherParams=r.extend({init:function(l){this.mixIn(l)},toString:function(l){return(l||this.formatter).stringify(this)}}),p=(c.format={}).OpenSSL={stringify:function(l){var v=l.ciphertext;return l=l.salt,(l?n.create([1398893684,1701076831]).concat(l).concat(v):v).toString(s)},parse:function(l){l=s.parse(l);var v=l.words;if(v[0]==1398893684&&v[1]==1701076831){var y=n.create(v.slice(2,4));v.splice(0,4),l.sigBytes-=16}return m.create({ciphertext:l,salt:y})}},h=t.SerializableCipher=r.extend({cfg:r.extend({format:p}),encrypt:function(l,v,y,x){x=this.cfg.extend(x);var E=l.createEncryptor(y,x);return v=E.finalize(v),E=E.cfg,m.create({ciphertext:v,key:y,iv:E.iv,algorithm:l,mode:E.mode,padding:E.padding,blockSize:l.blockSize,formatter:x.format})},decrypt:function(l,v,y,x){return x=this.cfg.extend(x),v=this._parse(v,x.format),l.createDecryptor(y,x).finalize(v.ciphertext)},_parse:function(l,v){return typeof l=="string"?v.parse(l,this):l}}),c=(c.kdf={}).OpenSSL={execute:function(l,v,y,x){return x||(x=n.random(8)),l=a.create({keySize:v+y}).compute(l,x),y=n.create(l.words.slice(v),4*y),l.sigBytes=4*v,m.create({key:l,iv:y,salt:x})}},g=t.PasswordBasedCipher=h.extend({cfg:h.cfg.extend({kdf:c}),encrypt:function(l,v,y,x){return x=this.cfg.extend(x),y=x.kdf.execute(y,l.keySize,l.ivSize),x.iv=y.iv,l=h.encrypt.call(this,l,v,y.key,x),l.mixIn(y),l},decrypt:function(l,v,y,x){return x=this.cfg.extend(x),v=this._parse(v,x.format),y=x.kdf.execute(y,l.keySize,l.ivSize,v.salt),x.iv=y.iv,h.decrypt.call(this,l,v,y.key,x)}})}();(function(){for(var e=q,t=e.lib.BlockCipher,R=e.algo,r=[],n=[],i=[],s=[],a=[],o=[],f=[],d=[],m=[],p=[],h=[],c=0;256>c;c++)h[c]=128>c?c<<1:c<<1^283;for(var g=0,l=0,c=0;256>c;c++){var v=l^l<<1^l<<2^l<<3^l<<4,v=v>>>8^v&255^99;r[g]=v,n[v]=g;var y=h[g],x=h[y],E=h[x],P=257*h[v]^16843008*v;i[g]=P<<24|P>>>8,s[g]=P<<16|P>>>16,a[g]=P<<8|P>>>24,o[g]=P,P=16843009*E^65537*x^257*y^16843008*g,f[v]=P<<24|P>>>8,d[v]=P<<16|P>>>16,m[v]=P<<8|P>>>24,p[v]=P,g?(g=y^h[h[h[E^y]]],l^=h[h[l]]):g=l=1}var b=[0,1,2,4,8,16,32,64,128,27,54],R=R.AES=t.extend({_doReset:function(){for(var w=this._key,T=w.words,S=w.sigBytes/4,w=4*((this._nRounds=S+6)+1),A=this._keySchedule=[],F=0;F<w;F++)if(F<S)A[F]=T[F];else{var I=A[F-1];F%S?6<S&&F%S==4&&(I=r[I>>>24]<<24|r[I>>>16&255]<<16|r[I>>>8&255]<<8|r[I&255]):(I=I<<8|I>>>24,I=r[I>>>24]<<24|r[I>>>16&255]<<16|r[I>>>8&255]<<8|r[I&255],I^=b[F/S|0]<<24),A[F]=A[F-S]^I}for(T=this._invKeySchedule=[],S=0;S<w;S++)F=w-S,I=S%4?A[F]:A[F-4],T[S]=4>S||4>=F?I:f[r[I>>>24]]^d[r[I>>>16&255]]^m[r[I>>>8&255]]^p[r[I&255]]},encryptBlock:function(T,S){this._doCryptBlock(T,S,this._keySchedule,i,s,a,o,r)},decryptBlock:function(T,S){var w=T[S+1];T[S+1]=T[S+3],T[S+3]=w,this._doCryptBlock(T,S,this._invKeySchedule,f,d,m,p,n),w=T[S+1],T[S+1]=T[S+3],T[S+3]=w},_doCryptBlock:function(T,S,w,A,F,I,N,C){for(var D=this._nRounds,Y=T[S]^w[0],fe=T[S+1]^w[1],oe=T[S+2]^w[2],Q=T[S+3]^w[3],_=4,O=1;O<D;O++)var U=A[Y>>>24]^F[fe>>>16&255]^I[oe>>>8&255]^N[Q&255]^w[_++],J=A[fe>>>24]^F[oe>>>16&255]^I[Q>>>8&255]^N[Y&255]^w[_++],G=A[oe>>>24]^F[Q>>>16&255]^I[Y>>>8&255]^N[fe&255]^w[_++],Q=A[Q>>>24]^F[Y>>>16&255]^I[fe>>>8&255]^N[oe&255]^w[_++],Y=U,fe=J,oe=G;U=(C[Y>>>24]<<24|C[fe>>>16&255]<<16|C[oe>>>8&255]<<8|C[Q&255])^w[_++],J=(C[fe>>>24]<<24|C[oe>>>16&255]<<16|C[Q>>>8&255]<<8|C[Y&255])^w[_++],G=(C[oe>>>24]<<24|C[Q>>>16&255]<<16|C[Y>>>8&255]<<8|C[fe&255])^w[_++],Q=(C[Q>>>24]<<24|C[Y>>>16&255]<<16|C[fe>>>8&255]<<8|C[oe&255])^w[_++],T[S]=U,T[S+1]=J,T[S+2]=G,T[S+3]=Q},keySize:8});e.AES=t._createHelper(R)})();(function(){function e(h,c){var g=(this._lBlock>>>h^this._rBlock)&c;this._rBlock^=g,this._lBlock^=g<<h}function t(h,c){var g=(this._rBlock>>>h^this._lBlock)&c;this._lBlock^=g,this._rBlock^=g<<h}var r=q,i=r.lib,n=i.WordArray,i=i.BlockCipher,s=r.algo,a=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],o=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],f=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],d=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],m=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],p=s.DES=i.extend({_doReset:function(){for(var h=this._key.words,c=[],g=0;56>g;g++){var l=a[g]-1;c[g]=h[l>>>5]>>>31-l%32&1}for(h=this._subKeys=[],l=0;16>l;l++){for(var v=h[l]=[],y=f[l],g=0;24>g;g++)v[g/6|0]|=c[(o[g]-1+y)%28]<<31-g%6,v[4+(g/6|0)]|=c[28+(o[g+24]-1+y)%28]<<31-g%6;for(v[0]=v[0]<<1|v[0]>>>31,g=1;7>g;g++)v[g]>>>=4*(g-1)+3;v[7]=v[7]<<5|v[7]>>>27}for(c=this._invSubKeys=[],g=0;16>g;g++)c[g]=h[15-g]},encryptBlock:function(h,c){this._doCryptBlock(h,c,this._subKeys)},decryptBlock:function(h,c){this._doCryptBlock(h,c,this._invSubKeys)},_doCryptBlock:function(h,c,g){this._lBlock=h[c],this._rBlock=h[c+1],e.call(this,4,252645135),e.call(this,16,65535),t.call(this,2,858993459),t.call(this,8,16711935),e.call(this,1,1431655765);for(var l=0;16>l;l++){for(var v=g[l],y=this._lBlock,x=this._rBlock,E=0,P=0;8>P;P++)E|=d[P][((x^v[P])&m[P])>>>0];this._lBlock=x,this._rBlock=y^E}g=this._lBlock,this._lBlock=this._rBlock,this._rBlock=g,e.call(this,1,1431655765),t.call(this,8,16711935),t.call(this,2,858993459),e.call(this,16,65535),e.call(this,4,252645135),h[c]=this._lBlock,h[c+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});r.DES=i._createHelper(p),s=s.TripleDES=i.extend({_doReset:function(){var h=this._key.words;this._des1=p.createEncryptor(n.create(h.slice(0,2))),this._des2=p.createEncryptor(n.create(h.slice(2,4))),this._des3=p.createEncryptor(n.create(h.slice(4,6)))},encryptBlock:function(h,c){this._des1.encryptBlock(h,c),this._des2.decryptBlock(h,c),this._des3.encryptBlock(h,c)},decryptBlock:function(h,c){this._des3.decryptBlock(h,c),this._des2.encryptBlock(h,c),this._des1.decryptBlock(h,c)},keySize:6,ivSize:2,blockSize:2}),r.TripleDES=i._createHelper(s)})();(function(){var e=q,t=e.lib.WordArray;e.enc.Base64={stringify:function(r){var n=r.words,i=r.sigBytes,s=this._map;r.clamp(),r=[];for(var a=0;a<i;a+=3)for(var o=(n[a>>>2]>>>24-8*(a%4)&255)<<16|(n[a+1>>>2]>>>24-8*((a+1)%4)&255)<<8|n[a+2>>>2]>>>24-8*((a+2)%4)&255,f=0;4>f&&a+.75*f<i;f++)r.push(s.charAt(o>>>6*(3-f)&63));if(n=s.charAt(64))for(;r.length%4;)r.push(n);return r.join("")},parse:function(r){var n=r.length,i=this._map,s=i.charAt(64);s&&(s=r.indexOf(s),s!=-1&&(n=s));for(var s=[],a=0,o=0;o<n;o++)if(o%4){var f=i.indexOf(r.charAt(o-1))<<2*(o%4),d=i.indexOf(r.charAt(o))>>>6-2*(o%4);s[a>>>2]|=(f|d)<<24-8*(a%4),a++}return t.create(s,a)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})();(function(e){function t(p,h,c,g,l,v,y){return p=p+(h&c|~h&g)+l+y,(p<<v|p>>>32-v)+h}function r(p,h,c,g,l,v,y){return p=p+(h&g|c&~g)+l+y,(p<<v|p>>>32-v)+h}function n(p,h,c,g,l,v,y){return p=p+(h^c^g)+l+y,(p<<v|p>>>32-v)+h}function i(p,h,c,g,l,v,y){return p=p+(c^(h|~g))+l+y,(p<<v|p>>>32-v)+h}for(var s=q,f=s.lib,a=f.WordArray,o=f.Hasher,f=s.algo,d=[],m=0;64>m;m++)d[m]=4294967296*e.abs(e.sin(m+1))|0;f=f.MD5=o.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(p,h){for(var c=0;16>c;c++){var g=h+c,l=p[g];p[g]=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360}var c=this._hash.words,g=p[h+0],l=p[h+1],v=p[h+2],y=p[h+3],x=p[h+4],E=p[h+5],P=p[h+6],b=p[h+7],R=p[h+8],T=p[h+9],S=p[h+10],w=p[h+11],A=p[h+12],F=p[h+13],I=p[h+14],N=p[h+15],C=c[0],O=c[1],_=c[2],D=c[3],C=t(C,O,_,D,g,7,d[0]),D=t(D,C,O,_,l,12,d[1]),_=t(_,D,C,O,v,17,d[2]),O=t(O,_,D,C,y,22,d[3]),C=t(C,O,_,D,x,7,d[4]),D=t(D,C,O,_,E,12,d[5]),_=t(_,D,C,O,P,17,d[6]),O=t(O,_,D,C,b,22,d[7]),C=t(C,O,_,D,R,7,d[8]),D=t(D,C,O,_,T,12,d[9]),_=t(_,D,C,O,S,17,d[10]),O=t(O,_,D,C,w,22,d[11]),C=t(C,O,_,D,A,7,d[12]),D=t(D,C,O,_,F,12,d[13]),_=t(_,D,C,O,I,17,d[14]),O=t(O,_,D,C,N,22,d[15]),C=r(C,O,_,D,l,5,d[16]),D=r(D,C,O,_,P,9,d[17]),_=r(_,D,C,O,w,14,d[18]),O=r(O,_,D,C,g,20,d[19]),C=r(C,O,_,D,E,5,d[20]),D=r(D,C,O,_,S,9,d[21]),_=r(_,D,C,O,N,14,d[22]),O=r(O,_,D,C,x,20,d[23]),C=r(C,O,_,D,T,5,d[24]),D=r(D,C,O,_,I,9,d[25]),_=r(_,D,C,O,y,14,d[26]),O=r(O,_,D,C,R,20,d[27]),C=r(C,O,_,D,F,5,d[28]),D=r(D,C,O,_,v,9,d[29]),_=r(_,D,C,O,b,14,d[30]),O=r(O,_,D,C,A,20,d[31]),C=n(C,O,_,D,E,4,d[32]),D=n(D,C,O,_,R,11,d[33]),_=n(_,D,C,O,w,16,d[34]),O=n(O,_,D,C,I,23,d[35]),C=n(C,O,_,D,l,4,d[36]),D=n(D,C,O,_,x,11,d[37]),_=n(_,D,C,O,b,16,d[38]),O=n(O,_,D,C,S,23,d[39]),C=n(C,O,_,D,F,4,d[40]),D=n(D,C,O,_,g,11,d[41]),_=n(_,D,C,O,y,16,d[42]),O=n(O,_,D,C,P,23,d[43]),C=n(C,O,_,D,T,4,d[44]),D=n(D,C,O,_,A,11,d[45]),_=n(_,D,C,O,N,16,d[46]),O=n(O,_,D,C,v,23,d[47]),C=i(C,O,_,D,g,6,d[48]),D=i(D,C,O,_,b,10,d[49]),_=i(_,D,C,O,I,15,d[50]),O=i(O,_,D,C,E,21,d[51]),C=i(C,O,_,D,A,6,d[52]),D=i(D,C,O,_,y,10,d[53]),_=i(_,D,C,O,S,15,d[54]),O=i(O,_,D,C,l,21,d[55]),C=i(C,O,_,D,R,6,d[56]),D=i(D,C,O,_,N,10,d[57]),_=i(_,D,C,O,P,15,d[58]),O=i(O,_,D,C,F,21,d[59]),C=i(C,O,_,D,x,6,d[60]),D=i(D,C,O,_,w,10,d[61]),_=i(_,D,C,O,v,15,d[62]),O=i(O,_,D,C,T,21,d[63]);c[0]=c[0]+C|0,c[1]=c[1]+O|0,c[2]=c[2]+_|0,c[3]=c[3]+D|0},_doFinalize:function(){var p=this._data,h=p.words,c=8*this._nDataBytes,g=8*p.sigBytes;h[g>>>5]|=128<<24-g%32;var l=e.floor(c/4294967296);for(h[(g+64>>>9<<4)+15]=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360,h[(g+64>>>9<<4)+14]=(c<<8|c>>>24)&16711935|(c<<24|c>>>8)&4278255360,p.sigBytes=4*(h.length+1),this._process(),p=this._hash,h=p.words,c=0;4>c;c++)g=h[c],h[c]=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360;return p},clone:function(){var p=o.clone.call(this);return p._hash=this._hash.clone(),p}}),s.MD5=o._createHelper(f),s.HmacMD5=o._createHmacHelper(f)})(Math);(function(){var e=q,i=e.lib,t=i.WordArray,r=i.Hasher,n=[],i=e.algo.SHA1=r.extend({_doReset:function(){this._hash=new t.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(s,a){for(var o=this._hash.words,f=o[0],d=o[1],m=o[2],p=o[3],h=o[4],c=0;80>c;c++){if(16>c)n[c]=s[a+c]|0;else{var g=n[c-3]^n[c-8]^n[c-14]^n[c-16];n[c]=g<<1|g>>>31}g=(f<<5|f>>>27)+h+n[c],g=20>c?g+((d&m|~d&p)+1518500249):40>c?g+((d^m^p)+1859775393):60>c?g+((d&m|d&p|m&p)-1894007588):g+((d^m^p)-899497514),h=p,p=m,m=d<<30|d>>>2,d=f,f=g}o[0]=o[0]+f|0,o[1]=o[1]+d|0,o[2]=o[2]+m|0,o[3]=o[3]+p|0,o[4]=o[4]+h|0},_doFinalize:function(){var s=this._data,a=s.words,o=8*this._nDataBytes,f=8*s.sigBytes;return a[f>>>5]|=128<<24-f%32,a[(f+64>>>9<<4)+14]=Math.floor(o/4294967296),a[(f+64>>>9<<4)+15]=o,s.sigBytes=4*a.length,this._process(),this._hash},clone:function(){var s=r.clone.call(this);return s._hash=this._hash.clone(),s}});e.SHA1=r._createHelper(i),e.HmacSHA1=r._createHmacHelper(i)})();(function(e){for(var t=q,c=t.lib,r=c.WordArray,n=c.Hasher,c=t.algo,i=[],s=[],a=function(l){return 4294967296*(l-(l|0))|0},o=2,f=0;64>f;){var d;e:{d=o;for(var m=e.sqrt(d),p=2;p<=m;p++)if(!(d%p)){d=!1;break e}d=!0}d&&(8>f&&(i[f]=a(e.pow(o,.5))),s[f]=a(e.pow(o,1/3)),f++),o++}var h=[],c=c.SHA256=n.extend({_doReset:function(){this._hash=new r.init(i.slice(0))},_doProcessBlock:function(g,l){for(var v=this._hash.words,y=v[0],x=v[1],E=v[2],P=v[3],b=v[4],R=v[5],T=v[6],S=v[7],w=0;64>w;w++){if(16>w)h[w]=g[l+w]|0;else{var A=h[w-15],F=h[w-2];h[w]=((A<<25|A>>>7)^(A<<14|A>>>18)^A>>>3)+h[w-7]+((F<<15|F>>>17)^(F<<13|F>>>19)^F>>>10)+h[w-16]}A=S+((b<<26|b>>>6)^(b<<21|b>>>11)^(b<<7|b>>>25))+(b&R^~b&T)+s[w]+h[w],F=((y<<30|y>>>2)^(y<<19|y>>>13)^(y<<10|y>>>22))+(y&x^y&E^x&E),S=T,T=R,R=b,b=P+A|0,P=E,E=x,x=y,y=A+F|0}v[0]=v[0]+y|0,v[1]=v[1]+x|0,v[2]=v[2]+E|0,v[3]=v[3]+P|0,v[4]=v[4]+b|0,v[5]=v[5]+R|0,v[6]=v[6]+T|0,v[7]=v[7]+S|0},_doFinalize:function(){var g=this._data,l=g.words,v=8*this._nDataBytes,y=8*g.sigBytes;return l[y>>>5]|=128<<24-y%32,l[(y+64>>>9<<4)+14]=e.floor(v/4294967296),l[(y+64>>>9<<4)+15]=v,g.sigBytes=4*l.length,this._process(),this._hash},clone:function(){var g=n.clone.call(this);return g._hash=this._hash.clone(),g}});t.SHA256=n._createHelper(c),t.HmacSHA256=n._createHmacHelper(c)})(Math);(function(){var e=q,t=e.lib.WordArray,n=e.algo,r=n.SHA256,n=n.SHA224=r.extend({_doReset:function(){this._hash=new t.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var i=r._doFinalize.call(this);return i.sigBytes-=4,i}});e.SHA224=r._createHelper(n),e.HmacSHA224=r._createHmacHelper(n)})();(function(){function e(){return n.create.apply(n,arguments)}for(var t=q,r=t.lib.Hasher,s=t.x64,n=s.Word,i=s.WordArray,s=t.algo,a=[e(1116352408,3609767458),e(1899447441,602891725),e(3049323471,3964484399),e(3921009573,2173295548),e(961987163,4081628472),e(1508970993,3053834265),e(2453635748,2937671579),e(2870763221,3664609560),e(3624381080,2734883394),e(310598401,1164996542),e(607225278,1323610764),e(1426881987,3590304994),e(1925078388,4068182383),e(2162078206,991336113),e(2614888103,633803317),e(3248222580,3479774868),e(3835390401,2666613458),e(4022224774,944711139),e(264347078,2341262773),e(604807628,2007800933),e(770255983,1495990901),e(1249150122,1856431235),e(1555081692,3175218132),e(1996064986,2198950837),e(2554220882,3999719339),e(2821834349,766784016),e(2952996808,2566594879),e(3210313671,3203337956),e(3336571891,1034457026),e(3584528711,2466948901),e(113926993,3758326383),e(338241895,168717936),e(666307205,1188179964),e(773529912,1546045734),e(1294757372,1522805485),e(1396182291,2643833823),e(1695183700,2343527390),e(1986661051,1014477480),e(2177026350,1206759142),e(2456956037,344077627),e(2730485921,1290863460),e(2820302411,3158454273),e(3259730800,3505952657),e(3345764771,106217008),e(3516065817,3606008344),e(3600352804,1432725776),e(4094571909,1467031594),e(275423344,851169720),e(430227734,3100823752),e(506948616,1363258195),e(659060556,3750685593),e(883997877,3785050280),e(958139571,3318307427),e(1322822218,3812723403),e(1537002063,2003034995),e(1747873779,3602036899),e(1955562222,1575990012),e(2024104815,1125592928),e(2227730452,2716904306),e(2361852424,442776044),e(2428436474,593698344),e(2756734187,3733110249),e(3204031479,2999351573),e(3329325298,3815920427),e(3391569614,3928383900),e(3515267271,566280711),e(3940187606,3454069534),e(4118630271,4000239992),e(116418474,1914138554),e(174292421,2731055270),e(289380356,3203993006),e(460393269,320620315),e(685471733,587496836),e(852142971,1086792851),e(1017036298,365543100),e(1126000580,2618297676),e(1288033470,3409855158),e(1501505948,4234509866),e(1607167915,987167468),e(1816402316,1246189591)],o=[],f=0;80>f;f++)o[f]=e();s=s.SHA512=r.extend({_doReset:function(){this._hash=new i.init([new n.init(1779033703,4089235720),new n.init(3144134277,2227873595),new n.init(1013904242,4271175723),new n.init(2773480762,1595750129),new n.init(1359893119,2917565137),new n.init(2600822924,725511199),new n.init(528734635,4215389547),new n.init(1541459225,327033209)])},_doProcessBlock:function(d,m){for(var x=this._hash.words,p=x[0],h=x[1],c=x[2],g=x[3],l=x[4],v=x[5],y=x[6],x=x[7],E=p.high,P=p.low,b=h.high,R=h.low,T=c.high,S=c.low,w=g.high,A=g.low,F=l.high,I=l.low,N=v.high,C=v.low,D=y.high,_=y.low,O=x.high,U=x.low,J=E,G=P,Q=b,Y=R,fe=T,oe=S,bt=w,We=A,_e=F,Ke=I,Le=N,se=C,Ee=D,pe=_,xe=O,Ve=U,ue=0;80>ue;ue++){var Tt=o[ue];if(16>ue)var ke=Tt.high=d[m+2*ue]|0,ie=Tt.low=d[m+2*ue+1]|0;else{var ke=o[ue-15],ie=ke.high,ht=ke.low,ke=(ie>>>1|ht<<31)^(ie>>>8|ht<<24)^ie>>>7,ht=(ht>>>1|ie<<31)^(ht>>>8|ie<<24)^(ht>>>7|ie<<25),Lt=o[ue-2],ie=Lt.high,de=Lt.low,Lt=(ie>>>19|de<<13)^(ie<<3|de>>>29)^ie>>>6,de=(de>>>19|ie<<13)^(de<<3|ie>>>29)^(de>>>6|ie<<26),ie=o[ue-7],br=ie.high,Nt=o[ue-16],ft=Nt.high,Nt=Nt.low,ie=ht+ie.low,ke=ke+br+(ie>>>0<ht>>>0?1:0),ie=ie+de,ke=ke+Lt+(ie>>>0<de>>>0?1:0),ie=ie+Nt,ke=ke+ft+(ie>>>0<Nt>>>0?1:0);Tt.high=ke,Tt.low=ie}var br=_e&Le^~_e&Ee,Nt=Ke&se^~Ke&pe,Tt=J&Q^J&fe^Q&fe,Ho=G&Y^G&oe^Y&oe,ht=(J>>>28|G<<4)^(J<<30|G>>>2)^(J<<25|G>>>7),Lt=(G>>>28|J<<4)^(G<<30|J>>>2)^(G<<25|J>>>7),de=a[ue],jo=de.high,gs=de.low,de=Ve+((Ke>>>14|_e<<18)^(Ke>>>18|_e<<14)^(Ke<<23|_e>>>9)),ft=xe+((_e>>>14|Ke<<18)^(_e>>>18|Ke<<14)^(_e<<23|Ke>>>9))+(de>>>0<Ve>>>0?1:0),de=de+Nt,ft=ft+br+(de>>>0<Nt>>>0?1:0),de=de+gs,ft=ft+jo+(de>>>0<gs>>>0?1:0),de=de+ie,ft=ft+ke+(de>>>0<ie>>>0?1:0),ie=Lt+Ho,Tt=ht+Tt+(ie>>>0<Lt>>>0?1:0),xe=Ee,Ve=pe,Ee=Le,pe=se,Le=_e,se=Ke,Ke=We+de|0,_e=bt+ft+(Ke>>>0<We>>>0?1:0)|0,bt=fe,We=oe,fe=Q,oe=Y,Q=J,Y=G,G=de+ie|0,J=ft+Tt+(G>>>0<de>>>0?1:0)|0}P=p.low=P+G,p.high=E+J+(P>>>0<G>>>0?1:0),R=h.low=R+Y,h.high=b+Q+(R>>>0<Y>>>0?1:0),S=c.low=S+oe,c.high=T+fe+(S>>>0<oe>>>0?1:0),A=g.low=A+We,g.high=w+bt+(A>>>0<We>>>0?1:0),I=l.low=I+Ke,l.high=F+_e+(I>>>0<Ke>>>0?1:0),C=v.low=C+se,v.high=N+Le+(C>>>0<se>>>0?1:0),_=y.low=_+pe,y.high=D+Ee+(_>>>0<pe>>>0?1:0),U=x.low=U+Ve,x.high=O+xe+(U>>>0<Ve>>>0?1:0)},_doFinalize:function(){var d=this._data,m=d.words,p=8*this._nDataBytes,h=8*d.sigBytes;return m[h>>>5]|=128<<24-h%32,m[(h+128>>>10<<5)+30]=Math.floor(p/4294967296),m[(h+128>>>10<<5)+31]=p,d.sigBytes=4*m.length,this._process(),this._hash.toX32()},clone:function(){var d=r.clone.call(this);return d._hash=this._hash.clone(),d},blockSize:32}),t.SHA512=r._createHelper(s),t.HmacSHA512=r._createHmacHelper(s)})();(function(){var e=q,i=e.x64,t=i.Word,r=i.WordArray,i=e.algo,n=i.SHA512,i=i.SHA384=n.extend({_doReset:function(){this._hash=new r.init([new t.init(3418070365,3238371032),new t.init(1654270250,914150663),new t.init(2438529370,812702999),new t.init(355462360,4144912697),new t.init(1731405415,4290775857),new t.init(2394180231,1750603025),new t.init(3675008525,1694076839),new t.init(1203062813,3204075428)])},_doFinalize:function(){var s=n._doFinalize.call(this);return s.sigBytes-=16,s}});e.SHA384=n._createHelper(i),e.HmacSHA384=n._createHmacHelper(i)})();(function(){var e=q,d=e.lib,t=d.WordArray,r=d.Hasher,d=e.algo,n=t.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),i=t.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),s=t.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),a=t.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),o=t.create([0,1518500249,1859775393,2400959708,2840853838]),f=t.create([1352829926,1548603684,1836072691,2053994217,0]),d=d.RIPEMD160=r.extend({_doReset:function(){this._hash=t.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(m,p){for(var h=0;16>h;h++){var c=p+h,g=m[c];m[c]=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360}var c=this._hash.words,g=o.words,l=f.words,v=n.words,y=i.words,x=s.words,E=a.words,P,b,R,T,S,w,A,F,I,N;w=P=c[0],A=b=c[1],F=R=c[2],I=T=c[3],N=S=c[4];for(var C,h=0;80>h;h+=1)C=P+m[p+v[h]]|0,C=16>h?C+((b^R^T)+g[0]):32>h?C+((b&R|~b&T)+g[1]):48>h?C+(((b|~R)^T)+g[2]):64>h?C+((b&T|R&~T)+g[3]):C+((b^(R|~T))+g[4]),C|=0,C=C<<x[h]|C>>>32-x[h],C=C+S|0,P=S,S=T,T=R<<10|R>>>22,R=b,b=C,C=w+m[p+y[h]]|0,C=16>h?C+((A^(F|~I))+l[0]):32>h?C+((A&I|F&~I)+l[1]):48>h?C+(((A|~F)^I)+l[2]):64>h?C+((A&F|~A&I)+l[3]):C+((A^F^I)+l[4]),C|=0,C=C<<E[h]|C>>>32-E[h],C=C+N|0,w=N,N=I,I=F<<10|F>>>22,F=A,A=C;C=c[1]+R+I|0,c[1]=c[2]+T+N|0,c[2]=c[3]+S+w|0,c[3]=c[4]+P+A|0,c[4]=c[0]+b+F|0,c[0]=C},_doFinalize:function(){var m=this._data,p=m.words,h=8*this._nDataBytes,c=8*m.sigBytes;for(p[c>>>5]|=128<<24-c%32,p[(c+64>>>9<<4)+14]=(h<<8|h>>>24)&16711935|(h<<24|h>>>8)&4278255360,m.sigBytes=4*(p.length+1),this._process(),m=this._hash,p=m.words,h=0;5>h;h++)c=p[h],p[h]=(c<<8|c>>>24)&16711935|(c<<24|c>>>8)&4278255360;return m},clone:function(){var m=r.clone.call(this);return m._hash=this._hash.clone(),m}});e.RIPEMD160=r._createHelper(d),e.HmacRIPEMD160=r._createHmacHelper(d)})(Math);(function(){var e=q,t=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(r,n){r=this._hasher=new r.init,typeof n=="string"&&(n=t.parse(n));var i=r.blockSize,s=4*i;n.sigBytes>s&&(n=r.finalize(n)),n.clamp();for(var a=this._oKey=n.clone(),o=this._iKey=n.clone(),f=a.words,d=o.words,m=0;m<i;m++)f[m]^=1549556828,d[m]^=909522486;a.sigBytes=o.sigBytes=s,this.reset()},reset:function(){var r=this._hasher;r.reset(),r.update(this._iKey)},update:function(r){return this._hasher.update(r),this},finalize:function(r){var n=this._hasher;return r=n.finalize(r),n.reset(),n.finalize(this._oKey.clone().concat(r))}})})();(function(){var e=q,n=e.lib,t=n.Base,r=n.WordArray,n=e.algo,i=n.HMAC,s=n.PBKDF2=t.extend({cfg:t.extend({keySize:4,hasher:n.SHA1,iterations:1}),init:function(a){this.cfg=this.cfg.extend(a)},compute:function(a,o){for(var g=this.cfg,f=i.create(g.hasher,a),d=r.create(),m=r.create([1]),p=d.words,h=m.words,c=g.keySize,g=g.iterations;p.length<c;){var l=f.update(o).finalize(m);f.reset();for(var v=l.words,y=v.length,x=l,E=1;E<g;E++){x=f.finalize(x),f.reset();for(var P=x.words,b=0;b<y;b++)v[b]^=P[b]}d.concat(l),h[0]++}return d.sigBytes=4*c,d}});e.PBKDF2=function(a,o,f){return s.create(f).compute(a,o)}})();var fr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ni="=";function It(e){var t,r,n="";for(t=0;t+3<=e.length;t+=3)r=parseInt(e.substring(t,t+3),16),n+=fr.charAt(r>>6)+fr.charAt(r&63);if(t+1==e.length?(r=parseInt(e.substring(t,t+1),16),n+=fr.charAt(r<<2)):t+2==e.length&&(r=parseInt(e.substring(t,t+2),16),n+=fr.charAt(r>>2)+fr.charAt((r&3)<<4)),Ni)for(;(n.length&3)>0;)n+=Ni;return n}function dr(e){var t="",r,n=0,i,s;for(r=0;r<e.length&&e.charAt(r)!=Ni;++r)s=fr.indexOf(e.charAt(r)),!(s<0)&&(n==0?(t+=Ct(s>>2),i=s&3,n=1):n==1?(t+=Ct(i<<2|s>>4),i=s&15,n=2):n==2?(t+=Ct(i),t+=Ct(s>>2),i=s&3,n=3):(t+=Ct(i<<2|s>>4),t+=Ct(s&15),n=0));return n==1&&(t+=Ct(i<<2)),t}function Da(e){var t=dr(e),r,n=new Array;for(r=0;2*r<t.length;++r)n[r]=parseInt(t.substring(2*r,2*r+2),16);return n}var Mt,gh=0xdeadbeefcafe,Pa=(gh&16777215)==15715070;function B(e,t,r){e!=null&&(typeof e=="number"?this.fromNumber(e,t,r):t==null&&typeof e!="string"?this.fromString(e,256):this.fromString(e,t))}function ee(){return new B(null)}function ph(e,t,r,n,i,s){for(;--s>=0;){var a=t*this[e++]+r[n]+i;i=Math.floor(a/67108864),r[n++]=a&67108863}return i}function vh(e,t,r,n,i,s){for(var a=t&32767,o=t>>15;--s>=0;){var f=this[e]&32767,d=this[e++]>>15,m=o*f+d*a;f=a*f+((m&32767)<<15)+r[n]+(i&1073741823),i=(f>>>30)+(m>>>15)+o*d+(i>>>30),r[n++]=f&1073741823}return i}function yh(e,t,r,n,i,s){for(var a=t&16383,o=t>>14;--s>=0;){var f=this[e]&16383,d=this[e++]>>14,m=o*f+d*a;f=a*f+((m&16383)<<14)+r[n]+i,i=(f>>28)+(m>>14)+o*d,r[n++]=f&268435455}return i}Pa&&Mr.appName=="Microsoft Internet Explorer"?(B.prototype.am=vh,Mt=30):Pa&&Mr.appName!="Netscape"?(B.prototype.am=ph,Mt=26):(B.prototype.am=yh,Mt=28);B.prototype.DB=Mt;B.prototype.DM=(1<<Mt)-1;B.prototype.DV=1<<Mt;var Mi=52;B.prototype.FV=Math.pow(2,Mi);B.prototype.F1=Mi-Mt;B.prototype.F2=2*Mt-Mi;var mh="0123456789abcdefghijklmnopqrstuvwxyz",Bn=new Array,gr,Qe;gr="0".charCodeAt(0);for(Qe=0;Qe<=9;++Qe)Bn[gr++]=Qe;gr="a".charCodeAt(0);for(Qe=10;Qe<36;++Qe)Bn[gr++]=Qe;gr="A".charCodeAt(0);for(Qe=10;Qe<36;++Qe)Bn[gr++]=Qe;function Ct(e){return mh.charAt(e)}function Ra(e,t){var r=Bn[e.charCodeAt(t)];return r??-1}function Sh(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s}function xh(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0}function jt(e){var t=ee();return t.fromInt(e),t}function wh(e,t){var r;if(t==16)r=4;else if(t==8)r=3;else if(t==256)r=8;else if(t==2)r=1;else if(t==32)r=5;else if(t==4)r=2;else{this.fromRadix(e,t);return}this.t=0,this.s=0;for(var n=e.length,i=!1,s=0;--n>=0;){var a=r==8?e[n]&255:Ra(e,n);if(a<0){e.charAt(n)=="-"&&(i=!0);continue}i=!1,s==0?this[this.t++]=a:s+r>this.DB?(this[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this[this.t++]=a>>this.DB-s):this[this.t-1]|=a<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&(e[0]&128)!=0&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&B.ZERO.subTo(this,this)}function Eh(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t}function bh(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var r=(1<<t)-1,n,i=!1,s="",a=this.t,o=this.DB-a*this.DB%t;if(a-- >0)for(o<this.DB&&(n=this[a]>>o)>0&&(i=!0,s=Ct(n));a>=0;)o<t?(n=(this[a]&(1<<o)-1)<<t-o,n|=this[--a]>>(o+=this.DB-t)):(n=this[a]>>(o-=t)&r,o<=0&&(o+=this.DB,--a)),n>0&&(i=!0),i&&(s+=Ct(n));return i?s:"0"}function Ph(){var e=ee();return B.ZERO.subTo(this,e),e}function Ah(){return this.s<0?this.negate():this}function Fh(e){var t=this.s-e.s;if(t!=0)return t;var r=this.t;if(t=r-e.t,t!=0)return this.s<0?-t:t;for(;--r>=0;)if((t=this[r]-e[r])!=0)return t;return 0}function _n(e){var t=1,r;return(r=e>>>16)!=0&&(e=r,t+=16),(r=e>>8)!=0&&(e=r,t+=8),(r=e>>4)!=0&&(e=r,t+=4),(r=e>>2)!=0&&(e=r,t+=2),(r=e>>1)!=0&&(e=r,t+=1),t}function Ch(){return this.t<=0?0:this.DB*(this.t-1)+_n(this[this.t-1]^this.s&this.DM)}function Ih(e,t){var r;for(r=this.t-1;r>=0;--r)t[r+e]=this[r];for(r=e-1;r>=0;--r)t[r]=0;t.t=this.t+e,t.s=this.s}function Dh(e,t){for(var r=e;r<this.t;++r)t[r-e]=this[r];t.t=Math.max(this.t-e,0),t.s=this.s}function Rh(e,t){var r=e%this.DB,n=this.DB-r,i=(1<<n)-1,s=Math.floor(e/this.DB),a=this.s<<r&this.DM,o;for(o=this.t-1;o>=0;--o)t[o+s+1]=this[o]>>n|a,a=(this[o]&i)<<r;for(o=s-1;o>=0;--o)t[o]=0;t[s]=a,t.t=this.t+s+1,t.s=this.s,t.clamp()}function Bh(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t){t.t=0;return}var n=e%this.DB,i=this.DB-n,s=(1<<n)-1;t[0]=this[r]>>n;for(var a=r+1;a<this.t;++a)t[a-r-1]|=(this[a]&s)<<i,t[a-r]=this[a]>>n;n>0&&(t[this.t-r-1]|=(this.s&s)<<i),t.t=this.t-r,t.clamp()}function _h(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this[r]-e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e[r],t[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t[r++]=this.DV+n:n>0&&(t[r++]=n),t.t=r,t.clamp()}function Nh(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t[i]=0;for(i=0;i<n.t;++i)t[i+r.t]=r.am(0,n[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&B.ZERO.subTo(t,t)}function Th(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t[r],e,2*r,0,1);(e[r+t.t]+=t.am(r+1,2*t[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e[r+t.t]-=t.DV,e[r+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(r,t[r],e,2*r,0,1)),e.s=0,e.clamp()}function Oh(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){t?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=ee());var s=ee(),a=this.s,o=e.s,f=this.DB-_n(n[n.t-1]);f>0?(n.lShiftTo(f,s),i.lShiftTo(f,r)):(n.copyTo(s),i.copyTo(r));var d=s.t,m=s[d-1];if(m!=0){var p=m*(1<<this.F1)+(d>1?s[d-2]>>this.F2:0),h=this.FV/p,c=(1<<this.F1)/p,g=1<<this.F2,l=r.t,v=l-d,y=t??ee();for(s.dlShiftTo(v,y),r.compareTo(y)>=0&&(r[r.t++]=1,r.subTo(y,r)),B.ONE.dlShiftTo(d,y),y.subTo(s,s);s.t<d;)s[s.t++]=0;for(;--v>=0;){var x=r[--l]==m?this.DM:Math.floor(r[l]*h+(r[l-1]+g)*c);if((r[l]+=s.am(0,x,r,v,0,d))<x)for(s.dlShiftTo(v,y),r.subTo(y,r);r[l]<--x;)r.subTo(y,r)}t!=null&&(r.drShiftTo(d,t),a!=o&&B.ZERO.subTo(t,t)),r.t=d,r.clamp(),f>0&&r.rShiftTo(f,r),a<0&&B.ZERO.subTo(r,r)}}}function Hh(e){var t=ee();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(B.ZERO)>0&&e.subTo(t,t),t}function $t(e){this.m=e}function jh(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function Mh(e){return e}function Kh(e){e.divRemTo(this.m,null,e)}function Vh(e,t,r){e.multiplyTo(t,r),this.reduce(r)}function qh(e,t){e.squareTo(t),this.reduce(t)}$t.prototype.convert=jh;$t.prototype.revert=Mh;$t.prototype.reduce=Kh;$t.prototype.mulTo=Vh;$t.prototype.sqrTo=qh;function Lh(){if(this.t<1)return 0;var e=this[0];if((e&1)==0)return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function Yt(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function kh(e){var t=ee();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(B.ZERO)>0&&this.m.subTo(t,t),t}function Uh(e){var t=ee();return e.copyTo(t),this.reduce(t),t}function Gh(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=e[t]&32767,n=r*this.mpl+((r*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e[r]+=this.m.am(0,n,e,t,0,this.m.t);e[r]>=e.DV;)e[r]-=e.DV,e[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function zh(e,t){e.squareTo(t),this.reduce(t)}function Wh(e,t,r){e.multiplyTo(t,r),this.reduce(r)}Yt.prototype.convert=kh;Yt.prototype.revert=Uh;Yt.prototype.reduce=Gh;Yt.prototype.mulTo=Wh;Yt.prototype.sqrTo=zh;function Xh(){return(this.t>0?this[0]&1:this.s)==0}function Jh(e,t){if(e>4294967295||e<1)return B.ONE;var r=ee(),n=ee(),i=t.convert(this),s=_n(e)-1;for(i.copyTo(r);--s>=0;)if(t.sqrTo(r,n),(e&1<<s)>0)t.mulTo(n,i,r);else{var a=r;r=n,n=a}return t.revert(r)}function $h(e,t){var r;return e<256||t.isEven()?r=new $t(t):r=new Yt(t),this.exp(e,r)}B.prototype.copyTo=Sh;B.prototype.fromInt=xh;B.prototype.fromString=wh;B.prototype.clamp=Eh;B.prototype.dlShiftTo=Ih;B.prototype.drShiftTo=Dh;B.prototype.lShiftTo=Rh;B.prototype.rShiftTo=Bh;B.prototype.subTo=_h;B.prototype.multiplyTo=Nh;B.prototype.squareTo=Th;B.prototype.divRemTo=Oh;B.prototype.invDigit=Lh;B.prototype.isEven=Xh;B.prototype.exp=Jh;B.prototype.toString=bh;B.prototype.negate=Ph;B.prototype.abs=Ah;B.prototype.compareTo=Fh;B.prototype.bitLength=Ch;B.prototype.mod=Hh;B.prototype.modPowInt=$h;B.ZERO=jt(0);B.ONE=jt(1);function Yh(){var e=ee();return this.copyTo(e),e}function Zh(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function Qh(){return this.t==0?this.s:this[0]<<24>>24}function ef(){return this.t==0?this.s:this[0]<<16>>16}function tf(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function rf(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function nf(e){if(e==null&&(e=10),this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=jt(r),i=ee(),s=ee(),a="";for(this.divRemTo(n,i,s);i.signum()>0;)a=(r+s.intValue()).toString(e).substr(1)+a,i.divRemTo(n,i,s);return s.intValue().toString(e)+a}function sf(e,t){this.fromInt(0),t==null&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,s=0,a=0,o=0;o<e.length;++o){var f=Ra(e,o);if(f<0){e.charAt(o)=="-"&&this.signum()==0&&(i=!0);continue}a=t*a+f,++s>=r&&(this.dMultiply(n),this.dAddOffset(a,0),s=0,a=0)}s>0&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(a,0)),i&&B.ZERO.subTo(this,this)}function af(e,t,r){if(typeof t=="number")if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(B.ONE.shiftLeft(e-1),Ki,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(B.ONE.shiftLeft(e-1),this);else{var n=new Array,i=e&7;n.length=(e>>3)+1,t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function of(){var e=this.t,t=new Array;t[0]=this.s;var r=this.DB-e*this.DB%8,n,i=0;if(e-- >0)for(r<this.DB&&(n=this[e]>>r)!=(this.s&this.DM)>>r&&(t[i++]=n|this.s<<this.DB-r);e>=0;)r<8?(n=(this[e]&(1<<r)-1)<<8-r,n|=this[--e]>>(r+=this.DB-8)):(n=this[e]>>(r-=8)&255,r<=0&&(r+=this.DB,--e)),(n&128)!=0&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(t[i++]=n);return t}function uf(e){return this.compareTo(e)==0}function cf(e){return this.compareTo(e)<0?this:e}function hf(e){return this.compareTo(e)>0?this:e}function ff(e,t,r){var n,i,s=Math.min(e.t,this.t);for(n=0;n<s;++n)r[n]=t(this[n],e[n]);if(e.t<this.t){for(i=e.s&this.DM,n=s;n<this.t;++n)r[n]=t(this[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<e.t;++n)r[n]=t(i,e[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()}function lf(e,t){return e&t}function df(e){var t=ee();return this.bitwiseTo(e,lf,t),t}function Ki(e,t){return e|t}function gf(e){var t=ee();return this.bitwiseTo(e,Ki,t),t}function Ba(e,t){return e^t}function pf(e){var t=ee();return this.bitwiseTo(e,Ba,t),t}function _a(e,t){return e&~t}function vf(e){var t=ee();return this.bitwiseTo(e,_a,t),t}function yf(){for(var e=ee(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e}function mf(e){var t=ee();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function Sf(e){var t=ee();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function xf(e){if(e==0)return-1;var t=0;return(e&65535)==0&&(e>>=16,t+=16),(e&255)==0&&(e>>=8,t+=8),(e&15)==0&&(e>>=4,t+=4),(e&3)==0&&(e>>=2,t+=2),(e&1)==0&&++t,t}function wf(){for(var e=0;e<this.t;++e)if(this[e]!=0)return e*this.DB+xf(this[e]);return this.s<0?this.t*this.DB:-1}function Ef(e){for(var t=0;e!=0;)e&=e-1,++t;return t}function bf(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=Ef(this[r]^t);return e}function Pf(e){var t=Math.floor(e/this.DB);return t>=this.t?this.s!=0:(this[t]&1<<e%this.DB)!=0}function Af(e,t){var r=B.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r}function Ff(e){return this.changeBit(e,Ki)}function Cf(e){return this.changeBit(e,_a)}function If(e){return this.changeBit(e,Ba)}function Df(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this[r]+e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e[r],t[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t[r++]=n:n<-1&&(t[r++]=this.DV+n),t.t=r,t.clamp()}function Rf(e){var t=ee();return this.addTo(e,t),t}function Bf(e){var t=ee();return this.subTo(e,t),t}function _f(e){var t=ee();return this.multiplyTo(e,t),t}function Nf(){var e=ee();return this.squareTo(e),e}function Tf(e){var t=ee();return this.divRemTo(e,t,null),t}function Of(e){var t=ee();return this.divRemTo(e,null,t),t}function Hf(e){var t=ee(),r=ee();return this.divRemTo(e,t,r),new Array(t,r)}function jf(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function Mf(e,t){if(e!=0){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}}function Vr(){}function Na(e){return e}function Kf(e,t,r){e.multiplyTo(t,r)}function Vf(e,t){e.squareTo(t)}Vr.prototype.convert=Na;Vr.prototype.revert=Na;Vr.prototype.mulTo=Kf;Vr.prototype.sqrTo=Vf;function qf(e){return this.exp(e,new Vr)}function Lf(e,t,r){var n=Math.min(this.t+e.t,t);for(r.s=0,r.t=n;n>0;)r[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r[n+this.t]=this.am(0,e[n],r,n,0,this.t);for(i=Math.min(e.t,t);n<i;++n)this.am(0,e[n],r,n,0,t-n);r.clamp()}function kf(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r[this.t+n-t]=this.am(t-n,e[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)}function pr(e){this.r2=ee(),this.q3=ee(),B.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function Uf(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=ee();return e.copyTo(t),this.reduce(t),t}function Gf(e){return e}function zf(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function Wf(e,t){e.squareTo(t),this.reduce(t)}function Xf(e,t,r){e.multiplyTo(t,r),this.reduce(r)}pr.prototype.convert=Uf;pr.prototype.revert=Gf;pr.prototype.reduce=zf;pr.prototype.mulTo=Xf;pr.prototype.sqrTo=Wf;function Jf(e,t){var r=e.bitLength(),n,i=jt(1),s;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new $t(t):t.isEven()?s=new pr(t):s=new Yt(t);var a=new Array,o=3,f=n-1,d=(1<<n)-1;if(a[1]=s.convert(this),n>1){var m=ee();for(s.sqrTo(a[1],m);o<=d;)a[o]=ee(),s.mulTo(m,a[o-2],a[o]),o+=2}var p=e.t-1,h,c=!0,g=ee(),l;for(r=_n(e[p])-1;p>=0;){for(r>=f?h=e[p]>>r-f&d:(h=(e[p]&(1<<r+1)-1)<<f-r,p>0&&(h|=e[p-1]>>this.DB+r-f)),o=n;(h&1)==0;)h>>=1,--o;if((r-=o)<0&&(r+=this.DB,--p),c)a[h].copyTo(i),c=!1;else{for(;o>1;)s.sqrTo(i,g),s.sqrTo(g,i),o-=2;o>0?s.sqrTo(i,g):(l=i,i=g,g=l),s.mulTo(g,a[h],i)}for(;p>=0&&(e[p]&1<<r)==0;)s.sqrTo(i,g),l=i,i=g,g=l,--r<0&&(r=this.DB-1,--p)}return s.revert(i)}function $f(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return t;for(i<s&&(s=i),s>0&&(t.rShiftTo(s,t),r.rShiftTo(s,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function Yf(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(t==0)r=this[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this[n])%e;return r}function Zf(e){var t=e.isEven();if(this.isEven()&&t||e.signum()==0)return B.ZERO;for(var r=e.clone(),n=this.clone(),i=jt(1),s=jt(0),a=jt(0),o=jt(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),t?((!i.isEven()||!s.isEven())&&(i.addTo(this,i),s.subTo(e,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),t?((!a.isEven()||!o.isEven())&&(a.addTo(this,a),o.subTo(e,o)),a.rShiftTo(1,a)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(a,i),s.subTo(o,s)):(n.subTo(r,n),t&&a.subTo(i,a),o.subTo(s,o))}if(n.compareTo(B.ONE)!=0)return B.ZERO;if(o.compareTo(e)>=0)return o.subtract(e);if(o.signum()<0)o.addTo(e,o);else return o;return o.signum()<0?o.add(e):o}var qe=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],Qf=(1<<26)/qe[qe.length-1];function el(e){var t,r=this.abs();if(r.t==1&&r[0]<=qe[qe.length-1]){for(t=0;t<qe.length;++t)if(r[0]==qe[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<qe.length;){for(var n=qe[t],i=t+1;i<qe.length&&n<Qf;)n*=qe[i++];for(n=r.modInt(n);t<i;)if(n%qe[t++]==0)return!1}return r.millerRabin(e)}function tl(e){var t=this.subtract(B.ONE),r=t.getLowestSetBit();if(r<=0)return!1;var n=t.shiftRight(r);e=e+1>>1,e>qe.length&&(e=qe.length);for(var i=ee(),s=0;s<e;++s){i.fromInt(qe[Math.floor(Math.random()*qe.length)]);var a=i.modPow(n,this);if(a.compareTo(B.ONE)!=0&&a.compareTo(t)!=0){for(var o=1;o++<r&&a.compareTo(t)!=0;)if(a=a.modPowInt(2,this),a.compareTo(B.ONE)==0)return!1;if(a.compareTo(t)!=0)return!1}}return!0}B.prototype.chunkSize=tf;B.prototype.toRadix=nf;B.prototype.fromRadix=sf;B.prototype.fromNumber=af;B.prototype.bitwiseTo=ff;B.prototype.changeBit=Af;B.prototype.addTo=Df;B.prototype.dMultiply=jf;B.prototype.dAddOffset=Mf;B.prototype.multiplyLowerTo=Lf;B.prototype.multiplyUpperTo=kf;B.prototype.modInt=Yf;B.prototype.millerRabin=tl;B.prototype.clone=Yh;B.prototype.intValue=Zh;B.prototype.byteValue=Qh;B.prototype.shortValue=ef;B.prototype.signum=rf;B.prototype.toByteArray=of;B.prototype.equals=uf;B.prototype.min=cf;B.prototype.max=hf;B.prototype.and=df;B.prototype.or=gf;B.prototype.xor=pf;B.prototype.andNot=vf;B.prototype.not=yf;B.prototype.shiftLeft=mf;B.prototype.shiftRight=Sf;B.prototype.getLowestSetBit=wf;B.prototype.bitCount=bf;B.prototype.testBit=Pf;B.prototype.setBit=Ff;B.prototype.clearBit=Cf;B.prototype.flipBit=If;B.prototype.add=Rf;B.prototype.subtract=Bf;B.prototype.multiply=_f;B.prototype.divide=Tf;B.prototype.remainder=Of;B.prototype.divideAndRemainder=Hf;B.prototype.modPow=Jf;B.prototype.modInverse=Zf;B.prototype.pow=qf;B.prototype.gcd=$f;B.prototype.isProbablePrime=el;B.prototype.square=Nf;function Vi(){this.i=0,this.j=0,this.S=new Array}function rl(e){var t,r,n;for(t=0;t<256;++t)this.S[t]=t;for(r=0,t=0;t<256;++t)r=r+this.S[t]+e[t%e.length]&255,n=this.S[t],this.S[t]=this.S[r],this.S[r]=n;this.i=0,this.j=0}function nl(){var e;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[e+this.S[this.i]&255]}Vi.prototype.init=rl;Vi.prototype.next=nl;function il(){return new Vi}var Ti=256;var Cn,Xe,Fe;function sl(e){Xe[Fe++]^=e&255,Xe[Fe++]^=e>>8&255,Xe[Fe++]^=e>>16&255,Xe[Fe++]^=e>>24&255,Fe>=Ti&&(Fe-=Ti)}function qi(){sl(new Date().getTime())}if(Xe==null){if(Xe=new Array,Fe=0,hr!==void 0&&(hr.crypto!==void 0||hr.msCrypto!==void 0)){if(Ri=hr.crypto||hr.msCrypto,Ri.getRandomValues)for(Bi=new Uint8Array(32),Ri.getRandomValues(Bi),Ze=0;Ze<32;++Ze)Xe[Fe++]=Bi[Ze];else if(Mr.appName=="Netscape"&&Mr.appVersion<"5")for(_i=hr.crypto.random(32),Ze=0;Ze<_i.length;++Ze)Xe[Fe++]=_i.charCodeAt(Ze)&255}for(;Fe<Ti;)Ze=Math.floor(65536*Math.random()),Xe[Fe++]=Ze>>>8,Xe[Fe++]=Ze&255;Fe=0,qi()}var Ze,Ri,Bi,_i;function al(){if(Cn==null){for(qi(),Cn=il(),Cn.init(Xe),Fe=0;Fe<Xe.length;++Fe)Xe[Fe]=0;Fe=0}return Cn.next()}function ol(e){var t;for(t=0;t<e.length;++t)e[t]=al()}function Kt(){}Kt.prototype.nextBytes=ol;function Oe(e,t){return new B(e,t)}function ul(e,t){if(t<e.length+11)throw"Message too long for RSA";for(var r=new Array,n=e.length-1;n>=0&&t>0;){var i=e.charCodeAt(n--);i<128?r[--t]=i:i>127&&i<2048?(r[--t]=i&63|128,r[--t]=i>>6|192):(r[--t]=i&63|128,r[--t]=i>>6&63|128,r[--t]=i>>12|224)}r[--t]=0;for(var s=new Kt,a=new Array;t>2;){for(a[0]=0;a[0]==0;)s.nextBytes(a);r[--t]=a[0]}return r[--t]=2,r[--t]=0,new B(r)}function Aa(e,t,r){for(var n="",i=0;n.length<t;)n+=r(String.fromCharCode.apply(String,e.concat([(i&4278190080)>>24,(i&16711680)>>16,(i&65280)>>8,i&255]))),i+=1;return n}function cl(e,t,r,n){var i=u.crypto.MessageDigest,s=u.crypto.Util,a=null;if(r||(r="sha1"),typeof r=="string"&&(a=i.getCanonicalAlgName(r),n=i.getHashLength(a),r=function(l){return He(s.hashHex(et(l),a))}),e.length+2*n+2>t)throw"Message too long for RSA";var o="",f;for(f=0;f<t-e.length-2*n-2;f+=1)o+="\0";var d=r("")+o+""+e,m=new Array(n);new Kt().nextBytes(m);var p=Aa(m,d.length,r),h=[];for(f=0;f<d.length;f+=1)h[f]=d.charCodeAt(f)^p.charCodeAt(f);var c=Aa(h,m.length,r),g=[0];for(f=0;f<m.length;f+=1)g[f+1]=m[f]^c.charCodeAt(f);return new B(g.concat(h))}function W(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function hl(e,t){if(this.isPublic=!0,this.isPrivate=!1,typeof e!="string")this.n=e,this.e=t;else if(e!=null&&t!=null&&e.length>0&&t.length>0)this.n=Oe(e,16),this.e=parseInt(t,16);else throw"Invalid RSA public key"}function fl(e){return e.modPowInt(this.e,this.n)}function ll(e){var t=ul(e,this.n.bitLength()+7>>3);if(t==null)return null;var r=this.doPublic(t);if(r==null)return null;var n=r.toString(16);return(n.length&1)==0?n:"0"+n}function dl(e,t,r){var n=this.n.bitLength()+7>>3,i=cl(e,n,t,r);if(i==null)return null;var s=this.doPublic(i);if(s==null)return null;for(var a=s.toString(16);a.length<n*2;)a="0"+a;return a}W.prototype.doPublic=fl;W.prototype.setPublic=hl;W.prototype.encrypt=ll;W.prototype.encryptOAEP=dl;W.prototype.type="RSA";function gl(e,t){for(var r=e.toByteArray(),n=0;n<r.length&&r[n]==0;)++n;if(r.length-n!=t-1||r[n]!=2)return null;for(++n;r[n]!=0;)if(++n>=r.length)return null;for(var i="";++n<r.length;){var s=r[n]&255;s<128?i+=String.fromCharCode(s):s>191&&s<224?(i+=String.fromCharCode((s&31)<<6|r[n+1]&63),++n):(i+=String.fromCharCode((s&15)<<12|(r[n+1]&63)<<6|r[n+2]&63),n+=2)}return i}function Fa(e,t,r){for(var n="",i=0;n.length<t;)n+=r(e+String.fromCharCode.apply(String,[(i&4278190080)>>24,(i&16711680)>>16,(i&65280)>>8,i&255])),i+=1;return n}function pl(e,t,r,n){var i=u.crypto.MessageDigest,s=u.crypto.Util,a=null;r||(r="sha1"),typeof r=="string"&&(a=i.getCanonicalAlgName(r),n=i.getHashLength(a),r=function(v){return He(s.hashHex(et(v),a))}),e=e.toByteArray();var p;for(p=0;p<e.length;p+=1)e[p]&=255;for(;e.length<t;)e.unshift(0);if(e=String.fromCharCode.apply(String,e),e.length<2*n+2)throw"Cipher too short";var o=e.substr(1,n),f=e.substr(n+1),d=Fa(f,n,r),m=[],p;for(p=0;p<o.length;p+=1)m[p]=o.charCodeAt(p)^d.charCodeAt(p);var h=Fa(String.fromCharCode.apply(String,m),e.length-n,r),c=[];for(p=0;p<f.length;p+=1)c[p]=f.charCodeAt(p)^h.charCodeAt(p);if(c=String.fromCharCode.apply(String,c),c.substr(0,n)!==r(""))throw"Hash mismatch";c=c.substr(n);var g=c.indexOf(""),l=g!=-1?c.substr(0,g).lastIndexOf("\0"):-1;if(l+1!=g)throw"Malformed data";return c.substr(g+1)}function vl(e,t,r){if(this.isPrivate=!0,typeof e!="string")this.n=e,this.e=t,this.d=r;else if(e!=null&&t!=null&&e.length>0&&t.length>0)this.n=Oe(e,16),this.e=parseInt(t,16),this.d=Oe(r,16);else throw"Invalid RSA private key"}function yl(e,t,r,n,i,s,a,o){if(this.isPrivate=!0,this.isPublic=!1,e==null)throw"RSASetPrivateEx N == null";if(t==null)throw"RSASetPrivateEx E == null";if(e.length==0)throw"RSASetPrivateEx N.length == 0";if(t.length==0)throw"RSASetPrivateEx E.length == 0";if(e!=null&&t!=null&&e.length>0&&t.length>0)this.n=Oe(e,16),this.e=parseInt(t,16),this.d=Oe(r,16),this.p=Oe(n,16),this.q=Oe(i,16),this.dmp1=Oe(s,16),this.dmq1=Oe(a,16),this.coeff=Oe(o,16);else throw"Invalid RSA private key in RSASetPrivateEx"}function ml(e,t){var r=new Kt,n=e>>1;this.e=parseInt(t,16);for(var i=new B(t,16),s=e/2-100,a=B.ONE.shiftLeft(s);;){for(;this.p=new B(e-n,1,r),!(this.p.subtract(B.ONE).gcd(i).compareTo(B.ONE)==0&&this.p.isProbablePrime(10)););for(;this.q=new B(n,1,r),!(this.q.subtract(B.ONE).gcd(i).compareTo(B.ONE)==0&&this.q.isProbablePrime(10)););if(this.p.compareTo(this.q)<=0){var o=this.p;this.p=this.q,this.q=o}var f=this.q.subtract(this.p).abs();if(!(f.bitLength()<s||f.compareTo(a)<=0)){var d=this.p.subtract(B.ONE),m=this.q.subtract(B.ONE),p=d.multiply(m);if(p.gcd(i).compareTo(B.ONE)==0&&(this.n=this.p.multiply(this.q),this.n.bitLength()==e)){this.d=i.modInverse(p),this.dmp1=this.d.mod(d),this.dmq1=this.d.mod(m),this.coeff=this.q.modInverse(this.p);break}}}this.isPrivate=!0}function Sl(e){if(this.p==null||this.q==null)return e.modPow(this.d,this.n);for(var t=e.mod(this.p).modPow(this.dmp1,this.p),r=e.mod(this.q).modPow(this.dmq1,this.q);t.compareTo(r)<0;)t=t.add(this.p);return t.subtract(r).multiply(this.coeff).mod(this.p).multiply(this.q).add(r)}function xl(e){if(e.length!=Math.ceil(this.n.bitLength()/4))throw new Error("wrong ctext length");var t=Oe(e,16),r=this.doPrivate(t);return r==null?null:gl(r,this.n.bitLength()+7>>3)}function wl(e,t,r){if(e.length!=Math.ceil(this.n.bitLength()/4))throw new Error("wrong ctext length");var n=Oe(e,16),i=this.doPrivate(n);return i==null?null:pl(i,this.n.bitLength()+7>>3,t,r)}W.prototype.doPrivate=Sl;W.prototype.setPrivate=vl;W.prototype.setPrivateEx=yl;W.prototype.generate=ml;W.prototype.decrypt=xl;W.prototype.decryptOAEP=wl;function Ae(e,t){this.x=t,this.q=e}function El(e){return e==this?!0:this.q.equals(e.q)&&this.x.equals(e.x)}function bl(){return this.x}function Pl(){return new Ae(this.q,this.x.negate().mod(this.q))}function Al(e){return new Ae(this.q,this.x.add(e.toBigInteger()).mod(this.q))}function Fl(e){return new Ae(this.q,this.x.subtract(e.toBigInteger()).mod(this.q))}function Cl(e){return new Ae(this.q,this.x.multiply(e.toBigInteger()).mod(this.q))}function Il(){return new Ae(this.q,this.x.square().mod(this.q))}function Dl(e){return new Ae(this.q,this.x.multiply(e.toBigInteger().modInverse(this.q)).mod(this.q))}Ae.prototype.equals=El;Ae.prototype.toBigInteger=bl;Ae.prototype.negate=Pl;Ae.prototype.add=Al;Ae.prototype.subtract=Fl;Ae.prototype.multiply=Cl;Ae.prototype.square=Il;Ae.prototype.divide=Dl;Ae.prototype.sqrt=function(){return new Ae(this.q,this.x.sqrt().mod(this.q))};function ne(e,t,r,n){this.curve=e,this.x=t,this.y=r,n==null?this.z=B.ONE:this.z=n,this.zinv=null}function Rl(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function Bl(){return this.zinv==null&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function _l(e){if(e==this)return!0;if(this.isInfinity())return e.isInfinity();if(e.isInfinity())return this.isInfinity();var t,r;return t=e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q),t.equals(B.ZERO)?(r=e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q),r.equals(B.ZERO)):!1}function Nl(){return this.x==null&&this.y==null?!0:this.z.equals(B.ZERO)&&!this.y.toBigInteger().equals(B.ZERO)}function Tl(){return new ne(this.curve,this.x,this.y.negate(),this.z)}function Ol(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q),r=e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q);if(B.ZERO.equals(r))return B.ZERO.equals(t)?this.twice():this.curve.getInfinity();var n=new B("3"),i=this.x.toBigInteger(),s=this.y.toBigInteger(),a=e.x.toBigInteger(),o=e.y.toBigInteger(),f=r.square(),d=f.multiply(r),m=i.multiply(f),p=t.square().multiply(this.z),h=p.subtract(m.shiftLeft(1)).multiply(e.z).subtract(d).multiply(r).mod(this.curve.q),c=m.multiply(n).multiply(t).subtract(s.multiply(d)).subtract(p.multiply(t)).multiply(e.z).add(t.multiply(d)).mod(this.curve.q),g=d.multiply(this.z).multiply(e.z).mod(this.curve.q);return new ne(this.curve,this.curve.fromBigInteger(h),this.curve.fromBigInteger(c),g)}function Hl(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var e=new B("3"),t=this.x.toBigInteger(),r=this.y.toBigInteger(),n=r.multiply(this.z),i=n.multiply(r).mod(this.curve.q),s=this.curve.a.toBigInteger(),a=t.square().multiply(e);B.ZERO.equals(s)||(a=a.add(this.z.square().multiply(s))),a=a.mod(this.curve.q);var o=a.square().subtract(t.shiftLeft(3).multiply(i)).shiftLeft(1).multiply(n).mod(this.curve.q),f=a.multiply(e).multiply(t).subtract(i.shiftLeft(1)).shiftLeft(2).multiply(i).subtract(a.square().multiply(a)).mod(this.curve.q),d=n.square().multiply(n).shiftLeft(3).mod(this.curve.q);return new ne(this.curve,this.curve.fromBigInteger(o),this.curve.fromBigInteger(f),d)}function jl(e){if(this.isInfinity())return this;if(e.signum()==0)return this.curve.getInfinity();var t=e,r=t.multiply(new B("3")),n=this.negate(),i=this,s=this.curve.q.subtract(e),a=s.multiply(new B("3")),o=new ne(this.curve,this.x,this.y),f=o.negate(),d;for(d=r.bitLength()-2;d>0;--d){i=i.twice();var m=r.testBit(d),p=t.testBit(d);m!=p&&(i=i.add(m?this:n))}for(d=a.bitLength()-2;d>0;--d){o=o.twice();var h=a.testBit(d),c=s.testBit(d);h!=c&&(o=o.add(h?o:f))}return i}function Ml(e,t,r){var n;e.bitLength()>r.bitLength()?n=e.bitLength()-1:n=r.bitLength()-1;for(var i=this.curve.getInfinity(),s=this.add(t);n>=0;)i=i.twice(),e.testBit(n)?r.testBit(n)?i=i.add(s):i=i.add(this):r.testBit(n)&&(i=i.add(t)),--n;return i}ne.prototype.getX=Rl;ne.prototype.getY=Bl;ne.prototype.equals=_l;ne.prototype.isInfinity=Nl;ne.prototype.negate=Tl;ne.prototype.add=Ol;ne.prototype.twice=Hl;ne.prototype.multiply=jl;ne.prototype.multiplyTwo=Ml;function Dt(e,t,r){this.q=e,this.a=this.fromBigInteger(t),this.b=this.fromBigInteger(r),this.infinity=new ne(this,null,null)}function Kl(){return this.q}function Vl(){return this.a}function ql(){return this.b}function Ll(e){return e==this?!0:this.q.equals(e.q)&&this.a.equals(e.a)&&this.b.equals(e.b)}function kl(){return this.infinity}function Ul(e){return new Ae(this.q,e)}function Gl(e){switch(parseInt(e.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:var t=e.substr(0,2),r=e.substr(2),n=this.fromBigInteger(new B(d,16)),i=this.getA(),s=this.getB(),a=n.square().add(i).multiply(n).add(s),o=a.sqrt();return t=="03"&&(o=o.negate()),new ne(this,n,o);case 4:case 6:case 7:var f=(e.length-2)/2,d=e.substr(2,f),m=e.substr(f+2,f);return new ne(this,this.fromBigInteger(new B(d,16)),this.fromBigInteger(new B(m,16)));default:return null}}Dt.prototype.getQ=Kl;Dt.prototype.getA=Vl;Dt.prototype.getB=ql;Dt.prototype.equals=Ll;Dt.prototype.getInfinity=kl;Dt.prototype.fromBigInteger=Ul;Dt.prototype.decodePointHex=Gl;Ae.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)};ne.prototype.getEncoded=function(e){var t=function(s,a){var o=s.toByteArrayUnsigned();if(a<o.length)o=o.slice(o.length-a);else for(;a>o.length;)o.unshift(0);return o},r=this.getX().toBigInteger(),n=this.getY().toBigInteger(),i=t(r,32);return e?n.isEven()?i.unshift(2):i.unshift(3):(i.unshift(4),i=i.concat(t(n,32))),i};ne.decodeFrom=function(e,t){var r=t[0],n=t.length-1,i=t.slice(1,1+n/2),s=t.slice(1+n/2,1+n);i.unshift(0),s.unshift(0);var a=new B(i),o=new B(s);return new ne(e,e.fromBigInteger(a),e.fromBigInteger(o))};ne.decodeFromHex=function(e,t){var r=t.substr(0,2),n=t.length-2,i=t.substr(2,n/2),s=t.substr(2+n/2,n/2),a=new B(i,16),o=new B(s,16);return new ne(e,e.fromBigInteger(a),e.fromBigInteger(o))};ne.prototype.add2D=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;if(this.x.equals(e.x))return this.y.equals(e.y)?this.twice():this.curve.getInfinity();var t=e.x.subtract(this.x),r=e.y.subtract(this.y),n=r.divide(t),i=n.square().subtract(this.x).subtract(e.x),s=n.multiply(this.x.subtract(i)).subtract(this.y);return new ne(this.curve,i,s)};ne.prototype.twice2D=function(){if(this.isInfinity())return this;if(this.y.toBigInteger().signum()==0)return this.curve.getInfinity();var e=this.curve.fromBigInteger(B.valueOf(2)),t=this.curve.fromBigInteger(B.valueOf(3)),r=this.x.square().multiply(t).add(this.curve.a).divide(this.y.multiply(e)),n=r.square().subtract(this.x.multiply(e)),i=r.multiply(this.x.subtract(n)).subtract(this.y);return new ne(this.curve,n,i)};ne.prototype.multiply2D=function(e){if(this.isInfinity())return this;if(e.signum()==0)return this.curve.getInfinity();var t=e,r=t.multiply(new B("3")),n=this.negate(),i=this,s;for(s=r.bitLength()-2;s>0;--s){i=i.twice();var a=r.testBit(s),o=t.testBit(s);a!=o&&(i=i.add2D(a?this:n))}return i};ne.prototype.isOnCurve=function(){var e=this.getX().toBigInteger(),t=this.getY().toBigInteger(),r=this.curve.getA().toBigInteger(),n=this.curve.getB().toBigInteger(),i=this.curve.getQ(),s=t.multiply(t).mod(i),a=e.multiply(e).multiply(e).add(r.multiply(e)).add(n).mod(i);return s.equals(a)};ne.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"};ne.prototype.validate=function(){var e=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var t=this.getX().toBigInteger(),r=this.getY().toBigInteger();if(t.compareTo(B.ONE)<0||t.compareTo(e.subtract(B.ONE))>0)throw new Error("x coordinate out of bounds");if(r.compareTo(B.ONE)<0||r.compareTo(e.subtract(B.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(e).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};var Ta=function(){var e="(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)",t='(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))',r='(?:"'+t+'*")',n=new RegExp("(?:false|true|null|[\\{\\}\\[\\]]|"+e+"|"+r+")","g"),i=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),s={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"};function a(p,h,c){return h?s[h]:String.fromCharCode(parseInt(c,16))}var o=new String(""),f="\\",d={"{":Object,"[":Array},m=Object.hasOwnProperty;return function(p,h){var c=p.match(n),g,l=c[0],v=!1;l==="{"?g={}:l==="["?g=[]:(g=[],v=!0);for(var y,x=[g],E=1-v,P=c.length;E<P;++E){l=c[E];var b;switch(l.charCodeAt(0)){default:b=x[0],b[y||b.length]=+l,y=void 0;break;case 34:if(l=l.substring(1,l.length-1),l.indexOf(f)!==-1&&(l=l.replace(i,a)),b=x[0],!y)if(b instanceof Array)y=b.length;else{y=l||o;break}b[y]=l,y=void 0;break;case 91:b=x[0],x.unshift(b[y||b.length]=[]),y=void 0;break;case 93:x.shift();break;case 102:b=x[0],b[y||b.length]=!1,y=void 0;break;case 110:b=x[0],b[y||b.length]=null,y=void 0;break;case 116:b=x[0],b[y||b.length]=!0,y=void 0;break;case 123:b=x[0],x.unshift(b[y||b.length]={}),y=void 0;break;case 125:x.shift();break}}if(v){if(x.length!==1)throw new Error;g=g[0]}else if(x.length)throw new Error;if(h){var R=function(T,S){var w=T[S];if(w&&typeof w=="object"){var A=null;for(var F in w)if(m.call(w,F)&&w!==T){var I=R(w,F);I!==void 0?w[F]=I:(A||(A=[]),A.push(F))}if(A)for(var N=A.length;--N>=0;)delete w[A[N]]}return h.call(T,S,w)};g=R({"":g},"")}return g}}();(typeof u>"u"||!u)&&(u={});(typeof u.asn1>"u"||!u.asn1)&&(u.asn1={});u.asn1.ASN1Util=new function(){this.integerToByteHex=function(e){var t=e.toString(16);return t.length%2==1&&(t="0"+t),t},this.bigIntToMinTwosComplementsHex=function(e){return Lr(e)},this.getPEMStringFromHex=function(e,t){return Te(e,t)},this.newObject=function(e){var t=u,r=t.asn1,n=r.ASN1Object,i=r.DERBoolean,s=r.DERInteger,a=r.DERBitString,o=r.DEROctetString,f=r.DERNull,d=r.DERObjectIdentifier,m=r.DEREnumerated,p=r.DERUTF8String,h=r.DERNumericString,c=r.DERPrintableString,g=r.DERTeletexString,l=r.DERIA5String,v=r.DERUTCTime,y=r.DERGeneralizedTime,x=r.DERVisibleString,E=r.DERBMPString,P=r.DERSequence,b=r.DERSet,R=r.DERTaggedObject,T=r.ASN1Util.newObject;if(e instanceof r.ASN1Object)return e;var S=Object.keys(e);if(S.length!=1)throw new Error("key of param shall be only one.");var w=S[0];if(":asn1:bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:visstr:bmpstr:seq:set:tag:".indexOf(":"+w+":")==-1)throw new Error("undefined key: "+w);if(w=="bool")return new i(e[w]);if(w=="int")return new s(e[w]);if(w=="bitstr")return new a(e[w]);if(w=="octstr")return new o(e[w]);if(w=="null")return new f(e[w]);if(w=="oid")return new d(e[w]);if(w=="enum")return new m(e[w]);if(w=="utf8str")return new p(e[w]);if(w=="numstr")return new h(e[w]);if(w=="prnstr")return new c(e[w]);if(w=="telstr")return new g(e[w]);if(w=="ia5str")return new l(e[w]);if(w=="utctime")return new v(e[w]);if(w=="gentime")return new y(e[w]);if(w=="visstr")return new x(e[w]);if(w=="bmpstr")return new E(e[w]);if(w=="asn1")return new n(e[w]);if(w=="seq"){for(var A=e[w],F=[],I=0;I<A.length;I++){var N=T(A[I]);F.push(N)}return new P({array:F})}if(w=="set"){for(var A=e[w],F=[],I=0;I<A.length;I++){var N=T(A[I]);F.push(N)}return new b({array:F})}if(w=="tag"){var C=e[w];if(Object.prototype.toString.call(C)==="[object Array]"&&C.length==3){var D=T(C[2]);return new R({tag:C[0],explicit:C[1],obj:D})}else return new R(C)}},this.jsonToASN1HEX=function(e){var t=this.newObject(e);return t.tohex()}};u.asn1.ASN1Util.oidHexToInt=function(e){for(var i="",t=parseInt(e.substr(0,2),16),r=Math.floor(t/40),n=t%40,i=r+"."+n,s="",a=2;a<e.length;a+=2){var o=parseInt(e.substr(a,2),16),f=("00000000"+o.toString(2)).slice(-8);if(s=s+f.substr(1,7),f.substr(0,1)=="0"){var d=new B(s,2);i=i+"."+d.toString(10),s=""}}return i};u.asn1.ASN1Util.oidIntToHex=function(e){var t=function(o){var f=o.toString(16);return f.length==1&&(f="0"+f),f},r=function(o){var f="",d=new B(o,10),m=d.toString(2),p=7-m.length%7;p==7&&(p=0);for(var h="",c=0;c<p;c++)h+="0";m=h+m;for(var c=0;c<m.length-1;c+=7){var g=m.substr(c,7);c!=m.length-7&&(g="1"+g),f+=t(parseInt(g,2))}return f};if(!e.match(/^[0-9.]+$/))throw"malformed oid string: "+e;var n="",i=e.split("."),s=parseInt(i[0])*40+parseInt(i[1]);n+=t(s),i.splice(0,2);for(var a=0;a<i.length;a++)n+=r(i[a]);return n};u.asn1.ASN1Object=function(e){var t=!0,r=null,n="00",i="00",s="";this.params=null,this.getLengthHexFromValue=function(){if(typeof this.hV>"u"||this.hV==null)throw new Error("this.hV is null or undefined");if(this.hV.length%2==1)throw new Error("value hex must be even length: n="+s.length+",v="+this.hV);var a=this.hV.length/2,o=a.toString(16);if(o.length%2==1&&(o="0"+o),a<128)return o;var f=o.length/2;if(f>15)throw new Error("ASN.1 length too long to represent by 8x: n = "+a.toString(16));var d=128+f;return d.toString(16)+o},this.tohex=function(){return(this.hTLV==null||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.getValueHex=function(){return this.tohex(),this.hV},this.getFreshValueHex=function(){return""},this.setByParam=function(a){this.params=a},e!=null&&e.tlv!=null&&(this.hTLV=e.tlv,this.isModified=!1)};u.asn1.DERAbstractString=function(e){u.asn1.DERAbstractString.superclass.constructor.call(this);var t=null,r=null;this.getString=function(){return this.s},this.setString=function(n){this.hTLV=null,this.isModified=!0,this.s=n,this.hV=Tn(this.s).toLowerCase()},this.setStringHex=function(n){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=n},this.getFreshValueHex=function(){return this.hV},typeof e<"u"&&(typeof e=="string"?this.setString(e):typeof e.str<"u"?this.setString(e.str):typeof e.hex<"u"&&this.setStringHex(e.hex))};H(u.asn1.DERAbstractString,u.asn1.ASN1Object);u.asn1.DERAbstractTime=function(e){u.asn1.DERAbstractTime.superclass.constructor.call(this);var t=null,r=null;this.localDateToUTC=function(n){var i=n.getTime()+n.getTimezoneOffset()*6e4,s=new Date(i);return s},this.formatDate=function(n,i,s){var a=this.zeroPadding,o=this.localDateToUTC(n),f=String(o.getFullYear());i=="utc"&&(f=f.substr(2,2));var d=a(String(o.getMonth()+1),2),m=a(String(o.getDate()),2),p=a(String(o.getHours()),2),h=a(String(o.getMinutes()),2),c=a(String(o.getSeconds()),2),g=f+d+m+p+h+c;if(s===!0){var l=o.getMilliseconds();if(l!=0){var v=a(String(l),3);v=v.replace(/[0]+$/,""),g=g+"."+v}}return g+"Z"},this.zeroPadding=function(n,i){return n.length>=i?n:new Array(i-n.length+1).join("0")+n},this.setByParam=function(n){this.hV=null,this.hTLV=null,this.params=n},this.getString=function(){},this.setString=function(n){this.hTLV=null,this.isModified=!0,this.params==null&&(this.params={}),this.params.str=n},this.setByDate=function(n){this.hTLV=null,this.isModified=!0,this.params==null&&(this.params={}),this.params.date=n},this.setByDateValue=function(n,i,s,a,o,f){var d=new Date(Date.UTC(n,i-1,s,a,o,f,0));this.setByDate(d)},this.getFreshValueHex=function(){return this.hV}};H(u.asn1.DERAbstractTime,u.asn1.ASN1Object);u.asn1.DERAbstractStructured=function(e){u.asn1.DERAbstractString.superclass.constructor.call(this);var t=null;this.setByASN1ObjectArray=function(r){this.hTLV=null,this.isModified=!0,this.asn1Array=r},this.appendASN1Object=function(r){this.hTLV=null,this.isModified=!0,this.asn1Array.push(r)},this.asn1Array=new Array,typeof e<"u"&&typeof e.array<"u"&&(this.asn1Array=e.array)};H(u.asn1.DERAbstractStructured,u.asn1.ASN1Object);u.asn1.DERBoolean=function(e){u.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",e==!1?this.hTLV="010100":this.hTLV="0101ff"};H(u.asn1.DERBoolean,u.asn1.ASN1Object);u.asn1.DERInteger=function(e){u.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.params=null;var t=Lr;this.setByBigInteger=function(r){this.isModified=!0,this.params={bigint:r}},this.setByInteger=function(r){this.isModified=!0,this.params=r},this.setValueHex=function(r){this.isModified=!0,this.params={hex:r}},this.getFreshValueHex=function(){var r=this.params,n=null;if(r==null)throw new Error("value not set");if(typeof r=="object"&&r.hex!=null)return this.hV=r.hex,this.hV;if(typeof r=="number")n=new B(String(r),10);else if(r.int!=null)n=new B(String(r.int),10);else if(r.bigint!=null)n=r.bigint;else throw new Error("wrong parameter");return this.hV=t(n),this.hV},e!=null&&(this.params=e)};H(u.asn1.DERInteger,u.asn1.ASN1Object);u.asn1.DERBitString=function(e){if(e!==void 0&&typeof e.obj<"u"){var t=u.asn1.ASN1Util.newObject(e.obj);e.hex="00"+t.tohex()}u.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(r){this.hTLV=null,this.isModified=!0,this.hV=r},this.setUnusedBitsAndHexValue=function(r,n){if(r<0||7<r)throw"unused bits shall be from 0 to 7: u = "+r;var i="0"+r;this.hTLV=null,this.isModified=!0,this.hV=i+n},this.setByBinaryString=function(r){r=r.replace(/0+$/,"");var n=8-r.length%8;n==8&&(n=0),r+="0000000".substr(0,n);for(var i="",s=0;s<r.length-1;s+=8){var a=r.substr(s,8),o=parseInt(a,2).toString(16);o.length==1&&(o="0"+o),i+=o}this.hTLV=null,this.isModified=!0,this.hV="0"+n+i},this.setByBooleanArray=function(r){for(var n="",i=0;i<r.length;i++)r[i]==!0?n+="1":n+="0";this.setByBinaryString(n)},this.newFalseArray=function(r){for(var n=new Array(r),i=0;i<r;i++)n[i]=!1;return n},this.getFreshValueHex=function(){return this.hV},typeof e<"u"&&(typeof e=="string"&&e.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(e):typeof e.hex<"u"?this.setHexValueIncludingUnusedBits(e.hex):typeof e.bin<"u"?this.setByBinaryString(e.bin):typeof e.array<"u"&&this.setByBooleanArray(e.array))};H(u.asn1.DERBitString,u.asn1.ASN1Object);u.asn1.DEROctetString=function(e){if(e!==void 0&&typeof e.obj<"u"){var t=u.asn1.ASN1Util.newObject(e.obj);e.hex=t.tohex()}u.asn1.DEROctetString.superclass.constructor.call(this,e),this.hT="04"};H(u.asn1.DEROctetString,u.asn1.DERAbstractString);u.asn1.DERNull=function(){u.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"};H(u.asn1.DERNull,u.asn1.ASN1Object);u.asn1.DERObjectIdentifier=function(e){u.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueOidString=function(t){var r=qa(t);if(r==null)throw new Error("malformed oid string: "+t);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=r},this.setValueName=function(t){var r=u.asn1.x509.OID.name2oid(t);if(r!=="")this.setValueOidString(r);else throw new Error("DERObjectIdentifier oidName undefined: "+t)},this.setValueNameOrOid=function(t){t.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(t):this.setValueName(t)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(t){typeof t=="string"?this.setValueNameOrOid(t):t.oid!==void 0?this.setValueNameOrOid(t.oid):t.name!==void 0?this.setValueNameOrOid(t.name):t.hex!==void 0&&this.setValueHex(t.hex)},e!==void 0&&this.setByParam(e)};H(u.asn1.DERObjectIdentifier,u.asn1.ASN1Object);u.asn1.DEREnumerated=function(e){u.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=Lr(t)},this.setByInteger=function(t){var r=new B(String(t),10);this.setByBigInteger(r)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},typeof e<"u"&&(typeof e.int<"u"?this.setByInteger(e.int):typeof e=="number"?this.setByInteger(e):typeof e.hex<"u"&&this.setValueHex(e.hex))};H(u.asn1.DEREnumerated,u.asn1.ASN1Object);u.asn1.DERUTF8String=function(e){u.asn1.DERUTF8String.superclass.constructor.call(this,e),this.hT="0c"};H(u.asn1.DERUTF8String,u.asn1.DERAbstractString);u.asn1.DERNumericString=function(e){u.asn1.DERNumericString.superclass.constructor.call(this,e),this.hT="12"};H(u.asn1.DERNumericString,u.asn1.DERAbstractString);u.asn1.DERPrintableString=function(e){u.asn1.DERPrintableString.superclass.constructor.call(this,e),this.hT="13"};H(u.asn1.DERPrintableString,u.asn1.DERAbstractString);u.asn1.DERTeletexString=function(e){u.asn1.DERTeletexString.superclass.constructor.call(this,e),this.hT="14"};H(u.asn1.DERTeletexString,u.asn1.DERAbstractString);u.asn1.DERIA5String=function(e){u.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="16"};H(u.asn1.DERIA5String,u.asn1.DERAbstractString);u.asn1.DERVisibleString=function(e){u.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="1a"};H(u.asn1.DERVisibleString,u.asn1.DERAbstractString);u.asn1.DERBMPString=function(e){u.asn1.DERBMPString.superclass.constructor.call(this,e),this.hT="1e"};H(u.asn1.DERBMPString,u.asn1.DERAbstractString);u.asn1.DERUTCTime=function(e){u.asn1.DERUTCTime.superclass.constructor.call(this,e),this.hT="17",this.params=void 0,this.getFreshValueHex=function(){var t=this.params;if(this.params==null&&(t={date:new Date}),typeof t=="string")if(t.match(/^[0-9]{12}Z$/)||t.match(/^[0-9]{12}\.[0-9]+Z$/))this.hV=Ge(t);else throw new Error("malformed string for UTCTime: "+t);else if(t.str!=null)this.hV=Ge(t.str);else if(t.date==null&&t.millis==!0){var r=new Date;this.hV=Ge(this.formatDate(r,"utc",!0))}else if(t.date!=null&&t.date instanceof Date){var n=t.millis===!0;this.hV=Ge(this.formatDate(t.date,"utc",n))}else t instanceof Date&&(this.hV=Ge(this.formatDate(t,"utc")));if(this.hV==null)throw new Error("parameter not specified properly for UTCTime");return this.hV},e!=null&&this.setByParam(e)};H(u.asn1.DERUTCTime,u.asn1.DERAbstractTime);u.asn1.DERGeneralizedTime=function(e){u.asn1.DERGeneralizedTime.superclass.constructor.call(this,e),this.hT="18",this.params=e,this.getFreshValueHex=function(){var t=this.params;if(this.params==null&&(t={date:new Date}),typeof t=="string")if(t.match(/^[0-9]{14}Z$/)||t.match(/^[0-9]{14}\.[0-9]+Z$/))this.hV=Ge(t);else throw new Error("malformed string for GeneralizedTime: "+t);else if(t.str!=null)this.hV=Ge(t.str);else if(t.date==null&&t.millis==!0){var r=new Date;this.hV=Ge(this.formatDate(r,"gen",!0))}else if(t.date!=null&&t.date instanceof Date){var n=t.millis===!0;this.hV=Ge(this.formatDate(t.date,"gen",n))}else t instanceof Date&&(this.hV=Ge(this.formatDate(t,"gen")));if(this.hV==null)throw new Error("parameter not specified properly for GeneralizedTime");return this.hV},e!=null&&this.setByParam(e)};H(u.asn1.DERGeneralizedTime,u.asn1.DERAbstractTime);u.asn1.DERSequence=function(e){u.asn1.DERSequence.superclass.constructor.call(this,e),this.hT="30",this.getFreshValueHex=function(){for(var t="",r=0;r<this.asn1Array.length;r++){var n=this.asn1Array[r];t+=n.tohex()}return this.hV=t,this.hV}};H(u.asn1.DERSequence,u.asn1.DERAbstractStructured);u.asn1.DERSet=function(e){u.asn1.DERSet.superclass.constructor.call(this,e),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var t=new Array,r=0;r<this.asn1Array.length;r++){var n=this.asn1Array[r];t.push(n.tohex())}return this.sortFlag==!0&&t.sort(),this.hV=t.join(""),this.hV},typeof e<"u"&&typeof e.sortflag<"u"&&e.sortflag==!1&&(this.sortFlag=!1)};H(u.asn1.DERSet,u.asn1.DERAbstractStructured);u.asn1.DERTaggedObject=function(e){u.asn1.DERTaggedObject.superclass.constructor.call(this);var t=u.asn1,r=K,n=r.getV,i=r.isASN1HEX,s=t.ASN1Util.newObject;this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.params={tag:"a0",explicit:!0},this.setASN1Object=function(a,o,f){this.params={tag:o,explicit:a,obj:f}},this.getFreshValueHex=function(){var a=this.params;if(a.explicit==null&&(a.explicit=!0),a.tage!=null&&(a.tag=a.tage,a.explicit=!0),a.tagi!=null&&(a.tag=a.tagi,a.explicit=!1),a.str!=null)this.hV=Tn(a.str);else if(a.hex!=null)this.hV=a.hex;else if(a.obj!=null){var o;a.obj instanceof t.ASN1Object?o=a.obj.tohex():typeof a.obj=="object"&&(o=s(a.obj).tohex()),a.explicit?this.hV=o:this.hV=n(o,0)}else throw new Error("str, hex nor obj not specified");return a.tag==null&&(a.tag="a0"),this.hT=a.tag,this.hTLV=null,this.isModified=!0,this.hV},this.setByParam=function(a){this.params=a},e!==void 0&&this.setByParam(e)};H(u.asn1.DERTaggedObject,u.asn1.ASN1Object);var K=new function(){};K.getLblen=function(e,t){if(e.substr(t+2,1)!="8")return 1;var r=parseInt(e.substr(t+3,1));return r==0?-1:0<r&&r<10?r+1:-2};K.getL=function(e,t){var r=K.getLblen(e,t);return r<1?"":e.substr(t+2,r*2)};K.getVblen=function(e,t){var r,n;return r=K.getL(e,t),r==""?-1:(r.substr(0,1)==="8"?n=new B(r.substr(2),16):n=new B(r,16),n.intValue())};K.getVidx=function(e,t){var r=K.getLblen(e,t);return r<0?r:t+(r+1)*2};K.getV=function(e,t){var r=K.getVidx(e,t),n=K.getVblen(e,t);return e.substr(r,n*2)};K.getTLV=function(e,t){return e.substr(t,2)+K.getL(e,t)+K.getV(e,t)};K.getTLVblen=function(e,t){return 2+K.getLblen(e,t)*2+K.getVblen(e,t)*2};K.getNextSiblingIdx=function(e,t){var r=K.getVidx(e,t),n=K.getVblen(e,t);return r+n*2};K.getChildIdx=function(e,t){var r=K,n=[],i,s,a;i=r.getVidx(e,t),s=r.getVblen(e,t)*2,e.substr(t,2)=="03"&&(i+=2,s-=2),a=0;for(var o=i;a<=s;){var f=r.getTLVblen(e,o);if(a+=f,a<=s&&n.push(o),o+=f,a>=s)break}return n};K.getNthChildIdx=function(e,t,r){var n=K.getChildIdx(e,t);return n[r]};K.getIdxbyList=function(e,t,r,n){var i=K,s,a;return r.length==0?n!==void 0&&e.substr(t,2)!==n?-1:t:(s=r.shift(),a=i.getChildIdx(e,t),s>=a.length?-1:i.getIdxbyList(e,a[s],r,n))};K.getIdxbyListEx=function(e,t,r,n){var i=K,s,a;if(r.length==0)return n!==void 0&&e.substr(t,2)!==n?-1:t;s=r.shift(),a=i.getChildIdx(e,t);for(var o=0,f=0;f<a.length;f++){var d=e.substr(a[f],2);if(typeof s=="number"&&!i.isContextTag(d)&&o==s||typeof s=="string"&&i.isContextTag(d,s))return i.getIdxbyListEx(e,a[f],r,n);i.isContextTag(d)||o++}return-1};K.getTLVbyList=function(e,t,r,n){var i=K,s=i.getIdxbyList(e,t,r,n);return s==-1||s>=e.length?null:i.getTLV(e,s)};K.getTLVbyListEx=function(e,t,r,n){var i=K,s=i.getIdxbyListEx(e,t,r,n);return s==-1?null:i.getTLV(e,s)};K.getVbyList=function(e,t,r,n,i){var s=K,a,o;return a=s.getIdxbyList(e,t,r,n),a==-1||a>=e.length?null:(o=s.getV(e,a),i===!0&&(o=o.substr(2)),o)};K.getVbyListEx=function(e,t,r,n,i){var s=K,a,o,f;return a=s.getIdxbyListEx(e,t,r,n),a==-1?null:(f=s.getV(e,a),e.substr(a,2)=="03"&&i!==!1&&(f=f.substr(2)),f)};K.getInt=function(e,t,r){r==null&&(r=-1);try{var n=e.substr(t,2);if(n!="02"&&n!="03")return r;var i=K.getV(e,t);return n=="02"?parseInt(i,16):ka(i)}catch{return r}};K.getOID=function(e,t,r){r==null&&(r=null);try{if(e.substr(t,2)!="06")return r;var n=K.getV(e,t);return Kn(n)}catch{return r}};K.getOIDName=function(e,t,r){r==null&&(r=null);try{var n=K.getOID(e,t,r);if(n==r)return r;var i=u.asn1.x509.OID.oid2name(n);return i==""?n:i}catch{return r}};K.getString=function(e,t,r){r==null&&(r=null);try{var n=K.getV(e,t);return He(n)}catch{return r}};K.hextooidstr=function(e){var t=function(p,h){return p.length>=h?p:new Array(h-p.length+1).join("0")+p},r=[],n=e.substr(0,2),i=parseInt(n,16);r[0]=new String(Math.floor(i/40)),r[1]=new String(i%40);for(var s=e.substr(2),a=[],o=0;o<s.length/2;o++)a.push(parseInt(s.substr(o*2,2),16));for(var f=[],d="",o=0;o<a.length;o++)a[o]&128?d=d+t((a[o]&127).toString(2),7):(d=d+t((a[o]&127).toString(2),7),f.push(new String(parseInt(d,2))),d="");var m=r.join(".");return f.length>0&&(m=m+"."+f.join(".")),m};K.dump=function(e,t,r,n){var i=K,s=i.getV,a=i.dump,o=i.getChildIdx,f=e;e instanceof u.asn1.ASN1Object&&(f=e.tohex());var d=function(T,S){if(T.length<=S*2)return T;var w=T.substr(0,S)+"..(total "+T.length/2+"bytes).."+T.substr(T.length-S,S);return w};t===void 0&&(t={ommit_long_octet:32}),r===void 0&&(r=0),n===void 0&&(n="");var m=t.ommit_long_octet,b=f.substr(r,2);if(b=="01"){var p=s(f,r);return p=="00"?n+`BOOLEAN FALSE
`:n+`BOOLEAN TRUE
`}if(b=="02"){var p=s(f,r);return n+"INTEGER "+d(p,m)+`
`}if(b=="03"){var p=s(f,r);if(i.isASN1HEX(p.substr(2))){var h=n+`BITSTRING, encapsulates
`;return h=h+a(p.substr(2),t,0,n+"  "),h}else return n+"BITSTRING "+d(p,m)+`
`}if(b=="04"){var p=s(f,r);if(i.isASN1HEX(p)){var h=n+`OCTETSTRING, encapsulates
`;return h=h+a(p,t,0,n+"  "),h}else return n+"OCTETSTRING "+d(p,m)+`
`}if(b=="05")return n+`NULL
`;if(b=="06"){var c=s(f,r),g=u.asn1.ASN1Util.oidHexToInt(c),l=u.asn1.x509.OID.oid2name(g),v=g.replace(/\./g," ");return l!=""?n+"ObjectIdentifier "+l+" ("+v+`)
`:n+"ObjectIdentifier ("+v+`)
`}if(b=="0a")return n+"ENUMERATED "+parseInt(s(f,r))+`
`;if(b=="0c")return n+"UTF8String '"+ae(s(f,r))+`'
`;if(b=="13")return n+"PrintableString '"+ae(s(f,r))+`'
`;if(b=="14")return n+"TeletexString '"+ae(s(f,r))+`'
`;if(b=="16")return n+"IA5String '"+ae(s(f,r))+`'
`;if(b=="17")return n+"UTCTime "+ae(s(f,r))+`
`;if(b=="18")return n+"GeneralizedTime "+ae(s(f,r))+`
`;if(b=="1a")return n+"VisualString '"+ae(s(f,r))+`'
`;if(b=="1e")return n+"BMPString '"+Gi(s(f,r))+`'
`;if(b=="30"){if(f.substr(r,4)=="3000")return n+`SEQUENCE {}
`;var h=n+`SEQUENCE
`,y=o(f,r),x=t;if((y.length==2||y.length==3)&&f.substr(y[0],2)=="06"&&f.substr(y[y.length-1],2)=="04"){var l=i.oidname(s(f,y[0])),E=JSON.parse(JSON.stringify(t));E.x509ExtName=l,x=E}for(var P=0;P<y.length;P++)h=h+a(f,x,y[P],n+"  ");return h}if(b=="31"){for(var h=n+`SET
`,y=o(f,r),P=0;P<y.length;P++)h=h+a(f,t,y[P],n+"  ");return h}var b=parseInt(b,16);if((b&128)!=0){var R=b&31;if((b&32)!=0){for(var h=n+"["+R+`]
`,y=o(f,r),P=0;P<y.length;P++)h=h+a(f,t,y[P],n+"  ");return h}else{var p=s(f,r);if(K.isASN1HEX(p)){var h=n+"["+R+`]
`;return h=h+a(p,t,0,n+"  "),h}else(p.substr(0,8)=="68747470"||t.x509ExtName==="subjectAltName"&&R==2)&&(p=ae(p));var h=n+"["+R+"] "+p+`
`;return h}}return n+"UNKNOWN("+b+") "+s(f,r)+`
`};K.parse=function(e){var t=K,r=t.parse,n=t.isASN1HEX,i=t.getV,s=t.getTLV,a=t.getChildIdx,o=u.asn1,f=o.ASN1Util.oidHexToInt,d=o.x509.OID.oid2name,m=ae,p=Gi,h=Yl,c={"0c":"utf8str",12:"numstr",13:"prnstr",14:"telstr",16:"ia5str",17:"utctime",18:"gentime","1a":"visstr","1e":"bmpstr",30:"seq",31:"set"},g=function(w){for(var A=[],F=a(w,0),I=0;I<F.length;I++){var N=F[I],C=s(w,N),D=r(C);A.push(D)}return A},l=e.substr(0,2),v={},y=i(e,0);if(l=="01")return e=="0101ff"?{bool:!0}:{bool:!1};if(l=="02")return{int:{hex:y}};if(l=="03")try{if(y.substr(0,2)!="00")throw"not encap";var x=y.substr(2);if(!n(x))throw"not encap";return{bitstr:{obj:r(x)}}}catch{var E=null;return y.length<=10&&(E=Ga(y)),E==null?{bitstr:{hex:y}}:{bitstr:{bin:E}}}else if(l=="04")try{if(!n(y))throw"not encap";return{octstr:{obj:r(y)}}}catch{return{octstr:{hex:y}}}else{if(l=="05")return{null:""};if(l=="06"){var P=f(y),b=d(P);return b==""?{oid:P}:{oid:b}}else{if(l=="0a")return y.length>4?{enum:{hex:y}}:{enum:parseInt(y,16)};if(l=="30"||l=="31")return v[c[l]]=g(e),v;if(l=="14"){var R=h(y);return v[c[l]]={str:R},v}else if(l=="1e"){var R=p(y);return v[c[l]]={str:R},v}else if(":0c:12:13:16:17:18:1a:".indexOf(l)!=-1){var R=m(y);return v[c[l]]={str:R},v}else if(l.match(/^8[0-9]$/)){var R=m(y);return R==null|R==""?{tag:{tag:l,explicit:!1,hex:y}}:R.match(/[\x00-\x1F\x7F-\x9F]/)!=null||R.match(/[\u0000-\u001F\u0080\u009F]/)!=null?{tag:{tag:l,explicit:!1,hex:y}}:{tag:{tag:l,explicit:!1,str:R}}}else if(l.match(/^a[0-9]$/))try{if(!n(y))throw new Error("not encap");return{tag:{tag:l,explicit:!0,obj:r(y)}}}catch{return{tag:{tag:l,explicit:!0,hex:y}}}else{var T=new u.asn1.ASN1Object;T.hV=y;var S=T.getLengthHexFromValue();return{asn1:{tlv:l+S+y}}}}}};K.isContextTag=function(e,t){e=e.toLowerCase();var r,n;try{r=parseInt(e,16)}catch{return-1}if(t===void 0)return(r&192)==128;try{var i=t.match(/^\[[0-9]+\]$/);return i==null||(n=parseInt(t.substr(1,t.length-1),10),n>31)?!1:(r&192)==128&&(r&31)==n}catch{return!1}};K.isASN1HEX=function(e){var t=K;if(e.length%2==1)return!1;var r=t.getVblen(e,0),n=e.substr(0,2),i=t.getL(e,0),s=e.length-n.length-i.length;return s==r*2};K.checkStrictDER=function(e,t,r,n,i){var s=K;if(r===void 0){if(typeof e!="string")throw new Error("not hex string");if(e=e.toLowerCase(),!u.lang.String.isHex(e))throw new Error("not hex string");r=e.length,n=e.length/2,n<128?i=1:i=Math.ceil(n.toString(16))+1}var a=s.getL(e,t);if(a.length>i*2)throw new Error("L of TLV too long: idx="+t);var o=s.getVblen(e,t);if(o>n)throw new Error("value of L too long than hex: idx="+t);var f=s.getTLV(e,t),d=f.length-2-s.getL(e,t).length;if(d!==o*2)throw new Error("V string length and L's value not the same:"+d+"/"+o*2);if(t===0&&e.length!=f.length)throw new Error("total length and TLV length unmatch:"+e.length+"!="+f.length);var m=e.substr(t,2);if(m==="02"){var p=s.getVidx(e,t);if(e.substr(p,2)=="00"&&e.charCodeAt(p+2)<56)throw new Error("not least zeros for DER INTEGER")}if(parseInt(m,16)&32){for(var h=s.getVblen(e,t),c=0,g=s.getChildIdx(e,t),l=0;l<g.length;l++){var v=s.getTLV(e,g[l]);c+=v.length,s.checkStrictDER(e,g[l],r,n,i)}if(h*2!=c)throw new Error("sum of children's TLV length and L unmatch: "+h*2+"!="+c)}};K.oidname=function(e){var t=u.asn1;u.lang.String.isHex(e)&&(e=t.ASN1Util.oidHexToInt(e));var r=t.x509.OID.oid2name(e);return r===""&&(r=e),r};(typeof u>"u"||!u)&&(u={});(typeof u.asn1>"u"||!u.asn1)&&(u.asn1={});(typeof u.asn1.x509>"u"||!u.asn1.x509)&&(u.asn1.x509={});u.asn1.x509.Certificate=function(e){u.asn1.x509.Certificate.superclass.constructor.call(this);var t=u,r=t.asn1,n=r.DERBitString,i=r.DERSequence,s=r.x509,a=s.TBSCertificate,o=s.AlgorithmIdentifier;this.params=void 0,this.setByParam=function(f){this.params=f},this.sign=function(){var f=this.params,d=f.sigalg;f.sigalg.name!=null&&(d=f.sigalg.name);var m=f.tbsobj.tohex(),p=new u.crypto.Signature({alg:d});p.init(f.cakey),p.updateHex(m),f.sighex=p.sign()},this.getPEM=function(){return Te(this.tohex(),"CERTIFICATE")},this.tohex=function(){var f=this.params;if((f.tbsobj==null||f.tbsobj==null)&&(f.tbsobj=new a(f)),f.sighex==null&&f.cakey!=null&&this.sign(),f.sighex==null)throw new Error("sighex or cakey parameter not defined");var d=[];d.push(f.tbsobj),d.push(new o({name:f.sigalg})),d.push(new n({hex:"00"+f.sighex}));var m=new i({array:d});return m.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&(this.params=e)};H(u.asn1.x509.Certificate,u.asn1.ASN1Object);u.asn1.x509.TBSCertificate=function(e){u.asn1.x509.TBSCertificate.superclass.constructor.call(this);var t=u,r=t.asn1,n=r.x509,i=r.DERTaggedObject,s=r.DERInteger,a=r.DERSequence,o=n.AlgorithmIdentifier,f=n.Time,d=n.X500Name,m=n.Extensions,p=n.SubjectPublicKeyInfo;this.params=null,this.setByParam=function(h){this.params=h},this.tohex=function(){var h=[],c=this.params;if(c.version!=null||c.version!=1){var g=2;c.version!=null&&(g=c.version-1);var l=new i({obj:new s({int:g})});h.push(l)}h.push(new s(c.serial)),h.push(new o({name:c.sigalg})),h.push(new d(c.issuer)),h.push(new a({array:[new f(c.notbefore),new f(c.notafter)]})),h.push(new d(c.subject)),h.push(new p(Z.getKey(c.sbjpubkey))),c.ext!==void 0&&c.ext.length>0&&h.push(new i({tag:"a3",obj:new m(c.ext)}));var v=new u.asn1.DERSequence({array:h});return v.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};H(u.asn1.x509.TBSCertificate,u.asn1.ASN1Object);u.asn1.x509.Extensions=function(e){u.asn1.x509.Extensions.superclass.constructor.call(this);var t=u,r=t.asn1,n=r.DERSequence,i=r.x509;this.aParam=[],this.setByParam=function(s){this.aParam=s},this.tohex=function(){for(var s=[],a=0;a<this.aParam.length;a++){var o=this.aParam[a],f=o.extname,d=null;if(o.extn!=null)d=new i.PrivateExtension(o);else if(f=="subjectKeyIdentifier")d=new i.SubjectKeyIdentifier(o);else if(f=="keyUsage")d=new i.KeyUsage(o);else if(f=="subjectAltName")d=new i.SubjectAltName(o);else if(f=="issuerAltName")d=new i.IssuerAltName(o);else if(f=="basicConstraints")d=new i.BasicConstraints(o);else if(f=="nameConstraints")d=new i.NameConstraints(o);else if(f=="cRLDistributionPoints")d=new i.CRLDistributionPoints(o);else if(f=="certificatePolicies")d=new i.CertificatePolicies(o);else if(f=="policyMappings")d=new i.PolicyMappings(o);else if(f=="policyConstraints")d=new i.PolicyConstraints(o);else if(f=="inhibitAnyPolicy")d=new i.InhibitAnyPolicy(o);else if(f=="authorityKeyIdentifier")d=new i.AuthorityKeyIdentifier(o);else if(f=="extKeyUsage")d=new i.ExtKeyUsage(o);else if(f=="authorityInfoAccess")d=new i.AuthorityInfoAccess(o);else if(f=="cRLNumber")d=new i.CRLNumber(o);else if(f=="cRLReason")d=new i.CRLReason(o);else if(f=="ocspNonce")d=new i.OCSPNonce(o);else if(f=="ocspNoCheck")d=new i.OCSPNoCheck(o);else if(f=="adobeTimeStamp")d=new i.AdobeTimeStamp(o);else if(f=="subjectDirectoryAttributes")d=new i.SubjectDirectoryAttributes(o);else throw new Error("extension not supported:"+JSON.stringify(o));d!=null&&s.push(d)}var m=new n({array:s});return m.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};H(u.asn1.x509.Extensions,u.asn1.ASN1Object);u.asn1.x509.Extension=function(e){u.asn1.x509.Extension.superclass.constructor.call(this);var t=null,r=u,n=r.asn1,i=n.DERObjectIdentifier,s=n.DEROctetString,a=n.DERBitString,o=n.DERBoolean,f=n.DERSequence;this.tohex=function(){var d=new i({oid:this.oid}),m=new s({hex:this.getExtnValueHex()}),p=new Array;p.push(d),this.critical&&p.push(new o),p.push(m);var h=new f({array:p});return h.tohex()},this.getEncodedHex=function(){return this.tohex()},this.critical=!1,e!==void 0&&e.critical!==void 0&&(this.critical=e.critical)};H(u.asn1.x509.Extension,u.asn1.ASN1Object);u.asn1.x509.KeyUsage=function(e){u.asn1.x509.KeyUsage.superclass.constructor.call(this,e);var t=Error,r={digitalSignature:0,nonRepudiation:1,keyEncipherment:2,dataEncipherment:3,keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8};this.getExtnValueHex=function(){var n=this.getBinValue();return this.asn1ExtnValue=new u.asn1.DERBitString({bin:n}),this.asn1ExtnValue.tohex()},this.getBinValue=function(){var n=this.params;if(typeof n!="object"||typeof n.names!="object"&&typeof n.bin!="string")throw new t("parameter not yet set");if(n.names!=null)return Rn(n.names,r);if(n.bin!=null)return n.bin;throw new t("parameter not set properly")},this.oid="2.5.29.15",e!==void 0&&(this.params=e)};H(u.asn1.x509.KeyUsage,u.asn1.x509.Extension);u.asn1.x509.BasicConstraints=function(e){u.asn1.x509.BasicConstraints.superclass.constructor.call(this,e);var t=u.asn1,r=t.DERBoolean,n=t.DERInteger,i=t.DERSequence,s=!1,a=-1;this.getExtnValueHex=function(){var o=new Array;this.cA&&o.push(new r),this.pathLen>-1&&o.push(new n({int:this.pathLen}));var f=new i({array:o});return this.asn1ExtnValue=f,this.asn1ExtnValue.tohex()},this.oid="2.5.29.19",this.cA=!1,this.pathLen=-1,e!==void 0&&(e.cA!==void 0&&(this.cA=e.cA),e.pathLen!==void 0&&(this.pathLen=e.pathLen))};H(u.asn1.x509.BasicConstraints,u.asn1.x509.Extension);u.asn1.x509.CRLDistributionPoints=function(e){u.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,e);var t=u,r=t.asn1,n=r.x509;this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.setByDPArray=function(i){for(var s=[],a=0;a<i.length;a++)if(i[a]instanceof u.asn1.ASN1Object)s.push(i[a]);else{var o=new n.DistributionPoint(i[a]);s.push(o)}this.asn1ExtnValue=new r.DERSequence({array:s})},this.setByOneURI=function(i){var s=new n.DistributionPoint({fulluri:i});this.setByDPArray([s])},this.oid="2.5.29.31",e!==void 0&&(e.array!==void 0?this.setByDPArray(e.array):e.uri!==void 0&&this.setByOneURI(e.uri))};H(u.asn1.x509.CRLDistributionPoints,u.asn1.x509.Extension);u.asn1.x509.DistributionPoint=function(e){u.asn1.x509.DistributionPoint.superclass.constructor.call(this);var t=null,r=u,n=r.asn1,i=n.x509.DistributionPointName;this.tohex=function(){var s=new n.DERSequence;if(this.asn1DP!=null){var a=new n.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});s.appendASN1Object(a)}return this.hTLV=s.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(e.dpobj!==void 0?this.asn1DP=e.dpobj:e.dpname!==void 0?this.asn1DP=new i(e.dpname):e.fulluri!==void 0&&(this.asn1DP=new i({full:[{uri:e.fulluri}]})))};H(u.asn1.x509.DistributionPoint,u.asn1.ASN1Object);u.asn1.x509.DistributionPointName=function(e){u.asn1.x509.DistributionPointName.superclass.constructor.call(this);var t=null,r=null,n=null,i=null,s=u,a=s.asn1,o=a.DERTaggedObject;if(this.tohex=function(){if(this.type!="full")throw new Error("currently type shall be 'full': "+this.type);return this.asn1Obj=new o({explicit:!1,tag:this.tag,obj:this.asn1V}),this.hTLV=this.asn1Obj.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0)if(a.x509.GeneralNames.prototype.isPrototypeOf(e))this.type="full",this.tag="a0",this.asn1V=e;else if(e.full!==void 0)this.type="full",this.tag="a0",this.asn1V=new a.x509.GeneralNames(e.full);else throw new Error("This class supports GeneralNames only as argument")};H(u.asn1.x509.DistributionPointName,u.asn1.ASN1Object);u.asn1.x509.CertificatePolicies=function(e){u.asn1.x509.CertificatePolicies.superclass.constructor.call(this,e);var t=u,r=t.asn1,n=r.x509,i=r.DERSequence,s=n.PolicyInformation;this.params=null,this.getExtnValueHex=function(){for(var a=[],o=0;o<this.params.array.length;o++)a.push(new s(this.params.array[o]));var f=new i({array:a});return this.asn1ExtnValue=f,this.asn1ExtnValue.tohex()},this.oid="2.5.29.32",e!==void 0&&(this.params=e)};H(u.asn1.x509.CertificatePolicies,u.asn1.x509.Extension);u.asn1.x509.PolicyInformation=function(e){u.asn1.x509.PolicyInformation.superclass.constructor.call(this,e);var t=u.asn1,r=t.DERSequence,n=t.DERObjectIdentifier,i=t.x509.PolicyQualifierInfo;this.params=null,this.tohex=function(){if(this.params.policyoid===void 0&&this.params.array===void 0)throw new Error("parameter oid and array missing");var s=[new n(this.params.policyoid)];if(this.params.array!==void 0){for(var a=[],o=0;o<this.params.array.length;o++)a.push(new i(this.params.array[o]));a.length>0&&s.push(new r({array:a}))}var f=new r({array:s});return f.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(this.params=e)};H(u.asn1.x509.PolicyInformation,u.asn1.ASN1Object);u.asn1.x509.PolicyQualifierInfo=function(e){u.asn1.x509.PolicyQualifierInfo.superclass.constructor.call(this,e);var t=u.asn1,r=t.DERSequence,n=t.DERIA5String,i=t.DERObjectIdentifier,s=t.x509.UserNotice;this.params=null,this.tohex=function(){if(this.params.cps!==void 0){var a=new r({array:[new i({oid:"1.3.6.1.5.5.7.2.1"}),new n({str:this.params.cps})]});return a.tohex()}if(this.params.unotice!=null){var a=new r({array:[new i({oid:"1.3.6.1.5.5.7.2.2"}),new s(this.params.unotice)]});return a.tohex()}},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(this.params=e)};H(u.asn1.x509.PolicyQualifierInfo,u.asn1.ASN1Object);u.asn1.x509.UserNotice=function(e){u.asn1.x509.UserNotice.superclass.constructor.call(this,e);var t=u.asn1.DERSequence,r=u.asn1.DERInteger,n=u.asn1.x509.DisplayText,i=u.asn1.x509.NoticeReference;this.params=null,this.tohex=function(){var s=[];this.params.noticeref!==void 0&&s.push(new i(this.params.noticeref)),this.params.exptext!==void 0&&s.push(new n(this.params.exptext));var a=new t({array:s});return a.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(this.params=e)};H(u.asn1.x509.UserNotice,u.asn1.ASN1Object);u.asn1.x509.NoticeReference=function(e){u.asn1.x509.NoticeReference.superclass.constructor.call(this,e);var t=u.asn1.DERSequence,r=u.asn1.DERInteger,n=u.asn1.x509.DisplayText;this.params=null,this.tohex=function(){var i=[];if(this.params.org!==void 0&&i.push(new n(this.params.org)),this.params.noticenum!==void 0){for(var s=[],a=this.params.noticenum,o=0;o<a.length;o++)s.push(new r(a[o]));i.push(new t({array:s}))}if(i.length==0)throw new Error("parameter is empty");var f=new t({array:i});return f.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(this.params=e)};H(u.asn1.x509.NoticeReference,u.asn1.ASN1Object);u.asn1.x509.DisplayText=function(e){u.asn1.x509.DisplayText.superclass.constructor.call(this,e),this.hT="0c",e!==void 0&&(e.type==="ia5"?this.hT="16":e.type==="vis"?this.hT="1a":e.type==="bmp"&&(this.hT="1e"))};H(u.asn1.x509.DisplayText,u.asn1.DERAbstractString);u.asn1.x509.PolicyMappings=function(e){u.asn1.x509.PolicyMappings.superclass.constructor.call(this,e);var t=u,r=t.asn1,n=r.x509,i=r.ASN1Util.newObject;this.params=null,this.getExtnValueHex=function(){for(var s=this.params,a=[],o=0;o<s.array.length;o++){var f=s.array[o];a.push({seq:[{oid:f[0]},{oid:f[1]}]})}return this.asn1ExtnValue=i({seq:a}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.33",e!==void 0&&(this.params=e)};H(u.asn1.x509.PolicyMappings,u.asn1.x509.Extension);u.asn1.x509.PolicyConstraints=function(e){u.asn1.x509.PolicyConstraints.superclass.constructor.call(this,e);var t=u,r=t.asn1,n=r.x509,i=r.ASN1Util.newObject;this.params=null,this.getExtnValueHex=function(){var s=this.params,a=[];return s.reqexp!=null&&a.push({tag:{tagi:"80",obj:{int:s.reqexp}}}),s.inhibit!=null&&a.push({tag:{tagi:"81",obj:{int:s.inhibit}}}),this.asn1ExtnValue=i({seq:a}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.36",e!==void 0&&(this.params=e)};H(u.asn1.x509.PolicyConstraints,u.asn1.x509.Extension);u.asn1.x509.InhibitAnyPolicy=function(e){u.asn1.x509.InhibitAnyPolicy.superclass.constructor.call(this,e);var t=u,r=t.asn1,n=r.x509,i=r.ASN1Util.newObject;this.params=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=i({int:this.params.skip}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.54",e!==void 0&&(this.params=e)};H(u.asn1.x509.InhibitAnyPolicy,u.asn1.x509.Extension);u.asn1.x509.NameConstraints=function(e){u.asn1.x509.NameConstraints.superclass.constructor.call(this,e);var t=u,r=t.asn1,n=r.x509,i=r.ASN1Util.newObject,s=n.GeneralSubtree;this.params=null,this.getExtnValueHex=function(){var a=this.params,o=[];if(a.permit!=null&&a.permit.length!=null){for(var f=[],d=0;d<a.permit.length;d++)f.push(new s(a.permit[d]));o.push({tag:{tagi:"a0",obj:{seq:f}}})}if(a.exclude!=null&&a.exclude.length!=null){for(var m=[],d=0;d<a.exclude.length;d++)m.push(new s(a.exclude[d]));o.push({tag:{tagi:"a1",obj:{seq:m}}})}return this.asn1ExtnValue=i({seq:o}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.30",e!==void 0&&(this.params=e)};H(u.asn1.x509.NameConstraints,u.asn1.x509.Extension);u.asn1.x509.GeneralSubtree=function(e){u.asn1.x509.GeneralSubtree.superclass.constructor.call(this);var t=u.asn1,r=t.x509,n=r.GeneralName,i=t.ASN1Util.newObject;this.params=null,this.setByParam=function(s){this.params=s},this.tohex=function(){var s=this.params,a=[new n(s)];s.min!=null&&a.push({tag:{tagi:"80",obj:{int:s.min}}}),s.max!=null&&a.push({tag:{tagi:"81",obj:{int:s.max}}});var o=i({seq:a});return o.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};H(u.asn1.x509.GeneralSubtree,u.asn1.ASN1Object);u.asn1.x509.ExtKeyUsage=function(e){u.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,e);var t=u,r=t.asn1;this.setPurposeArray=function(n){this.asn1ExtnValue=new r.DERSequence;for(var i=0;i<n.length;i++){var s=new r.DERObjectIdentifier(n[i]);this.asn1ExtnValue.appendASN1Object(s)}},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.37",e!==void 0&&e.array!==void 0&&this.setPurposeArray(e.array)};H(u.asn1.x509.ExtKeyUsage,u.asn1.x509.Extension);u.asn1.x509.AuthorityKeyIdentifier=function(e){u.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,e);var t=u,r=t.asn1,n=r.DERTaggedObject,i=r.x509.GeneralNames,s=t.crypto.Util.isKey;this.asn1KID=null,this.asn1CertIssuer=null,this.asn1CertSN=null,this.getExtnValueHex=function(){var a=new Array;this.asn1KID&&a.push(new n({explicit:!1,tag:"80",obj:this.asn1KID})),this.asn1CertIssuer&&a.push(new n({explicit:!1,tag:"a1",obj:new i([{dn:this.asn1CertIssuer}])})),this.asn1CertSN&&a.push(new n({explicit:!1,tag:"82",obj:this.asn1CertSN}));var o=new r.DERSequence({array:a});return this.asn1ExtnValue=o,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(a){if(a.str!==void 0||a.hex!==void 0)this.asn1KID=new u.asn1.DEROctetString(a);else if(typeof a=="object"&&u.crypto.Util.isKey(a)||typeof a=="string"&&a.indexOf("BEGIN ")!=-1){var o=a;typeof a=="string"&&(o=Z.getKey(a));var f=Z.getKeyID(o);this.asn1KID=new u.asn1.DEROctetString({hex:f})}},this.setCertIssuerByParam=function(a){a.str!==void 0||a.ldapstr!==void 0||a.hex!==void 0||a.certsubject!==void 0||a.certissuer!==void 0?this.asn1CertIssuer=new u.asn1.x509.X500Name(a):typeof a=="string"&&a.indexOf("BEGIN ")!=-1&&a.indexOf("CERTIFICATE")!=-1&&(this.asn1CertIssuer=new u.asn1.x509.X500Name({certissuer:a}))},this.setCertSNByParam=function(a){if(a.str!==void 0||a.bigint!==void 0||a.hex!==void 0)this.asn1CertSN=new u.asn1.DERInteger(a);else if(typeof a=="string"&&a.indexOf("BEGIN ")!=-1&&a.indexOf("CERTIFICATE")){var o=new X;o.readCertPEM(a);var f=o.getSerialNumberHex();this.asn1CertSN=new u.asn1.DERInteger({hex:f})}},this.oid="2.5.29.35",e!==void 0&&(e.kid!==void 0&&this.setKIDByParam(e.kid),e.issuer!==void 0&&this.setCertIssuerByParam(e.issuer),e.sn!==void 0&&this.setCertSNByParam(e.sn),e.issuersn!==void 0&&typeof e.issuersn=="string"&&e.issuersn.indexOf("BEGIN ")!=-1&&e.issuersn.indexOf("CERTIFICATE")&&(this.setCertSNByParam(e.issuersn),this.setCertIssuerByParam(e.issuersn)))};H(u.asn1.x509.AuthorityKeyIdentifier,u.asn1.x509.Extension);u.asn1.x509.SubjectKeyIdentifier=function(e){u.asn1.x509.SubjectKeyIdentifier.superclass.constructor.call(this,e);var t=u,r=t.asn1,n=r.DEROctetString;this.asn1KID=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=this.asn1KID,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(i){if(i.str!==void 0||i.hex!==void 0)this.asn1KID=new n(i);else if(typeof i=="object"&&u.crypto.Util.isKey(i)||typeof i=="string"&&i.indexOf("BEGIN")!=-1){var s=i;typeof i=="string"&&(s=Z.getKey(i));var a=Z.getKeyID(s);this.asn1KID=new u.asn1.DEROctetString({hex:a})}},this.oid="2.5.29.14",e!==void 0&&e.kid!==void 0&&this.setKIDByParam(e.kid)};H(u.asn1.x509.SubjectKeyIdentifier,u.asn1.x509.Extension);u.asn1.x509.AuthorityInfoAccess=function(e){u.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,e),this.setAccessDescriptionArray=function(t){for(var r=new Array,n=u,i=n.asn1,s=i.DERSequence,a=i.DERObjectIdentifier,o=i.x509.GeneralName,f=0;f<t.length;f++){var d,m=t[f];if(m.ocsp!==void 0)d=new s({array:[new a({oid:"1.3.6.1.5.5.7.48.1"}),new o({uri:m.ocsp})]});else if(m.caissuer!==void 0)d=new s({array:[new a({oid:"1.3.6.1.5.5.7.48.2"}),new o({uri:m.caissuer})]});else throw new Error("unknown AccessMethod parameter: "+JSON.stringify(m));r.push(d)}this.asn1ExtnValue=new s({array:r})},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.1.1",e!==void 0&&e.array!==void 0&&this.setAccessDescriptionArray(e.array)};H(u.asn1.x509.AuthorityInfoAccess,u.asn1.x509.Extension);u.asn1.x509.SubjectAltName=function(e){u.asn1.x509.SubjectAltName.superclass.constructor.call(this,e),this.setNameArray=function(t){this.asn1ExtnValue=new u.asn1.x509.GeneralNames(t)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.17",e!==void 0&&e.array!==void 0&&this.setNameArray(e.array)};H(u.asn1.x509.SubjectAltName,u.asn1.x509.Extension);u.asn1.x509.IssuerAltName=function(e){u.asn1.x509.IssuerAltName.superclass.constructor.call(this,e),this.setNameArray=function(t){this.asn1ExtnValue=new u.asn1.x509.GeneralNames(t)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.18",e!==void 0&&e.array!==void 0&&this.setNameArray(e.array)};H(u.asn1.x509.IssuerAltName,u.asn1.x509.Extension);u.asn1.x509.SubjectDirectoryAttributes=function(e){u.asn1.x509.SubjectDirectoryAttributes.superclass.constructor.call(this,e);var t=u.asn1,r=t.DERSequence,n=t.ASN1Util.newObject,i=t.x509.OID.name2oid;this.params=null,this.getExtnValueHex=function(){for(var s=[],a=0;a<this.params.array.length;a++){var o=this.params.array[a];if(o.attr!=null&&o.array!=null){var f={seq:[{oid:o.attr},{set:o.array}]};s.push(n(f));continue}var d={seq:[{oid:"1.2.3.4"},{set:[{utf8str:"DE"}]}]};if(o.attr=="dateOfBirth")d.seq[0].oid=i(o.attr),d.seq[1].set[0]={gentime:o.str};else if(o.attr=="placeOfBirth")d.seq[0].oid=i(o.attr),d.seq[1].set[0]={utf8str:o.str};else if(o.attr=="gender")d.seq[0].oid=i(o.attr),d.seq[1].set[0]={prnstr:o.str};else if(o.attr=="countryOfCitizenship")d.seq[0].oid=i(o.attr),d.seq[1].set[0]={prnstr:o.str};else if(o.attr=="countryOfResidence")d.seq[0].oid=i(o.attr),d.seq[1].set[0]={prnstr:o.str};else throw new Error("unsupported attribute: "+o.attr);s.push(new n(d))}var m=new r({array:s});return this.asn1ExtnValue=m,this.asn1ExtnValue.tohex()},this.oid="2.5.29.9",e!==void 0&&(this.params=e)};H(u.asn1.x509.SubjectDirectoryAttributes,u.asn1.x509.Extension);u.asn1.x509.PrivateExtension=function(e){u.asn1.x509.PrivateExtension.superclass.constructor.call(this,e);var t=u,r=t.lang.String.isHex,n=t.asn1,i=n.x509.OID.name2oid,s=n.ASN1Util.newObject;this.params=null,this.setByParam=function(a){this.oid=i(a.extname),this.params=a},this.getExtnValueHex=function(){if(this.params.extname==null||this.params.extn==null)throw new Error("extname or extnhex not specified");var a=this.params.extn;if(typeof a=="string"&&r(a))return a;if(typeof a=="object")try{return s(a).tohex()}catch{}throw new Error("unsupported extn value")},e!=null&&this.setByParam(e)};H(u.asn1.x509.PrivateExtension,u.asn1.x509.Extension);u.asn1.x509.CRL=function(e){u.asn1.x509.CRL.superclass.constructor.call(this);var t=u,r=t.asn1,n=r.DERSequence,i=r.DERBitString,s=r.x509,a=s.AlgorithmIdentifier,o=s.TBSCertList;this.params=void 0,this.setByParam=function(f){this.params=f},this.sign=function(){var f=new o(this.params).tohex(),d=new u.crypto.Signature({alg:this.params.sigalg});d.init(this.params.cakey),d.updateHex(f);var m=d.sign();this.params.sighex=m},this.getPEM=function(){return Te(this.tohex(),"X509 CRL")},this.tohex=function(){var f=this.params;if(f.tbsobj==null&&(f.tbsobj=new o(f)),f.sighex==null&&f.cakey!=null&&this.sign(),f.sighex==null)throw new Error("sighex or cakey parameter not defined");var d=[];d.push(f.tbsobj),d.push(new a({name:f.sigalg})),d.push(new i({hex:"00"+f.sighex}));var m=new n({array:d});return m.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&(this.params=e)};H(u.asn1.x509.CRL,u.asn1.ASN1Object);u.asn1.x509.TBSCertList=function(e){u.asn1.x509.TBSCertList.superclass.constructor.call(this);var t=u,r=t.asn1,n=r.DERInteger,i=r.DERSequence,s=r.DERTaggedObject,a=r.DERObjectIdentifier,o=r.x509,f=o.AlgorithmIdentifier,d=o.Time,m=o.Extensions,p=o.X500Name;this.params=null,this.setByParam=function(h){this.params=h},this.getRevCertSequence=function(){for(var h=[],c=this.params.revcert,g=0;g<c.length;g++){var l=[new n(c[g].sn),new d(c[g].date)];c[g].ext!=null&&l.push(new m(c[g].ext)),h.push(new i({array:l}))}return new i({array:h})},this.tohex=function(){var h=[],c=this.params;if(c.version!=null){var g=c.version-1,l=new n({int:g});h.push(l)}if(h.push(new f({name:c.sigalg})),h.push(new p(c.issuer)),h.push(new d(c.thisupdate)),c.nextupdate!=null&&h.push(new d(c.nextupdate)),c.revcert!=null&&h.push(this.getRevCertSequence()),c.ext!=null){var v=new m(c.ext);h.push(new s({tag:"a0",explicit:!0,obj:v}))}var y=new i({array:h});return y.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};H(u.asn1.x509.TBSCertList,u.asn1.ASN1Object);u.asn1.x509.CRLEntry=function(e){u.asn1.x509.CRLEntry.superclass.constructor.call(this);var t=null,r=null,n=u,i=n.asn1;this.setCertSerial=function(s){this.sn=new i.DERInteger(s)},this.setRevocationDate=function(s){this.time=new i.x509.Time(s)},this.tohex=function(){var s=new i.DERSequence({array:[this.sn,this.time]});return this.TLV=s.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(e.time!==void 0&&this.setRevocationDate(e.time),e.sn!==void 0&&this.setCertSerial(e.sn))};H(u.asn1.x509.CRLEntry,u.asn1.ASN1Object);u.asn1.x509.CRLNumber=function(e){u.asn1.x509.CRLNumber.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new u.asn1.DERInteger(this.params.num),this.asn1ExtnValue.tohex()},this.oid="2.5.29.20",e!=null&&(this.params=e)};H(u.asn1.x509.CRLNumber,u.asn1.x509.Extension);u.asn1.x509.CRLReason=function(e){u.asn1.x509.CRLReason.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new u.asn1.DEREnumerated(this.params.code),this.asn1ExtnValue.tohex()},this.oid="2.5.29.21",e!=null&&(this.params=e)};H(u.asn1.x509.CRLReason,u.asn1.x509.Extension);u.asn1.x509.OCSPNonce=function(e){u.asn1.x509.OCSPNonce.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new u.asn1.DEROctetString(this.params),this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.2",e!=null&&(this.params=e)};H(u.asn1.x509.OCSPNonce,u.asn1.x509.Extension);u.asn1.x509.OCSPNoCheck=function(e){u.asn1.x509.OCSPNoCheck.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new u.asn1.DERNull,this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.5",e!=null&&(this.params=e)};H(u.asn1.x509.OCSPNoCheck,u.asn1.x509.Extension);u.asn1.x509.AdobeTimeStamp=function(e){u.asn1.x509.AdobeTimeStamp.superclass.constructor.call(this,e);var t=u,r=t.asn1,n=r.DERInteger,i=r.DERBoolean,s=r.DERSequence,a=r.x509.GeneralName;this.params=null,this.getExtnValueHex=function(){var o=this.params,f=[new n(1)];return f.push(new a({uri:o.uri})),o.reqauth!=null&&f.push(new i(o.reqauth)),this.asn1ExtnValue=new s({array:f}),this.asn1ExtnValue.tohex()},this.oid="1.2.840.113583.1.1.9.1",e!==void 0&&this.setByParam(e)};H(u.asn1.x509.AdobeTimeStamp,u.asn1.x509.Extension);u.asn1.x509.X500Name=function(e){u.asn1.x509.X500Name.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var t=u,r=t.asn1,n=r.x509,i=n.RDN,s=me;this.setByString=function(a,o){o!==void 0&&(this.sRule=o);var f=a.split("/");f.shift();for(var d=[],m=0;m<f.length;m++)if(f[m].match(/^[^=]+=.+$/))d.push(f[m]);else{var p=d.length-1;d[p]=d[p]+"/"+f[m]}for(var m=0;m<d.length;m++)this.asn1Array.push(new i({str:d[m],rule:this.sRule}))},this.setByLdapString=function(a,o){o!==void 0&&(this.sRule=o);var f=n.X500Name.ldapToCompat(a);this.setByString(f,o)},this.setByObject=function(a,o){o!==void 0&&(this.sRule=o);for(var f in a)if(a.hasOwnProperty(f)){var d=new i({str:f+"="+a[f],rule:this.sRule});this.asn1Array?this.asn1Array.push(d):this.asn1Array=[d]}},this.setByParam=function(a){if(a.rule!==void 0&&(this.sRule=a.rule),a.array!==void 0)this.paramArray=a.array;else if(a.str!==void 0)this.setByString(a.str);else if(a.ldapstr!==void 0)this.setByLdapString(a.ldapstr);else if(a.hex!==void 0)this.hTLV=a.hex;else if(a.certissuer!==void 0){var o=new X;o.readCertPEM(a.certissuer),this.hTLV=o.getIssuerHex()}else if(a.certsubject!==void 0){var o=new X;o.readCertPEM(a.certsubject),this.hTLV=o.getSubjectHex()}else typeof a=="object"&&a.certsubject===void 0&&a.certissuer===void 0&&this.setByObject(a)},this.tohex=function(){if(typeof this.hTLV=="string")return this.hTLV;if(this.asn1Array.length==0&&this.paramArray.length>0)for(var a=0;a<this.paramArray.length;a++){var o={array:this.paramArray[a]};this.sRule!="utf8"&&(o.rule=this.sRule);var f=new i(o);this.asn1Array.push(f)}var d=new r.DERSequence({array:this.asn1Array});return this.hTLV=d.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};H(u.asn1.x509.X500Name,u.asn1.ASN1Object);u.asn1.x509.X500Name.compatToLDAP=function(e){if(e.substr(0,1)!=="/")throw"malformed input";var t="";e=e.substr(1);var r=e.split("/");return r.reverse(),r=r.map(function(n){return n.replace(/,/,"\\,")}),r.join(",")};u.asn1.x509.X500Name.onelineToLDAP=function(e){return u.asn1.x509.X500Name.compatToLDAP(e)};u.asn1.x509.X500Name.ldapToCompat=function(e){for(var t=e.split(","),r=!1,n=[],i=0;t.length>0;i++){var s=t.shift();if(r===!0){var a=n.pop(),o=(a+","+s).replace(/\\,/g,",");n.push(o),r=!1}else n.push(s);s.substr(-1,1)==="\\"&&(r=!0)}return n=n.map(function(f){return f.replace("/","\\/")}),n.reverse(),"/"+n.join("/")};u.asn1.x509.X500Name.ldapToOneline=function(e){return u.asn1.x509.X500Name.ldapToCompat(e)};u.asn1.x509.RDN=function(e){u.asn1.x509.RDN.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var t=u.asn1.x509.AttributeTypeAndValue;this.setByParam=function(r){r.rule!==void 0&&(this.sRule=r.rule),r.str!==void 0&&this.addByMultiValuedString(r.str),r.array!==void 0&&(this.paramArray=r.array)},this.addByString=function(r){this.asn1Array.push(new u.asn1.x509.AttributeTypeAndValue({str:r,rule:this.sRule}))},this.addByMultiValuedString=function(r){for(var n=u.asn1.x509.RDN.parseString(r),i=0;i<n.length;i++)this.addByString(n[i])},this.tohex=function(){if(this.asn1Array.length==0&&this.paramArray.length>0)for(var r=0;r<this.paramArray.length;r++){var n=this.paramArray[r];n.rule!==void 0&&this.sRule!="utf8"&&(n.rule=this.sRule);var i=new t(n);this.asn1Array.push(i)}var s=new u.asn1.DERSet({array:this.asn1Array});return this.TLV=s.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};H(u.asn1.x509.RDN,u.asn1.ASN1Object);u.asn1.x509.RDN.parseString=function(e){for(var t=e.split(/\+/),r=!1,n=[],i=0;t.length>0;i++){var s=t.shift();if(r===!0){var a=n.pop(),o=(a+"+"+s).replace(/\\\+/g,"+");n.push(o),r=!1}else n.push(s);s.substr(-1,1)==="\\"&&(r=!0)}for(var f=!1,d=[],i=0;n.length>0;i++){var s=n.shift();if(f===!0){var m=d.pop();if(s.match(/"$/)){var o=(m+"+"+s).replace(/^([^=]+)="(.*)"$/,"$1=$2");d.push(o),f=!1}else d.push(m+"+"+s)}else d.push(s);s.match(/^[^=]+="/)&&(f=!0)}return d};u.asn1.x509.AttributeTypeAndValue=function(e){u.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this),this.sRule="utf8",this.sType=null,this.sValue=null,this.dsType=null;var t=u,r=t.asn1,n=r.DERSequence,i=r.DERUTF8String,s=r.DERPrintableString,a=r.DERTeletexString,o=r.DERIA5String,f=r.DERVisibleString,d=r.DERBMPString,m=t.lang.String.isMail,p=t.lang.String.isPrintable;this.setByParam=function(h){if(h.rule!==void 0&&(this.sRule=h.rule),h.ds!==void 0&&(this.dsType=h.ds),h.value===void 0&&h.str!==void 0){var c=h.str,g=c.match(/^([^=]+)=(.+)$/);if(g)this.sType=g[1],this.sValue=g[2];else throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr)}else this.sType=h.type,this.sValue=h.value},this.setByString=function(h,c){c!==void 0&&(this.sRule=c);var g=h.match(/^([^=]+)=(.+)$/);if(g)this.setByAttrTypeAndValueStr(g[1],g[2]);else throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr)},this._getDsType=function(){var h=this.sType,c=this.sValue,g=this.sRule;return g==="prn"?h=="CN"&&m(c)?"ia5":p(c)?"prn":"utf8":g==="utf8"?h=="CN"&&m(c)?"ia5":h=="C"?"prn":"utf8":"utf8"},this.setByAttrTypeAndValueStr=function(h,c,g){g!==void 0&&(this.sRule=g),this.sType=h,this.sValue=c},this.getValueObj=function(h,c){if(h=="utf8")return new i({str:c});if(h=="prn")return new s({str:c});if(h=="tel")return new a({str:c});if(h=="ia5")return new o({str:c});if(h=="vis")return new f({str:c});if(h=="bmp")return new d({str:c});throw new Error("unsupported directory string type: type="+h+" value="+c)},this.tohex=function(){this.dsType==null&&(this.dsType=this._getDsType());var h=u.asn1.x509.OID.atype2obj(this.sType),c=this.getValueObj(this.dsType,this.sValue),g=new n({array:[h,c]});return this.TLV=g.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};H(u.asn1.x509.AttributeTypeAndValue,u.asn1.ASN1Object);u.asn1.x509.SubjectPublicKeyInfo=function(e){u.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var t=null,r=null,n=u,i=n.asn1,s=i.DERInteger,a=i.DERBitString,o=i.DERObjectIdentifier,f=i.DERSequence,d=i.ASN1Util.newObject,m=i.x509,p=m.AlgorithmIdentifier,h=n.crypto,c=h.ECDSA,g=h.DSA;this.getASN1Object=function(){if(this.asn1AlgId==null||this.asn1SubjPKey==null)throw"algId and/or subjPubKey not set";var l=new f({array:[this.asn1AlgId,this.asn1SubjPKey]});return l},this.tohex=function(){var l=this.getASN1Object();return this.hTLV=l.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.setPubKey=function(l){try{if(l instanceof W){var v=d({seq:[{int:{bigint:l.n}},{int:{int:l.e}}]}),y=v.tohex();this.asn1AlgId=new p({name:"rsaEncryption"}),this.asn1SubjPKey=new a({hex:"00"+y})}}catch{}try{if(l instanceof u.crypto.ECDSA){var x=new o({name:l.curveName});this.asn1AlgId=new p({name:"ecPublicKey",asn1params:x}),this.asn1SubjPKey=new a({hex:"00"+l.pubKeyHex})}}catch{}try{if(l instanceof u.crypto.DSA){var x=new d({seq:[{int:{bigint:l.p}},{int:{bigint:l.q}},{int:{bigint:l.g}}]});this.asn1AlgId=new p({name:"dsa",asn1params:x});var E=new s({bigint:l.y});this.asn1SubjPKey=new a({hex:"00"+E.tohex()})}}catch{}},e!==void 0&&this.setPubKey(e)};H(u.asn1.x509.SubjectPublicKeyInfo,u.asn1.ASN1Object);u.asn1.x509.Time=function(e){u.asn1.x509.Time.superclass.constructor.call(this);var t=null,r=null,n=u,i=n.asn1,s=i.DERUTCTime,a=i.DERGeneralizedTime;this.params=null,this.type=null,this.setTimeParams=function(o){this.timeParams=o},this.setByParam=function(o){this.params=o},this.getType=function(o){return o.match(/^[0-9]{12}Z$/)?"utc":o.match(/^[0-9]{14}Z$/)?"gen":o.match(/^[0-9]{12}\.[0-9]+Z$/)?"utc":o.match(/^[0-9]{14}\.[0-9]+Z$/)?"gen":null},this.tohex=function(){var o=this.params,f=null;if(typeof o=="string"&&(o={str:o}),o!=null&&o.str&&(o.type==null||o.type==null)&&(o.type=this.getType(o.str)),o!=null&&o.str?(o.type=="utc"&&(f=new s(o.str)),o.type=="gen"&&(f=new a(o.str))):this.type=="gen"?f=new a:f=new s,f==null)throw new Error("wrong setting for Time");return this.TLV=f.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};u.asn1.x509.Time_bak=function(e){u.asn1.x509.Time_bak.superclass.constructor.call(this);var t=null,r=null,n=u,i=n.asn1,s=i.DERUTCTime,a=i.DERGeneralizedTime;this.setTimeParams=function(o){this.timeParams=o},this.tohex=function(){var o=null;return this.timeParams!=null?this.type=="utc"?o=new s(this.timeParams):o=new a(this.timeParams):this.type=="utc"?o=new s:o=new a,this.TLV=o.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},this.type="utc",e!==void 0&&(e.type!==void 0?this.type=e.type:e.str!==void 0&&(e.str.match(/^[0-9]{12}Z$/)&&(this.type="utc"),e.str.match(/^[0-9]{14}Z$/)&&(this.type="gen")),this.timeParams=e)};H(u.asn1.x509.Time,u.asn1.ASN1Object);u.asn1.x509.AlgorithmIdentifier=function(e){u.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this),this.nameAlg=null,this.asn1Alg=null,this.asn1Params=null,this.paramEmpty=!1;var t=u,r=t.asn1,n=r.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV;if(this.tohex=function(){if(this.nameAlg===null&&this.asn1Alg===null)throw new Error("algorithm not specified");if(this.nameAlg!==null){var s=null;for(var a in n)a===this.nameAlg&&(s=n[a]);if(s!==null)return this.hTLV=s,this.hTLV}this.nameAlg!==null&&this.asn1Alg===null&&(this.asn1Alg=r.x509.OID.name2obj(this.nameAlg));var o=[this.asn1Alg];this.asn1Params!==null&&o.push(this.asn1Params);var f=new r.DERSequence({array:o});return this.hTLV=f.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&(e.name!==void 0&&(this.nameAlg=e.name),e.asn1params!==void 0&&(this.asn1Params=e.asn1params),e.paramempty!==void 0&&(this.paramEmpty=e.paramempty)),this.asn1Params===null&&this.paramEmpty===!1&&this.nameAlg!==null){this.nameAlg.name!==void 0&&(this.nameAlg=this.nameAlg.name);var i=this.nameAlg.toLowerCase();i.substr(-7,7)!=="withdsa"&&i.substr(-9,9)!=="withecdsa"&&(this.asn1Params=new r.DERNull)}};H(u.asn1.x509.AlgorithmIdentifier,u.asn1.ASN1Object);u.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV={SHAwithRSAandMGF1:"300d06092a864886f70d01010a3000",SHA256withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040201a11a301806092a864886f70d010108300b0609608648016503040201a203020120",SHA384withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040202a11a301806092a864886f70d010108300b0609608648016503040202a203020130",SHA512withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040203a11a301806092a864886f70d010108300b0609608648016503040203a203020140"};u.asn1.x509.GeneralName=function(e){u.asn1.x509.GeneralName.superclass.constructor.call(this);var t={rfc822:"81",dns:"82",dn:"a4",uri:"86",ip:"87",otherName:"a0"},r=u,n=r.asn1,i=n.x509,s=i.X500Name,a=i.OtherName,o=n.DERIA5String,f=n.DERPrintableString,d=n.DEROctetString,m=n.DERTaggedObject,p=n.ASN1Object,h=Error;this.params=null,this.setByParam=function(c){this.params=c},this.tohex=function(){var c=this.params,g,v,l,v=!1;if(c.other!==void 0)g="a0",l=new a(c.other);else if(c.rfc822!==void 0)g="81",l=new o({str:c.rfc822});else if(c.dns!==void 0)g="82",l=new o({str:c.dns});else if(c.dn!==void 0)g="a4",v=!0,typeof c.dn=="string"?l=new s({str:c.dn}):c.dn instanceof u.asn1.x509.X500Name?l=c.dn:l=new s(c.dn);else if(c.ldapdn!==void 0)g="a4",v=!0,l=new s({ldapstr:c.ldapdn});else if(c.certissuer!==void 0||c.certsubj!==void 0){g="a4",v=!0;var y,x,E=null;if(c.certsubj!==void 0?(y=!1,x=c.certsubj):(y=!0,x=c.certissuer),x.match(/^[0-9A-Fa-f]+$/)&&E==x,x.indexOf("-----BEGIN ")!=-1&&(E=me(x)),E==null)throw new Error("certsubj/certissuer not cert");var P=new X;P.hex=E;var b;y?b=P.getIssuerHex():b=P.getSubjectHex(),l=new p,l.hTLV=b}else if(c.uri!==void 0)g="86",l=new o({str:c.uri});else if(c.ip!==void 0){g="87";var R,T=c.ip;try{if(T.match(/^[0-9a-f]+$/)){var S=T.length;if(S==8||S==16||S==32||S==64)R=T;else throw"err"}else R=Ui(T)}catch(A){throw new h("malformed IP address: "+c.ip+":"+A.message)}l=new d({hex:R})}else throw new h("improper params");var w=new m({tag:g,explicit:v,obj:l});return w.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};H(u.asn1.x509.GeneralName,u.asn1.ASN1Object);u.asn1.x509.GeneralNames=function(e){u.asn1.x509.GeneralNames.superclass.constructor.call(this);var t=null,r=u,n=r.asn1;this.setByParamArray=function(i){for(var s=0;s<i.length;s++){var a=new n.x509.GeneralName(i[s]);this.asn1Array.push(a)}},this.tohex=function(){var i=new n.DERSequence({array:this.asn1Array});return i.tohex()},this.getEncodedHex=function(){return this.tohex()},this.asn1Array=new Array,typeof e<"u"&&this.setByParamArray(e)};H(u.asn1.x509.GeneralNames,u.asn1.ASN1Object);u.asn1.x509.OtherName=function(e){u.asn1.x509.OtherName.superclass.constructor.call(this);var t=null,r=null,n=u,i=n.asn1,s=i.DERObjectIdentifier,a=i.DERSequence,o=i.ASN1Util.newObject;this.params=null,this.setByParam=function(f){this.params=f},this.tohex=function(){var f=this.params;if(f.oid==null||f.value==null)throw new Error("oid or value not specified");var d=new s({oid:f.oid}),m=o({tag:{tag:"a0",explicit:!0,obj:f.value}}),p=new a({array:[d,m]});return p.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};H(u.asn1.x509.OtherName,u.asn1.ASN1Object);u.asn1.x509.OID=new function(){var e=u.asn1.DERObjectIdentifier;this.name2oidList={"aes128-CBC":"2.16.840.1.101.3.4.1.2","aes256-CBC":"2.16.840.1.101.3.4.1.42",sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",hmacWithSHA1:"1.2.840.113549.2.7",hmacWithSHA224:"1.2.840.113549.2.8",hmacWithSHA256:"1.2.840.113549.2.9",hmacWithSHA384:"1.2.840.113549.2.10",hmacWithSHA512:"1.2.840.113549.2.11",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5","pkcs1-MGF":"1.2.840.113549.1.1.8",rsaPSS:"1.2.840.113549.1.1.10",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",countryName:"2.5.4.6",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",streetAddress:"2.5.4.9",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",givenName:"2.5.4.42",title:"2.5.4.12",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectDirectoryAttributes:"2.5.29.9",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",cRLNumber:"2.5.29.20",cRLReason:"2.5.29.21",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",anyPolicy:"2.5.29.32.0",policyMappings:"2.5.29.33",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",inhibitAnyPolicy:"2.5.29.54",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",ocspBasic:"1.3.6.1.5.5.7.48.1.1",ocspNonce:"1.3.6.1.5.5.7.48.1.2",ocspNoCheck:"1.3.6.1.5.5.7.48.1.5",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",smtpUTF8Mailbox:"1.3.6.1.5.5.7.8.9",dateOfBirth:"1.3.6.1.5.5.7.9.1",placeOfBirth:"1.3.6.1.5.5.7.9.2",gender:"1.3.6.1.5.5.7.9.3",countryOfCitizenship:"1.3.6.1.5.5.7.9.4",countryOfResidence:"1.3.6.1.5.5.7.9.5",ecPublicKey:"1.2.840.10045.2.1","P-256":"1.2.840.10045.3.1.7",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",secp521r1:"1.3.132.0.35",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",signingCertificate:"1.2.840.113549.1.9.16.2.12",timeStampToken:"1.2.840.113549.1.9.16.2.14",signaturePolicyIdentifier:"1.2.840.113549.1.9.16.2.15",etsArchiveTimeStamp:"1.2.840.113549.1.9.16.2.27",signingCertificateV2:"1.2.840.113549.1.9.16.2.47",etsArchiveTimeStampV2:"1.2.840.113549.1.9.16.2.48",extensionRequest:"1.2.840.113549.1.9.14",contentType:"1.2.840.113549.1.9.3",messageDigest:"1.2.840.113549.1.9.4",signingTime:"1.2.840.113549.1.9.5",counterSignature:"1.2.840.113549.1.9.6",archiveTimeStampV3:"0.4.0.1733.2.4",pdfRevocationInfoArchival:"1.2.840.113583.1.1.8",adobeTimeStamp:"1.2.840.113583.1.1.9.1",smimeMailboxLegacy:"2.23.140.1.5.1.1",smimeMailboxMulti:"2.23.140.1.5.1.2",smimeMailboxStrict:"2.23.140.1.5.1.3",smimeOrganizationLegacy:"2.23.140.1.5.2.1",smimeOrganizationMulti:"2.23.140.1.5.2.2",smimeOrganizationStrict:"2.23.140.1.5.2.3",smimeSponsorLegacy:"2.23.140.1.5.3.1",smimeSponsorMulti:"2.23.140.1.5.3.2",smimeSponsorStrict:"2.23.140.1.5.3.3",smimeIndividualLegacy:"2.23.140.1.5.4.1",smimeIndividualMulti:"2.23.140.1.5.4.2",smimeIndividualStrict:"2.23.140.1.5.4.3"},this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",T:"2.5.4.12",GN:"2.5.4.42",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",serialNumber:"2.5.4.5",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"},this.objCache={},this.name2obj=function(t){if(typeof this.objCache[t]<"u")return this.objCache[t];if(typeof this.name2oidList[t]>"u")throw"Name of ObjectIdentifier not defined: "+t;var r=this.name2oidList[t],n=new e({oid:r});return this.objCache[t]=n,n},this.atype2obj=function(t){if(this.objCache[t]!==void 0)return this.objCache[t];var r;if(t.match(/^\d+\.\d+\.[0-9.]+$/))r=t;else if(this.atype2oidList[t]!==void 0)r=this.atype2oidList[t];else if(this.name2oidList[t]!==void 0)r=this.name2oidList[t];else throw new Error("AttributeType name undefined: "+t);var n=new e({oid:r});return this.objCache[t]=n,n},this.registerOIDs=function(t){if(!!this.checkOIDs(t))for(var r in t)this.name2oidList[r]=t[r]},this.checkOIDs=function(t){try{var r=Object.keys(t);return r.length==0?!1:(r.map(function(n,i,s){var a=this[n];if(!a.match(/^[0-2]\.[0-9.]+$/))throw new Error("value is not OID")},t),!0)}catch{return!1}}};u.asn1.x509.OID.oid2name=function(e){var t=u.asn1.x509.OID.name2oidList;for(var r in t)if(t[r]==e)return r;return""};u.asn1.x509.OID.oid2atype=function(e){var t=u.asn1.x509.OID.atype2oidList;for(var r in t)if(t[r]==e)return r;return e};u.asn1.x509.OID.name2oid=function(e){if(e.match(/^[0-9.]+$/))return e;var t=u.asn1.x509.OID.name2oidList;return t[e]===void 0?"":t[e]};u.asn1.x509.X509Util={};u.asn1.x509.X509Util.newCertPEM=function(e){var t=u.asn1.x509,r=t.TBSCertificate,n=t.Certificate,i=new n(e);return i.getPEM()};(typeof u>"u"||!u)&&(u={});(typeof u.asn1>"u"||!u.asn1)&&(u.asn1={});(typeof u.asn1.cms>"u"||!u.asn1.cms)&&(u.asn1.cms={});u.asn1.cms.Attribute=function(e){var t=Error,r=u,n=r.asn1,i=n.DERSequence,s=n.DERSet,a=n.DERObjectIdentifier;this.params=null,this.typeOid=null,this.setByParam=function(o){this.params=o},this.getValueArray=function(){throw new t("not yet implemented abstract")},this.tohex=function(){var o=new a({oid:this.typeOid}),f=new s({array:this.getValueArray()}),d=new i({array:[o,f]});return d.tohex()},this.getEncodedHex=function(){return this.tohex()}};H(u.asn1.cms.Attribute,u.asn1.ASN1Object);u.asn1.cms.ContentType=function(e){var t=u,r=t.asn1;r.cms.ContentType.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.3",this.getValueArray=function(){var n=new r.DERObjectIdentifier(this.params.type);return[n]},e!=null&&this.setByParam(e)};H(u.asn1.cms.ContentType,u.asn1.cms.Attribute);u.asn1.cms.MessageDigest=function(e){var t=u,r=t.asn1,n=r.DEROctetString,i=r.cms;i.MessageDigest.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.4",this.getValueArray=function(){var s=new n(this.params);return[s]},e!=null&&this.setByParam(e)};H(u.asn1.cms.MessageDigest,u.asn1.cms.Attribute);u.asn1.cms.SigningTime=function(e){var t=u,r=t.asn1;r.cms.SigningTime.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.5",this.getValueArray=function(){var n=new r.x509.Time(this.params);return[n]},e!=null&&this.setByParam(e)};H(u.asn1.cms.SigningTime,u.asn1.cms.Attribute);u.asn1.cms.SigningCertificate=function(e){var t=Error,r=u,n=r.asn1,i=n.DERSequence,s=n.cms,a=s.ESSCertID,o=r.crypto;s.SigningCertificate.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.12",this.getValueArray=function(){if(this.params==null||this.params==null||this.params.array==null)throw new t("parameter 'array' not specified");for(var f=this.params.array,d=[],m=0;m<f.length;m++){var p=f[m];e.hasis==!1&&typeof p=="string"&&(p.indexOf("-----BEGIN")!=-1||K.isASN1HEX(p))&&(p={cert:p}),p.hasis!=!1&&e.hasis==!1&&(p.hasis=!1),d.push(new a(p))}var h=new i({array:d}),c=new i({array:[h]});return[c]},e!=null&&this.setByParam(e)};H(u.asn1.cms.SigningCertificate,u.asn1.cms.Attribute);u.asn1.cms.ESSCertID=function(e){u.asn1.cms.ESSCertID.superclass.constructor.call(this);var t=Error,r=u,n=r.asn1,i=n.DEROctetString,s=n.DERSequence,a=n.cms.IssuerSerial;this.params=null,this.getCertHash=function(o,f){if(o.hash!=null)return o.hash;if(typeof o=="string"&&o.indexOf("-----BEGIN")==-1&&!K.isASN1HEX(o))return o;var d;if(typeof o=="string")d=o;else if(o.cert!=null)d=o.cert;else throw new t("hash nor cert unspecified");var m;d.indexOf("-----BEGIN")!=-1?m=me(d):m=d,typeof o=="string"&&(o.indexOf("-----BEGIN")!=-1?m=me(o):K.isASN1HEX(o)&&(m=o));var p;if(o.alg!=null)p=o.alg;else if(f!=null)p=f;else throw new t("hash alg unspecified");return r.crypto.Util.hashHex(m,p)},this.tohex=function(){var o=this.params,f=this.getCertHash(o,"sha1"),d=[];d.push(new i({hex:f})),(typeof o=="string"&&o.indexOf("-----BEGIN")!=-1||o.cert!=null&&o.hasis!=!1||o.issuer!=null&&o.serial!=null)&&d.push(new a(o));var m=new s({array:d});return m.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};H(u.asn1.cms.ESSCertID,u.asn1.ASN1Object);u.asn1.cms.SigningCertificateV2=function(e){var t=Error,r=u,n=r.asn1,i=n.DERSequence,s=n.x509,a=n.cms,o=a.ESSCertIDv2,f=r.crypto;a.SigningCertificateV2.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.47",this.getValueArray=function(){if(this.params==null||this.params==null||this.params.array==null)throw new t("parameter 'array' not specified");for(var d=this.params.array,m=[],p=0;p<d.length;p++){var h=d[p];(e.alg!=null||e.hasis==!1)&&typeof h=="string"&&(h.indexOf("-----BEGIN")!=-1||K.isASN1HEX(h))&&(h={cert:h}),h.alg==null&&e.alg!=null&&(h.alg=e.alg),h.hasis!=!1&&e.hasis==!1&&(h.hasis=!1),m.push(new o(h))}var c=new i({array:m}),g=new i({array:[c]});return[g]},e!=null&&this.setByParam(e)};H(u.asn1.cms.SigningCertificateV2,u.asn1.cms.Attribute);u.asn1.cms.ESSCertIDv2=function(e){u.asn1.cms.ESSCertIDv2.superclass.constructor.call(this);var t=Error,r=u,n=r.asn1,i=n.DEROctetString,s=n.DERSequence,a=n.cms.IssuerSerial,o=n.x509.AlgorithmIdentifier;this.params=null,this.tohex=function(){var f=this.params,d=this.getCertHash(f,"sha256"),m=[];f.alg!=null&&f.alg!="sha256"&&m.push(new o({name:f.alg})),m.push(new i({hex:d})),(typeof f=="string"&&f.indexOf("-----BEGIN")!=-1||f.cert!=null&&f.hasis!=!1||f.issuer!=null&&f.serial!=null)&&m.push(new a(f));var p=new s({array:m});return p.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};H(u.asn1.cms.ESSCertIDv2,u.asn1.cms.ESSCertID);u.asn1.cms.IssuerSerial=function(e){var t=Error,r=u,n=r.asn1,i=n.DERInteger,s=n.DERSequence,a=n.cms,o=n.x509,f=o.GeneralNames,d=X;a.IssuerSerial.superclass.constructor.call(this),this.setByParam=function(m){this.params=m},this.tohex=function(){var m=this.params,p,h;if(typeof m=="string"&&m.indexOf("-----BEGIN")!=-1||m.cert!=null){var c;m.cert!=null?c=m.cert:c=m;var g=new d;g.readCertPEM(c),p=g.getIssuer(),h={hex:g.getSerialNumberHex()}}else if(m.issuer!=null&&m.serial)p=m.issuer,h=m.serial;else throw new t("cert or issuer and serial parameter not specified");var l=new f([{dn:p}]),v=new i(h),y=new s({array:[l,v]});return y.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};H(u.asn1.cms.IssuerSerial,u.asn1.ASN1Object);u.asn1.cms.SignerIdentifier=function(e){var t=u,r=t.asn1,n=r.DERInteger,i=r.DERSequence,s=r.cms,a=s.IssuerAndSerialNumber,o=s.SubjectKeyIdentifier,f=r.x509,d=f.X500Name,m=X,p=Error;s.SignerIdentifier.superclass.constructor.call(this),this.params=null,this.tohex=function(){var h=this.params;if(h.type=="isssn"){var c=new a(h);return c.tohex()}else if(h.type=="skid"){var g=new o(h);return g.tohex()}else throw new Error("wrong property for isssn or skid")},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};H(u.asn1.cms.SignerIdentifier,u.asn1.ASN1Object);u.asn1.cms.IssuerAndSerialNumber=function(e){var t=u,r=t.asn1,n=r.DERInteger,i=r.DERSequence,s=r.cms,a=r.x509,o=a.X500Name,f=X,d=Error;s.IssuerAndSerialNumber.superclass.constructor.call(this),this.params=null,this.tohex=function(){var m=this.params,p,h;if(typeof m=="string"&&m.indexOf("-----BEGIN")!=-1||m.cert!=null){var c;m.cert!=null?c=m.cert:c=m;var g=new f;g.readCertPEM(c),p=g.getIssuer(),h={hex:g.getSerialNumberHex()}}else if(m.issuer!=null&&m.serial)p=m.issuer,h=m.serial;else throw new d("cert or issuer and serial parameter not specified");var l=new o(p),v=new n(h),y=new i({array:[l,v]});return y.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(m){this.params=m},e!=null&&this.setByParam(e)};H(u.asn1.cms.IssuerAndSerialNumber,u.asn1.ASN1Object);u.asn1.cms.SubjectKeyIdentifier=function(e){var t=u,r=t.asn1,n=r.DERInteger,i=r.DERSequence,s=r.ASN1Util.newObject,a=r.cms,o=a.IssuerAndSerialName,f=a.SubjectKeyIdentifier,d=r.x509,m=d.X500Name,p=X,h=Error;a.SubjectKeyIdentifier.superclass.constructor.call(this),this.tohex=function(){var c=this.params;if(c.cert==null&&c.skid==null)throw new h("property cert nor skid undefined");var g;if(c.cert!=null){var l=new p(c.cert),v=l.getExtSubjectKeyIdentifier();g=v.kid.hex}else c.skid!=null&&(g=c.skid);var y=s({tag:{tage:"a0",obj:{octstr:{hex:g}}}});return y.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};H(u.asn1.cms.SubjectKeyIdentifier,u.asn1.ASN1Object);u.asn1.cms.AttributeList=function(e){var t=Error,r=u,n=r.asn1,i=n.DERSet,s=n.cms;s.AttributeList.superclass.constructor.call(this),this.params=null,this.hTLV=null,this.setByParam=function(a){this.params=a},this.tohex=function(){var a=this.params;if(this.hTLV!=null)return this.hTLV;var o=!0;a.sortflag!=null&&(o=a.sortflag);for(var f=a.array,d=[],m=0;m<f.length;m++){var p=f[m],h=p.attr;if(h=="contentType")d.push(new s.ContentType(p));else if(h=="messageDigest")d.push(new s.MessageDigest(p));else if(h=="signingTime")d.push(new s.SigningTime(p));else if(h=="signingCertificate")d.push(new s.SigningCertificate(p));else if(h=="signingCertificateV2")d.push(new s.SigningCertificateV2(p));else if(h=="signaturePolicyIdentifier")d.push(new u.asn1.cades.SignaturePolicyIdentifier(p));else if(h=="signatureTimeStamp"||h=="timeStampToken")d.push(new u.asn1.cades.SignatureTimeStamp(p));else throw new t("unknown attr: "+h)}var c=new i({array:d,sortflag:o});return this.hTLV=c.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};H(u.asn1.cms.AttributeList,u.asn1.ASN1Object);u.asn1.cms.SignerInfo=function(e){var t=Error,r=u,n=r.asn1,i=n.DERInteger,s=n.DEROctetString,a=n.DERSequence,o=n.DERTaggedObject,f=n.cms,d=f.SignerIdentifier,m=f.AttributeList,p=f.ContentType,h=f.EncapsulatedContentInfo,c=f.MessageDigest,g=f.SignedData,l=n.x509,v=l.AlgorithmIdentifier,y=r.crypto,x=Z;f.SignerInfo.superclass.constructor.call(this),this.params=null,this.sign=function(){var E=this.params,P=E.sigalg,b=new m(E.sattrs).tohex(),R=x.getKey(E.signkey),T=new y.Signature({alg:P});T.init(R),T.updateHex(b);var S=T.sign();E.sighex=S},this.tohex=function(){var E=this.params,P=[];if(P.push(new i({int:E.version})),P.push(new d(E.id)),P.push(new v({name:E.hashalg})),E.sattrs!=null){var b=new m(E.sattrs);try{P.push(new o({tag:"a0",explicit:!1,obj:b}))}catch(T){throw new t("si sattr error: "+T)}}if(E.sigalgfield!=null?P.push(new v({name:E.sigalgfield})):P.push(new v({name:E.sigalg})),E.sighex==null&&E.signkey!=null&&this.sign(),P.push(new s({hex:E.sighex})),E.uattrs!=null){var b=new m(E.uattrs);try{P.push(new o({tag:"a1",explicit:!1,obj:b}))}catch(S){throw new t("si uattr error: "+S)}}var R=new a({array:P});return R.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};H(u.asn1.cms.SignerInfo,u.asn1.ASN1Object);u.asn1.cms.EncapsulatedContentInfo=function(e){var t=u,r=t.asn1,n=r.DERTaggedObject,i=r.DERSequence,s=r.DERObjectIdentifier,a=r.DEROctetString,o=r.cms;o.EncapsulatedContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var f=this.params,d=[];if(d.push(new s(f.type)),f.content!=null&&(f.content.hex!=null||f.content.str!=null)&&f.isDetached!=!0){var m=new a(f.content),p=new n({tag:"a0",explicit:!0,obj:m});d.push(p)}var h=new i({array:d});return h.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(f){this.params=f},e!=null&&this.setByParam(e)};H(u.asn1.cms.EncapsulatedContentInfo,u.asn1.ASN1Object);u.asn1.cms.ContentInfo=function(e){var t=u,r=t.asn1,n=r.DERTaggedObject,i=r.DERSequence,s=r.DERObjectIdentifier,a=r.x509,o=a.OID.name2obj;u.asn1.cms.ContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var f=this.params,d=[];d.push(new s(f.type));var m=new n({tag:"a0",explicit:!0,obj:f.obj});d.push(m);var p=new i({array:d});return p.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(f){this.params=f},e!=null&&this.setByParam(e)};H(u.asn1.cms.ContentInfo,u.asn1.ASN1Object);u.asn1.cms.SignedData=function(e){var t=Error,r=u,n=r.asn1,i=n.ASN1Object,s=n.DERInteger,a=n.DERSet,o=n.DERSequence,f=n.DERTaggedObject,d=n.cms,m=d.EncapsulatedContentInfo,p=d.SignerInfo,h=d.ContentInfo,c=d.CertificateSet,g=d.RevocationInfoChoices,l=n.x509,v=l.AlgorithmIdentifier;u.asn1.cms.SignedData.superclass.constructor.call(this),this.params=null,this.checkAndFixParam=function(){var y=this.params;this._setDigestAlgs(y),this._setContentTypeByEContent(y),this._setMessageDigestByEContent(y),this._setSignerInfoVersion(y),this._setSignedDataVersion(y)},this._setDigestAlgs=function(y){for(var x={},E=y.sinfos,P=0;P<E.length;P++){var b=E[P];x[b.hashalg]=1}y.hashalgs=Object.keys(x).sort()},this._setContentTypeByEContent=function(y){for(var x=y.econtent.type,E=y.sinfos,P=0;P<E.length;P++){var b=E[P],R=this._getAttrParamByName(b,"contentType");R.type=x}},this._setMessageDigestByEContent=function(y){var x=y.econtent,E=y.econtent.type,P=x.content.hex;P==null&&x.type=="data"&&x.content.str!=null&&(P=et(x.content.str));for(var b=y.sinfos,R=0;R<b.length;R++){var T=b[R],S=T.hashalg,w=this._getAttrParamByName(T,"messageDigest"),A=u.crypto.Util.hashHex(P,S);w.hex=A}},this._getAttrParamByName=function(y,x){for(var E=y.sattrs.array,P=0;P<E.length;P++)if(E[P].attr==x)return E[P]},this._setSignerInfoVersion=function(y){for(var x=y.sinfos,E=0;E<x.length;E++){var P=x[E],b=1;P.id.type=="skid"&&(b=3),P.version=b}},this._setSignedDataVersion=function(y){var x=this._getSignedDataVersion(y);y.version=x},this._getSignedDataVersion=function(y){if(y.revinfos!=null)for(var x=y.revinfos,E=0;E<x.length;E++){var P=x[E];if(P.ocsp!=null)return 5}for(var b=y.sinfos,E=0;E<b.length;E++){var R=y.sinfos[E];if(R.version==3)return 3}return y.econtent.type!="data"?3:1},this.tohex=function(){var y=this.params;this.getEncodedHexPrepare!=null&&this.getEncodedHexPrepare(),y.fixed!=!0&&this.checkAndFixParam();var x=[];x.push(new s({int:y.version}));for(var E=[],P=0;P<y.hashalgs.length;P++){var b=y.hashalgs[P];E.push(new v({name:b}))}x.push(new a({array:E})),x.push(new m(y.econtent)),y.certs!=null&&x.push(new c(y.certs)),y.revinfos!=null&&x.push(new g(y.revinfos));for(var R=[],P=0;P<y.sinfos.length;P++){var T=y.sinfos[P];R.push(new p(T))}x.push(new a({array:R}));var S=new o({array:x});return S.tohex()},this.getEncodedHex=function(){return this.tohex()},this.getContentInfo=function(){var y=new h({type:"signed-data",obj:this});return y},this.getContentInfoEncodedHex=function(){return this.getContentInfo().tohex()},e!=null&&this.setByParam(e)};H(u.asn1.cms.SignedData,u.asn1.ASN1Object);u.asn1.cms.CertificateSet=function(e){u.asn1.cms.CertificateSet.superclass.constructor.call(this);var t=Error,r=u.asn1,n=r.DERTaggedObject,i=r.DERSet,s=r.ASN1Object;this.params=null,this.tohex=function(){var a=this.params,o=[],f;if(a instanceof Array)f=a;else if(a.array!=null)f=a.array;else throw new t("cert array not specified");for(var d=0;d<f.length;d++){var m=f[d],p=me(m),h=new s;h.hTLV=p,o.push(h)}var c={array:o};a.sortflag==!1&&(c.sortflag=!1);var g=new i(c),l=new n({tag:"a0",explicit:!1,obj:g});return l.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};H(u.asn1.cms.CertificateSet,u.asn1.ASN1Object);u.asn1.cms.RevocationInfoChoices=function(e){u.asn1.cms.RevocationInfoChoices.superclass.constructor.call(this),this.params=null,this.tohex=function(){var t=this.params;if(!t instanceof Array)throw new Error("params is not array");for(var r=[],n=0;n<t.length;n++)r.push(new u.asn1.cms.RevocationInfoChoice(t[n]));var i=u.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:{set:r}}});return i.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};H(u.asn1.cms.RevocationInfoChoices,u.asn1.ASN1Object);u.asn1.cms.RevocationInfoChoice=function(e){u.asn1.cms.RevocationInfoChoice.superclass.constructor.call(this),this.params=null,this.tohex=function(){var t=this.params;if(t.crl!=null&&typeof t.crl=="string"){var r=t.crl;return t.crl.indexOf("-----BEGIN")!=-1&&(r=me(t.crl)),r}else if(t.ocsp!=null){var n=u.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:new u.asn1.cms.OtherRevocationFormat(t)}});return n.tohex()}else throw new Error("property crl or ocsp undefined")},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};H(u.asn1.cms.RevocationInfoChoice,u.asn1.ASN1Object);u.asn1.cms.OtherRevocationFormat=function(e){u.asn1.cms.OtherRevocationFormat.superclass.constructor.call(this);var t=Error,r=u,n=r.asn1,i=n.ASN1Util.newObject,s=r.lang.String.isHex;this.params=null,this.tohex=function(){var a=this.params;if(a.ocsp==null)throw new t("property ocsp not specified");if(!s(a.ocsp)||!K.isASN1HEX(a.ocsp))throw new t("ocsp value not ASN.1 hex string");var o=i({seq:[{oid:"1.3.6.1.5.5.7.16.2"},{asn1:{tlv:a.ocsp}}]});return o.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};H(u.asn1.cms.OtherRevocationFormat,u.asn1.ASN1Object);u.asn1.cms.CMSUtil=new function(){};u.asn1.cms.CMSUtil.newSignedData=function(e){return new u.asn1.cms.SignedData(e)};u.asn1.cms.CMSUtil.verifySignedData=function(e){var t=u,r=t.asn1,n=r.cms,i=n.SignerInfo,s=n.SignedData,a=n.SigningTime,o=n.SigningCertificate,f=n.SigningCertificateV2,d=r.cades,m=d.SignaturePolicyIdentifier,p=t.lang.String.isHex,h=K,c=h.getVbyList,g=h.getTLVbyList,l=h.getIdxbyList,v=h.getChildIdx,y=h.getTLV,x=h.oidname,E=t.crypto.Util.hashHex;e.cms===void 0&&p(e.cms);var P=e.cms,b=function(D,_){for(var O,U=3;U<6;U++)if(O=l(D,0,[1,0,U]),O!==void 0){var J=D.substr(O,2);J==="a0"&&(_.certsIdx=O),J==="a1"&&(_.revinfosIdx=O),J==="31"&&(_.signerinfosIdx=O)}},R=function(D,_){var O=_.signerinfosIdx;if(O!==void 0){var U=v(D,O);_.signerInfoIdxList=U;for(var J=0;J<U.length;J++){var G=U[J],Q={idx:G};T(D,Q),_.signerInfos.push(Q)}}},T=function(D,_){var O=_.idx;_.signerid_issuer1=g(D,O,[1,0],"30"),_.signerid_serial1=c(D,O,[1,1],"02"),_.hashalg=x(c(D,O,[2,0],"06"));var U=l(D,O,[3],"a0");_.idxSignedAttrs=U,S(D,_,U);var J=v(D,O),G=J.length;if(G<6)throw"malformed SignerInfo";_.sigalg=x(c(D,O,[G-2,0],"06")),_.sigval=c(D,O,[G-1],"04")},S=function(D,_,O){var U=v(D,O);_.signedAttrIdxList=U;for(var J=0;J<U.length;J++){var G=U[J],Q=c(D,G,[0],"06"),Y;Q==="2a864886f70d010905"?(Y=ae(c(D,G,[1,0])),_.saSigningTime=Y):Q==="2a864886f70d010904"&&(Y=c(D,G,[1,0],"04"),_.saMessageDigest=Y)}},w=function(D,_){if(c(D,0,[0],"06")!=="2a864886f70d010702")return _;_.cmsType="signedData",_.econtent=c(D,0,[1,0,2,1,0]),b(D,_),_.signerInfos=[],R(D,_)},A=function(D,_){for(var O=_.parse.signerInfos,U=O.length,J=!0,G=0;G<U;G++){var Q=O[G];I(D,_,Q,G),Q.isValid||(J=!1)}_.isValid=J},F=function(D,_,O,U){var J=_.parse.certsIdx,G;if(_.certs===void 0){G=[],_.certkeys=[];for(var Q=v(D,J),Y=0;Y<Q.length;Y++){var fe=y(D,Q[Y]),oe=new X;oe.readCertHex(fe),G[Y]=oe,_.certkeys[Y]=oe.getPublicKey()}_.certs=G}else G=_.certs;_.cccc=G.length,_.cccci=Q.length;for(var Y=0;Y<G.length;Y++){var bt=oe.getIssuerHex(),We=oe.getSerialNumberHex();O.signerid_issuer1===bt&&O.signerid_serial1===We&&(O.certkey_idx=Y)}},I=function(D,_,O,U){O.verifyDetail={};var J=O.verifyDetail,G=_.parse.econtent,Q=O.hashalg,Y=O.saMessageDigest;J.validMessageDigest=!1,E(G,Q)===Y&&(J.validMessageDigest=!0),F(D,_,O,U),J.validSignatureValue=!1;var fe=O.sigalg,oe="31"+y(D,O.idxSignedAttrs).substr(2);O.signedattrshex=oe;var bt=_.certs[O.certkey_idx].getPublicKey(),We=new u.crypto.Signature({alg:fe});We.init(bt),We.updateHex(oe);var _e=We.verify(O.sigval);J.validSignatureValue_isValid=_e,_e===!0&&(J.validSignatureValue=!0),O.isValid=!1,J.validMessageDigest&&J.validSignatureValue&&(O.isValid=!0)},N=function(){},C={isValid:!1,parse:{}};return w(P,C.parse),A(P,C),C};u.asn1.cms.CMSParser=function(){var e=Error,t=X,r=new t,n=K,i=n.getV,s=n.getTLV,a=n.getIdxbyList,o=n.getTLVbyList,f=n.getTLVbyListEx,d=n.getVbyList,m=n.getVbyListEx,p=n.getChildIdx;this.getCMSSignedData=function(h){var c=o(h,0,[1,0]),g=this.getSignedData(c);return g},this.getSignedData=function(h){var c=p(h,0),g={},l=i(h,c[0]),v=parseInt(l,16);g.version=v;var y=s(h,c[1]);g.hashalgs=this.getHashAlgArray(y);var x=s(h,c[2]);g.econtent=this.getEContent(x);var E=f(h,0,["[0]"]);E!=null&&(g.certs=this.getCertificateSet(E));var P=f(h,0,["[1]"]);P!=null;var b=f(h,0,[3]);return g.sinfos=this.getSignerInfos(b),g},this.getHashAlgArray=function(h){for(var c=p(h,0),g=new t,l=[],v=0;v<c.length;v++){var y=s(h,c[v]),x=g.getAlgorithmIdentifierName(y);l.push(x)}return l},this.getEContent=function(h){var c={},g=d(h,0,[0]),l=d(h,0,[1,0]);return c.type=u.asn1.x509.OID.oid2name(K.hextooidstr(g)),c.content={hex:l},c},this.getSignerInfos=function(h){for(var c=[],g=p(h,0),l=0;l<g.length;l++){var v=s(h,g[l]),y=this.getSignerInfo(v);c.push(y)}return c},this.getSignerInfo=function(h){var c={},g=p(h,0),l=n.getInt(h,g[0],-1);l!=-1&&(c.version=l);var v=s(h,g[1]),y=this.getIssuerAndSerialNumber(v);c.id=y;var x=s(h,g[2]),E=r.getAlgorithmIdentifierName(x);c.hashalg=E;var P=f(h,0,["[0]"]);if(P!=null){var b=this.getAttributeList(P);c.sattrs=b}var R=f(h,0,[3]),T=r.getAlgorithmIdentifierName(R);c.sigalg=T;var S=m(h,0,[4]);c.sighex=S;var w=f(h,0,["[1]"]);if(w!=null){var A=this.getAttributeList(w);c.uattrs=A}return c},this.getSignerIdentifier=function(h){if(h.substr(0,2)=="30")return this.getIssuerAndSerialNumber(h);throw new Error("SKID of signerIdentifier not supported")},this.getIssuerAndSerialNumber=function(h){var c={type:"isssn"},g=p(h,0),l=s(h,g[0]);c.issuer=r.getX500Name(l);var v=i(h,g[1]);return c.serial={hex:v},c},this.getAttributeList=function(h){for(var c=[],g=p(h,0),l=0;l<g.length;l++){var v=s(h,g[l]),y=this.getAttribute(v);c.push(y)}return{array:c}},this.getAttribute=function(h){var c={},g=p(h,0),l=n.getOID(h,g[0]),v=u.asn1.x509.OID.oid2name(l);c.attr=v;var y=s(h,g[1]),x=p(y,0);if(x.length==1)c.valhex=s(y,x[0]);else{for(var E=[],P=0;P<x.length;P++)E.push(s(y,x[P]));c.valhex=E}return v=="contentType"?this.setContentType(c):v=="messageDigest"?this.setMessageDigest(c):v=="signingTime"?this.setSigningTime(c):v=="signingCertificate"?this.setSigningCertificate(c):v=="signingCertificateV2"?this.setSigningCertificateV2(c):v=="signaturePolicyIdentifier"&&this.setSignaturePolicyIdentifier(c),c},this.setContentType=function(h){var c=n.getOIDName(h.valhex,0,null);c!=null&&(h.type=c,delete h.valhex)},this.setSigningTime=function(h){var c=i(h.valhex,0),g=ae(c);h.str=g,delete h.valhex},this.setMessageDigest=function(h){var c=i(h.valhex,0);h.hex=c,delete h.valhex},this.setSigningCertificate=function(h){var c=p(h.valhex,0);if(c.length>0){for(var g=s(h.valhex,c[0]),l=p(g,0),v=[],y=0;y<l.length;y++){var x=s(g,l[y]),E=this.getESSCertID(x);v.push(E)}h.array=v}if(c.length>1){var P=s(h.valhex,c[1]);h.polhex=P}delete h.valhex},this.setSignaturePolicyIdentifier=function(h){var c=p(h.valhex,0);if(c.length>0){var g=n.getOID(h.valhex,c[0]);h.oid=g}if(c.length>1){var l=new t,v=p(h.valhex,c[1]),y=s(h.valhex,v[0]),x=l.getAlgorithmIdentifierName(y);h.alg=x;var E=i(h.valhex,v[1]);h.hash=E}delete h.valhex},this.setSigningCertificateV2=function(h){var c=p(h.valhex,0);if(c.length>0){for(var g=s(h.valhex,c[0]),l=p(g,0),v=[],y=0;y<l.length;y++){var x=s(g,l[y]),E=this.getESSCertIDv2(x);v.push(E)}h.array=v}if(c.length>1){var P=s(h.valhex,c[1]);h.polhex=P}delete h.valhex},this.getESSCertID=function(h){var c={},g=p(h,0);if(g.length>0){var l=i(h,g[0]);c.hash=l}if(g.length>1){var v=s(h,g[1]),y=this.getIssuerSerial(v);y.serial!=null&&(c.serial=y.serial),y.issuer!=null&&(c.issuer=y.issuer)}return c},this.getESSCertIDv2=function(h){var c={},g=p(h,0);if(g.length<1||3<g.length)throw new e("wrong number of elements");var l=0;if(h.substr(g[0],2)=="30"){var v=s(h,g[0]);c.alg=r.getAlgorithmIdentifierName(v),l++}else c.alg="sha256";var y=i(h,g[l]);if(c.hash=y,g.length>l+1){var x=s(h,g[l+1]),E=this.getIssuerSerial(x);c.issuer=E.issuer,c.serial=E.serial}return c},this.getIssuerSerial=function(h){var c={},g=p(h,0),l=s(h,g[0]),v=r.getGeneralNames(l),y=v[0].dn;c.issuer=y;var x=i(h,g[1]);return c.serial={hex:x},c},this.getCertificateSet=function(h){for(var c=p(h,0),g=[],l=0;l<c.length;l++){var v=s(h,c[l]);if(v.substr(0,2)=="30"){var y=Te(v,"CERTIFICATE");g.push(y)}}return{array:g,sortflag:!1}}};(typeof u>"u"||!u)&&(u={});(typeof u.asn1>"u"||!u.asn1)&&(u.asn1={});(typeof u.asn1.tsp>"u"||!u.asn1.tsp)&&(u.asn1.tsp={});u.asn1.tsp.TimeStampToken=function(e){var t=u,r=t.asn1,n=r.tsp;n.TimeStampToken.superclass.constructor.call(this),this.params=null,this.getEncodedHexPrepare=function(){var i=new n.TSTInfo(this.params.econtent.content);this.params.econtent.content.hex=i.tohex()},e!=null&&this.setByParam(e)};H(u.asn1.tsp.TimeStampToken,u.asn1.cms.SignedData);u.asn1.tsp.TSTInfo=function(e){var t=Error,r=u,n=r.asn1,i=n.DERSequence,s=n.DERInteger,a=n.DERBoolean,o=n.DERGeneralizedTime,f=n.DERObjectIdentifier,d=n.DERTaggedObject,m=n.tsp,p=m.MessageImprint,h=m.Accuracy,c=n.x509.X500Name,g=n.x509.GeneralName;if(m.TSTInfo.superclass.constructor.call(this),this.dVersion=new s({int:1}),this.dPolicy=null,this.dMessageImprint=null,this.dSerial=null,this.dGenTime=null,this.dAccuracy=null,this.dOrdering=null,this.dNonce=null,this.dTsa=null,this.tohex=function(){var l=[this.dVersion];if(this.dPolicy==null)throw new Error("policy shall be specified.");if(l.push(this.dPolicy),this.dMessageImprint==null)throw new Error("messageImprint shall be specified.");if(l.push(this.dMessageImprint),this.dSerial==null)throw new Error("serialNumber shall be specified.");if(l.push(this.dSerial),this.dGenTime==null)throw new Error("genTime shall be specified.");l.push(this.dGenTime),this.dAccuracy!=null&&l.push(this.dAccuracy),this.dOrdering!=null&&l.push(this.dOrdering),this.dNonce!=null&&l.push(this.dNonce),this.dTsa!=null&&l.push(this.dTsa);var v=new i({array:l});return this.hTLV=v.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0){if(typeof e.policy=="string"){if(!e.policy.match(/^[0-9.]+$/))throw"policy shall be oid like 0.1.4.134";this.dPolicy=new f({oid:e.policy})}e.messageImprint!==void 0&&(this.dMessageImprint=new p(e.messageImprint)),e.serial!==void 0&&(this.dSerial=new s(e.serial)),e.genTime!==void 0&&(this.dGenTime=new o(e.genTime)),e.accuracy!==void 0&&(this.dAccuracy=new h(e.accuracy)),e.ordering!==void 0&&e.ordering==!0&&(this.dOrdering=new a),e.nonce!==void 0&&(this.dNonce=new s(e.nonce)),e.tsa!==void 0&&(this.dTsa=new d({tag:"a0",explicit:!0,obj:new g({dn:e.tsa})}))}};H(u.asn1.tsp.TSTInfo,u.asn1.ASN1Object);u.asn1.tsp.Accuracy=function(e){var t=u,r=t.asn1,n=r.ASN1Util.newObject;r.tsp.Accuracy.superclass.constructor.call(this),this.params=null,this.tohex=function(){var i=this.params,s=[];return i.seconds!=null&&typeof i.seconds=="number"&&s.push({int:i.seconds}),i.millis!=null&&typeof i.millis=="number"&&s.push({tag:{tagi:"80",obj:{int:i.millis}}}),i.micros!=null&&typeof i.micros=="number"&&s.push({tag:{tagi:"81",obj:{int:i.micros}}}),n({seq:s}).tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};H(u.asn1.tsp.Accuracy,u.asn1.ASN1Object);u.asn1.tsp.MessageImprint=function(e){var t=u,r=t.asn1,n=r.DERSequence,i=r.DEROctetString,s=r.x509,a=s.AlgorithmIdentifier;r.tsp.MessageImprint.superclass.constructor.call(this),this.params=null,this.tohex=function(){var o=this.params,f=new a({name:o.alg}),d=new i({hex:o.hash}),m=new n({array:[f,d]});return m.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};H(u.asn1.tsp.MessageImprint,u.asn1.ASN1Object);u.asn1.tsp.TimeStampReq=function(e){var t=u,r=t.asn1,n=r.DERSequence,i=r.DERInteger,s=r.DERBoolean,a=r.ASN1Object,o=r.DERObjectIdentifier,f=r.tsp,d=f.MessageImprint;f.TimeStampReq.superclass.constructor.call(this),this.params=null,this.tohex=function(){var m=this.params,p=[];p.push(new i({int:1})),m.messageImprint instanceof u.asn1.ASN1Object?p.push(m.messageImprint):p.push(new d(m.messageImprint)),m.policy!=null&&p.push(new o(m.policy)),m.nonce!=null&&p.push(new i(m.nonce)),m.certreq==!0&&p.push(new s);var h=new n({array:p});return h.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};H(u.asn1.tsp.TimeStampReq,u.asn1.ASN1Object);u.asn1.tsp.TimeStampResp=function(e){var t=u,r=t.asn1,n=r.DERSequence,i=r.ASN1Object,s=r.tsp,a=s.PKIStatusInfo;s.TimeStampResp.superclass.constructor.call(this),this.params=null,this.tohex=function(){var o=this.params,f=[];if(o.econtent!=null||o.tst!=null)if(o.statusinfo!=null?f.push(new a(o.statusinfo)):f.push(new a("granted")),o.econtent!=null)f.push(new s.TimeStampToken(o).getContentInfo());else if(o.tst instanceof r.ASN1Object)f.push(o.tst);else throw new Error("improper member tst value");else if(o.statusinfo!=null)f.push(new a(o.statusinfo));else throw new Error("parameter for token nor statusinfo not specified");var d=new n({array:f});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};H(u.asn1.tsp.TimeStampResp,u.asn1.ASN1Object);u.asn1.tsp.PKIStatusInfo=function(e){var t=Error,r=u,n=r.asn1,i=n.DERSequence,s=n.tsp,a=s.PKIStatus,o=s.PKIFreeText,f=s.PKIFailureInfo;s.PKIStatusInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var d=this.params,m=[];if(typeof d=="string")m.push(new a(d));else{if(d.status==null)throw new t("property 'status' unspecified");m.push(new a(d.status)),d.statusstr!=null&&m.push(new o(d.statusstr)),d.failinfo!=null&&m.push(new f(d.failinfo))}var p=new i({array:m});return p.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};H(u.asn1.tsp.PKIStatusInfo,u.asn1.ASN1Object);u.asn1.tsp.PKIStatus=function(e){var t=Error,r=u,n=r.asn1,i=n.DERInteger,s=n.tsp;s.PKIStatus.superclass.constructor.call(this);var a={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5};this.params=null,this.tohex=function(){var o=this.params,f,d;if(typeof o=="string")try{d=a[o]}catch{throw new t("undefined name: "+o)}else if(typeof o=="number")d=o;else throw new t("unsupported params");return new i({int:d}).tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};H(u.asn1.tsp.PKIStatus,u.asn1.ASN1Object);u.asn1.tsp.PKIFreeText=function(e){var t=Error,r=u,n=r.asn1,i=n.DERSequence,s=n.DERUTF8String,a=n.tsp;a.PKIFreeText.superclass.constructor.call(this),this.params=null,this.tohex=function(){var o=this.params;if(!o instanceof Array)throw new t("wrong params: not array");for(var f=[],d=0;d<o.length;d++)f.push(new s({str:o[d]}));var m=new i({array:f});return m.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};H(u.asn1.tsp.PKIFreeText,u.asn1.ASN1Object);u.asn1.tsp.PKIFailureInfo=function(e){var t=Error,r=u,n=r.asn1,i=n.DERBitString,s=n.tsp,a=s.PKIFailureInfo,o={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25};a.superclass.constructor.call(this),this.params=null,this.getBinValue=function(){var f=this.params,d=0;if(typeof f=="number"&&0<=f&&f<=25){d|=1<<f;for(var m=d.toString(2),p="",h=m.length-1;h>=0;h--)p+=m[h];return p}else{if(typeof f=="string"&&o[f]!=null)return Rn([f],o);if(typeof f=="object"&&f.length!=null)return Rn(f,o);throw new t("wrong params")}},this.tohex=function(){var f=this.params,d=this.getBinValue();return new i({bin:d}).tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};H(u.asn1.tsp.PKIFailureInfo,u.asn1.ASN1Object);u.asn1.tsp.AbstractTSAAdapter=function(e){this.getTSTHex=function(t,r){throw"not implemented yet"}};u.asn1.tsp.SimpleTSAAdapter=function(e){var t=u,r=t.asn1,n=r.tsp,i=t.crypto.Util.hashHex;n.SimpleTSAAdapter.superclass.constructor.call(this),this.params=null,this.serial=0,this.getTSTHex=function(s,a){var o=i(s,a);this.params.econtent.content.messageImprint={alg:a,hash:o},this.params.econtent.content.serial={int:this.serial++};var f=Math.floor(Math.random()*1e9);this.params.econtent.content.nonce={int:f};var d=new n.TimeStampToken(this.params);return d.getContentInfoEncodedHex()},e!==void 0&&(this.params=e)};H(u.asn1.tsp.SimpleTSAAdapter,u.asn1.tsp.AbstractTSAAdapter);u.asn1.tsp.FixedTSAAdapter=function(e){var t=u,r=t.asn1,n=r.tsp,i=t.crypto.Util.hashHex;n.FixedTSAAdapter.superclass.constructor.call(this),this.params=null,this.getTSTHex=function(s,a){var o=i(s,a);this.params.econtent.content.messageImprint={alg:a,hash:o};var f=new n.TimeStampToken(this.params);return f.getContentInfoEncodedHex()},e!==void 0&&(this.params=e)};H(u.asn1.tsp.FixedTSAAdapter,u.asn1.tsp.AbstractTSAAdapter);u.asn1.tsp.TSPUtil=new function(){};u.asn1.tsp.TSPUtil.newTimeStampToken=function(e){return new u.asn1.tsp.TimeStampToken(e)};u.asn1.tsp.TSPUtil.parseTimeStampReq=function(e){var t=new u.asn1.tsp.TSPParser;return t.getTimeStampReq(e)};u.asn1.tsp.TSPUtil.parseMessageImprint=function(e){var t=new u.asn1.tsp.TSPParser;return t.getMessageImprint(e)};u.asn1.tsp.TSPParser=function(){var e=Error,t=X,r=new t,n=K,i=n.getV,s=n.getTLV,a=n.getIdxbyList,o=n.getTLVbyListEx,f=n.getChildIdx,d=["granted","grantedWithMods","rejection","waiting","revocationWarning","revocationNotification"],m={0:"badAlg",2:"badRequest",5:"badDataFormat",14:"timeNotAvailable",15:"unacceptedPolicy",16:"unacceptedExtension",17:"addInfoNotAvailable",25:"systemFailure"};this.getResponse=function(p){var h=f(p,0);if(h.length==1)return this.getPKIStatusInfo(s(p,h[0]));if(h.length>1){var c=this.getPKIStatusInfo(s(p,h[0])),g=s(p,h[1]),l=this.getToken(g);return l.statusinfo=c,l}},this.getToken=function(p){var h=new u.asn1.cms.CMSParser,c=h.getCMSSignedData(p);return this.setTSTInfo(c),c},this.setTSTInfo=function(p){var h=p.econtent;if(h.type=="tstinfo"){var c=h.content.hex,g=this.getTSTInfo(c);h.content=g}},this.getTSTInfo=function(p){var h={},c=f(p,0),g=i(p,c[1]);h.policy=Kn(g);var l=s(p,c[2]);h.messageImprint=this.getMessageImprint(l);var v=i(p,c[3]);h.serial={hex:v};var y=i(p,c[4]);h.genTime={str:ae(y)};var x=0;if(c.length>5&&p.substr(c[5],2)=="30"){var E=s(p,c[5]);h.accuracy=this.getAccuracy(E),x++}if(c.length>5+x&&p.substr(c[5+x],2)=="01"){var P=i(p,c[5+x]);P=="ff"&&(h.ordering=!0),x++}if(c.length>5+x&&p.substr(c[5+x],2)=="02"){var b=i(p,c[5+x]);h.nonce={hex:b},x++}if(c.length>5+x&&p.substr(c[5+x],2)=="a0"){var R=s(p,c[5+x]);R="30"+R.substr(2),pGeneralNames=r.getGeneralNames(R);var T=pGeneralNames[0].dn;h.tsa=T,x++}if(c.length>5+x&&p.substr(c[5+x],2)=="a1"){var S=s(p,c[5+x]);S="30"+S.substr(2);var w=r.getExtParamArray(S);h.ext=w,x++}return h},this.getAccuracy=function(p){for(var h={},c=f(p,0),g=0;g<c.length;g++){var l=p.substr(c[g],2),v=i(p,c[g]),y=parseInt(v,16);l=="02"?h.seconds=y:l=="80"?h.millis=y:l=="81"&&(h.micros=y)}return h},this.getMessageImprint=function(p){if(p.substr(0,2)!="30")throw new Error("head of messageImprint hex shall be x30");var h={},c=f(p,0),g=a(p,0,[0,0]),l=i(p,g),v=n.hextooidstr(l),y=u.asn1.x509.OID.oid2name(v);if(y=="")throw new Error("hashAlg name undefined: "+v);var x=y,E=a(p,0,[1]);return h.alg=x,h.hash=i(p,E),h},this.getPKIStatusInfo=function(p){var h={},c=f(p,0),g=0;try{var l=i(p,c[0]),v=parseInt(l,16);h.status=d[v]}catch{}if(c.length>1&&p.substr(c[1],2)=="30"){var y=s(p,c[1]);h.statusstr=this.getPKIFreeText(y),g++}if(c.length>g&&p.substr(c[1+g],2)=="03"){var x=s(p,c[1+g]);h.failinfo=this.getPKIFailureInfo(x)}return h},this.getPKIFreeText=function(p){for(var h=[],c=f(p,0),g=0;g<c.length;g++)h.push(n.getString(p,c[g]));return h},this.getPKIFailureInfo=function(p){var h=n.getInt(p,0);return m[h]!=null?m[h]:h},this.getTimeStampReq=function(p){var h={};h.certreq=!1;var c=f(p,0);if(c.length<2)throw new Error("TimeStampReq must have at least 2 items");var g=s(p,c[1]);h.messageImprint=u.asn1.tsp.TSPUtil.parseMessageImprint(g);for(var l=2;l<c.length;l++){var v=c[l],y=p.substr(v,2);if(y=="06"){var x=i(p,v);h.policy=n.hextooidstr(x)}y=="02"&&(h.nonce=i(p,v)),y=="01"&&(h.certreq=!0)}return h}};(typeof u>"u"||!u)&&(u={});(typeof u.asn1>"u"||!u.asn1)&&(u.asn1={});(typeof u.asn1.cades>"u"||!u.asn1.cades)&&(u.asn1.cades={});u.asn1.cades.SignaturePolicyIdentifier=function(e){var t=u,r=t.asn1,n=r.cades,i=n.SignaturePolicyId;n.SignaturePolicyIdentifier.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.15",this.params=null,this.getValueArray=function(){return[new i(this.params)]},this.setByParam=function(s){this.params=s},e!=null&&this.setByParam(e)};H(u.asn1.cades.SignaturePolicyIdentifier,u.asn1.cms.Attribute);u.asn1.cades.SignaturePolicyId=function(e){var t=u,r=t.asn1,n=r.DERSequence,i=r.DERObjectIdentifier,s=r.x509,a=s.AlgorithmIdentifier,o=r.cades,f=o.SignaturePolicyId,d=o.OtherHashAlgAndValue;f.superclass.constructor.call(this),this.params=null,this.tohex=function(){var m=this.params,p=[];p.push(new i(m.oid)),p.push(new d(m));var h=new n({array:p});return h.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(m){this.params=m},e!=null&&this.setByParam(e)};H(u.asn1.cades.SignaturePolicyId,u.asn1.ASN1Object);u.asn1.cades.OtherHashAlgAndValue=function(e){var t=Error,r=u,n=r.asn1,i=n.DERSequence,s=n.DEROctetString,a=n.x509,o=a.AlgorithmIdentifier,f=n.cades,d=f.OtherHashAlgAndValue;d.superclass.constructor.call(this),this.params=null,this.tohex=function(){var m=this.params;if(m.alg==null)throw new t("property 'alg' not specified");if(m.hash==null&&m.cert==null)throw new t("property 'hash' nor 'cert' not specified");var p=null;if(m.hash!=null)p=m.hash;else if(m.cert!=null){if(typeof m.cert!="string")throw new t("cert not string");var h=m.cert;m.cert.indexOf("-----BEGIN")!=-1&&(h=me(m.cert)),p=u.crypto.Util.hashHex(h,m.alg)}var c=[];c.push(new o({name:m.alg})),c.push(new s({hex:p}));var g=new i({array:c});return g.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};H(u.asn1.cades.OtherHashAlgAndValue,u.asn1.ASN1Object);u.asn1.cades.OtherHashValue=function(e){u.asn1.cades.OtherHashValue.superclass.constructor.call(this);var t=Error,r=u,n=r.lang.String.isHex,i=r.asn1,s=i.DEROctetString,a=r.crypto.Util.hashHex;this.params=null,this.tohex=function(){var o=this.params;if(o.hash==null&&o.cert==null)throw new t("hash or cert not specified");var f=null;if(o.hash!=null)f=o.hash;else if(o.cert!=null){if(typeof o.cert!="string")throw new t("cert not string");var d=o.cert;o.cert.indexOf("-----BEGIN")!=-1&&(d=me(o.cert)),f=u.crypto.Util.hashHex(d,"sha1")}return new s({hex:f}).tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};H(u.asn1.cades.OtherHashValue,u.asn1.ASN1Object);u.asn1.cades.SignatureTimeStamp=function(e){var t=Error,r=u,n=r.lang.String.isHex,i=r.asn1,s=i.ASN1Object,a=i.x509,o=i.cades;o.SignatureTimeStamp.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.14",this.params=null,this.getValueArray=function(){var f=this.params;if(f.tst!=null)if(n(f.tst)){var d=new s;return d.hTLV=f.tst,[d]}else{if(f.tst instanceof s)return[f.tst];throw new t("params.tst has wrong value")}else if(f.res!=null){var m=f.res;if(m instanceof s&&(m=m.tohex()),typeof m!="string"||!n(m))throw new t("params.res has wrong value");var p=K.getTLVbyList(m,0,[1]),d=new s;return d.hTLV=f.tst,[d]}},e!=null&&this.setByParam(e)};H(u.asn1.cades.SignatureTimeStamp,u.asn1.cms.Attribute);u.asn1.cades.CompleteCertificateRefs=function(e){var t=Error,r=u,n=r.asn1,i=n.DERSequence,s=n.cades,a=s.OtherCertID,o=r.lang.String.isHex;s.CompleteCertificateRefs.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.21",this.params=null,this.getValueArray=function(){for(var f=this.params,d=[],m=0;m<f.array.length;m++){var p=f.array[m];if(typeof p=="string")if(p.indexOf("-----BEGIN")!=-1)p={cert:p};else if(o(p))p={hash:p};else throw new t("unsupported value: "+p);f.alg!=null&&p.alg==null&&(p.alg=f.alg),f.hasis!=null&&p.hasis==null&&(p.hasis=f.hasis);var h=new a(p);d.push(h)}var c=new i({array:d});return[c]},e!=null&&this.setByParam(e)};H(u.asn1.cades.CompleteCertificateRefs,u.asn1.cms.Attribute);u.asn1.cades.OtherCertID=function(e){var t=u,r=t.asn1,n=r.DERSequence,i=r.cms,s=i.IssuerSerial,a=r.cades,o=a.OtherHashValue,f=a.OtherHashAlgAndValue;a.OtherCertID.superclass.constructor.call(this),this.params=e,this.tohex=function(){var d=this.params;typeof d=="string"&&(d.indexOf("-----BEGIN")!=-1?d={cert:d}:_isHex(d)&&(d={hash:d}));var m=[],p=null;if(d.alg!=null?p=new f(d):p=new o(d),m.push(p),d.cert!=null&&d.hasis==!0||d.issuer!=null&&d.serial!=null){var h=new s(d);m.push(h)}var c=new n({array:m});return c.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};H(u.asn1.cades.OtherCertID,u.asn1.ASN1Object);u.asn1.cades.OtherHash=function(e){var t=Error,r=u,n=r.asn1,i=n.cms,s=n.cades,a=s.OtherHashAlgAndValue,o=s.OtherHashValue,f=r.crypto.Util.hashHex,d=r.lang.String.isHex;s.OtherHash.superclass.constructor.call(this),this.params=null,this.tohex=function(){var m=this.params;typeof m=="string"&&(m.indexOf("-----BEGIN")!=-1?m={cert:m}:d(m)&&(m={hash:m}));var p=null;return m.alg!=null?p=new a(m):p=new o(m),p.tohex()},this.getEncodedHex=function(){return this.tohex()},e!=null&&this.setByParam(e)};H(u.asn1.cades.OtherHash,u.asn1.ASN1Object);u.asn1.cades.CAdESUtil=new function(){};u.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(e){var t=new u.asn1.cms.CMSParser,r=t.getCMSSignedData(e);return r};u.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(e,t,r){var n=K,i=n.getChildIdx,s=n.getTLV,a=n.getV,o=u,f=o.asn1,d=f.ASN1Object,m=f.cms,p=m.AttributeList,h=m.SignerInfo,c={},g=i(e,t);if(g.length!=6)throw"not supported items for SignerInfo (!=6)";var l=g.shift();c.version=s(e,l);var v=g.shift();c.si=s(e,v);var y=g.shift();c.digalg=s(e,y);var x=g.shift();c.sattrs=s(e,x);var E=g.shift();c.sigalg=s(e,E);var P=g.shift();c.sig=s(e,P),c.sigval=a(e,P);var b=null;return c.obj=new h,b=new d,b.hTLV=c.version,c.obj.dCMSVersion=b,b=new d,b.hTLV=c.si,c.obj.dSignerIdentifier=b,b=new d,b.hTLV=c.digalg,c.obj.dDigestAlgorithm=b,b=new d,b.hTLV=c.sattrs,c.obj.dSignedAttrs=b,b=new d,b.hTLV=c.sigalg,c.obj.dSigAlg=b,b=new d,b.hTLV=c.sig,c.obj.dSig=b,c.obj.dUnsignedAttrs=new p,c};(typeof u.asn1.csr>"u"||!u.asn1.csr)&&(u.asn1.csr={});u.asn1.csr.CertificationRequest=function(e){var t=u,r=t.asn1,n=r.DERBitString,i=r.DERSequence,s=r.csr,a=r.x509,o=s.CertificationRequestInfo;s.CertificationRequest.superclass.constructor.call(this),this.setByParam=function(f){this.params=f},this.sign=function(){var f=new o(this.params).tohex(),d=new u.crypto.Signature({alg:this.params.sigalg});d.init(this.params.sbjprvkey),d.updateHex(f);var m=d.sign();this.params.sighex=m},this.getPEM=function(){return Te(this.tohex(),"CERTIFICATE REQUEST")},this.tohex=function(){var f=this.params,d=new u.asn1.csr.CertificationRequestInfo(this.params),m=new u.asn1.x509.AlgorithmIdentifier({name:f.sigalg});if(f.sighex==null&&f.sbjprvkey!=null&&this.sign(),f.sighex==null)throw new Error("sighex or sbjprvkey parameter not defined");var p=new n({hex:"00"+f.sighex}),h=new i({array:[d,m,p]});return h.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};H(u.asn1.csr.CertificationRequest,u.asn1.ASN1Object);u.asn1.csr.CertificationRequestInfo=function(e){var t=u,r=t.asn1,n=r.DERBitString,i=r.DERSequence,s=r.DERInteger,a=r.DERUTF8String,o=r.DERTaggedObject,f=r.ASN1Util.newObject,d=r.csr,m=r.x509,p=m.X500Name,h=m.Extensions,c=m.SubjectPublicKeyInfo,g=d.AttributeList;d.CertificationRequestInfo.superclass.constructor.call(this),this.params=null,this.setByParam=function(v){v!=null&&(this.params=v)},this.tohex=function(){var v=this.params,y=[];if(y.push(new s({int:0})),y.push(new p(v.subject)),y.push(new c(Z.getKey(v.sbjpubkey))),v.attrs!=null){var x=l(v.attrs),E=f({tag:{tage:"a0",obj:x}});y.push(E)}else if(v.extreq!=null){var P=new h(v.extreq),E=f({tag:{tage:"a0",obj:{seq:[{oid:"1.2.840.113549.1.9.14"},{set:[P]}]}}});y.push(E)}else y.push(new o({tag:"a0",explicit:!1,obj:new a({str:""})}));var b=new i({array:y});return b.tohex()},this.getEncodedHex=function(){return this.tohex()};function l(v){for(var y=Error,x=u.asn1.x509.Extensions,E=[],P=0;P<v.length;P++){var b=v[P],R=b.attr;if(R=="extensionRequest"){var T=new x(b.ext),S={seq:[{oid:"1.2.840.113549.1.9.14"},{set:[T]}]};E.push(S)}else if(R=="unstructuredName"){var S={seq:[{oid:"1.2.840.113549.1.9.2"},{set:b.names}]};E.push(S)}else if(R=="challengePassword"){var S={seq:[{oid:"1.2.840.113549.1.9.7"},{set:[{utf8str:b.password}]}]};E.push(S)}else throw new y("unknown CSR attribute")}return{set:E}}e!=null&&this.setByParam(e)};H(u.asn1.csr.CertificationRequestInfo,u.asn1.ASN1Object);u.asn1.csr.AttributeList=function(e){function t(r){}};H(u.asn1.csr.AttributeList,u.asn1.ASN1Object);u.asn1.csr.CSRUtil=new function(){};u.asn1.csr.CSRUtil.newCSRPEM=function(e){var t=Z,r=u.asn1.csr,n=new r.CertificationRequest(e),i=n.getPEM();return i};u.asn1.csr.CSRUtil.getParam=function(e,t){var r=K,n=r.getV,i=r.getIdxbyList,s=r.getTLVbyList,a=r.getTLVbyListEx,o=r.getVbyListEx,f=function(x){var E=i(x,0,[0,3,0,0],"06");return n(x,E)!="2a864886f70d01090e"?null:s(x,0,[0,3,0,1,0],"30")},d={};if(e.indexOf("-----BEGIN CERTIFICATE REQUEST")==-1)throw new Error("argument is not PEM file");var m=me(e,"CERTIFICATE REQUEST");t&&(d.tbs=s(m,0,[0]));try{var p=a(m,0,[0,1]);if(p=="3000")d.subject={};else{var l=new X;d.subject=l.getX500Name(p)}}catch{}var h=a(m,0,[0,2]),c=Z.getKey(h,null,"pkcs8pub");d.sbjpubkey=Z.getPEM(c,"PKCS8PUB");var g=f(m),l=new X;g!=null&&(d.extreq=l.getExtParamArray(g));try{var v=a(m,0,[1],"30"),l=new X;d.sigalg=l.getAlgorithmIdentifierName(v)}catch{}try{var y=o(m,0,[2]);d.sighex=y}catch{}return d};u.asn1.csr.CSRUtil.verifySignature=function(e){try{var t=null;if(typeof e=="string"&&e.indexOf("-----BEGIN CERTIFICATE REQUEST")!=-1?t=u.asn1.csr.CSRUtil.getParam(e,!0):typeof e=="object"&&e.sbjpubkey!=null&&e.sigalg!=null&&e.sighex!=null&&e.tbs!=null&&(t=e),t==null)return!1;var r=new u.crypto.Signature({alg:t.sigalg});return r.init(t.sbjpubkey),r.updateHex(t.tbs),r.verify(t.sighex)}catch(n){return alert(n),!1}};(typeof u>"u"||!u)&&(u={});(typeof u.asn1>"u"||!u.asn1)&&(u.asn1={});(typeof u.asn1.ocsp>"u"||!u.asn1.ocsp)&&(u.asn1.ocsp={});u.asn1.ocsp.DEFAULT_HASH="sha1";u.asn1.ocsp.OCSPResponse=function(e){u.asn1.ocsp.OCSPResponse.superclass.constructor.call(this);var t=u.asn1.DEREnumerated,r=u.asn1.ASN1Util.newObject,n=u.asn1.ocsp.ResponseBytes,i=["successful","malformedRequest","internalError","tryLater","_not_used_","sigRequired","unauthorized"];this.params=null,this._getStatusCode=function(){var s=this.params.resstatus;return typeof s=="number"?s:typeof s!="string"?-1:i.indexOf(s)},this.setByParam=function(s){this.params=s},this.tohex=function(){var s=this.params,a=this._getStatusCode();if(a==-1)throw new Error("responseStatus not supported: "+s.resstatus);if(a!=0)return r({seq:[{enum:{int:a}}]}).tohex();var o=new n(s);return r({seq:[{enum:{int:0}},{tag:{tag:"a0",explicit:!0,obj:o}}]}).tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};H(u.asn1.ocsp.OCSPResponse,u.asn1.ASN1Object);u.asn1.ocsp.ResponseBytes=function(e){u.asn1.ocsp.ResponseBytes.superclass.constructor.call(this);var t=u.asn1,r=t.DERSequence,n=t.DERObjectIdentifier,i=t.DEROctetString,s=t.ocsp.BasicOCSPResponse;this.params=null,this.setByParam=function(a){this.params=a},this.tohex=function(){var a=this.params;if(a.restype!="ocspBasic")throw new Error("not supported responseType: "+a.restype);var o=new s(a),f=[];f.push(new n({name:"ocspBasic"})),f.push(new i({hex:o.tohex()}));var d=new r({array:f});return d.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};H(u.asn1.ocsp.ResponseBytes,u.asn1.ASN1Object);u.asn1.ocsp.BasicOCSPResponse=function(e){u.asn1.ocsp.BasicOCSPResponse.superclass.constructor.call(this);var t=Error,r=u.asn1,n=r.ASN1Object,i=r.DERSequence,s=r.DERGeneralizedTime,a=r.DERTaggedObject,o=r.DERBitString,f=r.x509.Extensions,d=r.x509.AlgorithmIdentifier,m=r.ocsp,p=m.ResponderID;_SingleResponseList=m.SingleResponseList,_ResponseData=m.ResponseData,this.params=null,this.setByParam=function(h){this.params=h},this.sign=function(){var h=this.params,c=h.tbsresp.tohex(),g=new u.crypto.Signature({alg:h.sigalg});g.init(h.reskey),g.updateHex(c),h.sighex=g.sign()},this.tohex=function(){var h=this.params;h.tbsresp==null&&(h.tbsresp=new _ResponseData(h)),h.sighex==null&&h.reskey!=null&&this.sign();var c=[];if(c.push(h.tbsresp),c.push(new d({name:h.sigalg})),c.push(new o({hex:"00"+h.sighex})),h.certs!=null&&h.certs.length!=null){for(var g=[],l=0;l<h.certs.length;l++){var v=h.certs[l],y=null;if(K.isASN1HEX(v))y=v;else if(v.match(/-----BEGIN/))y=me(v);else throw new t("certs["+l+"] not hex or PEM");g.push(new n({tlv:y}))}var x=new i({array:g});c.push(new a({tag:"a0",explicit:!0,obj:x}))}var E=new i({array:c});return E.tohex()},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};H(u.asn1.ocsp.BasicOCSPResponse,u.asn1.ASN1Object);u.asn1.ocsp.ResponseData=function(e){u.asn1.ocsp.ResponseData.superclass.constructor.call(this);var t=Error,r=u.asn1,n=r.DERSequence,i=r.DERGeneralizedTime,s=r.DERTaggedObject,a=r.x509.Extensions,o=r.ocsp,f=o.ResponderID;_SingleResponseList=o.SingleResponseList,this.params=null,this.tohex=function(){var d=this.params;d.respid!=null&&new t("respid not specified"),d.prodat!=null&&new t("prodat not specified"),d.array!=null&&new t("array not specified");var m=[];if(m.push(new f(d.respid)),m.push(new i(d.prodat)),m.push(new _SingleResponseList(d.array)),d.ext!=null){var p=new a(d.ext);m.push(new s({tag:"a1",explicit:!0,obj:p}))}var h=new n({array:m});return h.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(d){this.params=d},e!==void 0&&this.setByParam(e)};H(u.asn1.ocsp.ResponseData,u.asn1.ASN1Object);u.asn1.ocsp.ResponderID=function(e){u.asn1.ocsp.ResponderID.superclass.constructor.call(this);var t=u,r=t.asn1,n=r.ASN1Util.newObject,i=r.x509.X500Name,s=t.lang.String.isHex,a=Error;this.params=null,this.tohex=function(){var o=this.params;if(o.key!=null){var f=null;if(typeof o.key=="string"){if(s(o.key)&&(f=o.key),o.key.match(/-----BEGIN CERTIFICATE/)){var d=new X(o.key),m=d.getExtSubjectKeyIdentifier();m!=null&&(f=m.kid.hex)}}else if(o.key instanceof X){var m=o.key.getExtSubjectKeyIdentifier();m!=null&&(f=m.kid.hex)}if(f==null)throw new a("wrong key member value");var p=n({tag:{tag:"a2",explicit:!0,obj:{octstr:{hex:f}}}});return p.tohex()}else if(o.name!=null){var h=null;if(typeof o.name=="string"&&o.name.match(/-----BEGIN CERTIFICATE/)){var d=new X(o.name);h=d.getSubject()}else o.name instanceof X?h=o.name.getSubject():typeof o.name=="object"&&(o.name.array!=null||o.name.str!=null)&&(h=o.name);if(h==null)throw new a("wrong name member value");var p=n({tag:{tag:"a1",explicit:!0,obj:new i(h)}});return p.tohex()}throw new a("key or name not specified")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(o){this.params=o},e!==void 0&&this.setByParam(e)};H(u.asn1.ocsp.ResponderID,u.asn1.ASN1Object);u.asn1.ocsp.SingleResponseList=function(e){u.asn1.ocsp.SingleResponseList.superclass.constructor.call(this);var t=u.asn1,r=t.DERSequence,n=t.ocsp.SingleResponse;this.params=null,this.tohex=function(){var i=this.params;if(typeof i!="object"||i.length==null)throw new Error("params not specified properly");for(var s=[],a=0;a<i.length;a++)s.push(new n(i[a]));var o=new r({array:s});return o.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(i){this.params=i},e!==void 0&&this.setByParam(e)};H(u.asn1.ocsp.SingleResponseList,u.asn1.ASN1Object);u.asn1.ocsp.SingleResponse=function(e){var t=Error,r=u,n=r.asn1,i=n.DERSequence,s=n.DERGeneralizedTime,a=n.DERTaggedObject,o=n.ocsp,f=o.CertID,d=o.CertStatus,m=n.x509,p=m.Extensions;o.SingleResponse.superclass.constructor.call(this),this.params=null,this.tohex=function(){var h=this.params,c=[];if(h.certid==null)throw new t("certid unspecified");if(h.status==null)throw new t("status unspecified");if(h.thisupdate==null)throw new t("thisupdate unspecified");if(c.push(new f(h.certid)),c.push(new d(h.status)),c.push(new s(h.thisupdate)),h.nextupdate!=null){var g=new s(h.nextupdate);c.push(new a({tag:"a0",explicit:!0,obj:g}))}if(h.ext!=null){var l=new p(h.ext);c.push(new a({tag:"a1",explicit:!0,obj:l}))}var v=new i({array:c});return v.tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(h){this.params=h},e!==void 0&&this.setByParam(e)};H(u.asn1.ocsp.SingleResponse,u.asn1.ASN1Object);u.asn1.ocsp.CertID=function(e){var t=u,r=t.asn1,n=r.DEROctetString,i=r.DERInteger,s=r.DERSequence,a=r.x509,o=a.AlgorithmIdentifier,f=r.ocsp,d=f.DEFAULT_HASH,m=t.crypto,p=m.Util.hashHex,h=X,c=K,g=c.getVbyList;f.CertID.superclass.constructor.call(this),this.DEFAULT_HASH="sha1",this.params=null,this.setByValue=function(l,v,y,x){x==null&&(x=this.DEFAULT_HASH),this.params={alg:x,issname:l,isskey:v,sbjsn:y}},this.setByCert=function(l,v,y){y==null&&(y=this.DEFAULT_HASH),this.params={alg:y,issuerCert:l,subjectCert:v}},this.getParamByCerts=function(l,v,y){y==null&&(y=this.DEFAULT_HASH);var x=new h(l),E=new h(v),P=p(x.getSubjectHex(),y),b=x.getPublicKeyHex(),R=p(g(b,0,[1],"03",!0),y),T=E.getSerialNumberHex(),S={alg:y,issname:P,isskey:R,sbjsn:T};return S},this.tohex=function(){if(typeof this.params!="object")throw new Error("params not set");var l=this.params,v,y,x,E;if(l.alg==null?E=this.DEFAULT_HASH:E=l.alg,l.issuerCert!=null&&l.subjectCert!=null){var P=this.getParamByCerts(l.issuerCert,l.subjectCert,E);v=P.issname,y=P.isskey,x=P.sbjsn}else if(l.issname!=null&&l.isskey!=null&&l.sbjsn!=null)v=l.issname,y=l.isskey,x=l.sbjsn;else throw new Error("required param members not defined");var b=new o({name:E}),R=new n({hex:v}),T=new n({hex:y}),S=new i({hex:x}),w=new s({array:[b,R,T,S]});return this.hTLV=w.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&this.setByParam(e)};H(u.asn1.ocsp.CertID,u.asn1.ASN1Object);u.asn1.ocsp.CertStatus=function(e){u.asn1.ocsp.CertStatus.superclass.constructor.call(this),this.params=null,this.tohex=function(){var t=this.params;if(t.status=="good")return"8000";if(t.status=="unknown")return"8200";if(t.status=="revoked"){var r=[{gentime:{str:t.time}}];t.reason!=null&&r.push({tag:{tag:"a0",explicit:!0,obj:{enum:{int:t.reason}}}});var n={tag:"a1",explicit:!1,obj:{seq:r}};return u.asn1.ASN1Util.newObject({tag:n}).tohex()}throw new Error("bad status")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(t){this.params=t},e!==void 0&&this.setByParam(e)};H(u.asn1.ocsp.CertStatus,u.asn1.ASN1Object);u.asn1.ocsp.Request=function(e){var t=u,r=t.asn1,n=r.DERSequence,i=r.ocsp;if(i.Request.superclass.constructor.call(this),this.dReqCert=null,this.dExt=null,this.tohex=function(){var a=[];if(this.dReqCert===null)throw"reqCert not set";a.push(this.dReqCert);var o=new n({array:a});return this.hTLV=o.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},typeof e<"u"){var s=new i.CertID(e);this.dReqCert=s}};H(u.asn1.ocsp.Request,u.asn1.ASN1Object);u.asn1.ocsp.TBSRequest=function(e){var t=u,r=t.asn1,n=r.DERSequence,i=r.ocsp;i.TBSRequest.superclass.constructor.call(this),this.version=0,this.dRequestorName=null,this.dRequestList=[],this.dRequestExt=null,this.setRequestListByParam=function(s){for(var a=[],o=0;o<s.length;o++){var f=new i.Request(s[0]);a.push(f)}this.dRequestList=a},this.tohex=function(){var s=[];if(this.version!==0)throw"not supported version: "+this.version;if(this.dRequestorName!==null)throw"requestorName not supported";var a=new n({array:this.dRequestList});if(s.push(a),this.dRequestExt!==null)throw"requestExtensions not supported";var o=new n({array:s});return this.hTLV=o.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&e.reqList!==void 0&&this.setRequestListByParam(e.reqList)};H(u.asn1.ocsp.TBSRequest,u.asn1.ASN1Object);u.asn1.ocsp.OCSPRequest=function(e){var t=u,r=t.asn1,n=r.DERSequence,i=r.ocsp;if(i.OCSPRequest.superclass.constructor.call(this),this.dTbsRequest=null,this.dOptionalSignature=null,this.tohex=function(){var a=[];if(this.dTbsRequest!==null)a.push(this.dTbsRequest);else throw"tbsRequest not set";if(this.dOptionalSignature!==null)throw"optionalSignature not supported";var o=new n({array:a});return this.hTLV=o.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},e!==void 0&&e.reqList!==void 0){var s=new i.TBSRequest(e);this.dTbsRequest=s}};H(u.asn1.ocsp.OCSPRequest,u.asn1.ASN1Object);u.asn1.ocsp.OCSPUtil={};u.asn1.ocsp.OCSPUtil.getRequestHex=function(e,t,r){var n=u,i=n.asn1,s=i.ocsp;r===void 0&&(r=s.DEFAULT_HASH);var a={alg:r,issuerCert:e,subjectCert:t},o=new s.OCSPRequest({reqList:[a]});return o.tohex()};u.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(e){var t=K,r=t.getVbyList,n=t.getVbyListEx,i=t.getIdxbyList,s=t.getIdxbyListEx,a=t.getV,o={};try{var f=n(e,0,[0],"0a");o.responseStatus=parseInt(f,16)}catch{}if(o.responseStatus!==0)return o;try{var d=i(e,0,[1,0,1,0,0,2,0,1]);e.substr(d,2)==="80"?o.certStatus="good":e.substr(d,2)==="a1"?(o.certStatus="revoked",o.revocationTime=ae(r(e,d,[0]))):e.substr(d,2)==="82"&&(o.certStatus="unknown")}catch{}try{var m=i(e,0,[1,0,1,0,0,2,0,2]);o.thisUpdate=ae(a(e,m))}catch{}try{var p=i(e,0,[1,0,1,0,0,2,0,3]);e.substr(p,2)==="a0"&&(o.nextUpdate=ae(r(e,p,[0])))}catch{}return o};u.asn1.ocsp.OCSPParser=function(){var e=Error,t=X,r=new t,n=K,i=n.getV,s=n.getTLV,a=n.getIdxbyList,o=n.getVbyList,f=n.getTLVbyList,d=n.getVbyListEx,m=n.getTLVbyListEx,p=n.getChildIdx;this.getOCSPRequest=function(h){var c=p(h,0);if(c.length!=1&&c.length!=2)throw new e("wrong number elements: "+c.length);var g=this.getTBSRequest(s(h,c[0]));return g},this.getTBSRequest=function(h){var c={},g=m(h,0,[0],"30");c.array=this.getRequestList(g);var l=m(h,0,["[2]",0],"30");return l!=null&&(c.ext=r.getExtParamArray(l)),c},this.getRequestList=function(h){for(var c=[],g=p(h,0),l=0;l<g.length;l++){var h=s(h,g[l]);c.push(this.getRequest(h))}return c},this.getRequest=function(h){var c=p(h,0);if(c.length!=1&&c.length!=2)throw new e("wrong number elements: "+c.length);var g=this.getCertID(s(h,c[0]));if(c.length==2){var l=a(h,0,[1,0]);g.ext=r.getExtParamArray(s(h,l))}return g},this.getCertID=function(h){var c=p(h,0);if(c.length!=4)throw new e("wrong number elements: "+c.length);var g=new t,l={};return l.alg=g.getAlgorithmIdentifierName(s(h,c[0])),l.issname=i(h,c[1]),l.isskey=i(h,c[2]),l.sbjsn=i(h,c[3]),l},this.getOCSPResponse=function(h){var c=p(h,0),g,l=i(h,c[0]),v=parseInt(l);if(c.length==1)return{resstatus:v};var y=f(h,0,[1,0]);return g=this.getResponseBytes(y),g.resstatus=v,g},this.getResponseBytes=function(h){var c=p(h,0),g,l=f(h,0,[1,0]);g=this.getBasicOCSPResponse(l);var v=i(h,c[0]);return g.restype=u.asn1.x509.OID.oid2name(Kn(v)),g},this.getBasicOCSPResponse=function(h){var c=p(h,0),g;g=this.getResponseData(s(h,c[0]));var l=new X;g.alg=l.getAlgorithmIdentifierName(s(h,c[1]));var v=i(h,c[2]);g.sighex=v.substr(2);var y=d(h,0,["[0]"]);if(y!=null){for(var x=p(y,0),E=[],P=0;P<x.length;P++){var b=s(y,x[P]);E.push(b)}g.certs=E}return g},this.getResponseData=function(h){var c=p(h,0),g=c.length,l={},v=0;h.substr(c[0],2)=="a0"&&v++,l.respid=this.getResponderID(s(h,c[v++]));var y=i(h,c[v++]);if(l.prodat=ae(y),l.array=this.getSingleResponseList(s(h,c[v++])),h.substr(c[g-1],2)=="a1"){var x=f(h,c[g-1],[0]),E=new X;l.ext=E.getExtParamArray(x)}return l},this.getResponderID=function(h){var c={};if(h.substr(0,2)=="a2"){var g=o(h,0,[0]);c.key=g}if(h.substr(0,2)=="a1"){var l=f(h,0,[0]),v=new X;c.name=v.getX500Name(l)}return c},this.getSingleResponseList=function(h){for(var c=p(h,0),g=[],l=0;l<c.length;l++){var v=this.getSingleResponse(s(h,c[l]));g.push(v)}return g},this.getSingleResponse=function(h){var c=p(h,0),g={},l=this.getCertID(s(h,c[0]));g.certid=l;var v=this.getCertStatus(s(h,c[1]));if(g.status=v,h.substr(c[2],2)=="18"){var y=i(h,c[2]);g.thisupdate=ae(y)}for(var x=3;x<c.length;x++){if(h.substr(c[x],2)=="a0"){var E=o(h,c[x],[0],"18");g.nextupdate=ae(E)}if(h.substr(c[x],2)=="a1"){var P=new X,b=f(h,0,[x,0]);g.ext=P.getExtParamArray(b)}}return g},this.getCertStatus=function(h){var c={};if(h=="8000")return{status:"good"};if(h=="8200")return{status:"unknown"};if(h.substr(0,2)=="a1"){c.status="revoked";var g=o(h,0,[0]),l=ae(g);c.time=l}return c}};var u;(typeof u>"u"||!u)&&(u={});(typeof u.lang>"u"||!u.lang)&&(u.lang={});u.lang.String=function(){};function Oa(e){for(var t=new Array,r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}function Ha(e){for(var t="",r=0;r<e.length;r++)t=t+String.fromCharCode(e[r]);return t}function Nn(e){for(var t="",r=0;r<e.length;r++){var n=e[r].toString(16);n.length==1&&(n="0"+n),t=t+n}return t}function Ge(e){return Nn(Oa(e))}function zl(e){return It(Ge(e))}function Wl(e){return lr(It(Ge(e)))}function Xl(e){return Ha(Da(qr(e)))}function lr(e){return e=e.replace(/\=/g,""),e=e.replace(/\+/g,"-"),e=e.replace(/\//g,"_"),e}function qr(e){return e.length%4==2?e=e+"==":e.length%4==3&&(e=e+"="),e=e.replace(/-/g,"+"),e=e.replace(/_/g,"/"),e}function Pe(e){return e.length%2==1&&(e="0"+e),lr(It(e))}function ge(e){return dr(qr(e))}var Kr,ut;typeof L.Buffer=="function"?(Kr=function(e){return lr(L.Buffer.from(e,"utf8").toString("base64"))},ut=function(e){return L.Buffer.from(qr(e),"base64").toString("utf8")}):(Kr=function(e){return Pe(Hn(Mn(e)))},ut=function(e){return decodeURIComponent(jn(ge(e)))});function Jl(e){return It(Hn(Mn(e)))}function $l(e){return decodeURIComponent(jn(dr(e)))}function Tn(e){return Hn(Mn(e)).toLowerCase()}function ae(e){try{return decodeURIComponent(jn(e))}catch{return null}}function Yl(e){return ae(Zl(e))}function Zl(e){for(var t=e.match(/.{1,2}/g),r=[],n=0;n<t.length;n++){var i=parseInt(t[n],16);161<=i&&i<=191?(r.push("c2"),r.push(t[n])):192<=i&&i<=255?(r.push("c3"),r.push((i-64).toString(16))):r.push(t[n])}return r.join("")}function He(e){for(var t="",r=0;r<e.length-1;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t}function et(e){for(var t="",r=0;r<e.length;r++)t+=("0"+e.charCodeAt(r).toString(16)).slice(-2);return t}function Li(e){return It(e)}function Ql(e){return On(Li(e),64)}function On(e,t){return e=e.replace(new RegExp("(.{"+t+"})","g"),`$1\r
`),e=e.replace(/\s+$/,""),e}function ja(e){var t=e.replace(/[^0-9A-Za-z\/+=]*/g,""),r=dr(t);return r}function e1(e,t){return"-----BEGIN "+t+`-----\r
`+On(e,64)+`\r
-----END `+t+`-----\r
`}function Te(e,t){return"-----BEGIN "+t+`-----\r
`+On(Li(e),64)+`\r
-----END `+t+`-----\r
`}function me(e,t){if(e.indexOf("-----BEGIN ")==-1)throw new Error("can't find PEM header");return t!==void 0?(e=e.replace(new RegExp("^[^]*-----BEGIN "+t+"-----"),""),e=e.replace(new RegExp("-----END "+t+"-----[^]*$"),"")):(e=e.replace(/^[^]*-----BEGIN [^-]+-----/,""),e=e.replace(/-----END [^-]+-----[^]*$/,"")),ja(e)}function t1(e){return e.indexOf("-----BEGIN ")==-1||e.indexOf("-----END ")==-1?null:(e=e.replace(/^[\s\S]*?-----BEGIN [^-]+-----/m,""),e=e.replace(/-----END [\s\S]+$/m,""),e=e.replace(/\s+/g,""),e.match(/^[0-9a-zA-Z+/=]+$/)?e:null)}function r1(e){if(e.length%2!=0)throw"input is not even length";if(e.match(/^[0-9A-Fa-f]+$/)==null)throw"input is not hexadecimal";for(var t=new ArrayBuffer(e.length/2),r=new DataView(t),n=0;n<e.length/2;n++)r.setUint8(n,parseInt(e.substr(n*2,2),16));return t}function n1(e){for(var t="",r=new DataView(e),n=0;n<e.byteLength;n++)t+=("00"+r.getUint8(n).toString(16)).slice(-2);return t}function ki(e){var t,r,n,i,s,a,o,f,d,m,p,h;if(e=Ka(e),h=e.match(/^(\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/),h)return t=parseInt(h[1]),r=parseInt(h[2])-1,n=parseInt(h[3]),i=parseInt(h[4]),s=parseInt(h[5]),a=parseInt(h[6]),o=0,m=h[7],m!==""&&(p=(m.substr(1)+"00").substr(0,3),o=parseInt(p)),Date.UTC(t,r,n,i,s,a,o);throw new Error("unsupported zulu format: "+e)}function i1(e){var t=new Date(e),r=("0000"+t.getUTCFullYear()).slice(-4),n=("00"+(t.getUTCMonth()+1)).slice(-2),i=("00"+t.getUTCDate()).slice(-2),s=("00"+t.getUTCHours()).slice(-2),a=("00"+t.getUTCMinutes()).slice(-2),o=("00"+t.getUTCSeconds()).slice(-2),f=("000"+t.getUTCMilliseconds()).slice(-3);return f=f.replace(/0+$/,""),f=f!=""?"."+f:f,r+n+i+s+a+o+f+"Z"}function Ma(e){return Math.round(ki(e)/1e3)}function s1(e){return new Date(ki(e))}function a1(e,t,r){var n,i=e.getUTCFullYear();if(t){if(i<1950||2049<i)throw"not proper year for UTCTime: "+i;n=(""+i).slice(-2)}else n=("000"+i).slice(-4);if(n+=("0"+(e.getUTCMonth()+1)).slice(-2),n+=("0"+e.getUTCDate()).slice(-2),n+=("0"+e.getUTCHours()).slice(-2),n+=("0"+e.getUTCMinutes()).slice(-2),n+=("0"+e.getUTCSeconds()).slice(-2),r){var s=e.getUTCMilliseconds();s!==0&&(s=("00"+s).slice(-3),s=s.replace(/0+$/g,""),n+="."+s)}return n+="Z",n}function Ka(e){return e.match(/^[0-9]{12}Z$/)||e.match(/^[0-9]{12}[.][0-9]*Z$/)?e.match(/^[0-4]/)?"20"+e:"19"+e:e}function Hn(e){return e.replace(/%/g,"")}function jn(e){return e.replace(/(..)/g,"%$1")}function Oi(e){var t="malformed IPv6 address";if(!e.match(/^[0-9A-Fa-f:]+$/))throw t;e=e.toLowerCase();var r=e.split(":").length-1;if(r<2)throw t;var n=":".repeat(7-r+2);e=e.replace("::",n);var i=e.split(":");if(i.length!=8)throw t;for(var s=0;s<8;s++)i[s]=("0000"+i[s]).slice(-4);return i.join("")}function Hi(e){if(!e.match(/^[0-9A-Fa-f]{32}$/))throw new Error("malformed IPv6 address: "+e);e=e.toLowerCase();var t=e.match(/.{1,4}/g);t=t.map(function(i){return i.replace(/^0+/,"")}),t=t.map(function(i){return i==""?"0":i}),e=":"+t.join(":")+":";var r=e.match(/:(0:){2,}/g);if(r==null)return e.slice(1,-1);var n=r.sort().slice(-1)[0];return e=e.replace(n.substr(0,n.length-1),":"),e.substr(0,2)!="::"&&(e=e.substr(1)),e.substr(-2,2)!="::"&&(e=e.substr(0,e.length-1)),e}function In(e){var t=new Error("malformed hex value");if(!e.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw t;if(e.length==8){var r;try{return r=parseInt(e.substr(0,2),16)+"."+parseInt(e.substr(2,2),16)+"."+parseInt(e.substr(4,2),16)+"."+parseInt(e.substr(6,2),16),r}catch{throw t}}else if(e.length==16)try{return In(e.substr(0,8))+"/"+Ca(e.substr(8))}catch{throw t}else{if(e.length==32)return Hi(e);if(e.length==64){try{return Hi(e.substr(0,32))+"/"+Ca(e.substr(32))}catch{throw t}return}else return e}}function Ca(e){var t=new Error("malformed mask"),r;try{r=new B(e,16).toString(2)}catch{throw t}if(!r.match(/^1*0*$/))throw t;return r.replace(/0+$/,"").length}function Ui(e){var t=new Error("malformed IP address");if(e=e.toLowerCase(e),!e.match(/^[0-9a-f.:/]+$/))throw t;if(e.match(/^[0-9.]+$/)){var r=e.split(".");if(r.length!==4)throw t;var n="";try{for(var i=0;i<4;i++){var s=parseInt(r[i]);n+=("0"+s.toString(16)).slice(-2)}return n}catch{throw t}}else if(e.match(/^[0-9.]+\/[0-9]+$/)){var a=e.split("/");return Ui(a[0])+Ia(parseInt(a[1]),32)}else{if(e.match(/^[0-9a-f:]+$/)&&e.indexOf(":")!==-1)return Oi(e);if(e.match(/^[0-9a-f:]+\/[0-9]+$/)&&e.indexOf(":")!==-1){var a=e.split("/");return Oi(a[0])+Ia(parseInt(a[1]),128)}else throw t}}function Ia(e,t){if(t==32&&e==0)return"00000000";if(t==128&&e==0)return"00000000000000000000000000000000";var r=Array(e+1).join("1")+Array(t-e+1).join("0");return new B(r,2).toString(16)}function Gi(e){function t(i){var s=parseInt(i.substr(0,2),16),a=parseInt(i.substr(2),16);if(s==0&a<128)return String.fromCharCode(a);if(s<8){var o=192|(s&7)<<3|(a&192)>>6,f=128|a&63;return ae(o.toString(16)+f.toString(16))}var o=224|(s&240)>>4,f=128|(s&15)<<2|(a&192)>>6,d=128|a&63;return ae(o.toString(16)+f.toString(16)+d.toString(16))}var r=e.match(/.{4}/g),n=r.map(t);return n.join("")}function Mn(e){for(var t=encodeURIComponent(e),r="",n=0;n<t.length;n++)t[n]=="%"?(r=r+t.substr(n,3),n=n+2):r=r+"%"+Ge(t[n]);return r}function o1(e){return e=e.replace(/\r\n/mg,`
`),e}function u1(e){return e=e.replace(/\r\n/mg,`
`),e=e.replace(/\n/mg,`\r
`),e}u.lang.String.isInteger=function(e){return e.match(/^[0-9]+$/)?!0:!!e.match(/^-[0-9]+$/)};u.lang.String.isHex=function(e){return Va(e)};function Va(e){return!!(e.length%2==0&&(e.match(/^[0-9a-f]+$/)||e.match(/^[0-9A-F]+$/)))}u.lang.String.isBase64=function(e){return e=e.replace(/\s+/g,""),!!(e.match(/^[0-9A-Za-z+\/]+={0,3}$/)&&e.length%4==0)};u.lang.String.isBase64URL=function(e){return e.match(/[+/=]/)?!1:(e=qr(e),u.lang.String.isBase64(e))};function zi(e){return!!e.match(/^[0-9A-Za-z-_.]+$/)}u.lang.String.isIntegerArray=function(e){return e=e.replace(/\s+/g,""),!!e.match(/^\[[0-9,]+\]$/)};u.lang.String.isPrintable=function(e){return e.match(/^[0-9A-Za-z '()+,-./:=?]*$/)!==null};u.lang.String.isIA5=function(e){return e.match(/^[\x20-\x21\x23-\x7f]*$/)!==null};u.lang.String.isMail=function(e){return e.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)!==null};function ji(e){return e.length%2==1?"0"+e:e.substr(0,1)>"7"?"00"+e:e}function c1(e){e=e.replace(/^\s*\[\s*/,""),e=e.replace(/\s*\]\s*$/,""),e=e.replace(/\s*/g,"");try{var t=e.split(/,/).map(function(r,n,i){var s=parseInt(r);if(s<0||255<s)throw"integer not in range 0-255";var a=("00"+s.toString(16)).slice(-2);return a}).join("");return t}catch(r){throw"malformed integer array string: "+r}}var h1=function(e,t){var r=e.length;e.length>t.length&&(r=t.length);for(var n=0;n<r;n++)if(e.charCodeAt(n)!=t.charCodeAt(n))return n;return e.length!=t.length?r:-1};function qa(e){var t=function(o){var f=o.toString(16);return f.length==1&&(f="0"+f),f},r=function(o){var f="",d=parseInt(o,10),m=d.toString(2),p=7-m.length%7;p==7&&(p=0);for(var h="",c=0;c<p;c++)h+="0";m=h+m;for(var c=0;c<m.length-1;c+=7){var g=m.substr(c,7);c!=m.length-7&&(g="1"+g),f+=t(parseInt(g,2))}return f};try{if(!e.match(/^[0-9.]+$/))return null;var n="",i=e.split("."),s=parseInt(i[0],10)*40+parseInt(i[1],10);n+=t(s),i.splice(0,2);for(var a=0;a<i.length;a++)n+=r(i[a]);return n}catch{return null}}function Kn(e){if(!Va(e))return null;try{var t=[],r=e.substr(0,2),n=parseInt(r,16);t[0]=new String(Math.floor(n/40)),t[1]=new String(n%40);for(var i=e.substr(2),s=[],a=0;a<i.length/2;a++)s.push(parseInt(i.substr(a*2,2),16));for(var o=[],f="",a=0;a<s.length;a++)s[a]&128?f=f+Dn((s[a]&127).toString(2),7):(f=f+Dn((s[a]&127).toString(2),7),o.push(new String(parseInt(f,2))),f="");var d=t.join(".");return o.length>0&&(d=d+"."+o.join(".")),d}catch{return null}}function La(e){var t=new B(String(e),10);return Lr(t)}function Lr(e){var t=e.toString(16);if(t.substr(0,1)!="-")return t.length%2==1?t="0"+t:t.match(/^[0-7]/)||(t="00"+t),t;var r=t.substr(1),n=r.length;n%2==1?n+=1:t.match(/^[0-7]/)||(n+=2);for(var i="",s=0;s<n;s++)i+="f";var a=new B(i,16),o=a.xor(e).add(B.ONE);return t=o.toString(16).replace(/^-/,""),t}var Dn=function(e,t,r){return r==null&&(r="0"),e.length>=t?e:new Array(t-e.length+1).join(r)+e};function ka(e){if(e.length%2!=0||(e=e.toLowerCase(),e.match(/^[0-9a-f]+$/)==null))return-1;try{var t=e.substr(0,2);if(t=="00")return parseInt(e.substr(2),16);var r=parseInt(t,16);if(r>7)return-1;var n=e.substr(2),i=parseInt(n,16).toString(2);i=="0"&&(i="00000000"),i=i.slice(0,0-r);var s=parseInt(i,2);return s==NaN?-1:s}catch{return-1}}function Ua(e){if(typeof e!="number"||e<0)return null;var t=Number(e).toString(2),r=8-t.length%8;r==8&&(r=0),t=t+Dn("",r,"0");var n=parseInt(t,2).toString(16);n.length%2==1&&(n="0"+n);var i="0"+r;return i+n}function Ga(e){if(typeof e!="string"||e.length%2!=0||!e.match(/^[0-9a-f]+$/))return null;try{var t=parseInt(e.substr(0,2),16);if(t<0||7<t)return null;for(var r=e.substr(2),n="",i=0;i<r.length;i+=2){var s=r.substr(i,2),a=parseInt(s,16).toString(2);a=("0000000"+a).slice(-8),n+=a}return n.substr(0,n.length-t)}catch{return null}}function f1(e){if(typeof e!="string"||e.match(/^[01]+$/)==null)return null;try{var t=parseInt(e,2);return Ua(t)}catch{return null}}function Rn(e,t){for(var r=0,n=0;n<e.length;n++)r|=1<<t[e[n]];for(var i=r.toString(2),s="",n=i.length-1;n>=0;n--)s+=i[n];return s}function he(e,n,r){if(typeof e=="object"){for(var n=String(n).split("."),i=0;i<n.length&&e;i++){var s=n[i];s.match(/^[0-9]+$/)&&(s=parseInt(s)),e=e[s]}return e||e===!1?e:r}}function H(e,t){var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.superclass=t.prototype,t.prototype.constructor==Object.prototype.constructor&&(t.prototype.constructor=t)}(typeof u>"u"||!u)&&(u={});(typeof u.crypto>"u"||!u.crypto)&&(u.crypto={});u.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:q.algo.MD5,sha1:q.algo.SHA1,sha224:q.algo.SHA224,sha256:q.algo.SHA256,sha384:q.algo.SHA384,sha512:q.algo.SHA512,ripemd160:q.algo.RIPEMD160},this.getDigestInfoHex=function(e,t){if(typeof this.DIGESTINFOHEAD[t]>"u")throw"alg not supported in Util.DIGESTINFOHEAD: "+t;return this.DIGESTINFOHEAD[t]+e},this.getPaddedDigestInfoHex=function(e,t,r){var n=this.getDigestInfoHex(e,t),i=r/4;if(n.length+22>i)throw"key is too short for SigAlg: keylen="+r+","+t;for(var s="0001",a="00"+n,o="",f=i-s.length-a.length,d=0;d<f;d+=2)o+="ff";var m=s+o+a;return m},this.hashString=function(e,t){var r=new u.crypto.MessageDigest({alg:t});return r.digestString(e)},this.hashHex=function(e,t){var r=new u.crypto.MessageDigest({alg:t});return r.digestHex(e)},this.sha1=function(e){return this.hashString(e,"sha1")},this.sha256=function(e){return this.hashString(e,"sha256")},this.sha256Hex=function(e){return this.hashHex(e,"sha256")},this.sha512=function(e){return this.hashString(e,"sha512")},this.sha512Hex=function(e){return this.hashHex(e,"sha512")},this.isKey=function(e){return e instanceof W||e instanceof u.crypto.DSA||e instanceof u.crypto.ECDSA}};u.crypto.Util.md5=function(e){var t=new u.crypto.MessageDigest({alg:"md5",prov:"cryptojs"});return t.digestString(e)};u.crypto.Util.ripemd160=function(e){var t=new u.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"});return t.digestString(e)};u.crypto.Util.SECURERANDOMGEN=new Kt;u.crypto.Util.getRandomHexOfNbytes=function(e){var t=new Array(e);return u.crypto.Util.SECURERANDOMGEN.nextBytes(t),Nn(t)};u.crypto.Util.getRandomBigIntegerOfNbytes=function(e){return new B(u.crypto.Util.getRandomHexOfNbytes(e),16)};u.crypto.Util.getRandomHexOfNbits=function(e){var t=e%8,r=(e-t)/8,n=new Array(r+1);return u.crypto.Util.SECURERANDOMGEN.nextBytes(n),n[0]=(255<<t&255^255)&n[0],Nn(n)};u.crypto.Util.getRandomBigIntegerOfNbits=function(e){return new B(u.crypto.Util.getRandomHexOfNbits(e),16)};u.crypto.Util.getRandomBigIntegerZeroToMax=function(e){for(var t=e.bitLength();;){var r=u.crypto.Util.getRandomBigIntegerOfNbits(t);if(e.compareTo(r)!=-1)return r}};u.crypto.Util.getRandomBigIntegerMinToMax=function(e,t){var r=e.compareTo(t);if(r==1)throw"biMin is greater than biMax";if(r==0)return e;var n=t.subtract(e),i=u.crypto.Util.getRandomBigIntegerZeroToMax(n);return i.add(e)};u.crypto.MessageDigest=function(e){var t=null,r=null,n=null;this.setAlgAndProvider=function(i,s){if(i=u.crypto.MessageDigest.getCanonicalAlgName(i),i!==null&&s===void 0&&(s=u.crypto.Util.DEFAULTPROVIDER[i]),":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(i)!=-1&&s=="cryptojs"){try{this.md=u.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[i].create()}catch(a){throw"setAlgAndProvider hash alg set fail alg="+i+"/"+a}this.updateString=function(a){this.md.update(a)},this.updateHex=function(a){var o=q.enc.Hex.parse(a);this.md.update(o)},this.digest=function(){var a=this.md.finalize();return a.toString(q.enc.Hex)},this.digestString=function(a){return this.updateString(a),this.digest()},this.digestHex=function(a){return this.updateHex(a),this.digest()}}if(":sha256:".indexOf(i)!=-1&&s=="sjcl"){try{this.md=new sjcl.hash.sha256}catch(a){throw"setAlgAndProvider hash alg set fail alg="+i+"/"+a}this.updateString=function(a){this.md.update(a)},this.updateHex=function(a){var o=sjcl.codec.hex.toBits(a);this.md.update(o)},this.digest=function(){var a=this.md.finalize();return sjcl.codec.hex.fromBits(a)},this.digestString=function(a){return this.updateString(a),this.digest()},this.digestHex=function(a){return this.updateHex(a),this.digest()}}},this.updateString=function(i){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(i){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(i){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(i){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},e!==void 0&&e.alg!==void 0&&(this.algName=e.alg,e.prov===void 0&&(this.provName=u.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))};u.crypto.MessageDigest.getCanonicalAlgName=function(e){return typeof e=="string"&&(e=e.toLowerCase(),e=e.replace(/-/,"")),e};u.crypto.MessageDigest.getHashLength=function(e){var t=u.crypto.MessageDigest,r=t.getCanonicalAlgName(e);if(t.HASHLENGTH[r]===void 0)throw"not supported algorithm: "+e;return t.HASHLENGTH[r]};u.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20};u.crypto.Mac=function(e){var t=null,r=null,n=null,i=null,s=null;this.setAlgAndProvider=function(a,o){if(a=a.toLowerCase(),a==null&&(a="hmacsha1"),a=a.toLowerCase(),a.substr(0,4)!="hmac")throw"setAlgAndProvider unsupported HMAC alg: "+a;o===void 0&&(o=u.crypto.Util.DEFAULTPROVIDER[a]),this.algProv=a+"/"+o;var f=a.substr(4);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(f)!=-1&&o=="cryptojs"){try{var d=u.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[f];this.mac=q.algo.HMAC.create(d,this.pass)}catch(m){throw"setAlgAndProvider hash alg set fail hashAlg="+f+"/"+m}this.updateString=function(m){this.mac.update(m)},this.updateHex=function(m){var p=q.enc.Hex.parse(m);this.mac.update(p)},this.doFinal=function(){var m=this.mac.finalize();return m.toString(q.enc.Hex)},this.doFinalString=function(m){return this.updateString(m),this.doFinal()},this.doFinalHex=function(m){return this.updateHex(m),this.doFinal()}}},this.updateString=function(a){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(a){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(a){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(a){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(a){if(typeof a=="string"){var o=a;(a.length%2==1||!a.match(/^[0-9A-Fa-f]+$/))&&(o=et(a)),this.pass=q.enc.Hex.parse(o);return}if(typeof a!="object")throw"KJUR.crypto.Mac unsupported password type: "+a;var o=null;if(a.hex!==void 0){if(a.hex.length%2!=0||!a.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+a.hex;o=a.hex}if(a.utf8!==void 0&&(o=Tn(a.utf8)),a.rstr!==void 0&&(o=et(a.rstr)),a.b64!==void 0&&(o=dr(a.b64)),a.b64u!==void 0&&(o=ge(a.b64u)),o==null)throw"KJUR.crypto.Mac unsupported password type: "+a;this.pass=q.enc.Hex.parse(o)},e!==void 0&&(e.pass!==void 0&&this.setPassword(e.pass),e.alg!==void 0&&(this.algName=e.alg,e.prov===void 0&&(this.provName=u.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))};u.crypto.Signature=function(e){var t=null,r=null,n=null,i=null,s=null,a=null,o=null,f=null,d=null,m=null,p=-1,h=null,c=null,g=null,l=null,v=null;if(this._setAlgNames=function(){var y=this.algName.match(/^(.+)with(.+)$/);y&&(this.mdAlgName=y[1].toLowerCase(),this.pubkeyAlgName=y[2].toLowerCase(),this.pubkeyAlgName=="rsaandmgf1"&&this.mdAlgName=="sha"&&(this.mdAlgName="sha1"))},this._zeroPaddingOfSignature=function(y,x){for(var E="",P=x/4-y.length,b=0;b<P;b++)E=E+"0";return E+y},this.setAlgAndProvider=function(y,x){if(this._setAlgNames(),x!="cryptojs/jsrsa")throw new Error("provider not supported: "+x);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)!=-1){try{this.md=new u.crypto.MessageDigest({alg:this.mdAlgName})}catch(E){throw new Error("setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+E)}this.init=function(E,P){var b=null;try{P===void 0?b=Z.getKey(E):b=Z.getKey(E,P)}catch(R){throw"init failed:"+R}if(b.isPrivate===!0)this.prvKey=b,this.state="SIGN";else if(b.isPublic===!0)this.pubKey=b,this.state="VERIFY";else throw"init failed.:"+b},this.updateString=function(E){this.md.updateString(E)},this.updateHex=function(E){this.md.updateHex(E)},this.sign=function(){if(this.sHashHex=this.md.digest(),this.prvKey===void 0&&this.ecprvhex!==void 0&&this.eccurvename!==void 0&&u.crypto.ECDSA!==void 0&&(this.prvKey=new u.crypto.ECDSA({curve:this.eccurvename,prv:this.ecprvhex})),this.prvKey instanceof W&&this.pubkeyAlgName==="rsaandmgf1")this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof W&&this.pubkeyAlgName==="rsa")this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof u.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else if(this.prvKey instanceof u.crypto.DSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;return this.hSign},this.signString=function(E){return this.updateString(E),this.sign()},this.signHex=function(E){return this.updateHex(E),this.sign()},this.verify=function(E){if(this.sHashHex=this.md.digest(),this.pubKey===void 0&&this.ecpubhex!==void 0&&this.eccurvename!==void 0&&u.crypto.ECDSA!==void 0&&(this.pubKey=new u.crypto.ECDSA({curve:this.eccurvename,pub:this.ecpubhex})),this.pubKey instanceof W&&this.pubkeyAlgName==="rsaandmgf1")return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,E,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof W&&this.pubkeyAlgName==="rsa")return this.pubKey.verifyWithMessageHash(this.sHashHex,E);if(u.crypto.ECDSA!==void 0&&this.pubKey instanceof u.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,E);if(u.crypto.DSA!==void 0&&this.pubKey instanceof u.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,E);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(y,x){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(y){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(y){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(y){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(y){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(y){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=e,e!==void 0&&(e.alg!==void 0&&(this.algName=e.alg,e.prov===void 0?this.provName=u.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=e.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),e.psssaltlen!==void 0&&(this.pssSaltLen=e.psssaltlen),e.prvkeypem!==void 0)){if(e.prvkeypas!==void 0)throw"both prvkeypem and prvkeypas parameters not supported";try{var t=Z.getKey(e.prvkeypem);this.init(t)}catch(y){throw"fatal error to load pem private key: "+y}}};u.crypto.Cipher=function(e){};u.crypto.Cipher.encrypt=function(e,t,r,n){if(he(n,"enclag")!=null&&(r=n.encalg),typeof r=="string"&&r.substr(-4)=="-CBC"){var i=t,s=e;he(n,"key")!=null&&(i=n.key),he(n,"enc")!=null&&(hEnc=n.enc);var a=q.enc.Hex.parse(i),o=q.enc.Hex.parse(s),f=q.enc.Hex.parse(n.iv),d;if(r=="des-EDE3-CBC")d=q.TripleDES.encrypt(o,a,{iv:f});else if(r=="aes128-CBC"||r=="aes256-CBC")d=q.AES.encrypt(o,a,{iv:f});else throw new Error("unsupported algorithm: "+r);return d+""}else if(t instanceof W&&t.isPublic){var m=u.crypto.Cipher.getAlgByKeyAndName(t,r);if(m==="RSA")return t.encrypt(e);if(m==="RSAOAEP")return t.encryptOAEP(e,"sha1");var p=m.match(/^RSAOAEP(\d+)$/);if(p!==null)return t.encryptOAEP(e,"sha"+p[1]);throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+r}else throw"Cipher.encrypt: unsupported key or algorithm"};u.crypto.Cipher.decrypt=function(e,t,r,n){if(he(n,"enclag")!=null&&(r=n.encalg),typeof r=="string"&&r.substr(-4)=="-CBC"){var i=t,s=e;he(n,"key")!=null&&(i=n.key),he(n,"enc")!=null&&(s=n.enc);var a=q.enc.Hex.parse(i),o=q.enc.Hex.parse(s),f=q.enc.Hex.parse(n.iv),d;if(r=="des-EDE3-CBC")d=q.TripleDES.decrypt({ciphertext:o},a,{iv:f});else if(r=="aes128-CBC"||r=="aes256-CBC")d=q.AES.decrypt({ciphertext:o},a,{iv:f});else throw new Error("unsupported algorithm: "+r);return q.enc.Hex.stringify(d)}else if(t instanceof W&&t.isPrivate){var m=u.crypto.Cipher.getAlgByKeyAndName(t,r);if(m==="RSA")return t.decrypt(e);if(m==="RSAOAEP")return t.decryptOAEP(e,"sha1");var p=m.match(/^RSAOAEP(\d+)$/);if(p!==null)return t.decryptOAEP(e,"sha"+p[1]);throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+r}else throw"Cipher.decrypt: unsupported key or algorithm"};u.crypto.Cipher.getAlgByKeyAndName=function(e,t){if(e instanceof W){if(":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(t)!=-1)return t;if(t==null)return"RSA";throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+t}throw"getAlgByKeyAndName: not supported algorithm name: "+t};u.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040022":"secp384r1","2b81040023":"secp521r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}};(typeof u>"u"||!u)&&(u={});(typeof u.crypto>"u"||!u.crypto)&&(u.crypto={});u.crypto.ECDSA=function(e){var t="secp256r1",r=null,n=null,i=null,s=Error,a=B,o=ne,f=u.crypto.ECDSA,d=u.crypto.ECParameterDB,m=f.getName,p=K,h=p.getVbyListEx,c=p.isASN1HEX,g=new Kt,l=null;this.type="EC",this.isPrivate=!1,this.isPublic=!1;function v(y,x,E,P){for(var b=Math.max(x.bitLength(),P.bitLength()),R=y.add2D(E),T=y.curve.getInfinity(),S=b-1;S>=0;--S)T=T.twice2D(),T.z=a.ONE,x.testBit(S)?P.testBit(S)?T=T.add2D(R):T=T.add2D(y):P.testBit(S)&&(T=T.add2D(E));return T}this.getBigRandom=function(y){return new a(y.bitLength(),g).mod(y.subtract(a.ONE)).add(a.ONE)},this.setNamedCurve=function(y){this.ecparams=d.getByName(y),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=y},this.setPrivateKeyHex=function(y){this.isPrivate=!0,this.prvKeyHex=y},this.setPublicKeyHex=function(y){this.isPublic=!0,this.pubKeyHex=y},this.getPublicKeyXYHex=function(){var y=this.pubKeyHex;if(y.substr(0,2)!=="04")throw"this method supports uncompressed format(04) only";var x=this.ecparams.keycharlen;if(y.length!==2+x*2)throw"malformed public key hex length";var E={};return E.x=y.substr(2,x),E.y=y.substr(2+x),E},this.getShortNISTPCurveName=function(){var y=this.curveName;return y==="secp256r1"||y==="NIST P-256"||y==="P-256"||y==="prime256v1"?"P-256":y==="secp384r1"||y==="NIST P-384"||y==="P-384"?"P-384":y==="secp521r1"||y==="NIST P-521"||y==="P-521"?"P-521":null},this.generateKeyPairHex=function(){var y=this.ecparams.n,x=this.getBigRandom(y),E=this.ecparams.keycharlen,P=("0000000000"+x.toString(16)).slice(-E);this.setPrivateKeyHex(P);var b=this.generatePublicKeyHex();return{ecprvhex:P,ecpubhex:b}},this.generatePublicKeyHex=function(){var y=new a(this.prvKeyHex,16),x=this.ecparams.G.multiply(y),E=x.getX().toBigInteger(),P=x.getY().toBigInteger(),b=this.ecparams.keycharlen,R=("0000000000"+E.toString(16)).slice(-b),T=("0000000000"+P.toString(16)).slice(-b),S="04"+R+T;return this.setPublicKeyHex(S),S},this.signWithMessageHash=function(y){return this.signHex(y,this.prvKeyHex)},this.signHex=function(y,x){var E=new a(x,16),P=this.ecparams.n,b=new a(y.substring(0,this.ecparams.keycharlen),16);do var R=this.getBigRandom(P),T=this.ecparams.G,S=T.multiply(R),w=S.getX().toBigInteger().mod(P);while(w.compareTo(a.ZERO)<=0);var A=R.modInverse(P).multiply(b.add(E.multiply(w))).mod(P);return f.biRSSigToASN1Sig(w,A)},this.sign=function(y,x){var E=x,P=this.ecparams.n,b=a.fromByteArrayUnsigned(y);do var R=this.getBigRandom(P),T=this.ecparams.G,S=T.multiply(R),w=S.getX().toBigInteger().mod(P);while(w.compareTo(B.ZERO)<=0);var A=R.modInverse(P).multiply(b.add(E.multiply(w))).mod(P);return this.serializeSig(w,A)},this.verifyWithMessageHash=function(y,x){return this.verifyHex(y,x,this.pubKeyHex)},this.verifyHex=function(y,x,E){try{var P,b,R=f.parseSigHex(x);P=R.r,b=R.s;var T=o.decodeFromHex(this.ecparams.curve,E),S=new a(y.substring(0,this.ecparams.keycharlen),16);return this.verifyRaw(S,P,b,T)}catch{return!1}},this.verify=function(y,x,E){var P,b;if(Bitcoin.Util.isArray(x)){var R=this.parseSig(x);P=R.r,b=R.s}else if(typeof x=="object"&&x.r&&x.s)P=x.r,b=x.s;else throw"Invalid value for signature";var T;if(E instanceof ne)T=E;else if(Bitcoin.Util.isArray(E))T=o.decodeFrom(this.ecparams.curve,E);else throw"Invalid format for pubkey value, must be byte array or ECPointFp";var S=a.fromByteArrayUnsigned(y);return this.verifyRaw(S,P,b,T)},this.verifyRaw=function(y,x,E,P){var b=this.ecparams.n,R=this.ecparams.G;if(x.compareTo(a.ONE)<0||x.compareTo(b)>=0||E.compareTo(a.ONE)<0||E.compareTo(b)>=0)return!1;var T=E.modInverse(b),S=y.multiply(T).mod(b),w=x.multiply(T).mod(b),A=R.multiply(S).add(P.multiply(w)),F=A.getX().toBigInteger().mod(b);return F.equals(x)},this.serializeSig=function(y,x){var E=y.toByteArraySigned(),P=x.toByteArraySigned(),b=[];return b.push(2),b.push(E.length),b=b.concat(E),b.push(2),b.push(P.length),b=b.concat(P),b.unshift(b.length),b.unshift(48),b},this.parseSig=function(y){var x;if(y[0]!=48)throw new Error("Signature not a valid DERSequence");if(x=2,y[x]!=2)throw new Error("First element in signature must be a DERInteger");var E=y.slice(x+2,x+2+y[x+1]);if(x+=2+y[x+1],y[x]!=2)throw new Error("Second element in signature must be a DERInteger");var P=y.slice(x+2,x+2+y[x+1]);x+=2+y[x+1];var b=a.fromByteArrayUnsigned(E),R=a.fromByteArrayUnsigned(P);return{r:b,s:R}},this.parseSigCompact=function(y){if(y.length!==65)throw"Signature has the wrong length";var x=y[0]-27;if(x<0||x>7)throw"Invalid signature type";var E=this.ecparams.n,P=a.fromByteArrayUnsigned(y.slice(1,33)).mod(E),b=a.fromByteArrayUnsigned(y.slice(33,65)).mod(E);return{r:P,s:b,i:x}},this.readPKCS5PrvKeyHex=function(y){if(c(y)===!1)throw new Error("not ASN.1 hex string");var x,E,P;try{x=h(y,0,["[0]",0],"06"),E=h(y,0,[1],"04");try{P=h(y,0,["[1]",0],"03")}catch{}}catch{throw new Error("malformed PKCS#1/5 plain ECC private key")}if(this.curveName=m(x),this.curveName===void 0)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(P),this.setPrivateKeyHex(E),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(y){if(c(y)===!1)throw new s("not ASN.1 hex string");var x,E,P,b;try{x=h(y,0,[1,0],"06"),E=h(y,0,[1,1],"06"),P=h(y,0,[2,0,1],"04");try{b=h(y,0,[2,0,"[1]",0],"03")}catch{}}catch{throw new s("malformed PKCS#8 plain ECC private key")}if(this.curveName=m(E),this.curveName===void 0)throw new s("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(b),this.setPrivateKeyHex(P),this.isPublic=!1},this.readPKCS8PubKeyHex=function(y){if(c(y)===!1)throw new s("not ASN.1 hex string");var x,E,P;try{x=h(y,0,[0,0],"06"),E=h(y,0,[0,1],"06"),P=h(y,0,[1],"03")}catch{throw new s("malformed PKCS#8 ECC public key")}if(this.curveName=m(E),this.curveName===null)throw new s("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(P)},this.readCertPubKeyHex=function(y,x){if(c(y)===!1)throw new s("not ASN.1 hex string");var E,P;try{E=h(y,0,[0,5,0,1],"06"),P=h(y,0,[0,5,1],"03")}catch{throw new s("malformed X.509 certificate ECC public key")}if(this.curveName=m(E),this.curveName===null)throw new s("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(P)},e!==void 0&&e.curve!==void 0&&(this.curveName=e.curve),this.curveName===void 0&&(this.curveName=t),this.setNamedCurve(this.curveName),e!==void 0&&(e.prv!==void 0&&this.setPrivateKeyHex(e.prv),e.pub!==void 0&&this.setPublicKeyHex(e.pub))};u.crypto.ECDSA.parseSigHex=function(e){var t=u.crypto.ECDSA.parseSigHexInHexRS(e),r=new B(t.r,16),n=new B(t.s,16);return{r,s:n}};u.crypto.ECDSA.parseSigHexInHexRS=function(e){var t=K,r=t.getChildIdx,n=t.getV;if(t.checkStrictDER(e,0),e.substr(0,2)!="30")throw new Error("signature is not a ASN.1 sequence");var i=r(e,0);if(i.length!=2)throw new Error("signature shall have two elements");var s=i[0],a=i[1];if(e.substr(s,2)!="02")throw new Error("1st item not ASN.1 integer");if(e.substr(a,2)!="02")throw new Error("2nd item not ASN.1 integer");var o=n(e,s),f=n(e,a);return{r:o,s:f}};u.crypto.ECDSA.asn1SigToConcatSig=function(e){var t=u.crypto.ECDSA.parseSigHexInHexRS(e),r=t.r,n=t.s;if(r.length>=130&&r.length<=134){if(r.length%2!=0)throw Error("unknown ECDSA sig r length error");if(n.length%2!=0)throw Error("unknown ECDSA sig s length error");r.substr(0,2)=="00"&&(r=r.substr(2)),n.substr(0,2)=="00"&&(n=n.substr(2));var i=Math.max(r.length,n.length);return r=("000000"+r).slice(-i),n=("000000"+n).slice(-i),r+n}if(r.substr(0,2)=="00"&&r.length%32==2&&(r=r.substr(2)),n.substr(0,2)=="00"&&n.length%32==2&&(n=n.substr(2)),r.length%32==30&&(r="00"+r),n.length%32==30&&(n="00"+n),r.length%32!=0)throw Error("unknown ECDSA sig r length error");if(n.length%32!=0)throw Error("unknown ECDSA sig s length error");return r+n};u.crypto.ECDSA.concatSigToASN1Sig=function(e){if(e.length%4!=0)throw Error("unknown ECDSA concatinated r-s sig length error");var t=e.substr(0,e.length/2),r=e.substr(e.length/2);return u.crypto.ECDSA.hexRSSigToASN1Sig(t,r)};u.crypto.ECDSA.hexRSSigToASN1Sig=function(e,t){var r=new B(e,16),n=new B(t,16);return u.crypto.ECDSA.biRSSigToASN1Sig(r,n)};u.crypto.ECDSA.biRSSigToASN1Sig=function(e,t){var r=u.asn1,n=new r.DERInteger({bigint:e}),i=new r.DERInteger({bigint:t}),s=new r.DERSequence({array:[n,i]});return s.tohex()};u.crypto.ECDSA.getName=function(e){return e==="2b8104001f"?"secp192k1":e==="2a8648ce3d030107"?"secp256r1":e==="2b8104000a"?"secp256k1":e==="2b81040021"?"secp224r1":e==="2b81040022"?"secp384r1":e==="2b81040023"?"secp521r1":"|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(e)!==-1?"secp256r1":"|secp256k1|".indexOf(e)!==-1?"secp256k1":"|secp224r1|NIST P-224|P-224|".indexOf(e)!==-1?"secp224r1":"|secp384r1|NIST P-384|P-384|".indexOf(e)!==-1?"secp384r1":"|secp521r1|NIST P-521|P-521|".indexOf(e)!==-1?"secp521r1":null};(typeof u>"u"||!u)&&(u={});(typeof u.crypto>"u"||!u.crypto)&&(u.crypto={});u.crypto.ECParameterDB=new function(){var e={},t={};function r(n){return new B(n,16)}this.getByName=function(n){var i=n;if(typeof t[i]<"u"&&(i=t[n]),typeof e[i]<"u")return e[i];throw"unregistered EC curve name: "+i},this.regist=function(n,i,s,a,o,f,d,m,p,h,c,g){e[n]={};var l=r(s),v=r(a),y=r(o),x=r(f),E=r(d),P=new Dt(l,v,y),b=P.decodePointHex("04"+m+p);e[n].name=n,e[n].keylen=i,e[n].keycharlen=Math.ceil(i/8)*2,e[n].curve=P,e[n].G=b,e[n].n=x,e[n].h=E,e[n].oid=c,e[n].info=g;for(var R=0;R<h.length;R++)t[h[R]]=n}};u.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field");u.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field");u.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field");u.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]);u.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]);u.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]);u.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]);u.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]);u.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]);u.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","00C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]);(typeof u>"u"||!u)&&(u={});(typeof u.crypto>"u"||!u.crypto)&&(u.crypto={});u.crypto.DSA=function(){var e=K,t=e.getVbyList,r=e.getVbyListEx,n=e.isASN1HEX,i=B;this.p=null,this.q=null,this.g=null,this.y=null,this.x=null,this.type="DSA",this.isPrivate=!1,this.isPublic=!1,this.setPrivate=function(s,a,o,f,d){this.isPrivate=!0,this.p=s,this.q=a,this.g=o,this.y=f,this.x=d},this.setPrivateHex=function(s,a,o,f,d){var m,p,h,c,g;m=new B(s,16),p=new B(a,16),h=new B(o,16),typeof f=="string"&&f.length>1?c=new B(f,16):c=null,g=new B(d,16),this.setPrivate(m,p,h,c,g)},this.setPublic=function(s,a,o,f){this.isPublic=!0,this.p=s,this.q=a,this.g=o,this.y=f,this.x=null},this.setPublicHex=function(s,a,o,f){var d,m,p,h;d=new B(s,16),m=new B(a,16),p=new B(o,16),h=new B(f,16),this.setPublic(d,m,p,h)},this.signWithMessageHash=function(s){var a=this.p,o=this.q,f=this.g,d=this.y,m=this.x,p=u.crypto.Util.getRandomBigIntegerMinToMax(B.ONE.add(B.ONE),o.subtract(B.ONE)),h=s.substr(0,o.bitLength()/4),c=new B(h,16),g=f.modPow(p,a).mod(o),l=p.modInverse(o).multiply(c.add(m.multiply(g))).mod(o),v=u.asn1.ASN1Util.jsonToASN1HEX({seq:[{int:{bigint:g}},{int:{bigint:l}}]});return v},this.verifyWithMessageHash=function(s,a){var o=this.p,f=this.q,d=this.g,m=this.y,p=this.parseASN1Signature(a),h=p[0],c=p[1],g=s.substr(0,f.bitLength()/4),l=new B(g,16);if(B.ZERO.compareTo(h)>0||h.compareTo(f)>0||B.ZERO.compareTo(c)>=0||c.compareTo(f)>0)throw"invalid DSA signature";var v=c.modInverse(f),y=l.multiply(v).mod(f),x=h.multiply(v).mod(f),E=d.modPow(y,o).multiply(m.modPow(x,o)).mod(o).mod(f);return E.compareTo(h)==0},this.parseASN1Signature=function(s){try{var a=new i(r(s,0,[0],"02"),16),o=new i(r(s,0,[1],"02"),16);return[a,o]}catch{throw new Error("malformed ASN.1 DSA signature")}},this.readPKCS5PrvKeyHex=function(s){var a,o,f,d,m;if(n(s)===!1)throw new Error("not ASN.1 hex string");try{a=r(s,0,[1],"02"),o=r(s,0,[2],"02"),f=r(s,0,[3],"02"),d=r(s,0,[4],"02"),m=r(s,0,[5],"02")}catch{throw new Error("malformed PKCS#1/5 plain DSA private key")}this.setPrivateHex(a,o,f,d,m)},this.readPKCS8PrvKeyHex=function(s){var a,o,f,d;if(n(s)===!1)throw new Error("not ASN.1 hex string");try{a=r(s,0,[1,1,0],"02"),o=r(s,0,[1,1,1],"02"),f=r(s,0,[1,1,2],"02"),d=r(s,0,[2,0],"02")}catch{throw new Error("malformed PKCS#8 plain DSA private key")}this.setPrivateHex(a,o,f,null,d)},this.readPKCS8PubKeyHex=function(s){var a,o,f,d;if(n(s)===!1)throw new Error("not ASN.1 hex string");try{a=r(s,0,[0,1,0],"02"),o=r(s,0,[0,1,1],"02"),f=r(s,0,[0,1,2],"02"),d=r(s,0,[1,0],"02")}catch{throw new Error("malformed PKCS#8 DSA public key")}this.setPublicHex(a,o,f,d)},this.readCertPubKeyHex=function(s,a){var o,f,d,m;if(n(s)===!1)throw new Error("not ASN.1 hex string");try{o=r(s,0,[0,5,0,1,0],"02"),f=r(s,0,[0,5,0,1,1],"02"),d=r(s,0,[0,5,0,1,2],"02"),m=r(s,0,[0,5,1,0],"02")}catch{throw new Error("malformed X.509 certificate DSA public key")}this.setPublicHex(o,f,d,m)}};var Z=function(){var e=function(l,v,y){return n(q.AES,l,v,y)},t=function(l,v,y){return n(q.TripleDES,l,v,y)},r=function(l,v,y){return n(q.DES,l,v,y)},n=function(l,v,y,x){var E=q.enc.Hex.parse(v),P=q.enc.Hex.parse(y),b=q.enc.Hex.parse(x),R={};R.key=P,R.iv=b,R.ciphertext=E;var T=l.decrypt(R,P,{iv:b});return q.enc.Hex.stringify(T)},i=function(l,v,y){return o(q.AES,l,v,y)},s=function(l,v,y){return o(q.TripleDES,l,v,y)},a=function(l,v,y){return o(q.DES,l,v,y)},o=function(l,v,y,x){var E=q.enc.Hex.parse(v),P=q.enc.Hex.parse(y),b=q.enc.Hex.parse(x),R=l.encrypt(E,P,{iv:b}),T=q.enc.Hex.parse(R.toString()),S=q.enc.Base64.stringify(T);return S},f={"AES-256-CBC":{proc:e,eproc:i,keylen:32,ivlen:16},"AES-192-CBC":{proc:e,eproc:i,keylen:24,ivlen:16},"AES-128-CBC":{proc:e,eproc:i,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:t,eproc:s,keylen:24,ivlen:8},"DES-CBC":{proc:r,eproc:a,keylen:8,ivlen:8}},d=function(l){return f[l].proc},m=function(l){var v=q.lib.WordArray.random(l),y=q.enc.Hex.stringify(v);return y},p=function(l){var v={},y=l.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));y&&(v.cipher=y[1],v.ivsalt=y[2]);var x=l.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));x&&(v.type=x[1]);var E=-1,P=0;l.indexOf(`\r
\r
`)!=-1&&(E=l.indexOf(`\r
\r
`),P=2),l.indexOf(`

`)!=-1&&(E=l.indexOf(`

`),P=1);var b=l.indexOf("-----END");if(E!=-1&&b!=-1){var R=l.substring(E+P*2,b-P);R=R.replace(/\s+/g,""),v.data=R}return v},h=function(l,v,y){for(var x=y.substring(0,16),E=q.enc.Hex.parse(x),P=q.enc.Utf8.parse(v),b=f[l].keylen+f[l].ivlen,R="",T=null;;){var S=q.algo.MD5.create();if(T!=null&&S.update(T),S.update(P),S.update(E),T=S.finalize(),R=R+q.enc.Hex.stringify(T),R.length>=b*2)break}var w={};return w.keyhex=R.substr(0,f[l].keylen*2),w.ivhex=R.substr(f[l].keylen*2,f[l].ivlen*2),w},c=function(l,v,y,x){var E=q.enc.Base64.parse(l),P=q.enc.Hex.stringify(E),b=f[v].proc,R=b(P,y,x);return R},g=function(l,v,y,x){var E=f[v].eproc,P=E(l,y,x);return P};return{version:"1.0.0",parsePKCS5PEM:function(l){return p(l)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(l,v,y){return h(l,v,y)},decryptKeyB64:function(l,v,y,x){return c(l,v,y,x)},getDecryptedKeyHex:function(l,v){var y=p(l),x=y.type,E=y.cipher,P=y.ivsalt,b=y.data,R=h(E,v,P),T=R.keyhex,S=c(b,E,T,P);return S},getEncryptedPKCS5PEMFromPrvKeyHex:function(l,v,y,x,E){var A="";if((typeof x>"u"||x==null)&&(x="AES-256-CBC"),typeof f[x]>"u")throw new Error("KEYUTIL unsupported algorithm: "+x);if(typeof E>"u"||E==null){var P=f[x].ivlen,b=m(P);E=b.toUpperCase()}var R=h(x,y,E),T=R.keyhex,S=g(v,x,T,E),w=S.replace(/(.{64})/g,`$1\r
`),A="-----BEGIN "+l+` PRIVATE KEY-----\r
`;return A+=`Proc-Type: 4,ENCRYPTED\r
`,A+="DEK-Info: "+x+","+E+`\r
`,A+=`\r
`,A+=w,A+=`\r
-----END `+l+` PRIVATE KEY-----\r
`,A},getEncryptedPKCS8PEM:function(l,v,y){var x=this.getEncryptedPKCS8Hex(l,v,y);return Te(x,"ENCRYPTED PRIVATE KEY")},getEncryptedPKCS8Hex:function(l,v,y){var x;y==null||y==null?x={}:x=JSON.parse(JSON.stringify(y)),x.plain=l,this.initPBES2Param(x),this.encryptPBES2Param(x,v);var E=this.generatePBES2ASN1Param(x);return u.asn1.ASN1Util.newObject(E).tohex()},initPBES2Param:function(l){if(he(l,"encalg")==null&&(l.encalg="aes256-CBC"),he(l,"iter")==null&&(l.iter=2048),he(l,"prf")==null&&(l.prf="hmacWithSHA256"),he(l,"salt")==null&&(l.salt=q.enc.Hex.stringify(q.lib.WordArray.random(8))),he(l,"enciv")==null){var v;l.encalg=="des-EDE3-CBC"&&(v=8),l.encalg=="aes128-CBC"&&(v=16),l.encalg=="aes256-CBC"&&(v=16),l.enciv=q.enc.Hex.stringify(q.lib.WordArray.random(v))}},encryptPBES2Param:function(l,v){var y=Z.getDKFromPBES2Param(l,v);try{var x=u.crypto.Cipher.encrypt(l.plain,y,l.encalg,{iv:l.enciv})}catch{throw new Error("encrypt error: "+l.plain+" "+y+" "+l.encalg+" "+l.enciv)}l.enc=x},generatePBES2ASN1Param:function(l){var v={seq:[{seq:[{oid:"pkcs5PBES2"},{seq:[{seq:[{oid:"pkcs5PBKDF2"},{seq:[{octstr:{hex:l.salt}},{int:{hex:La(l.iter)}}]}]},{seq:[{oid:l.encalg},{octstr:{hex:l.enciv}}]}]}]},{octstr:{hex:l.enc}}]};return l.prf!="hmacWithSHA1"&&v.seq[0].seq[1].seq[0].seq[1].seq.push({seq:[{oid:l.prf},{null:""}]}),v},parseHexOfEncryptedPKCS8:function(l){var v=K,y=v.getChildIdx,x=v.getV,E={},P=y(l,0);if(P.length!=2)throw new Error("malformed format: SEQUENCE(0).items != 2: "+P.length);E.ciphertext=x(l,P[1]);var b=y(l,P[0]);if(b.length!=2)throw new Error("malformed format: SEQUENCE(0.0).items != 2: "+b.length);if(x(l,b[0])!="2a864886f70d01050d")throw new Error("this only supports pkcs5PBES2");var R=y(l,b[1]);if(b.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1).items != 2: "+R.length);var T=y(l,R[1]);if(T.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.1).items != 2: "+T.length);if(x(l,T[0])!="2a864886f70d0307")throw"this only supports TripleDES";E.encryptionSchemeAlg="TripleDES",E.encryptionSchemeIV=x(l,T[1]);var S=y(l,R[0]);if(S.length!=2)throw new Error("malformed format: SEQUENCE(0.0.1.0).items != 2: "+S.length);if(x(l,S[0])!="2a864886f70d01050c")throw new Error("this only supports pkcs5PBKDF2");var w=y(l,S[1]);if(w.length<2)throw new Error("malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+w.length);E.pbkdf2Salt=x(l,w[0]);var A=x(l,w[1]);try{E.pbkdf2Iter=parseInt(A,16)}catch{throw new Error("malformed format pbkdf2Iter: "+A)}return E},getPBKDF2KeyHexFromParam:function(l,v){var y=q.enc.Hex.parse(l.pbkdf2Salt),x=l.pbkdf2Iter,E=q.PBKDF2(v,y,{keySize:192/32,iterations:x}),P=q.enc.Hex.stringify(E);return P},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(l,v){var y=me(l,"ENCRYPTED PRIVATE KEY"),x=this.parseHexOfEncryptedPKCS8(y),E=Z.getPBKDF2KeyHexFromParam(x,v),P={};P.ciphertext=q.enc.Hex.parse(x.ciphertext);var b=q.enc.Hex.parse(E),R=q.enc.Hex.parse(x.encryptionSchemeIV),T=q.TripleDES.decrypt(P,b,{iv:R}),S=q.enc.Hex.stringify(T);return S},parsePBES2:function(l){var v=K.parse(l);if(he(v,"seq.0.seq.0.oid")!="pkcs5PBES2"||he(v,"seq.0.seq.1.seq.0.seq.0.oid")!="pkcs5PBKDF2")throw new Error("not pkcs5PBES2 and pkcs5PBKDF2 used");var y=he(v,"seq.0.seq.1.seq.0.seq.1.seq");if(y==null)throw new Error("PBKDF2 parameter not found");var x=he(y,"0.octstr.hex"),E=he(y,"1.int.hex"),P=he(y,"2.seq.0.oid","hmacWithSHA1"),b=-1;try{b=parseInt(E,16)}catch{throw new Error("iter not proper value")}var R=he(v,"seq.0.seq.1.seq.1.seq.0.oid"),T=he(v,"seq.0.seq.1.seq.1.seq.1.octstr.hex"),S=he(v,"seq.1.octstr.hex");if(R==null||T==null||S==null)throw new Error("encalg, enciv or enc is undefined");var w={salt:x,iter:b,prf:P,encalg:R,enciv:T,enc:S};return w},getDKFromPBES2Param:function(l,v){var y={hmacWithSHA1:q.algo.SHA1,hmacWithSHA224:q.algo.SHA224,hmacWithSHA256:q.algo.SHA256,hmacWithSHA384:q.algo.SHA384,hmacWithSHA512:q.algo.SHA512},x={"des-EDE3-CBC":192/32,"aes128-CBC":128/32,"aes256-CBC":256/32},E=y[l.prf];if(E==null)throw new Error("unsupported prf");var P=x[l.encalg];if(P==null)throw new Error("unsupported encalg");var b=q.enc.Hex.parse(l.salt),R=l.iter;try{var T=q.PBKDF2(v,b,{keySize:P,iterations:R,hasher:E});return q.enc.Hex.stringify(T)}catch(S){throw new Error("PBKDF2 error: "+S+" "+JSON.stringify(l)+" "+v)}},getPlainHexFromEncryptedPKCS8PEM:function(l,v){if(l.indexOf("BEGIN ENCRYPTED PRIVATE KEY")==-1)throw new Error("not Encrypted PKCS#8 PEM string");var y=me(l),x;try{x=Z.parsePBES2(y)}catch(P){throw new Error("malformed PBES2 format: "+P.message)}var E=Z.getDKFromPBES2Param(x,v);return u.crypto.Cipher.decrypt(x.enc,E,x.encalg,{iv:x.enciv})},getKeyFromEncryptedPKCS8PEM:function(l,v){var y=this.getPlainHexFromEncryptedPKCS8PEM(l,v),x=this.getKeyFromPlainPrivatePKCS8Hex(y);return x},parsePlainPrivatePKCS8Hex:function(l){var v=K,y=v.getChildIdx,x=v.getV,E={};if(E.algparam=null,l.substr(0,2)!="30")throw new Error("malformed plain PKCS8 private key(code:001)");var P=y(l,0);if(P.length<3)throw new Error("malformed plain PKCS8 private key(code:002)");if(l.substr(P[1],2)!="30")throw new Error("malformed PKCS8 private key(code:003)");var b=y(l,P[1]);if(b.length!=2)throw new Error("malformed PKCS8 private key(code:004)");if(l.substr(b[0],2)!="06")throw new Error("malformed PKCS8 private key(code:005)");if(E.algoid=x(l,b[0]),l.substr(b[1],2)=="06"&&(E.algparam=x(l,b[1])),l.substr(P[2],2)!="04")throw new Error("malformed PKCS8 private key(code:006)");return E.keyidx=v.getVidx(l,P[2]),E},getKeyFromPlainPrivatePKCS8PEM:function(l){var v=me(l,"PRIVATE KEY"),y=this.getKeyFromPlainPrivatePKCS8Hex(v);return y},getKeyFromPlainPrivatePKCS8Hex:function(l){var v=this.parsePlainPrivatePKCS8Hex(l),y;if(v.algoid=="2a864886f70d010101")y=new W;else if(v.algoid=="2a8648ce380401")y=new u.crypto.DSA;else if(v.algoid=="2a8648ce3d0201")y=new u.crypto.ECDSA;else throw new Error("unsupported private key algorithm");return y.readPKCS8PrvKeyHex(l),y},_getKeyFromPublicPKCS8Hex:function(l){var v,y=K.getVbyList(l,0,[0,0],"06");if(y==="2a864886f70d010101")v=new W;else if(y==="2a8648ce380401")v=new u.crypto.DSA;else if(y==="2a8648ce3d0201")v=new u.crypto.ECDSA;else throw new Error("unsupported PKCS#8 public key hex");return v.readPKCS8PubKeyHex(l),v},parsePublicRawRSAKeyHex:function(l){var v=K,y=v.getChildIdx,x=v.getV,E={};if(l.substr(0,2)!="30")throw new Error("malformed RSA key(code:001)");var P=y(l,0);if(P.length!=2)throw new Error("malformed RSA key(code:002)");if(l.substr(P[0],2)!="02")throw new Error("malformed RSA key(code:003)");if(E.n=x(l,P[0]),l.substr(P[1],2)!="02")throw new Error("malformed RSA key(code:004)");return E.e=x(l,P[1]),E},parsePublicPKCS8Hex:function(l){var v=K,y=v.getChildIdx,x=v.getV,E={};E.algparam=null;var P=y(l,0);if(P.length!=2)throw new Error("outer DERSequence shall have 2 elements: "+P.length);var b=P[0];if(l.substr(b,2)!="30")throw new Error("malformed PKCS8 public key(code:001)");var R=y(l,b);if(R.length!=2)throw new Error("malformed PKCS8 public key(code:002)");if(l.substr(R[0],2)!="06")throw new Error("malformed PKCS8 public key(code:003)");if(E.algoid=x(l,R[0]),l.substr(R[1],2)=="06"?E.algparam=x(l,R[1]):l.substr(R[1],2)=="30"&&(E.algparam={},E.algparam.p=v.getVbyList(l,R[1],[0],"02"),E.algparam.q=v.getVbyList(l,R[1],[1],"02"),E.algparam.g=v.getVbyList(l,R[1],[2],"02")),l.substr(P[1],2)!="03")throw new Error("malformed PKCS8 public key(code:004)");return E.key=x(l,P[1]).substr(2),E}}}();Z.getKey=function(e,t,r){var n=K,i=n.getChildIdx,s=n.getV,a=n.getVbyList,o=u.crypto,f=o.ECDSA,d=o.DSA,m=W,p=me,h=Z;if(typeof m<"u"&&e instanceof m||typeof f<"u"&&e instanceof f||typeof d<"u"&&e instanceof d)return e;if(e.curve!==void 0&&e.xy!==void 0&&e.d===void 0)return new f({pub:e.xy,curve:e.curve});if(e.curve!==void 0&&e.d!==void 0)return new f({prv:e.d,curve:e.curve});if(e.kty===void 0&&e.n!==void 0&&e.e!==void 0&&e.d===void 0){var c=new m;return c.setPublic(e.n,e.e),c}if(e.kty===void 0&&e.n!==void 0&&e.e!==void 0&&e.d!==void 0&&e.p!==void 0&&e.q!==void 0&&e.dp!==void 0&&e.dq!==void 0&&e.co!==void 0&&e.qi===void 0){var c=new m;return c.setPrivateEx(e.n,e.e,e.d,e.p,e.q,e.dp,e.dq,e.co),c}if(e.kty===void 0&&e.n!==void 0&&e.e!==void 0&&e.d!==void 0&&e.p===void 0){var c=new m;return c.setPrivate(e.n,e.e,e.d),c}if(e.p!==void 0&&e.q!==void 0&&e.g!==void 0&&e.y!==void 0&&e.x===void 0){var c=new d;return c.setPublic(e.p,e.q,e.g,e.y),c}if(e.p!==void 0&&e.q!==void 0&&e.g!==void 0&&e.y!==void 0&&e.x!==void 0){var c=new d;return c.setPrivate(e.p,e.q,e.g,e.y,e.x),c}if(e.kty==="RSA"&&e.n!==void 0&&e.e!==void 0&&e.d===void 0){var c=new m;return c.setPublic(ge(e.n),ge(e.e)),c}if(e.kty==="RSA"&&e.n!==void 0&&e.e!==void 0&&e.d!==void 0&&e.p!==void 0&&e.q!==void 0&&e.dp!==void 0&&e.dq!==void 0&&e.qi!==void 0){var c=new m;return c.setPrivateEx(ge(e.n),ge(e.e),ge(e.d),ge(e.p),ge(e.q),ge(e.dp),ge(e.dq),ge(e.qi)),c}if(e.kty==="RSA"&&e.n!==void 0&&e.e!==void 0&&e.d!==void 0){var c=new m;return c.setPrivate(ge(e.n),ge(e.e),ge(e.d)),c}if(e.kty==="EC"&&e.crv!==void 0&&e.x!==void 0&&e.y!==void 0&&e.d===void 0){var g=new f({curve:e.crv}),l=g.ecparams.keycharlen,v=("0000000000"+ge(e.x)).slice(-l),y=("0000000000"+ge(e.y)).slice(-l),x="04"+v+y;return g.setPublicKeyHex(x),g}if(e.kty==="EC"&&e.crv!==void 0&&e.x!==void 0&&e.y!==void 0&&e.d!==void 0){var g=new f({curve:e.crv}),l=g.ecparams.keycharlen,v=("0000000000"+ge(e.x)).slice(-l),y=("0000000000"+ge(e.y)).slice(-l),x="04"+v+y,E=("0000000000"+ge(e.d)).slice(-l);return g.setPublicKeyHex(x),g.setPrivateKeyHex(E),g}if(r==="pkcs5prv"){var P=e,n=K,b,c;if(b=i(P,0),b.length===9)c=new m,c.readPKCS5PrvKeyHex(P);else if(b.length===6)c=new d,c.readPKCS5PrvKeyHex(P);else if(b.length>2&&P.substr(b[1],2)==="04")c=new f,c.readPKCS5PrvKeyHex(P);else throw new Error("unsupported PKCS#1/5 hexadecimal key");return c}if(r==="pkcs8prv"){var c=h.getKeyFromPlainPrivatePKCS8Hex(e);return c}if(r==="pkcs8pub")return h._getKeyFromPublicPKCS8Hex(e);if(r==="x509pub")return X.getPublicKeyFromCertHex(e);if(e.indexOf("-END CERTIFICATE-",0)!=-1||e.indexOf("-END X509 CERTIFICATE-",0)!=-1||e.indexOf("-END TRUSTED CERTIFICATE-",0)!=-1)return X.getPublicKeyFromCertPEM(e);if(e.indexOf("-END PUBLIC KEY-")!=-1){var R=me(e,"PUBLIC KEY");return h._getKeyFromPublicPKCS8Hex(R)}if(e.indexOf("-END RSA PRIVATE KEY-")!=-1&&e.indexOf("4,ENCRYPTED")==-1){var T=p(e,"RSA PRIVATE KEY");return h.getKey(T,null,"pkcs5prv")}if(e.indexOf("-END DSA PRIVATE KEY-")!=-1&&e.indexOf("4,ENCRYPTED")==-1){var S=p(e,"DSA PRIVATE KEY"),w=a(S,0,[1],"02"),A=a(S,0,[2],"02"),F=a(S,0,[3],"02"),I=a(S,0,[4],"02"),N=a(S,0,[5],"02"),c=new d;return c.setPrivate(new B(w,16),new B(A,16),new B(F,16),new B(I,16),new B(N,16)),c}if(e.indexOf("-END EC PRIVATE KEY-")!=-1&&e.indexOf("4,ENCRYPTED")==-1){var T=p(e,"EC PRIVATE KEY");return h.getKey(T,null,"pkcs5prv")}if(e.indexOf("-END PRIVATE KEY-")!=-1)return h.getKeyFromPlainPrivatePKCS8PEM(e);if(e.indexOf("-END RSA PRIVATE KEY-")!=-1&&e.indexOf("4,ENCRYPTED")!=-1){var C=h.getDecryptedKeyHex(e,t),D=new W;return D.readPKCS5PrvKeyHex(C),D}if(e.indexOf("-END EC PRIVATE KEY-")!=-1&&e.indexOf("4,ENCRYPTED")!=-1){var S=h.getDecryptedKeyHex(e,t),c=a(S,0,[1],"04"),_=a(S,0,[2,0],"06"),O=a(S,0,[3,0],"03").substr(2),U="";if(u.crypto.OID.oidhex2name[_]!==void 0)U=u.crypto.OID.oidhex2name[_];else throw new Error("undefined OID(hex) in KJUR.crypto.OID: "+_);var g=new f({curve:U});return g.setPublicKeyHex(O),g.setPrivateKeyHex(c),g.isPublic=!1,g}if(e.indexOf("-END DSA PRIVATE KEY-")!=-1&&e.indexOf("4,ENCRYPTED")!=-1){var S=h.getDecryptedKeyHex(e,t),w=a(S,0,[1],"02"),A=a(S,0,[2],"02"),F=a(S,0,[3],"02"),I=a(S,0,[4],"02"),N=a(S,0,[5],"02"),c=new d;return c.setPrivate(new B(w,16),new B(A,16),new B(F,16),new B(I,16),new B(N,16)),c}if(e.indexOf("-END ENCRYPTED PRIVATE KEY-")!=-1)return h.getKeyFromEncryptedPKCS8PEM(e,t);throw new Error("not supported argument")};Z.generateKeypair=function(e,t){if(e=="RSA"){var r=t,n=new W;n.generate(r,"10001"),n.isPrivate=!0,n.isPublic=!0;var i=new W,s=n.n.toString(16),a=n.e.toString(16);i.setPublic(s,a),i.isPrivate=!1,i.isPublic=!0;var o={};return o.prvKeyObj=n,o.pubKeyObj=i,o}else if(e=="EC"){var f=t,d=new u.crypto.ECDSA({curve:f}),m=d.generateKeyPairHex(),n=new u.crypto.ECDSA({curve:f});n.setPublicKeyHex(m.ecpubhex),n.setPrivateKeyHex(m.ecprvhex),n.isPrivate=!0,n.isPublic=!1;var i=new u.crypto.ECDSA({curve:f});i.setPublicKeyHex(m.ecpubhex),i.isPrivate=!1,i.isPublic=!0;var o={};return o.prvKeyObj=n,o.pubKeyObj=i,o}else throw new Error("unknown algorithm: "+e)};Z.getPEM=function(e,t,r,n,i,s){var a=u,o=a.asn1,f=o.DERObjectIdentifier,d=o.DERInteger,m=o.ASN1Util.newObject,p=o.x509,h=p.SubjectPublicKeyInfo,c=a.crypto,g=c.DSA,l=c.ECDSA,v=W;function y(D){var _=m({seq:[{int:0},{int:{bigint:D.n}},{int:D.e},{int:{bigint:D.d}},{int:{bigint:D.p}},{int:{bigint:D.q}},{int:{bigint:D.dmp1}},{int:{bigint:D.dmq1}},{int:{bigint:D.coeff}}]});return _}function x(D){var _=m({seq:[{int:1},{octstr:{hex:D.prvKeyHex}},{tag:["a0",!0,{oid:{name:D.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+D.pubKeyHex}}]}]});return _}function E(D){var _=m({seq:[{int:0},{int:{bigint:D.p}},{int:{bigint:D.q}},{int:{bigint:D.g}},{int:{bigint:D.y}},{int:{bigint:D.x}}]});return _}if((v!==void 0&&e instanceof v||g!==void 0&&e instanceof g||l!==void 0&&e instanceof l)&&e.isPublic==!0&&(t===void 0||t=="PKCS8PUB")){var P=new h(e),b=P.tohex();return Te(b,"PUBLIC KEY")}if(t=="PKCS1PRV"&&v!==void 0&&e instanceof v&&(r===void 0||r==null)&&e.isPrivate==!0){var P=y(e),b=P.tohex();return Te(b,"RSA PRIVATE KEY")}if(t=="PKCS1PRV"&&l!==void 0&&e instanceof l&&(r===void 0||r==null)&&e.isPrivate==!0){var R=new f({name:e.curveName}),T=R.tohex(),S=x(e),w=S.tohex(),A="";return A+=Te(T,"EC PARAMETERS"),A+=Te(w,"EC PRIVATE KEY"),A}if(t=="PKCS1PRV"&&g!==void 0&&e instanceof g&&(r===void 0||r==null)&&e.isPrivate==!0){var P=E(e),b=P.tohex();return Te(b,"DSA PRIVATE KEY")}if(t=="PKCS5PRV"&&v!==void 0&&e instanceof v&&r!==void 0&&r!=null&&e.isPrivate==!0){var P=y(e),b=P.tohex();return n===void 0&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",b,r,n,s)}if(t=="PKCS5PRV"&&l!==void 0&&e instanceof l&&r!==void 0&&r!=null&&e.isPrivate==!0){var P=x(e),b=P.tohex();return n===void 0&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",b,r,n,s)}if(t=="PKCS5PRV"&&g!==void 0&&e instanceof g&&r!==void 0&&r!=null&&e.isPrivate==!0){var P=E(e),b=P.tohex();return n===void 0&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",b,r,n,s)}var F=function(D,_){if(typeof _=="string")return Z.getEncryptedPKCS8PEM(D,_);if(typeof _=="object"&&he(_,"passcode")!=null){var O=JSON.parse(JSON.stringify(_)),U=O.passcode;return delete O.passcode,Z.getEncryptedPKCS8PEM(D,U,O)}};if(t=="PKCS8PRV"&&v!=null&&e instanceof v&&e.isPrivate==!0){var I=y(e),N=I.tohex(),P=m({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:N}}]}),b=P.tohex();return r===void 0||r==null?Te(b,"PRIVATE KEY"):F(b,r)}if(t=="PKCS8PRV"&&l!==void 0&&e instanceof l&&e.isPrivate==!0){var C={seq:[{int:1},{octstr:{hex:e.prvKeyHex}}]};typeof e.pubKeyHex=="string"&&C.seq.push({tag:["a1",!0,{bitstr:{hex:"00"+e.pubKeyHex}}]});var I=new m(C),N=I.tohex(),P=m({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:e.curveName}}]},{octstr:{hex:N}}]}),b=P.tohex();return r===void 0||r==null?Te(b,"PRIVATE KEY"):F(b,r)}if(t=="PKCS8PRV"&&g!==void 0&&e instanceof g&&e.isPrivate==!0){var I=new d({bigint:e.x}),N=I.tohex(),P=m({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.g}}]}]},{octstr:{hex:N}}]}),b=P.tohex();return r===void 0||r==null?Te(b,"PRIVATE KEY"):F(b,r)}throw new Error("unsupported object nor format")};Z.getKeyFromCSRPEM=function(e){var t=me(e,"CERTIFICATE REQUEST"),r=Z.getKeyFromCSRHex(t);return r};Z.getKeyFromCSRHex=function(e){var t=Z.parseCSRHex(e),r=Z.getKey(t.p8pubkeyhex,null,"pkcs8pub");return r};Z.parseCSRHex=function(e){var t=K,r=t.getChildIdx,n=t.getTLV,i={},s=e;if(s.substr(0,2)!="30")throw new Error("malformed CSR(code:001)");var a=r(s,0);if(a.length<1)throw new Error("malformed CSR(code:002)");if(s.substr(a[0],2)!="30")throw new Error("malformed CSR(code:003)");var o=r(s,a[0]);if(o.length<3)throw new Error("malformed CSR(code:004)");return i.p8pubkeyhex=n(s,o[2]),i};Z.getKeyID=function(e){var t=Z,r=K;typeof e=="string"&&e.indexOf("BEGIN ")!=-1&&(e=t.getKey(e));var n=me(t.getPEM(e)),i=r.getIdxbyList(n,0,[1]),s=r.getV(n,i).substring(2);return u.crypto.Util.hashHex(s,"sha1")};Z.getJWK=function(e,t,r,n,i){var s,a={},o,f=u.crypto.Util.hashHex;if(typeof e=="string")s=Z.getKey(e),e.indexOf("CERTIFICATE")!=-1&&(o=me(e));else if(typeof e=="object")e instanceof X?(s=e.getPublicKey(),o=e.hex):s=e;else throw new Error("unsupported keyinfo type");if(s instanceof W&&s.isPrivate)a.kty="RSA",a.n=Pe(s.n.toString(16)),a.e=Pe(s.e.toString(16)),a.d=Pe(s.d.toString(16)),a.p=Pe(s.p.toString(16)),a.q=Pe(s.q.toString(16)),a.dp=Pe(s.dmp1.toString(16)),a.dq=Pe(s.dmq1.toString(16)),a.qi=Pe(s.coeff.toString(16));else if(s instanceof W&&s.isPublic)a.kty="RSA",a.n=Pe(s.n.toString(16)),a.e=Pe(s.e.toString(16));else if(s instanceof u.crypto.ECDSA&&s.isPrivate){var d=s.getShortNISTPCurveName();if(d!=="P-256"&&d!=="P-384"&&d!=="P-521")throw new Error("unsupported curve name for JWT: "+d);var m=s.getPublicKeyXYHex();a.kty="EC",a.crv=d,a.x=Pe(m.x),a.y=Pe(m.y),a.d=Pe(s.prvKeyHex)}else if(s instanceof u.crypto.ECDSA&&s.isPublic){var d=s.getShortNISTPCurveName();if(d!=="P-256"&&d!=="P-384"&&d!=="P-521")throw new Error("unsupported curve name for JWT: "+d);var m=s.getPublicKeyXYHex();a.kty="EC",a.crv=d,a.x=Pe(m.x),a.y=Pe(m.y)}if(a.kty==null)throw new Error("unsupported keyinfo");return!s.isPrivate&&t!=!0&&(a.kid=u.jws.JWS.getJWKthumbprint(a)),o!=null&&r!=!0&&(a.x5c=[It(o)]),o!=null&&n!=!0&&(a.x5t=lr(It(f(o,"sha1")))),o!=null&&i!=!0&&(a["x5t#S256"]=lr(It(f(o,"sha256")))),a};Z.getJWKFromKey=function(e){return Z.getJWK(e,!0,!0,!0,!0)};W.getPosArrayOfChildrenFromHex=function(e){return K.getChildIdx(e,0)};W.getHexValueArrayOfChildrenFromHex=function(e){var t=K,r=t.getV,h=W.getPosArrayOfChildrenFromHex(e),n=r(e,h[0]),i=r(e,h[1]),s=r(e,h[2]),a=r(e,h[3]),o=r(e,h[4]),f=r(e,h[5]),d=r(e,h[6]),m=r(e,h[7]),p=r(e,h[8]),h=new Array;return h.push(n,i,s,a,o,f,d,m,p),h};W.prototype.readPrivateKeyFromPEMString=function(e){var t=me(e),r=W.getHexValueArrayOfChildrenFromHex(t);this.setPrivateEx(r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8])};W.prototype.readPKCS5PrvKeyHex=function(e){var t=W.getHexValueArrayOfChildrenFromHex(e);this.setPrivateEx(t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])};W.prototype.readPKCS8PrvKeyHex=function(e){var t,r,n,i,s,a,o,f,d=K,m=d.getVbyListEx;if(d.isASN1HEX(e)===!1)throw new Error("not ASN.1 hex string");try{t=m(e,0,[2,0,1],"02"),r=m(e,0,[2,0,2],"02"),n=m(e,0,[2,0,3],"02"),i=m(e,0,[2,0,4],"02"),s=m(e,0,[2,0,5],"02"),a=m(e,0,[2,0,6],"02"),o=m(e,0,[2,0,7],"02"),f=m(e,0,[2,0,8],"02")}catch{throw new Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(t,r,n,i,s,a,o,f)};W.prototype.readPKCS5PubKeyHex=function(e){var t=K,r=t.getV;if(t.isASN1HEX(e)===!1)throw new Error("keyHex is not ASN.1 hex string");var n=t.getChildIdx(e,0);if(n.length!==2||e.substr(n[0],2)!=="02"||e.substr(n[1],2)!=="02")throw new Error("wrong hex for PKCS#5 public key");var i=r(e,n[0]),s=r(e,n[1]);this.setPublic(i,s)};W.prototype.readPKCS8PubKeyHex=function(e){var t=K;if(t.isASN1HEX(e)===!1)throw new Error("not ASN.1 hex string");if(t.getTLVbyListEx(e,0,[0,0])!=="06092a864886f70d010101")throw new Error("not PKCS8 RSA public key");var r=t.getTLVbyListEx(e,0,[1,0]);this.readPKCS5PubKeyHex(r)};W.prototype.readCertPubKeyHex=function(e,t){var r,n;r=new X,r.readCertHex(e),n=r.getPublicKeyHex(),this.readPKCS8PubKeyHex(n)};var gg=new RegExp("[^0-9a-f]","gi");function za(e,t){for(var r="",n=t/4-e.length,i=0;i<n;i++)r=r+"0";return r+e}W.prototype.sign=function(e,t){var r=function(i){return u.crypto.Util.hashString(i,t)},n=r(e);return this.signWithMessageHash(n,t)};W.prototype.signWithMessageHash=function(e,t){var r=u.crypto.Util.getPaddedDigestInfoHex(e,t,this.n.bitLength()),n=Oe(r,16),i=this.doPrivate(n),s=i.toString(16);return za(s,this.n.bitLength())};function Wa(e,t,r){for(var n="",i=0;n.length<t;)n+=He(r(et(e+String.fromCharCode.apply(String,[(i&4278190080)>>24,(i&16711680)>>16,(i&65280)>>8,i&255])))),i+=1;return n}W.prototype.signPSS=function(e,t,r){var n=function(s){return u.crypto.Util.hashHex(s,t)},i=n(et(e));return r===void 0&&(r=-1),this.signWithMessageHashPSS(i,t,r)};W.prototype.signWithMessageHashPSS=function(e,t,r){var n=He(e),i=n.length,s=this.n.bitLength()-1,a=Math.ceil(s/8),o,f=function(v){return u.crypto.Util.hashHex(v,t)};if(r===-1||r===void 0)r=i;else if(r===-2)r=a-i-2;else if(r<-2)throw new Error("invalid salt length");if(a<i+r+2)throw new Error("data too long");var d="";r>0&&(d=new Array(r),new Kt().nextBytes(d),d=String.fromCharCode.apply(String,d));var m=He(f(et("\0\0\0\0\0\0\0\0"+n+d))),p=[];for(o=0;o<a-r-i-2;o+=1)p[o]=0;var h=String.fromCharCode.apply(String,p)+""+d,c=Wa(m,h.length,f),g=[];for(o=0;o<h.length;o+=1)g[o]=h.charCodeAt(o)^c.charCodeAt(o);var l=65280>>8*a-s&255;for(g[0]&=~l,o=0;o<i;o++)g.push(m.charCodeAt(o));return g.push(188),za(this.doPrivate(new B(g)).toString(16),this.n.bitLength())};function Xa(e){for(var t in u.crypto.Util.DIGESTINFOHEAD){var r=u.crypto.Util.DIGESTINFOHEAD[t],n=r.length;if(e.substring(0,n)==r){var i=[t,e.substring(n)];return i}}return[]}W.prototype.verify=function(e,t){if(t=t.toLowerCase(),t.match(/^[0-9a-f]+$/)==null)return!1;var r=Oe(t,16),n=this.n.bitLength();if(r.bitLength()>n)return!1;var i=this.doPublic(r),s=i.toString(16);if(s.length+3!=n/4)return!1;var a=s.replace(/^1f+00/,""),o=Xa(a);if(o.length==0)return!1;var f=o[0],d=o[1],m=function(h){return u.crypto.Util.hashString(h,f)},p=m(e);return d==p};W.prototype.verifyWithMessageHash=function(e,t){if(t.length!=Math.ceil(this.n.bitLength()/4))return!1;var r=Oe(t,16);if(r.bitLength()>this.n.bitLength())return 0;var n=this.doPublic(r),i=n.toString(16).replace(/^1f+00/,""),s=Xa(i);if(s.length==0)return!1;var a=s[0],o=s[1];return o==e};W.prototype.verifyPSS=function(e,t,r,n){var i=function(a){return u.crypto.Util.hashHex(a,r)},s=i(et(e));return n===void 0&&(n=-1),this.verifyWithMessageHashPSS(s,t,r,n)};W.prototype.verifyWithMessageHashPSS=function(e,t,r,n){if(t.length!=Math.ceil(this.n.bitLength()/4))return!1;var i=new B(t,16),s=function(x){return u.crypto.Util.hashHex(x,r)},a=He(e),o=a.length,f=this.n.bitLength()-1,d=Math.ceil(f/8),m;if(n===-1||n===void 0)n=o;else if(n===-2)n=d-o-2;else if(n<-2)throw new Error("invalid salt length");if(d<o+n+2)throw new Error("data too long");var p=this.doPublic(i).toByteArray();for(m=0;m<p.length;m+=1)p[m]&=255;for(;p.length<d;)p.unshift(0);if(p[d-1]!==188)throw new Error("encoded message does not end in 0xbc");p=String.fromCharCode.apply(String,p);var h=p.substr(0,d-o-1),c=p.substr(h.length,o),g=65280>>8*d-f&255;if((h.charCodeAt(0)&g)!==0)throw new Error("bits beyond keysize not zero");var l=Wa(c,h.length,s),v=[];for(m=0;m<h.length;m+=1)v[m]=h.charCodeAt(m)^l.charCodeAt(m);v[0]&=~g;var y=d-o-n-2;for(m=0;m<y;m+=1)if(v[m]!==0)throw new Error("leftmost octets not zero");if(v[y]!==1)throw new Error("0x01 marker not found");return c===He(s(et("\0\0\0\0\0\0\0\0"+a+String.fromCharCode.apply(String,v.slice(-n)))))};W.SALT_LEN_HLEN=-1;W.SALT_LEN_MAX=-2;W.SALT_LEN_RECOVER=-2;function X(e){var t=K,r=t.getChildIdx,n=t.getV,i=t.dump,s=t.parse,a=t.getTLV,o=t.getVbyList,f=t.getVbyListEx,d=t.getTLVbyList,m=t.getTLVbyListEx,p=t.getIdxbyList,h=t.getIdxbyListEx,c=t.getVidx,g=t.getInt,l=t.oidname,v=t.hextooidstr,y=X,x=me,E,P=Error;try{E=u.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch{}this.HEX2STAG={"0c":"utf8",13:"prn",16:"ia5","1a":"vis","1e":"bmp"},this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){if(this.hex===null||this.version!==0)return this.version;var S=d(this.hex,0,[0,0]);if(S.substr(0,2)=="a0"){var w=d(S,0,[0]),A=g(w,0);if(A<0||2<A)throw new Error("malformed version field");return this.version=A+1,this.version}else return this.version=1,this.foffset=-1,1},this.getSerialNumberHex=function(){return f(this.hex,0,[0,0],"02")},this.getSignatureAlgorithmField=function(){var S=m(this.hex,0,[0,1]);return this.getAlgorithmIdentifierName(S)},this.getAlgorithmIdentifierName=function(S){for(var w in E)if(S===E[w])return w;return l(f(S,0,[0],"06"))},this.getIssuer=function(S,w){return this.getX500Name(this.getIssuerHex(),S,w)},this.getIssuerHex=function(){return d(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){var S=this.getIssuer();return S.str},this.getSubject=function(S,w){return this.getX500Name(this.getSubjectHex(),S,w)},this.getSubjectHex=function(){return d(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){var S=this.getSubject();return S.str},this.getNotBefore=function(){var S=o(this.hex,0,[0,4+this.foffset,0]);return S=S.replace(/(..)/g,"%$1"),S=decodeURIComponent(S),S},this.getNotAfter=function(){var S=o(this.hex,0,[0,4+this.foffset,1]);return S=S.replace(/(..)/g,"%$1"),S=decodeURIComponent(S),S},this.getPublicKeyHex=function(){return this.getSPKI()},this.getSPKI=function(){return d(this.hex,0,[0,6+this.foffset],"30")},this.getSPKIValue=function(){var S=this.getSPKI();return S==null?null:o(S,0,[1],"03",!0)},this.getPublicKeyIdx=function(){return p(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var S=this.getPublicKeyIdx();return p(this.hex,S,[1,0],"30")},this.getPublicKey=function(){return Z.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){var S=d(this.hex,0,[1],"30");return this.getAlgorithmIdentifierName(S)},this.getSignatureValueHex=function(){return o(this.hex,0,[2],"03",!0)},this.verifySignature=function(S){var w=this.getSignatureAlgorithmField(),A=this.getSignatureValueHex(),F=d(this.hex,0,[0],"30"),I=new u.crypto.Signature({alg:w});return I.init(S),I.updateHex(F),I.verify(A)},this.parseExt=function(S){var w,A,F;if(S===void 0){if(F=this.hex,this.version!==3)return-1;w=p(F,0,[0,7,0],"30"),A=r(F,w)}else{F=me(S);var I=p(F,0,[0,3,0,0],"06");if(n(F,I)!="2a864886f70d01090e"){this.aExtInfo=new Array;return}w=p(F,0,[0,3,0,1,0],"30"),A=r(F,w),this.hex=F}this.aExtInfo=new Array;for(var N=0;N<A.length;N++){var C={};C.critical=!1;var D=r(F,A[N]),_=0;D.length===3&&(C.critical=!0,_=1),C.oid=t.hextooidstr(o(F,A[N],[0],"06"));var O=p(F,A[N],[1+_]);C.vidx=c(F,O),this.aExtInfo.push(C)}},this.getExtInfo=function(S){var w=this.aExtInfo,A=S;if(S.match(/^[0-9.]+$/)||(A=u.asn1.x509.OID.name2oid(S)),A!==""){for(var F=0;F<w.length;F++)if(w[F].oid===A)return w[F]}},this.getCriticalExtV=function(S,w,A){if(w!=null)return[w,A];var F=this.getExtInfo(S);return F==null?[null,null]:[a(this.hex,F.vidx),F.critical]},this.getExtBasicConstraints=function(S,w){if(S===void 0&&w===void 0){var A=this.getExtInfo("basicConstraints");if(A===void 0)return;S=a(this.hex,A.vidx),w=A.critical}var F={extname:"basicConstraints"};if(w&&(F.critical=!0),S==="3000")return F;if(S==="30030101ff")return F.cA=!0,F;if(S.substr(0,12)==="30060101ff02"){var I=n(S,10),N=parseInt(I,16);return F.cA=!0,F.pathLen=N,F}throw new Error("hExtV parse error: "+S)},this.getExtNameConstraints=function(S,w){var A=this.getCriticalExtV("nameConstraints",S,w);if(S=A[0],w=A[1],S!=null){var F={extname:"nameConstraints"};w&&(F.critical=!0);for(var I=r(S,0),N=0;N<I.length;N++){for(var C=[],D=r(S,I[N]),_=0;_<D.length;_++){var O=a(S,D[_]),U=this.getGeneralSubtree(O);C.push(U)}var J=S.substr(I[N],2);J=="a0"?F.permit=C:J=="a1"&&(F.exclude=C)}return F}},this.getGeneralSubtree=function(S){var w=r(S,0),A=w.length;if(A<1||2<A)throw new Error("wrong num elements");for(var F=this.getGeneralName(a(S,w[0])),I=1;I<A;I++){var N=S.substr(w[I],2),C=n(S,w[I]),D=parseInt(C,16);N=="80"&&(F.min=D),N=="81"&&(F.max=D)}return F},this.getExtKeyUsage=function(S,w){var A=this.getCriticalExtV("keyUsage",S,w);if(S=A[0],w=A[1],S!=null){var F={extname:"keyUsage"};return w&&(F.critical=!0),F.names=this.getExtKeyUsageString(S).split(","),F}},this.getExtKeyUsageBin=function(S){if(S===void 0){var w=this.getExtInfo("keyUsage");if(w===void 0)return"";S=a(this.hex,w.vidx)}if(S.length!=8&&S.length!=10)throw new Error("malformed key usage value: "+S);var A="000000000000000"+parseInt(S.substr(6),16).toString(2);return S.length==8&&(A=A.slice(-8)),S.length==10&&(A=A.slice(-16)),A=A.replace(/0+$/,""),A==""&&(A="0"),A},this.getExtKeyUsageString=function(S){for(var w=this.getExtKeyUsageBin(S),A=new Array,F=0;F<w.length;F++)w.substr(F,1)=="1"&&A.push(X.KEYUSAGE_NAME[F]);return A.join(",")},this.getExtSubjectKeyIdentifier=function(S,w){if(S===void 0&&w===void 0){var A=this.getExtInfo("subjectKeyIdentifier");if(A===void 0)return;S=a(this.hex,A.vidx),w=A.critical}var F={extname:"subjectKeyIdentifier"};w&&(F.critical=!0);var I=n(S,0);return F.kid={hex:I},F},this.getExtAuthorityKeyIdentifier=function(S,w){if(S===void 0&&w===void 0){var A=this.getExtInfo("authorityKeyIdentifier");if(A===void 0)return;S=a(this.hex,A.vidx),w=A.critical}var F={extname:"authorityKeyIdentifier"};w&&(F.critical=!0);for(var I=r(S,0),N=0;N<I.length;N++){var C=S.substr(I[N],2);if(C==="80"&&(F.kid={hex:n(S,I[N])}),C==="a1"){var D=a(S,I[N]),_=this.getGeneralNames(D);F.issuer=_[0].dn}C==="82"&&(F.sn={hex:n(S,I[N])})}return F},this.getExtExtKeyUsage=function(S,w){if(S===void 0&&w===void 0){var A=this.getExtInfo("extKeyUsage");if(A===void 0)return;S=a(this.hex,A.vidx),w=A.critical}var F={extname:"extKeyUsage",array:[]};w&&(F.critical=!0);for(var I=r(S,0),N=0;N<I.length;N++)F.array.push(l(n(S,I[N])));return F},this.getExtExtKeyUsageName=function(){var S=this.getExtInfo("extKeyUsage");if(S===void 0)return S;var w=new Array,A=a(this.hex,S.vidx);if(A==="")return w;for(var F=r(A,0),I=0;I<F.length;I++)w.push(l(n(A,F[I])));return w},this.getExtSubjectAltName=function(S,w){if(S===void 0&&w===void 0){var A=this.getExtInfo("subjectAltName");if(A===void 0)return;S=a(this.hex,A.vidx),w=A.critical}var F={extname:"subjectAltName",array:[]};return w&&(F.critical=!0),F.array=this.getGeneralNames(S),F},this.getExtIssuerAltName=function(S,w){if(S===void 0&&w===void 0){var A=this.getExtInfo("issuerAltName");if(A===void 0)return;S=a(this.hex,A.vidx),w=A.critical}var F={extname:"issuerAltName",array:[]};return w&&(F.critical=!0),F.array=this.getGeneralNames(S),F},this.getGeneralNames=function(S){for(var w=r(S,0),A=[],F=0;F<w.length;F++){var I=this.getGeneralName(a(S,w[F]));I!==void 0&&A.push(I)}return A},this.getGeneralName=function(S){var w=S.substr(0,2),A=n(S,0),F=He(A);if(w=="81")return{rfc822:F};if(w=="82")return{dns:F};if(w=="86")return{uri:F};if(w=="87")return{ip:In(A)};if(w=="a4")return{dn:this.getX500Name(A)};if(w=="a0")return{other:this.getOtherName(S)}},this.getExtSubjectAltName2=function(){var S,w,A,F=this.getExtInfo("subjectAltName");if(F===void 0)return F;for(var I=new Array,N=a(this.hex,F.vidx),C=r(N,0),D=0;D<C.length;D++)A=N.substr(C[D],2),S=n(N,C[D]),A==="81"&&(w=ae(S),I.push(["MAIL",w])),A==="82"&&(w=ae(S),I.push(["DNS",w])),A==="84"&&(w=X.hex2dn(S,0),I.push(["DN",w])),A==="86"&&(w=ae(S),I.push(["URI",w])),A==="87"&&(w=In(S),I.push(["IP",w]));return I},this.getExtCRLDistributionPoints=function(S,w){if(S===void 0&&w===void 0){var A=this.getExtInfo("cRLDistributionPoints");if(A===void 0)return;S=a(this.hex,A.vidx),w=A.critical}var F={extname:"cRLDistributionPoints",array:[]};w&&(F.critical=!0);for(var I=r(S,0),N=0;N<I.length;N++){var C=a(S,I[N]);F.array.push(this.getDistributionPoint(C))}return F},this.getDistributionPoint=function(S){for(var w={},A=r(S,0),F=0;F<A.length;F++){var I=S.substr(A[F],2),N=a(S,A[F]);I=="a0"&&(w.dpname=this.getDistributionPointName(N))}return w},this.getDistributionPointName=function(S){for(var w={},A=r(S,0),F=0;F<A.length;F++){var I=S.substr(A[F],2),N=a(S,A[F]);I=="a0"&&(w.full=this.getGeneralNames(N))}return w},this.getExtCRLDistributionPointsURI=function(){var S=this.getExtCRLDistributionPoints();if(S==null)return S;for(var w=S.array,A=[],F=0;F<w.length;F++)try{w[F].dpname.full[0].uri!=null&&A.push(w[F].dpname.full[0].uri)}catch{}return A},this.getExtAIAInfo=function(){var S=this.getExtInfo("authorityInfoAccess");if(S===void 0)return S;for(var w={ocsp:[],caissuer:[]},A=r(this.hex,S.vidx),F=0;F<A.length;F++){var I=o(this.hex,A[F],[0],"06"),N=o(this.hex,A[F],[1],"86");I==="2b06010505073001"&&w.ocsp.push(ae(N)),I==="2b06010505073002"&&w.caissuer.push(ae(N))}return w},this.getExtAuthorityInfoAccess=function(S,w){if(S===void 0&&w===void 0){var A=this.getExtInfo("authorityInfoAccess");if(A===void 0)return;S=a(this.hex,A.vidx),w=A.critical}var F={extname:"authorityInfoAccess",array:[]};w&&(F.critical=!0);for(var I=r(S,0),N=0;N<I.length;N++){var C=f(S,I[N],[0],"06"),D=o(S,I[N],[1],"86"),_=ae(D);if(C=="2b06010505073001")F.array.push({ocsp:_});else if(C=="2b06010505073002")F.array.push({caissuer:_});else throw new Error("unknown method: "+C)}return F},this.getExtCertificatePolicies=function(S,w){if(S===void 0&&w===void 0){var A=this.getExtInfo("certificatePolicies");if(A===void 0)return;S=a(this.hex,A.vidx),w=A.critical}var F={extname:"certificatePolicies",array:[]};w&&(F.critical=!0);for(var I=r(S,0),N=0;N<I.length;N++){var C=a(S,I[N]),D=this.getPolicyInformation(C);F.array.push(D)}return F},this.getPolicyInformation=function(S){var w={},A=o(S,0,[0],"06");w.policyoid=l(A);var F=h(S,0,[1],"30");if(F!=-1){w.array=[];for(var I=r(S,F),N=0;N<I.length;N++){var C=a(S,I[N]),D=this.getPolicyQualifierInfo(C);w.array.push(D)}}return w},this.getOtherName=function(S){var w={},A=r(S,0),F=o(S,A[0],[],"06"),I=o(S,A[1],[]);return w.oid=l(F),w.value=s(I),w},this.getPolicyQualifierInfo=function(S){var w={},A=o(S,0,[0],"06");if(A==="2b06010505070201"){var F=f(S,0,[1],"16");w.cps=He(F)}else if(A==="2b06010505070202"){var I=d(S,0,[1],"30");w.unotice=this.getUserNotice(I)}return w},this.getUserNotice=function(S){var w=null,A={};try{w=t.parse(S);var F=this._asn1ToUnotice(w);return F}catch{return}},this._asn1ToUnotice=function(S){try{for(var w={},A=he(S,"seq"),F=0;F<A.length;F++){var I=this._asn1ToNoticeRef(A[F]);I!=null&&(w.noticeref=I);var N=this.asn1ToDisplayText(A[F]);N!=null&&(w.exptext=N)}return Object.keys(w).length>0?w:void 0}catch{return}},this._asn1ToNoticeRef=function(S){try{for(var w={},A=he(S,"seq"),F=0;F<A.length;F++){var I=this._asn1ToNoticeNum(A[F]);I!=null&&(w.noticenum=I);var N=this.asn1ToDisplayText(A[F]);N!=null&&(w.org=N)}return Object.keys(w).length>0?w:void 0}catch{return}},this._asn1ToNoticeNum=function(S){try{for(var w=he(S,"seq"),A=[],F=0;F<w.length;F++){var I=w[F];A.push(parseInt(he(I,"int.hex"),16))}return A}catch{return}},this.getDisplayText=function(S){var w={"0c":"utf8",16:"ia5","1a":"vis","1e":"bmp"},A={};return A.type=w[S.substr(0,2)],A.str=He(n(S,0)),A},this.asn1ToDisplayText=function(S){if(S.utf8str!=null)return{type:"utf8",str:S.utf8str.str};if(S.ia5str!=null)return{type:"ia5",str:S.ia5str.str};if(S.visstr!=null)return{type:"vis",str:S.visstr.str};if(S.bmpstr!=null)return{type:"bmp",str:S.bmpstr.str};if(S.prnstr!=null)return{type:"prn",str:S.prnstr.str}},this.getExtPolicyMappings=function(S,w){var A=this.getCriticalExtV("policyMappings",S,w);if(S=A[0],w=A[1],S!=null){var F={extname:"policyMappings"};w&&(F.critical=!0);try{for(var I=s(S),N=I.seq,C=[],D=0;D<N.length;D++){var _=N[D].seq;C.push([_[0].oid,_[1].oid])}F.array=C}catch{throw new P("malformed policyMappings")}return F}},this.getExtPolicyConstraints=function(S,w){var A=this.getCriticalExtV("policyConstraints",S,w);if(S=A[0],w=A[1],S!=null){var F={extname:"policyConstraints"};w&&(F.critical=!0);var I=s(S);try{for(var N=I.seq,C=0;C<N.length;C++){var D=N[C].tag;D.explicit==!1&&(D.tag=="80"&&(F.reqexp=parseInt(D.hex,16)),D.tag=="81"&&(F.inhibit=parseInt(D.hex,16)))}}catch{return new P("malformed policyConstraints value")}return F}},this.getExtInhibitAnyPolicy=function(S,w){var A=this.getCriticalExtV("inhibitAnyPolicy",S,w);if(S=A[0],w=A[1],S!=null){var F={extname:"inhibitAnyPolicy"};w&&(F.critical=!0);var I=g(S,0);return I==-1?new P("wrong value"):(F.skip=I,F)}},this.getExtCRLNumber=function(S,w){var A={extname:"cRLNumber"};if(w&&(A.critical=!0),S.substr(0,2)=="02")return A.num={hex:n(S,0)},A;throw new P("hExtV parse error: "+S)},this.getExtCRLReason=function(S,w){var A={extname:"cRLReason"};if(w&&(A.critical=!0),S.substr(0,2)=="0a")return A.code=parseInt(n(S,0),16),A;throw new Error("hExtV parse error: "+S)},this.getExtOcspNonce=function(S,w){var A={extname:"ocspNonce"};w&&(A.critical=!0);var F=n(S,0);return A.hex=F,A},this.getExtOcspNoCheck=function(S,w){var A={extname:"ocspNoCheck"};return w&&(A.critical=!0),A},this.getExtAdobeTimeStamp=function(S,w){if(S===void 0&&w===void 0){var A=this.getExtInfo("adobeTimeStamp");if(A===void 0)return;S=a(this.hex,A.vidx),w=A.critical}var F={extname:"adobeTimeStamp"};w&&(F.critical=!0);var I=r(S,0);if(I.length>1){var N=a(S,I[1]),C=this.getGeneralName(N);C.uri!=null&&(F.uri=C.uri)}if(I.length>2){var D=a(S,I[2]);D=="0101ff"&&(F.reqauth=!0),D=="010100"&&(F.reqauth=!1)}return F},this.getExtSubjectDirectoryAttributes=function(S,w){if(S===void 0&&w===void 0){var A=this.getExtInfo("subjectDirectoryAttributes");if(A===void 0)return;S=a(this.hex,A.vidx),w=A.critical}var F={extname:"subjectDirectoryAttributes"};w&&(F.critical=!0);try{for(var I=s(S),N=[],C=0;C<I.seq.length;C++){var D=I.seq[C],_=he(D,"seq.0.oid"),O=he(D,"seq.1.set");if(_==null||O==null)throw"error";N.push({attr:_,array:O})}return F.array=N,F}catch{throw new Error("malformed subjectDirectoryAttributes extension value")}};var b=function(S){var w={};try{var A=S.seq[0].oid,F=u.asn1.x509.OID.name2oid(A);w.type=u.asn1.x509.OID.oid2atype(F);var I=S.seq[1];if(I.utf8str!=null)w.ds="utf8",w.value=I.utf8str.str;else if(I.numstr!=null)w.ds="num",w.value=I.numstr.str;else if(I.telstr!=null)w.ds="tel",w.value=I.telstr.str;else if(I.prnstr!=null)w.ds="prn",w.value=I.prnstr.str;else if(I.ia5str!=null)w.ds="ia5",w.value=I.ia5str.str;else if(I.visstr!=null)w.ds="vis",w.value=I.visstr.str;else if(I.bmpstr!=null)w.ds="bmp",w.value=I.bmpstr.str;else throw"error";return w}catch{throw new Erorr("improper ASN.1 parsed AttrTypeAndValue")}},R=function(S){try{return S.set.map(function(w){return b(w)})}catch(w){throw new Error("improper ASN.1 parsed RDN: "+w)}},T=function(S){try{return S.seq.map(function(w){return R(w)})}catch(w){throw new Error("improper ASN.1 parsed X500Name: "+w)}};this.getX500NameRule=function(S){for(var w=!0,A=!0,F=!1,I="",N="",C=null,D=[],_=0;_<S.length;_++)for(var O=S[_],U=0;U<O.length;U++)D.push(O[U]);for(var _=0;_<D.length;_++){var J=D[_],G=J.ds,Q=J.value,Y=J.type;if(I+=":"+G,G!="prn"&&G!="utf8"&&G!="ia5")return"mixed";if(G=="ia5"){if(Y!="CN")return"mixed";if(u.lang.String.isMail(Q))continue;return"mixed"}if(Y=="C"){if(G=="prn")continue;return"mixed"}if(N+=":"+G,C==null)C=G;else if(C!==G)return"mixed"}return C??"prn"},this.getAttrTypeAndValue=function(S){var w=s(S);return b(w)},this.getRDN=function(S){var w=s(S);return R(w)},this.getX500NameArray=function(S){var w=s(S);return T(w)},this.getX500Name=function(S,w,A){var F=this.getX500NameArray(S),I=this.dnarraytostr(F),N={str:I};return N.array=F,A==!0&&(N.hex=S),w==!0&&(N.canon=this.c14nRDNArray(F)),N},this.readCertPEM=function(S){this.readCertHex(x(S))},this.readCertHex=function(S){this.hex=S,this.getVersion();try{p(this.hex,0,[0,7],"a3"),this.parseExt()}catch{}},this.getParam=function(S){var w={};return S==null&&(S={}),w.version=this.getVersion(),w.serial={hex:this.getSerialNumberHex()},w.sigalg=this.getSignatureAlgorithmField(),w.issuer=this.getIssuer(S.dncanon,S.dnhex),w.notbefore=this.getNotBefore(),w.notafter=this.getNotAfter(),w.subject=this.getSubject(S.dncanon,S.dnhex),w.sbjpubkey=Te(this.getPublicKeyHex(),"PUBLIC KEY"),this.aExtInfo!=null&&this.aExtInfo.length>0&&(w.ext=this.getExtParamArray()),w.sighex=this.getSignatureValueHex(),S.tbshex==!0&&(w.tbshex=d(this.hex,0,[0])),S.nodnarray==!0&&(delete w.issuer.array,delete w.subject.array),w},this.getExtParamArray=function(S){if(S==null){var w=h(this.hex,0,[0,"[3]"]);w!=-1&&(S=m(this.hex,0,[0,"[3]",0],"30"))}for(var A=[],F=r(S,0),I=0;I<F.length;I++){var N=a(S,F[I]),C=this.getExtParam(N);C!=null&&A.push(C)}return A},this.getExtParam=function(S){var w={},A=r(S,0),F=A.length;if(F!=2&&F!=3)throw new Error("wrong number elements in Extension: "+F+" "+S);var I=v(o(S,0,[0],"06")),N=!1;F==3&&d(S,0,[1])=="0101ff"&&(N=!0);var C=d(S,0,[F-1,0]),D=void 0;if(I=="2.5.29.14"?D=this.getExtSubjectKeyIdentifier(C,N):I=="2.5.29.15"?D=this.getExtKeyUsage(C,N):I=="2.5.29.17"?D=this.getExtSubjectAltName(C,N):I=="2.5.29.18"?D=this.getExtIssuerAltName(C,N):I=="2.5.29.19"?D=this.getExtBasicConstraints(C,N):I=="2.5.29.30"?D=this.getExtNameConstraints(C,N):I=="2.5.29.31"?D=this.getExtCRLDistributionPoints(C,N):I=="2.5.29.32"?D=this.getExtCertificatePolicies(C,N):I=="2.5.29.33"?D=this.getExtPolicyMappings(C,N):I=="2.5.29.35"?D=this.getExtAuthorityKeyIdentifier(C,N):I=="2.5.29.36"?D=this.getExtPolicyConstraints(C,N):I=="2.5.29.37"?D=this.getExtExtKeyUsage(C,N):I=="2.5.29.54"?D=this.getExtInhibitAnyPolicy(C,N):I=="1.3.6.1.5.5.7.1.1"?D=this.getExtAuthorityInfoAccess(C,N):I=="2.5.29.20"?D=this.getExtCRLNumber(C,N):I=="2.5.29.21"?D=this.getExtCRLReason(C,N):I=="2.5.29.9"?D=this.getExtSubjectDirectoryAttributes(C,N):I=="1.3.6.1.5.5.7.48.1.2"?D=this.getExtOcspNonce(C,N):I=="1.3.6.1.5.5.7.48.1.5"?D=this.getExtOcspNoCheck(C,N):I=="1.2.840.113583.1.1.9.1"?D=this.getExtAdobeTimeStamp(C,N):X.EXT_PARSER[I]!=null&&(D=X.EXT_PARSER[I](I,N,C)),D!=null)return D;var _={extname:I,extn:C};try{_.extn=s(C)}catch{}return N&&(_.critical=!0),_},this.findExt=function(S,w){for(var A=0;A<S.length;A++)if(S[A].extname==w)return S[A];return null},this.updateExtCDPFullURI=function(S,w){var A=this.findExt(S,"cRLDistributionPoints");if(A!=null&&A.array!=null){for(var F=A.array,I=0;I<F.length;I++)if(F[I].dpname!=null&&F[I].dpname.full!=null)for(var N=F[I].dpname.full,C=0;C<N.length;C++){var D=N[I];D.uri!=null&&(D.uri=w)}}},this.updateExtAIAOCSP=function(S,w){var A=this.findExt(S,"authorityInfoAccess");if(A!=null&&A.array!=null)for(var F=A.array,I=0;I<F.length;I++)F[I].ocsp!=null&&(F[I].ocsp=w)},this.updateExtAIACAIssuer=function(S,w){var A=this.findExt(S,"authorityInfoAccess");if(A!=null&&A.array!=null)for(var F=A.array,I=0;I<F.length;I++)F[I].caissuer!=null&&(F[I].caissuer=w)},this.dnarraytostr=function(S){function w(F){return F.map(function(I){return A(I).replace(/\+/,"\\+")}).join("+")}function A(F){return F.type+"="+F.value}return"/"+S.map(function(F){return w(F).replace(/\//,"\\/")}).join("/")},this.setCanonicalizedDN=function(S){var w;if(S.str!=null&&S.array==null){var A=new u.asn1.x509.X500Name({str:S.str}),F=A.tohex();w=this.getX500NameArray(F)}else w=S.array;S.canon==null&&(S.canon=this.c14nRDNArray(w))},this.c14nRDNArray=function(S){for(var w=[],A=0;A<S.length;A++){for(var F=S[A],I=[],N=0;N<F.length;N++){var C=F[N],D=C.value;D=D.replace(/^\s*/,""),D=D.replace(/\s*$/,""),D=D.replace(/\s+/g," "),D=D.toLowerCase(),I.push(C.type.toLowerCase()+"="+D)}w.push(I.join("+"))}return"/"+w.join("/")},this.getInfo=function(){var S=function(Le){for(var se="",Ee="    ",pe=`
`,xe=Le.array,Ve=0;Ve<xe.length;Ve++){var ue=xe[Ve];if(ue.dn!=null&&(se+=Ee+"dn: "+ue.dn.str+pe),ue.ip!=null&&(se+=Ee+"ip: "+ue.ip+pe),ue.rfc822!=null&&(se+=Ee+"rfc822: "+ue.rfc822+pe),ue.dns!=null&&(se+=Ee+"dns: "+ue.dns+pe),ue.uri!=null&&(se+=Ee+"uri: "+ue.uri+pe),ue.other!=null){var ke=ue.other.oid,br=JSON.stringify(ue.other.value).replace(/\"/g,"");se+=Ee+"other: "+ke+"="+br+pe}}return se=se.replace(/\n$/,""),se},w=function(Le){for(var se="",Ee=Le.array,pe=0;pe<Ee.length;pe++){var xe=Ee[pe];if(se+="    policy oid: "+xe.policyoid+`
`,xe.array!==void 0)for(var Ve=0;Ve<xe.array.length;Ve++){var ue=xe.array[Ve];ue.cps!==void 0&&(se+="    cps: "+ue.cps+`
`)}}return se},A=function(Le){for(var se="",Ee=Le.array,pe=0;pe<Ee.length;pe++){var xe=Ee[pe];try{xe.dpname.full[0].uri!==void 0&&(se+="    "+xe.dpname.full[0].uri+`
`)}catch{}try{xe.dname.full[0].dn.hex!==void 0&&(se+="    "+X.hex2dn(xe.dpname.full[0].dn.hex)+`
`)}catch{}}return se},F=function(Le){for(var se="",Ee=Le.array,pe=0;pe<Ee.length;pe++){var xe=Ee[pe];xe.caissuer!==void 0&&(se+="    caissuer: "+xe.caissuer+`
`),xe.ocsp!==void 0&&(se+="    ocsp: "+xe.ocsp+`
`)}return se},I=X,N,C,D;if(N=`Basic Fields
`,N+="  serial number: "+this.getSerialNumberHex()+`
`,N+="  signature algorithm: "+this.getSignatureAlgorithmField()+`
`,N+="  issuer: "+this.getIssuerString()+`
`,N+="  notBefore: "+this.getNotBefore()+`
`,N+="  notAfter: "+this.getNotAfter()+`
`,N+="  subject: "+this.getSubjectString()+`
`,N+=`  subject public key info: 
`,C=this.getPublicKey(),N+="    key algorithm: "+C.type+`
`,C.type==="RSA"&&(N+="    n="+ji(C.n.toString(16)).substr(0,16)+`...
`,N+="    e="+ji(C.e.toString(16))+`
`),D=this.aExtInfo,D!=null){N+=`X509v3 Extensions:
`;for(var _=0;_<D.length;_++){var O=D[_],U=u.asn1.x509.OID.oid2name(O.oid);U===""&&(U=O.oid);var J="";if(O.critical===!0&&(J="CRITICAL"),N+="  "+U+" "+J+`:
`,U==="basicConstraints"){var G=this.getExtBasicConstraints();G.cA===void 0?N+=`    {}
`:(N+="    cA=true",G.pathLen!==void 0&&(N+=", pathLen="+G.pathLen),N+=`
`)}else if(U=="policyMappings"){var Q=this.getExtPolicyMappings().array,Y=Q.map(function(Le){var se=Le;return se[0]+":"+se[1]}).join(", ");N+="    "+Y+`
`}else if(U=="policyConstraints"){var fe=this.getExtPolicyConstraints();N+="    ",fe.reqexp!=null&&(N+=" reqexp="+fe.reqexp),fe.inhibit!=null&&(N+=" inhibit="+fe.inhibit),N+=`
`}else if(U=="inhibitAnyPolicy"){var fe=this.getExtInhibitAnyPolicy();N+="    skip="+fe.skip+`
`}else if(U=="keyUsage")N+="    "+this.getExtKeyUsageString()+`
`;else if(U=="subjectKeyIdentifier")N+="    "+this.getExtSubjectKeyIdentifier().kid.hex+`
`;else if(U=="authorityKeyIdentifier"){var oe=this.getExtAuthorityKeyIdentifier();oe.kid!==void 0&&(N+="    kid="+oe.kid.hex+`
`)}else if(U=="extKeyUsage"){var bt=this.getExtExtKeyUsage().array;N+="    "+bt.join(", ")+`
`}else if(U=="subjectAltName"){var We=S(this.getExtSubjectAltName());N+=We+`
`}else if(U=="cRLDistributionPoints"){var _e=this.getExtCRLDistributionPoints();N+=A(_e)}else if(U=="authorityInfoAccess"){var Ke=this.getExtAuthorityInfoAccess();N+=F(Ke)}else U=="certificatePolicies"&&(N+=w(this.getExtCertificatePolicies()))}}return N+="signature algorithm: "+this.getSignatureAlgorithmName()+`
`,N+="signature: "+this.getSignatureValueHex().substr(0,16)+`...
`,N},typeof e=="string"&&(e.indexOf("-----BEGIN")!=-1?this.readCertPEM(e):u.lang.String.isHex(e)&&this.readCertHex(e))}X.EXT_PARSER={};X.registExtParser=function(e,t){X.EXT_PARSER[e]=t};X.hex2dn=function(e,t){t===void 0&&(t=0);var r=new X,n=K.getTLV(e,t),i=r.getX500Name(e);return i.str};X.hex2rdn=function(e,t){if(t===void 0&&(t=0),e.substr(t,2)!=="31")throw new Error("malformed RDN");for(var r=new Array,n=K.getChildIdx(e,t),i=0;i<n.length;i++)r.push(X.hex2attrTypeValue(e,n[i]));return r=r.map(function(s){return s.replace("+","\\+")}),r.join("+")};X.hex2attrTypeValue=function(e,t){var r=K,n=r.getV;if(t===void 0&&(t=0),e.substr(t,2)!=="30")throw new Error("malformed attribute type and value");var i=r.getChildIdx(e,t);i.length!==2||e.substr(i[0],2);var s=n(e,i[0]),a=u.asn1.ASN1Util.oidHexToInt(s),o=u.asn1.x509.OID.oid2atype(a),f=n(e,i[1]),d=He(f);return o+"="+d};X.getPublicKeyFromCertHex=function(e){var t=new X;return t.readCertHex(e),t.getPublicKey()};X.getPublicKeyFromCertPEM=function(e){var t=new X;return t.readCertPEM(e),t.getPublicKey()};X.getPublicKeyInfoPropOfCertPEM=function(e){var t=K,r=t.getVbyList,n={},i,s,a;return n.algparam=null,i=new X,i.readCertPEM(e),s=i.getPublicKeyHex(),n.keyhex=r(s,0,[1],"03").substr(2),n.algoid=r(s,0,[0,0],"06"),n.algoid==="2a8648ce3d0201"&&(n.algparam=r(s,0,[0,1],"06")),n};X.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"];var l1=function(e){var t=u,r=t.lang.String.isHex,n=K,i=n.getV,s=n.getTLV,a=n.getVbyList,o=n.getTLVbyList,f=n.getTLVbyListEx,d=n.getIdxbyList,m=n.getIdxbyListEx,p=n.getChildIdx,h=new X;this.hex=null,this.posSigAlg=null,this.posRevCert=null,this.parsed=null,this._setPos=function(){var c=d(this.hex,0,[0,0]),g=this.hex.substr(c,2);if(g=="02")this.posSigAlg=1;else if(g=="30")this.posSigAlg=0;else throw new Error("malformed 1st item of TBSCertList: "+g);var l=d(this.hex,0,[0,this.posSigAlg+3]),v=this.hex.substr(l,2);if(v=="17"||v=="18"){var y,x;y=d(this.hex,0,[0,this.posSigAlg+4]),this.posRevCert=null,y!=-1&&(x=this.hex.substr(y,2),x=="30"&&(this.posRevCert=this.posSigAlg+4))}else if(v=="30")this.posRevCert=this.posSigAlg+3;else if(v=="a0")this.posRevCert=null;else throw new Error("malformed nextUpdate or revCert tag: "+v)},this.getVersion=function(){return this.posSigAlg==0?null:parseInt(a(this.hex,0,[0,0],"02"),16)+1},this.getSignatureAlgorithmField=function(){var c=o(this.hex,0,[0,this.posSigAlg],"30");return h.getAlgorithmIdentifierName(c)},this.getIssuer=function(){return h.getX500Name(this.getIssuerHex())},this.getIssuerHex=function(){return o(this.hex,0,[0,this.posSigAlg+1],"30")},this.getThisUpdate=function(){var c=a(this.hex,0,[0,this.posSigAlg+2]);return result=He(c)},this.getNextUpdate=function(){var c=d(this.hex,0,[0,this.posSigAlg+3]),g=this.hex.substr(c,2);return g!="17"&&g!="18"?null:He(i(this.hex,c))},this.getRevCertArray=function(){if(this.posRevCert==null)return null;for(var c=[],g=d(this.hex,0,[0,this.posRevCert]),l=p(this.hex,g),v=0;v<l.length;v++){var y=s(this.hex,l[v]);c.push(this.getRevCert(y))}return c},this.getRevCert=function(c){var g={},l=p(c,0);return g.sn={hex:a(c,0,[0],"02")},g.date=He(a(c,0,[1])),l.length==3&&(g.ext=h.getExtParamArray(o(c,0,[2]))),g},this.findRevCert=function(c){var g=new X(c),l=g.getSerialNumberHex();return this.findRevCertBySN(l)},this.findRevCertBySN=function(c){if(this.parsed==null&&this.getParam(),this.parsed.revcert==null)return null;for(var g=this.parsed.revcert,l=0;l<g.length;l++)if(c==g[l].sn.hex)return g[l];return null},this.getSignatureValueHex=function(){return a(this.hex,0,[2],"03",!0)},this.verifySignature=function(c){var g=this.getSignatureAlgorithmField(),l=this.getSignatureValueHex(),v=o(this.hex,0,[0],"30"),y=new u.crypto.Signature({alg:g});return y.init(c),y.updateHex(v),y.verify(l)},this.getParam=function(c){var g={},l=this.getVersion();l!=null&&(g.version=l),g.sigalg=this.getSignatureAlgorithmField(),g.issuer=this.getIssuer(),g.thisupdate=this.getThisUpdate();var v=this.getNextUpdate();v!=null&&(g.nextupdate=v);var y=this.getRevCertArray();y!=null&&(g.revcert=y);var x=m(this.hex,0,[0,"[0]"]);if(x!=-1){var E=f(this.hex,0,[0,"[0]",0]);g.ext=h.getExtParamArray(E)}return g.sighex=this.getSignatureValueHex(),this.parsed=g,typeof c=="object"&&(c.tbshex==!0&&(g.tbshex=o(this.hex,0,[0])),c.nodnarray==!0&&delete g.issuer.array),g},typeof e=="string"&&(r(e)?this.hex=e:e.match(/-----BEGIN X509 CRL/)&&(this.hex=me(e)),this._setPos())};(typeof u>"u"||!u)&&(u={});(typeof u.jws>"u"||!u.jws)&&(u.jws={});u.jws.JWS=function(){var e=u,t=e.jws.JWS,r=t.isSafeJSONString;this.parseJWS=function(n,i){if(!(this.parsedJWS!==void 0&&(i||this.parsedJWS.sigvalH!==void 0))){var s=n.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(s==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var a=s[1],o=s[2],f=s[3],d=a+"."+o;if(this.parsedJWS={},this.parsedJWS.headB64U=a,this.parsedJWS.payloadB64U=o,this.parsedJWS.sigvalB64U=f,this.parsedJWS.si=d,!i){var m=ge(f),p=Oe(m,16);this.parsedJWS.sigvalH=m,this.parsedJWS.sigvalBI=p}var h=ut(a),c=ut(o);if(this.parsedJWS.headS=h,this.parsedJWS.payloadS=c,!r(h,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+h}}};u.jws.JWS.sign=function(e,t,r,n,i){var s=u,a=s.jws,o=a.JWS,f=o.readSafeJSONString,d=o.isSafeJSONString,m=s.crypto,p=m.ECDSA,h=m.Mac,c=m.Signature,g=JSON,l,v,y;if(typeof t!="string"&&typeof t!="object")throw"spHeader must be JSON string or object: "+t;if(typeof t=="object"&&(v=t,l=g.stringify(v)),typeof t=="string"){if(l=t,!d(l))throw"JWS Head is not safe JSON string: "+l;v=f(l)}if(y=r,typeof r=="object"&&(y=g.stringify(r)),(e==""||e==null)&&v.alg!==void 0&&(e=v.alg),e!=""&&e!=null&&v.alg===void 0&&(v.alg=e,l=g.stringify(v)),e!==v.alg)throw"alg and sHeader.alg doesn't match: "+e+"!="+v.alg;var x=null;if(o.jwsalg2sigalg[e]===void 0)throw"unsupported alg name: "+e;x=o.jwsalg2sigalg[e];var E=Kr(l),P=Kr(y),b=E+"."+P,R="";if(x.substr(0,4)=="Hmac"){if(n===void 0)throw"mac key shall be specified for HS* alg";var T=new h({alg:x,prov:"cryptojs",pass:n});T.updateString(b),R=T.doFinal()}else if(x.indexOf("withECDSA")!=-1){var S=new c({alg:x});S.init(n,i),S.updateString(b);var w=S.sign();R=u.crypto.ECDSA.asn1SigToConcatSig(w)}else if(x!="none"){var S=new c({alg:x});S.init(n,i),S.updateString(b),R=S.sign()}var A=Pe(R);return b+"."+A};u.jws.JWS.verify=function(e,t,r){var n=u,i=n.jws,s=i.JWS,a=s.readSafeJSONString,o=n.crypto,f=o.ECDSA,d=o.Mac,m=o.Signature,p;if(typeof W!==void 0&&(p=W),!zi(e))return!1;var h=e.split(".");if(h.length!==3)return!1;var c=h[0],g=h[1],l=c+"."+g,v=ge(h[2]),y=a(ut(h[0])),x=null,E=null;if(y.alg===void 0)throw"algorithm not specified in header";if(x=y.alg,E=x.substr(0,2),r!=null&&Object.prototype.toString.call(r)==="[object Array]"&&r.length>0){var P=":"+r.join(":")+":";if(P.indexOf(":"+x+":")==-1)throw"algorithm '"+x+"' not accepted in the list"}if(x!="none"&&t===null)throw"key shall be specified to verify.";if(typeof t=="string"&&t.indexOf("-----BEGIN ")!=-1&&(t=Z.getKey(t)),(E=="RS"||E=="PS")&&!(t instanceof p))throw"key shall be a RSAKey obj for RS* and PS* algs";if(E=="ES"&&!(t instanceof f))throw"key shall be a ECDSA obj for ES* algs";x=="none";var b=null;if(s.jwsalg2sigalg[y.alg]===void 0)throw"unsupported alg name: "+x;if(b=s.jwsalg2sigalg[x],b=="none")throw"not supported";if(b.substr(0,4)=="Hmac"){var R=null;if(t===void 0)throw"hexadecimal key shall be specified for HMAC";var T=new d({alg:b,pass:t});return T.updateString(l),R=T.doFinal(),v==R}else if(b.indexOf("withECDSA")!=-1){var S=null;try{S=f.concatSigToASN1Sig(v)}catch{return!1}var w=new m({alg:b});return w.init(t),w.updateString(l),w.verify(S)}else{var w=new m({alg:b});return w.init(t),w.updateString(l),w.verify(v)}};u.jws.JWS.parse=function(e){var t=e.split("."),r={},n,i,s;if(t.length!=2&&t.length!=3)throw"malformed sJWS: wrong number of '.' splitted elements";return n=t[0],i=t[1],t.length==3&&(s=t[2]),r.headerObj=u.jws.JWS.readSafeJSONString(ut(n)),r.payloadObj=u.jws.JWS.readSafeJSONString(ut(i)),r.headerPP=JSON.stringify(r.headerObj,null,"  "),r.payloadObj==null?r.payloadPP=ut(i):r.payloadPP=JSON.stringify(r.payloadObj,null,"  "),s!==void 0&&(r.sigHex=ge(s)),r};u.jws.JWS.verifyJWT=function(e,t,r){var n=u,i=n.jws,s=i.JWS,a=s.readSafeJSONString,o=s.inArray,f=s.includedArray;if(!zi(e))return!1;var d=e.split(".");if(d.length!=3)return!1;var m=d[0],p=d[1],h=m+"."+p,c=ge(d[2]),g=a(ut(m)),l=a(ut(p));if(g.alg===void 0)return!1;if(r.alg===void 0)throw"acceptField.alg shall be specified";if(!o(g.alg,r.alg)||l.iss!==void 0&&typeof r.iss=="object"&&!o(l.iss,r.iss)||l.sub!==void 0&&typeof r.sub=="object"&&!o(l.sub,r.sub))return!1;if(l.aud!==void 0&&typeof r.aud=="object"){if(typeof l.aud=="string"){if(!o(l.aud,r.aud))return!1}else if(typeof l.aud=="object"&&!f(l.aud,r.aud))return!1}var v=i.IntDate.getNow();return r.verifyAt!==void 0&&typeof r.verifyAt=="number"&&(v=r.verifyAt),(r.gracePeriod===void 0||typeof r.gracePeriod!="number")&&(r.gracePeriod=0),!(l.exp!==void 0&&typeof l.exp=="number"&&l.exp+r.gracePeriod<v||l.nbf!==void 0&&typeof l.nbf=="number"&&v<l.nbf-r.gracePeriod||l.iat!==void 0&&typeof l.iat=="number"&&v<l.iat-r.gracePeriod||l.jti!==void 0&&r.jti!==void 0&&l.jti!==r.jti||!s.verify(e,t,r.alg))};u.jws.JWS.includedArray=function(e,t){var r=u.jws.JWS.inArray;if(e===null||typeof e!="object"||typeof e.length!="number")return!1;for(var n=0;n<e.length;n++)if(!r(e[n],t))return!1;return!0};u.jws.JWS.inArray=function(e,t){if(t===null||typeof t!="object"||typeof t.length!="number")return!1;for(var r=0;r<t.length;r++)if(t[r]==e)return!0;return!1};u.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",ES512:"SHA512withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"};u.jws.JWS.isSafeJSONString=function(e,t,r){var n=null;try{return n=Ta(e),typeof n!="object"||n.constructor===Array?0:(t&&(t[r]=n),1)}catch{return 0}};u.jws.JWS.readSafeJSONString=function(e){var t=null;try{return t=Ta(e),typeof t!="object"||t.constructor===Array?null:t}catch{return null}};u.jws.JWS.getEncodedSignatureValueFromJWS=function(e){var t=e.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(t==null)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return t[1]};u.jws.JWS.getJWKthumbprint=function(e){if(e.kty!=="RSA"&&e.kty!=="EC"&&e.kty!=="oct")throw"unsupported algorithm for JWK Thumprint";var t="{";if(e.kty==="RSA"){if(typeof e.n!="string"||typeof e.e!="string")throw"wrong n and e value for RSA key";t+='"e":"'+e.e+'",',t+='"kty":"'+e.kty+'",',t+='"n":"'+e.n+'"}'}else if(e.kty==="EC"){if(typeof e.crv!="string"||typeof e.x!="string"||typeof e.y!="string")throw"wrong crv, x and y value for EC key";t+='"crv":"'+e.crv+'",',t+='"kty":"'+e.kty+'",',t+='"x":"'+e.x+'",',t+='"y":"'+e.y+'"}'}else if(e.kty==="oct"){if(typeof e.k!="string")throw"wrong k value for oct(symmetric) key";t+='"kty":"'+e.kty+'",',t+='"k":"'+e.k+'"}'}var r=et(t),n=u.crypto.Util.hashHex(r,"sha256"),i=Pe(n);return i};u.jws.IntDate={};u.jws.IntDate.get=function(e){var t=u.jws.IntDate,r=t.getNow,n=t.getZulu;if(e=="now")return r();if(e=="now + 1hour")return r()+60*60;if(e=="now + 1day")return r()+60*60*24;if(e=="now + 1month")return r()+60*60*24*30;if(e=="now + 1year")return r()+60*60*24*365;if(e.match(/Z$/))return n(e);if(e.match(/^[0-9]+$/))return parseInt(e);throw"unsupported format: "+e};u.jws.IntDate.getZulu=function(e){return Ma(e)};u.jws.IntDate.getNow=function(){var e=~~(new Date/1e3);return e};u.jws.IntDate.intDate2UTCString=function(e){var t=new Date(e*1e3);return t.toUTCString()};u.jws.IntDate.intDate2Zulu=function(e){var t=new Date(e*1e3),r=("0000"+t.getUTCFullYear()).slice(-4),n=("00"+(t.getUTCMonth()+1)).slice(-2),i=("00"+t.getUTCDate()).slice(-2),s=("00"+t.getUTCHours()).slice(-2),a=("00"+t.getUTCMinutes()).slice(-2),o=("00"+t.getUTCSeconds()).slice(-2);return r+n+i+s+a+o+"Z"};(typeof u>"u"||!u)&&(u={});(typeof u.jws>"u"||!u.jws)&&(u.jws={});u.jws.JWSJS=function(){var e=u,t=e.jws,r=t.JWS,n=r.readSafeJSONString;this.aHeader=[],this.sPayload="",this.aSignature=[],this.init=function(){this.aHeader=[],this.sPayload=void 0,this.aSignature=[]},this.initWithJWS=function(i){this.init();var s=i.split(".");if(s.length!=3)throw"malformed input JWS";this.aHeader.push(s[0]),this.sPayload=s[1],this.aSignature.push(s[2])},this.addSignature=function(i,s,a,o){if(this.sPayload===void 0||this.sPayload===null)throw"there's no JSON-JS signature to add.";var f=this.aHeader.length;if(this.aHeader.length!=this.aSignature.length)throw"aHeader.length != aSignature.length";try{var d=u.jws.JWS.sign(i,s,this.sPayload,a,o),m=d.split("."),p=m[0],h=m[2];this.aHeader.push(m[0]),this.aSignature.push(m[2])}catch(c){throw this.aHeader.length>f&&this.aHeader.pop(),this.aSignature.length>f&&this.aSignature.pop(),"addSignature failed: "+c}},this.verifyAll=function(i){if(this.aHeader.length!==i.length||this.aSignature.length!==i.length)return!1;for(var s=0;s<i.length;s++){var a=i[s];if(a.length!==2)return!1;var o=this.verifyNth(s,a[0],a[1]);if(o===!1)return!1}return!0},this.verifyNth=function(i,s,a){if(this.aHeader.length<=i||this.aSignature.length<=i)return!1;var o=this.aHeader[i],f=this.aSignature[i],d=o+"."+this.sPayload+"."+f,m=!1;try{m=r.verify(d,s,a)}catch{return!1}return m},this.readJWSJS=function(i){if(typeof i=="string"){var s=n(i);if(s==null)throw"argument is not safe JSON object string";this.aHeader=s.headers,this.sPayload=s.payload,this.aSignature=s.signatures}else try{if(i.headers.length>0)this.aHeader=i.headers;else throw"malformed header";if(typeof i.payload=="string")this.sPayload=i.payload;else throw"malformed signatures";if(i.signatures.length>0)this.aSignature=i.signatures;else throw"malformed signatures"}catch(a){throw"malformed JWS-JS JSON object: "+a}},this.getJSON=function(){return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}},this.isEmpty=function(){return this.aHeader.length==0?1:0}};V.SecureRandom=Kt;V.rng_seed_time=qi;V.BigInteger=B;V.RSAKey=W;V.ECDSA=u.crypto.ECDSA;V.DSA=u.crypto.DSA;V.Signature=u.crypto.Signature;V.MessageDigest=u.crypto.MessageDigest;V.Mac=u.crypto.Mac;V.Cipher=u.crypto.Cipher;V.KEYUTIL=Z;V.ASN1HEX=K;V.X509=X;V.X509CRL=l1;V.CryptoJS=q;V.b64tohex=dr;V.b64toBA=Da;V.ECFieldElementFp=Ae;V.ECPointFp=ne;V.ECCurveFp=Dt;V.stoBA=Oa;V.BAtos=Ha;V.BAtohex=Nn;V.stohex=Ge;V.stob64=zl;V.stob64u=Wl;V.b64utos=Xl;V.b64tob64u=lr;V.b64utob64=qr;V.hex2b64=It;V.hextob64u=Pe;V.b64utohex=ge;V.utf8tob64u=Kr;V.b64utoutf8=ut;V.utf8tob64=Jl;V.b64toutf8=$l;V.utf8tohex=Tn;V.hextoutf8=ae;V.hextorstr=He;V.rstrtohex=et;V.hextob64=Li;V.hextob64nl=Ql;V.b64nltohex=ja;V.hextopem=Te;V.pemtohex=me;V.hextoArrayBuffer=r1;V.ArrayBuffertohex=n1;V.zulutomsec=ki;V.msectozulu=i1;V.zulutosec=Ma;V.zulutodate=s1;V.datetozulu=a1;V.uricmptohex=Hn;V.hextouricmp=jn;V.ipv6tohex=Oi;V.hextoipv6=Hi;V.hextoip=In;V.iptohex=Ui;V.ucs2hextoutf8=Gi;V.encodeURIComponentAll=Mn;V.newline_toUnix=o1;V.newline_toDos=u1;V.hextoposhex=ji;V.intarystrtohex=c1;V.strdiffidx=h1;V.oidtohex=qa;V.hextooid=Kn;V.strpad=Dn;V.bitstrtoint=ka;V.inttobitstr=Ua;V.bitstrtobinstr=Ga;V.binstrtobitstr=f1;V.isBase64URLDot=zi;V.namearraytobinstr=Rn;V.extendClass=H;V.foldnl=On;V.b64topem=e1;V.pemtob64=t1;V.timeogen=Ka;V.aryval=he;V.inttohex=La;V.twoscompl=Lr;V.KJUR=u;V.crypto=u.crypto;V.asn1=u.asn1;V.jws=u.jws;V.lang=u.lang;V.VERSION=lh;V.VERSION_FULL=dh});var Ya=$(Ce=>{j();M();var d1=Ce&&Ce.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),g1=Ce&&Ce.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),p1=Ce&&Ce.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&d1(t,e,r);return g1(t,e),t};Object.defineProperty(Ce,"__esModule",{value:!0});Ce.GenRSAKeyPair=Ce.decodeRsaPublicKey=Ce.decodeRsaPrivateKey=Ce.RSADecode=Ce.RSAEncode=void 0;var Rt=p1(Wi()),St=dt();function v1(e,t){try{let r=$a(t),n=Rt.KJUR.crypto.Cipher.encrypt(e,r,"RSAOAEP256");return Rt.hextob64(n)}catch(r){throw new St.MPCError(St.RSAEncodeError,r)}}Ce.RSAEncode=v1;function y1(e,t){try{let r=Ja(t),n=Rt.b64tohex(e);return Rt.KJUR.crypto.Cipher.decrypt(n,r,"RSAOAEP256")}catch(r){throw new St.MPCError(St.RSADecodeError,r)}}Ce.RSADecode=y1;function Ja(e){try{let t=`-----BEGIN RSA PRIVATE KEY-----
`+e+"-----END RSA PRIVATE KEY-----";return Rt.KEYUTIL.getKey(t,"PKCS1PRV")}catch(t){throw new St.MPCError(St.DecodeRSAPrivateKeyError,t)}}Ce.decodeRsaPrivateKey=Ja;function $a(e){try{let t=`-----BEGIN PUBLIC KEY-----
`+e+"-----END PUBLIC KEY-----";return Rt.KEYUTIL.getKey(t)}catch(t){throw new St.MPCError(St.DecodeRsaPublicKeyError,t)}}Ce.decodeRsaPublicKey=$a;function m1(){try{let e=Rt.KEYUTIL.generateKeypair("RSA",1024),t=Rt.KEYUTIL.getPEM(e.prvKeyObj,"PKCS1PRV"),r=Rt.KEYUTIL.getPEM(e.pubKeyObj),n=t.split(`\r
`),i=r.split(`\r
`),s="",a="";for(let o=0;o<n.length;o++){let f=n[o];f==="-----BEGIN RSA PRIVATE KEY-----"||f==="-----END RSA PRIVATE KEY-----"||(s+=f)}for(let o=0;o<i.length;o++){let f=i[o];f==="-----BEGIN PUBLIC KEY-----"||f==="-----END PUBLIC KEY-----"||(a+=f)}return[s,a]}catch(e){throw new St.MPCError(St.GenRSAKeyPairError,e)}}Ce.GenRSAKeyPair=m1});var Qa=$(tt=>{j();M();var S1=tt&&tt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),x1=tt&&tt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),w1=tt&&tt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&S1(t,e,r);return x1(t,e),t};Object.defineProperty(tt,"__esModule",{value:!0});tt.AESDecrypt=tt.AESEncrypt=void 0;var Bt=w1(ni()),Za=Fn(),Vn=dt();function E1(e,t){try{let r=(0,Za.md5)(t),n=Bt.enc.Utf8.parse(r);return Bt.AES.encrypt(e,n,{iv:n,mode:Bt.mode.CBC,padding:Bt.pad.Pkcs7}).toString()}catch(r){throw new Vn.MPCError(Vn.AESEncryptError,r)}}tt.AESEncrypt=E1;function b1(e,t){try{let r=(0,Za.md5)(t),n=Bt.enc.Utf8.parse(r);return Bt.AES.decrypt(e,n,{iv:n,mode:Bt.mode.CBC,padding:Bt.pad.Pkcs7}).toString(Bt.enc.Utf8)}catch(r){throw new Vn.MPCError(Vn.AESDecryptError,r)}}tt.AESDecrypt=b1});var to=$(kn=>{j();M();Object.defineProperty(kn,"__esModule",{value:!0});kn.bip32Derive=void 0;var eo=Re(),P1=dn(),A1=xi(),qn=ot(),Ln=dt();async function F1(e,t,r,n,i){try{if(r.Curve===qn.CurveName.Secp256k1){let[s,a]=await C1(e,t,r.toEcdsaPoint(),n,i);return Promise.resolve([s,qn.ECPoint.fromEcdsaPoint(a)])}else if(r.Curve===qn.CurveName.Ed25519){let[s,a]=await I1(e,t,r.toEd25519Point(),n);return Promise.resolve([s,qn.ECPoint.fromEd25519Point(a)])}return Promise.reject(new Ln.MPCError(Ln.Bip32DeriveError,`bip32Derive un_supported curve type: [${r.Curve}]`))}catch(s){return Promise.reject(new Ln.MPCError(Ln.Bip32DeriveError,s))}}kn.bip32Derive=F1;async function C1(e,t,r,n,i){let s=new P1.TssKey(new eo.BN(t.toString()),r,L.Buffer.from(n,"hex"));return s=await s.NewChildKey(e[0]),s=await s.NewChildKey(e[1]),s=await s.NewChildKey(e[2]),i!=null&&(s=await s.NewChildKey(i)),[BigInt(s.shareI.toString(10)),s.publicKey]}async function I1(e,t,r,n){let i=new A1.TssKey(new eo.BN(t.toString()),r,L.Buffer.from(n,"hex"));return i=await i.NewChildKey(e[0]),i=await i.NewChildKey(e[1]),i=await i.NewChildKey(e[2]),[BigInt(i.shareI.toString(10)),i.publicKey]}});var Xi=$(Je=>{j();M();var D1=Je&&Je.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Zt=Je&&Je.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&D1(t,e,r)};Object.defineProperty(Je,"__esModule",{value:!0});Zt(Sa(),Je);Zt(wa(),Je);Zt(ba(),Je);Zt(Ya(),Je);Zt(Qa(),Je);Zt(to(),Je);Zt(Fn(),Je)});var ro=$(Gn=>{j();M();Object.defineProperty(Gn,"__esModule",{value:!0});Gn.PedersenParameters=void 0;var Un=(yn(),lt(vn)),kr=class{constructor(t,r,n){this.S=t,this.T=r,this.Ntilde=n}static async NewPedersenParameters(){let t=24080463838836201080652082632305534732002063580868256837038210994857729586600268211801279564303369693950429682190326566093932573855509453567393841648357081821880053752774170718047382946252536000678870735515855163646754581081435553356222873770351932852227834667536288582125296651398663163648979543718769199804146918220464587326136530135286945735587984838293187128267423286364628812794385921668573124571396250799658461906690728456458650228465312865048432010152190862532689545798727242877158647292465531176377500682726348426989332482863616802427143787375284653058516335361011466118712811309500705785525375482092098963097n,r=3969445706491109142504463761757113181243720789927116177071520922075525103482617922906331624855888956328960525194513254320803314863178743526851561817509828829014160418629634938441455784583112125465764928720574665390156185396679649272387565016698159745106440263736311759353449267253427424326566011948150894938620330116124058453568512487633908317746279061077639294887980762568955530152514368105906737713994609570534667642479638349602421006214098814038802561220441092513322886567020060969058638935878546693061106757943434742074861416747299644165447889875592530645696214475164899537461943948958136027895218376240993342673n,n=13469185658727475035931073279550075030057497136872025477242105309462997417546940639217444818113817898323930497326722071401088281046063589760494766301417922508037554444807983479412495341757134204363059411424555694916349689713120515929919936432986593339122531838276046180495264783565315603443986101974283074727281432196871144636171331980926684638343639398221779004000968880059122234209774426712142116396474765406158933809440842904102096045102577802122569204376459489609991759029760310331107566518614976666732556835318392772320945696543239652277734046054967196610265022261270041776733838263923439736476965782219187765549n;return new kr(r,n,t)}Commit(t,r){let n=(0,Un.modPow)(this.S,t,this.Ntilde),i=(0,Un.modPow)(this.T,r,this.Ntilde);return n*i%this.Ntilde}Open(t,r,n){let i=(0,Un.modPow)(this.S,r,this.Ntilde),s=(0,Un.modPow)(this.T,n,this.Ntilde);return i*s%this.Ntilde===t}};Gn.PedersenParameters=kr});var so=$(zn=>{j();M();Object.defineProperty(zn,"__esModule",{value:!0});zn.ecdsaSign=void 0;var vr=ot(),no=Ue(),io=Re(),R1=ro(),Ur=new Map;async function B1(e){let t={},r=new Map,n=await R1.PedersenParameters.NewPedersenParameters();for(let i of e.Messages){let s=(0,vr.GetMapKeyTssSign)(e.MpcId,i),a=e.EcdsaMessageMap.get(s);if(e.Step===vr.SignStep.Step1){let o=e.EcdsaShare,f=new vr.P2(new io.BN(o.X2.toString()),new io.BN(o.E_x1.toString()),o.PaiPubKey,o.PublicKey.toEcdsaPoint(),i,n),[d,m]=await Promise.all(f.step1(a.CmtC));r.set(s,{Proof:d,R2:vr.ECPoint.fromEcdsaPoint(m),E_x1:o.E_x1}),Ur.set(s,f)}else if(e.Step===vr.SignStep.Step2){let o=Ur.get(s),[f,d]=o.step2(a.Proof,a.Witness);r.set(s,{E_k2_h_rx:BigInt(f.toString()),AffGProof:d})}else if(e.Step==vr.SignStep.Step3){let o=Ur.get(s),f=new no.secp256k1.Signature(a.Signature.r,a.Signature.s);if(!no.secp256k1.verify(f,i,o.publicKey))throw new Error("ecdsa sign verify fail");r.set(s,{Signature:a.Signature}),Ur.delete(s)}else throw Ur.delete(s),new Error(`un supported step: ${e.Step}`)}return t.EcdsaMessageMap=r,t}zn.ecdsaSign=B1});var oo=$(Wn=>{j();M();Object.defineProperty(Wn,"__esModule",{value:!0});Wn.ed25519Sign=void 0;var Vt=ot(),ao=Ue(),Gr=new Map;async function _1(e){let t={},r=new Map;for(let n of e.Messages){let i=(0,Vt.GetMapKeyTssSign)(e.MpcId,n),s=e.Ed25519MessageMap.get(i);if(e.Step===Vt.SignStep.Step1){let a=e.Ed25519Share,o=a.PublicKey,f=new Vt.Ed25519Sign(e.DeviceNumber,a.Threshold,a.PartList,a.ShareI,o.toEd25519Point(),n),d=await f.signStep1();r.set(i,{OutputDataMap:d}),Gr.set(i,f)}else if(e.Step===Vt.SignStep.Step2){let o=await Gr.get(i).signStep2(s.TssInput);r.set(i,{OutputDataMap:o})}else if(e.Step===Vt.SignStep.Step3){let a=Gr.get(i),[o,f]=await a.signStep3(s.TssInput),m=(s.Signature.s+o+ao.ed25519.CURVE.n)%ao.ed25519.CURVE.n,[p,h]=await(0,Vt.Ed25519Verify)(new Vt.Signature(f,m),n,Vt.ECPoint.fromEd25519Point(a.publicKey));if(!h)throw new Error("ed25519 sign verify fail");r.set(i,{Signature:p}),a={},Gr.delete(i)}else throw Gr.delete(i),new Error(`un supported step: ${e.Step}`)}return t.Ed25519MessageMap=r,t}Wn.ed25519Sign=_1});var co=$(Xn=>{j();M();Object.defineProperty(Xn,"__esModule",{value:!0});Xn.Dispatch=void 0;var Ji=Xi(),uo=sr(),N1=so(),T1=oo(),O1=[Ji.DeviceNumber.P2_No,Ji.DeviceNumber.P3_No];async function H1(e){if(!O1.includes(e.DeviceNumber))throw new Error(`wrong part number: ${e.DeviceNumber}`);if(e.FuncType!==Ji.FuncType.TssSign)throw new Error(`un supported operate: ${e.FuncType}`);switch(e.CurveName){case uo.CurveName.Secp256k1:return await(0,N1.ecdsaSign)(e);case uo.CurveName.Ed25519:return(0,T1.ed25519Sign)(e);default:throw new Error(`un supported curve: ${e.CurveName}`)}}Xn.Dispatch=H1});var fo=$(qt=>{j();M();var j1=qt&&qt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),ho=qt&&qt.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&j1(t,e,r)};Object.defineProperty(qt,"__esModule",{value:!0});ho(co(),qt);ho(Xi(),qt)});var ot=$(ze=>{j();M();var M1=ze&&ze.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Jn=ze&&ze.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&M1(t,e,r)};Object.defineProperty(ze,"__esModule",{value:!0});ze.JSONBigNative=ze.JsonParseBigInt=void 0;Jn(ya(),ze);Jn(sr(),ze);Jn(fo(),ze);Jn(dt(),ze);function K1(e,t){return/\d{16,}/.test(e)&&(e=e.replace(/"(\\?[\s\S])*?"|([+\-\d.eE]{16,})/g,function(r,n,i){return i&&/^\d{16,}$/.test(i)?'"'+r+'"':r})),JSON.parse(e,t)}ze.JsonParseBigInt=K1;var V1=Ko()({useNativeBigInt:!0});ze.JSONBigNative=V1});var $i=$(yr=>{j();M();Object.defineProperty(yr,"__esModule",{value:!0});yr.EcdsaPData=yr.ShareData=void 0;var lo=Re(),$n=ot(),zr=class{constructor(t,r,n){this.shareI=t,this.publicKey=r,this.chaincode=n}static parseShareData(t){let r=(0,$n.JsonParseBigInt)(t),n=BigInt(r.ShareI.toString()),i=r.ChainCode.toString(),s=new $n.ECPoint(r.PublicKey.Curve,BigInt(r.PublicKey.X.toString()),BigInt(r.PublicKey.Y.toString()));return new zr(n,s,i)}};yr.ShareData=zr;var Wr=class{constructor(t,r,n){this.e_x1=t,this.paiPubKey=r,this.x2=n}static parseEcdsaPShare(t){let r=(0,$n.JsonParseBigInt)(t),n=BigInt(r.E_x1.toString()),i=BigInt(r.X2),s=new lo.BN(r.PaiPubKey.N.toString());return new Wr(n,new $n.PailPubKey(new lo.BN(s.toString())),i)}};yr.EcdsaPData=Wr});var Yi=$(xt=>{j();M();Object.defineProperty(xt,"__esModule",{value:!0});xt.saveContext=xt.loadContext=xt.saveAesKey=xt.loadAesKey=void 0;var go=new Map,po=new Map;function q1(e){let t=go.get(e);if(t===void 0)throw new Error("aesKey miss, please shakeHand first");return t}xt.loadAesKey=q1;function L1(e,t){go.set(e,t)}xt.saveAesKey=L1;function k1(e){let t=po.get(e);if(t===void 0)throw new Error("sign context miss, please setup first");return t}xt.loadContext=k1;function U1(e,t){po.set(e,t)}xt.saveContext=U1});var es=$(ye=>{j();M();Object.defineProperty(ye,"__esModule",{value:!0});ye.extractShare=ye.ed25519Step3=ye.ed25519Step2=ye.ed25519Step1=ye.ed25519SetUp=ye.mpcEcdsaStep3=ye.ecdsaStep3=ye.ecdsaStep2=ye.ecdsaStep1=ye.ecdsaSetUp=ye.shakeHands=void 0;var ct=Re(),Zi=$i(),Yn=Jr(),k=ot(),Ie=Yi(),G1=Vo(),z1="MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC93PS4MnSbE5pLbXFrgSjphDjG9tqnWfwxgWbaMUhvtMVvSgFhO7JVbrY2AtflD8p3bXpFMIiGOLEp6W73No77rMigEJzbfRKy/vD8YMcdvW8KaoU5b4I7kloC7ItWW+keFWvoBO7OeqlPaMEBb/gXNWlqPvT2Gz5gDfqGJz5HRQIDAQAB";function W1(e){try{let t=ct.base.toHex(ct.base.randomBytes(16));return(0,Ie.saveAesKey)(e,t),(0,k.RSAEncode)(t,z1)}catch(t){throw new k.MPCError(ct.MPCShakeHandsError,t)}}ye.shakeHands=W1;async function X1(e,t,r,n,i,s,a){try{let o;a!=null&&a.length>0?o={hash:a,raw:""}:o=await(0,Yn.getMPCRawTransaction)(i,n);let f=e,d=i,m=s,[p,,h]=Qi(t,"",r),c=[];Array.isArray(o.hash)?o.hash.forEach(x=>c.push(x)):c.push(o.hash);let g={version:k.MpcVersion.Version_v1,messages:c,path:s},l=k.JSONBigNative.stringify(g),v=(0,Ie.loadAesKey)(e),y=(0,k.AESEncrypt)(l,v);return(0,Ie.saveContext)(e,{messages:c,pShareData:h,path:m,shareData:p,currentMpcId:f,mpcRawData:o,currency:d}),Promise.resolve(y)}catch(o){return Promise.reject(new k.MPCError(ct.EcdsaSetupError,o))}}ye.ecdsaSetUp=X1;async function J1(e,t){let r=(0,Ie.loadContext)(e),n=(0,Ie.loadAesKey)(e),i=r.path,s=r.shareData,a=r.pShareData,o=r.currentMpcId,f=r.messages;try{let d=(0,k.AESDecrypt)(t,n),m=new Map(Object.entries(k.JSONBigNative.parse(d))),[p,h]=await(0,k.bip32Derive)(i,a.x2,s.publicKey,s.chaincode),c=h,g={MpcId:o,DeviceNumber:k.DeviceNumber.P2_No,CurveName:k.CurveName.Secp256k1,FuncType:k.FuncType.TssSign,Step:k.SignStep.Step1,Messages:f,EcdsaShare:{PublicKey:h,X2:p,E_x1:a.e_x1,PaiPubKey:a.paiPubKey},EcdsaMessageMap:m},l=await(0,k.Dispatch)(g),v=k.JSONBigNative.stringify(Object.fromEntries(l.EcdsaMessageMap)),y=(0,k.AESEncrypt)(v,n);return r.childPublicKey=c,r.p2Input=g,Promise.resolve(y)}catch(d){return Promise.reject(new k.MPCError(ct.EcdsaStep1Error,d))}}ye.ecdsaStep1=J1;async function $1(e,t){let r=(0,Ie.loadContext)(e),n=(0,Ie.loadAesKey)(e),i=r.p2Input;try{let s=(0,k.AESDecrypt)(t,n),a=new Map(Object.entries(k.JSONBigNative.parse(s)));i.Step=k.SignStep.Step2,i.EcdsaMessageMap=a;let o=await(0,k.Dispatch)(i),f=k.JSONBigNative.stringify(Object.fromEntries(o.EcdsaMessageMap)),d=(0,k.AESEncrypt)(f,n);return Promise.resolve(d)}catch(s){return Promise.reject(new k.MPCError(ct.EcdsaStep2Error,s))}}ye.ecdsaStep2=$1;async function Y1(e,t){let r=(0,Ie.loadContext)(e),n=r.messages,i=r.currentMpcId,s=r.mpcRawData,a=r.childPublicKey,o=r.currency;try{let f=await vo(e,t),d=[],m=[];for(let g of n){let l=(0,k.GetMapKeyTssSign)(i,g),v=f.EcdsaMessageMap.get(l).Signature;d.push("0x"+v.r.toString(16).padStart(64,"0")+v.s.toString(16).padStart(64,"0")),m.push(v.r.toString(16).padStart(64,"0")+v.s.toString(16).padStart(64,"0"))}let p=Array.isArray(s.hash)?d:d[0],h={raw:s.raw,sigs:p,publicKey:a.toHex()};if(s?.raw===""&&s?.hash!=null&&s?.hash.length>0){let g={signatures:m};return Promise.resolve(G1.json.stringify(g))}let c=await(0,Yn.getMPCTransaction)(o,h);return Promise.resolve(c.toString())}catch(f){return Promise.reject(new k.MPCError(ct.EcdsaStep3Error,f))}}ye.ecdsaStep3=Y1;async function vo(e,t){let r=(0,Ie.loadContext)(e),n=(0,Ie.loadAesKey)(e),i=r.p2Input,s=(0,k.AESDecrypt)(t,n),a=new Map(Object.entries(k.JSONBigNative.parse(s)));i.Step=k.SignStep.Step3,i.EcdsaMessageMap=a;let o=await(0,k.Dispatch)(i);return Promise.resolve(o)}ye.mpcEcdsaStep3=vo;async function Z1(e,t,r,n,i){try{let s=await(0,Yn.getMPCRawTransaction)(n,r),a=e,o=n,f=i,[,d]=Qi("",t,""),m=[];Array.isArray(s.hash)?s.hash.forEach(l=>m.push(l)):m.push(s.hash);let p={version:k.MpcVersion.Version_v1,messages:m,path:i,ed25519Share:{threshold:2,partList:[k.DeviceNumber.P1_No,k.DeviceNumber.P2_No]}},h=k.JSONBigNative.stringify(p),c=(0,Ie.loadAesKey)(e),g=(0,k.AESEncrypt)(h,c);return(0,Ie.saveContext)(e,{currency:o,currentMpcId:a,messages:m,mpcRawData:s,path:f,shareData:d}),Promise.resolve(g)}catch(s){return Promise.reject(new k.MPCError(ct.Ed25519SetupError,s))}}ye.ed25519SetUp=Z1;async function Q1(e,t){let r=(0,Ie.loadContext)(e),n=(0,Ie.loadAesKey)(e),i=r.path,s=r.currentMpcId,a=r.messages,o=r.shareData;try{let f=(0,k.AESDecrypt)(t,n),d=(0,k.cvtObjToEd25519Map)((0,k.JsonParseBigInt)(f)),[m,p]=await(0,k.bip32Derive)(i,o.shareI,o.publicKey,o.chaincode),h=p,c={MpcId:s,DeviceNumber:k.DeviceNumber.P2_No,CurveName:k.CurveName.Ed25519,FuncType:k.FuncType.TssSign,Step:k.SignStep.Step1,Messages:a,Ed25519Share:{PublicKey:p,Threshold:2,PartList:[k.DeviceNumber.P1_No,k.DeviceNumber.P2_No],ShareI:m},Ed25519MessageMap:d},g=await(0,k.Dispatch)(c),l=(0,k.bigintStringify)((0,k.cvtEd25519MapToObj)(g.Ed25519MessageMap)),v=(0,k.AESEncrypt)(l,n);return r.childPublicKey=h,r.p2Input=c,r.ed25519P1Step1=d,Promise.resolve(v)}catch(f){return Promise.reject(new k.MPCError(ct.Ed25519Step1Error,f))}}ye.ed25519Step1=Q1;async function ed(e,t){let r=(0,Ie.loadContext)(e),n=(0,Ie.loadAesKey)(e),i=r.p2Input,s=r.ed25519P1Step1;try{let a=(0,k.AESDecrypt)(t,n),o=(0,k.cvtObjToEd25519Map)((0,k.JsonParseBigInt)(a));i.Step=k.SignStep.Step2,i.Ed25519MessageMap=s;let f=await(0,k.Dispatch)(i),d=(0,k.bigintStringify)((0,k.cvtEd25519MapToObj)(f.Ed25519MessageMap)),m=(0,k.AESEncrypt)(d,n);return r.ed25519P1Step2=o,Promise.resolve(m)}catch(a){return Promise.reject(new k.MPCError(ct.Ed25519Step2Error,a))}}ye.ed25519Step2=ed;async function td(e,t){let r=(0,Ie.loadContext)(e),n=(0,Ie.loadAesKey)(e),i=r.p2Input,s=r.messages,a=r.currentMpcId,o=r.mpcRawData,f=r.childPublicKey,d=r.ed25519P1Step2,m=r.currency;try{let p=(0,k.AESDecrypt)(t,n),h=(0,k.cvtObjToEd25519Map)((0,k.JsonParseBigInt)(p));i.Step=k.SignStep.Step3,i.Ed25519MessageMap=d;for(let[x,E]of h)i.Ed25519MessageMap.get(x).Signature=h.get(x).Signature;let c=await(0,k.Dispatch)(i),g=[];for(let x of s){let E=(0,k.GetMapKeyTssSign)(a,x),P=c.Ed25519MessageMap.get(E).Signature;g.push("0x"+P.r.toString(16).padStart(64,"0")+P.s.toString(16).padStart(64,"0"))}let l=Array.isArray(o.hash)?g:g[0],v={raw:o.raw,sigs:l,publicKey:f.toHex()},y=await(0,Yn.getMPCTransaction)(m,v);return Promise.resolve(y.toString())}catch(p){return Promise.reject(new k.MPCError(ct.Ed25519Step3Error,p))}}ye.ed25519Step3=td;function Qi(e,t,r){let n,i,s;return e!==""&&(n=Zi.ShareData.parseShareData(e)),t!==""&&(i=Zi.ShareData.parseShareData(t)),r!==""&&(s=Zi.EcdsaPData.parseEcdsaPShare(r)),[n,i,s]}ye.extractShare=Qi});var So=$(Sr=>{j();M();Object.defineProperty(Sr,"__esModule",{value:!0});Sr.signMsgStep3=Sr.signMsgSetup=void 0;var ts=Re(),yo=Jr(),rs=Yi(),mo=es(),mr=ot();async function rd(e,t,r,n,i,s){try{let a=await(0,yo.getMPCRawMessage)(i,n),f=[ts.base.stripHexPrefix(a.hash)],[d,,m]=(0,mo.extractShare)(t,"",r),p={version:mr.MpcVersion.Version_v1,messages:f,path:s},h=mr.JSONBigNative.stringify(p),c=(0,rs.loadAesKey)(e),g=(0,mr.AESEncrypt)(h,c);return(0,rs.saveContext)(e,{trxParam:n.data,messages:f,pShareData:m,path:s,shareData:d,currentMpcId:e,mpcRawData:a,currency:i}),Promise.resolve(g)}catch(a){return Promise.reject(new mr.MPCError(ts.SignMsgSetupError,a))}}Sr.signMsgSetup=rd;async function nd(e,t){let r=(0,rs.loadContext)(e),n=r.messages,i=r.trxParam,s=r.currentMpcId,a=r.mpcRawData,o=r.childPublicKey,f=r.currency;try{let d=await(0,mo.mpcEcdsaStep3)(e,t),m=[];for(let c of n){let g=(0,mr.GetMapKeyTssSign)(s,c),l=d.EcdsaMessageMap.get(g).Signature;m.push("0x"+l.r.toString(16).padStart(64,"0")+l.s.toString(16).padStart(64,"0"))}let p={hash:a.hash,sigs:m[0],publicKey:o.toHex(),type:i.type,message:i.message},h=await(0,yo.getMPCSignedMessage)(f,p);return Promise.resolve(h.toString())}catch(d){return Promise.reject(new mr.MPCError(ts.SignMsgStep3Error,d))}}Sr.signMsgStep3=nd});var xo=$(rt=>{j();M();Object.defineProperty(rt,"__esModule",{value:!0});rt.mpcSignMsg=rt.mpcSignEd25519=rt.mpcSignEcdsa=rt.mpcShakeHands=rt.getMPCAddress=void 0;var ns=ot(),De=wo(),wt=Re();async function id(e,t,r,n){if(!wt.CoinCurveMap.has(r))return Promise.reject(wt.UnsupportedCoinError);let i,s=wt.CoinCurveMap.get(r);if(s===ns.CurveName.Secp256k1)[i,,]=(0,De.extractShare)(t,"","");else if(s===ns.CurveName.Ed25519)[,i]=(0,De.extractShare)("",t,"");else return Promise.reject(wt.UnsupportedCoinError);let[a,o]=await(0,ns.bip32Derive)(e,0n,i.publicKey,i.chaincode),f={publicKey:o.toHex(),hrp:n},d=await(0,De.getAddressByPublicKey)(r,f);if(wt.MultiAddressCoins.includes(r)){for(let m of d){let p={address:m.address,hrp:n};if(!await(0,De.validAddress)(r,p))return Promise.reject(wt.ValidAddressError)}return{childPublicKey:o.toHex(),multiAddress:d}}else{let m={address:d,hrp:n};return await(0,De.validAddress)(r,m)?{childPublicKey:o.toHex(),address:d}:Promise.reject(wt.ValidAddressError)}}rt.getMPCAddress=id;function sd(e){return(0,De.shakeHands)(e)}rt.mpcShakeHands=sd;async function ad(e){switch(e.step){case 0:return await(0,De.ecdsaSetUp)(e.mpcId,e.share,e.pShare,e.txParams,e.currency,e.path,e.signHashList);case 1:return await(0,De.ecdsaStep1)(e.mpcId,e.serverData);case 2:return await(0,De.ecdsaStep2)(e.mpcId,e.serverData);case 3:return await(0,De.ecdsaStep3)(e.mpcId,e.serverData);default:return Promise.reject(wt.MPCStepError)}}rt.mpcSignEcdsa=ad;async function od(e){switch(e.step){case 0:return await(0,De.ed25519SetUp)(e.mpcId,e.share,e.txParams,e.currency,e.path);case 1:return await(0,De.ed25519Step1)(e.mpcId,e.serverData);case 2:return await(0,De.ed25519Step2)(e.mpcId,e.serverData);case 3:return await(0,De.ed25519Step3)(e.mpcId,e.serverData);default:return Promise.reject(wt.MPCStepError)}}rt.mpcSignEd25519=od;async function ud(e){switch(e.step){case 0:return await(0,De.signMsgSetup)(e.mpcId,e.share,e.pShare,e.txParams,e.currency,e.path);case 1:return await(0,De.ecdsaStep1)(e.mpcId,e.serverData);case 2:return await(0,De.ecdsaStep2)(e.mpcId,e.serverData);case 3:return await(0,De.signMsgStep3)(e.mpcId,e.serverData);default:return Promise.reject(wt.MPCStepError)}}rt.mpcSignMsg=ud});var is=$(Et=>{j();M();Object.defineProperty(Et,"__esModule",{value:!0});Et.isHexPrefixed=Et.stripHexPrefix=Et.fromHex=Et.toHex=void 0;function cd(e,t=!1){let r=L.Buffer.from(e);return t?"0x"+r.toString("hex"):r.toString("hex")}Et.toHex=cd;function hd(e){return e.startsWith("0x")&&(e=e.substring(2)),L.Buffer.from(e,"hex")}Et.fromHex=hd;function fd(e){return e.startsWith("0x")?e.substring(2):e}Et.stripHexPrefix=fd;function ld(e){return e.startsWith("0x")}Et.isHexPrefixed=ld});var ss=$(xr=>{j();M();Object.defineProperty(xr,"__esModule",{value:!0});xr.fromBase64=xr.toBase64=void 0;var Eo=Mo();function dd(e){let t=L.Buffer.from(e);return Eo.base64.encode(Uint8Array.from(t))}xr.toBase64=dd;function gd(e){return Eo.base64.decode(e)}xr.fromBase64=gd});var bo=$(nt=>{j();M();var pd=nt&&nt.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),vd=nt&&nt.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),yd=nt&&nt.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&pd(t,e,r);return vd(t,e),t};Object.defineProperty(nt,"__esModule",{value:!0});nt.decrypt=nt.encrypt=void 0;var _t=yd(ni());function md(e,t){let r=_t.enc.Utf8.parse(t);return _t.AES.encrypt(e,r,{iv:r,mode:_t.mode.CBC,padding:_t.pad.Pkcs7}).toString()}nt.encrypt=md;function Sd(e,t){let r=_t.enc.Utf8.parse(t);return _t.AES.decrypt(e,r,{iv:r,mode:_t.mode.CBC,padding:_t.pad.Pkcs7}).toString(_t.enc.Utf8)}nt.decrypt=Sd});var Ao=$(le=>{j();M();var xd=le&&le.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),wd=le&&le.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Ed=le&&le.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&xd(t,e,r);return wd(t,e),t};Object.defineProperty(le,"__esModule",{value:!0});le.wrapPEM=le.unwrapPEM=le.covertPublicKeyFromPkcs8ToPkcs1=le.covertPublicKeyFromPkcs8ToPkix=le.genKeyPair=le.decodeAny=le.encodeAny=le.decode=le.encode=void 0;var te=Ed(Wi()),bd=te.BigInteger,Zn=is(),Pd=ss();function as(e,t){let r=te.KJUR.crypto.Cipher.encrypt(e,t,"RSA");return(0,Zn.fromHex)(r)}le.encode=as;function os(e,t){return te.KJUR.crypto.Cipher.decrypt(e,t,"RSA")}le.decode=os;function Ad(e,t){let r=Dd(t),n=Math.floor((r.n.bitLength()+7)/8),i=e.length,s=0,a=n-11,o=[];for(;;){if(s+a>=i){let d=as(e.slice(s),r);o.push(d);break}let f=as(e.slice(s,s+a),r);o.push(f),s+=a}return te.hextob64((0,Zn.toHex)(L.Buffer.concat(o)))}le.encodeAny=Ad;function Fd(e,t){let r=te.RSAKey.getHexValueArrayOfChildrenFromHex(te.b64tohex(t)),n=new te.RSAKey;n.setPrivateEx(r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8]);let i=Math.floor((n.n.bitLength()+7)/8),s=(0,Pd.fromBase64)(e),a=s.length,o=0,f=[];for(;;){if(o+i>=a){let m=os((0,Zn.toHex)(s.slice(o)),n);f.push(m);break}let d=os((0,Zn.toHex)(s.slice(o,o+i)),n);f.push(d),o+=i}return f.join("")}le.decodeAny=Fd;function Cd(e){let t=te.KEYUTIL.generateKeypair("RSA",e),r=te.KEYUTIL.getPEM(t.prvKeyObj,"PKCS1PRV"),n=te.KEYUTIL.getPEM(t.pubKeyObj),i=Po(us(n,!0));return{privateKey:us(r,!1),publicKey:i}}le.genKeyPair=Cd;function Id(e){let t=te.KEYUTIL.getKey(cs(e,!0)),r=new te.KJUR.asn1.DERSequence({array:[new te.KJUR.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.1.1"}),new te.KJUR.asn1.DERNull]}),n=new te.KJUR.asn1.DERSequence({array:[new te.KJUR.asn1.DERInteger({bigint:t.n}),new te.KJUR.asn1.DERInteger({int:t.e})]}),i=new te.KJUR.asn1.DERBitString({hex:"00"+n.getEncodedHex()}),s=new te.KJUR.asn1.DERSequence({array:[r,i]});return te.hextob64(s.getEncodedHex())}le.covertPublicKeyFromPkcs8ToPkix=Id;function Po(e){let t=te.KEYUTIL.getKey(cs(e,!0)),r=new te.KJUR.asn1.DERSequence({array:[new te.KJUR.asn1.DERInteger({bigint:t.n}),new te.KJUR.asn1.DERInteger({int:t.e})]});return te.hextob64(r.getEncodedHex())}le.covertPublicKeyFromPkcs8ToPkcs1=Po;function Dd(e){let t=te.b64tohex(e);if(!te.ASN1HEX.isASN1HEX(t))throw new Error("keyHex is not ASN.1 hex string");let r=te.ASN1HEX.getChildIdx(t,0),n=new te.RSAKey,i=te.ASN1HEX.getV(t,r[0]);n.n=new bd(i,16);let s=te.ASN1HEX.getV(t,r[1]);return n.e=parseInt(s,16),n.isPublic=!0,n.isPrivate=!1,n}function us(e,t){let r=t?"PUBLIC KEY":"RSA PRIVATE KEY";return te.hextob64(te.pemtohex(e,r))}le.unwrapPEM=us;function cs(e,t){let r=t?"PUBLIC KEY":"RSA PRIVATE KEY";return te.hextopem(te.b64tohex(e),r)}le.wrapPEM=cs});var hs=$(je=>{j();M();var Fo=je&&je.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Rd=je&&je.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Co=je&&je.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&Fo(t,e,r)},Io=je&&je.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Fo(t,e,r);return Rd(t,e),t};Object.defineProperty(je,"__esModule",{value:!0});je.rsa=je.aes=void 0;Co(is(),je);Co(ss(),je);je.aes=Io(bo());je.rsa=Io(Ao())});var Bo=$(it=>{j();M();Object.defineProperty(it,"__esModule",{value:!0});it.RSADecodeQRCodeInfo=it.RSAEncodeQRCodeInfo=it.GenRSAKeyForQRCode=it.AesDecodeQRCodeInfo=it.AesEncodeQRCodeInfo=void 0;var fs=Re(),wr=hs(),Do=fs.base.md5.encode("1677594506944"),Bd=2048;function _d(e,t){if(e.length===0)throw new Error("message is empty");if(t.length===0)throw new Error("accountId is empty");let r=Ro(t);return wr.aes.encrypt(e,r)}it.AesEncodeQRCodeInfo=_d;function Nd(e,t){if(e.length===0)throw new Error("secret is empty");if(t.length===0)throw new Error("accountId is empty");let r=Ro(t);return wr.aes.decrypt(e,r)}it.AesDecodeQRCodeInfo=Nd;async function Td(){return Promise.resolve(wr.rsa.genKeyPair(Bd))}it.GenRSAKeyForQRCode=Td;async function Od(e,t){return Promise.resolve(wr.rsa.encodeAny(e,t))}it.RSAEncodeQRCodeInfo=Od;async function Hd(e,t){return Promise.resolve(wr.rsa.decodeAny(e,t))}it.RSADecodeQRCodeInfo=Hd;function Ro(e){let t=wr.aes.encrypt(e,fs.base.md5.encode(Do));return fs.base.md5.encode(Do+t)}});var _o=$(Qn=>{j();M();Object.defineProperty(Qn,"__esModule",{value:!0});Qn.getCoinHexKeyStringFromShareString=void 0;var ls=ot();async function jd(e,t){let r=(0,ls.JsonParseBigInt)(e),n=BigInt(r.ecdsaShare2.ShareI.toString()),i=n.toString(16);if(t&&t.length==3){let s=r.ecdsaShare2.ChainCode.toString(),a=new ls.ECPoint(r.ecdsaShare2.PublicKey.Curve,BigInt(r.ecdsaShare2.PublicKey.X.toString()),BigInt(r.ecdsaShare2.PublicKey.Y.toString())),[o,f]=await(0,ls.bip32Derive)([t[0],t[1],t[2]],n,a,s);i=o.toString(16)}return i.length%2==1&&(i="0"+i),i}Qn.getCoinHexKeyStringFromShareString=jd});var No=$(st=>{j();M();var Md=st&&st.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Er=st&&st.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&Md(t,e,r)};Object.defineProperty(st,"__esModule",{value:!0});Er(es(),st);Er(So(),st);Er(xo(),st);Er(Bo(),st);Er($i(),st);Er(_o(),st)});var To=$(ei=>{j();M();Object.defineProperty(ei,"__esModule",{value:!0});ei.getMidKey=void 0;var ds=ot(),Kd=Re();function Vd(e){return e.startsWith("0x")&&(e=e.substring(2)),L.Buffer.from(e,"hex")}async function qd(e,t){let r=(0,ds.JsonParseBigInt)(e),n=r.ecdsaShare2.PublicKey,i=r.ecdsaShare2.ChainCode,s=new ds.ECPoint(n.Curve,BigInt(n.X.toString()),BigInt(n.Y.toString())),[a,o]=await(0,ds.bip32Derive)([0,t.valueOf(),0],0n,s,i,0),f=o.toHex(),d=Vd(f);return Kd.base.sha256(d)}ei.getMidKey=qd});var wo=$(Me=>{j();M();var Oo=Me&&Me.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Ld=Me&&Me.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),ti=Me&&Me.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&Oo(t,e,r)},kd=Me&&Me.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Oo(t,e,r);return Ld(t,e),t};Object.defineProperty(Me,"__esModule",{value:!0});Me.base=void 0;ti(Jr(),Me);ti(No(),Me);ti(Re(),Me);ti(To(),Me);Me.base=kd(hs())});export default wo();
//# sourceMappingURL=dist-IDWCM2D4.js.map
