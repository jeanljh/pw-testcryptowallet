import{a as V}from"./chunk-WHMBK4MM.js";import{a as G,b as H}from"./chunk-T7OTOV53.js";import{a as S}from"./chunk-HCR7NOZ2.js";import"./chunk-JSVF3ZQH.js";import{a as K,b as O}from"./chunk-INFFKDHO.js";import"./chunk-SZVQQMYF.js";import{d as F}from"./chunk-ZDHJHPQ5.js";import{c as I}from"./chunk-A4VJP6UE.js";import{c as j}from"./chunk-SQUA6K5B.js";import"./chunk-OOYDFTEF.js";import"./chunk-JNIP4OYT.js";import"./chunk-QRAFULYC.js";import"./chunk-ITDLKQAF.js";import{b as R}from"./chunk-7MCLPJAH.js";import{wb as C}from"./chunk-GCS2RK7E.js";import"./chunk-OIPQWTNV.js";import"./chunk-VJI6MZK4.js";import"./chunk-FGAB46RQ.js";import"./chunk-47ZMUKCZ.js";import{o as se}from"./chunk-Z62JX42S.js";import{Na as ie}from"./chunk-2QHGKEME.js";import"./chunk-B624VS3G.js";import"./chunk-YDSDBRIT.js";import{a as le}from"./chunk-6PA65BO3.js";import"./chunk-OIXGC4LI.js";import"./chunk-WU2LB6XB.js";import"./chunk-GLL4BXR6.js";import"./chunk-4L5HWMAA.js";import"./chunk-EZS2GR7E.js";import"./chunk-S3FOFXM7.js";import"./chunk-YIFLUVTR.js";import"./chunk-EN2WHAVL.js";import{h as N}from"./chunk-CP2RIMI2.js";import"./chunk-3QLLFUC4.js";import"./chunk-EFOY37CC.js";import{c as m}from"./chunk-HMTT52FG.js";import"./chunk-45NMMWRA.js";import"./chunk-GR7YC6C3.js";import"./chunk-O33H5V3V.js";import"./chunk-DJN2J7J5.js";import"./chunk-35ANKHOJ.js";import"./chunk-BI4OEIFC.js";import"./chunk-COF7YKSN.js";import{D as a,K as ne,n as w}from"./chunk-VZKEX7KP.js";import"./chunk-QCEQQDCM.js";import{H as h}from"./chunk-BJKBO23H.js";import"./chunk-IO3ALUOJ.js";import"./chunk-DJSNVDZI.js";import"./chunk-K336SGW3.js";import"./chunk-XFTQD4B2.js";import"./chunk-FOOC6LB7.js";import"./chunk-DHKS44RQ.js";import"./chunk-4DBVFCYR.js";import"./chunk-2IGQWLAB.js";import{a as E}from"./chunk-GVV6OTQP.js";import{z as _}from"./chunk-ZFVABNQN.js";import"./chunk-VYWNZTTM.js";import"./chunk-LBWWOQL4.js";import"./chunk-4QGZDIBD.js";import{b as re}from"./chunk-73B6GL3S.js";import"./chunk-LVJGLJNA.js";import{b as ae}from"./chunk-Z7PBP7IJ.js";import"./chunk-5F7M5EJ4.js";import"./chunk-RNWGOGLT.js";import"./chunk-UGJ3FMEQ.js";import"./chunk-H6JAOQCX.js";import"./chunk-Z2AIGJGI.js";import"./chunk-VBZ4JSJ6.js";import"./chunk-LBYXY63E.js";import"./chunk-J6KTJ3IN.js";import"./chunk-5CQODPK7.js";import"./chunk-C5XO4JMZ.js";import"./chunk-HI3LE734.js";import"./chunk-RX4V72AK.js";import{f as k,o as g,q as v}from"./chunk-Y5OH3DDZ.js";g();v();var e=k(re()),T=k(ie()),z=k(le()),M=k(se()),b=k(ae());ne();g();v();var l={"retina-border-basic":"_retina-border-basic_11rve_1",retinaBorderBasic:"_retina-border-basic_11rve_1",container:"_container_11rve_29","img-wrapper":"_img-wrapper_11rve_32",imgWrapper:"_img-wrapper_11rve_32",pic:"_pic_11rve_38",img:"_img_11rve_32",text:"_text_11rve_46","risk-addr":"_risk-addr_11rve_57",riskAddr:"_risk-addr_11rve_57"};var W=(s,p)=>s.every(d=>d.status===p),$=s=>{let p=W(s,2),d=W(s,3);return{loading:p||d,loadingTextKey:p?"wallet_extension_approval_btn_revoking":"wallet_extension_approval_btn_approving"}},ce=()=>{let s=(0,z.useHistory)(),p=N({light:"/cdn/assets/imgs/253/4AD3248AD93516C7.png",dark:"/cdn/assets/imgs/253/4E618AEF79838D4F.png"}),d=(0,T.useDispatch)(),L=K(),{loading:P,run:x,error:Y}=(0,M.useRequest)(async()=>await L(),{manual:!0}),i=S(),u=(0,T.useSelector)(j);(0,e.useEffect)(()=>{!u&&x()},[u,x]),(0,e.useEffect)(()=>{u&&!i.length&&s.goBack()},[u,i.length]);let Z=i?.length||0;O();let B=(0,e.useCallback)(async({tokens:t,chainId:r})=>{if((0,b.isEmpty)(t))return[];let o=t.filter(c=>c.status===1).map(async({coinId:c,tokenAddress:A,approvalAddress:y,permit2Address:ee,address:te,approvalNum:oe})=>await V({address:te,chainId:r,tokenAddress:A,approvalAddress:y,permit2Address:ee,coinId:c,approvalNum:oe}));return await Promise.all(o)},[]),q=async()=>{let t=i.map(async o=>await B({tokens:o.tokens,chainId:o.chainId}));return(await Promise.all(t))?.flat()||[]},D=(0,e.useCallback)(t=>{if(t.some(o=>(0,b.isEmpty)(o))){h.error({title:a("wallet_extension_approval_toast_initiate_fail"),duration:3,showClose:!0,placement:h.DIRECTION.top});return}d(I({type:"approve",data:t})),s.push(`${C}?type=approve`)},[]),J=async({tokens:t,chainId:r})=>{let n=await B({tokens:t,chainId:r});D(n)},{revokeAllBtnLoading:U,revokeAllBtnLoadingTextKey:X}=(0,e.useMemo)(()=>{let t=i.map(o=>o?.tokens||[]).flat(),{loading:r,loadingTextKey:n}=$(t);return{revokeAllBtnLoading:r,revokeAllBtnLoadingTextKey:n}},[i]),Q=async()=>{let t=await q();D(t)};return e.default.createElement(m.Container,{loading:!1,className:l.container},e.default.createElement(F,{bordered:!1,closeable:!1}),e.default.createElement(H,{isError:!!Y,isLoading:P,reload:x},e.default.createElement(e.default.Fragment,null,e.default.createElement(m.Box,{className:l.imgWrapper},e.default.createElement(E,{src:p,pictureClassName:l.pic,className:l.img})),e.default.createElement(m.Box,{className:l.text},a("wallet_extension_approval_header_num_risky",{num:w(Z,{needZero:!1})})),e.default.createElement(m.Box,{className:l.riskAddr},a("wallet_extension_approval_label_malicious")),e.default.createElement(m.Box,null,i.map(t=>{let{projectIcon:r,projectName:n,network:o,approvalAddress:f,chainId:c}=t;if(!t?.tokens?.length)return null;let{loading:A,loadingTextKey:y}=$(t.tokens);return e.default.createElement(G,{title:n,desc:o,icon:r,btnText:a("wallet_extension_approval_btn_revoke"),btnLoading:A,key:`${f}-${c}`,btnLoadingText:a(y),btnClick:async()=>{await J({tokens:t.tokens,chainId:c})}})})),e.default.createElement(R.FooterActions,{zIndex:"100000"},e.default.createElement(_,{loading:U,loadingText:a(X),category:_.CATEGORY.fill,type:_.TYPE.highlight,size:_.SIZE.lg,onClick:Q},a("wallet_extension_approval_btn_revoke_all"))))))},Fe=ce;export{Fe as default};
//# sourceMappingURL=RiskApprovePage-UZDUSMJE.js.map
