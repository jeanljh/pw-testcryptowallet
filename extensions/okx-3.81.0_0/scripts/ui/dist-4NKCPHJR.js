import{a as Ge,b as de,c as ue}from"./chunk-GFFOVUC5.js";import{a as ce}from"./chunk-O3KHH6JI.js";import{a as Ve}from"./chunk-YSKQ76UN.js";import{k as Re}from"./chunk-C5XO4JMZ.js";import"./chunk-HI3LE734.js";import"./chunk-RX4V72AK.js";import{c as l,o as c,q as d}from"./chunk-Y5OH3DDZ.js";var H=l(p=>{c();d();Object.defineProperty(p,"__esModule",{value:!0});p.decode=p.encode=p.unescape=p.escape=p.pad=void 0;var le=ce();function Z(r){return`${r}${"=".repeat(4-(r.length%4||4))}`}p.pad=Z;function he(r){return r.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}p.escape=he;function fe(r){return Z(r).replace(/-/g,"+").replace(/_/g,"/")}p.unescape=fe;function Ke(r){return he((0,le.fromByteArray)(new TextEncoder().encode(r)))}p.encode=Ke;function Qe(r){return new TextDecoder().decode((0,le.toByteArray)(Z(fe(r))))}p.decode=Qe});var ye=l(S=>{c();d();Object.defineProperty(S,"__esModule",{value:!0});S.hmac=S.HMAC=void 0;var D=Ge(),_e=de(),M=class extends _e.Hash{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,(0,D.hash)(e);let n=(0,_e.toBytes)(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return(0,D.exists)(this),this.iHash.update(e),this}digestInto(e){(0,D.exists)(this),(0,D.bytes)(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:t,iHash:n,finished:s,destroyed:i,blockLen:o,outputLen:_}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=_,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};S.HMAC=M;var Xe=(r,e,t)=>new M(r,e).update(t).digest();S.hmac=Xe;S.hmac.create=(r,e)=>new M(r,e)});var Se=l(q=>{c();d();Object.defineProperty(q,"__esModule",{value:!0});q.joseToDer=q.derToJose=void 0;var ge=ce(),we=H();function ee(r){return(r/8|0)+(r%8===0?0:1)}var Ye={ES256:ee(256),ES384:ee(384),ES512:ee(521)};function be(r){let e=Ye[r];if(e)return e;throw new Error(`Unknown algorithm "${r}"`)}var L=128,ve=0,ze=32,Ze=16,et=2,Ce=Ze|ze|ve<<6,U=et|ve<<6;function me(r){if(r instanceof Uint8Array)return r;if(typeof r=="string")return(0,ge.toByteArray)((0,we.pad)(r));throw new TypeError("ECDSA signature must be a Base64 string or a Uint8Array")}function tt(r,e){let t=me(r),n=be(e),s=n+1,i=t.length,o=0;if(t[o++]!==Ce)throw new Error('Could not find expected "seq"');let _=t[o++];if(_===(L|1)&&(_=t[o++]),i-o<_)throw new Error(`"seq" specified length of "${_}", only "${i-o}" remaining`);if(t[o++]!==U)throw new Error('Could not find expected "int" for "r"');let h=t[o++];if(i-o-2<h)throw new Error(`"r" specified length of "${h}", only "${i-o-2}" available`);if(s<h)throw new Error(`"r" specified length of "${h}", max of "${s}" is acceptable`);let y=o;if(o+=h,t[o++]!==U)throw new Error('Could not find expected "int" for "s"');let a=t[o++];if(i-o!==a)throw new Error(`"s" specified length of "${a}", expected "${i-o}"`);if(s<a)throw new Error(`"s" specified length of "${a}", max of "${s}" is acceptable`);let u=o;if(o+=a,o!==i)throw new Error(`Expected to consume entire array, but "${i-o}" bytes remain`);let Y=n-h,z=n-a,x=new Uint8Array(Y+h+z+a);for(o=0;o<Y;++o)x[o]=0;x.set(t.subarray(y+Math.max(-Y,0),y+h),o),o=n;for(let Fe=o;o<Fe+z;++o)x[o]=0;return x.set(t.subarray(u+Math.max(-z,0),u+a),o),(0,we.escape)((0,ge.fromByteArray)(x))}q.derToJose=tt;function pe(r,e,t){let n=0;for(;e+n<t&&r[e+n]===0;)++n;return r[e+n]>=L&&--n,n}function rt(r,e){r=me(r);let t=be(e),n=r.length;if(n!==t*2)throw new TypeError(`"${e}" signatures must be "${t*2}" bytes, saw "${n}"`);let s=pe(r,0,t),i=pe(r,t,r.length),o=t-s,_=t-i,h=1+1+o+1+1+_,y=h<L,a=new Uint8Array((y?2:3)+h),u=0;return a[u++]=Ce,y?a[u++]=h:(a[u++]=L|1,a[u++]=h&255),a[u++]=U,a[u++]=o,s<0?(a[u++]=0,a.set(r.subarray(0,t),u),u+=t):(a.set(r.subarray(s,t),u),u+=t-s),a[u++]=U,a[u++]=_,i<0?(a[u++]=0,a.set(r.subarray(t),u)):a.set(r.subarray(t+i),u),a}q.joseToDer=rt});var B=l(O=>{c();d();Object.defineProperty(O,"__esModule",{value:!0});O.InvalidTokenError=O.MissingParametersError=void 0;var te=class extends Error{constructor(e){super(),this.name="MissingParametersError",this.message=e||""}};O.MissingParametersError=te;var re=class extends Error{constructor(e){super(),this.name="InvalidTokenError",this.message=e||""}};O.InvalidTokenError=re});var Oe=l(J=>{c();d();Object.defineProperty(J,"__esModule",{value:!0});J.SECP256K1Client=void 0;var nt=ye(),st=ue(),k=Ve(),Pe=Se(),Ee=B(),qe=de();k.utils.hmacSha256Sync=(r,...e)=>{let t=nt.hmac.create(st.sha256,r);return e.forEach(n=>t.update(n)),t.digest()};var $=class{static derivePublicKey(e,t=!0){return e.length===66&&(e=e.slice(0,64)),e.length<64&&(e=e.padStart(64,"0")),(0,qe.bytesToHex)(k.getPublicKey(e,t))}static signHash(e,t,n="jose"){if(!e||!t)throw new Ee.MissingParametersError("a signing input hash and private key are all required");let s=k.signSync(e,t.slice(0,64),{der:!0,canonical:!1});if(n==="der")return(0,qe.bytesToHex)(s);if(n==="jose")return(0,Pe.derToJose)(s,"ES256");throw Error("Invalid signature format")}static loadSignature(e){return(0,Pe.joseToDer)(e,"ES256")}static verifyHash(e,t,n){if(!e||!t||!n)throw new Ee.MissingParametersError("a signing input hash, der signature, and public key are all required");return k.verify(t,e,n,{strict:!1})}};J.SECP256K1Client=$;$.algorithmName="ES256K"});var W=l(j=>{c();d();Object.defineProperty(j,"__esModule",{value:!0});j.cryptoClients=j.SECP256K1Client=void 0;var je=Oe();Object.defineProperty(j,"SECP256K1Client",{enumerable:!0,get:function(){return je.SECP256K1Client}});var ot={ES256K:je.SECP256K1Client};j.cryptoClients=ot});var ne=l(C=>{c();d();var it=C&&C.__awaiter||function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function _(a){try{y(n.next(a))}catch(u){o(u)}}function h(a){try{y(n.throw(a))}catch(u){o(u)}}function y(a){a.done?i(a.value):s(a.value).then(_,h)}y((n=n.apply(r,e||[])).next())})};Object.defineProperty(C,"__esModule",{value:!0});C.hashSha256Async=C.hashSha256=void 0;var at=ue();function Te(r){return(0,at.sha256)(r)}C.hashSha256=Te;function ct(r){return it(this,void 0,void 0,function*(){try{if(typeof crypto<"u"&&typeof crypto.subtle<"u"){let t=typeof r=="string"?new TextEncoder().encode(r):r,n=yield crypto.subtle.digest("SHA-256",t);return new Uint8Array(n)}else{let t=Re();if(!t.createHash)throw new Error("`crypto` module does not contain `createHash`");return Promise.resolve(t.createHash("sha256").update(r).digest())}}catch(e){return console.log(e),console.log('Crypto lib not found. Neither the global `crypto.subtle` Web Crypto API, nor the or the Node.js `require("crypto").createHash` module is available. Falling back to JS implementation.'),Promise.resolve(Te(r))}})}C.hashSha256Async=ct});var He=l(m=>{c();d();var dt=m&&m.__awaiter||function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function _(a){try{y(n.next(a))}catch(u){o(u)}}function h(a){try{y(n.throw(a))}catch(u){o(u)}}function y(a){a.done?i(a.value):s(a.value).then(_,h)}y((n=n.apply(r,e||[])).next())})};Object.defineProperty(m,"__esModule",{value:!0});m.TokenSigner=m.createUnsecuredToken=void 0;var se=H(),Ae=W(),ut=B(),xe=ne();function oe(r,e){let t=[],n=se.encode(JSON.stringify(e));t.push(n);let s=se.encode(JSON.stringify(r));return t.push(s),t.join(".")}function lt(r){return oe(r,{typ:"JWT",alg:"none"})+"."}m.createUnsecuredToken=lt;var ie=class{constructor(e,t){if(!(e&&t))throw new ut.MissingParametersError("a signing algorithm and private key are required");if(typeof e!="string")throw new Error("signing algorithm parameter must be a string");if(e=e.toUpperCase(),!Ae.cryptoClients.hasOwnProperty(e))throw new Error("invalid signing algorithm");this.tokenType="JWT",this.cryptoClient=Ae.cryptoClients[e],this.rawPrivateKey=t}header(e={}){let t={typ:this.tokenType,alg:this.cryptoClient.algorithmName};return Object.assign({},t,e)}sign(e,t=!1,n={}){let s=this.header(n),i=oe(e,s),o=(0,xe.hashSha256)(i);return this.createWithSignedHash(e,t,s,i,o)}signAsync(e,t=!1,n={}){return dt(this,void 0,void 0,function*(){let s=this.header(n),i=oe(e,s),o=yield(0,xe.hashSha256Async)(i);return this.createWithSignedHash(e,t,s,i,o)})}createWithSignedHash(e,t,n,s,i){let o=this.cryptoClient.signHash(i,this.rawPrivateKey);return t?{header:[se.encode(JSON.stringify(n))],payload:JSON.stringify(e),signature:[o]}:[s,o].join(".")}};m.TokenSigner=ie});var Be=l(R=>{c();d();Object.defineProperty(R,"__esModule",{value:!0});R.TokenVerifier=void 0;var ht=H(),Me=W(),ft=B(),F=ne(),ae=class{constructor(e,t){if(!(e&&t))throw new ft.MissingParametersError("a signing algorithm and public key are required");if(typeof e!="string")throw"signing algorithm parameter must be a string";if(e=e.toUpperCase(),!Me.cryptoClients.hasOwnProperty(e))throw"invalid signing algorithm";this.tokenType="JWT",this.cryptoClient=Me.cryptoClients[e],this.rawPublicKey=t}verify(e){return typeof e=="string"?this.verifyCompact(e,!1):typeof e=="object"?this.verifyExpanded(e,!1):!1}verifyAsync(e){return typeof e=="string"?this.verifyCompact(e,!0):typeof e=="object"?this.verifyExpanded(e,!0):Promise.resolve(!1)}verifyCompact(e,t){let n=e.split("."),s=n[0]+"."+n[1],i=o=>{let _=this.cryptoClient.loadSignature(n[2]);return this.cryptoClient.verifyHash(o,_,this.rawPublicKey)};if(t)return(0,F.hashSha256Async)(s).then(o=>i(o));{let o=(0,F.hashSha256)(s);return i(o)}}verifyExpanded(e,t){let n=[e.header.join("."),ht.encode(e.payload)].join("."),s=!0,i=o=>(e.signature.map(_=>{let h=this.cryptoClient.loadSignature(_);this.cryptoClient.verifyHash(o,h,this.rawPublicKey)||(s=!1)}),s);if(t)return(0,F.hashSha256Async)(n).then(o=>i(o));{let o=(0,F.hashSha256)(n);return i(o)}}};R.TokenVerifier=ae});var Ie=l(G=>{c();d();Object.defineProperty(G,"__esModule",{value:!0});G.decodeToken=void 0;var V=H();function _t(r){if(typeof r=="string"){let e=r.split("."),t=JSON.parse(V.decode(e[0])),n=JSON.parse(V.decode(e[1])),s=e[2];return{header:t,payload:n,signature:s}}else if(typeof r=="object"){if(typeof r.payload!="string")throw new Error("Expected token payload to be a base64 or json string");let e=r.payload;r.payload[0]!=="{"&&(e=V.decode(e));let t=[];return r.header.map(n=>{let s=JSON.parse(V.decode(n));t.push(s)}),{header:t,payload:JSON.parse(e),signature:r.signature}}}G.decodeToken=_t});var T=l(w=>{c();d();var yt=w&&w.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var s=Object.getOwnPropertyDescriptor(e,t);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,s)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),I=w&&w.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&yt(e,r,t)};Object.defineProperty(w,"__esModule",{value:!0});I(He(),w);I(Be(),w);I(Ie(),w);I(B(),w);I(W(),w)});var P=l(K=>{c();d();Object.defineProperty(K,"__esModule",{value:!0});K.getDefaultProvider=void 0;async function pt(){return window.BitcoinProvider}K.getDefaultProvider=pt});var Ne=l(N=>{c();d();Object.defineProperty(N,"__esModule",{value:!0});N.AddressPurposes=void 0;var gt;(function(r){r.PAYMENT="payment",r.ORDINALS="ordinals"})(gt=N.AddressPurposes||(N.AddressPurposes={}))});var De=l(b=>{c();d();var wt=b&&b.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var s=Object.getOwnPropertyDescriptor(e,t);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,s)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),bt=b&&b.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&wt(e,r,t)};Object.defineProperty(b,"__esModule",{value:!0});b.getAddress=void 0;var vt=T(),Ct=P(),mt=async r=>{let{getProvider:e=Ct.getDefaultProvider}=r,t=await e();if(!t)throw new Error("No Bitcoin wallet installed");let{purposes:n}=r.payload;if(!n)throw new Error("Address purposes are required");try{let s=(0,vt.createUnsecuredToken)(r.payload),i=await t.connect(s);r.onFinish?.(i)}catch(s){console.error("[Connect] Error during address request",s),r.onCancel?.()}};b.getAddress=mt;bt(Ne(),b)});var Le=l(E=>{c();d();Object.defineProperty(E,"__esModule",{value:!0});E.callWalletPopup=E.CallMethod=void 0;var St=T(),Pt=P(),Et;(function(r){r.SIGN_TRANSACTION="signTransaction",r.GET_ADDRESS="getAddress"})(Et=E.CallMethod||(E.CallMethod={}));var qt=async r=>{let{getProvider:e=Pt.getDefaultProvider}=r,t=await e();if(!t)throw new Error("No Bitcoin wallet installed");let{method:n}=r.payload;if(!n)throw new Error("A wallet method is required");let s=(0,St.createUnsecuredToken)(r.payload);try{let i=await t.call(s);r.onFinish?.(i)}catch(i){console.error("[Connect] Error during call request",i),r.onCancel?.()}};E.callWalletPopup=qt});var ke=l(Ue=>{c();d();Object.defineProperty(Ue,"__esModule",{value:!0})});var $e=l(v=>{c();d();var Ot=v&&v.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var s=Object.getOwnPropertyDescriptor(e,t);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,s)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),jt=v&&v.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Ot(e,r,t)};Object.defineProperty(v,"__esModule",{value:!0});v.signMessage=void 0;var Tt=T(),At=P(),xt=async r=>{let{getProvider:e=At.getDefaultProvider}=r,t=await e();if(!t)throw new Error("No Bitcoin wallet installed");let{address:n,message:s}=r.payload;if(!n)throw new Error("An address is required to sign a message");if(!s)throw new Error("A message to be signed is required");try{let i=(0,Tt.createUnsecuredToken)(r.payload),o=await t.signMessage(i);r.onFinish?.(o)}catch(i){console.error("[Connect] Error during sign message request",i),r.onCancel?.()}};v.signMessage=xt;jt(ke(),v)});var Je=l(Q=>{c();d();Object.defineProperty(Q,"__esModule",{value:!0});Q.sendBtcTransaction=void 0;var Ht=T(),Mt=P(),Bt=async r=>{let{getProvider:e=Mt.getDefaultProvider}=r,t=await e();if(!t)throw new Error("No Bitcoin wallet installed");let{recipients:n,senderAddress:s}=r.payload;if(!n||n.length===0)throw new Error("At least one recipient is required");if(!s)throw new Error("The sender address is required");try{let i=(0,Ht.createUnsecuredToken)(r.payload),o=await t.sendBtcTransaction(i);r.onFinish?.(o)}catch(i){console.error("[Connect] Error during send BTC transaction request",i),r.onCancel?.()}};Q.sendBtcTransaction=Bt});var We=l(X=>{c();d();Object.defineProperty(X,"__esModule",{value:!0});X.signTransaction=void 0;var It=T(),Nt=P(),Dt=async r=>{let{getProvider:e=Nt.getDefaultProvider}=r,t=await e();if(!t)throw new Error("No Bitcoin wallet installed");let{psbtBase64:n,inputsToSign:s}=r.payload;if(!n)throw new Error("A value for psbtBase64 representing the tx hash is required");if(!s)throw new Error("An array specifying the inputs to be signed by the wallet is required");try{let i=(0,It.createUnsecuredToken)(r.payload),o=await t.signTransaction(i);r.onFinish?.(o)}catch(i){console.error("[Connect] Error during sign transaction request",i),r.onCancel?.()}};X.signTransaction=Dt});var Ut=l(g=>{c();d();var Lt=g&&g.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var s=Object.getOwnPropertyDescriptor(e,t);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,s)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),A=g&&g.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Lt(e,r,t)};Object.defineProperty(g,"__esModule",{value:!0});A(De(),g);A(Le(),g);A(P(),g);A($e(),g);A(Je(),g);A(We(),g)});export default Ut();
//# sourceMappingURL=dist-4NKCPHJR.js.map
