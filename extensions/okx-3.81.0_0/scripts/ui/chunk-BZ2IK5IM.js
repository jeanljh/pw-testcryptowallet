import{f as T}from"./chunk-YI5V5HTO.js";import{a as ae}from"./chunk-ARK47WR5.js";import{s as me}from"./chunk-4Y52FA3V.js";import{b as G}from"./chunk-B6WLGAPL.js";import{d as ne,f as se,m as S,t as ue}from"./chunk-FGRS6VIX.js";import{$a as te,Lb as re,W as J,Za as ee,ab as oe,vd as ie}from"./chunk-INIQCRIO.js";import{a as b,c as Q}from"./chunk-ZFBXO46L.js";import{a as A}from"./chunk-6Z5HVUBK.js";import{b as j,g as z,j as V}from"./chunk-ZBDGRK4Q.js";import{F as B,I as h,a as I,ea as L,j as n,va as P}from"./chunk-XFTQD4B2.js";import{b as v}from"./chunk-73B6GL3S.js";import{f as Y,h as f,o as u,q as m}from"./chunk-Y5OH3DDZ.js";u();m();var H=Y(v());u();m();var ce=Y(v());u();m();var fe=Y(v());function de(){let o=(0,fe.useRef)(!0);return o.current?(o.current=!1,!0):o.current}var _e=(o,e)=>{let t=de();(0,ce.useEffect)(()=>t?()=>{}:o(),e)};function Ee(){let{accountStore:o,fromToStore:e}=Q(),{computedAccountId:t,address:r,setFromChainId:s,computedMultiAddresses:i}=o,{from:a,to:d,setBalanceState:p,getSwapTokenBalance:k,computedIsToAddressEqualsCurrentToAddress:F}=e,{amount:U,chainId:D}=a;(0,H.useEffect)(()=>{ue(D)&&s(D)},[D,s]),(0,H.useEffect)(()=>{k()},[t,k]),(0,H.useEffect)(()=>{p({amount:U,address:r,from:a,to:d})},[U,r,a,d,p,F]),_e(()=>{k()},[i?.targetWalletAddress])}var ge=Ee;u();m();u();m();var E={default:()=>({type:"",title:"",desc:""}),quote:o=>o.error_code===ee?T["BLACKLIST_ADDRESS"]():o?.error_code===oe?T["BUY_HONEYPOT"]():T["NETWORK_ERROR"](),sellHoneyport:()=>T["SELL_HONEYPOT"](),leverageToken:(o,e)=>T["LEVERAGE_TOKEN"](o?.tokenSymbol,e?.tokenSymbol),wrongNetwork:o=>T["UNSUPPORTED_CHAIN"]({chainName:o}),feeConfig:()=>T["FEE_CONFIG_ERROR"](),accountErrorTips:()=>T["ACCOUNT_ERROR_TIPS"](),limitRegionTips:()=>T["LIMIT_REGION"](),chainInMaintenance:o=>T["CHAIN_IN_MAINTANCE"](o)},qe={handleQuoteErrorState:({quote:o,honeypotToken:e,hasLeverageToken:t,leverageTokenPair:r=[],shouldShowLimitRegionTip:s})=>{let{quoteError:i}=o;return s?E.limitRegionTips():i?E.quote(i):o?.bestRoute?.code===te?E.sellHoneyport(e.tokenSymbol):t?E.leverageToken(r[0],r[1]):null},handleNetworkErrorState:o=>(me({type:J.SWITCH_WALLET}),E.wrongNetwork(o)),handleDefaultState:()=>E.default(),handleFeeConfigErrorState:()=>E.feeConfig(),handleFacetTokenAccountErrorState:()=>E.accountErrorTips(),handleLimitRegionErrorState:()=>E.limitRegionTips(),handleChainInMaintenance:o=>o?.toastContent?E.chainInMaintenance(o):null};u();m();u();m();P();u();m();var x=(o,e)=>({networkFeeAmount:o,networkFeeTokenSymbol:e,formattedNetworkFeeAmount:o?`${se(o)} ${e}`:"--"}),N=o=>{let{commonStore:e}=b(),{computedNowCurrencySymbol:t,currencyConversion:r}=e;return{networkFeeUsd:o,formattedNetworkFeeUsd:o?ne(r(o).toString(),t):"--"}},W=o=>{let{estimateGasFeeAmount:e,fromNativeTokenSymbol:t,estimateGasFeeAmountUsd:r,bridge:s,fromToken:i,toToken:a,crossChainFee:d,bridgeFeeUsd:p,toSwapFee:k,toNativeTokenSymbol:F,toSwapFeeUsd:U}=o||{},{estimateBridgeFeeAmountUsd:D,estimateBridgeFeeAmount:Te,bridgeName:le,bridgeLogoUrl:pe,estimateClaimFeeAmount:$,estimateClaimFeeAmountUsd:he}=s||{},q=x(d,s?.crossToToken?.tokenSymbol),Z=N(p);return{from:{chainName:i?.chainName,chainLogo:i?.chainLogoUrl,...x(e,t),...N(r)},bridge:{bridgeName:le,bridgeLogo:pe,...x(Te,t),...N(D),bridgeFeeAmount:q.networkFeeAmount,bridgeFeeTokenSymbol:q.networkFeeTokenSymbol,formattedBridgeFeeAmount:q.formattedNetworkFeeAmount,bridgeFeeUsd:Z.networkFeeUsd,formattedBridgeFeeUsd:Z.formattedNetworkFeeUsd},to:{chainName:a?.chainName,chainLogo:a?.chainLogoUrl,...x(k,F),...N(U)},claim:A.gt($,0)?{chainName:ie("swaptrade_bridge_reminder_token_claim_fee"),chainLogo:a?.chainLogoUrl,...x($,F),...N(he)}:null}},Re=()=>{let{quoteStore:o}=Q(),{quote:e}=o;return W(e?.bestRoute)},Ze=Re;u();m();P();u();m();P();u();m();P();u();m();var O=class{constructor(e,t){f(this,"percent","");f(this,"exactPercent","");f(this,"dexRouterPercent","");Object.assign(this,t),this.dexRouterPercent=e}get computedPercent(){return this.percent?S(this.percent,{needZero:!1}):""}get computedExactPercent(){let e=A.BigNumber(this.percent).multipliedBy(this.dexRouterPercent).dividedBy(100);return e.isNaN()?"":S(e.toNumber(),{needZero:!1})}};var g=class{constructor(e,t,r){f(this,"fromToken",{});f(this,"toToken",{});f(this,"dexQuoteInfoList",[]);let{fromToken:s={},toToken:i={},dexQuoteInfoList:a}=t||{};this.fromToken=s,this.toToken=i,this.dialogHeaderText=r?G(this.toToken?.tokenSymbol):`${G(this.fromToken?.tokenSymbol)}/${G(this.toToken?.tokenSymbol)}`,I(a)&&(this.dexQuoteInfoList=a.map(d=>new O(e,d)))}};var M=class{constructor(e,t){f(this,"percent","");f(this,"router","");f(this,"subRouterList",[]);f(this,"flag","");let{percent:r="",router:s="",flag:i="",subRouterList:a}=e||{};this.percent=r,this.router=s,this.flag=i,I(a)&&(this.subRouterList=a.map(d=>new g(r,d,t)))}get computedPercent(){return this.percent?S(this.percent,{needZero:!1}):""}};var R=class{constructor(e,t=!1){f(this,"data",[]);I(e)&&(this.data=e.map(r=>new M(r,t)))}};u();m();var c={DEFAULT:0,LOADING:1,DISCONNECTION:2,NO_DATA:3,SHOW_DATA:4},l={DISMISS:"0",FROM:"1",BRIDGE:"2",TO:"3"},w={IN_CHAIN:"0",CROSS_CHAIN:"1"},C={NORMAL_PERCENT:0,EXACT_PERCENT:1};var y=class{constructor(){this.fromToData={};this.setFromToData=e=>{this.fromToData=e};this.reloadQuote=null;this.setReloadQuote=e=>{this.reloadQuote=e};this.updateSmartRouterData=({isFetchQuoting:e,bestRoute:t,quoteError:r,quoteNull:s,shouldPauseQuote:i})=>{let a=t?V(t):{},d=a.commonDexInfo||{},p=i?{}:{...d,...a};this.setStatusByQuote({isFetchQuoting:e,quoteError:r,bestRoute:p,quoteNull:s,shouldPauseQuote:i}),this.updateData(p||{}),this.updateAllGasFee(p||{})};this.showEntryForPc=!1;this.setShowEntryForPc=e=>{this.showEntryForPc=e};this.isShowShowAll=!0;this.updateIsShowShowAll=(e=!1)=>{this.isShowShowAll=e};this.status=c.LOADING;this.setStatus=e=>{let r=B(c).some(s=>s===e);this.status=r?e:c.DEFAULT};this.setStatusByQuote=({isFetchQuoting:e,quoteError:t,bestRoute:r,quoteNull:s,shouldPauseQuote:i})=>{if(i){this.setStatus(c.NO_DATA);return}let{fromToStore:a}=b();if(!t&&!r&&!s&&A.BigNumber(a?.computedTypedValue).gt(0)){this.setStatus(c.LOADING);return}if(e&&this.status!==c.SHOW_DATA&&this.status!==c.NO_DATA){this.setStatus(c.LOADING);return}if(t){this.setStatus(c.DISCONNECTION);return}if(s&&h(r?.dexRouterList)&&h(r?.fromDexRouterList)&&h(r?.bridge)&&h(r?.toDexRouterToList)){this.setStatus(c.NO_DATA);return}if(!h(r?.dexRouterList)||!h(r?.fromDexRouterList)||!h(r?.bridge)||!h(r?.toDexRouterToList)){this.setStatus(c.SHOW_DATA);return}this.setStatus(c.DEFAULT)};this.percentType=C.NORMAL_PERCENT;this.switchPercentType=()=>{this.percentType=this.percentType===C.NORMAL_PERCENT?C.EXACT_PERCENT:C.NORMAL_PERCENT};this.swapType=w.IN_CHAIN;this.setSwapType=e=>{this.swapType=e};this.tokenInfo={dexRouter:{token0:{},token1:{}},fromDexRouter:{token0:{},token1:{}},bridge:{token0:{},token1:{}},toDexRouter:{token0:{},token1:{}}};this.updateTokenInfo=e=>{L(this.tokenInfo,"dexRouter",{token0:this.fromToData.from||{},token1:this.fromToData.to||{}}),L(this.tokenInfo,"fromDexRouter",{token0:{...n(e,"fromToken",{}),amountIn:n(e,"fromTokenAmount","")},token1:{...n(e,"fromSwapToTokenInfo",{}),amountOut:n(e,"bridge.bridgeAmountIn","")}}),L(this.tokenInfo,"bridge",{token0:this.isCrossBridgeOnly?{...n(e,"fromToken",{}),amountIn:n(e,"bridge.bridgeAmountIn","")}:{...n(e,"bridge.crossFromToken",{}),amountIn:n(e,"bridge.bridgeAmountIn","")},token1:this.isCrossBridgeOnly?{...n(e,"toToken",{}),amountOut:n(e,"bridge.bridgeAmountOut","")}:{...n(e,"bridge.crossToToken",{}),amountOut:n(e,"bridge.bridgeAmountOut","")}}),L(this.tokenInfo,"toDexRouter",{token0:{...n(e,"toSwapFromTokenInfo",{}),amountIn:n(e,"bridge.bridgeAmountOut","")},token1:{...n(e,"toToken",{}),amountOut:n(e,"receiveAmount","")}})};this.dexRouterList=[];this.checkDagRouter=e=>!e||!e.length?!1:e?.filter?.(t=>!t.subRouterList).length;this.setDexRouterList=e=>{let t=this.checkDagRouter(e);this.dexRouterList=t?e:new R(e).data};this.fromDexRouterList=[];this.setFromDexRouterList=e=>{this.fromDexRouterList=new R(e).data};this.toDexRouterToList=[];this.setToDexRouterToList=e=>{this.toDexRouterToList=new R(e).data};this.bridgeRouterList=[];this.setBridgeRouterList=(e,t)=>{let r=(s={},i)=>({...s,tokenSymbol:i,fromBridge:!0});this.bridgeRouterList=new R([{percent:n(t,"percent")||"100",subRouterList:[{dexQuoteInfoList:[{dexName:n(t,"bridgeName"),percent:"100",okLinkUrl:n(t,"fromPoolAddress")}],fromToken:{},toToken:r(n(t,"crossFromToken"),n(t,"fromPoolName"))},{dexQuoteInfoList:[{dexName:n(t,"bridgeName"),percent:"100",okLinkUrl:n(t,"toPoolAddress")}],fromToken:{},toToken:r(n(t,"crossToToken"),n(t,"toPoolName"))}]}],!0).data};this.checkIsManyQuote=e=>{if(e.length>1)return!1;let t=e.length>0?n(e,[0,"subRouterList"],[]):[];return t.length>1?!1:n(t,[0,"dexQuoteInfoList","length"])>5};this.checkIsFewRouter=e=>e.length===1&&n(e,[0,"subRouterList","length"])<3;this.getInfoByMenuType=e=>{if(this.swapType===w.IN_CHAIN)return{routerList:this.dexRouterList,tokenInfo:this.tokenInfo.dexRouter};switch(e){case l.FROM:return{routerList:this.fromDexRouterList,tokenInfo:this.tokenInfo.fromDexRouter};case l.BRIDGE:return{routerList:this.bridgeRouterList,tokenInfo:this.tokenInfo.bridge};case l.TO:return{routerList:this.toDexRouterToList,tokenInfo:this.tokenInfo.toDexRouter};default:return{routerList:[],tokenInfo:this.tokenInfo.dexRouter}}};this.currentMenu=l.DISMISS;this.setCurrentMenu=e=>{let r=B(l).some(s=>s===e);this.currentMenu=r?e:l.DISMISS};this.menuList=[];this.showMenuList=!0;this.isCrossBridgeOnly=!1;this.setMenuListAndCurrentMenu=(e,t,r)=>{if(!Array.isArray(e)||h(e))this.showMenuList=!1,this.isCrossBridgeOnly=!1,this.setCurrentMenu(l.DISMISS);else{this.menuList=e.map(i=>({...i,bridge:{...r}}));let s=n(e,[0,"smartRoutingMenuType"]);(!this.showMenuList||this.currentMenu===l.DISMISS||!e.some(i=>n(i,"smartRoutingMenuType")===this.currentMenu))&&this.setCurrentMenu(s),this.isCrossBridgeOnly=e.length===1&&s===l.BRIDGE&&t===w.CROSS_CHAIN,this.showMenuList=!this.isCrossBridgeOnly}};this.updateData=e=>{let{swapType:t,smartRoutingMenuVoList:r,dexRouterList:s,fromDexRouterList:i,bridge:a,toDexRouterToList:d}=e;this.setSwapType(t),this.setMenuListAndCurrentMenu(r,t,a),this.setDexRouterList(s),this.setFromDexRouterList(i),this.setBridgeRouterList(e,a),this.setToDexRouterToList(d),this.updateTokenInfo(e)};this.showXRouteModal=re.SWAP;this.setXRouteModal=e=>{this.showXRouteModal=e};this.subRouterData=null;this.setSubRouterData=e=>{this.subRouterData=e};this.subRouterModal=!1;this.setSubRouterModal=e=>{this.subRouterModal=e};this.dexQuoteInfoListData=[];this.setDexQuoteInfoListData=e=>{this.dexQuoteInfoListData=e};this.oldRouterModal=!1;this.setOldRouterModal=e=>{this.oldRouterModal=e};this.allGasFee={};this.updateAllGasFee=e=>{this.allGasFee=W(e)}}get computedIsFewRouter(){let{routerList:e}=this.computedCurrentRouter;return this.checkIsFewRouter(e)}get computedIsManyQuoteInfo(){let{routerList:e}=this.computedCurrentRouter;return this.checkIsManyQuote(e)}get computedCurrentRouter(){return this.getInfoByMenuType(this.currentMenu)}};var K=class extends y{constructor({swapStore:t,fromToStore:r,swapDappStore:s}){super();this.fromToStore=r||{},this.quoteStore=t.quoteStore||{},this.swapDappStore=s||{},ae(this,{},{autoBind:!0}),z(()=>({isFetchQuoting:this.quoteStore.quote?.isFetchQuoting,bestRoute:this.quoteStore.computedRouterForSmartRouterStore,quoteError:this.quoteStore.quote?.quoteError,quoteNull:this.quoteStore.quote?.quoteNull,fromToken:this.fromToStore.from,toToken:this.fromToStore.to,shouldPauseQuote:this.swapDappStore.computedSupportDappTradeByChain}),({isFetchQuoting:i,bestRoute:a,quoteError:d,quoteNull:p,shouldPauseQuote:k})=>{this.setReloadQuote(this.quoteStore.fetchQuote),this.setFromToData({from:this.fromToStore.from,to:this.fromToStore.to}),this.updateSmartRouterData({isFetchQuoting:i,bestRoute:a,quoteError:d,quoteNull:p,shouldPauseQuote:k})},{equals:j.shallow})}};export{ge as a,E as b,qe as c,N as d,W as e,Ze as f,c as g,l as h,w as i,C as j,K as k};
//# sourceMappingURL=chunk-BZ2IK5IM.js.map
