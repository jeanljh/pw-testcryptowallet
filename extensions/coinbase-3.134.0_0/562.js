try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="0b993a97-8e86-4c7a-a2c8-98164a4d28d6",e._sentryDebugIdIdentifier="sentry-dbid-0b993a97-8e86-4c7a-a2c8-98164a4d28d6")}()}catch(e){}!function(){try{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{}).SENTRY_RELEASE={id:"3.134.0-bffc4d"}}catch(e){}}(),(self.webpackChunkcb_wallet_extension=self.webpackChunkcb_wallet_extension||[]).push([[562],{86431:(e,n,t)=>{t.d(n,{Gj:()=>k});var s=t(14041),a=t(28345),r=t(34767),o=t(55452);function c(e){(0,o.$s)("onboarding.cbpay.stream",{action:r.X2.unknown,componentType:r.I5.modal,...e})}t(84213);var i=t(13394),d=t(71847),u=t(66181),p=t(73185),l=t(74146);const y="payment-provider-proxy/cdp/onramp",m="payment-provider-proxy/cdp-scw/onramp";const h=t(65012).XP.map((e=>e.name));var f=t(58524),w=t(79071),I=t.n(w),b=t(87432),E=t(98053);const v={open:async()=>{},destroy:I()},N="https://pay.coinbase.com",C="https://pay-dev.cbhq.net",g=[N,C];function k({widgetParameters:e,appId:n=f.Wx??"wallet",onEvent:t,onEventError:r,onSuccess:w,onExit:I,onReady:k,closeOnExit:T,closeOnSuccess:O,experienceLoggedOut:S="popup",experienceLoggedIn:A="popup",embeddedContentStyles:_,enableOnrampSDK:x,isProduction:L=!0}){const[P,B]=(0,s.useState)(!x),M=(0,s.useRef)(v),R=(0,u.l)("kill_cbpay_buy_default_experiment"),D=(0,d.x)("cb_onramp_session_token"),W=R?e.defaultExperience:"buy",j=L?N:C,G=(0,s.useCallback)((function(e){if(!g.includes(e.origin))return;let n;try{n=JSON.parse(e.data).data}catch(e){r?.(e)}if(n.eventName&&"success"===n.eventName&&w?.(),n.eventName&&"analytics"!==n.eventName&&c({CBPayEventName:n.eventName}),n.eventName&&"analytics"===n.eventName){const{event:e}=n;c({CBPayEventName:e.name,...e.metadata})}}),[r,w]);(0,b.y)((function(){if(!x)return window.addEventListener("message",G),()=>{window.removeEventListener("message",G)}}));const{data:H,isLoading:X,refetch:q,error:U}=(0,E.I)({queryKey:["cbOnrampUrl"],queryFn:async()=>async function({appId:e,host:n,widgetParameters:t,defaultExperience:s,isSessionTokenEnabled:r,isSCW:o}){let c=(0,a.aw)({...t,appId:e,defaultExperience:s,host:n});if(r){const e={...t,destinationWallets:void 0},n=function({widgetParameters:e}){return e.destinationWallets.reduce((function(e,n){let t=Array.from(new Set([...n.blockchains||[],...n.supportedNetworks||[]]));0===t.length&&(t=h);const s=t.map((e=>"avalanche-c-chain"===e?"avacchain":e)),a={address:n.address,blockchains:s};return e.addresses.push(a),n.assets?.forEach((n=>{e.assets.includes(n)||e.assets.push(n)})),e}),{addresses:[],assets:e.defaultAsset?[e.defaultAsset]:[]})}({widgetParameters:t}),s=await async function({isSCW:e,...n}){try{const t=await(0,l.TB)("token",n,{service:e?m:y,apiVersion:1,authenticated:!0,setAuthTokens:p.PR});if(!t.token)throw new Error("No token returned from CB Onramp Session Token API");return t.token}catch(e){return void(0,i.gf)({error:e,context:"cb_onramp_session_token",severity:"error",isHandled:!1})}}({...n,isSCW:o});s&&(c=(0,a.aw)({...e,sessionToken:s}))}return c}({appId:n,host:j,defaultExperience:W,widgetParameters:e,isSessionTokenEnabled:D}),enabled:!x,staleTime:1/0,refetchOnWindowFocus:!1});return(0,s.useEffect)((function(){if(!x){if(X||U||!H)return;return M.current={open:async function(){window.open(H,"_blank")||((0,o.Np)("onramp.popup.blocked",{}),(0,i.gf)({error:new Error("Onramp popup blocked"),context:"onramp",severity:"error",isHandled:!1})),q()},destroy:()=>{M.current=v}},void k?.()}return(0,a.mp)({appId:n,widgetParameters:{...e,defaultExperience:W},closeOnExit:T,closeOnSuccess:O,experienceLoggedOut:S,experienceLoggedIn:A,embeddedContentStyles:_,onEvent:function(e){c({CBPayEventName:e.eventName}),t?.(e)},onExit:I,onSuccess:w},((e,n)=>{n&&(B(!0),M.current={open:async()=>n.open(),destroy:n.destroy},k?.())})),()=>{M.current?.destroy()}}),[n,H,T,O,W,_,x,U,A,S,j,D,X,t,I,k,w,q,e]),{cbPayInstance:M,isCBPayInstanceReady:P}}},65012:(e,n,t)=>{t.d(n,{Bu:()=>o,CM:()=>c,XP:()=>r,to:()=>d,yi:()=>i});var s=t(51676),a=t(10611);const r=Object.freeze([{currencyCode:"ETH",name:"ethereum",chainId:s.ay.whitelisted.ETHEREUM_MAINNET.chainId},{currencyCode:"AVAX",name:"avalanche-c-chain",chainId:s.ay.whitelisted.AVALANCHE_MAINNET.chainId},{currencyCode:"POL",name:"polygon",chainId:s.ay.whitelisted.POLYGON_MAINNET.chainId},{currencyCode:"OP",name:"optimism",chainId:s.ay.whitelisted.OPTIMISM_MAINNET.chainId},{currencyCode:"ARB",name:"arbitrum",chainId:s.ay.whitelisted.ARBITRUM_MAINNET.chainId},{currencyCode:"BASE",name:"base",chainId:s.ay.whitelisted.BASE_MAINNET.chainId},{currencyCode:"SOL",name:"solana",chainId:a.D.whitelisted.SOLANA_MAINNET.chainId},{currencyCode:"BTC",name:"bitcoin",chainId:null},{currencyCode:"DOGE",name:"dogecoin",chainId:null},{currencyCode:"LTC",name:"litecoin",chainId:null}]),o=Object.fromEntries(r.map((e=>[e.currencyCode,e]))),c=Object.fromEntries(r.filter((e=>!!e.chainId)).map((e=>[e.chainId,e]))),i=r.filter((e=>!["BTC","DOGE","LTC","SOL"].includes(e.currencyCode))).map((e=>e.currencyCode)),d=["BTC","DOGE","LTC"]},81732:(e,n,t)=>{t.d(n,{aR:()=>c});var s=t(51676),a=t(65012),r=t(52197);const o=Object.values(s.ay.whitelisted).filter((e=>!e.isTestnet&&!!a.CM[e.chainId]));function c({asset:e,chainId:n,networks:t,walletGroupId:s}){const c=function({primaryReceiveAddresses:e,asset:n,chainId:t,networks:s}){const r=i({asset:n,chainId:t});return Array.from(e).reduce((function(e,[c,{address:i}]){const d={address:i};if(a.to.includes(c)&&(d.supportedNetworks=[a.Bu[c].name],n!==c&&(n||t||s&&!s.includes(c))||(d.assets=n?[n]:void 0,e.push(d))),"SOL"===c){(!n||r&&"SOL"!==r)&&!!(n||r&&r!==c)||s&&!s.includes(c)||(d.assets=n?[n]:void 0,d.supportedNetworks=[a.Bu.SOL.name],e.push(d))}if("ETH"===c){const t=s?.filter((e=>a.yi.includes(e))).map((e=>a.Bu[e].name));n?r||s?r&&a.yi.includes(r)?(d.assets=[n],d.supportedNetworks=[a.Bu[r].name],e.push(d)):!r&&t&&t.length>0&&!a.to.includes(n)&&"SOL"!==n&&(d.assets=[n],d.supportedNetworks=t,e.push(d)):(d.assets=[n],d.supportedNetworks=o.map((e=>a.CM[e.chainId].name)),e.push(d)):n||(r&&a.yi.includes(r)?(d.supportedNetworks=[a.Bu[r].name],e.push(d)):!r&&t&&t.length>0?(d.supportedNetworks=t,e.push(d)):r||s||(d.supportedNetworks=o.map((e=>a.CM[e.chainId].name)),e.push(d)))}return e}),[])}({primaryReceiveAddresses:(0,r.j)(s),asset:e,chainId:n,networks:t});return c}function i({asset:e,chainId:n}){return n&&a.CM[n]?a.CM[n].currencyCode:e&&a.to.includes(e)?e:void 0}}}]);
//# sourceMappingURL=562.js.map