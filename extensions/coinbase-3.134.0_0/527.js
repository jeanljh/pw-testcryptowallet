/*! For license information please see 527.js.LICENSE.txt */
try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="041d606f-00d9-440a-9e07-b3c5c3b90d8f",e._sentryDebugIdIdentifier="sentry-dbid-041d606f-00d9-440a-9e07-b3c5c3b90d8f")}()}catch(e){}!function(){try{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{}).SENTRY_RELEASE={id:"3.134.0-bffc4d"}}catch(e){}}(),(self.webpackChunkcb_wallet_extension=self.webpackChunkcb_wallet_extension||[]).push([[527],{83420:(e,t,n)=>{n.r(t),n.d(t,{Interstitial:()=>G});var i=n(14041),s=n(32183),a=n(8867),o=n(86090),r=n(3521),c=n(86431),d=n(81732),l=n(70918),p=n(79734),u=n(10058),h=n(4681),g=n(59706),f=n(22115),m=n(85581),b=n(34107),y=n(15654),v=n(84492),w=n(60149),x=n(97541),P=n(67209),L=n(52331),E=n(80526),I=n(55452),C=n(34767);function k(e){return(0,I.cp)("onramp_interstitial.viewed",{loggingId:"a2e0ba41-1bfa-465b-a237-d65a3fe1ca86",componentType:C.I5.page,context:e??"none"})}var S,O=n(31085);function _(){var e,t,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",s=n.toStringTag||"@@toStringTag";function a(n,i,s,a){var c=i&&i.prototype instanceof r?i:r,d=Object.create(c.prototype);return j(d,"_invoke",function(n,i,s){var a,r,c,d=0,l=s||[],p=!1,u={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return a=t,r=0,c=e,u.n=n,o}};function h(n,i){for(r=n,c=i,t=0;!p&&d&&!s&&t<l.length;t++){var s,a=l[t],h=u.p,g=a[2];n>3?(s=g===i)&&(c=a[(r=a[4])?5:(r=3,3)],a[4]=a[5]=e):a[0]<=h&&((s=n<2&&h<a[1])?(r=0,u.v=i,u.n=a[1]):h<g&&(s=n<3||a[0]>i||i>g)&&(a[4]=n,a[5]=i,u.n=g,r=0))}if(s||n>1)return o;throw p=!0,i}return function(s,l,g){if(d>1)throw TypeError("Generator is already running");for(p&&1===l&&h(l,g),r=l,c=g;(t=r<2?e:c)||!p;){a||(r?r<3?(r>1&&(u.n=-1),h(r,c)):u.n=c:u.v=c);try{if(d=2,a){if(r||(s="next"),t=a[s]){if(!(t=t.call(a,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,r<2&&(r=0)}else 1===r&&(t=a.return)&&t.call(a),r<2&&(c=TypeError("The iterator does not provide a '"+s+"' method"),r=1);a=e}else if((t=(p=u.n<0)?c:n.call(i,u))!==o)break}catch(t){a=e,r=1,c=t}finally{d=1}}return{value:t,done:p}}}(n,s,a),!0),d}var o={};function r(){}function c(){}function d(){}t=Object.getPrototypeOf;var l=[][i]?t(t([][i]())):(j(t={},i,(function(){return this})),t),p=d.prototype=r.prototype=Object.create(l);function u(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,j(e,s,"GeneratorFunction")),e.prototype=Object.create(p),e}return c.prototype=d,j(p,"constructor",d),j(d,"constructor",c),c.displayName="GeneratorFunction",j(d,s,"GeneratorFunction"),j(p),j(p,s,"Generator"),j(p,i,(function(){return this})),j(p,"toString",(function(){return"[object Generator]"})),(_=function(){return{w:a,m:u}})()}function j(e,t,n,i){var s=Object.defineProperty;try{s({},"",{})}catch(e){s=0}j=function(e,t,n,i){function a(t,n){j(e,t,(function(e){return this._invoke(t,n,e)}))}t?s?s(e,t,{value:n,enumerable:!i,configurable:!i,writable:!i}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},j(e,t,n,i)}function M(e,t,n,i,s,a,o){try{var r=e[a](o),c=r.value}catch(e){return void n(e)}r.done?t(c):Promise.resolve(c).then(i,s)}function R(e){return function(){var t=this,n=arguments;return new Promise((function(i,s){var a=e.apply(t,n);function o(e){M(a,i,s,o,r,"next",e)}function r(e){M(a,i,s,o,r,"throw",e)}o(void 0)}))}}e=n.hmd(e),(S="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&S(e);var T,A,B="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e},N=(0,s.YK)({title:{id:"0cBfNo",defaultMessage:[{type:0,value:"Add crypto"}]},main:{id:"ANYNnm",defaultMessage:[{type:0,value:"Buy or transfer from Coinbase"}]},subtitle:{id:"n5pNbz",defaultMessage:[{type:0,value:"You can add crypto from your Coinbase account or another wallet."}]},finePrint:{id:"gB/gnI",defaultMessage:[{type:0,value:"Use of Coinbase.com's account linkage feature is subject to Coinbase.com's "},{type:1,value:"userAgreement"},{type:0,value:" and "},{type:1,value:"privacyPolicy"},{type:0,value:"."}]},userAgreement:{id:"V6jvi1",defaultMessage:[{type:0,value:"User Agreement"}]},privacyPolicy:{id:"0ROee6",defaultMessage:[{type:0,value:"Privacy Policy"}]},buttonCta:{id:"EeHuvk",defaultMessage:[{type:0,value:"Add crypto with Coinbase Onramp"}]},otherButton:{id:"IykAaN",defaultMessage:[{type:0,value:"Transfer from another wallet"}]}});function G(){var e=(0,o.g)().mode;k(e);var t=(0,a.A)().formatMessage,n=(0,o.W6)(),s=(0,l.h)(),S=(0,d.aR)({walletGroupId:s}),j=(0,c.Gj)({widgetParameters:{destinationWallets:S}}),M=j.cbPayInstance,T=j.isCBPayInstanceReady,A=(0,i.useCallback)(R(_().m((function t(){var n;return _().w((function(t){for(;;)if(0===t.n)return i=e,(0,I.$s)("onramp_interstitial.connect_coinbase",{loggingId:"dcb60e9e-075b-4fbf-a7f1-d0439701fdbd",action:C.X2.click,componentType:C.I5.button,context:i??"none"}),t.a(2,null===(n=M.current)||void 0===n?void 0:n.open());var i}),t)}))),[e,M]),B=(0,i.useCallback)((function(){var t;t=e,(0,I.$s)("onramp_interstitial.transfer_other",{loggingId:"3e932f1e-05cc-4d2f-93bc-1c1b52d730a4",action:C.X2.click,componentType:C.I5.button,context:t??"none"});var i="/receive/address";n.entries.at(-2).pathname===i?n.goBack():n.push(i)}),[n,e]),G=(0,i.useCallback)((function(){n.goBack(),(0,r.Ts)(n.entries.at(-1))}),[n]),F=(0,i.useCallback)(R(_().m((function e(){return _().w((function(e){for(;;)if(0===e.n)return e.a(2,chrome.tabs.create({url:p.i1,active:!1}))}),e)}))),[]),W=(0,i.useCallback)(R(_().m((function e(){return _().w((function(e){for(;;)if(0===e.n)return e.a(2,chrome.tabs.create({url:p.WO,active:!1}))}),e)}))),[]);return(0,O.jsxs)(h.ff,{header:(0,O.jsx)(u.jq,{variant:"secondary",title:t(N.title),handleBack:G,navBarTopComponent:(0,O.jsx)(E.P,{})}),children:[(0,O.jsxs)(y.T,{justifyContent:"space-between",paddingX:3,paddingBottom:3,paddingTop:2,height:515,children:[(0,O.jsxs)(y.T,{gap:3,children:[(0,O.jsx)(v.z,{alignItems:"center",justifyContent:"center",children:(0,O.jsx)(g.t,{illustration:"TransferCoinsMiami",alt:t(N.main),children:(0,O.jsx)(b.g,{name:"linkCoinbaseWallet",scaleMultiplier:.9})})}),(0,O.jsxs)(y.T,{gap:1,alignItems:"center",justifyContent:"center",children:[(0,O.jsx)(w.f,{as:"h2",children:t(N.main)}),(0,O.jsx)(x.K,{as:"p",color:"fgMuted",textAlign:"center",children:t(N.subtitle)})]})]}),(0,O.jsxs)(f.e,{accessibilityLabel:"Transfer Funds",block:!0,direction:"vertical",children:[(0,O.jsx)(m.$n,{loading:!T,testID:"cbpay-button",id:"cbpay-button",onClick:A,children:t(N.buttonCta)}),(0,O.jsx)(m.$n,{onClick:B,variant:"secondary",id:"onramp-interstitial-receive-btn",testID:"onramp-interstitial-receive-btn",children:t(N.otherButton)})]}),(0,O.jsx)(P.V,{display:"inline",as:"p",color:"fgMuted",textAlign:"center",children:t(N.finePrint,{userAgreement:(0,O.jsx)(L.N,{font:"legal",color:"fgPrimary",onClick:F,as:"button",children:t(N.userAgreement)}),privacyPolicy:(0,O.jsx)(L.N,{font:"legal",color:"fgPrimary",onClick:W,as:"button",children:t(N.privacyPolicy)})})})]}),(0,O.jsx)("div",{id:"cbpay-iframe-container"})]})}B(G,"useParams{{ mode }}\nuseOnrampInterstitialViewed{}\nuseIntl{{ formatMessage }}\nuseHistory{history}\nuseActiveWalletGroupId{activeWalletGroupId}\nuseDestinationWallets{destinationWallets}\nuseCoinbasePay{{ cbPayInstance, isCBPayInstanceReady }}\nuseCallback{handleConnectCoinbaseClick}\nuseCallback{handleOtherClick}\nuseCallback{handleBackClick}\nuseCallback{handleClickUserAgreement}\nuseCallback{handleClickPrivacyPolicy}",(function(){return[o.g,k,a.A,o.W6,l.h,d.aR,c.Gj]})),(T="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(T.register(N,"messages","/workspaces/apps/extension/src/screens/Onramp/Interstitial.tsx"),T.register(G,"Interstitial","/workspaces/apps/extension/src/screens/Onramp/Interstitial.tsx")),(A="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&A(e)},28345:(e,t,n)=>{n.d(t,{aw:()=>d,mp:()=>E});var i,s,a=Object.defineProperty,o=(e,t)=>a(e,"name",{value:t,configurable:!0}),r=(e,t,n)=>(((e,t,n)=>{t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n),c="https://pay.coinbase.com",d=o((({host:e=c,destinationWallets:t,...n})=>{const i=new URL(e);return i.pathname="/buy/select-asset",void 0!==t&&i.searchParams.append("destinationWallets",JSON.stringify(t)),Object.keys(n).forEach((e=>{const t=n[e];void 0!==t&&i.searchParams.append(e,t.toString())})),i.searchParams.sort(),i.toString()}),"generateOnRampURL"),l="cbpay-embedded-onramp",p=o((({url:e,width:t="100%",height:n="100%",position:i="fixed",top:s="0px"})=>{const a=document.createElement("iframe");return a.style.border="unset",a.style.borderWidth="0",a.style.width=t.toString(),a.style.height=n.toString(),a.style.position=i,a.style.top=s,a.id=l,a.src=e,a}),"createEmbeddedContent");(s=i||(i={})).LaunchEmbedded="launch_embedded",s.AppReady="app_ready",s.AppParams="app_params",s.SigninSuccess="signin_success",s.Success="success",s.Exit="exit",s.Event="event",s.Error="error",s.PixelReady="pixel_ready",s.OnAppParamsNonce="on_app_params_nonce";var u=o(((e,{onMessage:t,shouldUnsubscribe:n=!0,allowedOrigin:i,onValidateOrigin:s=o((()=>Promise.resolve(!0)),"onValidateOrigin")})=>{const a=o((o=>{const{eventName:r,data:c}=g(o.data),d=!i||o.origin===i;r===e&&(async()=>{d&&await s(o.origin)&&(t(c),n&&window.removeEventListener("message",a))})()}),"onMessage");return window.addEventListener("message",a),()=>{window.removeEventListener("message",a)}}),"onBroadcastedPostMessage"),h=o(((e,t,{allowedOrigin:n="*",data:i}={})=>{const s=f(t,i);e.postMessage(s,n)}),"broadcastPostMessage"),g=o((e=>{try{return JSON.parse(e)}catch{return{eventName:e}}}),"parsePostMessage"),f=o(((e,t)=>t?JSON.stringify({eventName:e,data:t}):e),"formatPostMessage"),m="coinbase-sdk-connect",b={width:460,height:730},y={width:430,height:600},v=class{constructor({host:e=c,appId:t,appParams:n,onReady:i,onFallbackOpen:s,debug:a,theme:d}){r(this,"state","loading"),r(this,"nonce",""),r(this,"eventStreamListeners",{}),r(this,"unsubs",[]),r(this,"isLoggedIn",!1),r(this,"openExperience",o((e=>{if(this.log("Attempting to open experience",{state:this.state}),"waiting_for_response"===this.state)return;if("loading"===this.state)return;if("failed"===this.state)return void this.onFallbackOpen?.();if(!this.nonce)throw new Error("Attempted to open CB Pay experience without nonce");const t=this.nonce;this.nonce="",this.setupExperienceListeners(e);const{path:n,experienceLoggedIn:i,experienceLoggedOut:s,embeddedContentStyles:a}=e,r=new URL(`${this.host}${n}`);r.searchParams.append("appId",this.appId),r.searchParams.append("type","secure_standalone"),this.theme&&r.searchParams.append("theme",this.theme);const c=this.isLoggedIn?i:s||i;r.searchParams.append("nonce",t);const d=r.toString();if(this.log("Opening experience",{experience:c,isLoggedIn:this.isLoggedIn}),"embedded"===c){const e=o((()=>{const e=p({url:d,...a});a?.target?document.querySelector(a?.target)?.replaceChildren(e):document.body.appendChild(e)}),"openEmbeddedExperience");this.isLoggedIn?e():this.startDirectSignin(e)}else"popup"===c&&window.chrome?.windows?.create?window.chrome.windows.create({url:d,setSelfAsOpener:!0,type:"popup",focused:!0,width:b.width,height:b.height,left:window.screenLeft-b.width-10,top:window.screenTop},(e=>{this.addEventStreamListener("open",(()=>{e?.id&&chrome.windows.update(e.id,{width:y.width,height:y.height,left:window.screenLeft-y.width-10,top:window.screenTop})}))})):"new_tab"===c&&window.chrome?.tabs?.create?window.chrome.tabs.create({url:d}):x(d,c);const l=o((()=>{this.sendAppParams(),this.removeEventStreamListener("open",l)}),"onOpen");this.addEventStreamListener("open",l)}),"openExperience")),r(this,"endExperience",o((()=>{document.getElementById(l)?.remove()}),"endExperience")),r(this,"destroy",o((()=>{document.getElementById(m)?.remove(),this.unsubs.forEach((e=>e()))}),"destroy")),r(this,"addPixelReadyListener",o((()=>{this.onMessage("pixel_ready",{shouldUnsubscribe:!1,onMessage:e=>{this.log("Received message: pixel_ready"),this.isLoggedIn=!!e?.isLoggedIn,this.removeErrorListener?.(),this.sendAppParams((()=>{this.onReadyCallback?.()}))}})}),"addPixelReadyListener")),r(this,"addErrorListener",o((()=>{this.removeErrorListener=this.onMessage("error",{shouldUnsubscribe:!0,onMessage:e=>{if(this.log("Received message: error"),e){const t="string"==typeof e?e:JSON.stringify(e);this.onReadyCallback?.(new Error(t))}}})}),"addErrorListener")),r(this,"embedPixel",o((()=>{document.getElementById(m)?.remove();const e=w({host:this.host,appId:this.appId});e.onerror=this.onFailedToLoad,this.pixelIframe=e,document.body.appendChild(e)}),"embedPixel")),r(this,"onFailedToLoad",o((()=>{if(this.state="failed",this.onFallbackOpen)this.debug&&console.warn("Failed to load CB Pay pixel. Falling back to opening in new tab."),this.onReadyCallback?.();else{const e=new Error("Failed to load CB Pay pixel");this.debug&&console.error(e),this.onReadyCallback?.(e)}}),"onFailedToLoad")),r(this,"sendAppParams",o((e=>{this.pixelIframe?.contentWindow?(this.log("Sending message: app_params"),this.onMessage("on_app_params_nonce",{onMessage:t=>{this.state="ready",this.nonce=t?.nonce||"",e?.()}}),this.state="waiting_for_response",h(this.pixelIframe.contentWindow,"app_params",{data:this.appParams})):(console.error("Failed to find pixel content window"),this.state="failed",this.onFallbackOpen?.())}),"sendAppParams")),r(this,"setupExperienceListeners",o((({onSuccess:e,onExit:t,onEvent:n,onRequestedUrl:i})=>{this.onMessage("event",{shouldUnsubscribe:!1,onMessage:s=>{const a=s;this.eventStreamListeners[a.eventName]?.forEach((e=>e?.())),"success"===a.eventName&&e?.(),"exit"===a.eventName&&t?.(a.error),"request_open_url"===a.eventName&&i?.(a.url),n?.(s)}})}),"setupExperienceListeners")),r(this,"startDirectSignin",o((e=>{const t=new URLSearchParams;t.set("appId",this.appId),t.set("type","direct");const n=x(`${this.host}/signin?${t.toString()}`,"popup");this.onMessage("signin_success",{onMessage:()=>{n?.close(),e()}})}),"startDirectSignin")),r(this,"addEventStreamListener",o(((e,t)=>{this.eventStreamListeners[e]?this.eventStreamListeners[e]?.push(t):this.eventStreamListeners[e]=[t]}),"addEventStreamListener")),r(this,"removeEventStreamListener",o(((e,t)=>{if(this.eventStreamListeners[e]){const n=this.eventStreamListeners[e]?.filter((e=>e!==t));this.eventStreamListeners[e]=n}}),"removeEventStreamListener")),r(this,"onMessage",o(((...e)=>{const t=u(e[0],{allowedOrigin:this.host,...e[1]});return this.unsubs.push(t),t}),"onMessage")),r(this,"log",o(((...e)=>{this.debug&&console.log("[CBPAY]",...e)}),"log")),this.host=e,this.appId=t,this.appParams=n,this.onReadyCallback=i,this.onFallbackOpen=s,this.debug=a||!1,this.theme=d,this.addPixelReadyListener(),this.addErrorListener(),this.embedPixel(),setTimeout((()=>{"ready"!==this.state&&this.onFailedToLoad()}),5e3)}};function w({host:e,appId:t}){const n=document.createElement("iframe");n.style.border="unset",n.style.borderWidth="0",n.style.width="0",n.style.height="0",n.style.height="0",n.id=m;const i=new URL(`${e}/embed`);return i.searchParams.append("appId",t),n.src=i.toString(),n}function x(e,t){return window.open(e,"Coinbase","popup"===t?`toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, height=${b.height},width=${b.width}`:void 0)}o(v,"CoinbasePixel"),o(w,"createPixel"),o(x,"openWindow");var P={buy:"/buy",checkout:"/checkout"},L=class{constructor(e){if(r(this,"open",o((()=>{const{widget:e,experienceLoggedIn:t,experienceLoggedOut:n,embeddedContentStyles:i,onExit:s,onSuccess:a,onEvent:o,onRequestedUrl:r,closeOnSuccess:c,closeOnExit:d}=this.options;this.pixel.openExperience({path:P[e],experienceLoggedIn:t,experienceLoggedOut:n,embeddedContentStyles:i,onExit:()=>{s?.(),d&&this.pixel.endExperience()},onSuccess:()=>{a?.(),c&&this.pixel.endExperience()},onRequestedUrl:r,onEvent:o})}),"open")),r(this,"destroy",o((()=>{this.pixel.destroy()}),"destroy")),this.options=e,this.pixel=new v({...e,appParams:{widget:e.widget,...e.appParams}}),e.target){const t=document.querySelector(e.target);t&&t.addEventListener("click",this.open)}}};o(L,"CBPayInstance");var E=o((({experienceLoggedIn:e="embedded",widgetParameters:t,...n},i)=>{const s=new L({...n,widget:"buy",experienceLoggedIn:e,appParams:t,onReady:e=>{e?i(e,null):i(null,s)},onFallbackOpen:()=>{const e=d({appId:n.appId,host:n.host,theme:n.theme,...t});window.open(e)}})}),"initOnRamp");o((function(e,t){h(e,"event",{data:t})}),"broadcastEvent")}}]);
//# sourceMappingURL=527.js.map