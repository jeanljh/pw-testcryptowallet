LavaPack.loadBundle([[1441,{"../errors":1436,"./_stream_duplex":1437,"./internal/streams/destroy":1444,"./internal/streams/state":1448,"./internal/streams/stream":1449,_process:3510,buffer:2461,inherits:3110,"util-deprecate":3938},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(n){(function(){function r(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;e.entry=null;for(;r;){var i=r.callback;t.pendingcb--,i(n),r=r.next}t.corkedRequestsFree.next=e}(t,e)}}var i;t.exports=E,E.WritableState=k;var s={deprecate:e("util-deprecate")},o=e("./internal/streams/stream"),a=e("buffer").Buffer,l=("undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var c,u=e("./internal/streams/destroy"),d=e("./internal/streams/state").getHighWaterMark,h=e("../errors").codes,f=h.ERR_INVALID_ARG_TYPE,p=h.ERR_METHOD_NOT_IMPLEMENTED,m=h.ERR_MULTIPLE_CALLBACK,g=h.ERR_STREAM_CANNOT_PIPE,v=h.ERR_STREAM_DESTROYED,b=h.ERR_STREAM_NULL_VALUES,w=h.ERR_STREAM_WRITE_AFTER_END,y=h.ERR_UNKNOWN_ENCODING,_=u.errorOrDestroy;function S(){}function k(t,s,o){i=i||e("./_stream_duplex"),t=t||{},"boolean"!=typeof o&&(o=s instanceof i),this.objectMode=!!t.objectMode,o&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=d(this,t,"writableHighWaterMark",o),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=!1===t.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,i=r.sync,s=r.writecb;if("function"!=typeof s)throw new m;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,i,s){--t.pendingcb,r?(n.nextTick(s,i),n.nextTick(M,e,t),e._writableState.errorEmitted=!0,_(e,i)):(s(i),e._writableState.errorEmitted=!0,_(e,i),M(e,t))}(e,r,i,t,s);else{var o=O(r)||e.destroyed;o||r.corked||r.bufferProcessing||!r.bufferedRequest||C(e,r),i?n.nextTick(P,e,r,o,s):P(e,r,o,s)}}(s,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new r(this)}function E(t){var n=this instanceof(i=i||e("./_stream_duplex"));if(!n&&!c.call(E,this))return new E(t);this._writableState=new k(t,this,n),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),o.call(this)}function T(e,t,n,r,i,s,o){t.writelen=r,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new v("write")):n?e._writev(i,t.onwrite):e._write(i,s,t.onwrite),t.sync=!1}function P(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),M(e,t)}function C(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var i=t.bufferedRequestCount,s=new Array(i),o=t.corkedRequestsFree;o.entry=n;for(var a=0,l=!0;n;)s[a]=n,n.isBuf||(l=!1),n=n.next,a+=1;s.allBuffers=l,T(e,t,!0,t.length,s,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new r(t),t.bufferedRequestCount=0}else{for(;n;){var c=n.chunk,u=n.encoding,d=n.callback;if(T(e,t,!1,t.objectMode?1:c.length,c,u,d),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function O(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function j(e,t){e._final((function(n){t.pendingcb--,n&&_(e,n),t.prefinished=!0,e.emit("prefinish"),M(e,t)}))}function M(e,t){var r=O(t);if(r&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,n.nextTick(j,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var i=e._readableState;(!i||i.autoDestroy&&i.endEmitted)&&e.destroy()}return r}e("inherits")(E,o),k.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(k.prototype,"buffer",{get:s.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer "+"instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(c=Function.prototype[Symbol.hasInstance],Object.defineProperty(E,Symbol.hasInstance,{value:function(e){return!!c.call(this,e)||this===E&&(e&&e._writableState instanceof k)}})):c=function(e){return e instanceof this},E.prototype.pipe=function(){_(this,new g)},E.prototype.write=function(e,t,r){var i,s=this._writableState,o=!1,c=!s.objectMode&&(i=e,a.isBuffer(i)||i instanceof l);return c&&!a.isBuffer(e)&&(e=function(e){return a.from(e)}(e)),"function"==typeof t&&(r=t,t=null),c?t="buffer":t||(t=s.defaultEncoding),"function"!=typeof r&&(r=S),s.ending?function(e,t){var r=new w;_(e,r),n.nextTick(t,r)}(this,r):(c||function(e,t,r,i){var s;return null===r?s=new b:"string"==typeof r||t.objectMode||(s=new f("chunk",["string","Buffer"],r)),!s||(_(e,s),n.nextTick(i,s),!1)}(this,s,e,r))&&(s.pendingcb++,o=function(e,t,n,r,i,s){if(!n){var o=function(e,t,n){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=a.from(t,n));return t}(t,r,i);r!==o&&(n=!0,i="buffer",r=o)}var l=t.objectMode?1:r.length;t.length+=l;var c=t.length<t.highWaterMark;c||(t.needDrain=!0);if(t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:s,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else T(e,t,!1,l,r,i,s);return c}(this,s,c,e,t,r)),o},E.prototype.cork=function(){this._writableState.corked++},E.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||C(this,e))},E.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new y(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(E.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(E.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),E.prototype._write=function(e,t,n){n(new p("_write()"))},E.prototype._writev=null,E.prototype.end=function(e,t,r){var i=this._writableState;return"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!==e&&e!==undefined&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||function(e,t,r){t.ending=!0,M(e,t),r&&(t.finished?n.nextTick(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,i,r),this},Object.defineProperty(E.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(E.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==undefined&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),E.prototype.destroy=u.destroy,E.prototype._undestroy=u.undestroy,E.prototype._destroy=function(e,t){t(e)}}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/providers>@metamask/object-multiplex>readable-stream",file:"node_modules/@metamask/object-multiplex/node_modules/readable-stream/lib/_stream_writable.js"}],[1442,{"./end-of-stream":1445,_process:3510},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(n){(function(){var r;function i(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(n!==undefined){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=e("./end-of-stream"),o=Symbol("lastResolve"),a=Symbol("lastReject"),l=Symbol("error"),c=Symbol("ended"),u=Symbol("lastPromise"),d=Symbol("handlePromise"),h=Symbol("stream");function f(e,t){return{value:e,done:t}}function p(e){var t=e[o];if(null!==t){var n=e[h].read();null!==n&&(e[u]=null,e[o]=null,e[a]=null,t(f(n,!1)))}}function m(e){n.nextTick(p,e)}var g=Object.getPrototypeOf((function(){})),v=Object.setPrototypeOf((i(r={get stream(){return this[h]},next:function(){var e=this,t=this[l];if(null!==t)return Promise.reject(t);if(this[c])return Promise.resolve(f(undefined,!0));if(this[h].destroyed)return new Promise((function(t,r){n.nextTick((function(){e[l]?r(e[l]):t(f(undefined,!0))}))}));var r,i=this[u];if(i)r=new Promise(function(e,t){return function(n,r){e.then((function(){t[c]?n(f(undefined,!0)):t[d](n,r)}),r)}}(i,this));else{var s=this[h].read();if(null!==s)return Promise.resolve(f(s,!1));r=new Promise(this[d])}return this[u]=r,r}},Symbol.asyncIterator,(function(){return this})),i(r,"return",(function(){var e=this;return new Promise((function(t,n){e[h].destroy(null,(function(e){e?n(e):t(f(undefined,!0))}))}))})),r),g);t.exports=function(e){var t,n=Object.create(v,(i(t={},h,{value:e,writable:!0}),i(t,o,{value:null,writable:!0}),i(t,a,{value:null,writable:!0}),i(t,l,{value:null,writable:!0}),i(t,c,{value:e._readableState.endEmitted,writable:!0}),i(t,d,{value:function(e,t){var r=n[h].read();r?(n[u]=null,n[o]=null,n[a]=null,e(f(r,!1))):(n[o]=e,n[a]=t)},writable:!0}),t));return n[u]=null,s(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=n[a];return null!==t&&(n[u]=null,n[o]=null,n[a]=null,t(e)),void(n[l]=e)}var r=n[o];null!==r&&(n[u]=null,n[o]=null,n[a]=null,r(f(undefined,!0))),n[c]=!0})),e.on("readable",m.bind(null,n)),n}}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/providers>@metamask/object-multiplex>readable-stream",file:"node_modules/@metamask/object-multiplex/node_modules/readable-stream/lib/internal/streams/async_iterator.js"}],[1443,{buffer:2461,util:2426},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return(t=a(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function a(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(n!==undefined){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=e("buffer").Buffer,c=e("util").inspect,u=c&&c.custom||"inspect";t.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,n,r;return t=e,(n=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n}},{key:"concat",value:function(e){if(0===this.length)return l.alloc(0);for(var t,n,r,i=l.allocUnsafe(e>>>0),s=this.head,o=0;s;)t=s.data,n=i,r=o,l.prototype.copy.call(t,n,r),o+=s.data.length,s=s.next;return i}},{key:"consume",value:function(e,t){var n;return e<this.head.data.length?(n=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):n=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,n=1,r=t.data;for(e-=r.length;t=t.next;){var i=t.data,s=e>i.length?i.length:e;if(s===i.length?r+=i:r+=i.slice(0,e),0==(e-=s)){s===i.length?(++n,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(s));break}++n}return this.length-=n,r}},{key:"_getBuffer",value:function(e){var t=l.allocUnsafe(e),n=this.head,r=1;for(n.data.copy(t),e-=n.data.length;n=n.next;){var i=n.data,s=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,s),0==(e-=s)){s===i.length?(++r,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=i.slice(s));break}++r}return this.length-=r,t}},{key:u,value:function(e,t){return c(this,i(i({},t),{},{depth:0,customInspect:!1}))}}])&&o(t.prototype,n),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()}}},{package:"@metamask/providers>@metamask/object-multiplex>readable-stream",file:"node_modules/@metamask/object-multiplex/node_modules/readable-stream/lib/internal/streams/buffer_list.js"}],[1444,{_process:3510},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(e){(function(){function n(e,t){i(e,t),r(e)}function r(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function i(e,t){e.emit("error",t)}t.exports={destroy:function(t,s){var o=this,a=this._readableState&&this._readableState.destroyed,l=this._writableState&&this._writableState.destroyed;return a||l?(s?s(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,e.nextTick(i,this,t)):e.nextTick(i,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!s&&t?o._writableState?o._writableState.errorEmitted?e.nextTick(r,o):(o._writableState.errorEmitted=!0,e.nextTick(n,o,t)):e.nextTick(n,o,t):s?(e.nextTick(r,o),s(t)):e.nextTick(r,o)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var n=e._readableState,r=e._writableState;n&&n.autoDestroy||r&&r.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/providers>@metamask/object-multiplex>readable-stream",file:"node_modules/@metamask/object-multiplex/node_modules/readable-stream/lib/internal/streams/destroy.js"}],[1445,{"../../../errors":1436},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function i(){}t.exports=function e(t,n,s){if("function"==typeof n)return e(t,null,n);n||(n={}),s=function(e){var t=!1;return function(){if(!t){t=!0;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e.apply(this,r)}}}(s||i);var o=n.readable||!1!==n.readable&&t.readable,a=n.writable||!1!==n.writable&&t.writable,l=function(){t.writable||u()},c=t._writableState&&t._writableState.finished,u=function(){a=!1,c=!0,o||s.call(t)},d=t._readableState&&t._readableState.endEmitted,h=function(){o=!1,d=!0,a||s.call(t)},f=function(e){s.call(t,e)},p=function(){var e;return o&&!d?(t._readableState&&t._readableState.ended||(e=new r),s.call(t,e)):a&&!c?(t._writableState&&t._writableState.ended||(e=new r),s.call(t,e)):void 0},m=function(){t.req.on("finish",u)};return!function(e){return e.setHeader&&"function"==typeof e.abort}(t)?a&&!t._writableState&&(t.on("end",l),t.on("close",l)):(t.on("complete",u),t.on("abort",p),t.req?m():t.on("request",m)),t.on("end",h),t.on("finish",u),!1!==n.error&&t.on("error",f),t.on("close",p),function(){t.removeListener("complete",u),t.removeListener("abort",p),t.removeListener("request",m),t.req&&t.req.removeListener("finish",u),t.removeListener("end",l),t.removeListener("close",l),t.removeListener("finish",u),t.removeListener("end",h),t.removeListener("error",f),t.removeListener("close",p)}}}}},{package:"@metamask/providers>@metamask/object-multiplex>readable-stream",file:"node_modules/@metamask/object-multiplex/node_modules/readable-stream/lib/internal/streams/end-of-stream.js"}],[1446,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports=function(){throw new Error("Readable.from is not available in the browser")}}}},{package:"@metamask/providers>@metamask/object-multiplex>readable-stream",file:"node_modules/@metamask/object-multiplex/node_modules/readable-stream/lib/internal/streams/from-browser.js"}],[1447,{"../../../errors":1436,"./end-of-stream":1445},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r;var i=e("../../../errors").codes,s=i.ERR_MISSING_ARGS,o=i.ERR_STREAM_DESTROYED;function a(e){if(e)throw e}function l(e){e()}function c(e,t){return e.pipe(t)}t.exports=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var u,d=function(e){return e.length?"function"!=typeof e[e.length-1]?a:e.pop():a}(n);if(Array.isArray(n[0])&&(n=n[0]),n.length<2)throw new s("streams");var h=n.map((function(t,i){var s=i<n.length-1;return function(t,n,i,s){s=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(s);var a=!1;t.on("close",(function(){a=!0})),r===undefined&&(r=e("./end-of-stream")),r(t,{readable:n,writable:i},(function(e){if(e)return s(e);a=!0,s()}));var l=!1;return function(e){if(!a&&!l)return l=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(t)?t.abort():"function"==typeof t.destroy?t.destroy():void s(e||new o("pipe"))}}(t,s,i>0,(function(e){u||(u=e),e&&h.forEach(l),s||(h.forEach(l),d(u))}))}));return n.reduce(c)}}}},{package:"@metamask/providers>@metamask/object-multiplex>readable-stream",file:"node_modules/@metamask/object-multiplex/node_modules/readable-stream/lib/internal/streams/pipeline.js"}],[1448,{"../../../errors":1436},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;t.exports={getHighWaterMark:function(e,t,n,i){var s=function(e,t,n){return null!=e.highWaterMark?e.highWaterMark:t?e[n]:null}(t,i,n);if(null!=s){if(!isFinite(s)||Math.floor(s)!==s||s<0)throw new r(i?n:"highWaterMark",s);return Math.floor(s)}return e.objectMode?16:16384}}}}},{package:"@metamask/providers>@metamask/object-multiplex>readable-stream",file:"node_modules/@metamask/object-multiplex/node_modules/readable-stream/lib/internal/streams/state.js"}],[1449,{events:2788},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports=e("events").EventEmitter}}},{package:"@metamask/providers>@metamask/object-multiplex>readable-stream",file:"node_modules/@metamask/object-multiplex/node_modules/readable-stream/lib/internal/streams/stream-browser.js"}],[145,{"../../../shared/constants/network":4006,lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("lodash"),i=e("../../../shared/constants/network");n.default={version:55,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=55;const n=t.data;return t.data=function(e){var t;null!=e&&null!==(t=e.IncomingTransactionsController)&&void 0!==t&&t.incomingTxLastFetchedBlocksByNetwork&&(e.IncomingTransactionsController.incomingTxLastFetchedBlockByChainId=(0,r.mapKeys)(e.IncomingTransactionsController.incomingTxLastFetchedBlocksByNetwork,((e,t)=>{var n;return(null===(n=i.BUILT_IN_NETWORKS[t])||void 0===n?void 0:n.chainId)??s})),delete e.IncomingTransactionsController.incomingTxLastFetchedBlockByChainId[s],delete e.IncomingTransactionsController.incomingTxLastFetchedBlocksByNetwork);return e}(n),t}};const s="UNKNOWN";i.BUILT_IN_NETWORKS.rinkeby={networkId:"4",chainId:"0x4",ticker:"ETH"},i.BUILT_IN_NETWORKS.ropsten={networkId:"3",chainId:"0x3",ticker:"ETH"},i.BUILT_IN_NETWORKS.kovan={networkId:"42",chainId:"0x2a",ticker:"ETH"}}}},{package:"$root$",file:"app/scripts/migrations/055.js"}],[1450,{"./lib/_stream_duplex.js":1437,"./lib/_stream_passthrough.js":1438,"./lib/_stream_readable.js":1439,"./lib/_stream_transform.js":1440,"./lib/_stream_writable.js":1441,"./lib/internal/streams/end-of-stream.js":1445,"./lib/internal/streams/pipeline.js":1447},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(n=t.exports=e("./lib/_stream_readable.js")).Stream=n,n.Readable=n,n.Writable=e("./lib/_stream_writable.js"),n.Duplex=e("./lib/_stream_duplex.js"),n.Transform=e("./lib/_stream_transform.js"),n.PassThrough=e("./lib/_stream_passthrough.js"),n.finished=e("./lib/internal/streams/end-of-stream.js"),n.pipeline=e("./lib/internal/streams/pipeline.js")}}},{package:"@metamask/providers>@metamask/object-multiplex>readable-stream",file:"node_modules/@metamask/object-multiplex/node_modules/readable-stream/readable-browser.js"}],[1451,{"./ObservableStore":1453},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ComposedStore=void 0;const r=e("./ObservableStore");class i extends r.ObservableStore{constructor(e){super({}),this._children=e||{},Object.keys(this._children).forEach((e=>{const t=this._children[e];this._addChild(e,t)}))}_addChild(e,t){const n=t=>{const n=this.getState();n[e]=t,this.putState(n)};t.subscribe(n),n(t.getState())}}n.ComposedStore=i}}},{package:"@metamask/obs-store",file:"node_modules/@metamask/obs-store/dist/ComposedStore.js"}],[1452,{"./ObservableStore":1453},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MergedStore=void 0;const r=e("./ObservableStore");class i extends r.ObservableStore{constructor(e=[]){super({}),this._children=e,e.forEach((e=>this._addChild(e))),this._updateWholeState()}_addChild(e){e.subscribe((()=>this._updateWholeState()))}_updateWholeState(){const e=this._children.map((e=>e.getState())),t=Object.assign({},...e);this.putState(t)}}n.MergedStore=i}}},{package:"@metamask/obs-store",file:"node_modules/@metamask/obs-store/dist/MergedStore.js"}],[1453,{"@metamask/safe-event-emitter":1526},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.ObservableStore=void 0;const i=r(e("@metamask/safe-event-emitter"));class s extends i.default{constructor(e){super(),e===undefined?this._state={}:this._state=e}getState(){return this._getState()}putState(e){this._putState(e),this.emit("update",e)}updateState(e){if(e&&"object"==typeof e){const t=this.getState();this.putState(Object.assign(Object.assign({},t),e))}else this.putState(e)}subscribe(e){this.on("update",e)}unsubscribe(e){this.removeListener("update",e)}_getState(){return this._state}_putState(e){this._state=e}}n.ObservableStore=s}}},{package:"@metamask/obs-store",file:"node_modules/@metamask/obs-store/dist/ObservableStore.js"}],[1454,{stream:3845},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.storeAsStream=void 0;const r=e("stream");class i extends r.Duplex{constructor(e){super({objectMode:!0}),this.resume(),this.handler=e=>this.push(e),this.obsStore=e,this.obsStore.subscribe(this.handler)}pipe(e,t){const n=super.pipe(e,t);return e.write(this.obsStore.getState()),n}_write(e,t,n){this.obsStore.putState(e),n()}_read(e){return undefined}_destroy(e,t){this.obsStore.unsubscribe(this.handler),super._destroy(e,t)}}n.storeAsStream=function(e){return new i(e)}}}},{package:"@metamask/obs-store",file:"node_modules/@metamask/obs-store/dist/asStream.js"}],[1455,{"./ComposedStore":1451,"./MergedStore":1452,"./ObservableStore":1453,"./asStream":1454,"./transform":1456},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){r===undefined&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){r===undefined&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),i(e("./asStream"),n),i(e("./ComposedStore"),n),i(e("./MergedStore"),n),i(e("./ObservableStore"),n),i(e("./transform"),n)}}},{package:"@metamask/obs-store",file:"node_modules/@metamask/obs-store/dist/index.js"}],[1456,{through2:1457},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.storeTransformStream=void 0;const r=e("through2");n.storeTransformStream=function(e){return r.obj(((t,n,r)=>{try{return r(null,e(t)),undefined}catch(e){return r(e),undefined}}))}}}},{package:"@metamask/obs-store",file:"node_modules/@metamask/obs-store/dist/transform.js"}],[1457,{_process:3510,"readable-stream":3740,util:3941,xtend:3983},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(n){(function(){var r=e("readable-stream").Transform,i=e("util").inherits,s=e("xtend");function o(e){r.call(this,e),this._destroyed=!1}function a(e,t,n){n(null,e)}function l(e){return function(t,n,r){return"function"==typeof t&&(r=n,n=t,t={}),"function"!=typeof n&&(n=a),"function"!=typeof r&&(r=null),e(t,n,r)}}i(o,r),o.prototype.destroy=function(e){if(!this._destroyed){this._destroyed=!0;var t=this;n.nextTick((function(){e&&t.emit("error",e),t.emit("close")}))}},t.exports=l((function(e,t,n){var r=new o(e);return r._transform=t,n&&(r._flush=n),r})),t.exports.ctor=l((function(e,t,n){function r(t){if(!(this instanceof r))return new r(t);this.options=s(e,t),o.call(this,this.options)}return i(r,o),r.prototype._transform=t,n&&(r.prototype._flush=n),r})),t.exports.obj=l((function(e,t,n){var r=new o(s({objectMode:!0,highWaterMark:16},e));return r._transform=t,n&&(r._flush=n),r}))}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/obs-store>through2",file:"node_modules/@metamask/obs-store/node_modules/through2/through2.js"}],[146,{lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("lodash");n.default={version:56,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=56;const{PreferencesController:n}=t.data;return Array.isArray(null==n?void 0:n.tokens)&&(n.tokens=n.tokens.filter((({address:e})=>e))),null!=n&&n.accountTokens&&"object"==typeof n.accountTokens&&Object.keys(n.accountTokens).forEach((e=>{Object.keys(n.accountTokens[e]).forEach((t=>{n.accountTokens[e][t]=n.accountTokens[e][t].filter((({address:e})=>e))}))})),null!=n&&n.assetImages&&"undefined"in n.assetImages&&delete n.assetImages.undefined,t}}}}},{package:"$root$",file:"app/scripts/migrations/056.js"}],[147,{"../../../shared/modules/random-id":4042,lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,i=e("lodash"),s=(r=e("../../../shared/modules/random-id"))&&r.__esModule?r:{default:r};n.default={version:57,async migrate(e){const t=(0,i.cloneDeep)(e);t.meta.version=57;const n=t.data;return t.data=function(e){var t;null!=e&&null!==(t=e.TransactionController)&&void 0!==t&&t.transactions&&Array.isArray(e.TransactionController.transactions)&&!e.TransactionController.transactions.some((e=>"object"!=typeof e||void 0===e.txParams))&&(e.TransactionController.transactions=(0,i.keyBy)(e.TransactionController.transactions,(e=>(void 0!==e.id&&null!==e.id||(e.id=(0,s.default)()),e.id))));return e}(n),t}}}}},{package:"$root$",file:"app/scripts/migrations/057.js"}],[1472,{"./enums":1473,"@metamask/base-controller":1064,"@metamask/utils":1806},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,i,s,o,a,l,c,u,d,h=this&&this.__classPrivateFieldSet||function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},f=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.PermissionLogController=void 0;const p=e("@metamask/base-controller"),m=e("@metamask/utils"),g=e("./enums"),v={permissionHistory:{},permissionActivityLog:[]};class b extends p.BaseController{constructor({messenger:e,restrictedMethods:t,state:n}){super({messenger:e,name:"PermissionLogController",metadata:{permissionHistory:{persist:!0,anonymous:!1},permissionActivityLog:{persist:!0,anonymous:!1}},state:Object.assign(Object.assign({},v),n)}),r.add(this),i.set(this,void 0),h(this,i,t,"f")}updateAccountsHistory(e,t){if(0===t.length)return;const n={eth_accounts:{accounts:f(this,r,"m",s).call(this,t,Date.now())}};f(this,r,"m",c).call(this,e,n)}createMiddleware(){return(e,t,n)=>{const{origin:s,method:c}=e,d=c.startsWith(g.WALLET_PREFIX),h="eth_requestAccounts"===c;if(!g.LOG_IGNORE_METHODS.includes(c)&&(d||f(this,i,"f").has(c))||h){const i=f(this,r,"m",o).call(this,e,d),c=f(this,r,"m",u).call(this,e);n((e=>{const n=Date.now();f(this,r,"m",a).call(this,i,t,n),c&&!t.error&&t.result&&s&&f(this,r,"m",l).call(this,c,s,t.result,n,h),e()}))}else n()}}}n.PermissionLogController=b,i=new WeakMap,r=new WeakSet,s=function(e,t){return e.reduce(((e,n)=>Object.assign(Object.assign({},e),{[n]:t})),{})},o=function(e,t){const n={id:e.id,method:e.method,methodType:t?g.LOG_METHOD_TYPES.internal:g.LOG_METHOD_TYPES.restricted,origin:e.origin,requestTime:Date.now(),responseTime:null,success:null};return this.update((e=>{const t=[...e.permissionActivityLog,n];e.permissionActivityLog=t.length>g.LOG_LIMIT?t.slice(1):t})),n},a=function(e,t,n){e&&t&&this.update((r=>{r.permissionActivityLog=r.permissionActivityLog.map((r=>r.id===e.id?Object.assign(Object.assign({},r),{success:(0,m.hasProperty)(t,"result"),responseTime:n}):r))}))},l=function(e,t,n,i,o){let a;if(o){const e=n;a={eth_accounts:{accounts:f(this,r,"m",s).call(this,e,i),lastApproved:i}}}else{a=n.reduce(((t,n)=>{const o=n.parentCapability;if(!e.includes(o))return t;if("eth_accounts"===o){const e=f(this,r,"m",d).call(this,n);return Object.assign(Object.assign({},t),{[o]:{lastApproved:i,accounts:f(this,r,"m",s).call(this,e,i)}})}return Object.assign(Object.assign({},t),{[o]:{lastApproved:i}})}),{})}Object.keys(a).length>0&&f(this,r,"m",c).call(this,t,a)},c=function(e,t){var n,r;const{permissionHistory:i}=this.state,s=null!==(n=i[e])&&void 0!==n?n:{},o=Object.assign(Object.assign({},s),t),a=s.eth_accounts,l=t.eth_accounts;if(a&&l){const e=null!==(r=l.lastApproved)&&void 0!==r?r:a.lastApproved;o.eth_accounts={lastApproved:e,accounts:Object.assign(Object.assign({},a.accounts),l.accounts)}}this.update((t=>{t.permissionHistory=Object.assign(Object.assign({},i),{[e]:o})}))},u=function(e){const{method:t,params:n}=e;return"eth_requestAccounts"===t?["eth_accounts"]:t===`${g.WALLET_PREFIX}requestPermissions`&&n&&Array.isArray(n)&&n[0]&&"object"==typeof n[0]&&!Array.isArray(n[0])?Object.keys(n[0]):null},d=function(e){if("eth_accounts"!==e.parentCapability||!e.caveats)return[];const t=new Set;for(const n of e.caveats)if(n.type===g.CAVEAT_TYPES.restrictReturnedAccounts&&Array.isArray(n.value))for(const e of n.value)t.add(e);return[...t]}}}},{package:"@metamask/permission-log-controller",file:"node_modules/@metamask/permission-log-controller/dist/PermissionLogController.js"}],[1473,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.LOG_LIMIT=n.LOG_METHOD_TYPES=n.LOG_IGNORE_METHODS=n.CAVEAT_TYPES=n.WALLET_PREFIX=void 0,n.WALLET_PREFIX="wallet_",n.CAVEAT_TYPES=Object.freeze({restrictReturnedAccounts:"restrictReturnedAccounts"}),n.LOG_IGNORE_METHODS=["wallet_registerOnboarding","wallet_watchAsset"],function(e){e.restricted="restricted",e.internal="internal"}(n.LOG_METHOD_TYPES||(n.LOG_METHOD_TYPES={})),n.LOG_LIMIT=100}}},{package:"@metamask/permission-log-controller",file:"node_modules/@metamask/permission-log-controller/dist/enums.js"}],[1474,{"./PermissionLogController":1472},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){r===undefined&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===undefined&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),i(e("./PermissionLogController"),n)}}},{package:"@metamask/permission-log-controller",file:"node_modules/@metamask/permission-log-controller/dist/index.js"}],[1475,{"./utils":1477,"@metamask/base-controller":1064,"@metamask/controller-utils":1069,"eth-phishing-detect/src/detector":2699,"punycode/":3544},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,i,s,o,a,l,c,u,d,h,f=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{l(r.next(e))}catch(e){s(e)}}function a(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))},p=this&&this.__classPrivateFieldSet||function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},m=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},g=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},v=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.PhishingController=n.phishingListKeyNameMap=n.ListNames=n.ListKeys=n.METAMASK_HOTLIST_DIFF_URL=n.METAMASK_STALELIST_URL=n.STALELIST_REFRESH_INTERVAL=n.HOTLIST_REFRESH_INTERVAL=n.METAMASK_HOTLIST_DIFF_FILE=n.METAMASK_STALELIST_FILE=n.PHISHING_CONFIG_BASE_URL=void 0;const b=e("@metamask/base-controller"),w=e("@metamask/controller-utils"),y=v(e("eth-phishing-detect/src/detector")),_=e("punycode/"),S=e("./utils");var k,E;n.PHISHING_CONFIG_BASE_URL="https://phishing-detection.metafi.codefi.network",n.METAMASK_STALELIST_FILE="/v1/stalelist",n.METAMASK_HOTLIST_DIFF_FILE="/v1/diffsSince",n.HOTLIST_REFRESH_INTERVAL=1800,n.STALELIST_REFRESH_INTERVAL=345600,n.METAMASK_STALELIST_URL=`${n.PHISHING_CONFIG_BASE_URL}${n.METAMASK_STALELIST_FILE}`,n.METAMASK_HOTLIST_DIFF_URL=`${n.PHISHING_CONFIG_BASE_URL}${n.METAMASK_HOTLIST_DIFF_FILE}`,function(e){e.PhishfortHotlist="phishfort_hotlist",e.EthPhishingDetectConfig="eth_phishing_detect_config"}(k=n.ListKeys||(n.ListKeys={})),function(e){e.MetaMask="MetaMask",e.Phishfort="Phishfort"}(E=n.ListNames||(n.ListNames={}));const T={[E.Phishfort]:k.PhishfortHotlist,[E.MetaMask]:k.EthPhishingDetectConfig};n.phishingListKeyNameMap={[k.EthPhishingDetectConfig]:E.MetaMask,[k.PhishfortHotlist]:E.Phishfort};const P="PhishingController",C={phishingLists:{persist:!0,anonymous:!1},whitelist:{persist:!0,anonymous:!1},hotlistLastFetched:{persist:!0,anonymous:!1},stalelistLastFetched:{persist:!0,anonymous:!1}};class O extends b.BaseController{constructor({stalelistRefreshInterval:e=n.STALELIST_REFRESH_INTERVAL,hotlistRefreshInterval:t=n.HOTLIST_REFRESH_INTERVAL,messenger:u,state:d={}}){super({name:P,metadata:C,messenger:u,state:Object.assign(Object.assign({},{phishingLists:[],whitelist:[],hotlistLastFetched:0,stalelistLastFetched:0}),d)}),r.add(this),i.set(this,void 0),s.set(this,void 0),o.set(this,void 0),a.set(this,void 0),l.set(this,void 0),p(this,s,e,"f"),p(this,o,t,"f"),m(this,r,"m",c).call(this),this.updatePhishingDetector()}updatePhishingDetector(){p(this,i,new y.default(this.state.phishingLists),"f")}setStalelistRefreshInterval(e){p(this,s,e,"f")}setHotlistRefreshInterval(e){p(this,o,e,"f")}isStalelistOutOfDate(){return(0,S.fetchTimeNow)()-this.state.stalelistLastFetched>=m(this,s,"f")}isHotlistOutOfDate(){return(0,S.fetchTimeNow)()-this.state.hotlistLastFetched>=m(this,o,"f")}maybeUpdateState(){return f(this,void 0,void 0,(function*(){if(this.isStalelistOutOfDate())return void(yield this.updateStalelist());this.isHotlistOutOfDate()&&(yield this.updateHotlist())}))}test(e){const t=(0,_.toASCII)(e);return this.state.whitelist.includes(t)?{result:!1,type:"all"}:m(this,i,"f").check(t)}bypass(e){const t=(0,_.toASCII)(e),{whitelist:n}=this.state;n.includes(t)||this.update((e=>{e.whitelist.push(t)}))}updateHotlist(){return f(this,void 0,void 0,(function*(){if(m(this,a,"f"))yield m(this,a,"f");else try{p(this,a,m(this,r,"m",d).call(this),"f"),yield m(this,a,"f")}finally{p(this,a,undefined,"f")}}))}updateStalelist(){return f(this,void 0,void 0,(function*(){if(m(this,l,"f"))yield m(this,l,"f");else try{p(this,l,m(this,r,"m",u).call(this),"f"),yield m(this,l,"f")}finally{p(this,l,undefined,"f")}}))}}n.PhishingController=O,i=new WeakMap,s=new WeakMap,o=new WeakMap,a=new WeakMap,l=new WeakMap,r=new WeakSet,c=function(){this.messagingSystem.registerActionHandler(`${P}:maybeUpdateState`,this.maybeUpdateState.bind(this)),this.messagingSystem.registerActionHandler(`${P}:testOrigin`,this.test.bind(this))},u=function(){return f(this,void 0,void 0,(function*(){let e,t;try{e=yield m(this,r,"m",h).call(this,n.METAMASK_STALELIST_URL).then((e=>e)),(null==e?void 0:e.data)&&e.data.lastUpdated>0&&(t=yield m(this,r,"m",h).call(this,`${n.METAMASK_HOTLIST_DIFF_URL}/${e.data.lastUpdated}`))}finally{const e=(0,S.fetchTimeNow)();this.update((t=>{t.stalelistLastFetched=e,t.hotlistLastFetched=e}))}if(!e||!t)return;const i=e.data,{phishfort_hotlist:s,eth_phishing_detect_config:o}=i,a=g(i,["phishfort_hotlist","eth_phishing_detect_config"]),l=Object.assign(Object.assign(Object.assign({},s),a),{fuzzylist:[],allowlist:[],name:n.phishingListKeyNameMap.phishfort_hotlist}),c=Object.assign(Object.assign(Object.assign({},o),a),{name:n.phishingListKeyNameMap.eth_phishing_detect_config}),u=(0,S.applyDiffs)(l,t.data,k.PhishfortHotlist),d=(0,S.applyDiffs)(c,t.data,k.EthPhishingDetectConfig);this.update((e=>{e.phishingLists=[d,u]})),this.updatePhishingDetector()}))},d=function(){return f(this,void 0,void 0,(function*(){const e=Math.max(...this.state.phishingLists.map((({lastUpdated:e})=>e)));let t;try{t=yield m(this,r,"m",h).call(this,`${n.METAMASK_HOTLIST_DIFF_URL}/${e}`)}finally{this.update((e=>{e.hotlistLastFetched=(0,S.fetchTimeNow)()}))}if(!(null==t?void 0:t.data))return;const i=t.data,s=this.state.phishingLists.map((e=>(0,S.applyDiffs)(e,i,T[e.name])));this.update((e=>{e.phishingLists=s})),this.updatePhishingDetector()}))},h=function(e){return f(this,void 0,void 0,(function*(){const t=yield(0,w.safelyExecute)((()=>fetch(e,{cache:"no-cache"})),!0);return 200===(null==t?void 0:t.status)?yield t.json():null}))},n.default=O}}},{package:"@metamask/phishing-controller",file:"node_modules/@metamask/phishing-controller/dist/PhishingController.js"}],[1476,{"./PhishingController":1475},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){r===undefined&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===undefined&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),i(e("./PhishingController"),n)}}},{package:"@metamask/phishing-controller",file:"node_modules/@metamask/phishing-controller/dist/index.js"}],[1477,{"./PhishingController":1475},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.applyDiffs=n.fetchTimeNow=void 0;const r=e("./PhishingController");n.fetchTimeNow=()=>Math.round(Date.now()/1e3);const i=e=>{const t=e.indexOf(".");return[e.slice(0,t),e.slice(t+1)]};n.applyDiffs=(e,t,n)=>{const s=t.filter((({timestamp:t,targetList:r})=>t>e.lastUpdated&&i(r)[0]===n));let o=e.lastUpdated;const a={allowlist:new Set(e.allowlist),blocklist:new Set(e.blocklist),fuzzylist:new Set(e.fuzzylist)};for(const{isRemoval:e,targetList:t,url:n,timestamp:r}of s){const s=i(t)[1];r>o&&(o=r),e?a[s].delete(n):a[s].add(n)}return{allowlist:Array.from(a.allowlist),blocklist:Array.from(a.blocklist),fuzzylist:Array.from(a.fuzzylist),version:e.version,name:r.phishingListKeyNameMap[n],tolerance:e.tolerance,lastUpdated:o}}}}},{package:"@metamask/phishing-controller",file:"node_modules/@metamask/phishing-controller/dist/utils.js"}],[148,{lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("lodash");n.default={version:58,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=58;const n=t.data;return t.data=function(e){var t;return null===(t=e.AppStateController)||void 0===t||delete t.swapsWelcomeMessageHasBeenShown,e}(n),t}}}}},{package:"$root$",file:"app/scripts/migrations/058.js"}],[1482,{"readable-stream":1503},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.BasePostMessageStream=void 0;const r=e("readable-stream"),i=()=>undefined,s="SYN",o="ACK";class a extends r.Duplex{constructor(){super({objectMode:!0}),this._init=!1,this._haveSyn=!1,this._log=()=>null}_handshake(){this._write(s,null,i),this.cork()}_onData(e){if(this._init)try{this.push(e),this._log(e,!1)}catch(e){this.emit("error",e)}else e===s?(this._haveSyn=!0,this._write(o,null,i)):e===o&&(this._init=!0,this._haveSyn||this._write(o,null,i),this.uncork())}_read(){return undefined}_write(e,t,n){e!==o&&e!==s&&this._log(e,!0),this._postMessage(e),n()}_setLogger(e){this._log=e}}n.BasePostMessageStream=a}}},{package:"@metamask/post-message-stream",file:"node_modules/@metamask/post-message-stream/dist/BasePostMessageStream.js"}],[1483,{"../BasePostMessageStream":1482,"../utils":1487},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.WebWorkerParentPostMessageStream=void 0;const r=e("../BasePostMessageStream"),i=e("../utils");class s extends r.BasePostMessageStream{constructor({worker:e}){super(),this._target=i.DEDICATED_WORKER_NAME,this._worker=e,this._worker.onmessage=this._onMessage.bind(this),this._handshake()}_postMessage(e){this._worker.postMessage({target:this._target,data:e})}_onMessage(e){const t=e.data;(0,i.isValidStreamMessage)(t)&&this._onData(t.data)}_destroy(){this._worker.onmessage=null,this._worker=null}}n.WebWorkerParentPostMessageStream=s}}},{package:"@metamask/post-message-stream",file:"node_modules/@metamask/post-message-stream/dist/WebWorker/WebWorkerParentPostMessageStream.js"}],[1484,{"../BasePostMessageStream":1482,"../utils":1487},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.WebWorkerPostMessageStream=void 0;const r=e("../BasePostMessageStream"),i=e("../utils");class s extends r.BasePostMessageStream{constructor(){if("undefined"==typeof self||"undefined"==typeof WorkerGlobalScope)throw new Error("WorkerGlobalScope not found. This class should only be instantiated in a WebWorker.");super(),this._name=i.DEDICATED_WORKER_NAME,self.addEventListener("message",this._onMessage.bind(this)),this._handshake()}_postMessage(e){self.postMessage({data:e})}_onMessage(e){const t=e.data;(0,i.isValidStreamMessage)(t)&&t.target===this._name&&this._onData(t.data)}_destroy(){return undefined}}n.WebWorkerPostMessageStream=s}}},{package:"@metamask/post-message-stream",file:"node_modules/@metamask/post-message-stream/dist/WebWorker/WebWorkerPostMessageStream.js"}],[1485,{"./BasePostMessageStream":1482,"./WebWorker/WebWorkerParentPostMessageStream":1483,"./WebWorker/WebWorkerPostMessageStream":1484,"./runtime/BrowserRuntimePostMessageStream":1486,"./window/WindowPostMessageStream":1488},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){r===undefined&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){r===undefined&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),i(e("./window/WindowPostMessageStream"),n),i(e("./WebWorker/WebWorkerPostMessageStream"),n),i(e("./WebWorker/WebWorkerParentPostMessageStream"),n),i(e("./runtime/BrowserRuntimePostMessageStream"),n),i(e("./BasePostMessageStream"),n)}}},{package:"@metamask/post-message-stream",file:"node_modules/@metamask/post-message-stream/dist/browser.js"}],[1486,{"../BasePostMessageStream":1482,"../utils":1487},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,i,s=this&&this.__classPrivateFieldSet||function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},o=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.BrowserRuntimePostMessageStream=void 0;const a=e("../BasePostMessageStream"),l=e("../utils");class c extends a.BasePostMessageStream{constructor({name:e,target:t}){super(),r.set(this,void 0),i.set(this,void 0),s(this,r,e,"f"),s(this,i,t,"f"),this._onMessage=this._onMessage.bind(this),this._getRuntime().onMessage.addListener(this._onMessage),this._handshake()}_postMessage(e){this._getRuntime().sendMessage({target:o(this,i,"f"),data:e})}_onMessage(e){(0,l.isValidStreamMessage)(e)&&e.target===o(this,r,"f")&&this._onData(e.data)}_getRuntime(){var e,t;if("chrome"in globalThis&&"function"==typeof(null===(e=null===chrome||void 0===chrome?void 0:chrome.runtime)||void 0===e?void 0:e.sendMessage))return chrome.runtime;if("browser"in globalThis&&"function"==typeof(null===(t=null===browser||void 0===browser?void 0:browser.runtime)||void 0===t?void 0:t.sendMessage))return browser.runtime;throw new Error("browser.runtime.sendMessage is not a function. This class should only be instantiated in a web extension.")}_destroy(){this._getRuntime().onMessage.removeListener(this._onMessage)}}n.BrowserRuntimePostMessageStream=c,r=new WeakMap,i=new WeakMap}}},{package:"@metamask/post-message-stream",file:"node_modules/@metamask/post-message-stream/dist/runtime/BrowserRuntimePostMessageStream.js"}],[1487,{"@metamask/utils":1806},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isValidStreamMessage=n.DEDICATED_WORKER_NAME=void 0;const r=e("@metamask/utils");n.DEDICATED_WORKER_NAME="dedicatedWorker",n.isValidStreamMessage=function(e){return(0,r.isObject)(e)&&Boolean(e.data)&&("number"==typeof e.data||"object"==typeof e.data||"string"==typeof e.data)}}}},{package:"@metamask/post-message-stream",file:"node_modules/@metamask/post-message-stream/dist/utils.js"}],[1488,{"../BasePostMessageStream":1482,"../utils":1487,"@metamask/utils":1806},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,i;Object.defineProperty(n,"__esModule",{value:!0}),n.WindowPostMessageStream=void 0;const s=e("@metamask/utils"),o=e("../BasePostMessageStream"),a=e("../utils"),l=null===(r=Object.getOwnPropertyDescriptor(MessageEvent.prototype,"source"))||void 0===r?void 0:r.get;(0,s.assert)(l,"MessageEvent.prototype.source getter is not defined.");const c=null===(i=Object.getOwnPropertyDescriptor(MessageEvent.prototype,"origin"))||void 0===i?void 0:i.get;(0,s.assert)(c,"MessageEvent.prototype.origin getter is not defined.");class u extends o.BasePostMessageStream{constructor({name:e,target:t,targetOrigin:n=location.origin,targetWindow:r=window}){if(super(),"undefined"==typeof window||"function"!=typeof window.postMessage)throw new Error("window.postMessage is not a function. This class should only be instantiated in a Window.");this._name=e,this._target=t,this._targetOrigin=n,this._targetWindow=r,this._onMessage=this._onMessage.bind(this),window.addEventListener("message",this._onMessage,!1),this._handshake()}_postMessage(e){this._targetWindow.postMessage({target:this._target,data:e},this._targetOrigin)}_onMessage(e){const t=e.data;"*"!==this._targetOrigin&&c.call(e)!==this._targetOrigin||l.call(e)!==this._targetWindow||!(0,a.isValidStreamMessage)(t)||t.target!==this._name||this._onData(t.data)}_destroy(){window.removeEventListener("message",this._onMessage,!1)}}n.WindowPostMessageStream=u}}},{package:"@metamask/post-message-stream",file:"node_modules/@metamask/post-message-stream/dist/window/WindowPostMessageStream.js"}],[1489,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r={};function i(e,t,n){n||(n=Error);var i=function(e){var n,r;function i(n,r,i){return e.call(this,function(e,n,r){return"string"==typeof t?t:t(e,n,r)}(n,r,i))||this}return r=e,(n=i).prototype=Object.create(r.prototype),n.prototype.constructor=n,n.__proto__=r,i}(n);i.prototype.name=n.name,i.prototype.code=e,r[e]=i}function s(e,t){if(Array.isArray(e)){var n=e.length;return e=e.map((function(e){return String(e)})),n>2?"one of ".concat(t," ").concat(e.slice(0,n-1).join(", "),", or ")+e[n-1]:2===n?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}i("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),i("ERR_INVALID_ARG_TYPE",(function(e,t,n){var r,i,o,a;if("string"==typeof t&&(i="not ",t.substr(!o||o<0?0:+o,i.length)===i)?(r="must not be",t=t.replace(/^not /,"")):r="must be",function(e,t,n){return(n===undefined||n>e.length)&&(n=e.length),e.substring(n-t.length,n)===t}(e," argument"))a="The ".concat(e," ").concat(r," ").concat(s(t,"type"));else{var l=function(e,t,n){return"number"!=typeof n&&(n=0),!(n+t.length>e.length)&&-1!==e.indexOf(t,n)}(e,".")?"property":"argument";a='The "'.concat(e,'" ').concat(l," ").concat(r," ").concat(s(t,"type"))}return a+=". Received type ".concat(typeof n)}),TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.codes=r}}},{package:"@metamask/post-message-stream>readable-stream",file:"node_modules/@metamask/post-message-stream/node_modules/readable-stream/errors-browser.js"}],[149,{"@metamask/transaction-controller":1755,lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("lodash"),i=e("@metamask/transaction-controller");n.default={version:59,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=59;const n=t.data;return t.data=function(e){var t;const n=null==e||null===(t=e.TransactionController)||void 0===t?void 0:t.transactions;if((0,r.isPlainObject)(n)){const t=(0,r.groupBy)(Object.values(n),(e=>{var t;return`${null===(t=e.txParams)||void 0===t?void 0:t.nonce}-${e.chainId??e.metamaskNetworkId}`})),s=(0,r.pickBy)(t,(e=>e.some((e=>e.type!==i.TransactionType.cancel&&e.type!==i.TransactionType.retry))));e.TransactionController.transactions=(0,r.keyBy)((0,r.concat)(...Object.values(s)),(e=>e.id))}return e}(n),t}}}}},{package:"$root$",file:"app/scripts/migrations/059.js"}],[1490,{"./_stream_readable":1492,"./_stream_writable":1494,_process:3510,inherits:3110},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(n){(function(){var r=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};t.exports=c;var i=e("./_stream_readable"),s=e("./_stream_writable");e("inherits")(c,i);for(var o=r(s.prototype),a=0;a<o.length;a++){var l=o[a];c.prototype[l]||(c.prototype[l]=s.prototype[l])}function c(e){if(!(this instanceof c))return new c(e);i.call(this,e),s.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",u)))}function u(){this._writableState.ended||n.nextTick(d,this)}function d(e){e.end()}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(c.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(c.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==undefined&&this._writableState!==undefined&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){this._readableState!==undefined&&this._writableState!==undefined&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/post-message-stream>readable-stream",file:"node_modules/@metamask/post-message-stream/node_modules/readable-stream/lib/_stream_duplex.js"}],[1491,{"./_stream_transform":1493,inherits:3110},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports=i;var r=e("./_stream_transform");function i(e){if(!(this instanceof i))return new i(e);r.call(this,e)}e("inherits")(i,r),i.prototype._transform=function(e,t,n){n(null,e)}}}},{package:"@metamask/post-message-stream>readable-stream",file:"node_modules/@metamask/post-message-stream/node_modules/readable-stream/lib/_stream_passthrough.js"}],[1492,{"../errors":1489,"./_stream_duplex":1490,"./internal/streams/async_iterator":1495,"./internal/streams/buffer_list":1496,"./internal/streams/destroy":1497,"./internal/streams/from":1499,"./internal/streams/state":1501,"./internal/streams/stream":1502,_process:3510,buffer:2461,events:2788,inherits:3110,"string_decoder/":3880,util:2426},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(n){(function(){var r;t.exports=E,E.ReadableState=k;e("events").EventEmitter;var i=function(e,t){return e.listeners(t).length},s=e("./internal/streams/stream"),o=e("buffer").Buffer,a=("undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var l,c=e("util");l=c&&c.debuglog?c.debuglog("stream"):function(){};var u,d,h,f=e("./internal/streams/buffer_list"),p=e("./internal/streams/destroy"),m=e("./internal/streams/state").getHighWaterMark,g=e("../errors").codes,v=g.ERR_INVALID_ARG_TYPE,b=g.ERR_STREAM_PUSH_AFTER_EOF,w=g.ERR_METHOD_NOT_IMPLEMENTED,y=g.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;e("inherits")(E,s);var _=p.errorOrDestroy,S=["error","close","destroy","pause","resume"];function k(t,n,i){r=r||e("./_stream_duplex"),t=t||{},"boolean"!=typeof i&&(i=n instanceof r),this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=m(this,t,"readableHighWaterMark",i),this.buffer=new f,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(u||(u=e("string_decoder/").StringDecoder),this.decoder=new u(t.encoding),this.encoding=t.encoding)}function E(t){if(r=r||e("./_stream_duplex"),!(this instanceof E))return new E(t);var n=this instanceof r;this._readableState=new k(t,this,n),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),s.call(this)}function T(e,t,n,r,i){l("readableAddChunk",t);var s,c=e._readableState;if(null===t)c.reading=!1,function(e,t){if(l("onEofChunk"),t.ended)return;if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,t.sync?j(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,M(e)))}(e,c);else if(i||(s=function(e,t){var n;r=t,o.isBuffer(r)||r instanceof a||"string"==typeof t||t===undefined||e.objectMode||(n=new v("chunk",["string","Buffer","Uint8Array"],t));var r;return n}(c,t)),s)_(e,s);else if(c.objectMode||t&&t.length>0)if("string"==typeof t||c.objectMode||Object.getPrototypeOf(t)===o.prototype||(t=function(e){return o.from(e)}(t)),r)c.endEmitted?_(e,new y):P(e,c,t,!0);else if(c.ended)_(e,new b);else{if(c.destroyed)return!1;c.reading=!1,c.decoder&&!n?(t=c.decoder.write(t),c.objectMode||0!==t.length?P(e,c,t,!1):R(e,c)):P(e,c,t,!1)}else r||(c.reading=!1,R(e,c));return!c.ended&&(c.length<c.highWaterMark||0===c.length)}function P(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",n)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&j(e)),R(e,t)}Object.defineProperty(E.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==undefined&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),E.prototype.destroy=p.destroy,E.prototype._undestroy=p.undestroy,E.prototype._destroy=function(e,t){t(e)},E.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=o.from(e,t),t=""),n=!0),T(this,e,t,!1,n)},E.prototype.unshift=function(e){return T(this,e,null,!0,!1)},E.prototype.isPaused=function(){return!1===this._readableState.flowing},E.prototype.setEncoding=function(t){u||(u=e("string_decoder/").StringDecoder);var n=new u(t);this._readableState.decoder=n,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,i="";null!==r;)i+=n.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var C=1073741824;function O(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=C?e=C:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function j(e){var t=e._readableState;l("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(l("emitReadable",t.flowing),t.emittedReadable=!0,n.nextTick(M,e))}function M(e){var t=e._readableState;l("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,L(e)}function R(e,t){t.readingMore||(t.readingMore=!0,n.nextTick(A,e,t))}function A(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var n=t.length;if(l("maybeReadMore read 0"),e.read(0),n===t.length)break}t.readingMore=!1}function N(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function I(e){l("readable nexttick read 0"),e.read(0)}function x(e,t){l("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),L(e),t.flowing&&!t.reading&&e.read(0)}function L(e){var t=e._readableState;for(l("flow",t.flowing);t.flowing&&null!==e.read(););}function B(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):n=t.buffer.consume(e,t.decoder),n);var n}function D(e){var t=e._readableState;l("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,n.nextTick(U,t,e))}function U(e,t){if(l("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var n=t._writableState;(!n||n.autoDestroy&&n.finished)&&t.destroy()}}function F(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}E.prototype.read=function(e){l("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return l("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?D(this):j(this),null;if(0===(e=O(e,t))&&t.ended)return 0===t.length&&D(this),null;var r,i=t.needReadable;return l("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&l("length less than watermark",i=!0),t.ended||t.reading?l("reading or ended",i=!1):i&&(l("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=O(n,t))),null===(r=e>0?B(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&D(this)),null!==r&&this.emit("data",r),r},E.prototype._read=function(e){_(this,new w("_read()"))},E.prototype.pipe=function(e,t){var r=this,s=this._readableState;switch(s.pipesCount){case 0:s.pipes=e;break;case 1:s.pipes=[s.pipes,e];break;default:s.pipes.push(e)}s.pipesCount+=1,l("pipe count=%d opts=%j",s.pipesCount,t);var o=(!t||!1!==t.end)&&e!==n.stdout&&e!==n.stderr?c:g;function a(t,n){l("onunpipe"),t===r&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,l("cleanup"),e.removeListener("close",p),e.removeListener("finish",m),e.removeListener("drain",u),e.removeListener("error",f),e.removeListener("unpipe",a),r.removeListener("end",c),r.removeListener("end",g),r.removeListener("data",h),d=!0,!s.awaitDrain||e._writableState&&!e._writableState.needDrain||u())}function c(){l("onend"),e.end()}s.endEmitted?n.nextTick(o):r.once("end",o),e.on("unpipe",a);var u=function(e){return function(){var t=e._readableState;l("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&i(e,"data")&&(t.flowing=!0,L(e))}}(r);e.on("drain",u);var d=!1;function h(t){l("ondata");var n=e.write(t);l("dest.write",n),!1===n&&((1===s.pipesCount&&s.pipes===e||s.pipesCount>1&&-1!==F(s.pipes,e))&&!d&&(l("false write response, pause",s.awaitDrain),s.awaitDrain++),r.pause())}function f(t){l("onerror",t),g(),e.removeListener("error",f),0===i(e,"error")&&_(e,t)}function p(){e.removeListener("finish",m),g()}function m(){l("onfinish"),e.removeListener("close",p),g()}function g(){l("unpipe"),r.unpipe(e)}return r.on("data",h),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",f),e.once("close",p),e.once("finish",m),e.emit("pipe",r),s.flowing||(l("pipe resume"),r.resume()),e},E.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var s=0;s<i;s++)r[s].emit("unpipe",this,{hasUnpiped:!1});return this}var o=F(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},E.prototype.on=function(e,t){var r=s.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===e&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,l("on readable",i.length,i.reading),i.length?j(this):i.reading||n.nextTick(I,this))),r},E.prototype.addListener=E.prototype.on,E.prototype.removeListener=function(e,t){var r=s.prototype.removeListener.call(this,e,t);return"readable"===e&&n.nextTick(N,this),r},E.prototype.removeAllListeners=function(e){var t=s.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&e!==undefined||n.nextTick(N,this),t},E.prototype.resume=function(){var e=this._readableState;return e.flowing||(l("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,n.nextTick(x,e,t))}(this,e)),e.paused=!1,this},E.prototype.pause=function(){return l("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(l("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},E.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;for(var i in e.on("end",(function(){if(l("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(l("wrapped data"),n.decoder&&(i=n.decoder.write(i)),!n.objectMode||null!==i&&i!==undefined)&&((n.objectMode||i&&i.length)&&(t.push(i)||(r=!0,e.pause())))})),e)this[i]===undefined&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var s=0;s<S.length;s++)e.on(S[s],this.emit.bind(this,S[s]));return this._read=function(t){l("wrapped _read",t),r&&(r=!1,e.resume())},this},"function"==typeof Symbol&&(E.prototype[Symbol.asyncIterator]=function(){return d===undefined&&(d=e("./internal/streams/async_iterator")),d(this)}),Object.defineProperty(E.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(E.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(E.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),E._fromList=B,Object.defineProperty(E.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(E.from=function(t,n){return h===undefined&&(h=e("./internal/streams/from")),h(E,t,n)})}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/post-message-stream>readable-stream",file:"node_modules/@metamask/post-message-stream/node_modules/readable-stream/lib/_stream_readable.js"}],[1493,{"../errors":1489,"./_stream_duplex":1490,inherits:3110},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports=u;var r=e("../errors").codes,i=r.ERR_METHOD_NOT_IMPLEMENTED,s=r.ERR_MULTIPLE_CALLBACK,o=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=r.ERR_TRANSFORM_WITH_LENGTH_0,l=e("./_stream_duplex");function c(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(null===r)return this.emit("error",new s);n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function u(e){if(!(this instanceof u))return new u(e);l.call(this,e),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",d)}function d(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?h(this,null,null):this._flush((function(t,n){h(e,t,n)}))}function h(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new a;if(e._transformState.transforming)throw new o;return e.push(null)}e("inherits")(u,l),u.prototype.push=function(e,t){return this._transformState.needTransform=!1,l.prototype.push.call(this,e,t)},u.prototype._transform=function(e,t,n){n(new i("_transform()"))},u.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},u.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},u.prototype._destroy=function(e,t){l.prototype._destroy.call(this,e,(function(e){t(e)}))}}}},{package:"@metamask/post-message-stream>readable-stream",file:"node_modules/@metamask/post-message-stream/node_modules/readable-stream/lib/_stream_transform.js"}],[1494,{"../errors":1489,"./_stream_duplex":1490,"./internal/streams/destroy":1497,"./internal/streams/state":1501,"./internal/streams/stream":1502,_process:3510,buffer:2461,inherits:3110,"util-deprecate":3938},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(n){(function(){function r(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;e.entry=null;for(;r;){var i=r.callback;t.pendingcb--,i(n),r=r.next}t.corkedRequestsFree.next=e}(t,e)}}var i;t.exports=E,E.WritableState=k;var s={deprecate:e("util-deprecate")},o=e("./internal/streams/stream"),a=e("buffer").Buffer,l=("undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var c,u=e("./internal/streams/destroy"),d=e("./internal/streams/state").getHighWaterMark,h=e("../errors").codes,f=h.ERR_INVALID_ARG_TYPE,p=h.ERR_METHOD_NOT_IMPLEMENTED,m=h.ERR_MULTIPLE_CALLBACK,g=h.ERR_STREAM_CANNOT_PIPE,v=h.ERR_STREAM_DESTROYED,b=h.ERR_STREAM_NULL_VALUES,w=h.ERR_STREAM_WRITE_AFTER_END,y=h.ERR_UNKNOWN_ENCODING,_=u.errorOrDestroy;function S(){}function k(t,s,o){i=i||e("./_stream_duplex"),t=t||{},"boolean"!=typeof o&&(o=s instanceof i),this.objectMode=!!t.objectMode,o&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=d(this,t,"writableHighWaterMark",o),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=!1===t.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,i=r.sync,s=r.writecb;if("function"!=typeof s)throw new m;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,i,s){--t.pendingcb,r?(n.nextTick(s,i),n.nextTick(M,e,t),e._writableState.errorEmitted=!0,_(e,i)):(s(i),e._writableState.errorEmitted=!0,_(e,i),M(e,t))}(e,r,i,t,s);else{var o=O(r)||e.destroyed;o||r.corked||r.bufferProcessing||!r.bufferedRequest||C(e,r),i?n.nextTick(P,e,r,o,s):P(e,r,o,s)}}(s,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new r(this)}function E(t){var n=this instanceof(i=i||e("./_stream_duplex"));if(!n&&!c.call(E,this))return new E(t);this._writableState=new k(t,this,n),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),o.call(this)}function T(e,t,n,r,i,s,o){t.writelen=r,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new v("write")):n?e._writev(i,t.onwrite):e._write(i,s,t.onwrite),t.sync=!1}function P(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),M(e,t)}function C(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var i=t.bufferedRequestCount,s=new Array(i),o=t.corkedRequestsFree;o.entry=n;for(var a=0,l=!0;n;)s[a]=n,n.isBuf||(l=!1),n=n.next,a+=1;s.allBuffers=l,T(e,t,!0,t.length,s,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new r(t),t.bufferedRequestCount=0}else{for(;n;){var c=n.chunk,u=n.encoding,d=n.callback;if(T(e,t,!1,t.objectMode?1:c.length,c,u,d),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function O(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function j(e,t){e._final((function(n){t.pendingcb--,n&&_(e,n),t.prefinished=!0,e.emit("prefinish"),M(e,t)}))}function M(e,t){var r=O(t);if(r&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,n.nextTick(j,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var i=e._readableState;(!i||i.autoDestroy&&i.endEmitted)&&e.destroy()}return r}e("inherits")(E,o),k.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(k.prototype,"buffer",{get:s.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer "+"instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(c=Function.prototype[Symbol.hasInstance],Object.defineProperty(E,Symbol.hasInstance,{value:function(e){return!!c.call(this,e)||this===E&&(e&&e._writableState instanceof k)}})):c=function(e){return e instanceof this},E.prototype.pipe=function(){_(this,new g)},E.prototype.write=function(e,t,r){var i,s=this._writableState,o=!1,c=!s.objectMode&&(i=e,a.isBuffer(i)||i instanceof l);return c&&!a.isBuffer(e)&&(e=function(e){return a.from(e)}(e)),"function"==typeof t&&(r=t,t=null),c?t="buffer":t||(t=s.defaultEncoding),"function"!=typeof r&&(r=S),s.ending?function(e,t){var r=new w;_(e,r),n.nextTick(t,r)}(this,r):(c||function(e,t,r,i){var s;return null===r?s=new b:"string"==typeof r||t.objectMode||(s=new f("chunk",["string","Buffer"],r)),!s||(_(e,s),n.nextTick(i,s),!1)}(this,s,e,r))&&(s.pendingcb++,o=function(e,t,n,r,i,s){if(!n){var o=function(e,t,n){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=a.from(t,n));return t}(t,r,i);r!==o&&(n=!0,i="buffer",r=o)}var l=t.objectMode?1:r.length;t.length+=l;var c=t.length<t.highWaterMark;c||(t.needDrain=!0);if(t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:s,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else T(e,t,!1,l,r,i,s);return c}(this,s,c,e,t,r)),o},E.prototype.cork=function(){this._writableState.corked++},E.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||C(this,e))},E.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new y(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(E.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(E.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),E.prototype._write=function(e,t,n){n(new p("_write()"))},E.prototype._writev=null,E.prototype.end=function(e,t,r){var i=this._writableState;return"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!==e&&e!==undefined&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||function(e,t,r){t.ending=!0,M(e,t),r&&(t.finished?n.nextTick(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,i,r),this},Object.defineProperty(E.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(E.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==undefined&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),E.prototype.destroy=u.destroy,E.prototype._undestroy=u.undestroy,E.prototype._destroy=function(e,t){t(e)}}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/post-message-stream>readable-stream",file:"node_modules/@metamask/post-message-stream/node_modules/readable-stream/lib/_stream_writable.js"}],[1495,{"./end-of-stream":1498,_process:3510},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(n){(function(){var r;function i(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(n!==undefined){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=e("./end-of-stream"),o=Symbol("lastResolve"),a=Symbol("lastReject"),l=Symbol("error"),c=Symbol("ended"),u=Symbol("lastPromise"),d=Symbol("handlePromise"),h=Symbol("stream");function f(e,t){return{value:e,done:t}}function p(e){var t=e[o];if(null!==t){var n=e[h].read();null!==n&&(e[u]=null,e[o]=null,e[a]=null,t(f(n,!1)))}}function m(e){n.nextTick(p,e)}var g=Object.getPrototypeOf((function(){})),v=Object.setPrototypeOf((i(r={get stream(){return this[h]},next:function(){var e=this,t=this[l];if(null!==t)return Promise.reject(t);if(this[c])return Promise.resolve(f(undefined,!0));if(this[h].destroyed)return new Promise((function(t,r){n.nextTick((function(){e[l]?r(e[l]):t(f(undefined,!0))}))}));var r,i=this[u];if(i)r=new Promise(function(e,t){return function(n,r){e.then((function(){t[c]?n(f(undefined,!0)):t[d](n,r)}),r)}}(i,this));else{var s=this[h].read();if(null!==s)return Promise.resolve(f(s,!1));r=new Promise(this[d])}return this[u]=r,r}},Symbol.asyncIterator,(function(){return this})),i(r,"return",(function(){var e=this;return new Promise((function(t,n){e[h].destroy(null,(function(e){e?n(e):t(f(undefined,!0))}))}))})),r),g);t.exports=function(e){var t,n=Object.create(v,(i(t={},h,{value:e,writable:!0}),i(t,o,{value:null,writable:!0}),i(t,a,{value:null,writable:!0}),i(t,l,{value:null,writable:!0}),i(t,c,{value:e._readableState.endEmitted,writable:!0}),i(t,d,{value:function(e,t){var r=n[h].read();r?(n[u]=null,n[o]=null,n[a]=null,e(f(r,!1))):(n[o]=e,n[a]=t)},writable:!0}),t));return n[u]=null,s(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=n[a];return null!==t&&(n[u]=null,n[o]=null,n[a]=null,t(e)),void(n[l]=e)}var r=n[o];null!==r&&(n[u]=null,n[o]=null,n[a]=null,r(f(undefined,!0))),n[c]=!0})),e.on("readable",m.bind(null,n)),n}}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/post-message-stream>readable-stream",file:"node_modules/@metamask/post-message-stream/node_modules/readable-stream/lib/internal/streams/async_iterator.js"}],[1496,{buffer:2461,util:2426},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return(t=a(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function a(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(n!==undefined){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=e("buffer").Buffer,c=e("util").inspect,u=c&&c.custom||"inspect";t.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,n,r;return t=e,(n=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n}},{key:"concat",value:function(e){if(0===this.length)return l.alloc(0);for(var t,n,r,i=l.allocUnsafe(e>>>0),s=this.head,o=0;s;)t=s.data,n=i,r=o,l.prototype.copy.call(t,n,r),o+=s.data.length,s=s.next;return i}},{key:"consume",value:function(e,t){var n;return e<this.head.data.length?(n=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):n=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,n=1,r=t.data;for(e-=r.length;t=t.next;){var i=t.data,s=e>i.length?i.length:e;if(s===i.length?r+=i:r+=i.slice(0,e),0==(e-=s)){s===i.length?(++n,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(s));break}++n}return this.length-=n,r}},{key:"_getBuffer",value:function(e){var t=l.allocUnsafe(e),n=this.head,r=1;for(n.data.copy(t),e-=n.data.length;n=n.next;){var i=n.data,s=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,s),0==(e-=s)){s===i.length?(++r,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=i.slice(s));break}++r}return this.length-=r,t}},{key:u,value:function(e,t){return c(this,i(i({},t),{},{depth:0,customInspect:!1}))}}])&&o(t.prototype,n),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()}}},{package:"@metamask/post-message-stream>readable-stream",file:"node_modules/@metamask/post-message-stream/node_modules/readable-stream/lib/internal/streams/buffer_list.js"}],[1497,{_process:3510},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(e){(function(){function n(e,t){i(e,t),r(e)}function r(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function i(e,t){e.emit("error",t)}t.exports={destroy:function(t,s){var o=this,a=this._readableState&&this._readableState.destroyed,l=this._writableState&&this._writableState.destroyed;return a||l?(s?s(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,e.nextTick(i,this,t)):e.nextTick(i,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!s&&t?o._writableState?o._writableState.errorEmitted?e.nextTick(r,o):(o._writableState.errorEmitted=!0,e.nextTick(n,o,t)):e.nextTick(n,o,t):s?(e.nextTick(r,o),s(t)):e.nextTick(r,o)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var n=e._readableState,r=e._writableState;n&&n.autoDestroy||r&&r.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/post-message-stream>readable-stream",file:"node_modules/@metamask/post-message-stream/node_modules/readable-stream/lib/internal/streams/destroy.js"}],[1498,{"../../../errors":1489},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function i(){}t.exports=function e(t,n,s){if("function"==typeof n)return e(t,null,n);n||(n={}),s=function(e){var t=!1;return function(){if(!t){t=!0;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e.apply(this,r)}}}(s||i);var o=n.readable||!1!==n.readable&&t.readable,a=n.writable||!1!==n.writable&&t.writable,l=function(){t.writable||u()},c=t._writableState&&t._writableState.finished,u=function(){a=!1,c=!0,o||s.call(t)},d=t._readableState&&t._readableState.endEmitted,h=function(){o=!1,d=!0,a||s.call(t)},f=function(e){s.call(t,e)},p=function(){var e;return o&&!d?(t._readableState&&t._readableState.ended||(e=new r),s.call(t,e)):a&&!c?(t._writableState&&t._writableState.ended||(e=new r),s.call(t,e)):void 0},m=function(){t.req.on("finish",u)};return!function(e){return e.setHeader&&"function"==typeof e.abort}(t)?a&&!t._writableState&&(t.on("end",l),t.on("close",l)):(t.on("complete",u),t.on("abort",p),t.req?m():t.on("request",m)),t.on("end",h),t.on("finish",u),!1!==n.error&&t.on("error",f),t.on("close",p),function(){t.removeListener("complete",u),t.removeListener("abort",p),t.removeListener("request",m),t.req&&t.req.removeListener("finish",u),t.removeListener("end",l),t.removeListener("close",l),t.removeListener("finish",u),t.removeListener("end",h),t.removeListener("error",f),t.removeListener("close",p)}}}}},{package:"@metamask/post-message-stream>readable-stream",file:"node_modules/@metamask/post-message-stream/node_modules/readable-stream/lib/internal/streams/end-of-stream.js"}],[1499,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports=function(){throw new Error("Readable.from is not available in the browser")}}}},{package:"@metamask/post-message-stream>readable-stream",file:"node_modules/@metamask/post-message-stream/node_modules/readable-stream/lib/internal/streams/from-browser.js"}],[15,{"@metamask/obs-store":1455,loglevel:3365},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,i=e("@metamask/obs-store"),s=(r=e("loglevel"))&&r.__esModule?r:{default:r};function o(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(n!==undefined){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.default=class{constructor(e={}){o(this,"registerOnboarding",(async(e,t)=>{if(this.store.getState().completedOnboarding)return void s.default.debug("Ignoring registerOnboarding; user already onboarded");const n={...this.store.getState().onboardingTabs};n[e]&&n[e]===t||(s.default.debug(`Registering onboarding tab at location '${e}' with tabId '${t}'`),n[e]=t,this.store.updateState({onboardingTabs:n}))}));const t={seedPhraseBackedUp:null,firstTimeFlowType:null,completedOnboarding:!1,...e.initState,onboardingTabs:{}};this.store=new i.ObservableStore(t)}setSeedPhraseBackedUp(e){this.store.updateState({seedPhraseBackedUp:e})}async completeOnboarding(){return this.store.updateState({completedOnboarding:!0}),!0}setFirstTimeFlowType(e){this.store.updateState({firstTimeFlowType:e})}}}}},{package:"$root$",file:"app/scripts/controllers/onboarding.js"}],[150,{lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("lodash");const i="2020-08-31";n.default={version:60,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=60;const n=function(e){var t;const n=null==e||null===(t=e.NotificationController)||void 0===t?void 0:t.notifications;var s;(0,r.isPlainObject)(n)&&(null===(s=n[2])||void 0===s?void 0:s.date)===i&&delete e.NotificationController.notifications[2];return e}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/060.js"}],[1500,{"../../../errors":1489,"./end-of-stream":1498},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r;var i=e("../../../errors").codes,s=i.ERR_MISSING_ARGS,o=i.ERR_STREAM_DESTROYED;function a(e){if(e)throw e}function l(e){e()}function c(e,t){return e.pipe(t)}t.exports=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var u,d=function(e){return e.length?"function"!=typeof e[e.length-1]?a:e.pop():a}(n);if(Array.isArray(n[0])&&(n=n[0]),n.length<2)throw new s("streams");var h=n.map((function(t,i){var s=i<n.length-1;return function(t,n,i,s){s=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(s);var a=!1;t.on("close",(function(){a=!0})),r===undefined&&(r=e("./end-of-stream")),r(t,{readable:n,writable:i},(function(e){if(e)return s(e);a=!0,s()}));var l=!1;return function(e){if(!a&&!l)return l=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(t)?t.abort():"function"==typeof t.destroy?t.destroy():void s(e||new o("pipe"))}}(t,s,i>0,(function(e){u||(u=e),e&&h.forEach(l),s||(h.forEach(l),d(u))}))}));return n.reduce(c)}}}},{package:"@metamask/post-message-stream>readable-stream",file:"node_modules/@metamask/post-message-stream/node_modules/readable-stream/lib/internal/streams/pipeline.js"}],[1501,{"../../../errors":1489},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;t.exports={getHighWaterMark:function(e,t,n,i){var s=function(e,t,n){return null!=e.highWaterMark?e.highWaterMark:t?e[n]:null}(t,i,n);if(null!=s){if(!isFinite(s)||Math.floor(s)!==s||s<0)throw new r(i?n:"highWaterMark",s);return Math.floor(s)}return e.objectMode?16:16384}}}}},{package:"@metamask/post-message-stream>readable-stream",file:"node_modules/@metamask/post-message-stream/node_modules/readable-stream/lib/internal/streams/state.js"}],[1502,{events:2788},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports=e("events").EventEmitter}}},{package:"@metamask/post-message-stream>readable-stream",file:"node_modules/@metamask/post-message-stream/node_modules/readable-stream/lib/internal/streams/stream-browser.js"}],[1503,{"./lib/_stream_duplex.js":1490,"./lib/_stream_passthrough.js":1491,"./lib/_stream_readable.js":1492,"./lib/_stream_transform.js":1493,"./lib/_stream_writable.js":1494,"./lib/internal/streams/end-of-stream.js":1498,"./lib/internal/streams/pipeline.js":1500},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(n=t.exports=e("./lib/_stream_readable.js")).Stream=n,n.Readable=n,n.Writable=e("./lib/_stream_writable.js"),n.Duplex=e("./lib/_stream_duplex.js"),n.Transform=e("./lib/_stream_transform.js"),n.PassThrough=e("./lib/_stream_passthrough.js"),n.finished=e("./lib/internal/streams/end-of-stream.js"),n.pipeline=e("./lib/internal/streams/pipeline.js")}}},{package:"@metamask/post-message-stream>readable-stream",file:"node_modules/@metamask/post-message-stream/node_modules/readable-stream/readable-browser.js"}],[1504,{"./ppom-controller":1505},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.PPOMController=n.NETWORK_CACHE_DURATION=void 0;var r=e("./ppom-controller");Object.defineProperty(n,"NETWORK_CACHE_DURATION",{enumerable:!0,get:function(){return r.NETWORK_CACHE_DURATION}}),Object.defineProperty(n,"PPOMController",{enumerable:!0,get:function(){return r.PPOMController}})}}},{package:"@metamask/ppom-validator",file:"node_modules/@metamask/ppom-validator/dist/index.js"}],[1505,{"./ppom-storage":1506,"./util":1507,"@metamask/base-controller":1511,"@metamask/controller-utils":1069,"await-semaphore":2355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,i,s,o,a,l,c,u,d,h,f,p,m,g,v,b,w,y,_,S,k,E,T,P,C,O,j,M,R,A,N,I,x,L=this&&this.__classPrivateFieldSet||function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},B=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.PPOMController=n.NETWORK_CACHE_DURATION=void 0;const D=e("@metamask/base-controller"),U=e("@metamask/controller-utils"),F=e("await-semaphore"),W=e("./ppom-storage"),H=e("./util");n.NETWORK_CACHE_DURATION=6048e5;const G=["eth_call","eth_blockNumber","eth_createAccessList","eth_getLogs","eth_getFilterLogs","eth_getTransactionByHash","eth_chainId","eth_getBlockByHash","eth_getBlockByNumber","eth_getCode","eth_getStorageAt","eth_getBalance","eth_getTransactionCount","trace_call","trace_callMany","debug_traceCall","trace_filter"],q={versionInfo:{persist:!0,anonymous:!1},storageMetadata:{persist:!0,anonymous:!1},versionFileETag:{persist:!0,anonymous:!1}},$="PPOMController",V={headers:{"Content-Type":"application/json"}};class z extends D.BaseControllerV2{constructor({chainId:e,messenger:t,provider:n,storageBackend:b,securityAlertsEnabled:w,onPreferencesChange:y,ppomProvider:E,cdnBaseUrl:T,providerRequestLimit:P,state:C,blockaidPublicKey:O,nativeCrypto:j}){super({name:$,metadata:q,messenger:t,state:{versionInfo:C?.versionInfo??[],storageMetadata:C?.storageMetadata??[],versionFileETag:C?.versionFileETag??""}}),r.add(this),i.set(this,void 0),s.set(this,void 0),o.set(this,void 0),a.set(this,void 0),l.set(this,void 0),c.set(this,void 0),u.set(this,void 0),d.set(this,0),h.set(this,void 0),f.set(this,void 0),p.set(this,{}),m.set(this,void 0),g.set(this,!1),v.set(this,undefined),L(this,h,(0,H.addHexPrefix)(e),"f"),L(this,s,n,"f"),L(this,l,E,"f"),L(this,o,new W.PPOMStorage({storageBackend:b,readMetadata:()=>[...this.state.storageMetadata],writeMetadata:e=>{this.update((t=>{t.storageMetadata=e}))}}),"f"),L(this,a,new F.Mutex,"f"),L(this,c,T,"f"),L(this,u,P??300,"f"),L(this,f,w,"f"),L(this,m,O,"f"),L(this,v,j,"f"),y(B(this,r,"m",_).bind(this)),B(this,r,"m",S).call(this),B(this,r,"m",k).call(this)}async usePPOM(e){if(!B(this,f,"f"))throw Error("User has securityAlertsEnabled set to false");if(!(0,H.blockaidValidationSupportedForNetwork)(B(this,h,"f")))throw Error(`Blockaid validation not available on network with chainId: ${B(this,h,"f")}`);return await B(this,r,"m",T).call(this),L(this,d,0,"f"),L(this,p,{},"f"),await B(this,a,"f").use((async()=>({...await e(B(this,i,"f")),providerRequestsCount:{...B(this,p,"f")}})))}}n.PPOMController=z,i=new WeakMap,s=new WeakMap,o=new WeakMap,a=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap,d=new WeakMap,h=new WeakMap,f=new WeakMap,p=new WeakMap,m=new WeakMap,g=new WeakMap,v=new WeakMap,r=new WeakSet,b=async function(){B(this,f,"f")&&!B(this,g,"f")&&await B(this,a,"f").use((async()=>{const{ppomInit:e}=B(this,l,"f");await e("./ppom_bg.wasm"),L(this,g,!0,"f")})).catch((e=>{throw console.error("Error in trying to initialize PPOM",e),e}))},w=function(){B(this,r,"m",E).call(this).catch((e=>{console.error(`Error in resetting ppom: ${e.message}`)}));const{storageMetadata:e}=this.state;this.update((e=>{e.versionInfo=[],e.storageMetadata=[],e.versionFileETag=""})),B(this,o,"f").deleteAllFiles(e).catch((e=>{console.error(`Error in deleting files: ${e.message}`)}))},y=function(e){const t=(0,H.addHexPrefix)(e.providerConfig.chainId);t!==B(this,h,"f")&&(L(this,h,t,"f"),B(this,r,"m",E).call(this).catch((e=>{console.error(`Error in resetting ppom: ${e.message}`)})))},_=function(e){const t=e.securityAlertsEnabled;t!==B(this,f,"f")&&(L(this,f,t,"f"),t||B(this,r,"m",w).call(this))},S=function(){this.messagingSystem.registerActionHandler(`${$}:usePPOM`,this.usePPOM.bind(this))},k=function(){const e=B(this,r,"m",y).bind(this);this.messagingSystem.subscribe("NetworkController:stateChange",e)},E=async function(){await B(this,a,"f").use((async()=>{B(this,i,"f")&&(B(this,i,"f").free(),L(this,i,undefined,"f"))}))},T=async function(){const e=await B(this,r,"m",P).call(this);(B(this,i,"f")===undefined||e)&&(L(this,i,await B(this,r,"m",x).call(this),"f"),B(this,o,"f").syncMetadata(this.state.versionInfo).catch((e=>{console.error(`Error while trying to sync metadata: ${e.message}`)})))},P=async function(){const e=await B(this,r,"m",A).call(this);return!!e&&(this.update((t=>{t.versionInfo=e})),!0)},C=function(e,t){return e.find((e=>e.name===t.name&&e.chainId===t.chainId&&e.version===t.version&&e.checksum===t.checksum))},O=async function(e){const t=await Promise.all(e.map((async e=>{let t;try{t=await B(this,r,"m",j).call(this,e)}catch(t){console.error(`Error in getting file ${e.filePath}: ${t.message}`)}return t?[e.name,new Uint8Array(t)]:undefined})));return t?.filter((e=>e?.[1]!==undefined))},j=async function(e){const{storageMetadata:t}=this.state;if(B(this,r,"m",C).call(this,t,e))try{return await B(this,o,"f").readFile(e.name,e.chainId)}catch(e){console.error(`Error in reading file: ${e.message}`)}(0,H.checkFilePath)(e.filePath);const n=(0,H.constructURLHref)(B(this,c,"f"),e.filePath),i=await B(this,r,"m",N).call(this,n);return await(0,H.validateSignature)(i,e.hashSignature,B(this,m,"f"),e.filePath,B(this,v,"f")),B(this,o,"f").writeFile({data:i,...e}).catch((e=>{console.error(`Error in writing file: ${e.message}`)})),i},M=async function(e,t={},n="GET"){const r=await(0,U.safelyExecute)((async()=>(0,U.timeoutFetch)(e,{method:n,cache:"no-cache",redirect:"error",...t},1e4)),!0);if(200!==r?.status)throw new Error(`Failed to fetch file with url: ${e}`);return r},R=async function(e){const t=await B(this,r,"m",M).call(this,e,{headers:V},"HEAD"),{versionFileETag:n}=this.state;return t.headers.get("ETag")!==n&&(this.update((e=>{e.versionFileETag=t.headers.get("ETag")})),!0)},A=async function(){const e=(0,H.constructURLHref)(B(this,c,"f"),"ppom_version.json");if(!await B(this,r,"m",R).call(this,e)&&this.state.versionInfo?.length)return undefined;return(await B(this,r,"m",M).call(this,e,{headers:V})).json()},N=async function(e){const t=await B(this,r,"m",M).call(this,e);return await t.arrayBuffer()},I=async function(e,t){return new Promise((n=>{B(this,d,"f")>B(this,u,"f")?n(H.PROVIDER_ERRORS.limitExceeded()):(L(this,d,B(this,d,"f")+1,"f"),G.includes(e)?(B(this,p,"f")[e]=B(this,p,"f")[e]?Number(B(this,p,"f")[e])+1:1,B(this,s,"f").sendAsync((0,H.createPayload)(e,t),((e,t)=>{n(e?{jsonrpc:"2.0",id:(0,H.IdGenerator)(),error:e}:t)}))):n(H.PROVIDER_ERRORS.methodNotSupported()))}))},x=async function(){await B(this,r,"m",b).call(this);const e=this.state.versionInfo.filter((({chainId:e})=>e===B(this,h,"f")));if(e?.length===undefined||0===e?.length)throw new Error(`Aborting initialising PPOM as no files are found for the network with chainId: ${B(this,h,"f")}`);const t=await B(this,r,"m",O).call(this,e);if(t?.length!==e?.length)throw new Error(`Aborting initialising PPOM as not all files could not be downloaded for the network with chainId: ${B(this,h,"f")}`);return await B(this,a,"f").use((async()=>{B(this,i,"f")&&B(this,i,"f").free();const{PPOM:e}=B(this,l,"f");return e.new(B(this,r,"m",I).bind(this),t)}))}}}},{package:"@metamask/ppom-validator",file:"node_modules/@metamask/ppom-validator/dist/ppom-controller.js"}],[1506,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,i,s,o=this&&this.__classPrivateFieldSet||function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},a=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.PPOMStorage=void 0;n.PPOMStorage=class{constructor({storageBackend:e,readMetadata:t,writeMetadata:n}){r.set(this,void 0),i.set(this,void 0),s.set(this,void 0),o(this,r,e,"f"),o(this,i,t,"f"),o(this,s,n,"f")}async syncMetadata(e){const t=a(this,i,"f").call(this),n=[];for(const r of t){try{await this.readFile(r.name,r.chainId)}catch(e){console.error("Error: ",e);continue}e.find((e=>e.name===r.name&&e.chainId===r.chainId&&e.version===r.version&&e.checksum===r.checksum))&&n.push(r)}const o=await a(this,r,"f").dir();for(const{name:e,chainId:t}of o)n.find((n=>n.name===e&&n.chainId===t))||await a(this,r,"f").delete({name:e,chainId:t});return a(this,s,"f").call(this,n),n}async deleteAllFiles(e){for(const t of e){const{name:e,chainId:n}=t;try{await a(this,r,"f").delete({name:e,chainId:n})}catch(t){console.error(`Error in deleting file: ${e}, ${n}`,t)}}}async readFile(e,t){const n=a(this,i,"f").call(this).find((n=>n.name===e&&n.chainId===t));if(!n)throw new Error(`File metadata (${e}, ${t}) not found`);const s=await a(this,r,"f").read({name:e,chainId:t},n.checksum);if(!s)throw new Error(`Storage File (${e}, ${t}) not found`);return s}async writeFile({data:e,name:t,chainId:n,version:o,checksum:l}){await a(this,r,"f").write({name:t,chainId:n},e,l);const c=a(this,i,"f").call(this),u=c.find((e=>e.name===t&&e.chainId===n));u?(u.version=o,u.checksum=l):c.push({name:t,chainId:n,version:o,checksum:l}),a(this,s,"f").call(this,c)}},r=new WeakMap,i=new WeakMap,s=new WeakMap}}},{package:"@metamask/ppom-validator",file:"node_modules/@metamask/ppom-validator/dist/ppom-storage.js"}],[1507,{buffer:2461,"crypto-js":2571,elliptic:2626,"json-rpc-random-id":3170},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){r===undefined&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===undefined&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.checkFilePath=n.addHexPrefix=n.constructURLHref=n.validateSignature=n.PROVIDER_ERRORS=n.createPayload=n.IdGenerator=n.blockaidValidationSupportedForNetwork=n.SUPPORTED_NETWORK_CHAINIDS=void 0;const a=s(e("crypto-js")),l=o(e("elliptic")),c=o(e("json-rpc-random-id")),u=l.default.eddsa;n.SUPPORTED_NETWORK_CHAINIDS={MAINNET:"0x1",BSC:"0x38",OPTIMISM:"0xa",POLYGON:"0x89",AVALANCHE:"0xa86a",ARBITRUM:"0xa4b1",LINEA_MAINNET:"0xe708",BASE:"0x2105",SEPOLIA:"0xaa36a7"};n.blockaidValidationSupportedForNetwork=e=>Object.values(n.SUPPORTED_NETWORK_CHAINIDS).some((t=>t===e)),n.IdGenerator=(0,c.default)();n.createPayload=(e,t)=>({id:(0,n.IdGenerator)(),jsonrpc:"2.0",method:e,params:t??[]}),n.PROVIDER_ERRORS={limitExceeded:()=>({jsonrpc:"2.0",id:(0,n.IdGenerator)(),error:{code:-32005,message:"Limit exceeded"}}),methodNotSupported:()=>({jsonrpc:"2.0",id:(0,n.IdGenerator)(),error:{code:-32601,message:"Method not supported"}})};n.validateSignature=async(e,n,r,i,s,o)=>{const l=await(async(e,t,n=!0)=>{if(t)return t.createHash("sha256").update(e).digest("hex");if("crypto"in globalThis&&"object"==typeof globalThis.crypto&&globalThis.crypto.subtle?.digest&&n){const t=await globalThis.crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map((e=>e.toString(16).padStart(2,"0"))).join("")}return(0,a.SHA256)(a.default.lib.WordArray.create(e)).toString()})(e,s,o);if(!new u("ed25519").keyFromPublic(r).verify(t.from(l),n))throw Error(`Signature verification failed for file path: ${i}`)};n.constructURLHref=(e,t)=>new URL(`https://${e}/${t}`.replace(/https:\/\/https:\/\//gu,"https://").replace(/\/\//gu,"/")).href;n.addHexPrefix=e=>"string"!=typeof e||e.match(/^-?0x/u)?e:e.match(/^-?0X/u)?e.replace("0X","0x"):`0x${parseInt(e,10).toString(16)}`;n.checkFilePath=e=>{if(!e.match(/^[\w./]+$/u))throw new Error(`Invalid file path for data file: ${e}`)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/ppom-validator",file:"node_modules/@metamask/ppom-validator/dist/util.js"}],[1508,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.BaseController=void 0;class r{constructor(e={},t={}){this.defaultConfig={},this.defaultState={},this.disabled=!1,this.name="BaseController",this.internalConfig=this.defaultConfig,this.internalState=this.defaultState,this.internalListeners=[],this.initialState=t,this.initialConfig=e}initialize(){return this.internalState=this.defaultState,this.internalConfig=this.defaultConfig,this.configure(this.initialConfig),this.update(this.initialState),this}get config(){return this.internalConfig}get state(){return this.internalState}configure(e,t=!1,n=!0){if(n){this.internalConfig=t?e:Object.assign(this.internalConfig,e);for(const e in this.internalConfig)void 0!==this.internalConfig[e]&&(this[e]=this.internalConfig[e])}else for(const t in e)void 0!==this.internalConfig[t]&&(this.internalConfig[t]=e[t],this[t]=e[t])}notify(){this.disabled||this.internalListeners.forEach((e=>{e(this.internalState)}))}subscribe(e){this.internalListeners.push(e)}unsubscribe(e){const t=this.internalListeners.findIndex((t=>e===t));return t>-1&&this.internalListeners.splice(t,1),t>-1}update(e,t=!1){this.internalState=t?Object.assign({},e):Object.assign({},this.internalState,e),this.notify()}}n.BaseController=r,n.default=r}}},{package:"@metamask/ppom-validator>@metamask/base-controller",file:"node_modules/@metamask/ppom-validator/node_modules/@metamask/base-controller/dist/BaseController.js"}],[1509,{immer:3109},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getPersistentState=n.getAnonymizedState=n.BaseController=void 0;const r=e("immer");(0,r.enablePatches)();function i(e,t,n){return Object.keys(e).reduce(((r,i)=>{try{const s=t[i];if(!s)throw new Error(`No metadata found for '${i}'`);const o=s[n],a=e[i];return"function"==typeof o?r[i]=o(a):o&&(r[i]=a),r}catch(e){return setTimeout((()=>{throw e})),r}}),{})}n.BaseController=class{constructor({messenger:e,metadata:t,name:n,state:r}){this.messagingSystem=e,this.name=n,this.internalState=r,this.metadata=t,this.messagingSystem.registerActionHandler(`${n}:getState`,(()=>this.state))}get state(){return this.internalState}set state(e){throw new Error("Controller state cannot be directly mutated; use 'update' method instead.")}update(e){const[t,n,i]=r.produceWithPatches(this.internalState,e);return this.internalState=t,this.messagingSystem.publish(`${this.name}:stateChange`,t,n),{nextState:t,patches:n,inversePatches:i}}applyPatches(e){const t=(0,r.applyPatches)(this.internalState,e);this.internalState=t,this.messagingSystem.publish(`${this.name}:stateChange`,t,e)}destroy(){this.messagingSystem.clearEventSubscriptions(`${this.name}:stateChange`)}},n.getAnonymizedState=function(e,t){return i(e,t,"anonymous")},n.getPersistentState=function(e,t){return i(e,t,"persist")}}}},{package:"@metamask/ppom-validator>@metamask/base-controller",file:"node_modules/@metamask/ppom-validator/node_modules/@metamask/base-controller/dist/BaseControllerV2.js"}],[151,{lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("lodash");n.default={version:61,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=61;const n=function(e){const t=(new Date).getTime();e.AppStateController?(e.AppStateController.recoveryPhraseReminderHasBeenShown=!1,e.AppStateController.recoveryPhraseReminderLastShown=t):e.AppStateController={recoveryPhraseReminderHasBeenShown:!1,recoveryPhraseReminderLastShown:t};return e}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/061.js"}],[1510,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ControllerMessenger=n.RestrictedControllerMessenger=void 0;class r{constructor({controllerMessenger:e,name:t,allowedActions:n,allowedEvents:r}){this.controllerMessenger=e,this.controllerName=t,this.allowedActions=n||null,this.allowedEvents=r||null}registerActionHandler(e,t){if(!e.startsWith(`${this.controllerName}:`))throw new Error(`Only allowed registering action handlers prefixed by '${this.controllerName}:'`);this.controllerMessenger.registerActionHandler(e,t)}unregisterActionHandler(e){if(!e.startsWith(`${this.controllerName}:`))throw new Error(`Only allowed unregistering action handlers prefixed by '${this.controllerName}:'`);this.controllerMessenger.unregisterActionHandler(e)}call(e,...t){if(null===this.allowedActions)throw new Error("No actions allowed");if(!this.allowedActions.includes(e))throw new Error(`Action missing from allow list: ${e}`);return this.controllerMessenger.call(e,...t)}publish(e,...t){if(!e.startsWith(`${this.controllerName}:`))throw new Error(`Only allowed publishing events prefixed by '${this.controllerName}:'`);this.controllerMessenger.publish(e,...t)}subscribe(e,t,n){if(null===this.allowedEvents)throw new Error("No events allowed");if(!this.allowedEvents.includes(e))throw new Error(`Event missing from allow list: ${e}`);return n?this.controllerMessenger.subscribe(e,t,n):this.controllerMessenger.subscribe(e,t)}unsubscribe(e,t){if(null===this.allowedEvents)throw new Error("No events allowed");if(!this.allowedEvents.includes(e))throw new Error(`Event missing from allow list: ${e}`);this.controllerMessenger.unsubscribe(e,t)}clearEventSubscriptions(e){if(!e.startsWith(`${this.controllerName}:`))throw new Error(`Only allowed clearing events prefixed by '${this.controllerName}:'`);this.controllerMessenger.clearEventSubscriptions(e)}}n.RestrictedControllerMessenger=r;n.ControllerMessenger=class{constructor(){this.actions=new Map,this.events=new Map,this.eventPayloadCache=new Map}registerActionHandler(e,t){if(this.actions.has(e))throw new Error(`A handler for ${e} has already been registered`);this.actions.set(e,t)}unregisterActionHandler(e){this.actions.delete(e)}clearActions(){this.actions.clear()}call(e,...t){const n=this.actions.get(e);if(!n)throw new Error(`A handler for ${e} has not been registered`);return n(...t)}publish(e,...t){const n=this.events.get(e);if(n)for(const[e,r]of n.entries())try{if(r){const n=this.eventPayloadCache.get(e),i=r(...t);i!==n&&(this.eventPayloadCache.set(e,i),e(i,n))}else e(...t)}catch(e){setTimeout((()=>{throw e}))}}subscribe(e,t,n){let r=this.events.get(e);r||(r=new Map,this.events.set(e,r)),r.set(t,n)}unsubscribe(e,t){const n=this.events.get(e);if(!n||!n.has(t))throw new Error(`Subscription not found for event: ${e}`);n.get(t)&&this.eventPayloadCache.delete(t),n.delete(t)}clearEventSubscriptions(e){this.events.delete(e)}clearSubscriptions(){this.events.clear()}getRestricted({name:e,allowedActions:t,allowedEvents:n}){return new r({controllerMessenger:this,name:e,allowedActions:t,allowedEvents:n})}}}}},{package:"@metamask/ppom-validator>@metamask/base-controller",file:"node_modules/@metamask/ppom-validator/node_modules/@metamask/base-controller/dist/ControllerMessenger.js"}],[1511,{"./BaseController":1508,"./BaseControllerV2":1509,"./ControllerMessenger":1510},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){r===undefined&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===undefined&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.getPersistentState=n.getAnonymizedState=n.BaseControllerV2=n.BaseController=void 0;var s=e("./BaseController");Object.defineProperty(n,"BaseController",{enumerable:!0,get:function(){return s.BaseController}});var o=e("./BaseControllerV2");Object.defineProperty(n,"BaseControllerV2",{enumerable:!0,get:function(){return o.BaseController}}),Object.defineProperty(n,"getAnonymizedState",{enumerable:!0,get:function(){return o.getAnonymizedState}}),Object.defineProperty(n,"getPersistentState",{enumerable:!0,get:function(){return o.getPersistentState}}),i(e("./ControllerMessenger"),n)}}},{package:"@metamask/ppom-validator>@metamask/base-controller",file:"node_modules/@metamask/ppom-validator/node_modules/@metamask/base-controller/dist/index.js"}],[1512,{"@metamask/base-controller":1064},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,i,s,o,a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{l(r.next(e))}catch(e){s(e)}}function a(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))},l=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},c=this&&this.__classPrivateFieldSet||function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n};Object.defineProperty(n,"__esModule",{value:!0}),n.QueuedRequestController=n.QueuedRequestControllerEventTypes=n.QueuedRequestControllerActionTypes=n.controllerName=void 0;const u=e("@metamask/base-controller");n.controllerName="QueuedRequestController",n.QueuedRequestControllerActionTypes={enqueueRequest:`${n.controllerName}:enqueueRequest`},n.QueuedRequestControllerEventTypes={countChanged:`${n.controllerName}:countChanged`};class d extends u.BaseController{constructor({messenger:e}){super({name:n.controllerName,metadata:{},messenger:e,state:{}}),r.add(this),this.currentRequest=Promise.resolve(),i.set(this,0),l(this,r,"m",s).call(this)}length(){return l(this,i,"f")}enqueueRequest(e){return a(this,void 0,void 0,(function*(){l(this,r,"m",o).call(this,1),l(this,i,"f")>1&&(yield this.currentRequest),this.currentRequest=e().then((()=>{l(this,r,"m",o).call(this,-1)})).catch((e=>{throw l(this,r,"m",o).call(this,-1),e})),yield this.currentRequest}))}}n.QueuedRequestController=d,i=new WeakMap,r=new WeakSet,s=function(){this.messagingSystem.registerActionHandler(n.QueuedRequestControllerActionTypes.enqueueRequest,this.enqueueRequest.bind(this))},o=function(e){c(this,i,l(this,i,"f")+e,"f"),this.messagingSystem.publish("QueuedRequestController:countChanged",l(this,i,"f"))}}}},{package:"@metamask/queued-request-controller",file:"node_modules/@metamask/queued-request-controller/dist/QueuedRequestController.js"}],[1513,{"./QueuedRequestController":1512,"@metamask/controller-utils":1069,"@metamask/json-rpc-engine":1234,"@metamask/rpc-errors":1525,"@metamask/selected-network-controller":1540},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{l(r.next(e))}catch(e){s(e)}}function a(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.createQueuedRequestMiddleware=void 0;const i=e("@metamask/controller-utils"),s=e("@metamask/json-rpc-engine"),o=e("@metamask/rpc-errors"),a=e("@metamask/selected-network-controller"),l=e("./QueuedRequestController");n.createQueuedRequestMiddleware=({messenger:e,useRequestQueue:t})=>(0,s.createAsyncMiddleware)(((n,s,c)=>r(void 0,void 0,void 0,(function*(){const{origin:u,networkClientId:d}=n;if(!u)throw new Error("Request object is lacking an 'origin'");if(!d)throw new Error("Request object is lacking a 'networkClientId'");var h;t()&&(h=n.method,["eth_sendTransaction","wallet_watchAsset","wallet_switchEthereumChain","eth_signTypedData_v4","wallet_addEthereumChain","wallet_requestPermissions","wallet_requestSnaps","personal_sign","eth_sign","eth_requestAccounts"].includes(h))?yield e.call(l.QueuedRequestControllerActionTypes.enqueueRequest,(()=>r(void 0,void 0,void 0,(function*(){if("wallet_switchEthereumChain"===n.method||"wallet_addEthereumChain"===n.method)return c();const t=e.call("NetworkController:getNetworkClientById",d).configuration,r=e.call("NetworkController:getState"),l=(0,i.isNetworkType)(d);let h;h=l?t:r.networkConfigurations[d];const f=r.providerConfig;if(f.chainId===h.chainId)return c();const p={toNetworkConfiguration:h,fromNetworkConfiguration:f};try{yield e.call("ApprovalController:addRequest",{origin:u,type:i.ApprovalType.SwitchEthereumChain,requestData:p},!0);const t=l?"setProviderType":"setActiveNetwork";yield e.call(`NetworkController:${t}`,d),e.call(a.SelectedNetworkControllerActionTypes.setNetworkClientIdForDomain,u,d)}catch(e){return s.error=(0,o.serializeError)(e),e}return c()})))):c()}))))}}},{package:"@metamask/queued-request-controller",file:"node_modules/@metamask/queued-request-controller/dist/QueuedRequestMiddleware.js"}],[1514,{"./QueuedRequestController":1512,"./QueuedRequestMiddleware":1513},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createQueuedRequestMiddleware=n.QueuedRequestController=n.QueuedRequestControllerEventTypes=n.QueuedRequestControllerActionTypes=void 0;var r=e("./QueuedRequestController");Object.defineProperty(n,"QueuedRequestControllerActionTypes",{enumerable:!0,get:function(){return r.QueuedRequestControllerActionTypes}}),Object.defineProperty(n,"QueuedRequestControllerEventTypes",{enumerable:!0,get:function(){return r.QueuedRequestControllerEventTypes}}),Object.defineProperty(n,"QueuedRequestController",{enumerable:!0,get:function(){return r.QueuedRequestController}});var i=e("./QueuedRequestMiddleware");Object.defineProperty(n,"createQueuedRequestMiddleware",{enumerable:!0,get:function(){return i.createQueuedRequestMiddleware}})}}},{package:"@metamask/queued-request-controller",file:"node_modules/@metamask/queued-request-controller/dist/index.js"}],[1515,{"@metamask/base-controller":1520,"eth-rpc-errors":2704},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{l(r.next(e))}catch(e){s(e)}}function a(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.RateLimitController=void 0;const i=e("eth-rpc-errors"),s=e("@metamask/base-controller"),o="RateLimitController",a={requests:{persist:!1,anonymous:!1}};class l extends s.BaseControllerV2{constructor({rateLimitTimeout:e=5e3,rateLimitCount:t=1,messenger:n,state:r,implementations:i}){const s={requests:Object.keys(i).reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:{}})),{})};super({name:o,metadata:a,messenger:n,state:Object.assign(Object.assign({},s),r)}),this.implementations=i,this.rateLimitTimeout=e,this.rateLimitCount=t,this.messagingSystem.registerActionHandler(`${o}:call`,((e,t,...n)=>this.call(e,t,...n)))}call(e,t,...n){return r(this,void 0,void 0,(function*(){if(this.isRateLimited(t,e))throw i.ethErrors.rpc.limitExceeded({message:`"${t.toString()}" is currently rate-limited. Please try again later.`});this.recordRequest(t,e);const r=this.implementations[t].method;if(!r)throw new Error("Invalid api type");return r(...n)}))}isRateLimited(e,t){var n;const r=null!==(n=this.implementations[e].rateLimitCount)&&void 0!==n?n:this.rateLimitCount;return this.state.requests[e][t]>=r}recordRequest(e,t){var n;const r=null!==(n=this.implementations[e].rateLimitTimeout)&&void 0!==n?n:this.rateLimitTimeout;this.update((n=>{var i;const s=null!==(i=n.requests[e][t])&&void 0!==i?i:0;n.requests[e][t]=s+1,0===s&&setTimeout((()=>this.resetRequestCount(e,t)),r)}))}resetRequestCount(e,t){this.update((n=>{n.requests[e][t]=0}))}}n.RateLimitController=l}}},{package:"@metamask/rate-limit-controller",file:"node_modules/@metamask/rate-limit-controller/dist/RateLimitController.js"}],[1516,{"./RateLimitController":1515},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){r===undefined&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===undefined&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),i(e("./RateLimitController"),n)}}},{package:"@metamask/rate-limit-controller",file:"node_modules/@metamask/rate-limit-controller/dist/index.js"}],[1517,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.BaseController=void 0;class r{constructor(e={},t={}){this.defaultConfig={},this.defaultState={},this.disabled=!1,this.name="BaseController",this.internalConfig=this.defaultConfig,this.internalState=this.defaultState,this.internalListeners=[],this.initialState=t,this.initialConfig=e}initialize(){return this.internalState=this.defaultState,this.internalConfig=this.defaultConfig,this.configure(this.initialConfig),this.update(this.initialState),this}get config(){return this.internalConfig}get state(){return this.internalState}configure(e,t=!1,n=!0){if(n){this.internalConfig=t?e:Object.assign(this.internalConfig,e);for(const e in this.internalConfig)void 0!==this.internalConfig[e]&&(this[e]=this.internalConfig[e])}else for(const t in e)void 0!==this.internalConfig[t]&&(this.internalConfig[t]=e[t],this[t]=e[t])}notify(){this.disabled||this.internalListeners.forEach((e=>{e(this.internalState)}))}subscribe(e){this.internalListeners.push(e)}unsubscribe(e){const t=this.internalListeners.findIndex((t=>e===t));return t>-1&&this.internalListeners.splice(t,1),t>-1}update(e,t=!1){this.internalState=t?Object.assign({},e):Object.assign({},this.internalState,e),this.notify()}}n.BaseController=r,n.default=r}}},{package:"@metamask/rate-limit-controller>@metamask/base-controller",file:"node_modules/@metamask/rate-limit-controller/node_modules/@metamask/base-controller/dist/BaseController.js"}],[1518,{immer:3109},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getPersistentState=n.getAnonymizedState=n.BaseController=void 0;const r=e("immer");(0,r.enablePatches)();function i(e,t,n){return Object.keys(e).reduce(((r,i)=>{try{const s=t[i];if(!s)throw new Error(`No metadata found for '${i}'`);const o=s[n],a=e[i];return"function"==typeof o?r[i]=o(a):o&&(r[i]=a),r}catch(e){return setTimeout((()=>{throw e})),r}}),{})}n.BaseController=class{constructor({messenger:e,metadata:t,name:n,state:r}){this.messagingSystem=e,this.name=n,this.internalState=r,this.metadata=t,this.messagingSystem.registerActionHandler(`${n}:getState`,(()=>this.state))}get state(){return this.internalState}set state(e){throw new Error("Controller state cannot be directly mutated; use 'update' method instead.")}update(e){const[t,n,i]=r.produceWithPatches(this.internalState,e);return this.internalState=t,this.messagingSystem.publish(`${this.name}:stateChange`,t,n),{nextState:t,patches:n,inversePatches:i}}applyPatches(e){const t=(0,r.applyPatches)(this.internalState,e);this.internalState=t,this.messagingSystem.publish(`${this.name}:stateChange`,t,e)}destroy(){this.messagingSystem.clearEventSubscriptions(`${this.name}:stateChange`)}},n.getAnonymizedState=function(e,t){return i(e,t,"anonymous")},n.getPersistentState=function(e,t){return i(e,t,"persist")}}}},{package:"@metamask/rate-limit-controller>@metamask/base-controller",file:"node_modules/@metamask/rate-limit-controller/node_modules/@metamask/base-controller/dist/BaseControllerV2.js"}],[1519,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ControllerMessenger=n.RestrictedControllerMessenger=void 0;class r{constructor({controllerMessenger:e,name:t,allowedActions:n,allowedEvents:r}){this.controllerMessenger=e,this.controllerName=t,this.allowedActions=n||null,this.allowedEvents=r||null}registerActionHandler(e,t){if(!e.startsWith(`${this.controllerName}:`))throw new Error(`Only allowed registering action handlers prefixed by '${this.controllerName}:'`);this.controllerMessenger.registerActionHandler(e,t)}unregisterActionHandler(e){if(!e.startsWith(`${this.controllerName}:`))throw new Error(`Only allowed unregistering action handlers prefixed by '${this.controllerName}:'`);this.controllerMessenger.unregisterActionHandler(e)}call(e,...t){if(null===this.allowedActions)throw new Error("No actions allowed");if(!this.allowedActions.includes(e))throw new Error(`Action missing from allow list: ${e}`);return this.controllerMessenger.call(e,...t)}publish(e,...t){if(!e.startsWith(`${this.controllerName}:`))throw new Error(`Only allowed publishing events prefixed by '${this.controllerName}:'`);this.controllerMessenger.publish(e,...t)}subscribe(e,t,n){if(null===this.allowedEvents)throw new Error("No events allowed");if(!this.allowedEvents.includes(e))throw new Error(`Event missing from allow list: ${e}`);return n?this.controllerMessenger.subscribe(e,t,n):this.controllerMessenger.subscribe(e,t)}unsubscribe(e,t){if(null===this.allowedEvents)throw new Error("No events allowed");if(!this.allowedEvents.includes(e))throw new Error(`Event missing from allow list: ${e}`);this.controllerMessenger.unsubscribe(e,t)}clearEventSubscriptions(e){if(!e.startsWith(`${this.controllerName}:`))throw new Error(`Only allowed clearing events prefixed by '${this.controllerName}:'`);this.controllerMessenger.clearEventSubscriptions(e)}}n.RestrictedControllerMessenger=r;n.ControllerMessenger=class{constructor(){this.actions=new Map,this.events=new Map,this.eventPayloadCache=new Map}registerActionHandler(e,t){if(this.actions.has(e))throw new Error(`A handler for ${e} has already been registered`);this.actions.set(e,t)}unregisterActionHandler(e){this.actions.delete(e)}clearActions(){this.actions.clear()}call(e,...t){const n=this.actions.get(e);if(!n)throw new Error(`A handler for ${e} has not been registered`);return n(...t)}publish(e,...t){const n=this.events.get(e);if(n)for(const[e,r]of n.entries())try{if(r){const n=this.eventPayloadCache.get(e),i=r(...t);i!==n&&(this.eventPayloadCache.set(e,i),e(i,n))}else e(...t)}catch(e){setTimeout((()=>{throw e}))}}subscribe(e,t,n){let r=this.events.get(e);r||(r=new Map,this.events.set(e,r)),r.set(t,n)}unsubscribe(e,t){const n=this.events.get(e);if(!n||!n.has(t))throw new Error(`Subscription not found for event: ${e}`);n.get(t)&&this.eventPayloadCache.delete(t),n.delete(t)}clearEventSubscriptions(e){this.events.delete(e)}clearSubscriptions(){this.events.clear()}getRestricted({name:e,allowedActions:t,allowedEvents:n}){return new r({controllerMessenger:this,name:e,allowedActions:t,allowedEvents:n})}}}}},{package:"@metamask/rate-limit-controller>@metamask/base-controller",file:"node_modules/@metamask/rate-limit-controller/node_modules/@metamask/base-controller/dist/ControllerMessenger.js"}],[152,{lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("lodash");n.default={version:62,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=62;const n=function(e){if(e.MetaMetricsController){const{metaMetricsSendCount:t}=e.MetaMetricsController;t!==undefined&&delete e.MetaMetricsController.metaMetricsSendCount}return e}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/062.js"}],[1520,{"./BaseController":1517,"./BaseControllerV2":1518,"./ControllerMessenger":1519},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){r===undefined&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===undefined&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.getPersistentState=n.getAnonymizedState=n.BaseControllerV2=n.BaseController=void 0;var s=e("./BaseController");Object.defineProperty(n,"BaseController",{enumerable:!0,get:function(){return s.BaseController}});var o=e("./BaseControllerV2");Object.defineProperty(n,"BaseControllerV2",{enumerable:!0,get:function(){return o.BaseController}}),Object.defineProperty(n,"getAnonymizedState",{enumerable:!0,get:function(){return o.getAnonymizedState}}),Object.defineProperty(n,"getPersistentState",{enumerable:!0,get:function(){return o.getPersistentState}}),i(e("./ControllerMessenger"),n)}}},{package:"@metamask/rate-limit-controller>@metamask/base-controller",file:"node_modules/@metamask/rate-limit-controller/node_modules/@metamask/base-controller/dist/index.js"}],[153,{lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("lodash");n.default={version:63,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=63;const n=function(e){var t,n,r,i,s,o,a,l;const c=null==e||null===(t=e.PreferencesController)||void 0===t?void 0:t.accountTokens,u=null==e||null===(n=e.PreferencesController)||void 0===n?void 0:n.accountHiddenTokens,d={};c&&Object.keys(c).forEach((e=>{Object.keys(c[e]).forEach((t=>{const n=c[e][t];d[t]===undefined?d[t]={[e]:n}:d[t]={...d[t],[e]:n}}))}));const h={};u&&Object.keys(u).forEach((e=>{Object.keys(u[e]).forEach((t=>{const n=u[e][t];h[t]===undefined?h[t]={[e]:n}:h[t]={...h[t],[e]:n}}))}));e.TokensController?(e.TokensController.allTokens=d,e.TokensController.allIgnoredTokens=h):e.TokensController={allTokens:d,allIgnoredTokens:h};return null==e||null===(r=e.PreferencesController)||void 0===r||delete r.accountHiddenTokens,null==e||null===(i=e.PreferencesController)||void 0===i||delete i.accountTokens,null==e||null===(s=e.PreferencesController)||void 0===s||delete s.assetImages,null==e||null===(o=e.PreferencesController)||void 0===o||delete o.hiddenTokens,null==e||null===(a=e.PreferencesController)||void 0===a||delete a.tokens,null==e||null===(l=e.PreferencesController)||void 0===l||delete l.suggestedTokens,e}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/063.js"}],[1538,{"@metamask/base-controller":1064,"@metamask/swappable-obj-proxy":1744},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,i,s,o,a,l,c=this&&this.__classPrivateFieldSet||function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},u=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.SelectedNetworkController=n.SelectedNetworkControllerEventTypes=n.SelectedNetworkControllerActionTypes=n.METAMASK_DOMAIN=n.controllerName=void 0;const d=e("@metamask/base-controller"),h=e("@metamask/swappable-obj-proxy");n.controllerName="SelectedNetworkController";const f={domains:{persist:!0,anonymous:!1}};n.METAMASK_DOMAIN="metamask",n.SelectedNetworkControllerActionTypes={getState:`${n.controllerName}:getState`,getNetworkClientIdForDomain:`${n.controllerName}:getNetworkClientIdForDomain`,setNetworkClientIdForDomain:`${n.controllerName}:setNetworkClientIdForDomain`},n.SelectedNetworkControllerEventTypes={stateChange:`${n.controllerName}:stateChange`};class p extends d.BaseController{constructor({messenger:e,state:t={domains:{}},getUseRequestQueue:a}){super({name:n.controllerName,metadata:f,messenger:e,state:t}),r.add(this),i.set(this,new Map),s.set(this,void 0),c(this,s,a,"f"),u(this,r,"m",o).call(this),this.messagingSystem.call("PermissionController:getSubjectNames").filter((e=>this.state.domains[e]===undefined)).forEach((e=>this.setNetworkClientIdForDomain(e,this.messagingSystem.call("NetworkController:getState").selectedNetworkClientId))),this.messagingSystem.subscribe("PermissionController:stateChange",((e,t)=>{t.forEach((({op:e,path:t})=>{if("subjects"===t[0]&&t[1]!==undefined&&"string"==typeof t[1]){const n=t[1];"add"===e&&this.state.domains[n]===undefined?this.setNetworkClientIdForDomain(n,this.messagingSystem.call("NetworkController:getState").selectedNetworkClientId):"remove"===e&&this.state.domains[n]!==undefined&&this.update((({domains:e})=>{delete e[n]}))}}))})),this.messagingSystem.subscribe("NetworkController:stateChange",(({selectedNetworkClientId:e},t)=>{t.forEach((({op:t,path:n})=>{if("remove"===t&&"networkConfigurations"===n[0]){const t=n[1];Object.entries(this.state.domains).forEach((([n,r])=>{r===t&&this.setNetworkClientIdForDomain(n,e)}))}}))}))}setNetworkClientIdForDomain(e,t){if(e===n.METAMASK_DOMAIN)throw new Error(`NetworkClientId for domain "${n.METAMASK_DOMAIN}" cannot be set on the SelectedNetworkController`);if(!u(this,r,"m",l).call(this,e))throw new Error("NetworkClientId for domain cannot be called with a domain that has not yet been granted permissions");u(this,r,"m",a).call(this,e,t)}getNetworkClientIdForDomain(e){var t;const{selectedNetworkClientId:n}=this.messagingSystem.call("NetworkController:getState");return u(this,s,"f").call(this)&&null!==(t=this.state.domains[e])&&void 0!==t?t:n}getProviderAndBlockTracker(e){if(!u(this,s,"f").call(this))throw new Error("Provider and BlockTracker should be fetched from NetworkController when useRequestQueue is false");const t=this.state.domains[e];if(!t)throw new Error("NetworkClientId has not been set for the requested domain");let n=u(this,i,"f").get(e);if(n===undefined){const r=this.messagingSystem.call("NetworkController:getNetworkClientById",t);n={provider:(0,h.createEventEmitterProxy)(r.provider),blockTracker:(0,h.createEventEmitterProxy)(r.blockTracker,{eventFilter:"skipInternal"})},u(this,i,"f").set(e,n)}return n}}n.SelectedNetworkController=p,i=new WeakMap,s=new WeakMap,r=new WeakSet,o=function(){this.messagingSystem.registerActionHandler(n.SelectedNetworkControllerActionTypes.getNetworkClientIdForDomain,this.getNetworkClientIdForDomain.bind(this)),this.messagingSystem.registerActionHandler(n.SelectedNetworkControllerActionTypes.setNetworkClientIdForDomain,this.setNetworkClientIdForDomain.bind(this))},a=function(e,t){const n=this.messagingSystem.call("NetworkController:getNetworkClientById",t),r=u(this,i,"f").get(e);r===undefined?u(this,i,"f").set(e,{provider:(0,h.createEventEmitterProxy)(n.provider),blockTracker:(0,h.createEventEmitterProxy)(n.blockTracker,{eventFilter:"skipInternal"})}):(r.provider.setTarget(n.provider),r.blockTracker.setTarget(n.blockTracker)),this.update((n=>{n.domains[e]=t}))},l=function(e){return this.messagingSystem.call("PermissionController:hasPermissions",e)}}}},{package:"@metamask/selected-network-controller",file:"node_modules/@metamask/selected-network-controller/dist/SelectedNetworkController.js"}],[1539,{"./SelectedNetworkController":1538},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createSelectedNetworkMiddleware=void 0;const r=e("./SelectedNetworkController");n.createSelectedNetworkMiddleware=e=>(t,n,i)=>{if(!t.origin)throw new Error("Request object is lacking an 'origin'");var s;return t.networkClientId=(s=t.origin,e.call(r.SelectedNetworkControllerActionTypes.getNetworkClientIdForDomain,s)),i()}}}},{package:"@metamask/selected-network-controller",file:"node_modules/@metamask/selected-network-controller/dist/SelectedNetworkMiddleware.js"}],[154,{"@metamask/transaction-controller":1755,lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("lodash"),i=e("@metamask/transaction-controller");const s="sentEther";n.default={version:64,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=64;const n=function(e){var t;const n=null==e||null===(t=e.TransactionController)||void 0===t?void 0:t.transactions;if((0,r.isPlainObject)(n))for(const e of Object.values(n))e.type===s&&(e.type=i.TransactionType.simpleSend),e.history&&e.history.map((e=>(e.type&&e.type===s&&(e.type=i.TransactionType.simpleSend),e)));return e}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/064.js"}],[1540,{"./SelectedNetworkController":1538,"./SelectedNetworkMiddleware":1539},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createSelectedNetworkMiddleware=n.METAMASK_DOMAIN=n.SelectedNetworkController=n.SelectedNetworkControllerEventTypes=n.SelectedNetworkControllerActionTypes=void 0;var r=e("./SelectedNetworkController");Object.defineProperty(n,"SelectedNetworkControllerActionTypes",{enumerable:!0,get:function(){return r.SelectedNetworkControllerActionTypes}}),Object.defineProperty(n,"SelectedNetworkControllerEventTypes",{enumerable:!0,get:function(){return r.SelectedNetworkControllerEventTypes}}),Object.defineProperty(n,"SelectedNetworkController",{enumerable:!0,get:function(){return r.SelectedNetworkController}}),Object.defineProperty(n,"METAMASK_DOMAIN",{enumerable:!0,get:function(){return r.METAMASK_DOMAIN}});var i=e("./SelectedNetworkMiddleware");Object.defineProperty(n,"createSelectedNetworkMiddleware",{enumerable:!0,get:function(){return i.createSelectedNetworkMiddleware}})}}},{package:"@metamask/selected-network-controller",file:"node_modules/@metamask/selected-network-controller/dist/index.js"}],[1541,{"@metamask/base-controller":1064,"@metamask/controller-utils":1069,"@metamask/logging-controller":1338,"@metamask/message-manager":1352,"@metamask/rpc-errors":1525,buffer:2461,"ethereumjs-util":2748,events:2788,lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){var r,i,s,o,a,l,c,u,d,h,f,p,m,g,v,b,w,y,_,S,k,E,T,P,C,O,j,M,R,A,N=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{l(r.next(e))}catch(e){s(e)}}function a(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))},I=this&&this.__classPrivateFieldSet||function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},x=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},L=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},B=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.SignatureController=void 0;const D=e("@metamask/base-controller"),U=e("@metamask/controller-utils"),F=e("@metamask/logging-controller"),W=e("@metamask/message-manager"),H=e("@metamask/rpc-errors"),G=e("ethereumjs-util"),q=B(e("events")),$=e("lodash"),V={unapprovedMsgs:{persist:!1,anonymous:!1},unapprovedPersonalMsgs:{persist:!1,anonymous:!1},unapprovedTypedMessages:{persist:!1,anonymous:!1},unapprovedMsgCount:{persist:!1,anonymous:!1},unapprovedPersonalMsgCount:{persist:!1,anonymous:!1},unapprovedTypedMessagesCount:{persist:!1,anonymous:!1}};class z extends D.BaseController{constructor({messenger:e,isEthSignEnabled:t,getAllState:n,securityProviderRequest:c,getCurrentChainId:u}){super({name:"SignatureController",metadata:V,messenger:e,state:{unapprovedMsgs:{},unapprovedPersonalMsgs:{},unapprovedTypedMessages:{},unapprovedMsgCount:0,unapprovedPersonalMsgCount:0,unapprovedTypedMessagesCount:0}}),r.add(this),i.set(this,void 0),s.set(this,void 0),o.set(this,void 0),a.set(this,void 0),l.set(this,void 0),I(this,i,t,"f"),I(this,s,n,"f"),this.hub=new q.default,I(this,o,new W.MessageManager(undefined,undefined,c),"f"),I(this,a,new W.PersonalMessageManager(undefined,undefined,c),"f"),I(this,l,new W.TypedMessageManager(undefined,undefined,c,undefined,u),"f"),x(this,r,"m",k).call(this,x(this,o,"f"),"unapprovedMessage"),x(this,r,"m",k).call(this,x(this,a,"f"),"unapprovedPersonalMessage"),x(this,r,"m",k).call(this,x(this,l,"f"),"unapprovedTypedMessage"),x(this,r,"m",E).call(this,x(this,o,"f"),((e,t,n)=>{e.unapprovedMsgs=t,e.unapprovedMsgCount=n})),x(this,r,"m",E).call(this,x(this,a,"f"),((e,t,n)=>{e.unapprovedPersonalMsgs=t,e.unapprovedPersonalMsgCount=n})),x(this,r,"m",E).call(this,x(this,l,"f"),((e,t,n)=>{e.unapprovedTypedMessages=t,e.unapprovedTypedMessagesCount=n}))}get unapprovedMsgCount(){return x(this,o,"f").getUnapprovedMessagesCount()}get unapprovedPersonalMessagesCount(){return x(this,a,"f").getUnapprovedMessagesCount()}get unapprovedTypedMessagesCount(){return x(this,l,"f").getUnapprovedMessagesCount()}get messages(){return[...x(this,l,"f").getAllMessages(),...x(this,a,"f").getAllMessages(),...x(this,o,"f").getAllMessages()].reduce(((e,t)=>(e[t.id]=t,e)),{})}resetState(){this.update((()=>({unapprovedMsgs:{},unapprovedPersonalMsgs:{},unapprovedTypedMessages:{},unapprovedMsgCount:0,unapprovedPersonalMsgCount:0,unapprovedTypedMessagesCount:0})))}rejectUnapproved(e){x(this,r,"m",b).call(this,x(this,o,"f"),e),x(this,r,"m",b).call(this,x(this,a,"f"),e),x(this,r,"m",b).call(this,x(this,l,"f"),e)}clearUnapproved(){x(this,r,"m",w).call(this,x(this,o,"f")),x(this,r,"m",w).call(this,x(this,a,"f")),x(this,r,"m",w).call(this,x(this,l,"f"))}newUnsignedMessage(e,t){return N(this,void 0,void 0,(function*(){return x(this,r,"m",u).call(this,x(this,o,"f"),U.ApprovalType.EthSign,F.SigningMethod.EthSign,"Message",x(this,r,"m",d).bind(this),e,t,x(this,r,"m",c).bind(this))}))}newUnsignedPersonalMessage(e,t){return N(this,void 0,void 0,(function*(){return x(this,r,"m",u).call(this,x(this,a,"f"),U.ApprovalType.PersonalSign,F.SigningMethod.PersonalSign,"Personal Message",x(this,r,"m",h).bind(this),e,t)}))}newUnsignedTypedMessage(e,t,n,i){return N(this,void 0,void 0,(function*(){const s=x(this,r,"m",A).call(this,n);return x(this,r,"m",u).call(this,x(this,l,"f"),U.ApprovalType.EthSignTypedData,s,"Typed Message",x(this,r,"m",f).bind(this),e,t,undefined,n,i)}))}setDeferredSignSuccess(e,t){x(this,r,"m",p).call(this,x(this,r,"m",m),e,t)}setMessageMetadata(e,t){x(this,r,"m",p).call(this,x(this,r,"m",g),e,t)}setDeferredSignError(e){x(this,r,"m",p).call(this,x(this,r,"m",v),e)}setTypedMessageInProgress(e){x(this,l,"f").setMessageStatusInProgress(e)}setPersonalMessageInProgress(e){x(this,a,"f").setMessageStatusInProgress(e)}}n.SignatureController=z,i=new WeakMap,s=new WeakMap,o=new WeakMap,a=new WeakMap,l=new WeakMap,r=new WeakSet,c=function(e){if(!x(this,i,"f").call(this))throw H.rpcErrors.methodNotFound("eth_sign has been disabled. You must enable it in the advanced settings");const t=x(this,r,"m",C).call(this,e.data);if(66!==t.length&&67!==t.length)throw H.rpcErrors.invalidParams("eth_sign requires 32 byte message hash")},u=function(e,t,n,i,s,o,a,l,c,u){return N(this,void 0,void 0,(function*(){let d;l&&l(o);try{const l=yield e.addUnapprovedMessage(o,a,c),h=Object.assign(Object.assign(Object.assign({},o),{metamaskId:l}),c&&{version:c}),f=e.waitForFinishStatus(h,i);try{x(this,r,"m",R).call(this,n,F.SigningStage.Proposed,h);d=(yield x(this,r,"m",j).call(this,h,t)).resultCallbacks}catch(t){throw x(this,r,"m",R).call(this,n,F.SigningStage.Rejected,h),x(this,r,"m",S).call(this,e,l),H.providerErrors.userRejectedRequest("User rejected the request.")}yield s(h,u);const p=yield f;return x(this,r,"m",R).call(this,n,F.SigningStage.Signed,h),null==d||d.success(p),p}catch(e){throw null==d||d.error(e),e}}))},d=function(e){return N(this,void 0,void 0,(function*(){return yield x(this,r,"m",y).call(this,x(this,o,"f"),U.ApprovalType.EthSign,e,(e=>N(this,void 0,void 0,(function*(){return yield this.messagingSystem.call("KeyringController:signMessage",e)}))))}))},h=function(e){return N(this,void 0,void 0,(function*(){return yield x(this,r,"m",y).call(this,x(this,a,"f"),U.ApprovalType.PersonalSign,e,(e=>N(this,void 0,void 0,(function*(){return yield this.messagingSystem.call("KeyringController:signPersonalMessage",e)}))))}))},f=function(e,t={parseJsonData:!0}){return N(this,void 0,void 0,(function*(){const{version:n}=e;return yield x(this,r,"m",y).call(this,x(this,l,"f"),U.ApprovalType.EthSignTypedData,e,(e=>N(this,void 0,void 0,(function*(){const i=t.parseJsonData?x(this,r,"m",M).call(this,e,n):e;return yield this.messagingSystem.call("KeyringController:signTypedMessage",i,n)}))))}))},p=function(e,...t){const n=[x(this,o,"f"),x(this,a,"f"),x(this,l,"f")];for(const r of n)if(e(r,...t))return!0;throw new Error("Message not found")},m=function(e,t,n){try{return e.setMessageStatusSigned(t,n),!0}catch(e){return!1}},g=function(e,t,n){try{return e.setMetadata(t,n),!0}catch(e){return!1}},v=function(e,t){try{return e.rejectMessage(t),!0}catch(e){return!1}},b=function(e,t){Object.keys(e.getUnapprovedMessages()).forEach((n=>{x(this,r,"m",S).call(this,e,n,t)}))},w=function(e){e.update({unapprovedMessages:{},unapprovedMessagesCount:0})},y=function(e,t,n,i){return N(this,void 0,void 0,(function*(){console.info(`MetaMaskController - ${t}`);const s=n.metamaskId;try{const r=yield e.approveMessage(n);try{const n=yield i(r);return this.hub.emit(`${t}:signed`,{signature:n,messageId:s}),r.deferSetAsSigned||e.setMessageStatusSigned(s,n),n}catch(e){throw this.hub.emit(`${s}:signError`,{error:e}),e}}catch(n){throw console.info(`MetaMaskController - ${t} failed.`,n),x(this,r,"m",_).call(this,e,s,n.message),n}}))},_=function(e,t,n){e instanceof W.TypedMessageManager?e.setMessageStatusErrored(t,n):x(this,r,"m",S).call(this,e,t)},S=function(e,t,n){if(n){const e=x(this,r,"m",O).call(this,t);this.hub.emit("cancelWithReason",{message:e,reason:n})}e.rejectMessage(t)},k=function(e,t){e.hub.on("updateBadge",(()=>{this.hub.emit("updateBadge")})),e.hub.on("unapprovedMessage",(e=>{this.hub.emit(t,e)}))},E=function(e,t){e.subscribe((e=>{const n=x(this,r,"m",T).call(this,e.unapprovedMessages);this.update((()=>{const r=Object.assign({},this.state);return t(r,n,e.unapprovedMessagesCount),r}))}))},T=function(e){const t={};for(const n of Object.keys(e)){const i=e[n],s=x(this,r,"m",P).call(this,i);t[n]=s}return t},P=function(e){const{messageParams:t}=e,n=L(e,["messageParams"]);return Object.assign(Object.assign({},n),{msgParams:t})},C=function(e){return e.startsWith("0x")?e:(0,G.bufferToHex)(t.from(e,"utf8"))},O=function(e){return Object.assign(Object.assign(Object.assign({},this.state.unapprovedMsgs),this.state.unapprovedPersonalMsgs),this.state.unapprovedTypedMessages)[e]},j=function(e,t){return N(this,void 0,void 0,(function*(){const n=e.metamaskId,r=e.origin||U.ORIGIN_METAMASK,i=(0,$.cloneDeep)(e);return yield this.messagingSystem.call("ApprovalController:addRequest",{id:n,origin:r,type:t,requestData:i,expectsResult:!0},!0)}))},M=function(e,t){return"V1"===t||"string"!=typeof e.data?e:Object.assign(Object.assign({},e),{data:JSON.parse(e.data)})},R=function(e,t,n){this.messagingSystem.call("LoggingController:add",{type:F.LogType.EthSignLog,data:{signingMethod:e,stage:t,signingData:n}})},A=function(e){let t=F.SigningMethod.EthSignTypedData;return"V3"===e?t=F.SigningMethod.EthSignTypedDataV3:"V4"===e&&(t=F.SigningMethod.EthSignTypedDataV4),t}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/signature-controller",file:"node_modules/@metamask/signature-controller/dist/SignatureController.js"}],[1542,{"./SignatureController":1541},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){r===undefined&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===undefined&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),i(e("./SignatureController"),n)}}},{package:"@metamask/signature-controller",file:"node_modules/@metamask/signature-controller/dist/index.js"}],[1544,{"./constants":1545,"./types":1547,"./utils":1548,"@ethersproject/bignumber":431,"@ethersproject/bytes":433,"@ethersproject/providers":471,"@metamask/base-controller":1552,"@metamask/controller-utils":1554,"bignumber.js":1559,"lodash/cloneDeep":3332,"lodash/mapValues":3356},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.DEFAULT_INTERVAL=void 0;const i=e("@metamask/base-controller"),s=e("@metamask/controller-utils"),o=e("bignumber.js"),a=e("@ethersproject/bignumber"),l=e("@ethersproject/providers"),c=e("@ethersproject/bytes"),u=r(e("lodash/mapValues")),d=r(e("lodash/cloneDeep")),h=e("./types"),f=e("./utils"),p=e("./constants");n.DEFAULT_INTERVAL=5e3;class m extends i.BaseController{constructor({onNetworkStateChange:e,getNonceLock:t,provider:r,confirmExternalTransaction:i,trackMetaMetricsEvent:s},o,a){super(o,a),this.defaultConfig={interval:n.DEFAULT_INTERVAL,chainId:p.CHAIN_IDS.ETHEREUM,clientId:"default",supportedChainIds:[p.CHAIN_IDS.ETHEREUM,p.CHAIN_IDS.RINKEBY]},this.defaultState={smartTransactionsState:{smartTransactions:{},userOptIn:undefined,userOptInV2:undefined,fees:{approvalTxFees:undefined,tradeTxFees:undefined},liveness:!0}},this.getNonceLock=t,this.ethersProvider=new l.Web3Provider(r),this.confirmExternalTransaction=i,this.trackMetaMetricsEvent=s,this.initialize(),this.initializeSmartTransactionsForChainId(),e((({providerConfig:e})=>{const{chainId:t}=e;this.configure({chainId:t}),this.initializeSmartTransactionsForChainId(),this.checkPoll(this.state),this.ethersProvider=new l.Web3Provider(r)})),this.subscribe((e=>this.checkPoll(e)))}async fetch(e,t){const{clientId:n}=this.config,r=Object.assign(Object.assign({},t),{headers:Object.assign({"Content-Type":"application/json"},n&&{"X-Client-Id":n})});return(0,f.handleFetch)(e,r)}checkPoll(e){const{smartTransactions:t}=e.smartTransactionsState,n=t[this.config.chainId],r=null==n?void 0:n.filter(f.isSmartTransactionPending);!this.timeoutHandle&&(null==r?void 0:r.length)>0?this.poll():this.timeoutHandle&&0===(null==r?void 0:r.length)&&this.stop()}initializeSmartTransactionsForChainId(){var e;if(this.config.supportedChainIds.includes(this.config.chainId)){const{smartTransactionsState:t}=this.state;this.update({smartTransactionsState:Object.assign(Object.assign({},t),{smartTransactions:Object.assign(Object.assign({},t.smartTransactions),{[this.config.chainId]:null!==(e=t.smartTransactions[this.config.chainId])&&void 0!==e?e:[]})})})}}async poll(e){const{chainId:t,supportedChainIds:n}=this.config;e&&this.configure({interval:e},!1,!1),this.timeoutHandle&&clearInterval(this.timeoutHandle),n.includes(t)&&(await(0,s.safelyExecute)((()=>this.updateSmartTransactions())),this.timeoutHandle=setInterval((()=>{(0,s.safelyExecute)((()=>this.updateSmartTransactions()))}),this.config.interval))}async stop(){this.timeoutHandle&&clearInterval(this.timeoutHandle),this.timeoutHandle=undefined}setOptInState(e){this.update({smartTransactionsState:Object.assign(Object.assign({},this.state.smartTransactionsState),{userOptInV2:e})})}trackStxStatusChange(e,t){if(!t)return;let n=(0,d.default)(e);if(n=Object.assign(Object.assign({},(0,d.default)(t)),n),!n.swapMetaData||n.status===t.status&&t.swapMetaData)return;const r={stx_status:n.status,token_from_symbol:n.sourceTokenSymbol,token_to_symbol:n.destinationTokenSymbol,processing_time:(0,f.getStxProcessingTime)(n.time),stx_enabled:!0,current_stx_enabled:!0,stx_user_opt_in:!0};this.trackMetaMetricsEvent({event:"STX Status Updated",category:"swaps",sensitiveProperties:r})}isNewSmartTransaction(e){const{chainId:t}=this.config,{smartTransactionsState:n}=this.state,{smartTransactions:r}=n,i=r[t],s=null==i?void 0:i.findIndex((t=>t.uuid===e));return-1===s||s===undefined}updateSmartTransaction(e){const{chainId:t}=this.config,{smartTransactionsState:n}=this.state,{smartTransactions:r}=n,i=r[t],s=null==i?void 0:i.findIndex((t=>t.uuid===e.uuid)),o=this.isNewSmartTransaction(e.uuid);if(this.trackStxStatusChange(e,o?undefined:i[s]),o){const r=i.findIndex((t=>{var n,r,i;return(null===(n=t.txParams)||void 0===n?void 0:n.nonce)===(null===(r=e.txParams)||void 0===r?void 0:r.nonce)&&(null===(i=t.status)||void 0===i?void 0:i.startsWith("cancelled"))})),s=[(0,d.default)(e)],o=Object.assign(Object.assign({},e),{history:s}),a=r>-1?i.slice(0,r).concat(i.slice(r+1)).concat(o):i.concat(o);this.update({smartTransactionsState:Object.assign(Object.assign({},n),{smartTransactions:Object.assign(Object.assign({},n.smartTransactions),{[t]:a})})})}else{if((e.status===h.SmartTransactionStatuses.SUCCESS||e.status===h.SmartTransactionStatuses.REVERTED)&&!e.confirmed){const t=i[s],n=Object.assign(Object.assign({},t),e);this.confirmSmartTransaction(n)}this.update({smartTransactionsState:Object.assign(Object.assign({},n),{smartTransactions:Object.assign(Object.assign({},n.smartTransactions),{[t]:n.smartTransactions[t].map(((t,n)=>n===s?Object.assign(Object.assign({},t),e):t))})})})}}async updateSmartTransactions(){const{smartTransactions:e}=this.state.smartTransactionsState,{chainId:t}=this.config,n=(null==e?void 0:e[t]).filter(f.isSmartTransactionPending).map((e=>e.uuid));n.length>0&&this.fetchSmartTransactionsStatus(n)}async confirmSmartTransaction(e){var t,n,r;const i=null===(t=e.statusMetadata)||void 0===t?void 0:t.minedHash;try{const t=await this.ethersProvider.getTransactionReceipt(i),s=await this.ethersProvider.getTransaction(i),o=null===(n=s.maxFeePerGas)||void 0===n?void 0:n.toHexString(),l=null===(r=s.maxPriorityFeePerGas)||void 0===r?void 0:r.toHexString();if(null==t?void 0:t.blockNumber){const n=await this.ethersProvider.getBlock(null==t?void 0:t.blockNumber,!1),r=null==n?void 0:n.baseFeePerGas.toHexString(),s=(0,u.default)(t,(e=>e instanceof a.BigNumber?e.toHexString():e)),c=Object.assign(Object.assign({},e.txParams),{maxFeePerGas:o,maxPriorityFeePerGas:l}),d=Object.assign(Object.assign({},e),{id:e.uuid,status:"confirmed",hash:i,txParams:c}),h=(0,f.snapshotFromTxMeta)(d),p=(0,f.replayHistory)(d.history),m=(0,f.generateHistoryEntry)(p,h,"txStateManager: setting status to confirmed"),g=m.length>0?Object.assign(Object.assign({},d),{history:d.history.concat(m)}):d;this.confirmExternalTransaction(g,s,r),this.trackMetaMetricsEvent({event:"STX Confirmed",category:"swaps"}),this.updateSmartTransaction(Object.assign(Object.assign({},e),{confirmed:!0}))}}catch(e){this.trackMetaMetricsEvent({event:"STX Confirmation Failed",category:"swaps"}),console.error("confirm error",e)}}async fetchSmartTransactionsStatus(e){const{chainId:t}=this.config,n=new URLSearchParams({uuids:e.join(",")}),r=`${(0,f.getAPIRequestURL)(h.APIType.BATCH_STATUS,t)}?${n.toString()}`,i=await this.fetch(r);return Object.entries(i).forEach((([e,t])=>{this.updateSmartTransaction({statusMetadata:t,status:(0,f.calculateStatus)(t),cancellable:(0,f.isSmartTransactionCancellable)(t),uuid:e})})),i}async addNonceToTransaction(e){const t=await this.getNonceLock(e.from),n=t.nextNonce;return t.releaseLock(),Object.assign(Object.assign({},e),{nonce:`0x${n.toString(16)}`})}clearFees(){const e={approvalTxFees:undefined,tradeTxFees:undefined};return this.update({smartTransactionsState:Object.assign(Object.assign({},this.state.smartTransactionsState),{fees:e})}),e}async getFees(e,t){const{chainId:n}=this.config,r=[];let i;if(t){const n=await this.addNonceToTransaction(t);r.push(n),i=Object.assign(Object.assign({},e),{nonce:(0,f.incrementNonceInHex)(n.nonce)})}else i=await this.addNonceToTransaction(e);r.push(i);const s=await this.fetch((0,f.getAPIRequestURL)(h.APIType.GET_FEES,n),{method:"POST",body:JSON.stringify({txs:r})});let o,a;return t?(o=null==s?void 0:s.txs[0],a=null==s?void 0:s.txs[1]):a=null==s?void 0:s.txs[0],this.update({smartTransactionsState:Object.assign(Object.assign({},this.state.smartTransactionsState),{fees:{approvalTxFees:o,tradeTxFees:a}})}),{approvalTxFees:o,tradeTxFees:a}}async submitSignedTransactions({txParams:e,signedTransactions:t,signedCanceledTransactions:n}){const{chainId:r}=this.config,i=await this.fetch((0,f.getAPIRequestURL)(h.APIType.SUBMIT_TRANSACTIONS,r),{method:"POST",body:JSON.stringify({rawTxs:t,rawCancelTxs:n})}),s=Date.now();let a;try{const t=await this.ethersProvider.getBalance(null==e?void 0:e.from);a=new o.BigNumber(t.toHexString()).toString(16)}catch(e){console.error("ethers error",e)}const l=await this.getNonceLock(null==e?void 0:e.from);try{const t=(0,c.hexlify)(l.nextNonce);e&&!(null==e?void 0:e.nonce)&&(e.nonce=t);const{nonceDetails:n}=l;this.updateSmartTransaction({chainId:r,nonceDetails:n,preTxBalance:a,status:h.SmartTransactionStatuses.PENDING,time:s,txParams:e,uuid:i.uuid,cancellable:!0})}finally{l.releaseLock()}return i}async cancelSmartTransaction(e){const{chainId:t}=this.config;await this.fetch((0,f.getAPIRequestURL)(h.APIType.CANCEL,t),{method:"POST",body:JSON.stringify({uuid:e})})}async fetchLiveness(){const{chainId:e}=this.config;let t=!1;try{const n=await this.fetch((0,f.getAPIRequestURL)(h.APIType.LIVENESS,e));t=Boolean(n.lastBlock)}catch(e){console.log('"fetchLiveness" API call failed')}return this.update({smartTransactionsState:Object.assign(Object.assign({},this.state.smartTransactionsState),{liveness:t})}),t}async setStatusRefreshInterval(e){e!==this.config.interval&&this.configure({interval:e},!1,!1)}getTransactions({addressFrom:e,status:t}){const{smartTransactions:n}=this.state.smartTransactionsState,{chainId:r}=this.config,i=null==n?void 0:n[r];return i&&0!==i.length?i.filter((n=>{var r;return n.status===t&&(null===(r=n.txParams)||void 0===r?void 0:r.from)===e})):[]}}n.default=m}}},{package:"@metamask/smart-transactions-controller",file:"node_modules/@metamask/smart-transactions-controller/dist/SmartTransactionsController.js"}],[1545,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CHAIN_IDS=n.API_BASE_URL=void 0,n.API_BASE_URL="https://transaction.metaswap.codefi.network",n.CHAIN_IDS={ETHEREUM:"0x1",RINKEBY:"0x4",BSC:"0x38"}}}},{package:"@metamask/smart-transactions-controller",file:"node_modules/@metamask/smart-transactions-controller/dist/constants.js"}],[1546,{"./SmartTransactionsController":1544},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const i=r(e("./SmartTransactionsController"));n.default=i.default}}},{package:"@metamask/smart-transactions-controller",file:"node_modules/@metamask/smart-transactions-controller/dist/index.js"}],[1547,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,i;Object.defineProperty(n,"__esModule",{value:!0}),n.cancellationReasonToStatusMap=n.SmartTransactionStatuses=n.SmartTransactionCancellationReason=n.SmartTransactionMinedTx=n.APIType=void 0,function(e){e[e.GET_FEES=0]="GET_FEES",e[e.ESTIMATE_GAS=1]="ESTIMATE_GAS",e[e.SUBMIT_TRANSACTIONS=2]="SUBMIT_TRANSACTIONS",e[e.CANCEL=3]="CANCEL",e[e.BATCH_STATUS=4]="BATCH_STATUS",e[e.LIVENESS=5]="LIVENESS"}(n.APIType||(n.APIType={})),function(e){e.NOT_MINED="not_mined",e.SUCCESS="success",e.CANCELLED="cancelled",e.REVERTED="reverted",e.UNKNOWN="unknown"}(n.SmartTransactionMinedTx||(n.SmartTransactionMinedTx={})),function(e){e.WOULD_REVERT="would_revert",e.TOO_CHEAP="too_cheap",e.DEADLINE_MISSED="deadline_missed",e.INVALID_NONCE="invalid_nonce",e.USER_CANCELLED="user_cancelled",e.NOT_CANCELLED="not_cancelled",e.PREVIOUS_TX_CANCELLED="previous_tx_cancelled"}(r=n.SmartTransactionCancellationReason||(n.SmartTransactionCancellationReason={})),function(e){e.PENDING="pending",e.SUCCESS="success",e.REVERTED="reverted",e.UNKNOWN="unknown",e.CANCELLED="cancelled",e.CANCELLED_WOULD_REVERT="cancelled_would_revert",e.CANCELLED_TOO_CHEAP="cancelled_too_cheap",e.CANCELLED_DEADLINE_MISSED="cancelled_deadline_missed",e.CANCELLED_INVALID_NONCE="cancelled_invalid_nonce",e.CANCELLED_USER_CANCELLED="cancelled_user_cancelled",e.CANCELLED_PREVIOUS_TX_CANCELLED="cancelled_previous_tx_cancelled",e.RESOLVED="resolved"}(i=n.SmartTransactionStatuses||(n.SmartTransactionStatuses={})),n.cancellationReasonToStatusMap={[r.WOULD_REVERT]:i.CANCELLED_WOULD_REVERT,[r.TOO_CHEAP]:i.CANCELLED_TOO_CHEAP,[r.DEADLINE_MISSED]:i.CANCELLED_DEADLINE_MISSED,[r.INVALID_NONCE]:i.CANCELLED_INVALID_NONCE,[r.USER_CANCELLED]:i.CANCELLED_USER_CANCELLED,[r.PREVIOUS_TX_CANCELLED]:i.CANCELLED_PREVIOUS_TX_CANCELLED}}}},{package:"@metamask/smart-transactions-controller",file:"node_modules/@metamask/smart-transactions-controller/dist/types.js"}],[1548,{"../package.json":1560,"./constants":1545,"./types":1547,"@ethersproject/bytes":433,"bignumber.js":1559,"fast-json-patch":2822,lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.incrementNonceInHex=n.isSmartTransactionCancellable=n.handleFetch=n.mapKeysToCamel=n.getStxProcessingTime=n.snapshotFromTxMeta=n.replayHistory=n.generateHistoryEntry=n.calculateStatus=n.getAPIRequestURL=n.isSmartTransactionStatusResolved=n.isSmartTransactionPending=void 0;const i=r(e("fast-json-patch")),s=r(e("lodash")),o=e("bignumber.js"),a=e("@ethersproject/bytes"),l=r(e("../package.json")),c=e("./types"),u=e("./constants");n.isSmartTransactionPending=function(e){return e.status===c.SmartTransactionStatuses.PENDING};n.isSmartTransactionStatusResolved=e=>"uuid_not_found"===e,n.getAPIRequestURL=function(e,t){const n=parseInt(t,16);switch(e){case c.APIType.GET_FEES:return`${u.API_BASE_URL}/networks/${n}/getFees`;case c.APIType.ESTIMATE_GAS:return`${u.API_BASE_URL}/networks/${n}/estimateGas`;case c.APIType.SUBMIT_TRANSACTIONS:return`${u.API_BASE_URL}/networks/${n}/submitTransactions?stxControllerVersion=${l.default.version}`;case c.APIType.CANCEL:return`${u.API_BASE_URL}/networks/${n}/cancel`;case c.APIType.BATCH_STATUS:return`${u.API_BASE_URL}/networks/${n}/batchStatus`;case c.APIType.LIVENESS:return`${u.API_BASE_URL}/networks/${n}/health`;default:throw new Error("Invalid APIType")}};n.calculateStatus=e=>{if((0,n.isSmartTransactionStatusResolved)(e))return c.SmartTransactionStatuses.RESOLVED;const t=[c.SmartTransactionCancellationReason.WOULD_REVERT,c.SmartTransactionCancellationReason.TOO_CHEAP,c.SmartTransactionCancellationReason.DEADLINE_MISSED,c.SmartTransactionCancellationReason.INVALID_NONCE,c.SmartTransactionCancellationReason.USER_CANCELLED,c.SmartTransactionCancellationReason.PREVIOUS_TX_CANCELLED];if((null==e?void 0:e.minedTx)===c.SmartTransactionMinedTx.NOT_MINED){if(e.cancellationReason===c.SmartTransactionCancellationReason.NOT_CANCELLED)return c.SmartTransactionStatuses.PENDING;const n=t.findIndex((t=>t===e.cancellationReason))>-1;if(e.cancellationReason&&n)return e.isSettled?c.cancellationReasonToStatusMap[e.cancellationReason]:c.SmartTransactionStatuses.PENDING}else{if((null==e?void 0:e.minedTx)===c.SmartTransactionMinedTx.SUCCESS)return c.SmartTransactionStatuses.SUCCESS;if((null==e?void 0:e.minedTx)===c.SmartTransactionMinedTx.CANCELLED)return c.SmartTransactionStatuses.CANCELLED;if((null==e?void 0:e.minedTx)===c.SmartTransactionMinedTx.REVERTED)return c.SmartTransactionStatuses.REVERTED;if((null==e?void 0:e.minedTx)===c.SmartTransactionMinedTx.UNKNOWN)return c.SmartTransactionStatuses.UNKNOWN}return c.SmartTransactionStatuses.UNKNOWN},n.generateHistoryEntry=function(e,t,n){const r=i.default.compare(e,t);return r[0]&&(n&&(r[0].note=n),r[0].timestamp=Date.now()),r},n.replayHistory=function(e){return s.default.cloneDeep(e).reduce(((e,t)=>i.default.applyPatch(e,t).newDocument))},n.snapshotFromTxMeta=function(e){const t=Object.assign({},e);return delete t.history,s.default.cloneDeep(t)};n.getStxProcessingTime=e=>e?Math.round((Date.now()-e)/1e3):undefined;n.mapKeysToCamel=e=>{if(!s.default.isObject(e))return e;const t=s.default.mapValues(e,(e=>s.default.isArray(e)?e.map(n.mapKeysToCamel):s.default.isObject(e)?(0,n.mapKeysToCamel)(e):e));return s.default.mapKeys(t,((e,t)=>s.default.camelCase(t)))},n.handleFetch=async function(e,t){const r=await fetch(e,t),i=await r.json();if(!r.ok)throw console.log("response",r),new Error(`Fetch error:${JSON.stringify(Object.assign({status:r.status},(0,n.mapKeysToCamel)(i)))}`);return i};n.isSmartTransactionCancellable=e=>e.minedTx===c.SmartTransactionMinedTx.NOT_MINED&&(!e.cancellationReason||e.cancellationReason===c.SmartTransactionCancellationReason.NOT_CANCELLED);n.incrementNonceInHex=e=>{const t=new o.BigNumber(e,16).toString(10);return(0,a.hexlify)(Number(t)+1)}}}},{package:"@metamask/smart-transactions-controller",file:"node_modules/@metamask/smart-transactions-controller/dist/utils.js"}],[1549,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.BaseController=void 0;class r{constructor(e={},t={}){this.defaultConfig={},this.defaultState={},this.disabled=!1,this.name="BaseController",this.internalConfig=this.defaultConfig,this.internalState=this.defaultState,this.internalListeners=[],this.initialState=t,this.initialConfig=e}initialize(){return this.internalState=this.defaultState,this.internalConfig=this.defaultConfig,this.configure(this.initialConfig),this.update(this.initialState),this}get config(){return this.internalConfig}get state(){return this.internalState}configure(e,t=!1,n=!0){if(n){this.internalConfig=t?e:Object.assign(this.internalConfig,e);for(const e in this.internalConfig)void 0!==this.internalConfig[e]&&(this[e]=this.internalConfig[e])}else for(const t in e)void 0!==this.internalConfig[t]&&(this.internalConfig[t]=e[t],this[t]=e[t])}notify(){this.disabled||this.internalListeners.forEach((e=>{e(this.internalState)}))}subscribe(e){this.internalListeners.push(e)}unsubscribe(e){const t=this.internalListeners.findIndex((t=>e===t));return t>-1&&this.internalListeners.splice(t,1),t>-1}update(e,t=!1){this.internalState=t?Object.assign({},e):Object.assign({},this.internalState,e),this.notify()}}n.BaseController=r,n.default=r}}},{package:"@metamask/smart-transactions-controller>@metamask/base-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/base-controller/dist/BaseController.js"}],[155,{lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("lodash");n.default={version:65,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=65;const n=function(e){if(e.PreferencesController){const{completedOnboarding:t,firstTimeFlowType:n}=e.PreferencesController;e.OnboardingController=e.OnboardingController??{},t!==undefined&&(e.OnboardingController.completedOnboarding=t,delete e.PreferencesController.completedOnboarding),n!==undefined&&(e.OnboardingController.firstTimeFlowType=n,delete e.PreferencesController.firstTimeFlowType)}return e}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/065.js"}],[1550,{immer:3109},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getPersistentState=n.getAnonymizedState=n.BaseController=void 0;const r=e("immer");(0,r.enablePatches)();function i(e,t,n){return Object.keys(e).reduce(((r,i)=>{try{const s=t[i];if(!s)throw new Error(`No metadata found for '${i}'`);const o=s[n],a=e[i];return"function"==typeof o?r[i]=o(a):o&&(r[i]=a),r}catch(e){return setTimeout((()=>{throw e})),r}}),{})}n.BaseController=class{constructor({messenger:e,metadata:t,name:n,state:r}){this.messagingSystem=e,this.name=n,this.internalState=r,this.metadata=t,this.messagingSystem.registerActionHandler(`${n}:getState`,(()=>this.state))}get state(){return this.internalState}set state(e){throw new Error("Controller state cannot be directly mutated; use 'update' method instead.")}update(e){const[t,n,i]=r.produceWithPatches(this.internalState,e);return this.internalState=t,this.messagingSystem.publish(`${this.name}:stateChange`,t,n),{nextState:t,patches:n,inversePatches:i}}applyPatches(e){const t=(0,r.applyPatches)(this.internalState,e);this.internalState=t,this.messagingSystem.publish(`${this.name}:stateChange`,t,e)}destroy(){this.messagingSystem.clearEventSubscriptions(`${this.name}:stateChange`)}},n.getAnonymizedState=function(e,t){return i(e,t,"anonymous")},n.getPersistentState=function(e,t){return i(e,t,"persist")}}}},{package:"@metamask/smart-transactions-controller>@metamask/base-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/base-controller/dist/BaseControllerV2.js"}],[1551,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ControllerMessenger=n.RestrictedControllerMessenger=void 0;class r{constructor({controllerMessenger:e,name:t,allowedActions:n,allowedEvents:r}){this.controllerMessenger=e,this.controllerName=t,this.allowedActions=n||null,this.allowedEvents=r||null}registerActionHandler(e,t){if(!e.startsWith(`${this.controllerName}:`))throw new Error(`Only allowed registering action handlers prefixed by '${this.controllerName}:'`);this.controllerMessenger.registerActionHandler(e,t)}unregisterActionHandler(e){if(!e.startsWith(`${this.controllerName}:`))throw new Error(`Only allowed unregistering action handlers prefixed by '${this.controllerName}:'`);this.controllerMessenger.unregisterActionHandler(e)}call(e,...t){if(null===this.allowedActions)throw new Error("No actions allowed");if(!this.allowedActions.includes(e))throw new Error(`Action missing from allow list: ${e}`);return this.controllerMessenger.call(e,...t)}publish(e,...t){if(!e.startsWith(`${this.controllerName}:`))throw new Error(`Only allowed publishing events prefixed by '${this.controllerName}:'`);this.controllerMessenger.publish(e,...t)}subscribe(e,t,n){if(null===this.allowedEvents)throw new Error("No events allowed");if(!this.allowedEvents.includes(e))throw new Error(`Event missing from allow list: ${e}`);return n?this.controllerMessenger.subscribe(e,t,n):this.controllerMessenger.subscribe(e,t)}unsubscribe(e,t){if(null===this.allowedEvents)throw new Error("No events allowed");if(!this.allowedEvents.includes(e))throw new Error(`Event missing from allow list: ${e}`);this.controllerMessenger.unsubscribe(e,t)}clearEventSubscriptions(e){if(!e.startsWith(`${this.controllerName}:`))throw new Error(`Only allowed clearing events prefixed by '${this.controllerName}:'`);this.controllerMessenger.clearEventSubscriptions(e)}}n.RestrictedControllerMessenger=r;n.ControllerMessenger=class{constructor(){this.actions=new Map,this.events=new Map,this.eventPayloadCache=new Map}registerActionHandler(e,t){if(this.actions.has(e))throw new Error(`A handler for ${e} has already been registered`);this.actions.set(e,t)}unregisterActionHandler(e){this.actions.delete(e)}clearActions(){this.actions.clear()}call(e,...t){const n=this.actions.get(e);if(!n)throw new Error(`A handler for ${e} has not been registered`);return n(...t)}publish(e,...t){const n=this.events.get(e);if(n)for(const[e,r]of n.entries())try{if(r){const n=this.eventPayloadCache.get(e),i=r(...t);i!==n&&(this.eventPayloadCache.set(e,i),e(i,n))}else e(...t)}catch(e){setTimeout((()=>{throw e}))}}subscribe(e,t,n){let r=this.events.get(e);r||(r=new Map,this.events.set(e,r)),r.set(t,n)}unsubscribe(e,t){const n=this.events.get(e);if(!n||!n.has(t))throw new Error(`Subscription not found for event: ${e}`);n.get(t)&&this.eventPayloadCache.delete(t),n.delete(t)}clearEventSubscriptions(e){this.events.delete(e)}clearSubscriptions(){this.events.clear()}getRestricted({name:e,allowedActions:t,allowedEvents:n}){return new r({controllerMessenger:this,name:e,allowedActions:t,allowedEvents:n})}}}}},{package:"@metamask/smart-transactions-controller>@metamask/base-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/base-controller/dist/ControllerMessenger.js"}],[1552,{"./BaseController":1549,"./BaseControllerV2":1550,"./ControllerMessenger":1551},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){r===undefined&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===undefined&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.getPersistentState=n.getAnonymizedState=n.BaseControllerV2=n.BaseController=void 0;var s=e("./BaseController");Object.defineProperty(n,"BaseController",{enumerable:!0,get:function(){return s.BaseController}});var o=e("./BaseControllerV2");Object.defineProperty(n,"BaseControllerV2",{enumerable:!0,get:function(){return o.BaseController}}),Object.defineProperty(n,"getAnonymizedState",{enumerable:!0,get:function(){return o.getAnonymizedState}}),Object.defineProperty(n,"getPersistentState",{enumerable:!0,get:function(){return o.getPersistentState}}),i(e("./ControllerMessenger"),n)}}},{package:"@metamask/smart-transactions-controller>@metamask/base-controller",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/base-controller/dist/index.js"}],[1553,{"./types":1557},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP=n.ApprovalType=n.ORIGIN_METAMASK=n.OPENSEA_TEST_API_URL=n.OPENSEA_API_URL=n.OPENSEA_PROXY_URL=n.BUILT_IN_NETWORKS=n.TESTNET_TICKER_SYMBOLS=n.ASSET_TYPES=n.GWEI=n.ERC1155_TOKEN_RECEIVER_INTERFACE_ID=n.ERC1155_METADATA_URI_INTERFACE_ID=n.ERC1155_INTERFACE_ID=n.ERC721_ENUMERABLE_INTERFACE_ID=n.ERC721_METADATA_INTERFACE_ID=n.ERC721_INTERFACE_ID=n.ERC20=n.ERC1155=n.ERC721=n.MAX_SAFE_CHAIN_ID=n.GANACHE_CHAIN_ID=n.IPFS_DEFAULT_GATEWAY_URL=n.FALL_BACK_VS_CURRENCY=n.RPC=void 0;const r=e("./types");n.RPC="rpc",n.FALL_BACK_VS_CURRENCY="ETH",n.IPFS_DEFAULT_GATEWAY_URL="https://cloudflare-ipfs.com/ipfs/",n.GANACHE_CHAIN_ID="0x539",n.MAX_SAFE_CHAIN_ID=0xfffffffffffec,n.ERC721="ERC721",n.ERC1155="ERC1155",n.ERC20="ERC20",n.ERC721_INTERFACE_ID="0x80ac58cd",n.ERC721_METADATA_INTERFACE_ID="0x5b5e139f",n.ERC721_ENUMERABLE_INTERFACE_ID="0x780e9d63",n.ERC1155_INTERFACE_ID="0xd9b67a26",n.ERC1155_METADATA_URI_INTERFACE_ID="0x0e89341c",n.ERC1155_TOKEN_RECEIVER_INTERFACE_ID="0x4e2312e0",n.GWEI="gwei",n.ASSET_TYPES={NATIVE:"NATIVE",TOKEN:"TOKEN",NFT:"NFT",UNKNOWN:"UNKNOWN"},n.TESTNET_TICKER_SYMBOLS={GOERLI:"GoerliETH",SEPOLIA:"SepoliaETH",LINEA_GOERLI:"LineaETH"},n.BUILT_IN_NETWORKS={[r.NetworkType.goerli]:{chainId:r.ChainId.goerli,ticker:r.NetworksTicker.goerli,rpcPrefs:{blockExplorerUrl:`https://${r.NetworkType.goerli}.etherscan.io`}},[r.NetworkType.sepolia]:{chainId:r.ChainId.sepolia,ticker:r.NetworksTicker.sepolia,rpcPrefs:{blockExplorerUrl:`https://${r.NetworkType.sepolia}.etherscan.io`}},[r.NetworkType.mainnet]:{chainId:r.ChainId.mainnet,ticker:r.NetworksTicker.mainnet,rpcPrefs:{blockExplorerUrl:"https://etherscan.io"}},[r.NetworkType["linea-goerli"]]:{chainId:r.ChainId["linea-goerli"],ticker:r.NetworksTicker["linea-goerli"],rpcPrefs:{blockExplorerUrl:"https://goerli.lineascan.build"}},[r.NetworkType["linea-mainnet"]]:{chainId:r.ChainId["linea-mainnet"],ticker:r.NetworksTicker["linea-mainnet"],rpcPrefs:{blockExplorerUrl:"https://lineascan.build"}},[r.NetworkType.rpc]:{chainId:undefined,blockExplorerUrl:undefined,rpcPrefs:undefined}},n.OPENSEA_PROXY_URL="https://proxy.metafi.codefi.network/opensea/v1/api/v1",n.OPENSEA_API_URL="https://api.opensea.io/api/v1",n.OPENSEA_TEST_API_URL="https://testnets-api.opensea.io/api/v1",n.ORIGIN_METAMASK="metamask",function(e){e.AddEthereumChain="wallet_addEthereumChain",e.ConnectAccounts="connect_accounts",e.EthDecrypt="eth_decrypt",e.EthGetEncryptionPublicKey="eth_getEncryptionPublicKey",e.EthSign="eth_sign",e.EthSignTypedData="eth_signTypedData",e.PersonalSign="personal_sign",e.ResultError="result_error",e.ResultSuccess="result_success",e.SnapDialogAlert="snap_dialog:alert",e.SnapDialogConfirmation="snap_dialog:confirmation",e.SnapDialogPrompt="snap_dialog:prompt",e.SwitchEthereumChain="wallet_switchEthereumChain",e.Transaction="transaction",e.Unlock="unlock",e.WalletConnect="wallet_connect",e.WalletRequestPermissions="wallet_requestPermissions",e.WatchAsset="wallet_watchAsset"}(n.ApprovalType||(n.ApprovalType={})),n.CHAIN_ID_TO_ETHERS_NETWORK_NAME_MAP={[r.ChainId.goerli]:r.BuiltInNetworkName.Goerli,[r.ChainId.sepolia]:r.BuiltInNetworkName.Sepolia,[r.ChainId.mainnet]:r.BuiltInNetworkName.Mainnet,[r.ChainId["linea-goerli"]]:r.BuiltInNetworkName.LineaGoerli,[r.ChainId["linea-mainnet"]]:r.BuiltInNetworkName.LineaMainnet,[r.ChainId.aurora]:r.BuiltInNetworkName.Aurora}}}},{package:"@metamask/smart-transactions-controller>@metamask/controller-utils",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controller-utils/dist/constants.js"}],[1554,{"./constants":1553,"./siwe":1556,"./types":1557,"./util":1558},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){r===undefined&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===undefined&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),i(e("./constants"),n),i(e("./util"),n),i(e("./types"),n),i(e("./siwe"),n)}}},{package:"@metamask/smart-transactions-controller>@metamask/controller-utils",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controller-utils/dist/index.js"}],[1555,{"@metamask/utils":1806},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createModuleLogger=n.projectLogger=void 0;const r=e("@metamask/utils");Object.defineProperty(n,"createModuleLogger",{enumerable:!0,get:function(){return r.createModuleLogger}}),n.projectLogger=(0,r.createProjectLogger)("controller-utils")}}},{package:"@metamask/smart-transactions-controller>@metamask/controller-utils",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controller-utils/dist/logger.js"}],[1556,{"./logger":1555,"@spruceid/siwe-parser":1996,buffer:2461,"ethereumjs-util":2748},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.detectSIWE=n.isValidSIWEOrigin=n.parseDomainParts=void 0;const r=e("@spruceid/siwe-parser"),i=e("ethereumjs-util"),s=e("./logger"),o=(0,s.createModuleLogger)(s.projectLogger,"detect-siwe");function a(e){try{const r="string"!=typeof(n=e)?n:(0,i.isHexPrefixed)(n)?n.slice(2):n,s=t.from(r,"hex");return 32===s.length?e:s.toString("utf8")}catch(t){return o(t),e}var n}const l={"http:":"80","https:":"443"};n.parseDomainParts=(e,t)=>e.match(/^[^/:]*:\/\//u)?new URL(e):new URL(`${t}//${e}`);n.isValidSIWEOrigin=e=>{var t;try{const{origin:r,siwe:i}=e;if(!r||!(null===(t=null==i?void 0:i.parsedMessage)||void 0===t?void 0:t.domain))return!1;const s=new URL(r),o=(0,n.parseDomainParts)(i.parsedMessage.domain,s.protocol);return 0===o.hostname.localeCompare(s.hostname,undefined,{sensitivity:"accent"})&&(""!==o.port&&o.port!==s.port?""===s.port&&o.port===l[s.protocol]:""===o.username||o.username===s.username)}catch(e){return o(e),!1}};n.detectSIWE=e=>{try{const{data:t}=e,n=a(t);return{isSIWEMessage:!0,parsedMessage:new r.ParsedMessage(n)}}catch(e){return{isSIWEMessage:!1,parsedMessage:null}}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/controller-utils",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controller-utils/dist/siwe.js"}],[1557,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r;Object.defineProperty(n,"__esModule",{value:!0}),n.NetworksTicker=n.ChainId=n.BuiltInNetworkName=n.isNetworkType=n.NetworkType=n.InfuraNetworkType=void 0,n.InfuraNetworkType={mainnet:"mainnet",goerli:"goerli",sepolia:"sepolia","linea-goerli":"linea-goerli","linea-mainnet":"linea-mainnet"},n.NetworkType=Object.assign(Object.assign({},n.InfuraNetworkType),{rpc:"rpc"}),n.isNetworkType=function(e){return Object.values(n.NetworkType).includes(e)},function(e){e.Mainnet="mainnet",e.Goerli="goerli",e.Sepolia="sepolia",e.LineaGoerli="linea-goerli",e.LineaMainnet="linea-mainnet",e.Aurora="aurora"}(r=n.BuiltInNetworkName||(n.BuiltInNetworkName={})),n.ChainId={[r.Mainnet]:"0x1",[r.Goerli]:"0x5",[r.Sepolia]:"0xaa36a7",[r.Aurora]:"0x4e454152",[r.LineaGoerli]:"0xe704",[r.LineaMainnet]:"0xe708"},function(e){e.mainnet="ETH",e.goerli="GoerliETH",e.sepolia="SepoliaETH",e["linea-goerli"]="LineaETH",e["linea-mainnet"]="ETH",e.rpc=""}(n.NetworksTicker||(n.NetworksTicker={}))}}},{package:"@metamask/smart-transactions-controller>@metamask/controller-utils",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controller-utils/dist/types.js"}],[1558,{"./constants":1553,"@metamask/utils":1806,buffer:2461,"eth-ens-namehash":2661,"ethereumjs-util":2748,"ethjs-unit":2786,"fast-deep-equal":2816},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(t){(function(){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{l(r.next(e))}catch(e){s(e)}}function a(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.isValidJson=n.isNonEmptyArray=n.isPlainObject=n.convertHexToDecimal=n.query=n.normalizeEnsName=n.timeoutFetch=n.fetchWithErrorHandling=n.handleFetch=n.successfulFetch=n.isSmartContractCode=n.isValidHexAddress=n.toChecksumHexAddress=n.safelyExecuteWithTimeout=n.safelyExecute=n.toHex=n.fromHex=n.hexToText=n.hexToBN=n.getBuyURL=n.weiHexToGweiDec=n.gweiDecToWEIBN=n.fractionBN=n.BNToHex=n.isSafeChainId=void 0;const s=e("@metamask/utils"),o=i(e("eth-ens-namehash")),a=e("ethereumjs-util"),l=e("ethjs-unit"),c=i(e("fast-deep-equal")),u=e("./constants"),d=new Error("timeout");function h(e){return e?new a.BN((0,a.stripHexPrefix)(e),16):new a.BN(0)}function f(e,t){return r(this,void 0,void 0,(function*(){const n=yield fetch(e,t);if(!n.ok)throw new Error(`Fetch failed with status '${n.status}' for request '${e}'`);return n}))}function p(e,t){return r(this,void 0,void 0,(function*(){const n=yield f(e,t);return yield n.json()}))}n.isSafeChainId=function(e){if(!(0,a.isHexString)(e))return!1;const t=Number.parseInt(e);return Number.isSafeInteger(t)&&t>0&&t<=u.MAX_SAFE_CHAIN_ID},n.BNToHex=function(e){return(0,a.addHexPrefix)(e.toString(16))},n.fractionBN=function(e,t,n){const r=new a.BN(t),i=new a.BN(n);return e.mul(r).div(i)},n.gweiDecToWEIBN=function(e){if(Number.isNaN(e))return new a.BN(0);const t=e.toString().split("."),n=t[0]||"0";let r=t[1]||"";if(!r)return(0,l.toWei)(n,"gwei");if(r.length<=9)return(0,l.toWei)(`${n}.${r}`,"gwei");const i=r.slice(9)[0];r=r.slice(0,9);let s=(0,l.toWei)(`${n}.${r}`,"gwei");return Number(i)>=5&&(s=s.add(new a.BN(1))),s},n.weiHexToGweiDec=function(e){const t=new a.BN((0,a.stripHexPrefix)(e),16);return(0,l.fromWei)(t,"gwei").toString(10)},n.getBuyURL=function(e="1",t,n=5){switch(e){case"1":return`https://buy.coinbase.com/?code=9ec56d01-7e81-5017-930c-513daa27bb6a&amount=${n}&address=${t}&crypto_currency=ETH`;case"5":return"https://goerli-faucet.slock.it/";case"11155111":return"https://sepoliafaucet.net/";default:return undefined}},n.hexToBN=h,n.hexToText=function(e){try{const n=(0,a.stripHexPrefix)(e);return t.from(n,"hex").toString("utf8")}catch(t){return e}},n.fromHex=function(e){return a.BN.isBN(e)?e:new a.BN(h(e).toString(10))},n.toHex=function(e){return"string"==typeof e&&(0,s.isStrictHexString)(e)?e:`0x${a.BN.isBN(e)?e.toString(16):new a.BN(e.toString(),10).toString(16)}`},n.safelyExecute=function(e,t=!1){return r(this,void 0,void 0,(function*(){try{return yield e()}catch(e){return t&&console.error(e),undefined}}))},n.safelyExecuteWithTimeout=function(e,t=!1,n=500){return r(this,void 0,void 0,(function*(){try{return yield Promise.race([e(),new Promise(((e,t)=>setTimeout((()=>{t(d)}),n)))])}catch(e){return t&&console.error(e),undefined}}))},n.toChecksumHexAddress=function(e){const t=(0,a.addHexPrefix)(e);return(0,a.isHexString)(t)?(0,a.toChecksumAddress)(t):t},n.isValidHexAddress=function(e,{allowNonPrefixed:t=!0}={}){const n=t?(0,a.addHexPrefix)(e):e;return!!(0,a.isHexString)(n)&&(0,a.isValidAddress)(n)},n.isSmartContractCode=function(e){return!!e&&("0x"!==e&&"0x0"!==e)},n.successfulFetch=f,n.handleFetch=p,n.fetchWithErrorHandling=function({url:e,options:t,timeout:n,errorCodesToCatch:i}){return r(this,void 0,void 0,(function*(){let r;try{r=n?Promise.race([yield p(e,t),new Promise(((e,t)=>setTimeout((()=>{t(d)}),n)))]):yield p(e,t)}catch(e){!function(e,t=[]){var n;if(!e)return;const r=t.some((t=>{var n;return null===(n=e.message)||void 0===n?void 0:n.includes(`Fetch failed with status '${t}'`)}));if(!(e instanceof Error&&(r||(null===(n=e.message)||void 0===n?void 0:n.includes("Failed to fetch"))||e===d)))throw e;console.error(e)}(e,i)}return r}))},n.timeoutFetch=function(e,t,n=500){return r(this,void 0,void 0,(function*(){return Promise.race([f(e,t),new Promise(((e,t)=>setTimeout((()=>{t(d)}),n)))])}))},n.normalizeEnsName=function(e){if(e&&"string"==typeof e)try{const t=o.default.normalize(e.trim());if(t.match(/^(([\w\d-]+)\.)*[\w\d-]{7,}\.(eth|test)$/u))return t}catch(e){}return null},n.query=function(e,t,n=[]){return new Promise(((r,i)=>{const s=(e,t)=>{e?i(e):r(t)};t in e&&"function"==typeof e[t]?e[t](...n,s):e.sendAsync({method:t,params:n},s)}))};n.convertHexToDecimal=(e="0x0")=>(0,a.isHexString)(e)?parseInt(e,16):Number(e)?Number(e):0,n.isPlainObject=function(e){return Boolean(e)&&"object"==typeof e&&!Array.isArray(e)},n.isNonEmptyArray=function(e){return Array.isArray(e)&&e.length>0},n.isValidJson=function(e){try{return(0,c.default)(e,JSON.parse(JSON.stringify(e)))}catch(e){return!1}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/smart-transactions-controller>@metamask/controller-utils",file:"node_modules/@metamask/smart-transactions-controller/node_modules/@metamask/controller-utils/dist/util.js"}],[1559,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){!function(e){var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,s=Math.floor,o="[BigNumber Error] ",a=o+"Number primitive has more than 15 significant digits: ",l=1e14,c=14,u=9007199254740991,d=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],h=1e7,f=1e9;function p(e){var t=0|e;return e>0||e===t?t:t-1}function m(e){for(var t,n,r=1,i=e.length,s=e[0]+"";r<i;){for(t=e[r++]+"",n=c-t.length;n--;t="0"+t);s+=t}for(i=s.length;48===s.charCodeAt(--i););return s.slice(0,i+1||1)}function g(e,t){var n,r,i=e.c,s=t.c,o=e.s,a=t.s,l=e.e,c=t.e;if(!o||!a)return null;if(n=i&&!i[0],r=s&&!s[0],n||r)return n?r?0:-a:o;if(o!=a)return o;if(n=o<0,r=l==c,!i||!s)return r?0:!i^n?1:-1;if(!r)return l>c^n?1:-1;for(a=(l=i.length)<(c=s.length)?l:c,o=0;o<a;o++)if(i[o]!=s[o])return i[o]>s[o]^n?1:-1;return l==c?0:l>c^n?1:-1}function v(e,t,n,r){if(e<t||e>n||e!==s(e))throw Error(o+(r||"Argument")+("number"==typeof e?e<t||e>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function b(e){var t=e.c.length-1;return p(e.e/c)==t&&e.c[t]%2!=0}function w(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function y(e,t,n){var r,i;if(t<0){for(i=n+".";++t;i+=n);e=i+e}else if(++t>(r=e.length)){for(i=n,t-=r;--t;i+=n);e+=i}else t<r&&(e=e.slice(0,t)+"."+e.slice(t));return e}n=function e(t){var n,_,S,k,E,T,P,C,O,j,M=q.prototype={constructor:q,toString:null,valueOf:null},R=new q(1),A=20,N=4,I=-7,x=21,L=-1e7,B=1e7,D=!1,U=1,F=0,W={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},H="0123456789abcdefghijklmnopqrstuvwxyz",G=!0;function q(e,t){var n,i,o,l,d,h,f,p,m=this;if(!(m instanceof q))return new q(e,t);if(null==t){if(e&&!0===e._isBigNumber)return m.s=e.s,void(!e.c||e.e>B?m.c=m.e=null:e.e<L?m.c=[m.e=0]:(m.e=e.e,m.c=e.c.slice()));if((h="number"==typeof e)&&0*e==0){if(m.s=1/e<0?(e=-e,-1):1,e===~~e){for(l=0,d=e;d>=10;d/=10,l++);return void(l>B?m.c=m.e=null:(m.e=l,m.c=[e]))}p=String(e)}else{if(!r.test(p=String(e)))return S(m,p,h);m.s=45==p.charCodeAt(0)?(p=p.slice(1),-1):1}(l=p.indexOf("."))>-1&&(p=p.replace(".","")),(d=p.search(/e/i))>0?(l<0&&(l=d),l+=+p.slice(d+1),p=p.substring(0,d)):l<0&&(l=p.length)}else{if(v(t,2,H.length,"Base"),10==t&&G)return K(m=new q(e),A+m.e+1,N);if(p=String(e),h="number"==typeof e){if(0*e!=0)return S(m,p,h,t);if(m.s=1/e<0?(p=p.slice(1),-1):1,q.DEBUG&&p.replace(/^0\.0*|\./,"").length>15)throw Error(a+e)}else m.s=45===p.charCodeAt(0)?(p=p.slice(1),-1):1;for(n=H.slice(0,t),l=d=0,f=p.length;d<f;d++)if(n.indexOf(i=p.charAt(d))<0){if("."==i){if(d>l){l=f;continue}}else if(!o&&(p==p.toUpperCase()&&(p=p.toLowerCase())||p==p.toLowerCase()&&(p=p.toUpperCase()))){o=!0,d=-1,l=0;continue}return S(m,String(e),h,t)}h=!1,(l=(p=_(p,t,10,m.s)).indexOf("."))>-1?p=p.replace(".",""):l=p.length}for(d=0;48===p.charCodeAt(d);d++);for(f=p.length;48===p.charCodeAt(--f););if(p=p.slice(d,++f)){if(f-=d,h&&q.DEBUG&&f>15&&(e>u||e!==s(e)))throw Error(a+m.s*e);if((l=l-d-1)>B)m.c=m.e=null;else if(l<L)m.c=[m.e=0];else{if(m.e=l,m.c=[],d=(l+1)%c,l<0&&(d+=c),d<f){for(d&&m.c.push(+p.slice(0,d)),f-=c;d<f;)m.c.push(+p.slice(d,d+=c));d=c-(p=p.slice(d)).length}else d-=f;for(;d--;p+="0");m.c.push(+p)}}else m.c=[m.e=0]}function $(e,t,n,r){var i,s,o,a,l;if(null==n?n=N:v(n,0,8),!e.c)return e.toString();if(i=e.c[0],o=e.e,null==t)l=m(e.c),l=1==r||2==r&&(o<=I||o>=x)?w(l,o):y(l,o,"0");else if(s=(e=K(new q(e),t,n)).e,a=(l=m(e.c)).length,1==r||2==r&&(t<=s||s<=I)){for(;a<t;l+="0",a++);l=w(l,s)}else if(t-=o,l=y(l,s,"0"),s+1>a){if(--t>0)for(l+=".";t--;l+="0");}else if((t+=s-a)>0)for(s+1==a&&(l+=".");t--;l+="0");return e.s<0&&i?"-"+l:l}function V(e,t){for(var n,r,i=1,s=new q(e[0]);i<e.length;i++)(!(r=new q(e[i])).s||(n=g(s,r))===t||0===n&&s.s===t)&&(s=r);return s}function z(e,t,n){for(var r=1,i=t.length;!t[--i];t.pop());for(i=t[0];i>=10;i/=10,r++);return(n=r+n*c-1)>B?e.c=e.e=null:n<L?e.c=[e.e=0]:(e.e=n,e.c=t),e}function K(e,t,n,r){var o,a,u,h,f,p,m,g=e.c,v=d;if(g){e:{for(o=1,h=g[0];h>=10;h/=10,o++);if((a=t-o)<0)a+=c,u=t,f=g[p=0],m=s(f/v[o-u-1]%10);else if((p=i((a+1)/c))>=g.length){if(!r)break e;for(;g.length<=p;g.push(0));f=m=0,o=1,u=(a%=c)-c+1}else{for(f=h=g[p],o=1;h>=10;h/=10,o++);m=(u=(a%=c)-c+o)<0?0:s(f/v[o-u-1]%10)}if(r=r||t<0||null!=g[p+1]||(u<0?f:f%v[o-u-1]),r=n<4?(m||r)&&(0==n||n==(e.s<0?3:2)):m>5||5==m&&(4==n||r||6==n&&(a>0?u>0?f/v[o-u]:0:g[p-1])%10&1||n==(e.s<0?8:7)),t<1||!g[0])return g.length=0,r?(t-=e.e+1,g[0]=v[(c-t%c)%c],e.e=-t||0):g[0]=e.e=0,e;if(0==a?(g.length=p,h=1,p--):(g.length=p+1,h=v[c-a],g[p]=u>0?s(f/v[o-u]%v[u])*h:0),r)for(;;){if(0==p){for(a=1,u=g[0];u>=10;u/=10,a++);for(u=g[0]+=h,h=1;u>=10;u/=10,h++);a!=h&&(e.e++,g[0]==l&&(g[0]=1));break}if(g[p]+=h,g[p]!=l)break;g[p--]=0,h=1}for(a=g.length;0===g[--a];g.pop());}e.e>B?e.c=e.e=null:e.e<L&&(e.c=[e.e=0])}return e}function Q(e){var t,n=e.e;return null===n?e.toString():(t=m(e.c),t=n<=I||n>=x?w(t,n):y(t,n,"0"),e.s<0?"-"+t:t)}return q.clone=e,q.ROUND_UP=0,q.ROUND_DOWN=1,q.ROUND_CEIL=2,q.ROUND_FLOOR=3,q.ROUND_HALF_UP=4,q.ROUND_HALF_DOWN=5,q.ROUND_HALF_EVEN=6,q.ROUND_HALF_CEIL=7,q.ROUND_HALF_FLOOR=8,q.EUCLID=9,q.config=q.set=function(e){var t,n;if(null!=e){if("object"!=typeof e)throw Error(o+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(v(n=e[t],0,f,t),A=n),e.hasOwnProperty(t="ROUNDING_MODE")&&(v(n=e[t],0,8,t),N=n),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((n=e[t])&&n.pop?(v(n[0],-f,0,t),v(n[1],0,f,t),I=n[0],x=n[1]):(v(n,-f,f,t),I=-(x=n<0?-n:n))),e.hasOwnProperty(t="RANGE"))if((n=e[t])&&n.pop)v(n[0],-f,-1,t),v(n[1],1,f,t),L=n[0],B=n[1];else{if(v(n,-f,f,t),!n)throw Error(o+t+" cannot be zero: "+n);L=-(B=n<0?-n:n)}if(e.hasOwnProperty(t="CRYPTO")){if((n=e[t])!==!!n)throw Error(o+t+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw D=!n,Error(o+"crypto unavailable");D=n}else D=n}if(e.hasOwnProperty(t="MODULO_MODE")&&(v(n=e[t],0,9,t),U=n),e.hasOwnProperty(t="POW_PRECISION")&&(v(n=e[t],0,f,t),F=n),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(n=e[t]))throw Error(o+t+" not an object: "+n);W=n}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(n=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(n))throw Error(o+t+" invalid: "+n);G="0123456789"==n.slice(0,10),H=n}}return{DECIMAL_PLACES:A,ROUNDING_MODE:N,EXPONENTIAL_AT:[I,x],RANGE:[L,B],CRYPTO:D,MODULO_MODE:U,POW_PRECISION:F,FORMAT:W,ALPHABET:H}},q.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!q.DEBUG)return!0;var t,n,r=e.c,i=e.e,a=e.s;e:if("[object Array]"=={}.toString.call(r)){if((1===a||-1===a)&&i>=-f&&i<=f&&i===s(i)){if(0===r[0]){if(0===i&&1===r.length)return!0;break e}if((t=(i+1)%c)<1&&(t+=c),String(r[0]).length==t){for(t=0;t<r.length;t++)if((n=r[t])<0||n>=l||n!==s(n))break e;if(0!==n)return!0}}}else if(null===r&&null===i&&(null===a||1===a||-1===a))return!0;throw Error(o+"Invalid BigNumber: "+e)},q.maximum=q.max=function(){return V(arguments,-1)},q.minimum=q.min=function(){return V(arguments,1)},q.random=(k=9007199254740992,E=Math.random()*k&2097151?function(){return s(Math.random()*k)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,n,r,a,l,u=0,h=[],p=new q(R);if(null==e?e=A:v(e,0,f),a=i(e/c),D)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(a*=2));u<a;)(l=131072*t[u]+(t[u+1]>>>11))>=9e15?(n=crypto.getRandomValues(new Uint32Array(2)),t[u]=n[0],t[u+1]=n[1]):(h.push(l%1e14),u+=2);u=a/2}else{if(!crypto.randomBytes)throw D=!1,Error(o+"crypto unavailable");for(t=crypto.randomBytes(a*=7);u<a;)(l=281474976710656*(31&t[u])+1099511627776*t[u+1]+4294967296*t[u+2]+16777216*t[u+3]+(t[u+4]<<16)+(t[u+5]<<8)+t[u+6])>=9e15?crypto.randomBytes(7).copy(t,u):(h.push(l%1e14),u+=7);u=a/7}if(!D)for(;u<a;)(l=E())<9e15&&(h[u++]=l%1e14);for(a=h[--u],e%=c,a&&e&&(l=d[c-e],h[u]=s(a/l)*l);0===h[u];h.pop(),u--);if(u<0)h=[r=0];else{for(r=-1;0===h[0];h.splice(0,1),r-=c);for(u=1,l=h[0];l>=10;l/=10,u++);u<c&&(r-=c-u)}return p.e=r,p.c=h,p}),q.sum=function(){for(var e=1,t=arguments,n=new q(t[0]);e<t.length;)n=n.plus(t[e++]);return n},_=function(){var e="0123456789";function t(e,t,n,r){for(var i,s,o=[0],a=0,l=e.length;a<l;){for(s=o.length;s--;o[s]*=t);for(o[0]+=r.indexOf(e.charAt(a++)),i=0;i<o.length;i++)o[i]>n-1&&(null==o[i+1]&&(o[i+1]=0),o[i+1]+=o[i]/n|0,o[i]%=n)}return o.reverse()}return function(r,i,s,o,a){var l,c,u,d,h,f,p,g,v=r.indexOf("."),b=A,w=N;for(v>=0&&(d=F,F=0,r=r.replace(".",""),f=(g=new q(i)).pow(r.length-v),F=d,g.c=t(y(m(f.c),f.e,"0"),10,s,e),g.e=g.c.length),u=d=(p=t(r,i,s,a?(l=H,e):(l=e,H))).length;0==p[--d];p.pop());if(!p[0])return l.charAt(0);if(v<0?--u:(f.c=p,f.e=u,f.s=o,p=(f=n(f,g,b,w,s)).c,h=f.r,u=f.e),v=p[c=u+b+1],d=s/2,h=h||c<0||null!=p[c+1],h=w<4?(null!=v||h)&&(0==w||w==(f.s<0?3:2)):v>d||v==d&&(4==w||h||6==w&&1&p[c-1]||w==(f.s<0?8:7)),c<1||!p[0])r=h?y(l.charAt(1),-b,l.charAt(0)):l.charAt(0);else{if(p.length=c,h)for(--s;++p[--c]>s;)p[c]=0,c||(++u,p=[1].concat(p));for(d=p.length;!p[--d];);for(v=0,r="";v<=d;r+=l.charAt(p[v++]));r=y(r,u,l.charAt(0))}return r}}(),n=function(){function e(e,t,n){var r,i,s,o,a=0,l=e.length,c=t%h,u=t/h|0;for(e=e.slice();l--;)a=((i=c*(s=e[l]%h)+(r=u*s+(o=e[l]/h|0)*c)%h*h+a)/n|0)+(r/h|0)+u*o,e[l]=i%n;return a&&(e=[a].concat(e)),e}function t(e,t,n,r){var i,s;if(n!=r)s=n>r?1:-1;else for(i=s=0;i<n;i++)if(e[i]!=t[i]){s=e[i]>t[i]?1:-1;break}return s}function n(e,t,n,r){for(var i=0;n--;)e[n]-=i,i=e[n]<t[n]?1:0,e[n]=i*r+e[n]-t[n];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(r,i,o,a,u){var d,h,f,m,g,v,b,w,y,_,S,k,E,T,P,C,O,j=r.s==i.s?1:-1,M=r.c,R=i.c;if(!(M&&M[0]&&R&&R[0]))return new q(r.s&&i.s&&(M?!R||M[0]!=R[0]:R)?M&&0==M[0]||!R?0*j:j/0:NaN);for(y=(w=new q(j)).c=[],j=o+(h=r.e-i.e)+1,u||(u=l,h=p(r.e/c)-p(i.e/c),j=j/c|0),f=0;R[f]==(M[f]||0);f++);if(R[f]>(M[f]||0)&&h--,j<0)y.push(1),m=!0;else{for(T=M.length,C=R.length,f=0,j+=2,(g=s(u/(R[0]+1)))>1&&(R=e(R,g,u),M=e(M,g,u),C=R.length,T=M.length),E=C,S=(_=M.slice(0,C)).length;S<C;_[S++]=0);O=R.slice(),O=[0].concat(O),P=R[0],R[1]>=u/2&&P++;do{if(g=0,(d=t(R,_,C,S))<0){if(k=_[0],C!=S&&(k=k*u+(_[1]||0)),(g=s(k/P))>1)for(g>=u&&(g=u-1),b=(v=e(R,g,u)).length,S=_.length;1==t(v,_,b,S);)g--,n(v,C<b?O:R,b,u),b=v.length,d=1;else 0==g&&(d=g=1),b=(v=R.slice()).length;if(b<S&&(v=[0].concat(v)),n(_,v,S,u),S=_.length,-1==d)for(;t(R,_,C,S)<1;)g++,n(_,C<S?O:R,S,u),S=_.length}else 0===d&&(g++,_=[0]);y[f++]=g,_[0]?_[S++]=M[E]||0:(_=[M[E]],S=1)}while((E++<T||null!=_[0])&&j--);m=null!=_[0],y[0]||y.splice(0,1)}if(u==l){for(f=1,j=y[0];j>=10;j/=10,f++);K(w,o+(w.e=f+h*c-1)+1,a,m)}else w.e=h,w.r=+m;return w}}(),T=/^(-?)0([xbo])(?=\w[\w.]*$)/i,P=/^([^.]+)\.$/,C=/^\.([^.]+)$/,O=/^-?(Infinity|NaN)$/,j=/^\s*\+(?=[\w.])|^\s+|\s+$/g,S=function(e,t,n,r){var i,s=n?t:t.replace(j,"");if(O.test(s))e.s=isNaN(s)?null:s<0?-1:1;else{if(!n&&(s=s.replace(T,(function(e,t,n){return i="x"==(n=n.toLowerCase())?16:"b"==n?2:8,r&&r!=i?e:t})),r&&(i=r,s=s.replace(P,"$1").replace(C,"0.$1")),t!=s))return new q(s,i);if(q.DEBUG)throw Error(o+"Not a"+(r?" base "+r:"")+" number: "+t);e.s=null}e.c=e.e=null},M.absoluteValue=M.abs=function(){var e=new q(this);return e.s<0&&(e.s=1),e},M.comparedTo=function(e,t){return g(this,new q(e,t))},M.decimalPlaces=M.dp=function(e,t){var n,r,i,s=this;if(null!=e)return v(e,0,f),null==t?t=N:v(t,0,8),K(new q(s),e+s.e+1,t);if(!(n=s.c))return null;if(r=((i=n.length-1)-p(this.e/c))*c,i=n[i])for(;i%10==0;i/=10,r--);return r<0&&(r=0),r},M.dividedBy=M.div=function(e,t){return n(this,new q(e,t),A,N)},M.dividedToIntegerBy=M.idiv=function(e,t){return n(this,new q(e,t),0,1)},M.exponentiatedBy=M.pow=function(e,t){var n,r,a,l,u,d,h,f,p=this;if((e=new q(e)).c&&!e.isInteger())throw Error(o+"Exponent not an integer: "+Q(e));if(null!=t&&(t=new q(t)),u=e.e>14,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!e.c||!e.c[0])return f=new q(Math.pow(+Q(p),u?e.s*(2-b(e)):+Q(e))),t?f.mod(t):f;if(d=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new q(NaN);(r=!d&&p.isInteger()&&t.isInteger())&&(p=p.mod(t))}else{if(e.e>9&&(p.e>0||p.e<-1||(0==p.e?p.c[0]>1||u&&p.c[1]>=24e7:p.c[0]<8e13||u&&p.c[0]<=9999975e7)))return l=p.s<0&&b(e)?-0:0,p.e>-1&&(l=1/l),new q(d?1/l:l);F&&(l=i(F/c+2))}for(u?(n=new q(.5),d&&(e.s=1),h=b(e)):h=(a=Math.abs(+Q(e)))%2,f=new q(R);;){if(h){if(!(f=f.times(p)).c)break;l?f.c.length>l&&(f.c.length=l):r&&(f=f.mod(t))}if(a){if(0===(a=s(a/2)))break;h=a%2}else if(K(e=e.times(n),e.e+1,1),e.e>14)h=b(e);else{if(0===(a=+Q(e)))break;h=a%2}p=p.times(p),l?p.c&&p.c.length>l&&(p.c.length=l):r&&(p=p.mod(t))}return r?f:(d&&(f=R.div(f)),t?f.mod(t):l?K(f,F,N,undefined):f)},M.integerValue=function(e){var t=new q(this);return null==e?e=N:v(e,0,8),K(t,t.e+1,e)},M.isEqualTo=M.eq=function(e,t){return 0===g(this,new q(e,t))},M.isFinite=function(){return!!this.c},M.isGreaterThan=M.gt=function(e,t){return g(this,new q(e,t))>0},M.isGreaterThanOrEqualTo=M.gte=function(e,t){return 1===(t=g(this,new q(e,t)))||0===t},M.isInteger=function(){return!!this.c&&p(this.e/c)>this.c.length-2},M.isLessThan=M.lt=function(e,t){return g(this,new q(e,t))<0},M.isLessThanOrEqualTo=M.lte=function(e,t){return-1===(t=g(this,new q(e,t)))||0===t},M.isNaN=function(){return!this.s},M.isNegative=function(){return this.s<0},M.isPositive=function(){return this.s>0},M.isZero=function(){return!!this.c&&0==this.c[0]},M.minus=function(e,t){var n,r,i,s,o=this,a=o.s;if(t=(e=new q(e,t)).s,!a||!t)return new q(NaN);if(a!=t)return e.s=-t,o.plus(e);var u=o.e/c,d=e.e/c,h=o.c,f=e.c;if(!u||!d){if(!h||!f)return h?(e.s=-t,e):new q(f?o:NaN);if(!h[0]||!f[0])return f[0]?(e.s=-t,e):new q(h[0]?o:3==N?-0:0)}if(u=p(u),d=p(d),h=h.slice(),a=u-d){for((s=a<0)?(a=-a,i=h):(d=u,i=f),i.reverse(),t=a;t--;i.push(0));i.reverse()}else for(r=(s=(a=h.length)<(t=f.length))?a:t,a=t=0;t<r;t++)if(h[t]!=f[t]){s=h[t]<f[t];break}if(s&&(i=h,h=f,f=i,e.s=-e.s),(t=(r=f.length)-(n=h.length))>0)for(;t--;h[n++]=0);for(t=l-1;r>a;){if(h[--r]<f[r]){for(n=r;n&&!h[--n];h[n]=t);--h[n],h[r]+=l}h[r]-=f[r]}for(;0==h[0];h.splice(0,1),--d);return h[0]?z(e,h,d):(e.s=3==N?-1:1,e.c=[e.e=0],e)},M.modulo=M.mod=function(e,t){var r,i,s=this;return e=new q(e,t),!s.c||!e.s||e.c&&!e.c[0]?new q(NaN):!e.c||s.c&&!s.c[0]?new q(s):(9==U?(i=e.s,e.s=1,r=n(s,e,0,3),e.s=i,r.s*=i):r=n(s,e,0,U),(e=s.minus(r.times(e))).c[0]||1!=U||(e.s=s.s),e)},M.multipliedBy=M.times=function(e,t){var n,r,i,s,o,a,u,d,f,m,g,v,b,w,y,_=this,S=_.c,k=(e=new q(e,t)).c;if(!(S&&k&&S[0]&&k[0]))return!_.s||!e.s||S&&!S[0]&&!k||k&&!k[0]&&!S?e.c=e.e=e.s=null:(e.s*=_.s,S&&k?(e.c=[0],e.e=0):e.c=e.e=null),e;for(r=p(_.e/c)+p(e.e/c),e.s*=_.s,(u=S.length)<(m=k.length)&&(b=S,S=k,k=b,i=u,u=m,m=i),i=u+m,b=[];i--;b.push(0));for(w=l,y=h,i=m;--i>=0;){for(n=0,g=k[i]%y,v=k[i]/y|0,s=i+(o=u);s>i;)n=((d=g*(d=S[--o]%y)+(a=v*d+(f=S[o]/y|0)*g)%y*y+b[s]+n)/w|0)+(a/y|0)+v*f,b[s--]=d%w;b[s]=n}return n?++r:b.splice(0,1),z(e,b,r)},M.negated=function(){var e=new q(this);return e.s=-e.s||null,e},M.plus=function(e,t){var n,r=this,i=r.s;if(t=(e=new q(e,t)).s,!i||!t)return new q(NaN);if(i!=t)return e.s=-t,r.minus(e);var s=r.e/c,o=e.e/c,a=r.c,u=e.c;if(!s||!o){if(!a||!u)return new q(i/0);if(!a[0]||!u[0])return u[0]?e:new q(a[0]?r:0*i)}if(s=p(s),o=p(o),a=a.slice(),i=s-o){for(i>0?(o=s,n=u):(i=-i,n=a),n.reverse();i--;n.push(0));n.reverse()}for((i=a.length)-(t=u.length)<0&&(n=u,u=a,a=n,t=i),i=0;t;)i=(a[--t]=a[t]+u[t]+i)/l|0,a[t]=l===a[t]?0:a[t]%l;return i&&(a=[i].concat(a),++o),z(e,a,o)},M.precision=M.sd=function(e,t){var n,r,i,s=this;if(null!=e&&e!==!!e)return v(e,1,f),null==t?t=N:v(t,0,8),K(new q(s),e,t);if(!(n=s.c))return null;if(r=(i=n.length-1)*c+1,i=n[i]){for(;i%10==0;i/=10,r--);for(i=n[0];i>=10;i/=10,r++);}return e&&s.e+1>r&&(r=s.e+1),r},M.shiftedBy=function(e){return v(e,-9007199254740991,u),this.times("1e"+e)},M.squareRoot=M.sqrt=function(){var e,t,r,i,s,o=this,a=o.c,l=o.s,c=o.e,u=A+4,d=new q("0.5");if(1!==l||!a||!a[0])return new q(!l||l<0&&(!a||a[0])?NaN:a?o:1/0);if(0==(l=Math.sqrt(+Q(o)))||l==1/0?(((t=m(a)).length+c)%2==0&&(t+="0"),l=Math.sqrt(+t),c=p((c+1)/2)-(c<0||c%2),r=new q(t=l==1/0?"5e"+c:(t=l.toExponential()).slice(0,t.indexOf("e")+1)+c)):r=new q(l+""),r.c[0])for((l=(c=r.e)+u)<3&&(l=0);;)if(s=r,r=d.times(s.plus(n(o,s,u,1))),m(s.c).slice(0,l)===(t=m(r.c)).slice(0,l)){if(r.e<c&&--l,"9999"!=(t=t.slice(l-3,l+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(K(r,r.e+A+2,1),e=!r.times(r).eq(o));break}if(!i&&(K(s,s.e+A+2,0),s.times(s).eq(o))){r=s;break}u+=4,l+=4,i=1}return K(r,r.e+A+1,N,e)},M.toExponential=function(e,t){return null!=e&&(v(e,0,f),e++),$(this,e,t,1)},M.toFixed=function(e,t){return null!=e&&(v(e,0,f),e=e+this.e+1),$(this,e,t)},M.toFormat=function(e,t,n){var r,i=this;if(null==n)null!=e&&t&&"object"==typeof t?(n=t,t=null):e&&"object"==typeof e?(n=e,e=t=null):n=W;else if("object"!=typeof n)throw Error(o+"Argument not an object: "+n);if(r=i.toFixed(e,t),i.c){var s,a=r.split("."),l=+n.groupSize,c=+n.secondaryGroupSize,u=n.groupSeparator||"",d=a[0],h=a[1],f=i.s<0,p=f?d.slice(1):d,m=p.length;if(c&&(s=l,l=c,c=s,m-=s),l>0&&m>0){for(s=m%l||l,d=p.substr(0,s);s<m;s+=l)d+=u+p.substr(s,l);c>0&&(d+=u+p.slice(s)),f&&(d="-"+d)}r=h?d+(n.decimalSeparator||"")+((c=+n.fractionGroupSize)?h.replace(new RegExp("\\d{"+c+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):h):d}return(n.prefix||"")+r+(n.suffix||"")},M.toFraction=function(e){var t,r,i,s,a,l,u,h,f,p,g,v,b=this,w=b.c;if(null!=e&&(!(u=new q(e)).isInteger()&&(u.c||1!==u.s)||u.lt(R)))throw Error(o+"Argument "+(u.isInteger()?"out of range: ":"not an integer: ")+Q(u));if(!w)return new q(b);for(t=new q(R),f=r=new q(R),i=h=new q(R),v=m(w),a=t.e=v.length-b.e-1,t.c[0]=d[(l=a%c)<0?c+l:l],e=!e||u.comparedTo(t)>0?a>0?t:f:u,l=B,B=1/0,u=new q(v),h.c[0]=0;p=n(u,t,0,1),1!=(s=r.plus(p.times(i))).comparedTo(e);)r=i,i=s,f=h.plus(p.times(s=f)),h=s,t=u.minus(p.times(s=t)),u=s;return s=n(e.minus(r),i,0,1),h=h.plus(s.times(f)),r=r.plus(s.times(i)),h.s=f.s=b.s,g=n(f,i,a*=2,N).minus(b).abs().comparedTo(n(h,r,a,N).minus(b).abs())<1?[f,i]:[h,r],B=l,g},M.toNumber=function(){return+Q(this)},M.toPrecision=function(e,t){return null!=e&&v(e,1,f),$(this,e,t,2)},M.toString=function(e){var t,n=this,r=n.s,i=n.e;return null===i?r?(t="Infinity",r<0&&(t="-"+t)):t="NaN":(null==e?t=i<=I||i>=x?w(m(n.c),i):y(m(n.c),i,"0"):10===e&&G?t=y(m((n=K(new q(n),A+i+1,N)).c),n.e,"0"):(v(e,2,H.length,"Base"),t=_(y(m(n.c),i,"0"),10,e,r,!0)),r<0&&n.c[0]&&(t="-"+t)),t},M.valueOf=M.toJSON=function(){return Q(this)},M._isBigNumber=!0,null!=t&&q.set(t),q}(),n.default=n.BigNumber=n,"function"==typeof define&&define.amd?define((function(){return n})):void 0!==t&&t.exports?t.exports=n:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=n)}(this)}}},{package:"@metamask/smart-transactions-controller>bignumber.js",file:"node_modules/@metamask/smart-transactions-controller/node_modules/bignumber.js/bignumber.js"}],[156,{"../../../shared/constants/hardware-wallets":4001,lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("lodash"),i=e("../../../shared/constants/hardware-wallets");n.default={version:66,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=66;const n=function(e){var t;const n=window.navigator.hid?i.LedgerTransportTypes.webhid:i.LedgerTransportTypes.u2f,r=Boolean(null===(t=e.PreferencesController)||void 0===t?void 0:t.useLedgerLive),s={...e,PreferencesController:{...null==e?void 0:e.PreferencesController,ledgerTransportType:r?i.LedgerTransportTypes.live:n}};return delete s.PreferencesController.useLedgerLive,s}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/066.js"}],[1560,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports={name:"@metamask/smart-transactions-controller",version:"6.2.2",description:"Improves success rates for swaps by trialing transactions privately and finding minimum fees",repository:{type:"git",url:"https://github.com/MetaMask/smart-transactions-controller.git"},license:"SEE LICENSE IN LICENSE",main:"dist/index.js",types:"dist/index.d.ts",files:["dist/"],scripts:{build:"tsc --project .","build:clean":"rm -rf dist && yarn build","build:link":"yarn build && cd dist && yarn link && rm -rf node_modules && cd ..",lint:"yarn lint:eslint && yarn lint:misc --check","lint:eslint":"eslint . --cache --ext js,ts","lint:fix":"yarn lint:eslint --fix && yarn lint:misc --write","lint:misc":"prettier '**/*.json' '**/*.md' '!CHANGELOG.md' '**/*.yml' '!.yarnrc.yml' --ignore-path .gitignore",prepack:"./scripts/prepack.sh",test:"jest","test:watch":"jest --watchAll"},dependencies:{"@ethersproject/bignumber":"^5.7.0","@ethersproject/bytes":"^5.7.0","@ethersproject/providers":"^5.7.0","@metamask/base-controller":"^3.2.1","@metamask/controller-utils":"^5.0.0","@metamask/network-controller":"^15.0.0","bignumber.js":"^9.0.1","fast-json-patch":"^3.1.0",lodash:"^4.17.21"},devDependencies:{"@lavamoat/allow-scripts":"^2.3.1","@metamask/auto-changelog":"^3.1.0","@metamask/eslint-config":"^10.0.0","@metamask/eslint-config-jest":"^10.0.0","@metamask/eslint-config-nodejs":"^10.0.0","@metamask/eslint-config-typescript":"^10.0.0","@types/jest":"^26.0.24","@types/lodash":"^4.14.194","@types/node":"^16.18.31","@typescript-eslint/eslint-plugin":"^5.33.0","@typescript-eslint/parser":"^5.33.0",eslint:"^8.21.0","eslint-config-prettier":"^8.8.0","eslint-plugin-import":"^2.27.5","eslint-plugin-jest":"^26.8.2","eslint-plugin-jsdoc":"^39.2.9","eslint-plugin-node":"^11.1.0","eslint-plugin-prettier":"^4.2.1","isomorphic-fetch":"^3.0.0",jest:"^26.4.2",nock:"^13.3.1",prettier:"^2.8.8","prettier-plugin-packagejson":"^2.4.3","ts-jest":"^26.5.6",typescript:"~4.4.4"},packageManager:"yarn@3.2.1",engines:{node:">=16.0.0"},publishConfig:{access:"public",registry:"https://registry.npmjs.org/"},lavamoat:{allowScripts:{"@lavamoat/preinstall-always-fail":!1,"@metamask/controller-utils>ethereumjs-util>ethereum-cryptography>keccak":!1,"@metamask/controller-utils>ethereumjs-util>ethereum-cryptography>secp256k1":!1,"@metamask/controller-utils>babel-runtime>core-js":!1}}}}}},{package:"@metamask/smart-transactions-controller",file:"node_modules/@metamask/smart-transactions-controller/package.json"}],[1561,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-4URGXJP7.js"}],[1562,{"@metamask/snaps-rpc-methods":1668},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("@metamask/snaps-rpc-methods"),i=Object.freeze(["snap_dialog","snap_manageState","snap_notify","snap_getLocale",r.SnapEndowments.Cronjob,r.SnapEndowments.HomePage,r.SnapEndowments.LifecycleHooks,r.SnapEndowments.EthereumProvider,r.SnapEndowments.TransactionInsight,r.SnapEndowments.SignatureInsight]);n.ALLOWED_PERMISSIONS=i}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-5YBORD3A.js"}],[1563,{"./chunk-CFTCANAK.js":1570,"./chunk-EXN2TFDJ.js":1572,"@metamask/post-message-stream":1485},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i,s=e("./chunk-CFTCANAK.js"),o=e("./chunk-EXN2TFDJ.js"),a=e("@metamask/post-message-stream"),l=class extends s.ProxyExecutionService{constructor({documentUrl:e,messenger:t,setupSnapProvider:n}){super({messenger:t,setupSnapProvider:n,stream:new(0,a.BrowserRuntimePostMessageStream)({name:"parent",target:"child"})}),o.__privateAdd.call(void 0,this,r),this.documentUrl=e}async initEnvStream(e){return await o.__privateMethod.call(void 0,this,r,i).call(this),super.initEnvStream(e)}};r=new WeakSet,i=async function(){await chrome.offscreen.hasDocument()||await chrome.offscreen.createDocument({justification:"MetaMask Snaps Execution Environment",reasons:["IFRAME_SCRIPTING"],url:this.documentUrl.toString()})},n.OffscreenExecutionService=l}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-6HI7J27U.js"}],[1564,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=(e=>(e[e.Unverified=0]="Unverified",e[e.Blocked=1]="Blocked",e[e.Verified=2]="Verified",e))(r||{});n.SnapsRegistryStatus=r}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-6N6KZYVD.js"}],[1565,{"./chunk-EXN2TFDJ.js":1572,"@metamask/base-controller":1064,"@metamask/snaps-registry":1613,"@metamask/snaps-utils":1705,"@metamask/utils":1806},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i,s,o,a,l,c,u,d,h,f,p,m,g,v,b,w,y,_,S,k,E,T,P,C,O,j,M=e("./chunk-EXN2TFDJ.js"),R=e("@metamask/base-controller"),A=e("@metamask/snaps-registry"),N=e("@metamask/snaps-utils"),I=e("@metamask/utils"),x={database:null,lastUpdated:null},L=class extends R.BaseController{constructor({messenger:e,state:t,url:n={registry:"https://cdn.jsdelivr.net/gh/MetaMask/snaps-registry@gh-pages/latest/registry.json",signature:"https://cdn.jsdelivr.net/gh/MetaMask/snaps-registry@gh-pages/latest/signature.json"},publicKey:d,fetchFunction:m=globalThis.fetch.bind(globalThis),recentFetchThreshold:v=I.inMilliseconds.call(void 0,5,I.Duration.Minute),failOnUnavailableRegistry:w=!0,refetchOnAllowlistMiss:C=!0}){super({messenger:e,metadata:{database:{persist:!0,anonymous:!1},lastUpdated:{persist:!0,anonymous:!1}},name:"SnapsRegistry",state:{...x,...t}}),M.__privateAdd.call(void 0,this,u),M.__privateAdd.call(void 0,this,h),M.__privateAdd.call(void 0,this,p),M.__privateAdd.call(void 0,this,g),M.__privateAdd.call(void 0,this,b),M.__privateAdd.call(void 0,this,y),M.__privateAdd.call(void 0,this,S),M.__privateAdd.call(void 0,this,E),M.__privateAdd.call(void 0,this,P),M.__privateAdd.call(void 0,this,O),M.__privateAdd.call(void 0,this,r,void 0),M.__privateAdd.call(void 0,this,i,void 0),M.__privateAdd.call(void 0,this,s,void 0),M.__privateAdd.call(void 0,this,o,void 0),M.__privateAdd.call(void 0,this,a,void 0),M.__privateAdd.call(void 0,this,l,void 0),M.__privateAdd.call(void 0,this,c,void 0),M.__privateSet.call(void 0,this,r,n),M.__privateSet.call(void 0,this,i,d),M.__privateSet.call(void 0,this,s,m),M.__privateSet.call(void 0,this,o,v),M.__privateSet.call(void 0,this,a,C),M.__privateSet.call(void 0,this,l,w),M.__privateSet.call(void 0,this,c,null),this.messagingSystem.registerActionHandler("SnapsRegistry:get",(async(...e)=>M.__privateMethod.call(void 0,this,y,_).call(this,...e))),this.messagingSystem.registerActionHandler("SnapsRegistry:getMetadata",(async(...e)=>M.__privateMethod.call(void 0,this,E,T).call(this,...e))),this.messagingSystem.registerActionHandler("SnapsRegistry:resolveVersion",(async(...e)=>M.__privateMethod.call(void 0,this,S,k).call(this,...e))),this.messagingSystem.registerActionHandler("SnapsRegistry:update",(async()=>M.__privateMethod.call(void 0,this,h,f).call(this)))}};r=new WeakMap,i=new WeakMap,s=new WeakMap,o=new WeakMap,a=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakSet,d=function(){return this.state.lastUpdated&&Date.now()-this.state.lastUpdated<M.__privateGet.call(void 0,this,o)},h=new WeakSet,f=async function(){M.__privateGet.call(void 0,this,c)?await M.__privateGet.call(void 0,this,c):(null===M.__privateGet.call(void 0,this,c)&&M.__privateSet.call(void 0,this,c,M.__privateMethod.call(void 0,this,p,m).call(this)),await M.__privateGet.call(void 0,this,c),M.__privateSet.call(void 0,this,c,null))},p=new WeakSet,m=async function(){if(!M.__privateMethod.call(void 0,this,u,d).call(this))try{const e=await M.__privateMethod.call(void 0,this,O,j).call(this,M.__privateGet.call(void 0,this,r).registry);if(M.__privateGet.call(void 0,this,i)){const t=await M.__privateMethod.call(void 0,this,O,j).call(this,M.__privateGet.call(void 0,this,r).signature);M.__privateMethod.call(void 0,this,P,C).call(this,e,t)}this.update((t=>{t.database=JSON.parse(e),t.lastUpdated=Date.now()}))}catch{}},g=new WeakSet,v=async function(){if(null===this.state.database&&await M.__privateMethod.call(void 0,this,h,f).call(this),M.__privateGet.call(void 0,this,l)&&null===this.state.database)throw new Error("Snaps registry is unavailable, installation blocked.");return this.state.database},b=new WeakSet,w=async function(e,t,n=!1){const r=await M.__privateMethod.call(void 0,this,g,v).call(this),i=r?.blockedSnaps.find((n=>"id"in n?n.id===e&&I.satisfiesVersionRange.call(void 0,t.version,n.versionRange):n.checksum===t.checksum));if(i)return{status:1,reason:i.reason};const s=r?.verifiedSnaps[e],o=s?.versions?.[t.version];return o&&o.checksum===t.checksum?{status:2}:M.__privateGet.call(void 0,this,a)&&!n?(await M.__privateMethod.call(void 0,this,h,f).call(this),M.__privateMethod.call(void 0,this,b,w).call(this,e,t,!0)):{status:0}},y=new WeakSet,_=async function(e){return Object.entries(e).reduce((async(e,[t,n])=>{const r=await M.__privateMethod.call(void 0,this,b,w).call(this,t,n),i=await e;return i[t]=r,i}),Promise.resolve({}))},S=new WeakSet,k=async function(e,t,n=!1){const r=await M.__privateMethod.call(void 0,this,g,v).call(this),i=r?.verifiedSnaps[e]?.versions??null;if(!i&&M.__privateGet.call(void 0,this,a)&&!n)return await M.__privateMethod.call(void 0,this,h,f).call(this),M.__privateMethod.call(void 0,this,S,k).call(this,e,t,!0);if(!i)return t;const s=N.getTargetVersion.call(void 0,Object.keys(i),t);return s||!M.__privateGet.call(void 0,this,a)||n?s?(I.assertIsSemVerRange.call(void 0,s),s):t:(await M.__privateMethod.call(void 0,this,h,f).call(this),M.__privateMethod.call(void 0,this,S,k).call(this,e,t,!0))},E=new WeakSet,T=async function(e){const t=await M.__privateMethod.call(void 0,this,g,v).call(this);return t?.verifiedSnaps[e]?.metadata??null},P=new WeakSet,C=function(e,t){I.assert.call(void 0,M.__privateGet.call(void 0,this,i),"No public key provided.");const n=A.verify.call(void 0,{registry:e,signature:JSON.parse(t),publicKey:M.__privateGet.call(void 0,this,i)});I.assert.call(void 0,n,"Invalid registry signature.")},O=new WeakSet,j=async function(e){const t=await M.__privateGet.call(void 0,this,s).call(this,e);if(!t.ok)throw new Error(`Failed to fetch ${e}.`);return await t.text()},n.JsonSnapsRegistry=L}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-7JY5VENP.js"}],[1566,{"./chunk-LWBPKSU2.js":1578,"./chunk-RDBT3ZJQ.js":1585,"./chunk-XWDEGRM5.js":1592,"@metamask/utils":1806},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("./chunk-XWDEGRM5.js"),i=e("./chunk-LWBPKSU2.js"),s=e("./chunk-RDBT3ZJQ.js"),o=e("@metamask/utils");n.detectSnapLocation=function(e,t){const n=t?.allowHttp??!1,a=t?.allowLocal??!1,l=new URL(e);switch(l.protocol){case"npm:":return new(0,r.NpmLocation)(l,t);case"local:":return o.assert.call(void 0,a,new TypeError("Fetching local snaps is disabled.")),new(0,i.LocalLocation)(l,t);case"http:":case"https:":return o.assert.call(void 0,n,new TypeError("Fetching snaps through http/https is disabled.")),new(0,s.HttpLocation)(l,t);default:throw new TypeError(`Unrecognized "${l.protocol}" snap location protocol.`)}}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-7WOG63YY.js"}],[1567,{"./chunk-EXN2TFDJ.js":1572,"@metamask/post-message-stream":1485},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i,s,o,a=e("./chunk-EXN2TFDJ.js"),l=e("@metamask/post-message-stream"),c=class extends l.BasePostMessageStream{constructor({stream:e,jobId:t}){super(),a.__privateAdd.call(void 0,this,s),a.__privateAdd.call(void 0,this,r,void 0),a.__privateAdd.call(void 0,this,i,void 0),a.__privateSet.call(void 0,this,r,e),a.__privateSet.call(void 0,this,i,t),a.__privateGet.call(void 0,this,r).on("data",a.__privateMethod.call(void 0,this,s,o).bind(this))}_postMessage(e){a.__privateGet.call(void 0,this,r).write({jobId:a.__privateGet.call(void 0,this,i),data:e})}};r=new WeakMap,i=new WeakMap,s=new WeakSet,o=function(e){e.jobId===a.__privateGet.call(void 0,this,i)&&this.push(e.data)},n.ProxyPostMessageStream=c}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-7Y6P5FRN.js"}],[1568,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.RequestQueue=class{constructor(e){this.maxQueueSize=e,this.queueSizes=new Map}increment(e){const t=this.queueSizes.get(e)??0;if(t>=this.maxQueueSize)throw new Error("Maximum number of requests reached. Try again later.");this.queueSizes.set(e,t+1)}decrement(e){const t=this.queueSizes.get(e)??0;if(0===t)throw new Error(`Cannot decrement, ${e} does not have any outstanding requests.`);this.queueSizes.set(e,t-1)}get(e){return this.queueSizes.get(e)??0}}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-AP7CJ6DA.js"}],[1569,{"@metamask/utils":1806,"@xstate/fsm":2081},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("@metamask/utils"),i=e("@xstate/fsm");n.validateMachine=function(e){r.assert.call(void 0,"_options"in e,"The machine is not an @xstate/fsm machine");const t=e,n=new Set,i=e=>{return(t=e,Array.isArray(t)?t:null==t?[]:[t]).flatMap((e=>"string"==typeof e?[e]:(r.assert.call(void 0,"function"==typeof e),[]))).forEach(n.add.bind(n));var t};for(const e of Object.values(t.config.states)){i(e.entry),i(e.exit);for(const t of Object.values(e.on??{}))i(t.actions)}n.forEach((e=>r.assert.call(void 0,void 0!==t._options.actions&&e in t._options.actions,`Action "${e}" doesn't have an implementation`)))},n.forceStrict=function(e){let t=!1;e.subscribe((e=>{r.assert.call(void 0,!t||e.changed,"Invalid state transition"),t=!0}));const n=e.send.bind(e);e.send=(...t)=>(r.assert.call(void 0,e.status===i.InterpreterStatus.Running,"Interpreter is stopped"),n(...t))}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-BO2ZDPWV.js"}],[157,{"../../../shared/constants/network":4006,"bignumber.js":2366,lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,i=e("lodash"),s=(r=e("bignumber.js"))&&r.__esModule?r:{default:r},o=e("../../../shared/constants/network");const a=e=>new s.default(e||"0x0",16).gt(0);n.default={version:67,async migrate(e){const t=(0,i.cloneDeep)(e);t.meta.version=67;const n=function(e){var t,n,r;const i=(null==e?void 0:e.PreferencesController)||{},s=i.preferences||{};if(s.showTestNetworks)return e;const l=(null==e||null===(t=e.TransactionController)||void 0===t?void 0:t.transactions)||{},c=(null===(n=e.NetworkController)||void 0===n?void 0:n.provider)||{},u=(null===(r=e.CachedBalancesController)||void 0===r?void 0:r.cachedBalances)||{},d=o.TEST_CHAINS.includes(null==c?void 0:c.chainId),h=Object.values(l).some((({chainId:e})=>o.TEST_CHAINS.includes(e))),f=o.TEST_CHAINS.some((e=>Object.values(u[e]||{}).some(a))),p=d||h||f,m={...e,PreferencesController:{...i,preferences:{...s,showTestNetworks:p}}};return m}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/067.js"}],[1570,{"./chunk-7Y6P5FRN.js":1567,"./chunk-EXN2TFDJ.js":1572,"./chunk-VJZI4VSJ.js":1587,nanoid:1596},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i=e("./chunk-VJZI4VSJ.js"),s=e("./chunk-7Y6P5FRN.js"),o=e("./chunk-EXN2TFDJ.js"),a=e("nanoid"),l=class extends i.AbstractExecutionService{constructor({stream:e,messenger:t,setupSnapProvider:n}){super({messenger:t,setupSnapProvider:n}),o.__privateAdd.call(void 0,this,r,void 0),o.__privateSet.call(void 0,this,r,e)}async terminateJob(e){o.__privateGet.call(void 0,this,r).write({jobId:e.id,data:{jsonrpc:"2.0",method:"terminateJob",id:a.nanoid.call(void 0)}})}async initEnvStream(e){return{worker:e,stream:new(0,s.ProxyPostMessageStream)({stream:o.__privateGet.call(void 0,this,r),jobId:e})}}};r=new WeakMap,n.ProxyExecutionService=l}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-CFTCANAK.js"}],[1571,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-D74XJG2L.js"}],[1572,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=(t=>void 0!==e?e:"undefined"!=typeof Proxy?new Proxy(t,{get:(t,n)=>(void 0!==e?e:t)[n]}):t)((function(t){if(void 0!==e)return e.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')})),i=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};n.__require=r,n.__privateGet=(e,t,n)=>(i(e,t,"read from private field"),n?n.call(e):t.get(e)),n.__privateAdd=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},n.__privateSet=(e,t,n,r)=>(i(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),n.__privateMethod=(e,t,n)=>(i(e,t,"access private method"),n)}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-EXN2TFDJ.js"}],[1573,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-G66GQJS6.js"}],[1574,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-HOY6NKQR.js"}],[1575,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-JAUAKTUL.js"}],[1576,{"@metamask/snaps-sdk":1669},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("@metamask/snaps-sdk"),i=(e,t)=>t.value??e[t.name]??null,s=(e,t,n)=>{const r=e[n],i=r?.[t.name];return t.value??i??null},o=(e,t)=>{r.assert.call(void 0,void 0===e[t],`Duplicate component names are not allowed, found multiple instances of: "${t}".`)},a=(e,t,n={})=>{const{type:l}=t;return l===r.NodeType.Panel?t.children.reduce(((t,n)=>a(e,n,t)),n):(l===r.NodeType.Form&&(o(n,t.name),n[t.name]=t.children.reduce(((n,i)=>(i.type===r.NodeType.Input&&(o(n,i.name),n[i.name]=s(e,i,t.name)),n)),{})),l===r.NodeType.Input&&(o(n,t.name),n[t.name]=i(e,t)),n)};n.constructInputState=i,n.constructFormInputState=s,n.assertNameIsUnique=o,n.constructState=a}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-KLK7ZRMH.js"}],[1577,{"./chunk-VJZI4VSJ.js":1587,"@metamask/post-message-stream":1485,"@metamask/snaps-utils":1705},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("./chunk-VJZI4VSJ.js"),i=e("@metamask/post-message-stream"),s=e("@metamask/snaps-utils"),o=class extends r.AbstractExecutionService{constructor({iframeUrl:e,messenger:t,setupSnapProvider:n}){super({messenger:t,setupSnapProvider:n}),this.iframeUrl=e}terminateJob(e){document.getElementById(e.id)?.remove()}async initEnvStream(e){const t=await s.createWindow.call(void 0,this.iframeUrl.toString(),e);return{worker:t,stream:new(0,i.WindowPostMessageStream)({name:"parent",target:"child",targetWindow:t,targetOrigin:"*"})}}};n.IframeExecutionService=o}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-LAVQZHSH.js"}],[1578,{"./chunk-EXN2TFDJ.js":1572,"./chunk-RDBT3ZJQ.js":1585,"@metamask/snaps-utils":1705,"@metamask/utils":1806},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i=e("./chunk-RDBT3ZJQ.js"),s=e("./chunk-EXN2TFDJ.js"),o=e("@metamask/snaps-utils"),a=e("@metamask/utils");function l(e){return a.assert.call(void 0,void 0!==e.data.canonicalPath),e.data.canonicalPath=`local:${e.data.canonicalPath}`,e}r=new WeakMap,n.LocalLocation=class{constructor(e,t={}){s.__privateAdd.call(void 0,this,r,void 0),a.assertStruct.call(void 0,e.toString(),o.LocalSnapIdStruct,"Invalid Snap Id"),a.assert.call(void 0,void 0===t.fetchOptions,"Currently adding fetch options to local: is unsupported."),s.__privateSet.call(void 0,this,r,new(0,i.HttpLocation)(new URL(e.toString().slice(o.SnapIdPrefixes.local.length)),{...t,fetchOptions:{cache:"no-cache"}}))}async manifest(){return l(await s.__privateGet.call(void 0,this,r).manifest())}async fetch(e){return l(await s.__privateGet.call(void 0,this,r).fetch(e))}get shouldAlwaysReload(){return!0}}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-LWBPKSU2.js"}],[1579,{"./chunk-EXN2TFDJ.js":1572,"./chunk-NOLPMHXS.js":1580,"./chunk-YYPUPKQY.js":1593,"@metamask/base-controller":1064,"@metamask/snaps-rpc-methods":1668,"@metamask/snaps-utils":1705,"@metamask/utils":1806},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i,s,o,a=e("./chunk-YYPUPKQY.js"),l=e("./chunk-NOLPMHXS.js"),c=e("./chunk-EXN2TFDJ.js"),u=e("@metamask/base-controller"),d=e("@metamask/snaps-rpc-methods"),h=e("@metamask/snaps-utils"),f=e("@metamask/utils"),p=f.inMilliseconds.call(void 0,24,f.Duration.Hour),m=class extends u.BaseController{constructor({messenger:e,state:t}){super({messenger:e,metadata:{jobs:{persist:!0,anonymous:!1}},name:"CronjobController",state:{jobs:{},...t}}),c.__privateAdd.call(void 0,this,r,void 0),c.__privateAdd.call(void 0,this,i,void 0),c.__privateAdd.call(void 0,this,s,void 0),c.__privateAdd.call(void 0,this,o,void 0),c.__privateSet.call(void 0,this,s,new Map),c.__privateSet.call(void 0,this,o,new Map),c.__privateSet.call(void 0,this,r,e),this._handleSnapRegisterEvent=this._handleSnapRegisterEvent.bind(this),this._handleSnapUnregisterEvent=this._handleSnapUnregisterEvent.bind(this),this._handleEventSnapUpdated=this._handleEventSnapUpdated.bind(this),this.messagingSystem.subscribe("SnapController:snapInstalled",this._handleSnapRegisterEvent),this.messagingSystem.subscribe("SnapController:snapUninstalled",this._handleSnapUnregisterEvent),this.messagingSystem.subscribe("SnapController:snapEnabled",this._handleSnapRegisterEvent),this.messagingSystem.subscribe("SnapController:snapDisabled",this._handleSnapUnregisterEvent),this.messagingSystem.subscribe("SnapController:snapUpdated",this._handleEventSnapUpdated),this.dailyCheckIn().catch((e=>{h.logError.call(void 0,e)}))}getAllJobs(){const e=this.messagingSystem.call("SnapController:getAll");return a.getRunnableSnaps.call(void 0,e).map((e=>this.getSnapJobs(e.id))).flat().filter((e=>void 0!==e))}getSnapJobs(e){const t=c.__privateGet.call(void 0,this,r).call("PermissionController:getPermissions",e),n=t?.[d.SnapEndowments.Cronjob],i=d.getCronjobCaveatJobs.call(void 0,n);return i?.map(((t,n)=>({...t,id:`${e}-${n}`,snapId:e})))}register(e){const t=this.getSnapJobs(e);t?.forEach((e=>this.schedule(e)))}schedule(e){if(c.__privateGet.call(void 0,this,s).has(e.id))return;const t=h.parseCronExpression.call(void 0,e.expression).next(),n=new Date,r=t.getTime()-n.getTime();if(r>p)return;const i=new(0,l.Timer)(r);i.start((()=>{this.executeCronjob(e).catch((e=>{h.logError.call(void 0,e)})),c.__privateGet.call(void 0,this,s).delete(e.id),this.schedule(e)})),this.state.jobs[e.id]?.lastRun||this.updateJobLastRunState(e.id,0),c.__privateGet.call(void 0,this,s).set(e.id,i),c.__privateGet.call(void 0,this,o).set(e.id,e.snapId)}async executeCronjob(e){this.updateJobLastRunState(e.id,Date.now()),await c.__privateGet.call(void 0,this,r).call("SnapController:handleRequest",{snapId:e.snapId,origin:"",handler:h.HandlerType.OnCronjob,request:e.request})}unregister(e){const t=[...c.__privateGet.call(void 0,this,o).entries()].filter((([t,n])=>n===e));t.length&&t.forEach((([e])=>{const t=c.__privateGet.call(void 0,this,s).get(e);t&&(t.cancel(),c.__privateGet.call(void 0,this,s).delete(e),c.__privateGet.call(void 0,this,o).delete(e))}))}updateJobLastRunState(e,t){this.update((n=>{n.jobs[e]={lastRun:t}}))}async dailyCheckIn(){const e=this.getAllJobs();for(const t of e){const e=h.parseCronExpression.call(void 0,t.expression),n=this.state.jobs[t.id]?.lastRun;void 0!==n&&e.hasPrev()&&e.prev().getTime()>n&&await this.executeCronjob(t),this.schedule(t)}c.__privateSet.call(void 0,this,i,new(0,l.Timer)(p)),c.__privateGet.call(void 0,this,i).start((()=>{this.dailyCheckIn().catch((e=>{h.logError.call(void 0,e)}))}))}destroy(){super.destroy(),this.messagingSystem.unsubscribe("SnapController:snapInstalled",this._handleSnapRegisterEvent),this.messagingSystem.unsubscribe("SnapController:snapUninstalled",this._handleSnapUnregisterEvent),this.messagingSystem.unsubscribe("SnapController:snapEnabled",this._handleSnapRegisterEvent),this.messagingSystem.unsubscribe("SnapController:snapDisabled",this._handleSnapUnregisterEvent),this.messagingSystem.unsubscribe("SnapController:snapUpdated",this._handleEventSnapUpdated),c.__privateGet.call(void 0,this,o).forEach((e=>{this.unregister(e)}))}_handleSnapRegisterEvent(e){this.register(e.id)}_handleSnapUnregisterEvent(e){this.unregister(e.id)}_handleEventSnapUpdated(e){this.unregister(e.id),this.register(e.id)}};r=new WeakMap,i=new WeakMap,s=new WeakMap,o=new WeakMap,n.DAILY_TIMEOUT=p,n.CronjobController=m}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-MYWDTEX2.js"}],[158,{lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("lodash");n.default={version:68,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=68;const n=function(e){const{PermissionsController:t={},PermissionsMetadata:n={},...r}=e,{domainMetadata:o={},permissionsHistory:a={},permissionsLog:l=[]}=n;return{...r,PermissionController:i(t),PermissionLogController:{permissionActivityLog:l,permissionHistory:a},SubjectMetadataController:s(o)}}(t.data);return t.data=n,t}};function i(e){const{domains:t={}}=e;return{subjects:Object.entries(t).reduce(((e,[t,n])=>{const{permissions:[r]}=n,i=r.caveats.find((e=>"exposedAccounts"===e.name)),s={...r,caveats:[{type:"restrictReturnedAccounts",value:i.value}]};return delete s["@context"],e[t]={origin:t,permissions:{eth_accounts:s}},e}),{})}}function s(e){return{subjectMetadata:Object.entries(e).reduce(((e,[t,n])=>{const{name:r=null,icon:i=null,extensionId:s=null,...o}=n;return delete o.lastUpdated,delete o.host,t&&(e[t]={name:r,iconUrl:i,extensionId:s,...o,origin:t}),e}),{})}}}}},{package:"$root$",file:"app/scripts/migrations/068.js"}],[1580,{"@metamask/utils":1806},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("@metamask/utils");n.Timer=class{constructor(e){r.assert.call(void 0,!Number.isNaN(e),new TypeError("Can't start a timer with NaN time")),r.assert.call(void 0,e>=0,new TypeError("Can't start a timer with negative time")),this.state={value:"stopped",remaining:e}}get status(){return this.state.value}cancel(){r.assert.call(void 0,"paused"===this.status||"running"===this.status,new Error("Tried to cancel a not running Timer")),this.onFinish(!1)}pause(){r.assert.call(void 0,"running"===this.state.value,new Error("Tried to pause a not running Timer"));const{callback:e,start:t,timeout:n,remaining:i}=this.state;void 0!==n&&clearTimeout(n),this.state={value:"paused",callback:e,remaining:i-(Date.now()-t)}}start(e){r.assert.call(void 0,"stopped"===this.state.value,new Error("Tried to start an already running Timer"));const{remaining:t}=this.state;this.state={value:"paused",remaining:t,callback:e},this.resume()}resume(){r.assert.call(void 0,"paused"===this.state.value,new Error("Tried to resume not paused Timer"));const{remaining:e,callback:t}=this.state,n=Date.now();let i;e!==Number.POSITIVE_INFINITY&&(i=setTimeout((()=>this.onFinish(!0)),e)),this.state={value:"running",callback:t,remaining:e,start:n,timeout:i}}onFinish(e){r.assert.call(void 0,"running"===this.state.value||"paused"===this.state.value),"running"===this.state.value&&void 0!==this.state.timeout&&clearTimeout(this.state.timeout);const{callback:t}=this.state;this.state={value:"finished"},e&&t()}}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-NOLPMHXS.js"}],[1581,{"@metamask/snaps-utils":1705,"@metamask/utils":1806},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("@metamask/snaps-utils"),i=e("@metamask/utils").createModuleLogger.call(void 0,r.snapsLogger,"snaps-controllers");n.log=i}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-NXZVKBSV.js"}],[1582,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-OHMCPTOI.js"}],[1583,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-OIEUL55W.js"}],[1584,{"./chunk-EXN2TFDJ.js":1572,"./chunk-KLK7ZRMH.js":1576,"@metamask/base-controller":1064,"@metamask/snaps-utils":1705,"@metamask/utils":1806,nanoid:1596},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i,s,o,a,l,c,u,d,h,f=e("./chunk-KLK7ZRMH.js"),p=e("./chunk-EXN2TFDJ.js"),m=e("@metamask/base-controller"),g=e("@metamask/snaps-utils"),v=e("@metamask/utils"),b=e("nanoid"),w=25e4,y="SnapInterfaceController",_=class extends m.BaseController{constructor({messenger:e,state:t}){super({messenger:e,metadata:{interfaces:{persist:!1,anonymous:!1}},name:y,state:{interfaces:{},...t}}),p.__privateAdd.call(void 0,this,r),p.__privateAdd.call(void 0,this,s),p.__privateAdd.call(void 0,this,a),p.__privateAdd.call(void 0,this,c),p.__privateAdd.call(void 0,this,d),p.__privateMethod.call(void 0,this,r,i).call(this)}async createInterface(e,t){await p.__privateMethod.call(void 0,this,d,h).call(this,t);const n=b.nanoid.call(void 0),r=f.constructState.call(void 0,{},t);return this.update((i=>{i.interfaces[n]={snapId:e,content:t,state:r}})),n}getInterface(e,t){return p.__privateMethod.call(void 0,this,s,o).call(this,e,t),this.state.interfaces[t]}async updateInterface(e,t,n){p.__privateMethod.call(void 0,this,s,o).call(this,e,t),await p.__privateMethod.call(void 0,this,d,h).call(this,n);const r=this.state.interfaces[t].state,i=f.constructState.call(void 0,r,n);this.update((e=>{e.interfaces[t].state=i,e.interfaces[t].content=n}))}deleteInterface(e){this.update((t=>{delete t.interfaces[e]}))}updateInterfaceState(e,t){this.update((n=>{n.interfaces[e].state=t}))}};r=new WeakSet,i=function(){this.messagingSystem.registerActionHandler(`${y}:createInterface`,this.createInterface.bind(this)),this.messagingSystem.registerActionHandler(`${y}:getInterface`,this.getInterface.bind(this)),this.messagingSystem.registerActionHandler(`${y}:updateInterface`,this.updateInterface.bind(this)),this.messagingSystem.registerActionHandler(`${y}:deleteInterface`,this.deleteInterface.bind(this)),this.messagingSystem.registerActionHandler(`${y}:updateInterfaceState`,this.updateInterfaceState.bind(this))},s=new WeakSet,o=function(e,t){const n=this.state.interfaces[t];v.assert.call(void 0,void 0!==n,`Interface with id '${t}' not found.`),v.assert.call(void 0,n.snapId===e,`Interface not created by ${e}.`)},a=new WeakSet,l=async function(){await this.messagingSystem.call("PhishingController:maybeUpdateState")},c=new WeakSet,u=function(e){return this.messagingSystem.call("PhishingController:testOrigin",e).result},d=new WeakSet,h=async function(e){const t=v.getJsonSize.call(void 0,e);v.assert.call(void 0,t<=w,"A Snap UI may not be larger than 250 kB.");const n=g.getTotalTextLength.call(void 0,e);v.assert.call(void 0,n<=5e4,"The text in a Snap UI may not be larger than 50 kB."),await p.__privateMethod.call(void 0,this,a,l).call(this),g.validateComponentLinks.call(void 0,e,p.__privateMethod.call(void 0,this,c,u).bind(this))},n.SnapInterfaceController=_}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-Q2ON6SMV.js"}],[1585,{"@metamask/snaps-utils":1705,"@metamask/utils":1806},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("@metamask/snaps-utils"),i=e("@metamask/utils");n.HttpLocation=class{constructor(e,t={}){this.cache=new Map,i.assertStruct.call(void 0,e.toString(),r.HttpSnapIdStruct,"Invalid Snap Id: "),this.fetchFn=t.fetch??globalThis.fetch.bind(globalThis),this.fetchOptions=t.fetchOptions,this.url=e}async manifest(){if(this.validatedManifest)return this.validatedManifest.clone();const e=new URL(r.NpmSnapFileNames.Manifest,this.url).toString(),t=await this.fetchFn(e,this.fetchOptions);if(!t.ok)throw new Error(`Failed to fetch "${e}". Status code: ${t.status}.`);const n=await t.text(),i=r.parseJson.call(void 0,n),s=new(0,r.VirtualFile)({value:n,result:r.createSnapManifest.call(void 0,i),path:r.NpmSnapFileNames.Manifest,data:{canonicalPath:e}});return this.validatedManifest=s,this.manifest()}async fetch(e){const t=r.normalizeRelative.call(void 0,e),n=this.cache.get(t);if(void 0!==n){const{file:e,contents:t}=n,r=new Uint8Array(await t.arrayBuffer()),i=e.clone();return i.value=r,i}const s=this.toCanonical(t).toString(),o=await this.fetchFn(s,this.fetchOptions);if(!o.ok)throw new Error(`Failed to fetch "${s}". Status code: ${o.status}.`);const a=new(0,r.VirtualFile)({value:"",path:t,data:{canonicalPath:s}}),l=await o.blob();return i.assert.call(void 0,!this.cache.has(t),"Corrupted cache, multiple files with same path."),this.cache.set(t,{file:a,contents:l}),this.fetch(t)}get root(){return new URL(this.url)}toCanonical(e){return i.assert.call(void 0,!e.startsWith("/"),"Tried to parse absolute path."),new URL(e,this.url)}}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-RDBT3ZJQ.js"}],[1586,{"./chunk-5YBORD3A.js":1562,"./chunk-7WOG63YY.js":1566,"./chunk-AP7CJ6DA.js":1568,"./chunk-BO2ZDPWV.js":1569,"./chunk-EXN2TFDJ.js":1572,"./chunk-NOLPMHXS.js":1580,"./chunk-NXZVKBSV.js":1581,"./chunk-XE5IWVNV.js":1591,"@metamask/base-controller":1064,"@metamask/permission-controller":1463,"@metamask/rpc-errors":1525,"@metamask/snaps-rpc-methods":1668,"@metamask/snaps-sdk":1669,"@metamask/snaps-utils":1705,"@metamask/utils":1806,"@xstate/fsm":2081,nanoid:1596},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("./chunk-7WOG63YY.js"),i=e("./chunk-AP7CJ6DA.js"),s=e("./chunk-5YBORD3A.js"),o=e("./chunk-BO2ZDPWV.js"),a=e("./chunk-NXZVKBSV.js"),l=e("./chunk-XE5IWVNV.js"),c=e("./chunk-NOLPMHXS.js"),u=e("./chunk-EXN2TFDJ.js"),d=e("@metamask/base-controller"),h=e("@metamask/permission-controller"),f=e("@metamask/rpc-errors"),p=e("@metamask/snaps-rpc-methods"),m=e("@metamask/snaps-sdk"),g=e("@metamask/snaps-utils"),v=e("@metamask/utils"),b=e("@xstate/fsm"),w=e("nanoid"),y="SnapController",_="wallet_installSnap",S="wallet_updateSnap",k="wallet_installSnapResult",E=new Set(["initialPermissions","id","version","enabled","blocked"]),T={snaps:{},snapStates:{},unencryptedSnapStates:{}};function P(e){return Object.keys(e).reduce(((t,n)=>(E.has(n)&&(t[n]=e[n]),t)),{})}var C,O,j,M,R,A,N,I,x,L,B,D,U,F,W,H,G,q,$,V,z,K,Q,Y,J,Z,X,ee,te,ne,re,ie,se,oe,ae,le,ce,ue,de,he,fe,pe,me,ge,ve,be,we,ye,_e,Se,ke,Ee,Te,Pe,Ce,Oe,je,Me,Re,Ae,Ne,Ie,xe,Le,Be,De,Ue,Fe,We,He,Ge,qe,$e,Ve,ze,Ke,Qe,Ye,Je,Ze,Xe,et,tt,nt,rt,it,st,ot,at,lt,ct,ut,dt,ht,ft,pt,mt=class extends d.BaseController{constructor({closeAllConnections:e,messenger:t,state:n,dynamicPermissions:i=["eth_accounts"],environmentEndowmentPermissions:s=[],excludedPermissions:o={},idleTimeCheckInterval:a=v.inMilliseconds.call(void 0,5,v.Duration.Second),maxIdleTime:l=v.inMilliseconds.call(void 0,30,v.Duration.Second),maxRequestTime:c=v.inMilliseconds.call(void 0,60,v.Duration.Second),maxInitTime:d=v.inMilliseconds.call(void 0,60,v.Duration.Second),fetchFunction:h=globalThis.fetch.bind(globalThis),featureFlags:f={},detectSnapLocation:p=r.detectSnapLocation,preinstalledSnaps:b}){super({messenger:t,metadata:{snapStates:{persist:!0,anonymous:!1},unencryptedSnapStates:{persist:!0,anonymous:!1},snaps:{persist:e=>Object.values(e).filter((e=>e.status!==g.SnapStatus.Installing)).map((e=>({...e,status:g.SnapStatus.Stopped}))).reduce(((e,t)=>(e[t.id]=t,e)),{}),anonymous:!1}},name:"SnapController",state:{...T,...n}}),u.__privateAdd.call(void 0,this,W),u.__privateAdd.call(void 0,this,G),u.__privateAdd.call(void 0,this,$),u.__privateAdd.call(void 0,this,z),u.__privateAdd.call(void 0,this,Q),u.__privateAdd.call(void 0,this,J),u.__privateAdd.call(void 0,this,X),u.__privateAdd.call(void 0,this,te),u.__privateAdd.call(void 0,this,re),u.__privateAdd.call(void 0,this,se),u.__privateAdd.call(void 0,this,ae),u.__privateAdd.call(void 0,this,ce),u.__privateAdd.call(void 0,this,de),u.__privateAdd.call(void 0,this,fe),u.__privateAdd.call(void 0,this,me),u.__privateAdd.call(void 0,this,ve),u.__privateAdd.call(void 0,this,we),u.__privateAdd.call(void 0,this,_e),u.__privateAdd.call(void 0,this,ke),u.__privateAdd.call(void 0,this,Te),u.__privateAdd.call(void 0,this,Ce),u.__privateAdd.call(void 0,this,je),u.__privateAdd.call(void 0,this,Re),u.__privateAdd.call(void 0,this,Ne),u.__privateAdd.call(void 0,this,xe),u.__privateAdd.call(void 0,this,Be),u.__privateAdd.call(void 0,this,Ue),u.__privateAdd.call(void 0,this,We),u.__privateAdd.call(void 0,this,Ge),u.__privateAdd.call(void 0,this,$e),u.__privateAdd.call(void 0,this,ze),u.__privateAdd.call(void 0,this,Qe),u.__privateAdd.call(void 0,this,Je),u.__privateAdd.call(void 0,this,Xe),u.__privateAdd.call(void 0,this,tt),u.__privateAdd.call(void 0,this,rt),u.__privateAdd.call(void 0,this,st),u.__privateAdd.call(void 0,this,at),u.__privateAdd.call(void 0,this,ct),u.__privateAdd.call(void 0,this,dt),u.__privateAdd.call(void 0,this,ft),u.__privateAdd.call(void 0,this,C,void 0),u.__privateAdd.call(void 0,this,O,void 0),u.__privateAdd.call(void 0,this,j,void 0),u.__privateAdd.call(void 0,this,M,void 0),u.__privateAdd.call(void 0,this,R,void 0),u.__privateAdd.call(void 0,this,A,void 0),u.__privateAdd.call(void 0,this,N,void 0),u.__privateAdd.call(void 0,this,I,void 0),u.__privateAdd.call(void 0,this,x,void 0),u.__privateAdd.call(void 0,this,L,void 0),u.__privateAdd.call(void 0,this,B,void 0),u.__privateAdd.call(void 0,this,D,void 0),u.__privateAdd.call(void 0,this,U,void 0),u.__privateAdd.call(void 0,this,F,void 0),u.__privateSet.call(void 0,this,C,e),u.__privateSet.call(void 0,this,O,i),u.__privateSet.call(void 0,this,j,s),u.__privateSet.call(void 0,this,M,o),u.__privateSet.call(void 0,this,R,f),u.__privateSet.call(void 0,this,A,h),u.__privateSet.call(void 0,this,N,a),u.__privateSet.call(void 0,this,I,l),this.maxRequestTime=c,u.__privateSet.call(void 0,this,x,d),u.__privateSet.call(void 0,this,L,p),this._onUnhandledSnapError=this._onUnhandledSnapError.bind(this),this._onOutboundRequest=this._onOutboundRequest.bind(this),this._onOutboundResponse=this._onOutboundResponse.bind(this),u.__privateSet.call(void 0,this,D,new Map),u.__privateSet.call(void 0,this,B,new Map),u.__privateMethod.call(void 0,this,z,K).call(this),this.messagingSystem.subscribe("ExecutionService:unhandledError",this._onUnhandledSnapError),this.messagingSystem.subscribe("ExecutionService:outboundRequest",this._onOutboundRequest),this.messagingSystem.subscribe("ExecutionService:outboundResponse",this._onOutboundResponse),this.messagingSystem.subscribe("SnapController:snapInstalled",(({id:e})=>{u.__privateMethod.call(void 0,this,ft,pt).call(this,e,g.HandlerType.OnInstall).catch((t=>{g.logError.call(void 0,`Error when calling \`onInstall\` lifecycle hook for snap "${e}": ${m.getErrorMessage.call(void 0,t)}`)}))})),this.messagingSystem.subscribe("SnapController:snapUpdated",(({id:e})=>{u.__privateMethod.call(void 0,this,ft,pt).call(this,e,g.HandlerType.OnUpdate).catch((t=>{g.logError.call(void 0,`Error when calling \`onUpdate\` lifecycle hook for snap "${e}": ${m.getErrorMessage.call(void 0,t)}`)}))})),u.__privateMethod.call(void 0,this,W,H).call(this),u.__privateMethod.call(void 0,this,G,q).call(this),b&&u.__privateMethod.call(void 0,this,$,V).call(this,b),Object.values(this.state?.snaps??{}).forEach((e=>u.__privateMethod.call(void 0,this,st,ot).call(this,e.id)))}async updateBlockedSnaps(){await this.messagingSystem.call("SnapsRegistry:update");const e=await this.messagingSystem.call("SnapsRegistry:get",Object.values(this.state.snaps).reduce(((e,t)=>(e[t.id]={version:t.version,checksum:t.manifest.source.shasum},e)),{}));await Promise.all(Object.entries(e).map((async([e,{status:t,reason:n}])=>1===t?u.__privateMethod.call(void 0,this,Q,Y).call(this,e,n):u.__privateMethod.call(void 0,this,J,Z).call(this,e))))}_onUnhandledSnapError(e,t){this.stopSnap(e,g.SnapStatusEvents.Crash).catch((e=>{g.logError.call(void 0,e)}))}_onOutboundRequest(e){const t=u.__privateMethod.call(void 0,this,rt,it).call(this,e);t.pendingInboundRequests.filter((e=>"running"===e.timer.status)).forEach((e=>e.timer.pause())),t.pendingOutboundRequests+=1}_onOutboundResponse(e){const t=u.__privateMethod.call(void 0,this,rt,it).call(this,e);t.pendingOutboundRequests-=1,0===t.pendingOutboundRequests&&t.pendingInboundRequests.filter((e=>"paused"===e.timer.status)).forEach((e=>e.timer.resume()))}async startSnap(e){const t=this.state.snaps[e];if(!1===t.enabled)throw new Error(`Snap "${e}" is disabled.`);await u.__privateMethod.call(void 0,this,ke,Ee).call(this,{snapId:e,sourceCode:t.sourceCode})}enableSnap(e){if(this.getExpect(e),this.state.snaps[e].blocked)throw new Error(`Snap "${e}" is blocked and cannot be enabled.`);this.update((t=>{t.snaps[e].enabled=!0})),this.messagingSystem.publish("SnapController:snapEnabled",this.getTruncatedExpect(e))}async disableSnap(e){if(!this.has(e))throw new Error(`Snap "${e}" not found.`);this.update((t=>{t.snaps[e].enabled=!1})),this.isRunning(e)&&await this.stopSnap(e,g.SnapStatusEvents.Stop),this.messagingSystem.publish("SnapController:snapDisabled",this.getTruncatedExpect(e))}async stopSnap(e,t=g.SnapStatusEvents.Stop){var n;const r=u.__privateMethod.call(void 0,this,tt,nt).call(this,e);if(!r)throw new Error(`The snap "${e}" is not running.`);r.lastRequest=null,r.pendingInboundRequests=[],r.pendingOutboundRequests=0;try{this.isRunning(e)&&(null==(n=u.__privateGet.call(void 0,this,C))||n.call(this,e),await u.__privateMethod.call(void 0,this,se,oe).call(this,e))}finally{this.isRunning(e)&&u.__privateMethod.call(void 0,this,re,ie).call(this,e,t)}}isRunning(e){return"running"===this.getExpect(e).status}has(e){return Boolean(this.get(e))}get(e){return this.state.snaps[e]}getExpect(e){const t=this.get(e);return v.assert.call(void 0,void 0!==t,new Error(`Snap "${e}" not found.`)),t}getTruncated(e){const t=this.get(e);return t?P(t):null}getTruncatedExpect(e){return P(this.getExpect(e))}updateSnapState(e,t,n){this.update((r=>{n?r.snapStates[e]=t:r.unencryptedSnapStates[e]=t}))}clearSnapState(e,t){this.update((n=>{t?n.snapStates[e]=null:n.unencryptedSnapStates[e]=null}))}getSnapState(e,t){return(t?this.state.snapStates[e]:this.state.unencryptedSnapStates[e])??null}async getSnapFile(e,t,n=m.AuxiliaryFileEncoding.Base64){const r=this.getExpect(e),i=g.normalizeRelative.call(void 0,t),s=r.auxiliaryFiles?.find((e=>e.path===i))?.value;return s?g.encodeAuxiliaryFile.call(void 0,s,n):null}async clearState(){const e=Object.keys(this.state.snaps);u.__privateGet.call(void 0,this,C)&&e.forEach((e=>{var t;null==(t=u.__privateGet.call(void 0,this,C))||t.call(this,e)})),await this.messagingSystem.call("ExecutionService:terminateAllSnaps"),e.forEach((e=>u.__privateMethod.call(void 0,this,fe,pe).call(this,e))),this.update((e=>{e.snaps={},e.snapStates={}}))}async removeSnap(e){return this.removeSnaps([e])}async removeSnaps(e){if(!Array.isArray(e))throw new Error("Expected array of snap ids.");e.forEach((e=>{const t=this.getExpect(e);v.assert.call(void 0,!1!==t.removable,`${e} is not removable.`)})),await Promise.all(e.map((async e=>{const t=this.getExpect(e),n=this.getTruncatedExpect(e);await this.disableSnap(e),u.__privateMethod.call(void 0,this,fe,pe).call(this,e),u.__privateMethod.call(void 0,this,de,he).call(this,e),u.__privateGet.call(void 0,this,B).delete(e),this.update((t=>{delete t.snaps[e],delete t.snapStates[e]})),t.status!==g.SnapStatus.Installing&&this.messagingSystem.publish("SnapController:snapUninstalled",n)})))}removeSnapFromSubject(e,t){const n=this.messagingSystem.call("PermissionController:getPermissions",e),r=n?.[p.WALLET_SNAP_PERMISSION_KEY]?.caveats?.find((e=>e.type===g.SnapCaveatType.SnapIds));if(!r)return;if(Boolean(r.value?.[t])){const n={...r.value};delete n[t],Object.keys(n).length>0?this.messagingSystem.call("PermissionController:updateCaveat",e,p.WALLET_SNAP_PERMISSION_KEY,g.SnapCaveatType.SnapIds,n):this.messagingSystem.call("PermissionController:revokePermissions",{[e]:[p.WALLET_SNAP_PERMISSION_KEY]})}}revokeDynamicSnapPermissions(e,t){v.assert.call(void 0,t.every((e=>u.__privateGet.call(void 0,this,O).includes(e))),"Non-dynamic permissions cannot be revoked"),this.messagingSystem.call("PermissionController:revokePermissions",{[e]:t})}incrementActiveReferences(e){u.__privateMethod.call(void 0,this,rt,it).call(this,e).activeReferences+=1}decrementActiveReferences(e){const t=u.__privateMethod.call(void 0,this,rt,it).call(this,e);v.assert.call(void 0,t.activeReferences>0,"SnapController reference management is in an invalid state."),t.activeReferences-=1}getAllSnaps(){return Object.values(this.state.snaps).map(P)}getPermittedSnaps(e){const t=this.messagingSystem.call("PermissionController:getPermissions",e)??{},n=t[p.WALLET_SNAP_PERMISSION_KEY]?.caveats?.find((e=>e.type===g.SnapCaveatType.SnapIds))?.value??{};return Object.keys(n).reduce(((e,t)=>{const n=this.get(t),r=this.getTruncated(t);return r&&n?.status!==g.SnapStatus.Installing&&(e[t]=r),e}),{})}async installSnaps(e,t){const n={},r=Object.keys(t),i=[],s=[];try{for(const[r,{version:o}]of Object.entries(t)){g.assertIsValidSnapId.call(void 0,r);const[t,a]=g.resolveVersionRange.call(void 0,o);if(t)throw f.rpcErrors.invalidParams(`The "version" field must be a valid SemVer version range if specified. Received: "${o}".`);const l=u.__privateGet.call(void 0,this,L).call(this,r,{versionRange:a,fetch:u.__privateGet.call(void 0,this,A),allowLocal:u.__privateGet.call(void 0,this,R).allowLocalSnaps,resolveVersion:async e=>u.__privateGet.call(void 0,this,R).requireAllowlist?await u.__privateMethod.call(void 0,this,we,ye).call(this,r,e):e}),c=this.has(r)&&!l.shouldAlwaysReload;if(c&&u.__privateMethod.call(void 0,this,dt,ht).call(this,r,a)){const e=this.getExpect(r);i.push({snapId:r,oldVersion:e.version});let t=u.__privateMethod.call(void 0,this,ze,Ke).call(this,r);if(void 0!==t)throw new Error("This snap is already being updated.");t=u.__privateMethod.call(void 0,this,Qe,Ye).call(this,r),t.newVersion=a}else c||s.push(r);n[r]=await this.processRequestedSnap(e,r,l,a)}s.forEach((t=>this.messagingSystem.publish("SnapController:snapInstalled",this.getTruncatedExpect(t),e))),i.forEach((({snapId:t,oldVersion:n})=>this.messagingSystem.publish("SnapController:snapUpdated",this.getTruncatedExpect(t),n,e))),r.forEach((e=>u.__privateGet.call(void 0,this,D).delete(e)))}catch(e){const t=s.filter((e=>this.has(e)));await this.removeSnaps(t);const n=[...u.__privateGet.call(void 0,this,D).keys()],r=i.map((({snapId:e})=>e)).filter((e=>n.includes(e)));throw await u.__privateMethod.call(void 0,this,Xe,et).call(this,r),e}return n}async processRequestedSnap(e,t,n,r){const i=this.getTruncated(t);if(i&&!n.shouldAlwaysReload)return v.satisfiesVersionRange.call(void 0,i.version,r)?i:await this.updateSnap(e,t,n,r,!1);let s=u.__privateMethod.call(void 0,this,me,ge).call(this,{origin:e,snapId:t,type:_});this.messagingSystem.publish("SnapController:snapInstallStarted",t,e,!1),i&&this.isRunning(t)&&await this.stopSnap(t,g.SnapStatusEvents.Stop),i&&n.shouldAlwaysReload&&u.__privateMethod.call(void 0,this,fe,pe).call(this,t);try{const{sourceCode:i}=await u.__privateMethod.call(void 0,this,_e,Se).call(this,{origin:e,id:t,location:n,versionRange:r});await this.authorize(t,s),s=u.__privateMethod.call(void 0,this,me,ge).call(this,{origin:e,snapId:t,type:k}),await u.__privateMethod.call(void 0,this,ke,Ee).call(this,{snapId:t,sourceCode:i});const o=this.getTruncatedExpect(t);return u.__privateMethod.call(void 0,this,ve,be).call(this,s.id,{loading:!1,type:_}),o}catch(n){g.logError.call(void 0,`Error when adding ${t}.`,n);const r=n instanceof Error?n.message:n.toString();throw u.__privateMethod.call(void 0,this,ve,be).call(this,s.id,{loading:!1,type:_,error:r}),this.messagingSystem.publish("SnapController:snapInstallFailed",t,e,!1,r),n}}async updateSnap(e,t,n,r=g.DEFAULT_REQUESTED_SNAP_VERSION,i=!0){if(!v.isValidSemVerRange.call(void 0,r))throw new Error(`Received invalid snap version range: "${r}".`);let s=u.__privateMethod.call(void 0,this,me,ge).call(this,{origin:e,snapId:t,type:S});try{this.messagingSystem.publish("SnapController:snapInstallStarted",t,e,!0);const o=this.getExpect(t),a=o.manifest,c=await l.fetchSnap.call(void 0,t,n),{sourceCode:d,manifest:h}=c,m=h.result,b=m.version;if(!v.gtVersion.call(void 0,b,o.version))throw f.rpcErrors.invalidParams(`Snap "${t}@${o.version}" is already installed. Couldn't update to a version inside requested "${r}" range.`);if(!v.satisfiesVersionRange.call(void 0,b,r))throw new Error(`Version mismatch. Manifest for "${t}" specifies version "${b}" which doesn't satisfy requested version range "${r}".`);await u.__privateMethod.call(void 0,this,X,ee).call(this,t,{version:b,checksum:m.source.shasum,permissions:m.initialPermissions});const w=p.processSnapPermissions.call(void 0,m.initialPermissions);u.__privateMethod.call(void 0,this,je,Me).call(this,w);const{newPermissions:y,unusedPermissions:_,approvedPermissions:E}=u.__privateMethod.call(void 0,this,at,lt).call(this,t,w);u.__privateMethod.call(void 0,this,ve,be).call(this,s.id,{permissions:y,newVersion:m.version,newPermissions:y,approvedPermissions:E,unusedPermissions:_,loading:!1});const{permissions:T,...P}=await s.promise;s=u.__privateMethod.call(void 0,this,me,ge).call(this,{origin:e,snapId:t,type:k}),this.isRunning(t)&&await this.stopSnap(t,g.SnapStatusEvents.Stop),u.__privateMethod.call(void 0,this,re,ie).call(this,t,g.SnapStatusEvents.Update),u.__privateMethod.call(void 0,this,Ce,Oe).call(this,{origin:e,id:t,files:c,isUpdate:!0}),u.__privateMethod.call(void 0,this,ct,ut).call(this,{snapId:t,unusedPermissions:_,newPermissions:T,requestData:P}),m.initialConnections&&u.__privateMethod.call(void 0,this,ae,le).call(this,t,a.initialConnections??null,m.initialConnections);const C=u.__privateMethod.call(void 0,this,ze,Ke).call(this,t);void 0!==C&&(C.permissions.revoked=_,C.permissions.granted=T,C.permissions.requestData=P);const O=d.toString();v.assert.call(void 0,"string"==typeof O&&O.length>0,`Invalid source code for snap "${t}".`);try{await u.__privateMethod.call(void 0,this,ke,Ee).call(this,{snapId:t,sourceCode:O})}catch{throw new Error(`Snap ${t} crashed with updated source code.`)}const j=this.getTruncatedExpect(t);return i&&this.messagingSystem.publish("SnapController:snapUpdated",j,o.version,e),u.__privateMethod.call(void 0,this,ve,be).call(this,s.id,{loading:!1,type:S}),j}catch(n){g.logError.call(void 0,`Error when updating ${t},`,n);const r=n instanceof Error?n.message:n.toString();throw u.__privateMethod.call(void 0,this,ve,be).call(this,s.id,{loading:!1,error:r,type:S}),this.messagingSystem.publish("SnapController:snapInstallFailed",t,e,!0,r),n}}async getRegistryMetadata(e){return await this.messagingSystem.call("SnapsRegistry:getMetadata",e)}async authorize(e,t){a.log.call(void 0,`Authorizing snap: ${e}`);const n=this.state.snaps[e],{initialPermissions:r}=n;try{const i=p.processSnapPermissions.call(void 0,r);u.__privateMethod.call(void 0,this,je,Me).call(this,i),u.__privateMethod.call(void 0,this,ve,be).call(this,t.id,{loading:!1,permissions:i});const{permissions:s,...o}=await t.promise;u.__privateMethod.call(void 0,this,ct,ut).call(this,{snapId:e,newPermissions:s,requestData:o}),n.manifest.initialConnections&&u.__privateMethod.call(void 0,this,ae,le).call(this,e,null,n.manifest.initialConnections)}finally{u.__privateMethod.call(void 0,this,rt,it).call(this,e).installPromise=null}}destroy(){super.destroy(),u.__privateGet.call(void 0,this,U)&&clearTimeout(u.__privateGet.call(void 0,this,U)),this.messagingSystem.unsubscribe("ExecutionService:unhandledError",this._onUnhandledSnapError),this.messagingSystem.unsubscribe("ExecutionService:outboundRequest",this._onOutboundRequest),this.messagingSystem.unsubscribe("ExecutionService:outboundResponse",this._onOutboundResponse),this.messagingSystem.clearEventSubscriptions("SnapController:snapInstalled"),this.messagingSystem.clearEventSubscriptions("SnapController:snapUpdated")}async handleRequest({snapId:e,origin:t,handler:n,request:r}){const i={jsonrpc:"2.0",id:w.nanoid.call(void 0),...r};v.assertIsJsonRpcRequest.call(void 0,i);const s=p.handlerEndowments[n];v.assert.call(void 0,"string"==typeof s||null===s,"'permissionName' must be either a string or null.");const o=this.messagingSystem.call("PermissionController:getPermissions",e);if(!(null===s||o&&v.hasProperty.call(void 0,o,s)))throw new Error(`Snap "${e}" is not permitted to use "${s}".`);const a=s?o[s]:void 0;if(s===p.SnapEndowments.Rpc||s===p.SnapEndowments.Keyring){v.assert.call(void 0,a);const n=this.messagingSystem.call("SubjectMetadataController:getSubjectMetadata",t),r=s===p.SnapEndowments.Rpc?p.getRpcCaveatOrigins.call(void 0,a):p.getKeyringCaveatOrigins.call(void 0,a);if(v.assert.call(void 0,r),!g.isOriginAllowed.call(void 0,r,n?.subjectType??h.SubjectType.Website,t))throw new Error(`Snap "${e}" is not permitted to handle requests from "${t}".`)}const l=u.__privateMethod.call(void 0,this,Ne,Ie).call(this,e);if(!l)throw new Error(`Snap RPC message handler not found for snap "${e}".`);return l({origin:t,handler:n,request:i,timeout:u.__privateMethod.call(void 0,this,Re,Ae).call(this,a)})}};C=new WeakMap,O=new WeakMap,j=new WeakMap,M=new WeakMap,R=new WeakMap,A=new WeakMap,N=new WeakMap,I=new WeakMap,x=new WeakMap,L=new WeakMap,B=new WeakMap,D=new WeakMap,U=new WeakMap,F=new WeakMap,W=new WeakSet,H=function(){const e=({snapId:e})=>this.getExpect(e).enabled,t={initial:g.SnapStatus.Installing,states:{[g.SnapStatus.Installing]:{on:{[g.SnapStatusEvents.Start]:{target:g.SnapStatus.Running,cond:e}}},[g.SnapStatus.Updating]:{on:{[g.SnapStatusEvents.Start]:{target:g.SnapStatus.Running,cond:e},[g.SnapStatusEvents.Stop]:g.SnapStatus.Stopped}},[g.SnapStatus.Running]:{on:{[g.SnapStatusEvents.Stop]:g.SnapStatus.Stopped,[g.SnapStatusEvents.Crash]:g.SnapStatus.Crashed}},[g.SnapStatus.Stopped]:{on:{[g.SnapStatusEvents.Start]:{target:g.SnapStatus.Running,cond:e},[g.SnapStatusEvents.Update]:g.SnapStatus.Updating}},[g.SnapStatus.Crashed]:{on:{[g.SnapStatusEvents.Start]:{target:g.SnapStatus.Running,cond:e},[g.SnapStatusEvents.Update]:g.SnapStatus.Updating}}}};u.__privateSet.call(void 0,this,F,b.createMachine.call(void 0,t)),o.validateMachine.call(void 0,u.__privateGet.call(void 0,this,F))},G=new WeakSet,q=function(){this.messagingSystem.registerActionHandler(`${y}:clearSnapState`,((...e)=>this.clearSnapState(...e))),this.messagingSystem.registerActionHandler(`${y}:get`,((...e)=>this.get(...e))),this.messagingSystem.registerActionHandler(`${y}:getSnapState`,((...e)=>this.getSnapState(...e))),this.messagingSystem.registerActionHandler(`${y}:handleRequest`,(async(...e)=>this.handleRequest(...e))),this.messagingSystem.registerActionHandler(`${y}:has`,((...e)=>this.has(...e))),this.messagingSystem.registerActionHandler(`${y}:updateBlockedSnaps`,(async()=>this.updateBlockedSnaps())),this.messagingSystem.registerActionHandler(`${y}:updateSnapState`,((...e)=>this.updateSnapState(...e))),this.messagingSystem.registerActionHandler(`${y}:enable`,((...e)=>this.enableSnap(...e))),this.messagingSystem.registerActionHandler(`${y}:disable`,(async(...e)=>this.disableSnap(...e))),this.messagingSystem.registerActionHandler(`${y}:remove`,(async(...e)=>this.removeSnap(...e))),this.messagingSystem.registerActionHandler(`${y}:getPermitted`,((...e)=>this.getPermittedSnaps(...e))),this.messagingSystem.registerActionHandler(`${y}:install`,(async(...e)=>this.installSnaps(...e))),this.messagingSystem.registerActionHandler(`${y}:getAll`,((...e)=>this.getAllSnaps(...e))),this.messagingSystem.registerActionHandler(`${y}:incrementActiveReferences`,((...e)=>this.incrementActiveReferences(...e))),this.messagingSystem.registerActionHandler(`${y}:decrementActiveReferences`,((...e)=>this.decrementActiveReferences(...e))),this.messagingSystem.registerActionHandler(`${y}:getRegistryMetadata`,(async(...e)=>this.getRegistryMetadata(...e))),this.messagingSystem.registerActionHandler(`${y}:disconnectOrigin`,((...e)=>this.removeSnapFromSubject(...e))),this.messagingSystem.registerActionHandler(`${y}:revokeDynamicPermissions`,((...e)=>this.revokeDynamicSnapPermissions(...e))),this.messagingSystem.registerActionHandler(`${y}:getFile`,(async(...e)=>this.getSnapFile(...e)))},$=new WeakSet,V=function(e){for(const{snapId:t,manifest:n,files:r,removable:i}of e){const e=this.get(t),s=void 0!==e,o=s&&v.gtVersion.call(void 0,n.version,e.version);if(s&&(!o||!0!==e.preinstalled))continue;const a=new(0,g.VirtualFile)({path:g.NpmSnapFileNames.Manifest,value:JSON.stringify(n),result:n}),l=r.map((({path:e,value:t})=>new(0,g.VirtualFile)({value:t,path:e}))),{filePath:c,iconPath:d}=n.source.location.npm,h=l.find((e=>e.path===c)),f=d?l.find((e=>e.path===d)):void 0;v.assert.call(void 0,h,"Source code not provided for preinstalled snap."),v.assert.call(void 0,!d||d&&f,"Icon not provided for preinstalled snap."),v.assert.call(void 0,void 0===n.source.files,"Auxiliary files are not currently supported for preinstalled snaps.");const m=n.source.locales?.map((e=>l.find((t=>t.path===e))))??[],b=g.getValidatedLocalizationFiles.call(void 0,m.filter(Boolean));v.assert.call(void 0,m.length===b.length,"Missing localization files for preinstalled snap.");const w={manifest:a,sourceCode:h,svgIcon:f,auxiliaryFiles:[],localizationFiles:b};u.__privateMethod.call(void 0,this,Ce,Oe).call(this,{id:t,origin:"metamask",files:w,removable:i,preinstalled:!0});const y=p.processSnapPermissions.call(void 0,n.initialPermissions);u.__privateMethod.call(void 0,this,je,Me).call(this,y);const{newPermissions:_,unusedPermissions:S}=u.__privateMethod.call(void 0,this,at,lt).call(this,t,y);u.__privateMethod.call(void 0,this,ct,ut).call(this,{snapId:t,newPermissions:_,unusedPermissions:S}),this.update((e=>{e.snaps[t].status=g.SnapStatus.Stopped}))}},z=new WeakSet,K=function(){u.__privateSet.call(void 0,this,U,setTimeout((()=>{u.__privateMethod.call(void 0,this,te,ne).call(this).catch((e=>{g.logError.call(void 0,e)})),u.__privateMethod.call(void 0,this,z,K).call(this)}),u.__privateGet.call(void 0,this,N)))},Q=new WeakSet,Y=async function(e,t){if(this.has(e)){try{this.update((n=>{n.snaps[e].blocked=!0,n.snaps[e].blockInformation=t})),await this.disableSnap(e)}catch(t){g.logError.call(void 0,`Encountered error when stopping blocked snap "${e}".`,t)}this.messagingSystem.publish(`${y}:snapBlocked`,e,t)}},J=new WeakSet,Z=function(e){this.has(e)&&this.state.snaps[e].blocked&&(this.update((t=>{t.snaps[e].blocked=!1,delete t.snaps[e].blockInformation})),this.messagingSystem.publish(`${y}:snapUnblocked`,e))},X=new WeakSet,ee=async function(e,t){const n=(await this.messagingSystem.call("SnapsRegistry:get",{[e]:t}))[e];if(1===n.status)throw new Error(`Cannot install version "${t.version}" of snap "${e}": The version is blocked. ${n.reason?.explanation??""}`);const r=Object.keys(t.permissions).some((e=>!s.ALLOWED_PERMISSIONS.includes(e)));if(u.__privateGet.call(void 0,this,R).requireAllowlist&&r&&2!==n.status)throw new Error(`Cannot install version "${t.version}" of snap "${e}": The snap is not on the allowlist.`)},te=new WeakSet,ne=async function(){const e=[...u.__privateGet.call(void 0,this,B).entries()];return Promise.all(e.filter((([e,t])=>0===t.activeReferences&&0===t.pendingInboundRequests.length&&t.lastRequest&&u.__privateGet.call(void 0,this,I)&&v.timeSince.call(void 0,t.lastRequest)>u.__privateGet.call(void 0,this,I))).map((async([e])=>this.stopSnap(e,g.SnapStatusEvents.Stop))))},re=new WeakSet,ie=function(e,t){const{interpreter:n}=u.__privateMethod.call(void 0,this,rt,it).call(this,e);n.send(t),this.update((t=>{t.snaps[e].status=n.state.value}))},se=new WeakSet,oe=async function(e){await this.messagingSystem.call("ExecutionService:terminateSnap",e),this.messagingSystem.publish("SnapController:snapTerminated",this.getTruncatedExpect(e))},ae=new WeakSet,le=function(e,t,n){if(t){const r=l.setDiff.call(void 0,t,n);for(const t of Object.keys(r))this.removeSnapFromSubject(t,e)}for(const t of Object.keys(n))u.__privateMethod.call(void 0,this,ce,ue).call(this,t,e)},ce=new WeakSet,ue=function(e,t){const n=this.messagingSystem.call("PermissionController:getPermissions",e),r=n?.[p.WALLET_SNAP_PERMISSION_KEY]?.caveats?.find((e=>e.type===g.SnapCaveatType.SnapIds));if(Boolean(r?.value?.[t]))return;if(r)return void this.messagingSystem.call("PermissionController:updateCaveat",e,p.WALLET_SNAP_PERMISSION_KEY,g.SnapCaveatType.SnapIds,{...r,[t]:{}});const i={[p.WALLET_SNAP_PERMISSION_KEY]:{caveats:[{type:g.SnapCaveatType.SnapIds,value:{[t]:{}}}]}};this.messagingSystem.call("PermissionController:grantPermissions",{approvedPermissions:i,subject:{origin:e}})},de=new WeakSet,he=function(e){const t=this.messagingSystem.call("PermissionController:getSubjectNames");for(const n of t)this.removeSnapFromSubject(n,e)},fe=new WeakSet,pe=function(e){this.messagingSystem.call("PermissionController:hasPermissions",e)&&this.messagingSystem.call("PermissionController:revokeAllPermissions",e)},me=new WeakSet,ge=function({origin:e,snapId:t,type:n}){const r=w.nanoid.call(void 0);return{id:r,promise:this.messagingSystem.call("ApprovalController:addRequest",{origin:e,id:r,type:n,requestData:{metadata:{id:r,origin:t,dappOrigin:e},snapId:t},requestState:{loading:!0}},!0)}},ve=new WeakSet,be=function(e,t){try{this.messagingSystem.call("ApprovalController:updateRequestState",{id:e,requestState:t})}catch{}},we=new WeakSet,ye=async function(e,t){return await this.messagingSystem.call("SnapsRegistry:resolveVersion",e,t)},_e=new WeakSet,Se=async function(e){const{id:t,location:n,versionRange:r}=e;u.__privateMethod.call(void 0,this,st,ot).call(this,t);const i=u.__privateMethod.call(void 0,this,rt,it).call(this,t);i.installPromise||(a.log.call(void 0,`Adding snap: ${t}`),i.installPromise=(async()=>{const i=await l.fetchSnap.call(void 0,t,n),s=i.manifest.result;if(!v.satisfiesVersionRange.call(void 0,s.version,r))throw new Error(`Version mismatch. Manifest for "${t}" specifies version "${s.version}" which doesn't satisfy requested version range "${r}".`);return await u.__privateMethod.call(void 0,this,X,ee).call(this,t,{version:s.version,checksum:s.source.shasum,permissions:s.initialPermissions}),u.__privateMethod.call(void 0,this,Ce,Oe).call(this,{...e,files:i,id:t})})());try{return await i.installPromise}catch(e){throw i.installPromise=null,e}},ke=new WeakSet,Ee=async function(e){const{snapId:t}=e;if(this.isRunning(t))throw new Error(`Snap "${t}" is already started.`);try{const n=u.__privateMethod.call(void 0,this,rt,it).call(this,t),r=await l.withTimeout.call(void 0,this.messagingSystem.call("ExecutionService:executeSnap",{...e,endowments:await u.__privateMethod.call(void 0,this,Te,Pe).call(this,t)}),u.__privateGet.call(void 0,this,x));if(r===l.hasTimedOut)throw new Error(`${t} failed to start.`);return u.__privateMethod.call(void 0,this,re,ie).call(this,t,g.SnapStatusEvents.Start),n.lastRequest=Date.now(),r}catch(e){throw await u.__privateMethod.call(void 0,this,se,oe).call(this,t),e}},Te=new WeakSet,Pe=async function(e){let t=[];for(const n of u.__privateGet.call(void 0,this,j))if(this.messagingSystem.call("PermissionController:hasPermission",e,n)){const r=await this.messagingSystem.call("PermissionController:getEndowments",e,n);if(r){if(!Array.isArray(r)||r.some((e=>"string"!=typeof e)))throw new Error("Expected an array of string endowment names.");t=t.concat(r)}}const n=[...new Set([...g.DEFAULT_ENDOWMENTS,...t])];return n.length<g.DEFAULT_ENDOWMENTS.length+t.length&&g.logError.call(void 0,`Duplicate endowments found for ${e}. Default endowments should not be requested.`,t),n},Ce=new WeakSet,Oe=function(e){const{id:t,origin:n,files:r,isUpdate:i=!1,removable:s,preinstalled:o}=e,{manifest:a,sourceCode:l,svgIcon:c,auxiliaryFiles:d,localizationFiles:f}=r;g.assertIsSnapManifest.call(void 0,a.result);const{version:p}=a.result,m=l.toString();v.assert.call(void 0,"string"==typeof m&&m.length>0,`Invalid source code for snap "${t}".`);const b=d.map((e=>(v.assert.call(void 0,"string"==typeof e.data.base64),{path:e.path,value:e.data.base64}))),w=this.state.snaps[t],y=[...w?.versionHistory??[],{version:p,date:Date.now(),origin:n}],_=f.map((e=>e.result)),S={...w,blocked:!1,enabled:!0,removable:s,preinstalled:o,id:t,initialPermissions:a.result.initialPermissions,manifest:a.result,status:u.__privateGet.call(void 0,this,F).config.initial,sourceCode:m,version:p,versionHistory:y,auxiliaryFiles:b,localizationFiles:_};delete S.blockInformation;const{inversePatches:k}=this.update((e=>{e.snaps[t]=S}));if(i){const e=u.__privateMethod.call(void 0,this,ze,Ke).call(this,t);void 0!==e&&(e.statePatches=k)}const{proposedName:E}=g.getLocalizedSnapManifest.call(void 0,a.result,"en",_);return this.messagingSystem.call("SubjectMetadataController:addSubjectMetadata",{subjectType:h.SubjectType.Snap,name:E,origin:S.id,version:p,svgIcon:c?.toString()??null}),{...S,sourceCode:m}},je=new WeakSet,Me=function(e){const t=Object.keys(e),n=Array.from(new Set(Object.values(p.handlerEndowments)));v.assert.call(void 0,t.some((e=>n.includes(e))),`A snap must request at least one of the following permissions: ${n.filter((e=>null!==e)).join(", ")}.`);const r=t.reduce(((e,t)=>(v.hasProperty.call(void 0,u.__privateGet.call(void 0,this,M),t)&&e.push(u.__privateGet.call(void 0,this,M)[t]),e)),[]);v.assert.call(void 0,0===r.length,`One or more permissions are not allowed:\n${r.join("\n")}`)},Re=new WeakSet,Ae=function(e){return p.getMaxRequestTimeCaveat.call(void 0,e)??this.maxRequestTime},Ne=new WeakSet,Ie=function(e){const t=u.__privateMethod.call(void 0,this,rt,it).call(this,e),n=t.rpcHandler;if(n)return n;const r=new(0,i.RequestQueue)(5),s=new Map,o=async({origin:t,handler:n,request:i,timeout:o})=>{if(!1===this.state.snaps[e].enabled)throw new Error(`Snap "${e}" is disabled.`);if(this.state.snaps[e].status===g.SnapStatus.Installing)throw new Error(`Snap "${e}" is currently being installed. Please try again later.`);if(!this.isRunning(e)){let n=s.get(e);if(n){if(r.get(t)>=r.maxQueueSize)throw new Error("Exceeds maximum number of requests waiting to be resolved, please try again.")}else n=this.startSnap(e),s.set(e,n);r.increment(t);try{await n}finally{r.decrement(t),s.get(e)===n&&s.delete(e)}}const a=new(0,c.Timer)(o);u.__privateMethod.call(void 0,this,Ge,qe).call(this,e,i.id,a);const d=this.messagingSystem.call("ExecutionService:handleRpcRequest",e,{origin:t,handler:n,request:i});try{const t=await l.withTimeout.call(void 0,d,a);if(t===l.hasTimedOut)throw new Error(`${e} failed to respond to the request in time.`);return await u.__privateMethod.call(void 0,this,We,He).call(this,e,n,t),u.__privateMethod.call(void 0,this,Ue,Fe).call(this,e,n,t)}catch(t){const[n,r]=g.unwrapError.call(void 0,t);throw r||await this.stopSnap(e,g.SnapStatusEvents.Crash),n}finally{u.__privateMethod.call(void 0,this,$e,Ve).call(this,e,i.id)}};return t.rpcHandler=o,o},xe=new WeakSet,Le=async function(e,t){return this.messagingSystem.call("SnapInterfaceController:createInterface",e,t)},Be=new WeakSet,De=function(e,t){v.assert.call(void 0,this.messagingSystem.call("SnapInterfaceController:getInterface",e,t))},Ue=new WeakSet,Fe=async function(e,t,n){switch(t){case g.HandlerType.OnTransaction:case g.HandlerType.OnSignature:case g.HandlerType.OnHomePage:{const t=n;if(t&&v.hasProperty.call(void 0,t,"content")){const{content:n,...r}=t;return{...r,id:await u.__privateMethod.call(void 0,this,xe,Le).call(this,e,n)}}return n}default:return n}},We=new WeakSet,He=async function(e,t,n){switch(t){case g.HandlerType.OnTransaction:v.assertStruct.call(void 0,n,g.OnTransactionResponseStruct),n&&v.hasProperty.call(void 0,n,"id")&&u.__privateMethod.call(void 0,this,Be,De).call(this,e,n.id);break;case g.HandlerType.OnSignature:v.assertStruct.call(void 0,n,g.OnSignatureResponseStruct),n&&v.hasProperty.call(void 0,n,"id")&&u.__privateMethod.call(void 0,this,Be,De).call(this,e,n.id);break;case g.HandlerType.OnHomePage:v.assertStruct.call(void 0,n,g.OnHomePageResponseStruct),n&&v.hasProperty.call(void 0,n,"id")&&u.__privateMethod.call(void 0,this,Be,De).call(this,e,n.id);break;case g.HandlerType.OnNameLookup:v.assertStruct.call(void 0,n,g.OnNameLookupResponseStruct)}},Ge=new WeakSet,qe=function(e,t,n){const r=u.__privateMethod.call(void 0,this,rt,it).call(this,e);r.pendingInboundRequests.push({requestId:t,timer:n}),r.lastRequest=null},$e=new WeakSet,Ve=function(e,t){const n=u.__privateMethod.call(void 0,this,rt,it).call(this,e);n.pendingInboundRequests=n.pendingInboundRequests.filter((e=>e.requestId!==t)),0===n.pendingInboundRequests.length&&(n.lastRequest=Date.now())},ze=new WeakSet,Ke=function(e){return u.__privateGet.call(void 0,this,D).get(e)},Qe=new WeakSet,Ye=function(e){v.assert.call(void 0,void 0===u.__privateGet.call(void 0,this,D).get(e),new Error(`Snap "${e}" rollback snapshot already exists.`)),u.__privateGet.call(void 0,this,D).set(e,{statePatches:[],permissions:{},newVersion:""});const t=u.__privateGet.call(void 0,this,D).get(e);return v.assert.call(void 0,void 0!==t,new Error(`Snapshot creation failed for ${e}.`)),t},Je=new WeakSet,Ze=async function(e){const t=u.__privateMethod.call(void 0,this,ze,Ke).call(this,e);if(!t)throw new Error("A snapshot does not exist for this snap.");await this.stopSnap(e,g.SnapStatusEvents.Stop),this.get(e)?.status!==g.SnapStatus.Stopped&&u.__privateMethod.call(void 0,this,re,ie).call(this,e,g.SnapStatusEvents.Stop);const{statePatches:n,permissions:r}=t;n?.length&&this.applyPatches(n),this.get(e)?.status!==g.SnapStatus.Stopped&&this.update((t=>{t.snaps[e].status=g.SnapStatus.Stopped})),u.__privateMethod.call(void 0,this,ct,ut).call(this,{snapId:e,unusedPermissions:r.granted,newPermissions:r.revoked,requestData:r.requestData});const i=this.getTruncatedExpect(e);this.messagingSystem.publish("SnapController:snapRolledback",i,t.newVersion),u.__privateGet.call(void 0,this,D).delete(e)},Xe=new WeakSet,et=async function(e){for(const t of e)await u.__privateMethod.call(void 0,this,Je,Ze).call(this,t)},tt=new WeakSet,nt=function(e){return u.__privateGet.call(void 0,this,B).get(e)},rt=new WeakSet,it=function(e){const t=u.__privateMethod.call(void 0,this,tt,nt).call(this,e);return v.assert.call(void 0,void 0!==t,new Error(`Snap "${e}" runtime data not found`)),t},st=new WeakSet,ot=function(e){if(u.__privateGet.call(void 0,this,B).has(e))return;const t=this.get(e),n=b.interpret.call(void 0,u.__privateGet.call(void 0,this,F));n.start({context:{snapId:e},value:t?.status??u.__privateGet.call(void 0,this,F).config.initial}),o.forceStrict.call(void 0,n),u.__privateGet.call(void 0,this,B).set(e,{lastRequest:null,rpcHandler:null,installPromise:null,activeReferences:0,pendingInboundRequests:[],pendingOutboundRequests:0,interpreter:n})},at=new WeakSet,lt=function(e,t){const n=this.messagingSystem.call("PermissionController:getPermissions",e)??{},r=l.setDiff.call(void 0,t,n),i=l.setDiff.call(void 0,n,t);return{newPermissions:r,unusedPermissions:i,approvedPermissions:l.setDiff.call(void 0,n,i)}},ct=new WeakSet,ut=function({snapId:e,unusedPermissions:t={},newPermissions:n={},requestData:r}){const i=Object.keys(t);v.isNonEmptyArray.call(void 0,i)&&this.messagingSystem.call("PermissionController:revokePermissions",{[e]:i}),v.isNonEmptyArray.call(void 0,Object.keys(n))&&this.messagingSystem.call("PermissionController:grantPermissions",{approvedPermissions:n,subject:{origin:e},requestData:r})},dt=new WeakSet,ht=function(e,t){const n=this.getExpect(e);return!v.satisfiesVersionRange.call(void 0,n.version,t)&&!v.gtRange.call(void 0,n.version,t)},ft=new WeakSet,pt=async function(e,t){const n=p.handlerEndowments[t];v.assert.call(void 0,n,"Lifecycle hook must have an endowment.");this.messagingSystem.call("PermissionController:hasPermission",e,n)&&await this.handleRequest({snapId:e,handler:t,origin:"",request:{jsonrpc:"2.0",method:t}})},n.controllerName=y,n.SNAP_APPROVAL_INSTALL=_,n.SNAP_APPROVAL_UPDATE=S,n.SNAP_APPROVAL_RESULT=k,n.SnapController=mt}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-V7FYGVMW.js"}],[1587,{"./chunk-EXN2TFDJ.js":1572,"./chunk-NXZVKBSV.js":1581,"./chunk-XE5IWVNV.js":1591,"@metamask/json-rpc-engine":1234,"@metamask/object-multiplex":1435,"@metamask/rpc-errors":1525,"@metamask/snaps-utils":1705,"@metamask/utils":1806,"json-rpc-middleware-stream":3153,nanoid:1596,"readable-stream":1612},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i,s,o,a,l,c,u,d,h,f,p,m,g,v,b=e("./chunk-NXZVKBSV.js"),w=e("./chunk-XE5IWVNV.js"),y=e("./chunk-EXN2TFDJ.js"),_=e("@metamask/json-rpc-engine"),S=e("@metamask/object-multiplex"),k=(r=S)&&r.__esModule?r:{default:r},E=e("@metamask/rpc-errors"),T=e("@metamask/snaps-utils"),P=e("@metamask/utils"),C=e("json-rpc-middleware-stream"),O=e("nanoid"),j=e("readable-stream"),M="ExecutionService";function R(e,t){const n=new(0,k.default);return j.pipeline.call(void 0,e,n,e,(e=>{e&&(t?T.logError.call(void 0,`"${t}" stream failure.`,e):T.logError.call(void 0,e))})),n}i=new WeakMap,s=new WeakMap,o=new WeakMap,a=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakSet,d=function(e){y.__privateGet.call(void 0,this,i).delete(e)},h=new WeakSet,f=function(e,t){y.__privateGet.call(void 0,this,i).set(e,(async({origin:n,handler:r,request:i})=>await this.command(t,{id:O.nanoid.call(void 0),jsonrpc:"2.0",method:"snapRpc",params:{origin:n,handler:r,request:i,target:e}})))},p=new WeakSet,m=function(e,t){y.__privateGet.call(void 0,this,s).set(e,t),y.__privateGet.call(void 0,this,o).set(t,e)},g=new WeakSet,v=function(e){const t=y.__privateGet.call(void 0,this,o).get(e);if(!t)throw new Error(`job: "${e}" has no mapped snap.`);y.__privateGet.call(void 0,this,o).delete(e),y.__privateGet.call(void 0,this,s).delete(t),y.__privateMethod.call(void 0,this,u,d).call(this,t)},n.AbstractExecutionService=class{constructor({setupSnapProvider:e,messenger:t,pingTimeout:n=P.inMilliseconds.call(void 0,2,P.Duration.Second),terminationTimeout:r=P.inMilliseconds.call(void 0,1,P.Duration.Second)}){y.__privateAdd.call(void 0,this,u),y.__privateAdd.call(void 0,this,h),y.__privateAdd.call(void 0,this,p),y.__privateAdd.call(void 0,this,g),y.__privateAdd.call(void 0,this,i,void 0),y.__privateAdd.call(void 0,this,s,void 0),y.__privateAdd.call(void 0,this,o,void 0),y.__privateAdd.call(void 0,this,a,void 0),y.__privateAdd.call(void 0,this,l,void 0),y.__privateAdd.call(void 0,this,c,void 0),y.__privateSet.call(void 0,this,i,new Map),this.jobs=new Map,this.setupSnapProvider=e,y.__privateSet.call(void 0,this,s,new Map),y.__privateSet.call(void 0,this,o,new Map),y.__privateSet.call(void 0,this,a,t),y.__privateSet.call(void 0,this,l,n),y.__privateSet.call(void 0,this,c,r),this.registerMessageHandlers()}registerMessageHandlers(){y.__privateGet.call(void 0,this,a).registerActionHandler(`${M}:handleRpcRequest`,(async(e,t)=>this.handleRpcRequest(e,t))),y.__privateGet.call(void 0,this,a).registerActionHandler(`${M}:executeSnap`,(async e=>this.executeSnap(e))),y.__privateGet.call(void 0,this,a).registerActionHandler(`${M}:terminateSnap`,(async e=>this.terminateSnap(e))),y.__privateGet.call(void 0,this,a).registerActionHandler(`${M}:terminateAllSnaps`,(async()=>this.terminateAllSnaps()))}async terminate(e){const t=this.jobs.get(e);if(!t)throw new Error(`Job with id "${e}" not found.`);const n=await w.withTimeout.call(void 0,this.command(e,{jsonrpc:"2.0",method:"terminate",params:[],id:O.nanoid.call(void 0)}),y.__privateGet.call(void 0,this,c));n!==w.hasTimedOut&&"OK"===n||T.logError.call(void 0,`Job "${e}" failed to terminate gracefully.`,n),Object.values(t.streams).forEach((e=>{try{!e.destroyed&&e.destroy(),e.removeAllListeners()}catch(e){T.logError.call(void 0,"Error while destroying stream",e)}})),this.terminateJob(t),y.__privateMethod.call(void 0,this,g,v).call(this,e),this.jobs.delete(e),b.log.call(void 0,`Job "${e}" terminated.`)}async initJob(){const e=O.nanoid.call(void 0),{streams:t,worker:n}=await this.initStreams(e),r=new(0,_.JsonRpcEngine),i=C.createStreamMiddleware.call(void 0);j.pipeline.call(void 0,i.stream,t.command,i.stream,(e=>{e&&T.logError.call(void 0,"Command stream failure.",e)})),r.push(i.middleware);const s={id:e,streams:t,rpcEngine:r,worker:n};return this.jobs.set(e,s),s}async initStreams(e){const{worker:t,stream:n}=await this.initEnvStream(e),r=R(n,`Job: "${e}"`),i=r.createStream(T.SNAP_STREAM_NAMES.COMMAND),s=t=>{if(!P.isJsonRpcNotification.call(void 0,t))return;const n=y.__privateGet.call(void 0,this,o).get(e);"OutboundRequest"===t.method?y.__privateGet.call(void 0,this,a).publish("ExecutionService:outboundRequest",n):"OutboundResponse"===t.method?y.__privateGet.call(void 0,this,a).publish("ExecutionService:outboundResponse",n):"UnhandledError"===t.method?P.isObject.call(void 0,t.params)&&t.params.error?(y.__privateGet.call(void 0,this,a).publish("ExecutionService:unhandledError",n,t.params.error),i.removeListener("data",s)):T.logError.call(void 0,new Error(`Received malformed "${t.method}" command stream notification.`)):T.logError.call(void 0,new Error(`Received unexpected command stream notification "${t.method}".`))};i.on("data",s);const l=r.createStream(T.SNAP_STREAM_NAMES.JSON_RPC);return{streams:{command:i,rpc:l,_connection:n},worker:t}}async terminateSnap(e){const t=y.__privateGet.call(void 0,this,s).get(e);t&&await this.terminate(t)}async terminateAllSnaps(){await Promise.all([...this.jobs.keys()].map((async e=>this.terminate(e)))),y.__privateGet.call(void 0,this,i).clear()}getRpcRequestHandler(e){return y.__privateGet.call(void 0,this,i).get(e)}async executeSnap(e){if(y.__privateGet.call(void 0,this,s).has(e.snapId))throw new Error(`Snap "${e.snapId}" is already being executed.`);const t=await this.initJob();y.__privateMethod.call(void 0,this,p,m).call(this,e.snapId,t.id);if(await w.withTimeout.call(void 0,this.command(t.id,{jsonrpc:"2.0",method:"ping",id:O.nanoid.call(void 0)}),y.__privateGet.call(void 0,this,l))===w.hasTimedOut)throw new Error("The Snaps execution environment failed to start.");const n=t.streams.rpc;this.setupSnapProvider(e.snapId,n);const r=await this.command(t.id,{jsonrpc:"2.0",method:"executeSnap",params:e,id:O.nanoid.call(void 0)});return y.__privateMethod.call(void 0,this,h,f).call(this,e.snapId,t.id),r}async command(e,t){P.assertIsJsonRpcRequest.call(void 0,t);const n=this.jobs.get(e);if(!n)throw new Error(`Job with id "${e}" not found.`);b.log.call(void 0,"Parent: Sending Command",t);const r=await n.rpcEngine.handle(t);if(r.error)throw new(0,E.JsonRpcError)(r.error.code,r.error.message,r.error.data);return r.result}async handleRpcRequest(e,t){const n=this.getRpcRequestHandler(e);if(!n)throw new Error(`Snap execution service returned no RPC handler for running snap "${e}".`);return n(t)}},n.setupMultiplex=R}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-VJZI4VSJ.js"}],[1588,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-VNOCJWOK.js"}],[1589,{"./chunk-7Y6P5FRN.js":1567,"./chunk-EXN2TFDJ.js":1572,"./chunk-VJZI4VSJ.js":1587,"@metamask/post-message-stream":1485,"@metamask/snaps-utils":1705,"@metamask/utils":1806,nanoid:1596},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,i,s=e("./chunk-VJZI4VSJ.js"),o=e("./chunk-7Y6P5FRN.js"),a=e("./chunk-EXN2TFDJ.js"),l=e("@metamask/post-message-stream"),c=e("@metamask/snaps-utils"),u=e("@metamask/utils"),d=e("nanoid"),h="snaps-worker-pool",f=class extends s.AbstractExecutionService{constructor({documentUrl:e,messenger:t,setupSnapProvider:n}){super({messenger:t,setupSnapProvider:n}),a.__privateAdd.call(void 0,this,r,void 0),a.__privateAdd.call(void 0,this,i,void 0),a.__privateSet.call(void 0,this,r,e)}async terminateJob(e){u.assert.call(void 0,a.__privateGet.call(void 0,this,i),"Runtime stream not initialized."),a.__privateGet.call(void 0,this,i).write({jobId:e.id,data:{jsonrpc:"2.0",method:"terminateJob",id:d.nanoid.call(void 0)}})}async initEnvStream(e){await this.createDocument(),u.assert.call(void 0,a.__privateGet.call(void 0,this,i),"Runtime stream not initialized.");return{worker:e,stream:new(0,o.ProxyPostMessageStream)({stream:a.__privateGet.call(void 0,this,i),jobId:e})}}async createDocument(){if(document.getElementById(h))return;const e=await c.createWindow.call(void 0,a.__privateGet.call(void 0,this,r).href,h,!1);a.__privateSet.call(void 0,this,i,new(0,l.WindowPostMessageStream)({name:"parent",target:"child",targetWindow:e,targetOrigin:"*"}))}};r=new WeakMap,i=new WeakMap,n.WORKER_POOL_ID=h,n.WebWorkerExecutionService=f}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-VOAJRWUB.js"}],[159,{"@metamask/permission-controller":1463,lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("@metamask/permission-controller"),i=e("lodash");n.default={version:69,async migrate(e){const t=(0,i.cloneDeep)(e);t.meta.version=69;const n=function(e){var t;if("object"==typeof(null==e||null===(t=e.SubjectMetadataController)||void 0===t?void 0:t.subjectMetadata)){const{SubjectMetadataController:{subjectMetadata:t}}=e;Object.values(t).forEach((e=>{e&&"object"==typeof e&&!Array.isArray(e)&&(e.subjectType=e.extensionId?r.SubjectType.Extension:r.SubjectType.Website)}))}return e}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/069.js"}],[1590,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-WEY7ICES.js"}],[1591,{"./chunk-NOLPMHXS.js":1580,"@metamask/snaps-sdk":1669,"@metamask/snaps-utils":1705},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("./chunk-NOLPMHXS.js"),i=e("@metamask/snaps-sdk"),s=e("@metamask/snaps-utils");function o(e,t){let n;const r=new Promise(((r,i)=>{e.start((()=>{void 0===t?r():r(t)})),n=i}));return r.cancel=()=>{"finished"!==e.status&&(e.cancel(),n(new Error("The delay has been canceled.")))},r}var a=Symbol("Used to check if the requested promise has timeout (see withTimeout)");async function l(e,t){return t&&0!==t.length?await Promise.all(t.map((async t=>e.fetch(t)))):[]}n.setDiff=function(e,t){return Object.entries(e).reduce(((e,[n,r])=>(n in t||(e[n]=r),e)),{})},n.delay=function(e,t){return o(new(0,r.Timer)(e),t)},n.delayWithTimer=o,n.hasTimedOut=a,n.withTimeout=async function(e,t){const n=o("number"==typeof t?new(0,r.Timer)(t):t,a);try{return await Promise.race([e,n])}finally{n.cancel()}},n.getSnapFiles=l,n.fetchSnap=async function(e,t){try{const e=await t.manifest(),n=await t.fetch(e.result.source.location.npm.filePath),{iconPath:r}=e.result.source.location.npm,i=r?await t.fetch(r):void 0,o=await l(t,e.result.source.files);await Promise.all(o.map((async e=>{e.data.base64=await s.encodeBase64.call(void 0,e)})));const a=await l(t,e.result.source.locales),c={manifest:e,sourceCode:n,svgIcon:i,auxiliaryFiles:o,localizationFiles:s.getValidatedLocalizationFiles.call(void 0,a)};return await s.validateFetchedSnap.call(void 0,c),c}catch(t){throw new Error(`Failed to fetch snap "${e}": ${i.getErrorMessage.call(void 0,t)}.`)}}}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-XE5IWVNV.js"}],[1592,{"./chunk-EXN2TFDJ.js":1572,"@metamask/snaps-utils":1705,"@metamask/utils":1806,"browserify-zlib":2455,"concat-stream":1595,"get-npm-tarball-url":2866,"readable-stream":1612,"readable-web-to-node-stream":3741,"tar-stream":3888},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i,s,o,a,l=e("./chunk-EXN2TFDJ.js"),c=e("@metamask/snaps-utils"),u=e("@metamask/utils"),d=e("browserify-zlib"),h=r(e("concat-stream")),f=r(e("get-npm-tarball-url")),p=e("readable-stream"),m=e("readable-web-to-node-stream"),g=e("tar-stream"),v=new URL("https://registry.npmjs.org"),b=class{constructor(e,t={}){l.__privateAdd.call(void 0,this,o),l.__privateAdd.call(void 0,this,i,void 0),l.__privateAdd.call(void 0,this,s,void 0);const n=t.allowCustomRegistries??!1,r=t.fetch??globalThis.fetch.bind(globalThis),a=t.versionRange??c.DEFAULT_REQUESTED_SNAP_VERSION,d=t.resolveVersion??(async e=>e);let h;u.assertStruct.call(void 0,e.toString(),c.NpmSnapIdStruct,"Invalid Snap Id: "),""===e.host&&""===e.port&&""===e.username&&""===e.password?h=v:(h="https://",e.username&&(h+=e.username,e.password&&(h+=`:${e.password}`),h+="@"),h+=e.host,h=new URL(h),u.assert.call(void 0,n,new TypeError(`Custom NPM registries are disabled, tried to use "${h.toString()}".`))),u.assert.call(void 0,"/"===h.pathname&&""===h.search&&""===h.hash),u.assert.call(void 0,""!==e.pathname&&"/"!==e.pathname,new TypeError("The package name in NPM location is empty."));let f=e.pathname;f.startsWith("/")&&(f=f.slice(1)),this.meta={requestedRange:a,registry:h,packageName:f,fetch:r,resolveVersion:d}}async manifest(){if(l.__privateGet.call(void 0,this,i))return l.__privateGet.call(void 0,this,i).clone();const e=await this.fetch("snap.manifest.json"),t=c.parseJson.call(void 0,e.toString());return e.result=c.createSnapManifest.call(void 0,t),l.__privateSet.call(void 0,this,i,e),this.manifest()}async fetch(e){const t=c.normalizeRelative.call(void 0,e);l.__privateGet.call(void 0,this,s)||(await l.__privateMethod.call(void 0,this,o,a).call(this),u.assert.call(void 0,void 0!==l.__privateGet.call(void 0,this,s)));const n=l.__privateGet.call(void 0,this,s).get(t);return u.assert.call(void 0,void 0!==n,new TypeError(`File "${e}" not found in package.`)),n.clone()}get packageName(){return this.meta.packageName}get version(){return u.assert.call(void 0,void 0!==this.meta.version,"Tried to access version without first fetching NPM package."),this.meta.version}get registry(){return this.meta.registry}get versionRange(){return this.meta.requestedRange}};i=new WeakMap,s=new WeakMap,o=new WeakSet,a=async function(){u.assert.call(void 0,void 0===l.__privateGet.call(void 0,this,s));const e=await this.meta.resolveVersion(this.meta.requestedRange),{tarballURL:t,targetVersion:n}=await async function(e,t,n,r){if(S(n)&&u.isValidSemVerVersion.call(void 0,t))return{tarballURL:f.default.call(void 0,e,t),targetVersion:t};const i=await y(e,n,r),s=Object.keys(i?.versions??{}).map((e=>(u.assertIsSemVerVersion.call(void 0,e),e))),o=c.getTargetVersion.call(void 0,s,t);if(null===o)throw new Error(`Failed to find a matching version in npm metadata for package "${e}" and requested semver range "${t}".`);const a=i?.versions?.[o]?.dist?.tarball;return{tarballURL:a,targetVersion:o}}(this.meta.packageName,e,this.meta.registry,this.meta.fetch);if(!c.isValidUrl.call(void 0,t)||!t.toString().endsWith(".tgz"))throw new Error(`Failed to find valid tarball URL in NPM metadata for package "${this.meta.packageName}".`);const r=new URL(t);r.hostname=this.meta.registry.hostname,r.protocol=this.meta.registry.protocol;const i=await this.fetchNpmTarball(r);l.__privateSet.call(void 0,this,s,i),this.meta.version=n};var w=262144e3;async function y(e,t,n){const r=await n(new URL(e,t).toString(),{headers:{accept:S(t)?"application/vnd.npm.install-v1+json; q=1.0, application/json; q=0.8, */*":"application/json"}});if(!r.ok)throw new Error(`Failed to fetch NPM registry entry. Status code: ${r.status}.`);const i=await r.json();if(!u.isObject.call(void 0,i))throw new Error(`Failed to fetch package "${e}" metadata from npm.`);return i}function _(e,t){let n="npm://";return""!==e.username&&(n+=e.username,""!==e.password&&(n+=`:${e.password}`),n+="@"),`${n}${e.host}/${t}/`}function S(e){return e.toString()===v.toString()}var k=/^package\//u;function E(e){return"function"!=typeof e.getReader?e:new(0,m.ReadableWebToNodeStream)(e)}n.DEFAULT_NPM_REGISTRY=v,n.BaseNpmLocation=b,n.TARBALL_SIZE_SAFETY_LIMIT=w,n.NpmLocation=class extends b{async fetchNpmTarball(e){const t=await this.meta.fetch(e.toString());if(!t.ok||!t.body)throw new Error(`Failed to fetch tarball for package "${this.meta.packageName}".`);const n=t.headers.get("content-length");u.assert.call(void 0,n,"Snap tarball has invalid content-length");const r=parseInt(n,10);return u.assert.call(void 0,r<=w,"Snap tarball exceeds size limit"),new Promise(((e,n)=>{const r=new Map,i=function(e,t){u.assert.call(void 0,e.endsWith("/"),"Base needs to end with '/' for relative paths to be added as children instead of siblings."),u.assert.call(void 0,e.startsWith("npm:"),'Protocol mismatch, expected "npm:".');const n=g.extract.call(void 0);let r=0;return n.on("entry",((i,s,o)=>{const{name:a,type:l}=i;if("file"===l){const i=a.replace(k,"");return s.pipe(h.default.call(void 0,{encoding:"uint8array"},(s=>{try{r+=s.byteLength,u.assert.call(void 0,r<w,"Snap tarball exceeds limit of 262144000 bytes.");const n=new(0,c.VirtualFile)({value:s,path:i,data:{canonicalPath:new URL(i,e).toString()}});return u.assert.call(void 0,!t.has(i),"Malformed tarball, multiple files with the same path."),t.set(i,n),o()}catch(e){return n.destroy(e)}})))}return s.on("end",(()=>o())),s.resume()})),n}(_(this.meta.registry,this.meta.packageName),r),s=t.body;if("pipeThrough"in s&&"DecompressionStream"in globalThis){const t=new DecompressionStream("gzip"),o=s.pipeThrough(t);p.pipeline.call(void 0,E(o),i,(t=>{t?n(t):e(r)}))}else p.pipeline.call(void 0,E(s),d.createGunzip.call(void 0),i,(t=>{t?n(t):e(r)}))}))}},n.fetchNpmMetadata=y,n.getNpmCanonicalBasePath=_}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-XWDEGRM5.js"}],[1593,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.getRunnableSnaps=e=>e.filter((e=>e.enabled&&!e.blocked))}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/chunk-YYPUPKQY.js"}],[1594,{"./chunk-4URGXJP7.js":1561,"./chunk-5YBORD3A.js":1562,"./chunk-6HI7J27U.js":1563,"./chunk-6N6KZYVD.js":1564,"./chunk-7JY5VENP.js":1565,"./chunk-7WOG63YY.js":1566,"./chunk-7Y6P5FRN.js":1567,"./chunk-AP7CJ6DA.js":1568,"./chunk-BO2ZDPWV.js":1569,"./chunk-CFTCANAK.js":1570,"./chunk-D74XJG2L.js":1571,"./chunk-EXN2TFDJ.js":1572,"./chunk-G66GQJS6.js":1573,"./chunk-HOY6NKQR.js":1574,"./chunk-JAUAKTUL.js":1575,"./chunk-KLK7ZRMH.js":1576,"./chunk-LAVQZHSH.js":1577,"./chunk-LWBPKSU2.js":1578,"./chunk-MYWDTEX2.js":1579,"./chunk-NOLPMHXS.js":1580,"./chunk-NXZVKBSV.js":1581,"./chunk-OHMCPTOI.js":1582,"./chunk-OIEUL55W.js":1583,"./chunk-Q2ON6SMV.js":1584,"./chunk-RDBT3ZJQ.js":1585,"./chunk-V7FYGVMW.js":1586,"./chunk-VJZI4VSJ.js":1587,"./chunk-VNOCJWOK.js":1588,"./chunk-VOAJRWUB.js":1589,"./chunk-WEY7ICES.js":1590,"./chunk-XE5IWVNV.js":1591,"./chunk-XWDEGRM5.js":1592,"./chunk-YYPUPKQY.js":1593},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("./chunk-MYWDTEX2.js");e("./chunk-JAUAKTUL.js");var i=e("./chunk-V7FYGVMW.js");e("./chunk-G66GQJS6.js");var s=e("./chunk-7JY5VENP.js"),o=e("./chunk-6N6KZYVD.js");e("./chunk-WEY7ICES.js");var a=e("./chunk-7WOG63YY.js"),l=e("./chunk-XWDEGRM5.js"),c=e("./chunk-LWBPKSU2.js"),u=e("./chunk-RDBT3ZJQ.js");e("./chunk-AP7CJ6DA.js"),e("./chunk-5YBORD3A.js");var d=e("./chunk-YYPUPKQY.js");e("./chunk-VNOCJWOK.js");var h=e("./chunk-Q2ON6SMV.js");e("./chunk-KLK7ZRMH.js"),e("./chunk-4URGXJP7.js"),e("./chunk-D74XJG2L.js");var f=e("./chunk-VOAJRWUB.js");e("./chunk-HOY6NKQR.js");var p=e("./chunk-LAVQZHSH.js");e("./chunk-OHMCPTOI.js");var m=e("./chunk-6HI7J27U.js");e("./chunk-CFTCANAK.js");var g=e("./chunk-VJZI4VSJ.js");e("./chunk-OIEUL55W.js");var v=e("./chunk-7Y6P5FRN.js");e("./chunk-BO2ZDPWV.js"),e("./chunk-NXZVKBSV.js");var b=e("./chunk-XE5IWVNV.js");e("./chunk-NOLPMHXS.js"),e("./chunk-EXN2TFDJ.js"),n.AbstractExecutionService=g.AbstractExecutionService,n.BaseNpmLocation=l.BaseNpmLocation,n.CronjobController=r.CronjobController,n.DAILY_TIMEOUT=r.DAILY_TIMEOUT,n.DEFAULT_NPM_REGISTRY=l.DEFAULT_NPM_REGISTRY,n.HttpLocation=u.HttpLocation,n.IframeExecutionService=p.IframeExecutionService,n.JsonSnapsRegistry=s.JsonSnapsRegistry,n.LocalLocation=c.LocalLocation,n.NpmLocation=l.NpmLocation,n.OffscreenExecutionService=m.OffscreenExecutionService,n.ProxyPostMessageStream=v.ProxyPostMessageStream,n.SNAP_APPROVAL_INSTALL=i.SNAP_APPROVAL_INSTALL,n.SNAP_APPROVAL_RESULT=i.SNAP_APPROVAL_RESULT,n.SNAP_APPROVAL_UPDATE=i.SNAP_APPROVAL_UPDATE,n.SnapController=i.SnapController,n.SnapInterfaceController=h.SnapInterfaceController,n.SnapsRegistryStatus=o.SnapsRegistryStatus,n.TARBALL_SIZE_SAFETY_LIMIT=l.TARBALL_SIZE_SAFETY_LIMIT,n.WebWorkerExecutionService=f.WebWorkerExecutionService,n.controllerName=i.controllerName,n.delay=b.delay,n.delayWithTimer=b.delayWithTimer,n.detectSnapLocation=a.detectSnapLocation,n.fetchNpmMetadata=l.fetchNpmMetadata,n.fetchSnap=b.fetchSnap,n.getNpmCanonicalBasePath=l.getNpmCanonicalBasePath,n.getRunnableSnaps=d.getRunnableSnaps,n.getSnapFiles=b.getSnapFiles,n.hasTimedOut=b.hasTimedOut,n.setDiff=b.setDiff,n.setupMultiplex=g.setupMultiplex,n.withTimeout=b.withTimeout}}},{package:"@metamask/snaps-controllers",file:"node_modules/@metamask/snaps-controllers/dist/index.js"}],[1595,{buffer:2461,"buffer-from":2466,inherits:3110,"readable-stream":1612,typedarray:3900},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(n){(function(){var r=e("readable-stream").Writable,i=e("inherits"),s=e("buffer-from");if("undefined"==typeof Uint8Array)var o=e("typedarray").Uint8Array;else o=Uint8Array;function a(e,t){if(!(this instanceof a))return new a(e,t);"function"==typeof e&&(t=e,e={}),e||(e={});var n=e.encoding,i=!1;n?"u8"!==(n=String(n).toLowerCase())&&"uint8"!==n||(n="uint8array"):i=!0,r.call(this,{objectMode:!0}),this.encoding=n,this.shouldInferEncoding=i,t&&this.on("finish",(function(){t(this.getBody())})),this.body=[]}t.exports=a,i(a,r),a.prototype._write=function(e,t,n){this.body.push(e),n()},a.prototype.inferEncoding=function(e){var t=e===undefined?this.body[0]:e;return n.isBuffer(t)?"buffer":"undefined"!=typeof Uint8Array&&t instanceof Uint8Array?"uint8array":Array.isArray(t)?"array":"string"==typeof t?"string":"[object Object]"===Object.prototype.toString.call(t)?"object":"buffer"},a.prototype.getBody=function(){return this.encoding||0!==this.body.length?(this.shouldInferEncoding&&(this.encoding=this.inferEncoding()),"array"===this.encoding?function(e){for(var t=[],n=0;n<e.length;n++)t.push.apply(t,e[n]);return t}(this.body):"string"===this.encoding?function(e){for(var t=[],r=0;r<e.length;r++){var i=e[r];"string"==typeof i||n.isBuffer(i)?t.push(i):l(i)?t.push(s(i)):t.push(s(String(i)))}t=n.isBuffer(e[0])?(t=n.concat(t)).toString("utf8"):t.join("");return t}(this.body):"buffer"===this.encoding?function(e){for(var t=[],r=0;r<e.length;r++){var i=e[r];n.isBuffer(i)?t.push(i):l(i)?t.push(s(i)):t.push(s(String(i)))}return n.concat(t)}(this.body):"uint8array"===this.encoding?function(e){for(var t=0,n=0;n<e.length;n++)"string"==typeof e[n]&&(e[n]=s(e[n])),t+=e[n].length;for(var r=new o(t),i=(n=0,0);n<e.length;n++)for(var a=e[n],l=0;l<a.length;l++)r[i++]=a[l];return r}(this.body):this.body):[]};Array.isArray;function l(e){return"string"==typeof e||(t=e,/Array\]$/.test(Object.prototype.toString.call(t)))||e&&"function"==typeof e.subarray;var t}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/snaps-controllers>concat-stream",file:"node_modules/@metamask/snaps-controllers/node_modules/concat-stream/index.js"}],[1596,{"./url-alphabet/index.cjs":1597},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){let{urlAlphabet:r}=e("./url-alphabet/index.cjs"),i=e=>crypto.getRandomValues(new Uint8Array(e)),s=(e,t,n)=>{let r=(2<<Math.log(e.length-1)/Math.LN2)-1,i=-~(1.6*r*t/e.length);return(s=t)=>{let o="";for(;;){let t=n(i),a=i;for(;a--;)if(o+=e[t[a]&r]||"",o.length===s)return o}}};t.exports={nanoid:(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+=(t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_"),""),customAlphabet:(e,t=21)=>s(e,t,i),customRandom:s,urlAlphabet:r,random:i}}}},{package:"@metamask/snaps-controllers>nanoid",file:"node_modules/@metamask/snaps-controllers/node_modules/nanoid/index.browser.cjs"}],[1597,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports={urlAlphabet:"useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"}}}},{package:"@metamask/snaps-controllers>nanoid",file:"node_modules/@metamask/snaps-controllers/node_modules/nanoid/url-alphabet/index.cjs"}],[1598,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r={};function i(e,t,n){n||(n=Error);var i=function(e){var n,r;function i(n,r,i){return e.call(this,function(e,n,r){return"string"==typeof t?t:t(e,n,r)}(n,r,i))||this}return r=e,(n=i).prototype=Object.create(r.prototype),n.prototype.constructor=n,n.__proto__=r,i}(n);i.prototype.name=n.name,i.prototype.code=e,r[e]=i}function s(e,t){if(Array.isArray(e)){var n=e.length;return e=e.map((function(e){return String(e)})),n>2?"one of ".concat(t," ").concat(e.slice(0,n-1).join(", "),", or ")+e[n-1]:2===n?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}i("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),i("ERR_INVALID_ARG_TYPE",(function(e,t,n){var r,i,o,a;if("string"==typeof t&&(i="not ",t.substr(!o||o<0?0:+o,i.length)===i)?(r="must not be",t=t.replace(/^not /,"")):r="must be",function(e,t,n){return(n===undefined||n>e.length)&&(n=e.length),e.substring(n-t.length,n)===t}(e," argument"))a="The ".concat(e," ").concat(r," ").concat(s(t,"type"));else{var l=function(e,t,n){return"number"!=typeof n&&(n=0),!(n+t.length>e.length)&&-1!==e.indexOf(t,n)}(e,".")?"property":"argument";a='The "'.concat(e,'" ').concat(l," ").concat(r," ").concat(s(t,"type"))}return a+=". Received type ".concat(typeof n)}),TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.codes=r}}},{package:"@metamask/snaps-controllers>readable-stream",file:"node_modules/@metamask/snaps-controllers/node_modules/readable-stream/errors-browser.js"}],[1599,{"./_stream_readable":1601,"./_stream_writable":1603,_process:3510,inherits:3110},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(n){(function(){var r=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};t.exports=c;var i=e("./_stream_readable"),s=e("./_stream_writable");e("inherits")(c,i);for(var o=r(s.prototype),a=0;a<o.length;a++){var l=o[a];c.prototype[l]||(c.prototype[l]=s.prototype[l])}function c(e){if(!(this instanceof c))return new c(e);i.call(this,e),s.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",u)))}function u(){this._writableState.ended||n.nextTick(d,this)}function d(e){e.end()}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(c.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(c.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==undefined&&this._writableState!==undefined&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){this._readableState!==undefined&&this._writableState!==undefined&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/snaps-controllers>readable-stream",file:"node_modules/@metamask/snaps-controllers/node_modules/readable-stream/lib/_stream_duplex.js"}],[16,{"../../../../shared/constants/permissions":4008,nanoid:3452},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getPermissionBackgroundApiMethods=function(e){return{addPermittedAccount:(t,n)=>{const r=e.getCaveat(t,s.RestrictedMethods.eth_accounts,s.CaveatTypes.restrictReturnedAccounts);r.value.includes(n)||e.updateCaveat(t,s.RestrictedMethods.eth_accounts,s.CaveatTypes.restrictReturnedAccounts,[...r.value,n])},removePermittedAccount:(t,n)=>{const r=e.getCaveat(t,s.RestrictedMethods.eth_accounts,s.CaveatTypes.restrictReturnedAccounts);if(!r.value.includes(n))return;const i=r.value.filter((e=>e!==n));0===i.length?e.revokePermission(t,s.RestrictedMethods.eth_accounts):e.updateCaveat(t,s.RestrictedMethods.eth_accounts,s.CaveatTypes.restrictReturnedAccounts,i)},requestAccountsPermissionWithId:async t=>{const n=(0,i.default)();return e.requestPermissions({origin:t},{eth_accounts:{}},{id:n}),n}}};var r,i=(r=e("nanoid"))&&r.__esModule?r:{default:r},s=e("../../../../shared/constants/permissions")}}},{package:"$root$",file:"app/scripts/controllers/permissions/background-api.js"}],[160,{lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("lodash");n.default={version:70,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=70;const n=function(e){var t;if(Array.isArray(null==e||null===(t=e.PermissionLogController)||void 0===t?void 0:t.permissionActivityLog)){const{PermissionLogController:{permissionActivityLog:t}}=e;t.forEach((e=>{e&&"object"==typeof e&&!Array.isArray(e)&&(delete e.request,delete e.response)}))}return e}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/070.js"}],[1600,{"./_stream_transform":1602,inherits:3110},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports=i;var r=e("./_stream_transform");function i(e){if(!(this instanceof i))return new i(e);r.call(this,e)}e("inherits")(i,r),i.prototype._transform=function(e,t,n){n(null,e)}}}},{package:"@metamask/snaps-controllers>readable-stream",file:"node_modules/@metamask/snaps-controllers/node_modules/readable-stream/lib/_stream_passthrough.js"}],[1601,{"../errors":1598,"./_stream_duplex":1599,"./internal/streams/async_iterator":1604,"./internal/streams/buffer_list":1605,"./internal/streams/destroy":1606,"./internal/streams/from":1608,"./internal/streams/state":1610,"./internal/streams/stream":1611,_process:3510,buffer:2461,events:2788,inherits:3110,"string_decoder/":3880,util:2426},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(n){(function(){var r;t.exports=E,E.ReadableState=k;e("events").EventEmitter;var i=function(e,t){return e.listeners(t).length},s=e("./internal/streams/stream"),o=e("buffer").Buffer,a=("undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var l,c=e("util");l=c&&c.debuglog?c.debuglog("stream"):function(){};var u,d,h,f=e("./internal/streams/buffer_list"),p=e("./internal/streams/destroy"),m=e("./internal/streams/state").getHighWaterMark,g=e("../errors").codes,v=g.ERR_INVALID_ARG_TYPE,b=g.ERR_STREAM_PUSH_AFTER_EOF,w=g.ERR_METHOD_NOT_IMPLEMENTED,y=g.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;e("inherits")(E,s);var _=p.errorOrDestroy,S=["error","close","destroy","pause","resume"];function k(t,n,i){r=r||e("./_stream_duplex"),t=t||{},"boolean"!=typeof i&&(i=n instanceof r),this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=m(this,t,"readableHighWaterMark",i),this.buffer=new f,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(u||(u=e("string_decoder/").StringDecoder),this.decoder=new u(t.encoding),this.encoding=t.encoding)}function E(t){if(r=r||e("./_stream_duplex"),!(this instanceof E))return new E(t);var n=this instanceof r;this._readableState=new k(t,this,n),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),s.call(this)}function T(e,t,n,r,i){l("readableAddChunk",t);var s,c=e._readableState;if(null===t)c.reading=!1,function(e,t){if(l("onEofChunk"),t.ended)return;if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,t.sync?j(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,M(e)))}(e,c);else if(i||(s=function(e,t){var n;r=t,o.isBuffer(r)||r instanceof a||"string"==typeof t||t===undefined||e.objectMode||(n=new v("chunk",["string","Buffer","Uint8Array"],t));var r;return n}(c,t)),s)_(e,s);else if(c.objectMode||t&&t.length>0)if("string"==typeof t||c.objectMode||Object.getPrototypeOf(t)===o.prototype||(t=function(e){return o.from(e)}(t)),r)c.endEmitted?_(e,new y):P(e,c,t,!0);else if(c.ended)_(e,new b);else{if(c.destroyed)return!1;c.reading=!1,c.decoder&&!n?(t=c.decoder.write(t),c.objectMode||0!==t.length?P(e,c,t,!1):R(e,c)):P(e,c,t,!1)}else r||(c.reading=!1,R(e,c));return!c.ended&&(c.length<c.highWaterMark||0===c.length)}function P(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",n)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&j(e)),R(e,t)}Object.defineProperty(E.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==undefined&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),E.prototype.destroy=p.destroy,E.prototype._undestroy=p.undestroy,E.prototype._destroy=function(e,t){t(e)},E.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=o.from(e,t),t=""),n=!0),T(this,e,t,!1,n)},E.prototype.unshift=function(e){return T(this,e,null,!0,!1)},E.prototype.isPaused=function(){return!1===this._readableState.flowing},E.prototype.setEncoding=function(t){u||(u=e("string_decoder/").StringDecoder);var n=new u(t);this._readableState.decoder=n,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,i="";null!==r;)i+=n.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var C=1073741824;function O(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=C?e=C:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function j(e){var t=e._readableState;l("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(l("emitReadable",t.flowing),t.emittedReadable=!0,n.nextTick(M,e))}function M(e){var t=e._readableState;l("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,L(e)}function R(e,t){t.readingMore||(t.readingMore=!0,n.nextTick(A,e,t))}function A(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var n=t.length;if(l("maybeReadMore read 0"),e.read(0),n===t.length)break}t.readingMore=!1}function N(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function I(e){l("readable nexttick read 0"),e.read(0)}function x(e,t){l("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),L(e),t.flowing&&!t.reading&&e.read(0)}function L(e){var t=e._readableState;for(l("flow",t.flowing);t.flowing&&null!==e.read(););}function B(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):n=t.buffer.consume(e,t.decoder),n);var n}function D(e){var t=e._readableState;l("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,n.nextTick(U,t,e))}function U(e,t){if(l("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var n=t._writableState;(!n||n.autoDestroy&&n.finished)&&t.destroy()}}function F(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}E.prototype.read=function(e){l("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return l("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?D(this):j(this),null;if(0===(e=O(e,t))&&t.ended)return 0===t.length&&D(this),null;var r,i=t.needReadable;return l("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&l("length less than watermark",i=!0),t.ended||t.reading?l("reading or ended",i=!1):i&&(l("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=O(n,t))),null===(r=e>0?B(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&D(this)),null!==r&&this.emit("data",r),r},E.prototype._read=function(e){_(this,new w("_read()"))},E.prototype.pipe=function(e,t){var r=this,s=this._readableState;switch(s.pipesCount){case 0:s.pipes=e;break;case 1:s.pipes=[s.pipes,e];break;default:s.pipes.push(e)}s.pipesCount+=1,l("pipe count=%d opts=%j",s.pipesCount,t);var o=(!t||!1!==t.end)&&e!==n.stdout&&e!==n.stderr?c:g;function a(t,n){l("onunpipe"),t===r&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,l("cleanup"),e.removeListener("close",p),e.removeListener("finish",m),e.removeListener("drain",u),e.removeListener("error",f),e.removeListener("unpipe",a),r.removeListener("end",c),r.removeListener("end",g),r.removeListener("data",h),d=!0,!s.awaitDrain||e._writableState&&!e._writableState.needDrain||u())}function c(){l("onend"),e.end()}s.endEmitted?n.nextTick(o):r.once("end",o),e.on("unpipe",a);var u=function(e){return function(){var t=e._readableState;l("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&i(e,"data")&&(t.flowing=!0,L(e))}}(r);e.on("drain",u);var d=!1;function h(t){l("ondata");var n=e.write(t);l("dest.write",n),!1===n&&((1===s.pipesCount&&s.pipes===e||s.pipesCount>1&&-1!==F(s.pipes,e))&&!d&&(l("false write response, pause",s.awaitDrain),s.awaitDrain++),r.pause())}function f(t){l("onerror",t),g(),e.removeListener("error",f),0===i(e,"error")&&_(e,t)}function p(){e.removeListener("finish",m),g()}function m(){l("onfinish"),e.removeListener("close",p),g()}function g(){l("unpipe"),r.unpipe(e)}return r.on("data",h),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",f),e.once("close",p),e.once("finish",m),e.emit("pipe",r),s.flowing||(l("pipe resume"),r.resume()),e},E.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var s=0;s<i;s++)r[s].emit("unpipe",this,{hasUnpiped:!1});return this}var o=F(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},E.prototype.on=function(e,t){var r=s.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===e&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,l("on readable",i.length,i.reading),i.length?j(this):i.reading||n.nextTick(I,this))),r},E.prototype.addListener=E.prototype.on,E.prototype.removeListener=function(e,t){var r=s.prototype.removeListener.call(this,e,t);return"readable"===e&&n.nextTick(N,this),r},E.prototype.removeAllListeners=function(e){var t=s.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&e!==undefined||n.nextTick(N,this),t},E.prototype.resume=function(){var e=this._readableState;return e.flowing||(l("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,n.nextTick(x,e,t))}(this,e)),e.paused=!1,this},E.prototype.pause=function(){return l("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(l("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},E.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;for(var i in e.on("end",(function(){if(l("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(l("wrapped data"),n.decoder&&(i=n.decoder.write(i)),!n.objectMode||null!==i&&i!==undefined)&&((n.objectMode||i&&i.length)&&(t.push(i)||(r=!0,e.pause())))})),e)this[i]===undefined&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var s=0;s<S.length;s++)e.on(S[s],this.emit.bind(this,S[s]));return this._read=function(t){l("wrapped _read",t),r&&(r=!1,e.resume())},this},"function"==typeof Symbol&&(E.prototype[Symbol.asyncIterator]=function(){return d===undefined&&(d=e("./internal/streams/async_iterator")),d(this)}),Object.defineProperty(E.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(E.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(E.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),E._fromList=B,Object.defineProperty(E.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(E.from=function(t,n){return h===undefined&&(h=e("./internal/streams/from")),h(E,t,n)})}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/snaps-controllers>readable-stream",file:"node_modules/@metamask/snaps-controllers/node_modules/readable-stream/lib/_stream_readable.js"}],[1602,{"../errors":1598,"./_stream_duplex":1599,inherits:3110},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports=u;var r=e("../errors").codes,i=r.ERR_METHOD_NOT_IMPLEMENTED,s=r.ERR_MULTIPLE_CALLBACK,o=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=r.ERR_TRANSFORM_WITH_LENGTH_0,l=e("./_stream_duplex");function c(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(null===r)return this.emit("error",new s);n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function u(e){if(!(this instanceof u))return new u(e);l.call(this,e),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",d)}function d(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?h(this,null,null):this._flush((function(t,n){h(e,t,n)}))}function h(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new a;if(e._transformState.transforming)throw new o;return e.push(null)}e("inherits")(u,l),u.prototype.push=function(e,t){return this._transformState.needTransform=!1,l.prototype.push.call(this,e,t)},u.prototype._transform=function(e,t,n){n(new i("_transform()"))},u.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},u.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},u.prototype._destroy=function(e,t){l.prototype._destroy.call(this,e,(function(e){t(e)}))}}}},{package:"@metamask/snaps-controllers>readable-stream",file:"node_modules/@metamask/snaps-controllers/node_modules/readable-stream/lib/_stream_transform.js"}],[1603,{"../errors":1598,"./_stream_duplex":1599,"./internal/streams/destroy":1606,"./internal/streams/state":1610,"./internal/streams/stream":1611,_process:3510,buffer:2461,inherits:3110,"util-deprecate":3938},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(n){(function(){function r(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;e.entry=null;for(;r;){var i=r.callback;t.pendingcb--,i(n),r=r.next}t.corkedRequestsFree.next=e}(t,e)}}var i;t.exports=E,E.WritableState=k;var s={deprecate:e("util-deprecate")},o=e("./internal/streams/stream"),a=e("buffer").Buffer,l=("undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var c,u=e("./internal/streams/destroy"),d=e("./internal/streams/state").getHighWaterMark,h=e("../errors").codes,f=h.ERR_INVALID_ARG_TYPE,p=h.ERR_METHOD_NOT_IMPLEMENTED,m=h.ERR_MULTIPLE_CALLBACK,g=h.ERR_STREAM_CANNOT_PIPE,v=h.ERR_STREAM_DESTROYED,b=h.ERR_STREAM_NULL_VALUES,w=h.ERR_STREAM_WRITE_AFTER_END,y=h.ERR_UNKNOWN_ENCODING,_=u.errorOrDestroy;function S(){}function k(t,s,o){i=i||e("./_stream_duplex"),t=t||{},"boolean"!=typeof o&&(o=s instanceof i),this.objectMode=!!t.objectMode,o&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=d(this,t,"writableHighWaterMark",o),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=!1===t.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,i=r.sync,s=r.writecb;if("function"!=typeof s)throw new m;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,i,s){--t.pendingcb,r?(n.nextTick(s,i),n.nextTick(M,e,t),e._writableState.errorEmitted=!0,_(e,i)):(s(i),e._writableState.errorEmitted=!0,_(e,i),M(e,t))}(e,r,i,t,s);else{var o=O(r)||e.destroyed;o||r.corked||r.bufferProcessing||!r.bufferedRequest||C(e,r),i?n.nextTick(P,e,r,o,s):P(e,r,o,s)}}(s,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new r(this)}function E(t){var n=this instanceof(i=i||e("./_stream_duplex"));if(!n&&!c.call(E,this))return new E(t);this._writableState=new k(t,this,n),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),o.call(this)}function T(e,t,n,r,i,s,o){t.writelen=r,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new v("write")):n?e._writev(i,t.onwrite):e._write(i,s,t.onwrite),t.sync=!1}function P(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),M(e,t)}function C(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var i=t.bufferedRequestCount,s=new Array(i),o=t.corkedRequestsFree;o.entry=n;for(var a=0,l=!0;n;)s[a]=n,n.isBuf||(l=!1),n=n.next,a+=1;s.allBuffers=l,T(e,t,!0,t.length,s,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new r(t),t.bufferedRequestCount=0}else{for(;n;){var c=n.chunk,u=n.encoding,d=n.callback;if(T(e,t,!1,t.objectMode?1:c.length,c,u,d),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function O(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function j(e,t){e._final((function(n){t.pendingcb--,n&&_(e,n),t.prefinished=!0,e.emit("prefinish"),M(e,t)}))}function M(e,t){var r=O(t);if(r&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,n.nextTick(j,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var i=e._readableState;(!i||i.autoDestroy&&i.endEmitted)&&e.destroy()}return r}e("inherits")(E,o),k.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(k.prototype,"buffer",{get:s.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer "+"instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(c=Function.prototype[Symbol.hasInstance],Object.defineProperty(E,Symbol.hasInstance,{value:function(e){return!!c.call(this,e)||this===E&&(e&&e._writableState instanceof k)}})):c=function(e){return e instanceof this},E.prototype.pipe=function(){_(this,new g)},E.prototype.write=function(e,t,r){var i,s=this._writableState,o=!1,c=!s.objectMode&&(i=e,a.isBuffer(i)||i instanceof l);return c&&!a.isBuffer(e)&&(e=function(e){return a.from(e)}(e)),"function"==typeof t&&(r=t,t=null),c?t="buffer":t||(t=s.defaultEncoding),"function"!=typeof r&&(r=S),s.ending?function(e,t){var r=new w;_(e,r),n.nextTick(t,r)}(this,r):(c||function(e,t,r,i){var s;return null===r?s=new b:"string"==typeof r||t.objectMode||(s=new f("chunk",["string","Buffer"],r)),!s||(_(e,s),n.nextTick(i,s),!1)}(this,s,e,r))&&(s.pendingcb++,o=function(e,t,n,r,i,s){if(!n){var o=function(e,t,n){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=a.from(t,n));return t}(t,r,i);r!==o&&(n=!0,i="buffer",r=o)}var l=t.objectMode?1:r.length;t.length+=l;var c=t.length<t.highWaterMark;c||(t.needDrain=!0);if(t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:s,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else T(e,t,!1,l,r,i,s);return c}(this,s,c,e,t,r)),o},E.prototype.cork=function(){this._writableState.corked++},E.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||C(this,e))},E.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new y(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(E.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(E.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),E.prototype._write=function(e,t,n){n(new p("_write()"))},E.prototype._writev=null,E.prototype.end=function(e,t,r){var i=this._writableState;return"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!==e&&e!==undefined&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||function(e,t,r){t.ending=!0,M(e,t),r&&(t.finished?n.nextTick(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,i,r),this},Object.defineProperty(E.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(E.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==undefined&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),E.prototype.destroy=u.destroy,E.prototype._undestroy=u.undestroy,E.prototype._destroy=function(e,t){t(e)}}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/snaps-controllers>readable-stream",file:"node_modules/@metamask/snaps-controllers/node_modules/readable-stream/lib/_stream_writable.js"}],[1604,{"./end-of-stream":1607,_process:3510},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(n){(function(){var r;function i(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(n!==undefined){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=e("./end-of-stream"),o=Symbol("lastResolve"),a=Symbol("lastReject"),l=Symbol("error"),c=Symbol("ended"),u=Symbol("lastPromise"),d=Symbol("handlePromise"),h=Symbol("stream");function f(e,t){return{value:e,done:t}}function p(e){var t=e[o];if(null!==t){var n=e[h].read();null!==n&&(e[u]=null,e[o]=null,e[a]=null,t(f(n,!1)))}}function m(e){n.nextTick(p,e)}var g=Object.getPrototypeOf((function(){})),v=Object.setPrototypeOf((i(r={get stream(){return this[h]},next:function(){var e=this,t=this[l];if(null!==t)return Promise.reject(t);if(this[c])return Promise.resolve(f(undefined,!0));if(this[h].destroyed)return new Promise((function(t,r){n.nextTick((function(){e[l]?r(e[l]):t(f(undefined,!0))}))}));var r,i=this[u];if(i)r=new Promise(function(e,t){return function(n,r){e.then((function(){t[c]?n(f(undefined,!0)):t[d](n,r)}),r)}}(i,this));else{var s=this[h].read();if(null!==s)return Promise.resolve(f(s,!1));r=new Promise(this[d])}return this[u]=r,r}},Symbol.asyncIterator,(function(){return this})),i(r,"return",(function(){var e=this;return new Promise((function(t,n){e[h].destroy(null,(function(e){e?n(e):t(f(undefined,!0))}))}))})),r),g);t.exports=function(e){var t,n=Object.create(v,(i(t={},h,{value:e,writable:!0}),i(t,o,{value:null,writable:!0}),i(t,a,{value:null,writable:!0}),i(t,l,{value:null,writable:!0}),i(t,c,{value:e._readableState.endEmitted,writable:!0}),i(t,d,{value:function(e,t){var r=n[h].read();r?(n[u]=null,n[o]=null,n[a]=null,e(f(r,!1))):(n[o]=e,n[a]=t)},writable:!0}),t));return n[u]=null,s(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=n[a];return null!==t&&(n[u]=null,n[o]=null,n[a]=null,t(e)),void(n[l]=e)}var r=n[o];null!==r&&(n[u]=null,n[o]=null,n[a]=null,r(f(undefined,!0))),n[c]=!0})),e.on("readable",m.bind(null,n)),n}}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/snaps-controllers>readable-stream",file:"node_modules/@metamask/snaps-controllers/node_modules/readable-stream/lib/internal/streams/async_iterator.js"}],[1605,{buffer:2461,util:2426},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return(t=a(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function a(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(n!==undefined){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var l=e("buffer").Buffer,c=e("util").inspect,u=c&&c.custom||"inspect";t.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,n,r;return t=e,(n=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n}},{key:"concat",value:function(e){if(0===this.length)return l.alloc(0);for(var t,n,r,i=l.allocUnsafe(e>>>0),s=this.head,o=0;s;)t=s.data,n=i,r=o,l.prototype.copy.call(t,n,r),o+=s.data.length,s=s.next;return i}},{key:"consume",value:function(e,t){var n;return e<this.head.data.length?(n=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):n=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,n=1,r=t.data;for(e-=r.length;t=t.next;){var i=t.data,s=e>i.length?i.length:e;if(s===i.length?r+=i:r+=i.slice(0,e),0==(e-=s)){s===i.length?(++n,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(s));break}++n}return this.length-=n,r}},{key:"_getBuffer",value:function(e){var t=l.allocUnsafe(e),n=this.head,r=1;for(n.data.copy(t),e-=n.data.length;n=n.next;){var i=n.data,s=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,s),0==(e-=s)){s===i.length?(++r,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=i.slice(s));break}++r}return this.length-=r,t}},{key:u,value:function(e,t){return c(this,i(i({},t),{},{depth:0,customInspect:!1}))}}])&&o(t.prototype,n),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()}}},{package:"@metamask/snaps-controllers>readable-stream",file:"node_modules/@metamask/snaps-controllers/node_modules/readable-stream/lib/internal/streams/buffer_list.js"}],[1606,{_process:3510},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(e){(function(){function n(e,t){i(e,t),r(e)}function r(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function i(e,t){e.emit("error",t)}t.exports={destroy:function(t,s){var o=this,a=this._readableState&&this._readableState.destroyed,l=this._writableState&&this._writableState.destroyed;return a||l?(s?s(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,e.nextTick(i,this,t)):e.nextTick(i,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!s&&t?o._writableState?o._writableState.errorEmitted?e.nextTick(r,o):(o._writableState.errorEmitted=!0,e.nextTick(n,o,t)):e.nextTick(n,o,t):s?(e.nextTick(r,o),s(t)):e.nextTick(r,o)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var n=e._readableState,r=e._writableState;n&&n.autoDestroy||r&&r.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this)}).call(this,e("_process"))}}},{package:"@metamask/snaps-controllers>readable-stream",file:"node_modules/@metamask/snaps-controllers/node_modules/readable-stream/lib/internal/streams/destroy.js"}],[1607,{"../../../errors":1598},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function i(){}t.exports=function e(t,n,s){if("function"==typeof n)return e(t,null,n);n||(n={}),s=function(e){var t=!1;return function(){if(!t){t=!0;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e.apply(this,r)}}}(s||i);var o=n.readable||!1!==n.readable&&t.readable,a=n.writable||!1!==n.writable&&t.writable,l=function(){t.writable||u()},c=t._writableState&&t._writableState.finished,u=function(){a=!1,c=!0,o||s.call(t)},d=t._readableState&&t._readableState.endEmitted,h=function(){o=!1,d=!0,a||s.call(t)},f=function(e){s.call(t,e)},p=function(){var e;return o&&!d?(t._readableState&&t._readableState.ended||(e=new r),s.call(t,e)):a&&!c?(t._writableState&&t._writableState.ended||(e=new r),s.call(t,e)):void 0},m=function(){t.req.on("finish",u)};return!function(e){return e.setHeader&&"function"==typeof e.abort}(t)?a&&!t._writableState&&(t.on("end",l),t.on("close",l)):(t.on("complete",u),t.on("abort",p),t.req?m():t.on("request",m)),t.on("end",h),t.on("finish",u),!1!==n.error&&t.on("error",f),t.on("close",p),function(){t.removeListener("complete",u),t.removeListener("abort",p),t.removeListener("request",m),t.req&&t.req.removeListener("finish",u),t.removeListener("end",l),t.removeListener("close",l),t.removeListener("finish",u),t.removeListener("end",h),t.removeListener("error",f),t.removeListener("close",p)}}}}},{package:"@metamask/snaps-controllers>readable-stream",file:"node_modules/@metamask/snaps-controllers/node_modules/readable-stream/lib/internal/streams/end-of-stream.js"}],[1608,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports=function(){throw new Error("Readable.from is not available in the browser")}}}},{package:"@metamask/snaps-controllers>readable-stream",file:"node_modules/@metamask/snaps-controllers/node_modules/readable-stream/lib/internal/streams/from-browser.js"}],[1609,{"../../../errors":1598,"./end-of-stream":1607},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r;var i=e("../../../errors").codes,s=i.ERR_MISSING_ARGS,o=i.ERR_STREAM_DESTROYED;function a(e){if(e)throw e}function l(e){e()}function c(e,t){return e.pipe(t)}t.exports=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var u,d=function(e){return e.length?"function"!=typeof e[e.length-1]?a:e.pop():a}(n);if(Array.isArray(n[0])&&(n=n[0]),n.length<2)throw new s("streams");var h=n.map((function(t,i){var s=i<n.length-1;return function(t,n,i,s){s=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(s);var a=!1;t.on("close",(function(){a=!0})),r===undefined&&(r=e("./end-of-stream")),r(t,{readable:n,writable:i},(function(e){if(e)return s(e);a=!0,s()}));var l=!1;return function(e){if(!a&&!l)return l=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(t)?t.abort():"function"==typeof t.destroy?t.destroy():void s(e||new o("pipe"))}}(t,s,i>0,(function(e){u||(u=e),e&&h.forEach(l),s||(h.forEach(l),d(u))}))}));return n.reduce(c)}}}},{package:"@metamask/snaps-controllers>readable-stream",file:"node_modules/@metamask/snaps-controllers/node_modules/readable-stream/lib/internal/streams/pipeline.js"}],[161,{lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("lodash");n.default={version:71,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=71;const n=function(e){e.NotificationController&&(e.AnnouncementController={announcements:e.NotificationController.notifications},delete e.NotificationController);return e}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/071.js"}],[1610,{"../../../errors":1598},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;t.exports={getHighWaterMark:function(e,t,n,i){var s=function(e,t,n){return null!=e.highWaterMark?e.highWaterMark:t?e[n]:null}(t,i,n);if(null!=s){if(!isFinite(s)||Math.floor(s)!==s||s<0)throw new r(i?n:"highWaterMark",s);return Math.floor(s)}return e.objectMode?16:16384}}}}},{package:"@metamask/snaps-controllers>readable-stream",file:"node_modules/@metamask/snaps-controllers/node_modules/readable-stream/lib/internal/streams/state.js"}],[1611,{events:2788},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports=e("events").EventEmitter}}},{package:"@metamask/snaps-controllers>readable-stream",file:"node_modules/@metamask/snaps-controllers/node_modules/readable-stream/lib/internal/streams/stream-browser.js"}],[1612,{"./lib/_stream_duplex.js":1599,"./lib/_stream_passthrough.js":1600,"./lib/_stream_readable.js":1601,"./lib/_stream_transform.js":1602,"./lib/_stream_writable.js":1603,"./lib/internal/streams/end-of-stream.js":1607,"./lib/internal/streams/pipeline.js":1609},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(n=t.exports=e("./lib/_stream_readable.js")).Stream=n,n.Readable=n,n.Writable=e("./lib/_stream_writable.js"),n.Duplex=e("./lib/_stream_duplex.js"),n.Transform=e("./lib/_stream_transform.js"),n.PassThrough=e("./lib/_stream_passthrough.js"),n.finished=e("./lib/internal/streams/end-of-stream.js"),n.pipeline=e("./lib/internal/streams/pipeline.js")}}},{package:"@metamask/snaps-controllers>readable-stream",file:"node_modules/@metamask/snaps-controllers/node_modules/readable-stream/readable-browser.js"}],[1613,{"./verify":1614,"@metamask/utils":1806,superstruct:3884},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){r===undefined&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===undefined&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),n.SnapsRegistryDatabaseStruct=n.BlockedSnapStruct=n.BlockReasonStruct=n.VerifiedSnapStruct=n.ImagePathStruct=n.AdditionalSourceCodeStruct=n.SupportStruct=n.AuditStruct=n.AuthorStruct=void 0;const s=e("@metamask/utils"),o=e("superstruct"),a=(0,o.refine)((0,o.string)(),"Npm ID",(e=>e.startsWith("npm:"))),l=(0,o.object)({checksum:s.ChecksumStruct});n.AuthorStruct=(0,o.object)({name:(0,o.string)(),website:(0,o.string)()}),n.AuditStruct=(0,o.object)({auditor:(0,o.string)(),report:(0,o.string)()}),n.SupportStruct=(0,o.object)({knowledgeBase:(0,o.optional)((0,o.string)()),faq:(0,o.optional)((0,o.string)()),contact:(0,o.optional)((0,o.string)()),keyRecovery:(0,o.optional)((0,o.string)())}),n.AdditionalSourceCodeStruct=(0,o.object)({name:(0,o.string)(),url:(0,o.string)()}),n.ImagePathStruct=(0,o.pattern)((0,o.string)(),/\.\/images\/.*\/\d+\.(?:png|jpe?g)$/u),n.VerifiedSnapStruct=(0,o.object)({id:a,metadata:(0,o.object)({name:(0,o.string)(),type:(0,o.optional)((0,o.enums)(["account"])),author:(0,o.optional)(n.AuthorStruct),website:(0,o.optional)((0,o.string)()),onboard:(0,o.optional)((0,o.boolean)()),summary:(0,o.optional)((0,o.string)()),description:(0,o.optional)((0,o.string)()),audits:(0,o.optional)((0,o.array)(n.AuditStruct)),category:(0,o.optional)((0,o.enums)(["interoperability","notifications","transaction insights","account management"])),tags:(0,o.optional)((0,o.array)((0,o.string)())),support:(0,o.optional)(n.SupportStruct),sourceCode:(0,o.optional)((0,o.string)()),hidden:(0,o.optional)((0,o.boolean)()),privateCode:(0,o.optional)((0,o.boolean)()),privacyPolicy:(0,o.optional)((0,o.string)()),termsOfUse:(0,o.optional)((0,o.string)()),additionalSourceCode:(0,o.optional)((0,o.array)(n.AdditionalSourceCodeStruct)),screenshots:(0,o.optional)((0,o.size)((0,o.array)(n.ImagePathStruct),3,3))}),versions:(0,o.record)(s.VersionStruct,l)}),n.BlockReasonStruct=(0,o.object)({explanation:(0,o.optional)((0,o.string)()),url:(0,o.optional)((0,o.string)())}),n.BlockedSnapStruct=(0,o.union)([(0,o.object)({id:a,versionRange:s.VersionRangeStruct,reason:(0,o.optional)(n.BlockReasonStruct)}),(0,o.object)({checksum:s.ChecksumStruct,reason:(0,o.optional)(n.BlockReasonStruct)})]),n.SnapsRegistryDatabaseStruct=(0,o.object)({verifiedSnaps:(0,o.record)(a,n.VerifiedSnapStruct),blockedSnaps:(0,o.array)(n.BlockedSnapStruct)}),i(e("./verify"),n)}}},{package:"@metamask/snaps-utils>@metamask/snaps-registry",file:"node_modules/@metamask/snaps-registry/dist/index.js"}],[1614,{"@metamask/utils":1806,"@noble/curves/secp256k1":1621,"@noble/hashes/sha256":1841,superstruct:3884},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.verify=n.SignatureStruct=void 0;const r=e("@metamask/utils"),i=e("@noble/curves/secp256k1"),s=e("@noble/hashes/sha256"),o=e("superstruct");n.SignatureStruct=(0,o.object)({signature:r.StrictHexStruct,curve:(0,o.literal)("secp256k1"),format:(0,o.literal)("DER")}),n.verify=function({registry:e,signature:t,publicKey:o}){(0,r.assertStruct)(t,n.SignatureStruct,"Invalid signature object");const a=(0,r.hexToBytes)(o);return i.secp256k1.verify((0,r.remove0x)(t.signature),(0,s.sha256)((0,r.stringToBytes)(e)),a)}}}},{package:"@metamask/snaps-utils>@metamask/snaps-registry",file:"node_modules/@metamask/snaps-registry/dist/verify.js"}],[1615,{"./abstract/weierstrass.js":1620,"@noble/hashes/hmac":1839,"@noble/hashes/utils":1844},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createCurve=n.getHash=void 0;
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const r=e("@noble/hashes/hmac"),i=e("@noble/hashes/utils"),s=e("./abstract/weierstrass.js");function o(e){return{hash:e,hmac:(t,...n)=>(0,r.hmac)(e,t,(0,i.concatBytes)(...n)),randomBytes:i.randomBytes}}n.getHash=o,n.createCurve=function(e,t){const n=t=>(0,s.weierstrass)({...e,...o(t)});return Object.freeze({...n(t),create:n})}}}},{package:"@metamask/snaps-utils>@metamask/snaps-registry>@noble/curves",file:"node_modules/@metamask/snaps-registry/node_modules/@noble/curves/_shortw_utils.js"}],[1616,{"./modular.js":1618,"./utils.js":1619},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateBasic=n.wNAF=void 0;
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const r=e("./modular.js"),i=e("./utils.js"),s=BigInt(0),o=BigInt(1);n.wNAF=function(e,t){const n=(e,t)=>{const n=t.negate();return e?n:t},r=e=>({windows:Math.ceil(t/e)+1,windowSize:2**(e-1)});return{constTimeNegate:n,unsafeLadder(t,n){let r=e.ZERO,i=t;for(;n>s;)n&o&&(r=r.add(i)),i=i.double(),n>>=o;return r},precomputeWindow(e,t){const{windows:n,windowSize:i}=r(t),s=[];let o=e,a=o;for(let e=0;e<n;e++){a=o,s.push(a);for(let e=1;e<i;e++)a=a.add(o),s.push(a);o=a.double()}return s},wNAF(t,i,s){const{windows:a,windowSize:l}=r(t);let c=e.ZERO,u=e.BASE;const d=BigInt(2**t-1),h=2**t,f=BigInt(t);for(let e=0;e<a;e++){const t=e*l;let r=Number(s&d);s>>=f,r>l&&(r-=h,s+=o);const a=t,p=t+Math.abs(r)-1,m=e%2!=0,g=r<0;0===r?u=u.add(n(m,i[a])):c=c.add(n(g,i[p]))}return{p:c,f:u}},wNAFCached(e,t,n,r){const i=e._WINDOW_SIZE||1;let s=t.get(e);return s||(s=this.precomputeWindow(e,i),1!==i&&t.set(e,r(s))),this.wNAF(i,s,n)}}},n.validateBasic=function(e){return(0,r.validateField)(e.Fp),(0,i.validateObject)(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,r.nLength)(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}}}},{package:"@metamask/snaps-utils>@metamask/snaps-registry>@noble/curves",file:"node_modules/@metamask/snaps-registry/node_modules/@noble/curves/abstract/curve.js"}],[1617,{"./modular.js":1618,"./utils.js":1619},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createHasher=n.isogenyMap=n.hash_to_field=n.expand_message_xof=n.expand_message_xmd=void 0;const r=e("./modular.js"),i=e("./utils.js");const s=i.bytesToNumberBE;function o(e,t){if(e<0||e>=1<<8*t)throw new Error(`bad I2OSP call: value=${e} length=${t}`);const n=Array.from({length:t}).fill(0);for(let r=t-1;r>=0;r--)n[r]=255&e,e>>>=8;return new Uint8Array(n)}function a(e,t){const n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e[r]^t[r];return n}function l(e){if(!(0,i.isBytes)(e))throw new Error("Uint8Array expected")}function c(e){if(!Number.isSafeInteger(e))throw new Error("number expected")}function u(e,t,n,r){l(e),l(t),c(n),t.length>255&&(t=r((0,i.concatBytes)((0,i.utf8ToBytes)("H2C-OVERSIZE-DST-"),t)));const{outputLen:s,blockLen:u}=r,d=Math.ceil(n/s);if(d>255)throw new Error("Invalid xmd length");const h=(0,i.concatBytes)(t,o(t.length,1)),f=o(0,u),p=o(n,2),m=new Array(d),g=r((0,i.concatBytes)(f,e,p,o(0,1),h));m[0]=r((0,i.concatBytes)(g,o(1,1),h));for(let e=1;e<=d;e++){const t=[a(g,m[e-1]),o(e+1,1),h];m[e]=r((0,i.concatBytes)(...t))}return(0,i.concatBytes)(...m).slice(0,n)}function d(e,t,n,r,s){if(l(e),l(t),c(n),t.length>255){const e=Math.ceil(2*r/8);t=s.create({dkLen:e}).update((0,i.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(t).digest()}if(n>65535||t.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return s.create({dkLen:n}).update(e).update(o(n,2)).update(t).update(o(t.length,1)).digest()}function h(e,t,n){(0,i.validateObject)(n,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});const{p:o,k:a,m:h,hash:f,expand:p,DST:m}=n;l(e),c(t);const g=function(e){if((0,i.isBytes)(e))return e;if("string"==typeof e)return(0,i.utf8ToBytes)(e);throw new Error("DST must be Uint8Array or string")}(m),v=o.toString(2).length,b=Math.ceil((v+a)/8),w=t*h*b;let y;if("xmd"===p)y=u(e,g,w,f);else if("xof"===p)y=d(e,g,w,a,f);else{if("_internal_pass"!==p)throw new Error('expand must be "xmd" or "xof"');y=e}const _=new Array(t);for(let e=0;e<t;e++){const t=new Array(h);for(let n=0;n<h;n++){const i=b*(n+e*h),a=y.subarray(i,i+b);t[n]=(0,r.mod)(s(a),o)}_[e]=t}return _}n.expand_message_xmd=u,n.expand_message_xof=d,n.hash_to_field=h,n.isogenyMap=function(e,t){const n=t.map((e=>Array.from(e).reverse()));return(t,r)=>{const[i,s,o,a]=n.map((n=>n.reduce(((n,r)=>e.add(e.mul(n,t),r)))));return t=e.div(i,s),r=e.mul(r,e.div(o,a)),{x:t,y:r}}},n.createHasher=function(e,t,n){if("function"!=typeof t)throw new Error("mapToCurve() must be defined");return{hashToCurve(r,i){const s=h(r,2,{...n,DST:n.DST,...i}),o=e.fromAffine(t(s[0])),a=e.fromAffine(t(s[1])),l=o.add(a).clearCofactor();return l.assertValidity(),l},encodeToCurve(r,i){const s=h(r,1,{...n,DST:n.encodeDST,...i}),o=e.fromAffine(t(s[0])).clearCofactor();return o.assertValidity(),o}}}}}},{package:"@metamask/snaps-utils>@metamask/snaps-registry>@noble/curves",file:"node_modules/@metamask/snaps-registry/node_modules/@noble/curves/abstract/hash-to-curve.js"}],[1618,{"./utils.js":1619},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.mapHashToField=n.getMinHashLength=n.getFieldBytesLength=n.hashToPrivateScalar=n.FpSqrtEven=n.FpSqrtOdd=n.Field=n.nLength=n.FpIsSquare=n.FpDiv=n.FpInvertBatch=n.FpPow=n.validateField=n.isNegativeLE=n.FpSqrt=n.tonelliShanks=n.invert=n.pow2=n.pow=n.mod=void 0;
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const r=e("./utils.js"),i=BigInt(0),s=BigInt(1),o=BigInt(2),a=BigInt(3),l=BigInt(4),c=BigInt(5),u=BigInt(8);BigInt(9),BigInt(16);function d(e,t){const n=e%t;return n>=i?n:t+n}function h(e,t,n){if(n<=i||t<i)throw new Error("Expected power/modulo > 0");if(n===s)return i;let r=s;for(;t>i;)t&s&&(r=r*e%n),e=e*e%n,t>>=s;return r}function f(e,t){if(e===i||t<=i)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let n=d(e,t),r=t,o=i,a=s,l=s,c=i;for(;n!==i;){const e=r/n,t=r%n,i=o-l*e,s=a-c*e;r=n,n=t,o=l,a=c,l=i,c=s}if(r!==s)throw new Error("invert: does not exist");return d(o,t)}function p(e){const t=(e-s)/o;let n,r,a;for(n=e-s,r=0;n%o===i;n/=o,r++);for(a=o;a<e&&h(a,t,e)!==e-s;a++);if(1===r){const t=(e+s)/l;return function(e,n){const r=e.pow(n,t);if(!e.eql(e.sqr(r),n))throw new Error("Cannot find square root");return r}}const c=(n+s)/o;return function(e,i){if(e.pow(i,t)===e.neg(e.ONE))throw new Error("Cannot find square root");let o=r,l=e.pow(e.mul(e.ONE,a),n),u=e.pow(i,c),d=e.pow(i,n);for(;!e.eql(d,e.ONE);){if(e.eql(d,e.ZERO))return e.ZERO;let t=1;for(let n=e.sqr(d);t<o&&!e.eql(n,e.ONE);t++)n=e.sqr(n);const n=e.pow(l,s<<BigInt(o-t-1));l=e.sqr(n),u=e.mul(u,n),d=e.mul(d,l),o=t}return u}}function m(e){if(e%l===a){const t=(e+s)/l;return function(e,n){const r=e.pow(n,t);if(!e.eql(e.sqr(r),n))throw new Error("Cannot find square root");return r}}if(e%u===c){const t=(e-c)/u;return function(e,n){const r=e.mul(n,o),i=e.pow(r,t),s=e.mul(n,i),a=e.mul(e.mul(s,o),i),l=e.mul(s,e.sub(a,e.ONE));if(!e.eql(e.sqr(l),n))throw new Error("Cannot find square root");return l}}return p(e)}n.mod=d,n.pow=h,n.pow2=function(e,t,n){let r=e;for(;t-- >i;)r*=r,r%=n;return r},n.invert=f,n.tonelliShanks=p,n.FpSqrt=m;n.isNegativeLE=(e,t)=>(d(e,t)&s)===s;const g=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function v(e,t,n){if(n<i)throw new Error("Expected power > 0");if(n===i)return e.ONE;if(n===s)return t;let r=e.ONE,o=t;for(;n>i;)n&s&&(r=e.mul(r,o)),o=e.sqr(o),n>>=s;return r}function b(e,t){const n=new Array(t.length),r=t.reduce(((t,r,i)=>e.is0(r)?t:(n[i]=t,e.mul(t,r))),e.ONE),i=e.inv(r);return t.reduceRight(((t,r,i)=>e.is0(r)?t:(n[i]=e.mul(t,n[i]),e.mul(t,r))),i),n}function w(e,t){const n=t!==undefined?t:e.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function y(e){if("bigint"!=typeof e)throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function _(e){const t=y(e);return t+Math.ceil(t/2)}n.validateField=function(e){const t=g.reduce(((e,t)=>(e[t]="function",e)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});return(0,r.validateObject)(e,t)},n.FpPow=v,n.FpInvertBatch=b,n.FpDiv=function(e,t,n){return e.mul(t,"bigint"==typeof n?f(n,e.ORDER):e.inv(n))},n.FpIsSquare=function(e){const t=(e.ORDER-s)/o;return n=>{const r=e.pow(n,t);return e.eql(r,e.ZERO)||e.eql(r,e.ONE)}},n.nLength=w,n.Field=function(e,t,n=!1,o={}){if(e<=i)throw new Error(`Expected Field ORDER > 0, got ${e}`);const{nBitLength:a,nByteLength:l}=w(e,t);if(l>2048)throw new Error("Field lengths over 2048 bytes are not supported");const c=m(e),u=Object.freeze({ORDER:e,BITS:a,BYTES:l,MASK:(0,r.bitMask)(a),ZERO:i,ONE:s,create:t=>d(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("Invalid field element: expected bigint, got "+typeof t);return i<=t&&t<e},is0:e=>e===i,isOdd:e=>(e&s)===s,neg:t=>d(-t,e),eql:(e,t)=>e===t,sqr:t=>d(t*t,e),add:(t,n)=>d(t+n,e),sub:(t,n)=>d(t-n,e),mul:(t,n)=>d(t*n,e),pow:(e,t)=>v(u,e,t),div:(t,n)=>d(t*f(n,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>f(t,e),sqrt:o.sqrt||(e=>c(u,e)),invertBatch:e=>b(u,e),cmov:(e,t,n)=>n?t:e,toBytes:e=>n?(0,r.numberToBytesLE)(e,l):(0,r.numberToBytesBE)(e,l),fromBytes:e=>{if(e.length!==l)throw new Error(`Fp.fromBytes: expected ${l}, got ${e.length}`);return n?(0,r.bytesToNumberLE)(e):(0,r.bytesToNumberBE)(e)}});return Object.freeze(u)},n.FpSqrtOdd=function(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");const n=e.sqrt(t);return e.isOdd(n)?n:e.neg(n)},n.FpSqrtEven=function(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");const n=e.sqrt(t);return e.isOdd(n)?e.neg(n):n},n.hashToPrivateScalar=function(e,t,n=!1){const i=(e=(0,r.ensureBytes)("privateHash",e)).length,o=w(t).nByteLength+8;if(o<24||i<o||i>1024)throw new Error(`hashToPrivateScalar: expected ${o}-1024 bytes of input, got ${i}`);return d(n?(0,r.bytesToNumberLE)(e):(0,r.bytesToNumberBE)(e),t-s)+s},n.getFieldBytesLength=y,n.getMinHashLength=_,n.mapHashToField=function(e,t,n=!1){const i=e.length,o=y(t),a=_(t);if(i<16||i<a||i>1024)throw new Error(`expected ${a}-1024 bytes of input, got ${i}`);const l=d(n?(0,r.bytesToNumberBE)(e):(0,r.bytesToNumberLE)(e),t-s)+s;return n?(0,r.numberToBytesLE)(l,o):(0,r.numberToBytesBE)(l,o)}}}},{package:"@metamask/snaps-utils>@metamask/snaps-registry>@noble/curves",file:"node_modules/@metamask/snaps-registry/node_modules/@noble/curves/abstract/modular.js"}],[1619,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateObject=n.createHmacDrbg=n.bitMask=n.bitSet=n.bitGet=n.bitLen=n.utf8ToBytes=n.equalBytes=n.concatBytes=n.ensureBytes=n.numberToVarBytesBE=n.numberToBytesLE=n.numberToBytesBE=n.bytesToNumberLE=n.bytesToNumberBE=n.hexToBytes=n.hexToNumber=n.numberToHexUnpadded=n.bytesToHex=n.isBytes=void 0;
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const r=BigInt(0),i=BigInt(1),s=BigInt(2);function o(e){return e instanceof Uint8Array||null!=e&&"object"==typeof e&&"Uint8Array"===e.constructor.name}n.isBytes=o;const a=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function l(e){if(!o(e))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=a[e[n]];return t}function c(e){const t=e.toString(16);return 1&t.length?`0${t}`:t}function u(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return BigInt(""===e?"0":`0x${e}`)}n.bytesToHex=l,n.numberToHexUnpadded=c,n.hexToNumber=u;const d={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function h(e){return e>=d._0&&e<=d._9?e-d._0:e>=d._A&&e<=d._F?e-(d._A-10):e>=d._a&&e<=d._f?e-(d._a-10):void 0}function f(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);const t=e.length,n=t/2;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let t=0,i=0;t<n;t++,i+=2){const n=h(e.charCodeAt(i)),s=h(e.charCodeAt(i+1));if(n===undefined||s===undefined){const t=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+i)}r[t]=16*n+s}return r}function p(e,t){return f(e.toString(16).padStart(2*t,"0"))}function m(...e){let t=0;for(let n=0;n<e.length;n++){const r=e[n];if(!o(r))throw new Error("Uint8Array expected");t+=r.length}let n=new Uint8Array(t),r=0;for(let t=0;t<e.length;t++){const i=e[t];n.set(i,r),r+=i.length}return n}n.hexToBytes=f,n.bytesToNumberBE=function(e){return u(l(e))},n.bytesToNumberLE=function(e){if(!o(e))throw new Error("Uint8Array expected");return u(l(Uint8Array.from(e).reverse()))},n.numberToBytesBE=p,n.numberToBytesLE=function(e,t){return p(e,t).reverse()},n.numberToVarBytesBE=function(e){return f(c(e))},n.ensureBytes=function(e,t,n){let r;if("string"==typeof t)try{r=f(t)}catch(n){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${n}`)}else{if(!o(t))throw new Error(`${e} must be hex string or Uint8Array`);r=Uint8Array.from(t)}const i=r.length;if("number"==typeof n&&i!==n)throw new Error(`${e} expected ${n} bytes, got ${i}`);return r},n.concatBytes=m,n.equalBytes=function(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return 0===n},n.utf8ToBytes=function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))},n.bitLen=function(e){let t;for(t=0;e>r;e>>=i,t+=1);return t},n.bitGet=function(e,t){return e>>BigInt(t)&i};n.bitSet=(e,t,n)=>e|(n?i:r)<<BigInt(t);n.bitMask=e=>(s<<BigInt(e-1))-i;const g=e=>new Uint8Array(e),v=e=>Uint8Array.from(e);n.createHmacDrbg=function(e,t,n){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof n)throw new Error("hmacFn must be a function");let r=g(e),i=g(e),s=0;const o=()=>{r.fill(1),i.fill(0),s=0},a=(...e)=>n(i,r,...e),l=(e=g())=>{i=a(v([0]),e),r=a(),0!==e.length&&(i=a(v([1]),e),r=a())},c=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const n=[];for(;e<t;){r=a();const t=r.slice();n.push(t),e+=r.length}return m(...n)};return(e,t)=>{o(),l(e);let n=undefined;for(;!(n=t(c()));)l();return o(),n}};const b={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||o(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};n.validateObject=function(e,t,n={}){const r=(t,n,r)=>{const i=b[n];if("function"!=typeof i)throw new Error(`Invalid validator "${n}", expected function`);const s=e[t];if(!(r&&s===undefined||i(s,e)))throw new Error(`Invalid param ${String(t)}=${s} (${typeof s}), expected ${n}`)};for(const[e,n]of Object.entries(t))r(e,n,!1);for(const[e,t]of Object.entries(n))r(e,t,!0);return e}}}},{package:"@metamask/snaps-utils>@metamask/snaps-registry>@noble/curves",file:"node_modules/@metamask/snaps-registry/node_modules/@noble/curves/abstract/utils.js"}],[162,{lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("lodash");n.default={version:72,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=72;const n=function(e){const t=(null==e?void 0:e.PreferencesController)||{};return{...e,PreferencesController:{...t,knownMethodData:{}}}}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/072.js"}],[1620,{"./curve.js":1616,"./modular.js":1618,"./utils.js":1619},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.mapToCurveSimpleSWU=n.SWUFpSqrtRatio=n.weierstrass=n.weierstrassPoints=n.DER=void 0;
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const r=e("./modular.js"),i=e("./utils.js"),s=e("./utils.js"),o=e("./curve.js");const{bytesToNumberBE:a,hexToBytes:l}=i;n.DER={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(e){const{Err:t}=n.DER;if(e.length<2||2!==e[0])throw new t("Invalid signature integer tag");const r=e[1],i=e.subarray(2,r+2);if(!r||i.length!==r)throw new t("Invalid signature integer: wrong length");if(128&i[0])throw new t("Invalid signature integer: negative");if(0===i[0]&&!(128&i[1]))throw new t("Invalid signature integer: unnecessary leading zero");return{d:a(i),l:e.subarray(r+2)}},toSig(e){const{Err:t}=n.DER,r="string"==typeof e?l(e):e;if(!i.isBytes(r))throw new Error("ui8a expected");let s=r.length;if(s<2||48!=r[0])throw new t("Invalid signature tag");if(r[1]!==s-2)throw new t("Invalid signature: incorrect length");const{d:o,l:a}=n.DER._parseInt(r.subarray(2)),{d:c,l:u}=n.DER._parseInt(a);if(u.length)throw new t("Invalid signature: left bytes after parsing");return{r:o,s:c}},hexFromSig(e){const t=e=>8&Number.parseInt(e[0],16)?"00"+e:e,n=e=>{const t=e.toString(16);return 1&t.length?`0${t}`:t},r=t(n(e.s)),i=t(n(e.r)),s=r.length/2,o=i.length/2,a=n(s),l=n(o);return`30${n(o+s+4)}02${l}${i}02${a}${r}`}};const c=BigInt(0),u=BigInt(1),d=BigInt(2),h=BigInt(3),f=BigInt(4);function p(e){const t=function(e){const t=(0,o.validateBasic)(e);i.validateObject(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:s}=t;if(n){if(!r.eql(s,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof n||"bigint"!=typeof n.beta||"function"!=typeof n.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}(e),{Fp:n}=t,a=t.toBytes||((e,t,r)=>{const s=t.toAffine();return i.concatBytes(Uint8Array.from([4]),n.toBytes(s.x),n.toBytes(s.y))}),l=t.fromBytes||(e=>{const t=e.subarray(1);return{x:n.fromBytes(t.subarray(0,n.BYTES)),y:n.fromBytes(t.subarray(n.BYTES,2*n.BYTES))}});function d(e){const{a:r,b:i}=t,s=n.sqr(e),o=n.mul(s,e);return n.add(n.add(o,n.mul(e,r)),i)}if(!n.eql(n.sqr(t.Gy),d(t.Gx)))throw new Error("bad generator point: equation left != right");function f(e){return"bigint"==typeof e&&c<e&&e<t.n}function p(e){if(!f(e))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function m(e){const{allowedPrivateKeyLengths:n,nByteLength:o,wrapPrivateKey:a,n:l}=t;if(n&&"bigint"!=typeof e){if(i.isBytes(e)&&(e=i.bytesToHex(e)),"string"!=typeof e||!n.includes(e.length))throw new Error("Invalid key");e=e.padStart(2*o,"0")}let c;try{c="bigint"==typeof e?e:i.bytesToNumberBE((0,s.ensureBytes)("private key",e,o))}catch(t){throw new Error(`private key must be ${o} bytes, hex or bigint, not ${typeof e}`)}return a&&(c=r.mod(c,l)),p(c),c}const g=new Map;function v(e){if(!(e instanceof b))throw new Error("ProjectivePoint expected")}class b{constructor(e,t,r){if(this.px=e,this.py=t,this.pz=r,null==e||!n.isValid(e))throw new Error("x required");if(null==t||!n.isValid(t))throw new Error("y required");if(null==r||!n.isValid(r))throw new Error("z required")}static fromAffine(e){const{x:t,y:r}=e||{};if(!e||!n.isValid(t)||!n.isValid(r))throw new Error("invalid affine point");if(e instanceof b)throw new Error("projective point not allowed");const i=e=>n.eql(e,n.ZERO);return i(t)&&i(r)?b.ZERO:new b(t,r,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){const t=n.invertBatch(e.map((e=>e.pz)));return e.map(((e,n)=>e.toAffine(t[n]))).map(b.fromAffine)}static fromHex(e){const t=b.fromAffine(l((0,s.ensureBytes)("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return b.BASE.multiply(m(e))}_setWindowSize(e){this._WINDOW_SIZE=e,g.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:e,y:r}=this.toAffine();if(!n.isValid(e)||!n.isValid(r))throw new Error("bad point: x or y not FE");const i=n.sqr(r),s=d(e);if(!n.eql(i,s))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:e}=this.toAffine();if(n.isOdd)return!n.isOdd(e);throw new Error("Field doesn't support isOdd")}equals(e){v(e);const{px:t,py:r,pz:i}=this,{px:s,py:o,pz:a}=e,l=n.eql(n.mul(t,a),n.mul(s,i)),c=n.eql(n.mul(r,a),n.mul(o,i));return l&&c}negate(){return new b(this.px,n.neg(this.py),this.pz)}double(){const{a:e,b:r}=t,i=n.mul(r,h),{px:s,py:o,pz:a}=this;let l=n.ZERO,c=n.ZERO,u=n.ZERO,d=n.mul(s,s),f=n.mul(o,o),p=n.mul(a,a),m=n.mul(s,o);return m=n.add(m,m),u=n.mul(s,a),u=n.add(u,u),l=n.mul(e,u),c=n.mul(i,p),c=n.add(l,c),l=n.sub(f,c),c=n.add(f,c),c=n.mul(l,c),l=n.mul(m,l),u=n.mul(i,u),p=n.mul(e,p),m=n.sub(d,p),m=n.mul(e,m),m=n.add(m,u),u=n.add(d,d),d=n.add(u,d),d=n.add(d,p),d=n.mul(d,m),c=n.add(c,d),p=n.mul(o,a),p=n.add(p,p),d=n.mul(p,m),l=n.sub(l,d),u=n.mul(p,f),u=n.add(u,u),u=n.add(u,u),new b(l,c,u)}add(e){v(e);const{px:r,py:i,pz:s}=this,{px:o,py:a,pz:l}=e;let c=n.ZERO,u=n.ZERO,d=n.ZERO;const f=t.a,p=n.mul(t.b,h);let m=n.mul(r,o),g=n.mul(i,a),w=n.mul(s,l),y=n.add(r,i),_=n.add(o,a);y=n.mul(y,_),_=n.add(m,g),y=n.sub(y,_),_=n.add(r,s);let S=n.add(o,l);return _=n.mul(_,S),S=n.add(m,w),_=n.sub(_,S),S=n.add(i,s),c=n.add(a,l),S=n.mul(S,c),c=n.add(g,w),S=n.sub(S,c),d=n.mul(f,_),c=n.mul(p,w),d=n.add(c,d),c=n.sub(g,d),d=n.add(g,d),u=n.mul(c,d),g=n.add(m,m),g=n.add(g,m),w=n.mul(f,w),_=n.mul(p,_),g=n.add(g,w),w=n.sub(m,w),w=n.mul(f,w),_=n.add(_,w),m=n.mul(g,_),u=n.add(u,m),m=n.mul(S,_),c=n.mul(y,c),c=n.sub(c,m),m=n.mul(y,g),d=n.mul(S,d),d=n.add(d,m),new b(c,u,d)}subtract(e){return this.add(e.negate())}is0(){return this.equals(b.ZERO)}wNAF(e){return y.wNAFCached(this,g,e,(e=>{const t=n.invertBatch(e.map((e=>e.pz)));return e.map(((e,n)=>e.toAffine(t[n]))).map(b.fromAffine)}))}multiplyUnsafe(e){const r=b.ZERO;if(e===c)return r;if(p(e),e===u)return this;const{endo:i}=t;if(!i)return y.unsafeLadder(this,e);let{k1neg:s,k1:o,k2neg:a,k2:l}=i.splitScalar(e),d=r,h=r,f=this;for(;o>c||l>c;)o&u&&(d=d.add(f)),l&u&&(h=h.add(f)),f=f.double(),o>>=u,l>>=u;return s&&(d=d.negate()),a&&(h=h.negate()),h=new b(n.mul(h.px,i.beta),h.py,h.pz),d.add(h)}multiply(e){p(e);let r,i,s=e;const{endo:o}=t;if(o){const{k1neg:e,k1:t,k2neg:a,k2:l}=o.splitScalar(s);let{p:c,f:u}=this.wNAF(t),{p:d,f:h}=this.wNAF(l);c=y.constTimeNegate(e,c),d=y.constTimeNegate(a,d),d=new b(n.mul(d.px,o.beta),d.py,d.pz),r=c.add(d),i=u.add(h)}else{const{p:e,f:t}=this.wNAF(s);r=e,i=t}return b.normalizeZ([r,i])[0]}multiplyAndAddUnsafe(e,t,n){const r=b.BASE,i=(e,t)=>t!==c&&t!==u&&e.equals(r)?e.multiply(t):e.multiplyUnsafe(t),s=i(this,t).add(i(e,n));return s.is0()?undefined:s}toAffine(e){const{px:t,py:r,pz:i}=this,s=this.is0();null==e&&(e=s?n.ONE:n.inv(i));const o=n.mul(t,e),a=n.mul(r,e),l=n.mul(i,e);if(s)return{x:n.ZERO,y:n.ZERO};if(!n.eql(l,n.ONE))throw new Error("invZ was invalid");return{x:o,y:a}}isTorsionFree(){const{h:e,isTorsionFree:n}=t;if(e===u)return!0;if(n)return n(b,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:e,clearCofactor:n}=t;return e===u?this:n?n(b,this):this.multiplyUnsafe(t.h)}toRawBytes(e=!0){return this.assertValidity(),a(b,this,e)}toHex(e=!0){return i.bytesToHex(this.toRawBytes(e))}}b.BASE=new b(t.Gx,t.Gy,n.ONE),b.ZERO=new b(n.ZERO,n.ONE,n.ZERO);const w=t.nBitLength,y=(0,o.wNAF)(b,t.endo?Math.ceil(w/2):w);return{CURVE:t,ProjectivePoint:b,normPrivateKeyToScalar:m,weierstrassEquation:d,isWithinCurveOrder:f}}function m(e,t){const n=e.ORDER;let r=c;for(let e=n-u;e%d===c;e/=d)r+=u;const i=r,s=d<<i-u-u,o=s*d,a=(n-u)/o,l=(a-u)/d,p=o-u,m=s,g=e.pow(t,a),v=e.pow(t,(a+u)/d);let b=(t,n)=>{let r=g,s=e.pow(n,p),o=e.sqr(s);o=e.mul(o,n);let a=e.mul(t,o);a=e.pow(a,l),a=e.mul(a,s),s=e.mul(a,n),o=e.mul(a,t);let c=e.mul(o,s);a=e.pow(c,m);let h=e.eql(a,e.ONE);s=e.mul(o,v),a=e.mul(c,r),o=e.cmov(s,o,h),c=e.cmov(a,c,h);for(let t=i;t>u;t--){let n=t-d;n=d<<n-u;let i=e.pow(c,n);const a=e.eql(i,e.ONE);s=e.mul(o,r),r=e.mul(r,r),i=e.mul(c,r),o=e.cmov(s,o,a),c=e.cmov(i,c,a)}return{isValid:h,value:o}};if(e.ORDER%f===h){const n=(e.ORDER-h)/f,r=e.sqrt(e.neg(t));b=(t,i)=>{let s=e.sqr(i);const o=e.mul(t,i);s=e.mul(s,o);let a=e.pow(s,n);a=e.mul(a,o);const l=e.mul(a,r),c=e.mul(e.sqr(a),i),u=e.eql(c,t);return{isValid:u,value:e.cmov(l,a,u)}}}return b}n.weierstrassPoints=p,n.weierstrass=function(e){const t=function(e){const t=(0,o.validateBasic)(e);return i.validateObject(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}(e),{Fp:a,n:l}=t,d=a.BYTES+1,h=2*a.BYTES+1;function f(e){return r.mod(e,l)}function m(e){return r.invert(e,l)}const{ProjectivePoint:g,normPrivateKeyToScalar:v,weierstrassEquation:b,isWithinCurveOrder:w}=p({...t,toBytes(e,t,n){const r=t.toAffine(),s=a.toBytes(r.x),o=i.concatBytes;return n?o(Uint8Array.from([t.hasEvenY()?2:3]),s):o(Uint8Array.from([4]),s,a.toBytes(r.y))},fromBytes(e){const t=e.length,n=e[0],r=e.subarray(1);if(t!==d||2!==n&&3!==n){if(t===h&&4===n){return{x:a.fromBytes(r.subarray(0,a.BYTES)),y:a.fromBytes(r.subarray(a.BYTES,2*a.BYTES))}}throw new Error(`Point of length ${t} was invalid. Expected ${d} compressed bytes or ${h} uncompressed bytes`)}{const e=i.bytesToNumberBE(r);if(!(c<(s=e)&&s<a.ORDER))throw new Error("Point is not on curve");const t=b(e);let o=a.sqrt(t);return 1==(1&n)!==((o&u)===u)&&(o=a.neg(o)),{x:e,y:o}}var s}}),y=e=>i.bytesToHex(i.numberToBytesBE(e,t.nByteLength));function _(e){return e>l>>u}const S=(e,t,n)=>i.bytesToNumberBE(e.slice(t,n));class k{constructor(e,t,n){this.r=e,this.s=t,this.recovery=n,this.assertValidity()}static fromCompact(e){const n=t.nByteLength;return e=(0,s.ensureBytes)("compactSignature",e,2*n),new k(S(e,0,n),S(e,n,2*n))}static fromDER(e){const{r:t,s:r}=n.DER.toSig((0,s.ensureBytes)("DER",e));return new k(t,r)}assertValidity(){if(!w(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!w(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(e){return new k(this.r,this.s,e)}recoverPublicKey(e){const{r:n,s:r,recovery:i}=this,o=C((0,s.ensureBytes)("msgHash",e));if(null==i||![0,1,2,3].includes(i))throw new Error("recovery id invalid");const l=2===i||3===i?n+t.n:n;if(l>=a.ORDER)throw new Error("recovery id 2 or 3 invalid");const c=0==(1&i)?"02":"03",u=g.fromHex(c+y(l)),d=m(l),h=f(-o*d),p=f(r*d),v=g.BASE.multiplyAndAddUnsafe(u,h,p);if(!v)throw new Error("point at infinify");return v.assertValidity(),v}hasHighS(){return _(this.s)}normalizeS(){return this.hasHighS()?new k(this.r,f(-this.s),this.recovery):this}toDERRawBytes(){return i.hexToBytes(this.toDERHex())}toDERHex(){return n.DER.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return i.hexToBytes(this.toCompactHex())}toCompactHex(){return y(this.r)+y(this.s)}}const E={isValidPrivateKey(e){try{return v(e),!0}catch(e){return!1}},normPrivateKeyToScalar:v,randomPrivateKey:()=>{const e=r.getMinHashLength(t.n);return r.mapHashToField(t.randomBytes(e),t.n)},precompute:(e=8,t=g.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)};function T(e){const t=i.isBytes(e),n="string"==typeof e,r=(t||n)&&e.length;return t?r===d||r===h:n?r===2*d||r===2*h:e instanceof g}const P=t.bits2int||function(e){const n=i.bytesToNumberBE(e),r=8*e.length-t.nBitLength;return r>0?n>>BigInt(r):n},C=t.bits2int_modN||function(e){return f(P(e))},O=i.bitMask(t.nBitLength);function j(e){if("bigint"!=typeof e)throw new Error("bigint expected");if(!(c<=e&&e<O))throw new Error(`bigint expected < 2^${t.nBitLength}`);return i.numberToBytesBE(e,t.nByteLength)}function M(e,n,r=R){if(["recovered","canonical"].some((e=>e in r)))throw new Error("sign() legacy options not supported");const{hash:o,randomBytes:l}=t;let{lowS:d,prehash:h,extraEntropy:p}=r;null==d&&(d=!0),e=(0,s.ensureBytes)("msgHash",e),h&&(e=(0,s.ensureBytes)("prehashed msgHash",o(e)));const b=C(e),y=v(n),S=[j(y),j(b)];if(null!=p){const e=!0===p?l(a.BYTES):p;S.push((0,s.ensureBytes)("extraEntropy",e))}const E=i.concatBytes(...S),T=b;return{seed:E,k2sig:function(e){const t=P(e);if(!w(t))return;const n=m(t),r=g.BASE.multiply(t).toAffine(),i=f(r.x);if(i===c)return;const s=f(n*f(T+i*y));if(s===c)return;let o=(r.x===i?0:2)|Number(r.y&u),a=s;return d&&_(s)&&(a=function(e){return _(e)?f(-e):e}(s),o^=1),new k(i,a,o)}}}const R={lowS:t.lowS,prehash:!1},A={lowS:t.lowS,prehash:!1};return g.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(e,t=!0){return g.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t,n=!0){if(T(e))throw new Error("first arg must be private key");if(!T(t))throw new Error("second arg must be public key");return g.fromHex(t).multiply(v(e)).toRawBytes(n)},sign:function(e,n,r=R){const{seed:s,k2sig:o}=M(e,n,r),a=t;return i.createHmacDrbg(a.hash.outputLen,a.nByteLength,a.hmac)(s,o)},verify:function(e,r,o,a=A){const l=e;if(r=(0,s.ensureBytes)("msgHash",r),o=(0,s.ensureBytes)("publicKey",o),"strict"in a)throw new Error("options.strict was renamed to lowS");const{lowS:c,prehash:u}=a;let d,h=undefined;try{if("string"==typeof l||i.isBytes(l))try{h=k.fromDER(l)}catch(e){if(!(e instanceof n.DER.Err))throw e;h=k.fromCompact(l)}else{if("object"!=typeof l||"bigint"!=typeof l.r||"bigint"!=typeof l.s)throw new Error("PARSE");{const{r:e,s:t}=l;h=new k(e,t)}}d=g.fromHex(o)}catch(e){if("PARSE"===e.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(c&&h.hasHighS())return!1;u&&(r=t.hash(r));const{r:p,s:v}=h,b=C(r),w=m(v),y=f(b*w),_=f(p*w),S=g.BASE.multiplyAndAddUnsafe(d,y,_)?.toAffine();return!!S&&f(S.x)===p},ProjectivePoint:g,Signature:k,utils:E}},n.SWUFpSqrtRatio=m,n.mapToCurveSimpleSWU=function(e,t){if(r.validateField(e),!e.isValid(t.A)||!e.isValid(t.B)||!e.isValid(t.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const n=m(e,t.Z);if(!e.isOdd)throw new Error("Fp.isOdd is not implemented!");return r=>{let i,s,o,a,l,c,u,d;i=e.sqr(r),i=e.mul(i,t.Z),s=e.sqr(i),s=e.add(s,i),o=e.add(s,e.ONE),o=e.mul(o,t.B),a=e.cmov(t.Z,e.neg(s),!e.eql(s,e.ZERO)),a=e.mul(a,t.A),s=e.sqr(o),c=e.sqr(a),l=e.mul(c,t.A),s=e.add(s,l),s=e.mul(s,o),c=e.mul(c,a),l=e.mul(c,t.B),s=e.add(s,l),u=e.mul(i,o);const{isValid:h,value:f}=n(s,c);d=e.mul(i,r),d=e.mul(d,f),u=e.cmov(u,o,h),d=e.cmov(d,f,h);const p=e.isOdd(r)===e.isOdd(d);return d=e.cmov(e.neg(d),d,p),u=e.div(u,a),{x:u,y:d}}}}}},{package:"@metamask/snaps-utils>@metamask/snaps-registry>@noble/curves",file:"node_modules/@metamask/snaps-registry/node_modules/@noble/curves/abstract/weierstrass.js"}],[1621,{"./_shortw_utils.js":1615,"./abstract/hash-to-curve.js":1617,"./abstract/modular.js":1618,"./abstract/utils.js":1619,"./abstract/weierstrass.js":1620,"@noble/hashes/sha256":1841,"@noble/hashes/utils":1844},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.encodeToCurve=n.hashToCurve=n.schnorr=n.secp256k1=void 0;
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const r=e("@noble/hashes/sha256"),i=e("@noble/hashes/utils"),s=e("./abstract/modular.js"),o=e("./abstract/weierstrass.js"),a=e("./abstract/utils.js"),l=e("./abstract/hash-to-curve.js"),c=e("./_shortw_utils.js"),u=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),d=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h=BigInt(1),f=BigInt(2),p=(e,t)=>(e+t/f)/t;function m(e){const t=u,n=BigInt(3),r=BigInt(6),i=BigInt(11),o=BigInt(22),a=BigInt(23),l=BigInt(44),c=BigInt(88),d=e*e*e%t,h=d*d*e%t,p=(0,s.pow2)(h,n,t)*h%t,m=(0,s.pow2)(p,n,t)*h%t,v=(0,s.pow2)(m,f,t)*d%t,b=(0,s.pow2)(v,i,t)*v%t,w=(0,s.pow2)(b,o,t)*b%t,y=(0,s.pow2)(w,l,t)*w%t,_=(0,s.pow2)(y,c,t)*y%t,S=(0,s.pow2)(_,l,t)*w%t,k=(0,s.pow2)(S,n,t)*h%t,E=(0,s.pow2)(k,a,t)*b%t,T=(0,s.pow2)(E,r,t)*d%t,P=(0,s.pow2)(T,f,t);if(!g.eql(g.sqr(P),e))throw new Error("Cannot find square root");return P}const g=(0,s.Field)(u,undefined,undefined,{sqrt:m});n.secp256k1=(0,c.createCurve)({a:BigInt(0),b:BigInt(7),Fp:g,n:d,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=d,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-h*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=n,a=BigInt("0x100000000000000000000000000000000"),l=p(o*e,t),c=p(-r*e,t);let u=(0,s.mod)(e-l*n-c*i,t),f=(0,s.mod)(-l*r-c*o,t);const m=u>a,g=f>a;if(m&&(u=t-u),g&&(f=t-f),u>a||f>a)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:m,k1:u,k2neg:g,k2:f}}}},r.sha256);const v=BigInt(0),b=e=>"bigint"==typeof e&&v<e&&e<u,w=e=>"bigint"==typeof e&&v<e&&e<d,y={};function _(e,...t){let n=y[e];if(n===undefined){const t=(0,r.sha256)(Uint8Array.from(e,(e=>e.charCodeAt(0))));n=(0,a.concatBytes)(t,t),y[e]=n}return(0,r.sha256)((0,a.concatBytes)(n,...t))}const S=e=>e.toRawBytes(!0).slice(1),k=e=>(0,a.numberToBytesBE)(e,32),E=e=>(0,s.mod)(e,u),T=e=>(0,s.mod)(e,d),P=n.secp256k1.ProjectivePoint,C=(e,t,n)=>P.BASE.multiplyAndAddUnsafe(e,t,n);function O(e){let t=n.secp256k1.utils.normPrivateKeyToScalar(e),r=P.fromPrivateKey(t);return{scalar:r.hasEvenY()?t:T(-t),bytes:S(r)}}function j(e){if(!b(e))throw new Error("bad x: need 0 < x < p");const t=E(e*e);let n=m(E(t*e+BigInt(7)));n%f!==v&&(n=E(-n));const r=new P(e,n,h);return r.assertValidity(),r}function M(...e){return T((0,a.bytesToNumberBE)(_("BIP0340/challenge",...e)))}function R(e){return O(e).bytes}function A(e,t,n=(0,i.randomBytes)(32)){const r=(0,a.ensureBytes)("message",e),{bytes:s,scalar:o}=O(t),l=(0,a.ensureBytes)("auxRand",n,32),c=k(o^(0,a.bytesToNumberBE)(_("BIP0340/aux",l))),u=_("BIP0340/nonce",c,s,r),d=T((0,a.bytesToNumberBE)(u));if(d===v)throw new Error("sign failed: k is zero");const{bytes:h,scalar:f}=O(d),p=M(h,s,r),m=new Uint8Array(64);if(m.set(h,0),m.set(k(T(f+p*o)),32),!N(m,r,s))throw new Error("sign: Invalid signature produced");return m}function N(e,t,n){const r=(0,a.ensureBytes)("signature",e,64),i=(0,a.ensureBytes)("message",t),s=(0,a.ensureBytes)("publicKey",n,32);try{const e=j((0,a.bytesToNumberBE)(s)),t=(0,a.bytesToNumberBE)(r.subarray(0,32));if(!b(t))return!1;const n=(0,a.bytesToNumberBE)(r.subarray(32,64));if(!w(n))return!1;const o=M(k(t),S(e),i),l=C(e,n,T(-o));return!(!l||!l.hasEvenY()||l.toAffine().x!==t)}catch(e){return!1}}n.schnorr={getPublicKey:R,sign:A,verify:N,utils:{randomPrivateKey:n.secp256k1.utils.randomPrivateKey,lift_x:j,pointToBytes:S,numberToBytesBE:a.numberToBytesBE,bytesToNumberBE:a.bytesToNumberBE,taggedHash:_,mod:s.mod}};const I=(()=>(0,l.isogenyMap)(g,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map((e=>e.map((e=>BigInt(e)))))))(),x=(()=>(0,o.mapToCurveSimpleSWU)(g,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:g.create(BigInt("-11"))}))(),L=(()=>(0,l.createHasher)(n.secp256k1.ProjectivePoint,(e=>{const{x:t,y:n}=x(g.create(e[0]));return I(t,n)}),{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:g.ORDER,m:1,k:128,expand:"xmd",hash:r.sha256}))();n.hashToCurve=L.hashToCurve,n.encodeToCurve=L.encodeToCurve}}},{package:"@metamask/snaps-utils>@metamask/snaps-registry>@noble/curves",file:"node_modules/@metamask/snaps-registry/node_modules/@noble/curves/secp256k1.js"}],[163,{lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("lodash");n.default={version:73,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=73;const n=function(e){const t=(null==e?void 0:e.PreferencesController)||{};return{...e,PreferencesController:{...t,knownMethodData:{}}}}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/073.js"}],[164,{"../../../shared/constants/network":4006,"bignumber.js":2366,lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r,i=e("lodash"),s=(r=e("bignumber.js"))&&r.__esModule?r:{default:r},o=e("../../../shared/constants/network");const a=e=>new s.default(e||"0x0",16).gt(0),l=["0x3","0x2a","0x4"],c={"0x3":{rpcUrl:(0,o.getRpcUrl)({network:"ropsten"}),nickname:"Ropsten",ticker:"RopstenETH"},"0x2a":{rpcUrl:(0,o.getRpcUrl)({network:"kovan"}),nickname:"Kovan",ticker:"KovanETH"},"0x4":{rpcUrl:(0,o.getRpcUrl)({network:"rinkeby"}),nickname:"Rinkeby",ticker:"RinkebyETH"}};n.default={version:74,async migrate(e){const t=(0,i.cloneDeep)(e);t.meta.version=74;const n=function(e){var t,n;const r=(null==e?void 0:e.PreferencesController)||{},s=r.preferences||{},o=(null==e?void 0:e.NetworkController)||{},u=(null==o?void 0:o.provider)||{},d=l.filter((e=>e===(null==u?void 0:u.chainId)));if(!s.showTestNetworks&&0===d.length)return e;const h=(null==e||null===(t=e.TransactionController)||void 0===t?void 0:t.transactions)||{},f=(null===(n=e.CachedBalancesController)||void 0===n?void 0:n.cachedBalances)||{},p=Object.values(h).filter((({chainId:e})=>l.includes(e))).map((({chainId:e})=>e)),m=l.filter((e=>Object.values(f[e]||{}).some(a))),g=(0,i.uniq)([...m,...p,...d]),v=r.frequentRpcListDetail??[];g.forEach((e=>{v.find((t=>t.chainId===e))||v.unshift({rpcUrl:c[e].rpcUrl,chainId:e,ticker:c[e].ticker,nickname:c[e].nickname,rpcPrefs:{}})})),v.length&&(r.frequentRpcListDetail=v);if(d.length){const e=d[0];o.provider={...o.provider,type:"rpc",rpcUrl:c[e].rpcUrl,chainId:e,nickname:c[e].nickname,ticker:c[e].ticker}}return{...e,PreferencesController:{...r},NetworkController:{...o}}}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/074.js"}],[165,{lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("lodash");n.default={version:75,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=75;const n=function(e){return delete e.ThreeBoxController,e}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/075.js"}],[166,{lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("lodash");n.default={version:76,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=76;const n=function(e){var t;if(e.CollectiblesController){const{allCollectibleContracts:t,allCollectibles:n,ignoredCollectibles:r,...i}=e.CollectiblesController;e.NftController={...t?{allNftContracts:t}:{},...n?{allNfts:n}:{},...r?{ignoredNfts:r}:{},...i},delete e.CollectiblesController}null!==(t=e.PreferencesController)&&void 0!==t&&t.useCollectibleDetection&&(e.PreferencesController.useNftDetection=e.PreferencesController.useCollectibleDetection,delete e.PreferencesController.useCollectibleDetection);return e}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/076.js"}],[167,{"@metamask/utils":1806},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){(0,r.hasProperty)(e,"PreferencesController")&&(0,r.isObject)(e.PreferencesController)&&(0,r.hasProperty)(e.PreferencesController,"frequentRpcListDetail")&&(0,r.isObject)(e.NetworkController)&&(0,r.hasProperty)(e.NetworkController,"networkConfigurations")&&delete e.PreferencesController.frequentRpcListDetail;return{...e}};var r=e("@metamask/utils")}}},{package:"$root$",file:"app/scripts/migrations/077-supplements/077-supplement-for-082.ts"}],[168,{"@metamask/utils":1806},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){(0,r.hasProperty)(e,"NetworkController")&&(0,r.isObject)(e.NetworkController)&&(0,r.hasProperty)(e.NetworkController,"network")&&(0,r.hasProperty)(e.NetworkController,"networkId")&&delete e.NetworkController.network;return{...e}};var r=e("@metamask/utils")}}},{package:"$root$",file:"app/scripts/migrations/077-supplements/077-supplement-for-084.ts"}],[169,{"@metamask/utils":1806},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){(0,r.hasProperty)(e,"NetworkController")&&(0,r.isObject)(e.NetworkController)&&(0,r.hasProperty)(e.NetworkController,"provider")&&(0,r.hasProperty)(e.NetworkController,"providerConfig")&&delete e.NetworkController.provider;return{...e}};var r=e("@metamask/utils")}}},{package:"$root$",file:"app/scripts/migrations/077-supplements/077-supplement-for-086.ts"}],[17,{"../../../../shared/constants/permissions":4008,"@metamask/permission-controller":1463,"ethereumjs-util":2748},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CaveatMutatorFactories=void 0;var r=e("@metamask/permission-controller"),i=e("ethereumjs-util"),s=e("../../../../shared/constants/permissions");n.CaveatMutatorFactories={[s.CaveatTypes.restrictReturnedAccounts]:{removeAccount:function(e,t){const n=(0,i.toChecksumAddress)(e),s=t.filter((e=>(0,i.toChecksumAddress)(e)!==n));if(s.length===t.length)return{operation:r.CaveatMutatorOperation.noop};if(s.length>0)return{operation:r.CaveatMutatorOperation.updateValue,value:s};return{operation:r.CaveatMutatorOperation.revokePermission}}}}}}},{package:"$root$",file:"app/scripts/controllers/permissions/caveat-mutators.js"}],[170,{"@metamask/utils":1806},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){if((0,r.hasProperty)(e,"NftController")&&(0,r.isObject)(e.NftController)){const t=e.NftController;if((0,r.hasProperty)(t,"allNftContracts")&&(0,r.isObject)(t.allNftContracts)){const{allNftContracts:e}=t;Object.keys(e).every((t=>(0,r.isObject)(e[t])))&&Object.keys(e).forEach((t=>{const n=e[t];if((0,r.isObject)(n)&&i(n))for(const e of Object.keys(n))(0,r.isStrictHexString)(e)||delete n[e]}))}if((0,r.hasProperty)(t,"allNfts")&&(0,r.isObject)(t.allNfts)){const{allNfts:e}=t;Object.keys(e).every((t=>(0,r.isObject)(e[t])))&&Object.keys(e).forEach((t=>{const n=e[t];if((0,r.isObject)(n)&&i(n))for(const e of Object.keys(n))(0,r.isStrictHexString)(e)||delete n[e]}))}e.NftController=t}if((0,r.hasProperty)(e,"TokenListController")&&(0,r.isObject)(e.TokenListController)){const t=e.TokenListController;if((0,r.hasProperty)(t,"tokensChainsCache")&&(0,r.isObject)(t.tokensChainsCache)&&i(t.tokensChainsCache))for(const e of Object.keys(t.tokensChainsCache))(0,r.isStrictHexString)(e)||delete t.tokensChainsCache[e]}if((0,r.hasProperty)(e,"TokensController")&&(0,r.isObject)(e.TokensController)){const t=e.TokensController;if((0,r.hasProperty)(t,"allTokens")&&(0,r.isObject)(t.allTokens)&&i(t.allTokens)){const{allTokens:e}=t;for(const n of Object.keys(e))(0,r.isStrictHexString)(n)||delete t.allTokens[n]}if((0,r.hasProperty)(t,"allIgnoredTokens")&&(0,r.isObject)(t.allIgnoredTokens)&&i(t.allIgnoredTokens)){const{allIgnoredTokens:e}=t;for(const n of Object.keys(e))(0,r.isStrictHexString)(n)||delete t.allIgnoredTokens[n]}if((0,r.hasProperty)(t,"allDetectedTokens")&&(0,r.isObject)(t.allDetectedTokens)&&i(t.allDetectedTokens)){const{allDetectedTokens:e}=t;for(const n of Object.keys(e))(0,r.isStrictHexString)(n)||delete t.allDetectedTokens[n]}e.TokensController=t}return e};var r=e("@metamask/utils");function i(e){return Object.keys(e).some((e=>(0,r.isStrictHexString)(e)))}}}},{package:"$root$",file:"app/scripts/migrations/077-supplements/077-supplement-for-088.ts"}],[171,{"./077-supplements/077-supplement-for-082":167,"./077-supplements/077-supplement-for-084":168,"./077-supplements/077-supplement-for-086":169,"./077-supplements/077-supplement-for-088":170,"@metamask/utils":1806,lodash:3355,loglevel:3365},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("lodash"),i=u(e("loglevel")),s=e("@metamask/utils"),o=u(e("./077-supplements/077-supplement-for-082")),a=u(e("./077-supplements/077-supplement-for-084")),l=u(e("./077-supplements/077-supplement-for-086")),c=u(e("./077-supplements/077-supplement-for-088"));function u(e){return e&&e.__esModule?e:{default:e}}n.default={version:77,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=77;let n=function(e){if(!(0,s.hasProperty)(e,"TokenListController"))return i.default.warn("Skipping migration, TokenListController state is missing"),e;var t,n;if(!(0,s.isObject)(e.TokenListController))return null===(t=global.sentry)||void 0===t||null===(n=t.captureException)||void 0===n||n.call(t,new Error("typeof state.TokenListController is "+typeof e.TokenListController)),e;if(!(0,s.hasProperty)(e.TokenListController,"tokensChainsCache"))return i.default.warn("Skipping migration, TokenListController.tokensChainsCache state is missing"),e;const{TokenListController:r}=e,{tokensChainsCache:o}=r;let a,l;for(const e in o){var c,u;if(a=o[e].data||{},l={},Array.isArray(a))for(const e of a)l[e.address]=e;else if((null===(c=Object.keys(a)[0])||void 0===c?void 0:c.toLowerCase())!==(null===(u=a[Object.keys(a)[0]])||void 0===u||null===(u=u.address)||void 0===u?void 0:u.toLowerCase()))for(const e in a)l[a[e].address]=a[e];o[e].data=Object.keys(l).length>0?l:a}return r.tokensChainsCache=o,{...e,TokenListController:{...r}}}(t.data);return n=(0,o.default)(n),n=(0,a.default)(n),n=(0,l.default)(n),n=(0,c.default)(n),t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/077.js"}],[172,{"@metamask/utils":1806,lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=s,t.data=function(e){if(!(0,i.hasProperty)(e,"PhishingController")||!(0,i.isObject)(e.PhishingController))return e;const{PhishingController:t}=e;return delete t.phishing,delete t.lastFetched,e}(t.data),t},n.version=void 0;var r=e("lodash"),i=e("@metamask/utils");const s=n.version=78}}},{package:"$root$",file:"app/scripts/migrations/078.ts"}],[173,{lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("lodash");n.default={version:79,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=79;const n=function(e){var t,n;(null==e||null===(t=e.AppStateController)||void 0===t?void 0:t.collectiblesDetectionNoticeDismissed)!==undefined&&delete e.AppStateController.collectiblesDetectionNoticeDismissed;(null==e||null===(n=e.metamask)||void 0===n?void 0:n.collectiblesDropdownState)!==undefined&&delete e.metamask.collectiblesDropdownState;return e}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/079.js"}],[174,{lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("lodash");n.default={version:80,async migrate(e){const t=(0,r.cloneDeep)(e);t.meta.version=80;const n=function(e){var t;(null==e||null===(t=e.metamask)||void 0===t?void 0:t.showPortfolioTooltip)!==undefined&&delete e.metamask.showPortfolioTooltip;return e}(t.data);return t.data=n,t}}}}},{package:"$root$",file:"app/scripts/migrations/080.js"}],[175,{"@metamask/utils":1806,lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,r.cloneDeep)(e);t.meta.version=s;const n=function(e){if(!(0,i.hasProperty)(e,"SnapController")||!(0,i.hasProperty)(e,"PermissionController")||!(0,i.isObject)(e.PermissionController))return e;const{PermissionController:t}=e,{subjects:n}=t;if(!(0,i.isObject)(n))return e;const s="wallet_snap_";for(const[t,o]of Object.entries(n)){if(!(0,i.isObject)(o)||!(0,i.isObject)(o.permissions))return e;let n,a=1;const{permissions:l}=o,c={...l};for(const[o,u]of Object.entries(l))if(o.startsWith(s)){if(!(0,i.isObject)(u)||!(0,i.hasProperty)(u,"id")||!(0,i.hasProperty)(u,"date"))return e;if((0,i.hasProperty)(c,"wallet_snap")||(c.wallet_snap={caveats:[{type:"snapIds",value:{}}],invoker:t,parentCapability:"wallet_snap"}),!(0,i.isObject)(c.wallet_snap))return e;if(!(0,r.isArray)(c.wallet_snap.caveats))return e;const l=o.slice(s.length),d=c.wallet_snap.caveats[0];if(!(0,i.isObject)(d))return e;if(!(0,i.hasProperty)(d,"type")||"snapIds"!==d.type||!(0,i.hasProperty)(d,"value")||!(0,i.isObject)(d.value))return e;if(d.value[l]={},"number"!=typeof u.date||"string"!=typeof u.id)return e;u.date>a&&(a=u.date,n=u.id),delete c[o]}c.wallet_snap&&(c.wallet_snap.date=a,c.wallet_snap.id=n,o.permissions=c)}return e}(t.data);return t.data=n,t},n.version=void 0;var r=e("lodash"),i=e("@metamask/utils");const s=n.version=81}}},{package:"$root$",file:"app/scripts/migrations/081.ts"}],[176,{"@metamask/utils":1806,lodash:3355,loglevel:3365,uuid:3942},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,i.cloneDeep)(e);return t.meta.version=l,t.data=function(e){if(!(0,s.hasProperty)(e,"PreferencesController"))return a.default.warn("state.PreferencesController is undefined"),e;if(!(0,s.isObject)(e.PreferencesController)){var t,n;return null===(t=global.sentry)||void 0===t||null===(n=t.captureException)||void 0===n||n.call(t,new Error("typeof state.PreferencesController is "+typeof e.PreferencesController)),e}if(!(0,s.hasProperty)(e,"NetworkController")||!(0,s.isObject)(e.NetworkController)){var r,i;return null===(r=global.sentry)||void 0===r||null===(i=r.captureException)||void 0===i||i.call(r,new Error("typeof state.NetworkController is "+typeof e.NetworkController)),e}if(!(0,s.hasProperty)(e.PreferencesController,"frequentRpcListDetail")||!Array.isArray(e.PreferencesController.frequentRpcListDetail)){var l,c;if(!(e.NetworkController.networkConfigurations&&e.PreferencesController.frequentRpcListDetail===undefined))null===(l=global.sentry)||void 0===l||null===(c=l.captureException)||void 0===c||c.call(l,new Error("typeof state.PreferencesController.frequentRpcListDetail is "+typeof e.PreferencesController.frequentRpcListDetail));return e}if(!e.PreferencesController.frequentRpcListDetail.every(s.isObject)){var u,d;const t=e.PreferencesController.frequentRpcListDetail.find((e=>!(0,s.isObject)(e)));return null===(u=global.sentry)||void 0===u||null===(d=u.captureException)||void 0===d||d.call(u,new Error("state.PreferencesController.frequentRpcListDetail contains an element of type "+typeof t)),e}const{PreferencesController:h,NetworkController:f}=e,{frequentRpcListDetail:p}=h;if(!Array.isArray(p))return e;const m=p.reduce(((e,{rpcUrl:t,chainId:n,ticker:r,nickname:i,rpcPrefs:s})=>({...e,[(0,o.v4)()]:{rpcUrl:t,chainId:n,ticker:r,rpcPrefs:s,nickname:i}})),{});return delete h.frequentRpcListDetail,{...e,NetworkController:{...f,networkConfigurations:m},PreferencesController:{...h}}}(t.data),t},n.version=void 0;var r,i=e("lodash"),s=e("@metamask/utils"),o=e("uuid"),a=(r=e("loglevel"))&&r.__esModule?r:{default:r};const l=n.version=82}}},{package:"$root$",file:"app/scripts/migrations/082.ts"}],[1769,{"./constants":1770,"./helpers/Bundler":1771,"./helpers/PendingUserOperationTracker":1772,"./helpers/SnapSmartContractAccount":1773,"./logger":1775,"./types":1776,"./utils/gas":1778,"./utils/gas-fees":1777,"./utils/transaction":1779,"./utils/validation":1780,"@metamask/base-controller":1064,"@metamask/controller-utils":1069,"@metamask/eth-query":1131,"@metamask/rpc-errors":1525,"@metamask/transaction-controller":1755,"ethereumjs-util":2748,events:2788,lodash:3355,uuid:3942},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,i,s,o,a,l,c,u,d,h,f,p,m,g,v,b,w,y,_,S,k,E,T,P,C=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{l(r.next(e))}catch(e){s(e)}}function a(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))},O=this&&this.__classPrivateFieldSet||function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},j=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},M=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.UserOperationController=void 0;const R=e("@metamask/base-controller"),A=e("@metamask/controller-utils"),N=M(e("@metamask/eth-query")),I=e("@metamask/rpc-errors"),x=e("@metamask/transaction-controller"),L=e("ethereumjs-util"),B=M(e("events")),D=e("lodash"),U=e("uuid"),F=e("./constants"),W=e("./helpers/Bundler"),H=e("./helpers/PendingUserOperationTracker"),G=e("./helpers/SnapSmartContractAccount"),q=e("./logger"),$=e("./types"),V=e("./utils/gas"),z=e("./utils/gas-fees"),K=e("./utils/transaction"),Q=e("./utils/validation"),Y={userOperations:{persist:!0,anonymous:!1}};class J extends R.BaseController{constructor({entrypoint:e,getGasFeeEstimates:t,messenger:n,state:a}){super({name:"UserOperationController",metadata:Y,messenger:n,state:Object.assign(Object.assign({},{userOperations:{}}),a)}),r.add(this),i.set(this,void 0),s.set(this,void 0),o.set(this,void 0),this.hub=new B.default,O(this,i,e,"f"),O(this,s,t,"f"),O(this,o,new H.PendingUserOperationTracker({getUserOperations:()=>(0,D.cloneDeep)(Object.values(this.state.userOperations)),messenger:n}),"f"),j(this,r,"m",_).call(this)}addUserOperation(e,t){return C(this,void 0,void 0,(function*(){return(0,Q.validateAddUserOperationRequest)(e),(0,Q.validateAddUserOperationOptions)(t),yield j(this,r,"m",a).call(this,e,t)}))}addUserOperationFromTransaction(e,t){return C(this,void 0,void 0,(function*(){(0,Q.validateAddUserOperationOptions)(t);const{data:n,from:i,maxFeePerGas:s,maxPriorityFeePerGas:o,to:l,value:c}=e,u={data:""===n?undefined:n,from:i,maxFeePerGas:s,maxPriorityFeePerGas:o,to:l,value:c};return(0,Q.validateAddUserOperationRequest)(u),yield j(this,r,"m",a).call(this,u,Object.assign(Object.assign({},t),{transaction:e}))}))}startPollingByNetworkClientId(e){return j(this,o,"f").startPollingByNetworkClientId(e)}}n.UserOperationController=J,i=new WeakMap,s=new WeakMap,o=new WeakMap,r=new WeakSet,a=function(e,t){return C(this,void 0,void 0,(function*(){(0,q.projectLogger)("Adding user operation",{request:e,options:t});const{networkClientId:n,origin:i,smartContractAccount:s,swaps:o,transaction:a}=t,{chainId:d,provider:h}=yield j(this,r,"m",E).call(this,n),f=yield j(this,r,"m",u).call(this,d,i,a,o),p=null!=s?s:new G.SnapSmartContractAccount(this.messagingSystem),m={chainId:d,metadata:f,options:Object.assign(Object.assign({},t),{smartContractAccount:p}),provider:h,request:e,transaction:a},{id:v}=f;let b=!1;const w=(()=>C(this,void 0,void 0,(function*(){try{return yield j(this,r,"m",l).call(this,m)}catch(e){if(j(this,r,"m",g).call(this,f,e),b)throw e;return undefined}})))(),y=()=>C(this,void 0,void 0,(function*(){return b=!0,yield w}));return{id:v,hash:y,transactionHash:()=>C(this,void 0,void 0,(function*(){yield y();const{transactionHash:e}=yield j(this,r,"m",c).call(this,f);return e}))}}))},l=function(e){return C(this,void 0,void 0,(function*(){const{metadata:t,options:n}=e,{requireApproval:i,smartContractAccount:s}=n;let o;try{return yield j(this,r,"m",d).call(this,e),yield j(this,r,"m",h).call(this,t,s),this.hub.emit("user-operation-added",t),!1!==i&&(o=yield j(this,r,"m",f).call(this,e)),yield j(this,r,"m",p).call(this,t,s),yield j(this,r,"m",m).call(this,t),null==o||o.success(),t.hash}catch(e){throw null==o||o.error(e),e}}))},c=function(e){return C(this,void 0,void 0,(function*(){const{id:t,hash:n}=e;return(0,q.projectLogger)("Waiting for confirmation",t,n),new Promise(((e,n)=>{this.hub.once(`${t}:confirmed`,(t=>{e(t)})),this.hub.once(`${t}:failed`,((e,t)=>{n(t)}))}))}))},u=function(e,t,n,i){var s,o,a,l,c,u,d,h,f;return C(this,void 0,void 0,(function*(){const p={actualGasCost:null,actualGasUsed:null,baseFeePerGas:null,bundlerUrl:null,chainId:e,error:null,hash:null,id:(0,U.v1)(),origin:t,status:$.UserOperationStatus.Unapproved,swapsMetadata:i?{approvalTxId:null!==(s=i.approvalTxId)&&void 0!==s?s:null,destinationTokenAddress:null!==(o=i.destinationTokenAddress)&&void 0!==o?o:null,destinationTokenDecimals:null!==(a=i.destinationTokenDecimals)&&void 0!==a?a:null,destinationTokenSymbol:null!==(l=i.destinationTokenSymbol)&&void 0!==l?l:null,estimatedBaseFee:null!==(c=i.estimatedBaseFee)&&void 0!==c?c:null,sourceTokenSymbol:null!==(u=i.sourceTokenSymbol)&&void 0!==u?u:null,swapMetaData:null!==(d=i.swapMetaData)&&void 0!==d?d:null,swapTokenValue:null!==(h=i.swapTokenValue)&&void 0!==h?h:null}:null,time:Date.now(),transactionHash:null,transactionParams:null!==(f=n)&&void 0!==f?f:null,transactionType:null,userFeeLevel:null,userOperation:j(this,r,"m",v).call(this,n)};return j(this,r,"m",b).call(this,p),(0,q.projectLogger)("Added user operation",p.id),p}))},d=function(e){return C(this,void 0,void 0,(function*(){const{chainId:t,metadata:n,options:o,provider:a,request:l,transaction:c}=e,{data:u,from:d,to:h,value:f}=l,{id:p,transactionParams:m,userOperation:g}=n,{smartContractAccount:v}=o;(0,q.projectLogger)("Preparing user operation",{id:p});const w=yield j(this,r,"m",k).call(this,c,a,o);n.transactionType=null!=w?w:null,(0,q.projectLogger)("Determined transaction type",w),yield(0,z.updateGasFees)({getGasFeeEstimates:j(this,s,"f"),metadata:n,originalRequest:l,provider:a,transaction:null!=m?m:undefined});const y=yield v.prepareUserOperation({chainId:t,data:u,from:d,to:h,value:f});(0,Q.validatePrepareUserOperationResponse)(y);const{bundler:_,callData:S,dummyPaymasterAndData:E,dummySignature:T,initCode:P,nonce:C,sender:O}=y;g.callData=S,g.initCode=null!=P?P:F.EMPTY_BYTES,g.nonce=C,g.paymasterAndData=null!=E?E:F.EMPTY_BYTES,g.sender=O,g.signature=null!=T?T:F.EMPTY_BYTES,n.bundlerUrl=_,yield(0,V.updateGas)(n,y,j(this,i,"f")),j(this,r,"m",b).call(this,n)}))},h=function(e,t){var n;return C(this,void 0,void 0,(function*(){const{id:i,userOperation:s}=e;(0,q.projectLogger)("Requesting paymaster data",{id:i});const o=yield t.updateUserOperation({userOperation:s});(0,Q.validateUpdateUserOperationResponse)(o),s.paymasterAndData=null!==(n=o.paymasterAndData)&&void 0!==n?n:F.EMPTY_BYTES,j(this,r,"m",b).call(this,e)}))},f=function(e){return C(this,void 0,void 0,(function*(){(0,q.projectLogger)("Requesting approval");const{metadata:t}=e,{resultCallbacks:n,value:i}=yield j(this,r,"m",S).call(this,t),s=null==i?void 0:i.txMeta;return s&&(yield j(this,r,"m",T).call(this,e,s)),t.status=$.UserOperationStatus.Approved,j(this,r,"m",b).call(this,t),n}))},p=function(e,t){return C(this,void 0,void 0,(function*(){const{id:n,chainId:i,userOperation:s}=e;(0,q.projectLogger)("Signing user operation",n,s);const o=yield t.signUserOperation({userOperation:s,chainId:i});(0,Q.validateSignUserOperationResponse)(o);const{signature:a}=o;s.signature=a,(0,q.projectLogger)("Signed user operation",a),e.status=$.UserOperationStatus.Signed,j(this,r,"m",b).call(this,e)}))},m=function(e){return C(this,void 0,void 0,(function*(){const{userOperation:t}=e;(0,q.projectLogger)("Submitting user operation",t);const n=new W.Bundler(e.bundlerUrl),s=yield n.sendUserOperation(t,j(this,i,"f"));e.hash=s,e.status=$.UserOperationStatus.Submitted,j(this,r,"m",b).call(this,e)}))},g=function(e,t){const{id:n}=e,i=t;(0,q.projectLogger)("User operation failed",n,t),e.error={name:i.name,message:i.message,stack:i.stack,code:i.code,rpc:i.value},e.status=$.UserOperationStatus.Failed,j(this,r,"m",b).call(this,e),String(i.code)===String(I.errorCodes.provider.userRejectedRequest)&&j(this,r,"m",w).call(this,n)},v=function(e){var t,n;return{callData:F.EMPTY_BYTES,callGasLimit:F.EMPTY_BYTES,initCode:F.EMPTY_BYTES,maxFeePerGas:null!==(t=null==e?void 0:e.maxFeePerGas)&&void 0!==t?t:F.EMPTY_BYTES,maxPriorityFeePerGas:null!==(n=null==e?void 0:e.maxPriorityFeePerGas)&&void 0!==n?n:F.EMPTY_BYTES,nonce:F.EMPTY_BYTES,paymasterAndData:F.EMPTY_BYTES,preVerificationGas:F.EMPTY_BYTES,sender:F.ADDRESS_ZERO,signature:F.EMPTY_BYTES,verificationGasLimit:F.EMPTY_BYTES}},b=function(e){const{id:t}=e;this.update((n=>{n.userOperations[t]=(0,D.cloneDeep)(e)})),j(this,r,"m",y).call(this,e)},w=function(e){this.update((t=>{delete t.userOperations[e]}))},y=function(e){if(!e.transactionParams)return;const t=(0,K.getTransactionMetadata)(e);this.hub.emit("transaction-updated",t)},_=function(){j(this,o,"f").hub.on("user-operation-confirmed",(e=>{(0,q.projectLogger)("In listener..."),this.hub.emit("user-operation-confirmed",e),this.hub.emit(`${e.id}:confirmed`,e)})),j(this,o,"f").hub.on("user-operation-failed",((e,t)=>{this.hub.emit("user-operation-failed",e,t),this.hub.emit(`${e.id}:failed`,e,t)})),j(this,o,"f").hub.on("user-operation-updated",(e=>{j(this,r,"m",b).call(this,e)}))},S=function(e){return C(this,void 0,void 0,(function*(){const{id:t,origin:n}=e,r=A.ApprovalType.Transaction,i={txId:t};return yield this.messagingSystem.call("ApprovalController:addRequest",{id:t,origin:n,type:r,requestData:i,expectsResult:!0},!0)}))},k=function(e,t,n){return C(this,void 0,void 0,(function*(){if(!e)return undefined;if(n.type)return n.type;const r=new N.default(t),i=(0,x.determineTransactionType)(e,r);return(yield i).type}))},E=function(e){return C(this,void 0,void 0,(function*(){const{provider:t,configuration:n}=this.messagingSystem.call("NetworkController:getNetworkClientById",e),{chainId:r}=n;return{provider:t,chainId:r}}))},T=function(e,t){var n,i,s,o;return C(this,void 0,void 0,(function*(){(0,q.projectLogger)("Found updated transaction in approval",{updatedTransaction:t});const{metadata:a,request:l}=e,{userOperation:c}=a,u=c.paymasterAndData!==F.EMPTY_BYTES,d=(0,L.addHexPrefix)(t.txParams.maxFeePerGas),h=(0,L.addHexPrefix)(t.txParams.maxPriorityFeePerGas);let f=!1;const p=c.maxFeePerGas,m=c.maxPriorityFeePerGas;p===d&&m===h||((0,q.projectLogger)("Gas fees updated during approval",{previousMaxFeePerGas:p,previousMaxPriorityFeePerGas:m,updatedMaxFeePerGas:d,updatedMaxPriorityFeePerGas:h}),c.maxFeePerGas=d,c.maxPriorityFeePerGas=h,f=u);const g=null!==(n=l.data)&&void 0!==n?n:F.EMPTY_BYTES,v=null!==(i=t.txParams.data)&&void 0!==i?i:F.EMPTY_BYTES;g!==v&&((0,q.projectLogger)("Data updated during approval",{previousData:g,updatedData:v}),f=!0);const b=null!==(s=l.value)&&void 0!==s?s:F.VALUE_ZERO,w=null!==(o=t.txParams.value)&&void 0!==o?o:F.VALUE_ZERO;if(b!==w&&((0,q.projectLogger)("Value updated during approval",{previousValue:b,updatedValue:w}),f=!0),f){const t=Object.assign(Object.assign({},l),{data:v,maxFeePerGas:d,maxPriorityFeePerGas:h,value:w});yield j(this,r,"m",P).call(this,Object.assign(Object.assign({},e),{request:t}))}}))},P=function(e){return C(this,void 0,void 0,(function*(){(0,q.projectLogger)("Regenerating user operation as parameters were updated during approval");const{options:{smartContractAccount:t},metadata:n}=e;yield j(this,r,"m",d).call(this,e),yield j(this,r,"m",h).call(this,n,t),(0,q.projectLogger)("Regenerated user operation",n.userOperation)}))}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/UserOperationController.js"}],[177,{"@metamask/utils":1806,lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=s,t.data=function(e){if(!(0,i.isObject)(e.NetworkController)){var t,n;return null===(t=global.sentry)||void 0===t||null===(n=t.captureException)||void 0===n||n.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController)),e}const{NetworkController:r}=e;if(!(0,i.isObject)(r.networkConfigurations)){var s,o;return null===(s=global.sentry)||void 0===s||null===(o=s.captureException)||void 0===o||o.call(s,new Error("typeof NetworkController.networkConfigurations is "+typeof r.networkConfigurations)),e}const{networkConfigurations:a}=r,l={};for(const t of Object.keys(a)){const n=a[t];if(!(0,i.isObject)(n))return e;l[t]={...n,id:t}}return{...e,NetworkController:{...r,networkConfigurations:l}}}(t.data),t},n.version=void 0;var r=e("lodash"),i=e("@metamask/utils");const s=n.version=83}}},{package:"$root$",file:"app/scripts/migrations/083.ts"}],[1770,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.VALUE_ZERO=n.ADDRESS_ZERO=n.EMPTY_BYTES=void 0,n.EMPTY_BYTES="0x",n.ADDRESS_ZERO="0x0000000000000000000000000000000000000000",n.VALUE_ZERO="0x0"}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/constants.js"}],[1771,{"../logger":1775},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,i,s,o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{l(r.next(e))}catch(e){s(e)}}function a(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))},a=this&&this.__classPrivateFieldSet||function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},l=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.Bundler=void 0;const c=e("../logger"),u=(0,c.createModuleLogger)(c.projectLogger,"bundler");n.Bundler=class{constructor(e){r.add(this),i.set(this,void 0),a(this,i,e,"f")}estimateUserOperationGas(e,t){return o(this,void 0,void 0,(function*(){u("Estimating gas",{url:l(this,i,"f"),userOperation:e,entrypoint:t});const n=yield l(this,r,"m",s).call(this,"eth_estimateUserOperationGas",[e,t]);return u("Estimated gas",{response:n}),n}))}getUserOperationReceipt(e){return o(this,void 0,void 0,(function*(){return u("Getting user operation receipt",{url:l(this,i,"f"),hash:e}),yield l(this,r,"m",s).call(this,"eth_getUserOperationReceipt",[e])}))}sendUserOperation(e,t){return o(this,void 0,void 0,(function*(){u("Sending user operation",{url:l(this,i,"f"),userOperation:e,entrypoint:t});const n=yield l(this,r,"m",s).call(this,"eth_sendUserOperation",[e,t]);return u("Sent user operation",n),n}))}},i=new WeakMap,r=new WeakSet,s=function(e,t){return o(this,void 0,void 0,(function*(){const n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",id:1,method:e,params:t})},r=yield fetch(l(this,i,"f"),n),s=yield r.json();if(s.error){const e=new Error(s.error.message||s.error);throw e.code=s.error.code,e}return s.result}))}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/helpers/Bundler.js"}],[1772,{"../logger":1775,"../types":1776,"./Bundler":1771,"@metamask/controller-utils":1069,"@metamask/eth-query":1131,"@metamask/polling-controller":1784,"@metamask/utils":1806,events:2788},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,i,s,o,a,l,c,u,d,h,f=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{l(r.next(e))}catch(e){s(e)}}function a(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))},p=this&&this.__classPrivateFieldSet||function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},m=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},g=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.PendingUserOperationTracker=void 0;const v=e("@metamask/controller-utils"),b=g(e("@metamask/eth-query")),w=e("@metamask/polling-controller"),y=e("@metamask/utils"),_=g(e("events")),S=e("../logger"),k=e("../types"),E=e("./Bundler"),T=(0,y.createModuleLogger)(S.projectLogger,"pending-user-operations");class P extends w.BlockTrackerPollingControllerOnly{constructor({getUserOperations:e,messenger:t}){super(),r.add(this),i.set(this,void 0),s.set(this,void 0),this.hub=new _.default,p(this,i,e,"f"),p(this,s,t,"f")}_executePoll(e,t){return f(this,void 0,void 0,(function*(){try{const{blockTracker:t,configuration:n,provider:i}=this._getNetworkClientById(e);T("Polling",{blockNumber:t.getCurrentBlock(),chainId:n.chainId}),yield m(this,r,"m",o).call(this,n.chainId,i)}catch(e){T("Failed to check user operations",e)}}))}_getNetworkClientById(e){return m(this,s,"f").call("NetworkController:getNetworkClientById",e)}}n.PendingUserOperationTracker=P,i=new WeakMap,s=new WeakMap,r=new WeakSet,o=function(e,t){return f(this,void 0,void 0,(function*(){const n=m(this,r,"m",u).call(this).filter((t=>t.chainId===e));n.length?(T("Found pending user operations to check",{count:n.length,ids:n.map((e=>e.id))}),yield Promise.all(n.map((e=>m(this,r,"m",a).call(this,e,t))))):T("No pending user operations to check")}))},a=function(e,t){return f(this,void 0,void 0,(function*(){const{bundlerUrl:n,hash:i,id:s}=e;if(i&&n)try{const o=yield m(this,r,"m",h).call(this,i,n),a=null==o?void 0:o.success;if(o&&!a)return void m(this,r,"m",c).call(this,e,o);if(a)return void(yield m(this,r,"m",l).call(this,e,o,t));T("No receipt found for user operation",{id:s,hash:i})}catch(e){T("Failed to check user operation",s,e)}else T("Skipping user operation as missing hash or bundler",s)}))},l=function(e,t,n){return f(this,void 0,void 0,(function*(){const{id:i}=e,{actualGasCost:s,actualGasUsed:o,receipt:{blockHash:a,transactionHash:l}}=t;T("User operation confirmed",i,l);const{baseFeePerGas:c}=yield(0,v.query)(new b.default(n),"getBlockByHash",[a,!1]);e.actualGasCost=s,e.actualGasUsed=o,e.baseFeePerGas=c,e.status=k.UserOperationStatus.Confirmed,e.transactionHash=l,m(this,r,"m",d).call(this,e),this.hub.emit("user-operation-confirmed",e)}))},c=function(e,t){const{id:n}=e;T("User operation failed",n),e.status=k.UserOperationStatus.Failed,m(this,r,"m",d).call(this,e),this.hub.emit("user-operation-failed",e,new Error("User operation receipt has failed status"))},u=function(){return m(this,i,"f").call(this).filter((e=>e.status===k.UserOperationStatus.Submitted))},d=function(e){this.hub.emit("user-operation-updated",e)},h=function(e,t){return f(this,void 0,void 0,(function*(){return new E.Bundler(t).getUserOperationReceipt(e)}))}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/helpers/PendingUserOperationTracker.js"}],[1773,{"../constants":1770},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r,i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{l(r.next(e))}catch(e){s(e)}}function a(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))},s=this&&this.__classPrivateFieldSet||function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},o=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.SnapSmartContractAccount=void 0;const a=e("../constants");n.SnapSmartContractAccount=class{constructor(e){r.set(this,void 0),s(this,r,e,"f")}prepareUserOperation(e){return i(this,void 0,void 0,(function*(){const{data:t,from:n,to:i,value:s}=e,l=null!=t?t:a.EMPTY_BYTES,c=null!=i?i:a.ADDRESS_ZERO,u=null!=s?s:a.VALUE_ZERO,d=yield o(this,r,"f").call("KeyringController:prepareUserOperation",n,[{data:l,to:c,value:u}]),{bundlerUrl:h,callData:f,dummyPaymasterAndData:p,dummySignature:m,gasLimits:g,initCode:v,nonce:b}=d;return{bundler:h,callData:f,dummyPaymasterAndData:p,dummySignature:m,gas:g,initCode:v,nonce:b,sender:n}}))}updateUserOperation(e){return i(this,void 0,void 0,(function*(){const{userOperation:t}=e,{sender:n}=t,{paymasterAndData:i}=yield o(this,r,"f").call("KeyringController:patchUserOperation",n,t);return{paymasterAndData:i===a.EMPTY_BYTES?undefined:i}}))}signUserOperation(e){return i(this,void 0,void 0,(function*(){const{userOperation:t}=e,{sender:n}=t;return{signature:yield o(this,r,"f").call("KeyringController:signUserOperation",n,t)}}))}},r=new WeakMap}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/helpers/SnapSmartContractAccount.js"}],[1774,{"./UserOperationController":1769,"./types":1776},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){r===undefined&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===undefined&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(n,"__esModule",{value:!0}),i(e("./UserOperationController"),n),i(e("./types"),n)}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/index.js"}],[1775,{"@metamask/utils":1806},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createModuleLogger=n.projectLogger=void 0;const r=e("@metamask/utils");Object.defineProperty(n,"createModuleLogger",{enumerable:!0,get:function(){return r.createModuleLogger}}),n.projectLogger=(0,r.createProjectLogger)("user-operation-controller")}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/logger.js"}],[1776,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.UserOperationStatus=void 0,function(e){e.Unapproved="unapproved",e.Approved="approved",e.Signed="signed",e.Submitted="submitted",e.Failed="failed",e.Confirmed="confirmed"}(n.UserOperationStatus||(n.UserOperationStatus={}))}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/types.js"}],[1777,{"../constants":1770,"../logger":1775,"@metamask/controller-utils":1069,"@metamask/eth-query":1131,"@metamask/gas-fee-controller":1221,"@metamask/transaction-controller":1755,"ethereumjs-util":2748},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{l(r.next(e))}catch(e){s(e)}}function a(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.updateGasFees=void 0;const s=e("@metamask/controller-utils"),o=i(e("@metamask/eth-query")),a=e("@metamask/gas-fee-controller"),l=e("@metamask/transaction-controller"),c=e("ethereumjs-util"),u=e("../constants"),d=e("../logger"),h=(0,d.createModuleLogger)(d.projectLogger,"gas-fees");function f(e){return(0,s.toHex)((0,s.gweiDecToWEIBN)(e))}function p(e){return!e||e===u.EMPTY_BYTES}n.updateGasFees=function(e){return r(this,void 0,void 0,(function*(){const{metadata:t,originalRequest:n,transaction:i}=e,{userOperation:u}=t;let d;const m=()=>r(this,void 0,void 0,(function*(){return d||(d=yield function(e){return r(this,void 0,void 0,(function*(){const{getGasFeeEstimates:t,provider:n}=e;try{const{gasFeeEstimates:e,gasEstimateType:n}=yield t();if(n===a.GAS_ESTIMATE_TYPES.FEE_MARKET){const{medium:{suggestedMaxPriorityFeePerGas:t,suggestedMaxFeePerGas:n}={}}=e;if(t&&n){const e={maxFeePerGas:f(n),maxPriorityFeePerGas:f(t)};return h("Using medium values from fee market estimate",e),e}}if(n===a.GAS_ESTIMATE_TYPES.LEGACY){const t=f(e.medium);return h("Using medium value from legacy estimate",t),{maxFeePerGas:t}}if(n===a.GAS_ESTIMATE_TYPES.ETH_GASPRICE){const t=f(e.gasPrice);return h("Using gasPrice from estimate",t),{maxFeePerGas:t}}}catch(e){h("Failed to get estimate",e)}const r=yield(0,s.query)(new o.default(n),"gasPrice");if(!r)return{};const i=(0,c.addHexPrefix)(r.toString(16));return h("Using gasPrice from network as fallback",i),{maxFeePerGas:i}}))}(e)),d}));u.maxFeePerGas=yield function(e,t,n){return r(this,void 0,void 0,(function*(){const{maxFeePerGas:r,maxPriorityFeePerGas:i}=e,{gasPrice:s}=null!=n?n:{};if(!p(r))return h("Using maxFeePerGas from request",r),r;if(p(i)&&s)return h("Setting maxFeePerGas to transaction gasPrice",s),s;const{maxFeePerGas:o}=yield t();if(!o)throw new Error("Failed to get gas fee estimate for maxFeePerGas");return h("Using maxFeePerGas from estimate",o),o}))}(n,m,i),u.maxPriorityFeePerGas=yield function(e,t,n,i){return r(this,void 0,void 0,(function*(){const{maxFeePerGas:r,maxPriorityFeePerGas:s}=e,{gasPrice:o}=null!=i?i:{},{maxFeePerGas:a}=n;if(!p(s))return h("Using maxPriorityFeePerGas from request",s),s;if(p(r)&&o)return h("Setting maxPriorityFeePerGas to transaction gasPrice",o),o;const{maxPriorityFeePerGas:l}=yield t();return l?(h("Using maxPriorityFeePerGas from estimate",l),l):(h("Setting maxPriorityFeePerGas to maxFeePerGas",a),a)}))}(n,m,u,i),t.userFeeLevel=function(e,t,n,r){const{origin:i}=e,{maxFeePerGas:o,maxPriorityFeePerGas:a}=t,{maxFeePerGas:c,maxPriorityFeePerGas:u}=n||{};if(p(o)&&p(a)&&(null==r?void 0:r.gasPrice))return i===s.ORIGIN_METAMASK?l.UserFeeLevel.CUSTOM:l.UserFeeLevel.DAPP_SUGGESTED;if(p(o)&&p(a)&&c&&u)return l.UserFeeLevel.MEDIUM;if(i===s.ORIGIN_METAMASK)return l.UserFeeLevel.CUSTOM;return l.UserFeeLevel.DAPP_SUGGESTED}(t,n,d,i)}))}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/utils/gas-fees.js"}],[1778,{"../constants":1770,"../helpers/Bundler":1771,"../logger":1775,"@metamask/controller-utils":1069,"ethereumjs-util":2748},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{l(r.next(e))}catch(e){s(e)}}function a(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.updateGas=void 0;const i=e("@metamask/controller-utils"),s=e("ethereumjs-util"),o=e("../constants"),a=e("../helpers/Bundler"),l=e("../logger"),c=(0,l.createModuleLogger)(l.projectLogger,"gas"),u=1.5;function d(e){const t=("string"==typeof e?(0,i.hexToBN)(e):new s.BN(e)).muln(u);return(0,s.addHexPrefix)(t.toString(16))}n.updateGas=function(e,t,n){var i;return r(this,void 0,void 0,(function*(){const{userOperation:r}=e;if(t.gas)return r.callGasLimit=t.gas.callGasLimit,r.preVerificationGas=t.gas.preVerificationGas,r.verificationGasLimit=t.gas.verificationGasLimit,void c("Using gas values from smart contract account",{callGasLimit:r.callGasLimit,preVerificationGas:r.preVerificationGas,verificationGasLimit:r.verificationGasLimit});const s=Object.assign(Object.assign({},r),{maxFeePerGas:o.VALUE_ZERO,maxPriorityFeePerGas:o.VALUE_ZERO,callGasLimit:o.VALUE_ZERO,preVerificationGas:o.VALUE_ZERO,verificationGasLimit:"0xF4240"}),l=new a.Bundler(e.bundlerUrl),h=yield l.estimateUserOperationGas(s,n);r.callGasLimit=d(h.callGasLimit),r.preVerificationGas=d(h.preVerificationGas),r.verificationGasLimit=d(null!==(i=h.verificationGasLimit)&&void 0!==i?i:h.verificationGas),c("Using buffered gas values from bundler estimate",{callGasLimit:r.callGasLimit,preVerificationGas:r.preVerificationGas,verificationGasLimit:r.verificationGasLimit,multiplier:u,estimate:h})}))}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/utils/gas.js"}],[1779,{"../constants":1770,"../types":1776,"@metamask/transaction-controller":1755,"ethereumjs-util":2748},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getTransactionMetadata=void 0;const r=e("@metamask/transaction-controller"),i=e("ethereumjs-util"),s=e("../constants"),o=e("../types");n.getTransactionMetadata=function(e){var t,n,a,l,c,u,d,h,f;const{actualGasCost:p,actualGasUsed:m,baseFeePerGas:g,chainId:v,error:b,origin:w,transactionHash:y,id:_,swapsMetadata:S,time:k,transactionParams:E,transactionType:T,userFeeLevel:P,userOperation:C}=e;if(!E)return undefined;const O=p&&m?(0,i.addHexPrefix)(new i.BN((0,i.stripHexPrefix)(p),16).div(new i.BN((0,i.stripHexPrefix)(m),16)).toString(16)):undefined,j=b?{name:b.name,message:b.message,stack:b.stack,code:b.code,rpc:b.rpc}:undefined,M={[o.UserOperationStatus.Unapproved]:r.TransactionStatus.unapproved,[o.UserOperationStatus.Approved]:r.TransactionStatus.approved,[o.UserOperationStatus.Signed]:r.TransactionStatus.signed,[o.UserOperationStatus.Submitted]:r.TransactionStatus.submitted,[o.UserOperationStatus.Confirmed]:r.TransactionStatus.confirmed,[o.UserOperationStatus.Failed]:r.TransactionStatus.failed}[e.status],R=function(...e){const t=new i.BN(0);for(const n of e)n&&t.iadd(new i.BN((0,i.stripHexPrefix)(n),16));return(0,i.addHexPrefix)(t.toString(16))}(C.preVerificationGas,C.verificationGasLimit,C.callGasLimit),A=C.paymasterAndData!==s.EMPTY_BYTES,N=A?s.VALUE_ZERO:C.maxFeePerGas,I=A?s.VALUE_ZERO:C.maxPriorityFeePerGas,x=C.nonce===s.EMPTY_BYTES?undefined:C.nonce,L=Object.assign(Object.assign({},E),{from:C.sender,gas:R,nonce:x,maxFeePerGas:N,maxPriorityFeePerGas:I});delete L.gasPrice;const B={approvalTxId:null!==(t=null==S?void 0:S.approvalTxId)&&void 0!==t?t:undefined,destinationTokenAddress:null!==(n=null==S?void 0:S.destinationTokenAddress)&&void 0!==n?n:undefined,destinationTokenDecimals:null!==(a=null==S?void 0:S.destinationTokenDecimals)&&void 0!==a?a:undefined,destinationTokenSymbol:null!==(l=null==S?void 0:S.destinationTokenSymbol)&&void 0!==l?l:undefined,estimatedBaseFee:null!==(c=null==S?void 0:S.estimatedBaseFee)&&void 0!==c?c:undefined,sourceTokenSymbol:null!==(u=null==S?void 0:S.sourceTokenSymbol)&&void 0!==u?u:undefined,swapMetaData:null!==(d=null==S?void 0:S.swapMetaData)&&void 0!==d?d:undefined,swapTokenValue:null!==(h=null==S?void 0:S.swapTokenValue)&&void 0!==h?h:undefined},D=A?r.UserFeeLevel.CUSTOM:P;return Object.assign({baseFeePerGas:null!==(f=g)&&void 0!==f?f:undefined,chainId:v,error:j,hash:null!=y?y:undefined,id:_,isUserOperation:!0,origin:w,status:M,time:k,txParams:L,txReceipt:{effectiveGasPrice:null!=O?O:undefined,gasUsed:null!=m?m:undefined},type:null!=T?T:undefined,userFeeLevel:D},B)}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/utils/transaction.js"}],[178,{"@metamask/utils":1806,lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=s,t.data=function(e){if(!(0,i.hasProperty)(e,"NetworkController")||!(0,i.isObject)(e.NetworkController)){var t,n;return null===(t=global.sentry)||void 0===t||null===(n=t.captureException)||void 0===n||n.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController)),e}if(!(0,i.hasProperty)(e.NetworkController,"network")){var r,s;if(e.NetworkController.networkId===undefined)null===(r=global.sentry)||void 0===r||null===(s=r.captureException)||void 0===s||s.call(r,new Error("typeof state.NetworkController.network is "+typeof e.NetworkController.network));return e}const o={...e.NetworkController};"loading"===o.network?(o.networkId=null,o.networkStatus="unknown"):(o.networkId=o.network,o.networkStatus="available");return delete o.network,{...e,NetworkController:o}}(t.data),t},n.version=void 0;var r=e("lodash"),i=e("@metamask/utils");const s=n.version=84}}},{package:"$root$",file:"app/scripts/migrations/084.ts"}],[1780,{"../constants":1770,"@metamask/transaction-controller":1755,"@metamask/utils":1806,superstruct:3884},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateSignUserOperationResponse=n.validateUpdateUserOperationResponse=n.validatePrepareUserOperationResponse=n.validateAddUserOperationOptions=n.validateAddUserOperationRequest=void 0;const r=e("@metamask/transaction-controller"),i=e("@metamask/utils"),s=e("superstruct"),o=e("../constants");function a(e,t,n){try{(0,s.assert)(e,t,n)}catch(e){const t=e.failures().map((e=>e.path.length?`${e.path.join(".")} - ${e.message}`:e.message)).join("\n");throw new Error(`${n}\n${t}`)}}function l(){return(0,s.define)("Hexadecimal String",(e=>(0,i.isStrictHexString)(e)))}function c(){return(0,s.define)("Hexadecimal String or 0x",(e=>(0,i.isStrictHexString)(e)||e===o.EMPTY_BYTES))}n.validateAddUserOperationRequest=function(e){const t=l(),n=c();a(e,(0,s.object)({data:(0,s.optional)(n),from:t,maxFeePerGas:(0,s.optional)(t),maxPriorityFeePerGas:(0,s.optional)(t),to:(0,s.optional)(t),value:(0,s.optional)(t)}),"Invalid request to add user operation")},n.validateAddUserOperationOptions=function(e){a(e,(0,s.object)({networkClientId:(0,s.string)(),origin:(0,s.string)(),requireApproval:(0,s.optional)((0,s.boolean)()),smartContractAccount:(0,s.optional)((0,s.object)({prepareUserOperation:(0,s.func)(),updateUserOperation:(0,s.func)(),signUserOperation:(0,s.func)()})),swaps:(0,s.optional)((0,s.object)({approvalTxId:(0,s.optional)((0,s.string)()),destinationTokenAddress:(0,s.optional)((0,s.string)()),destinationTokenDecimals:(0,s.optional)((0,s.number)()),destinationTokenSymbol:(0,s.optional)((0,s.string)()),estimatedBaseFee:(0,s.optional)((0,s.string)()),sourceTokenSymbol:(0,s.optional)((0,s.string)()),swapMetaData:(0,s.optional)((0,s.object)()),swapTokenValue:(0,s.optional)((0,s.string)())})),type:(0,s.optional)((0,s.enums)(Object.values(r.TransactionType)))}),"Invalid options to add user operation")},n.validatePrepareUserOperationResponse=function(e){const t=l(),n=c();a(e,(0,s.refine)((0,s.object)({bundler:(0,s.string)(),callData:t,dummyPaymasterAndData:(0,s.optional)(n),dummySignature:(0,s.optional)(n),gas:(0,s.optional)((0,s.object)({callGasLimit:t,preVerificationGas:t,verificationGasLimit:t})),initCode:(0,s.optional)(n),nonce:t,sender:t}),"ValidPrepareUserOperationResponse",(({gas:e,dummySignature:t})=>!!(e||t&&t!==o.EMPTY_BYTES)||"Must specify dummySignature if not specifying gas")),"Invalid response when preparing user operation")},n.validateUpdateUserOperationResponse=function(e){const t=l();a(e,(0,s.optional)((0,s.object)({paymasterAndData:(0,s.optional)(t)})),"Invalid response when updating user operation")},n.validateSignUserOperationResponse=function(e){const t=l();a(e,(0,s.object)({signature:t}),"Invalid response when signing user operation")}}}},{package:"@metamask/user-operation-controller",file:"node_modules/@metamask/user-operation-controller/dist/utils/validation.js"}],[1781,{"fast-json-stable-stringify":2823,uuid:3942},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.AbstractPollingControllerBaseMixin=n.getKey=void 0;const s=i(e("fast-json-stable-stringify")),o=e("uuid");n.getKey=(e,t)=>`${e}:${(0,s.default)(t)}`,n.AbstractPollingControllerBaseMixin=function(e){var t,i;return t=new WeakMap,i=new WeakMap,class extends e{constructor(){super(...arguments),t.set(this,new Map),i.set(this,new Map)}startPollingByNetworkClientId(e,i={}){var s;const a=(0,o.v4)(),l=(0,n.getKey)(e,i),c=null!==(s=r(this,t,"f").get(l))&&void 0!==s?s:new Set;return c.add(a),r(this,t,"f").set(l,c),1===c.size&&this._startPollingByNetworkClientId(e,i),a}stopAllPolling(){r(this,t,"f").forEach(((e,t)=>{e.forEach((e=>{this.stopPollingByPollingToken(e)}))}))}stopPollingByPollingToken(e){if(!e)throw new Error("pollingToken required");let n=null;for(const[i,s]of r(this,t,"f"))if(s.delete(e)){0===s.size&&(n=i);break}if(n){this._stopPollingByPollingTokenSetId(n),r(this,t,"f").delete(n);const e=r(this,i,"f").get(n);if(e){for(const t of e)t(n);e.clear()}}}onPollingCompleteByNetworkClientId(e,t,s={}){var o;const a=(0,n.getKey)(e,s),l=null!==(o=r(this,i,"f").get(a))&&void 0!==o?o:new Set;l.add(t),r(this,i,"f").set(a,l)}}}}}},{package:"@metamask/user-operation-controller>@metamask/polling-controller",file:"node_modules/@metamask/user-operation-controller/node_modules/@metamask/polling-controller/dist/AbstractPollingController.js"}],[1782,{"./AbstractPollingController":1781,"@metamask/base-controller":1064},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.BlockTrackerPollingControllerV1=n.BlockTrackerPollingController=n.BlockTrackerPollingControllerOnly=void 0;const i=e("@metamask/base-controller"),s=e("./AbstractPollingController");function o(e){var t;class n extends((0,s.AbstractPollingControllerBaseMixin)(e)){constructor(){super(...arguments),t.set(this,{})}_startPollingByNetworkClientId(e,n){const i=(0,s.getKey)(e,n);if(r(this,t,"f")[i])return;const o=this._getNetworkClientById(e);if(!o)throw new Error(`Unable to retrieve blockTracker for networkClientId ${e}`);{const s=this._executePoll.bind(this,e,n);o.blockTracker.addListener("latest",s),r(this,t,"f")[i]=s}}_stopPollingByPollingTokenSetId(e){const[n]=e.split(":"),i=this._getNetworkClientById(n);if(i&&r(this,t,"f")[e]){const n=r(this,t,"f")[e];n&&(i.blockTracker.removeListener("latest",n),delete r(this,t,"f")[e])}}}return t=new WeakMap,n}n.BlockTrackerPollingControllerOnly=o(class{}),n.BlockTrackerPollingController=o(i.BaseController),n.BlockTrackerPollingControllerV1=o(i.BaseControllerV1)}}},{package:"@metamask/user-operation-controller>@metamask/polling-controller",file:"node_modules/@metamask/user-operation-controller/node_modules/@metamask/polling-controller/dist/BlockTrackerPollingController.js"}],[1783,{"./AbstractPollingController":1781,"@metamask/base-controller":1064},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{l(r.next(e))}catch(e){s(e)}}function a(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))},i=this&&this.__classPrivateFieldSet||function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},s=this&&this.__classPrivateFieldGet||function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};Object.defineProperty(n,"__esModule",{value:!0}),n.StaticIntervalPollingControllerV1=n.StaticIntervalPollingController=n.StaticIntervalPollingControllerOnly=void 0;const o=e("@metamask/base-controller"),a=e("./AbstractPollingController");function l(e){var t,n;class o extends((0,a.AbstractPollingControllerBaseMixin)(e)){constructor(){super(...arguments),t.set(this,{}),n.set(this,1e3)}setIntervalLength(e){i(this,n,e,"f")}getIntervalLength(){return s(this,n,"f")}_startPollingByNetworkClientId(e,i){if(!s(this,n,"f"))throw new Error("intervalLength must be defined and greater than 0");const o=(0,a.getKey)(e,i),l=s(this,t,"f")[o];this._stopPollingByPollingTokenSetId(o),s(this,t,"f")[o]=setTimeout((()=>r(this,void 0,void 0,(function*(){try{yield this._executePoll(e,i)}catch(e){console.error(e)}this._startPollingByNetworkClientId(e,i)}))),l?s(this,n,"f"):0)}_stopPollingByPollingTokenSetId(e){const n=s(this,t,"f")[e];n&&(clearTimeout(n),delete s(this,t,"f")[e])}}return t=new WeakMap,n=new WeakMap,o}n.StaticIntervalPollingControllerOnly=l(class{}),n.StaticIntervalPollingController=l(o.BaseController),n.StaticIntervalPollingControllerV1=l(o.BaseControllerV1)}}},{package:"@metamask/user-operation-controller>@metamask/polling-controller",file:"node_modules/@metamask/user-operation-controller/node_modules/@metamask/polling-controller/dist/StaticIntervalPollingController.js"}],[1784,{"./BlockTrackerPollingController":1782,"./StaticIntervalPollingController":1783},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.StaticIntervalPollingControllerV1=n.StaticIntervalPollingController=n.StaticIntervalPollingControllerOnly=n.BlockTrackerPollingControllerV1=n.BlockTrackerPollingController=n.BlockTrackerPollingControllerOnly=void 0;var r=e("./BlockTrackerPollingController");Object.defineProperty(n,"BlockTrackerPollingControllerOnly",{enumerable:!0,get:function(){return r.BlockTrackerPollingControllerOnly}}),Object.defineProperty(n,"BlockTrackerPollingController",{enumerable:!0,get:function(){return r.BlockTrackerPollingController}}),Object.defineProperty(n,"BlockTrackerPollingControllerV1",{enumerable:!0,get:function(){return r.BlockTrackerPollingControllerV1}});var i=e("./StaticIntervalPollingController");Object.defineProperty(n,"StaticIntervalPollingControllerOnly",{enumerable:!0,get:function(){return i.StaticIntervalPollingControllerOnly}}),Object.defineProperty(n,"StaticIntervalPollingController",{enumerable:!0,get:function(){return i.StaticIntervalPollingController}}),Object.defineProperty(n,"StaticIntervalPollingControllerV1",{enumerable:!0,get:function(){return i.StaticIntervalPollingControllerV1}})}}},{package:"@metamask/user-operation-controller>@metamask/polling-controller",file:"node_modules/@metamask/user-operation-controller/node_modules/@metamask/polling-controller/dist/index.js"}],[179,{"@metamask/utils":1806,lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=s,t.data=function(e){if(!(0,i.isObject)(e.NetworkController)){var t,n;return null===(t=global.sentry)||void 0===t||null===(n=t.captureException)||void 0===n||n.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController)),e}return delete e.NetworkController.previousProviderStore,e}(t.data),t},n.version=void 0;var r=e("lodash"),i=e("@metamask/utils");const s=n.version=85}}},{package:"$root$",file:"app/scripts/migrations/085.ts"}],[18,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.NOTIFICATION_NAMES=void 0;n.NOTIFICATION_NAMES={accountsChanged:"metamask_accountsChanged",unlockStateChanged:"metamask_unlockStateChanged",chainChanged:"metamask_chainChanged"}}}},{package:"$root$",file:"app/scripts/controllers/permissions/enums.js"}],[180,{"@metamask/utils":1806,lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,i.cloneDeep)(e);return t.meta.version=s,t.data=function(e){if((0,r.hasProperty)(e,"NetworkController")&&(0,r.isObject)(e.NetworkController)&&(0,r.hasProperty)(e.NetworkController,"provider")){const t=e.NetworkController;return t.providerConfig=t.provider,delete t.provider,{...e,NetworkController:t}}var t,n;if((0,r.isObject)(e.NetworkController)){if(!(0,r.hasProperty)(e.NetworkController,"provider")){var i,s;if(e.NetworkController.providerConfig===undefined)null===(i=global.sentry)||void 0===i||null===(s=i.captureException)||void 0===s||s.call(i,new Error("typeof state.NetworkController.provider is "+typeof e.NetworkController.provider))}}else null===(t=global.sentry)||void 0===t||null===(n=t.captureException)||void 0===n||n.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController));return e}(t.data),t},n.version=void 0;var r=e("@metamask/utils"),i=e("lodash");const s=n.version=86}}},{package:"$root$",file:"app/scripts/migrations/086.ts"}],[1807,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){t.exports=function(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var r=0;r<e.length;r++){var i=e.charAt(r),s=i.charCodeAt(0);if(255!==t[s])throw new TypeError(i+" is ambiguous");t[s]=r}var o=e.length,a=e.charAt(0),l=Math.log(o)/Math.log(256),c=Math.log(256)/Math.log(o);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var n=0;if(" "!==e[n]){for(var r=0,i=0;e[n]===a;)r++,n++;for(var s=(e.length-n)*l+1>>>0,c=new Uint8Array(s);e[n];){var u=t[e.charCodeAt(n)];if(255===u)return;for(var d=0,h=s-1;(0!==u||d<i)&&-1!==h;h--,d++)u+=o*c[h]>>>0,c[h]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=d,n++}if(" "!==e[n]){for(var f=s-i;f!==s&&0===c[f];)f++;for(var p=new Uint8Array(r+(s-f)),m=r;f!==s;)p[m++]=c[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,s=t.length;i!==s&&0===t[i];)i++,n++;for(var l=(s-i)*c+1>>>0,u=new Uint8Array(l);i!==s;){for(var d=t[i],h=0,f=l-1;(0!==d||h<r)&&-1!==f;f--,h++)d+=256*u[f]>>>0,u[f]=d%o>>>0,d=d/o>>>0;if(0!==d)throw new Error("Non-zero carry");r=h,i++}for(var p=l-r;p!==l&&0===u[p];)p++;for(var m=a.repeat(n);p<l;++p)m+=e.charAt(u[p]);return m},decodeUnsafe:u,decode:function(e){var t=u(e);if(t)return t;throw new Error("Non-base"+o+" character")}}}}}},{package:"@ensdomains/content-hash>cids>multibase>@multiformats/base-x",file:"node_modules/@multiformats/base-x/src/index.js"}],[181,{"@metamask/utils":1806,lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,i.cloneDeep)(e);return t.meta.version=s,t.data=function(e){if(!(0,r.isObject)(e.TokensController)){var t,n;return null===(t=global.sentry)||void 0===t||null===(n=t.captureException)||void 0===n||n.call(t,new Error("typeof state.TokensController is "+typeof e.TokensController)),e}return delete e.TokensController.suggestedAssets,e}(t.data),t},n.version=void 0;var r=e("@metamask/utils"),i=e("lodash");const s=n.version=87}}},{package:"$root$",file:"app/scripts/migrations/087.ts"}],[182,{"@metamask/utils":1806,"ethereumjs-util":2748,lodash:3355,loglevel:3365},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,o.cloneDeep)(e);return t.meta.version=l,function(e){if((0,i.hasProperty)(e,"NftController")&&(0,i.isObject)(e.NftController)){const l=e.NftController;if((0,i.hasProperty)(l,"allNftContracts")&&(0,i.isObject)(l.allNftContracts)){const{allNftContracts:e}=l;Object.keys(e).every((t=>(0,i.isObject)(e[t])))&&Object.keys(e).forEach((t=>{const n=e[t];if((0,i.isObject)(n)){for(const e of Object.keys(n))"undefined"!==e&&e!==undefined||delete n[e];e[t]=(0,o.mapKeys)(n,((e,t)=>c(t)))}}))}else if((0,i.hasProperty)(l,"allNftContracts")){var t,n;null===(t=global.sentry)||void 0===t||null===(n=t.captureException)||void 0===n||n.call(t,new Error("typeof state.NftController.allNftContracts is "+typeof l.allNftContracts))}else a.default.warn("typeof state.NftController.allNftContracts is "+typeof l.allNftContracts);if((0,i.hasProperty)(l,"allNfts")&&(0,i.isObject)(l.allNfts)){const{allNfts:e}=l;Object.keys(e).every((t=>(0,i.isObject)(e[t])))&&Object.keys(e).forEach((t=>{const n=e[t];if((0,i.isObject)(n)){for(const e of Object.keys(n))"undefined"!==e&&e!==undefined||delete n[e];e[t]=(0,o.mapKeys)(n,((e,t)=>c(t)))}}))}else if((0,i.hasProperty)(l,"allNfts")){var r,s;null===(r=global.sentry)||void 0===r||null===(s=r.captureException)||void 0===s||s.call(r,new Error("typeof state.NftController.allNfts is "+typeof l.allNfts))}else a.default.warn("typeof state.NftController.allNfts is "+typeof l.allNfts);e.NftController=l}else if((0,i.hasProperty)(e,"NftController")){var l,u;null===(l=global.sentry)||void 0===l||null===(u=l.captureException)||void 0===u||u.call(l,new Error("typeof state.NftController is "+typeof e.NftController))}else a.default.warn("typeof state.NftController is undefined");if((0,i.hasProperty)(e,"TokenListController")&&(0,i.isObject)(e.TokenListController)){const t=e.TokenListController;if((0,i.hasProperty)(t,"tokensChainsCache")&&(0,i.isObject)(t.tokensChainsCache)){for(const e of Object.keys(t.tokensChainsCache))"undefined"!==e&&e!==undefined||delete t.tokensChainsCache[e];t.tokensChainsCache=(0,o.mapKeys)(t.tokensChainsCache,((e,t)=>c(t)))}else if((0,i.hasProperty)(t,"tokensChainsCache")){var d,h;null===(d=global.sentry)||void 0===d||null===(h=d.captureException)||void 0===h||h.call(d,new Error("typeof state.TokenListController.tokensChainsCache is "+typeof e.TokenListController.tokensChainsCache))}else a.default.warn("typeof state.TokenListController.tokensChainsCache is undefined")}else a.default.warn("typeof state.TokenListController is "+typeof e.TokenListController);if((0,i.hasProperty)(e,"TokensController")&&(0,i.isObject)(e.TokensController)){const t=e.TokensController;if((0,i.hasProperty)(t,"allTokens")&&(0,i.isObject)(t.allTokens)){const{allTokens:e}=t;for(const t of Object.keys(e))"undefined"!==t&&t!==undefined||delete e[t];t.allTokens=(0,o.mapKeys)(e,((e,t)=>c(t)))}else if((0,i.hasProperty)(t,"allTokens")){var f,p;null===(f=global.sentry)||void 0===f||null===(p=f.captureException)||void 0===p||p.call(f,new Error("typeof state.TokensController.allTokens is "+typeof t.allTokens))}else a.default.warn("typeof state.TokensController.allTokens is "+typeof t.allTokens);if((0,i.hasProperty)(t,"allIgnoredTokens")&&(0,i.isObject)(t.allIgnoredTokens)){const{allIgnoredTokens:e}=t;for(const t of Object.keys(e))"undefined"!==t&&t!==undefined||delete e[t];t.allIgnoredTokens=(0,o.mapKeys)(e,((e,t)=>c(t)))}else if((0,i.hasProperty)(t,"allIgnoredTokens")){var m,g;null===(m=global.sentry)||void 0===m||null===(g=m.captureException)||void 0===g||g.call(m,new Error("typeof state.TokensController.allIgnoredTokens is "+typeof t.allIgnoredTokens))}else a.default.warn("typeof state.TokensController.allIgnoredTokens is "+typeof t.allIgnoredTokens);if((0,i.hasProperty)(t,"allDetectedTokens")&&(0,i.isObject)(t.allDetectedTokens)){const{allDetectedTokens:e}=t;for(const t of Object.keys(e))"undefined"!==t&&t!==undefined||delete e[t];t.allDetectedTokens=(0,o.mapKeys)(e,((e,t)=>c(t)))}else if((0,i.hasProperty)(t,"allDetectedTokens")){var v,b;null===(v=global.sentry)||void 0===v||null===(b=v.captureException)||void 0===b||b.call(v,new Error("typeof state.TokensController.allDetectedTokens is "+typeof t.allDetectedTokens))}else a.default.warn("typeof state.TokensController.allDetectedTokens is "+typeof t.allDetectedTokens);e.TokensController=t}else{var w,y;null===(w=global.sentry)||void 0===w||null===(y=w.captureException)||void 0===y||y.call(w,new Error("typeof state.TokensController is "+typeof e.TokensController))}}(t.data),t},n.version=void 0;var r,i=e("@metamask/utils"),s=e("ethereumjs-util"),o=e("lodash"),a=(r=e("loglevel"))&&r.__esModule?r:{default:r};const l=n.version=88;function c(e){if("string"==typeof e&&(0,i.isStrictHexString)(e))return e;return`0x${s.BN.isBN(e)?e.toString(16):new s.BN(e.toString(),10).toString(16)}`}}}},{package:"$root$",file:"app/scripts/migrations/088.ts"}],[183,{"@metamask/utils":1806,lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,i.cloneDeep)(e);return t.meta.version=s,t.data=function(e){if((0,r.hasProperty)(e,"NetworkController")&&(0,r.isObject)(e.NetworkController)&&(0,r.hasProperty)(e.NetworkController,"providerConfig")&&(0,r.isObject)(e.NetworkController.providerConfig)){const{networkConfigurations:t,providerConfig:n}=e.NetworkController;if(!(0,r.isObject)(t))return e;if(n.id)return e;let i;for(const s of Object.keys(t)){const o=t[s];if(!(0,r.isObject)(o))return e;if(o.rpcUrl===n.rpcUrl){i=o.id;break}}return i?(e.NetworkController.providerConfig={...n,id:i},{...e,NetworkController:e.NetworkController}):e}var t,n;if((0,r.isObject)(e.NetworkController)){if(!(0,r.isObject)(e.NetworkController.providerConfig)){var i,s;null===(i=global.sentry)||void 0===i||null===(s=i.captureException)||void 0===s||s.call(i,new Error("typeof state.NetworkController.providerConfig is "+typeof e.NetworkController.providerConfig))}}else null===(t=global.sentry)||void 0===t||null===(n=t.captureException)||void 0===n||n.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController));return e}(t.data),t},n.version=void 0;var r=e("@metamask/utils"),i=e("lodash");const s=n.version=89}}},{package:"$root$",file:"app/scripts/migrations/089.ts"}],[184,{"@metamask/utils":1806,lodash:3355,loglevel:3365},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,i.cloneDeep)(e);return t.meta.version=a,t.data=function(e){if(!(0,s.hasProperty)(e,"PhishingController"))return o.default.warn("typeof state.PhishingController is undefined"),e;if(!(0,s.isObject)(e.PhishingController)){var t,n;return null===(t=global.sentry)||void 0===t||null===(n=t.captureException)||void 0===n||n.call(t,new Error("typeof state.PhishingController is "+typeof e.PhishingController)),e}if(!(0,s.hasProperty)(e.PhishingController,"listState"))return o.default.warn("typeof state.PhishingController.listState is "+typeof e.PhishingController),e;return delete e.PhishingController.listState,e}(t.data),t},n.version=void 0;var r,i=e("lodash"),s=e("@metamask/utils"),o=(r=e("loglevel"))&&r.__esModule?r:{default:r};const a=n.version=90}}},{package:"$root$",file:"app/scripts/migrations/090.ts"}],[185,{"@metamask/utils":1806,lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,i.cloneDeep)(e);return t.meta.version=s,t.data=function(e){if((0,r.hasProperty)(e,"NetworkController")&&(0,r.isObject)(e.NetworkController)&&(0,r.hasProperty)(e.NetworkController,"networkConfigurations")&&(0,r.isObject)(e.NetworkController.networkConfigurations)){const{networkConfigurations:t}=e.NetworkController;for(const[e,n]of Object.entries(t))(0,r.isObject)(n)&&(n.chainId||delete t[e]);return e.NetworkController={...e.NetworkController,networkConfigurations:t},{...e,NetworkController:e.NetworkController}}var t,n;if((0,r.isObject)(e.NetworkController)){if(!(0,r.isObject)(e.NetworkController.networkConfigurations)){var i,s;null===(i=global.sentry)||void 0===i||null===(s=i.captureException)||void 0===s||s.call(i,new Error("typeof state.NetworkController.networkConfigurations is "+typeof e.NetworkController.networkConfigurations))}}else null===(t=global.sentry)||void 0===t||null===(n=t.captureException)||void 0===n||n.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController));return e}(t.data),t},n.version=void 0;var r=e("@metamask/utils"),i=e("lodash");const s=n.version=91}}},{package:"$root$",file:"app/scripts/migrations/091.ts"}],[1852,{"@noble/curves/abstract/modular":1824,"@noble/curves/secp256k1":1833,"@noble/hashes/_assert":1835,"@noble/hashes/hmac":1839,"@noble/hashes/ripemd160":1840,"@noble/hashes/sha256":1841,"@noble/hashes/sha512":1843,"@noble/hashes/utils":1844,"@scure/base":1851},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.HDKey=n.HARDENED_OFFSET=void 0;const r=e("@noble/hashes/hmac"),i=e("@noble/hashes/ripemd160"),s=e("@noble/hashes/sha256"),o=e("@noble/hashes/sha512"),a=e("@noble/hashes/_assert"),l=e("@noble/hashes/utils"),c=e("@noble/curves/secp256k1"),u=e("@noble/curves/abstract/modular"),d=e("@scure/base"),h=c.secp256k1.ProjectivePoint,f=(0,d.base58check)(s.sha256);function p(e){return BigInt(`0x${(0,l.bytesToHex)(e)}`)}const m=(0,l.utf8ToBytes)("Bitcoin seed"),g={private:76066276,public:76067358};n.HARDENED_OFFSET=2147483648;const v=e=>{if(!Number.isSafeInteger(e)||e<0||e>2**32-1)throw new Error(`Invalid number=${e}. Should be from 0 to 2 ** 32 - 1`);const t=new Uint8Array(4);return(0,l.createView)(t).setUint32(0,e,!1),t};class b{get fingerprint(){if(!this.pubHash)throw new Error("No publicKey set!");return e=this.pubHash,(0,l.createView)(e).getUint32(0,!1);var e}get identifier(){return this.pubHash}get pubKeyHash(){return this.pubHash}get privateKey(){return this.privKeyBytes||null}get publicKey(){return this.pubKey||null}get privateExtendedKey(){const e=this.privateKey;if(!e)throw new Error("No private key");return f.encode(this.serialize(this.versions.private,(0,l.concatBytes)(new Uint8Array([0]),e)))}get publicExtendedKey(){if(!this.pubKey)throw new Error("No public key");return f.encode(this.serialize(this.versions.public,this.pubKey))}static fromMasterSeed(e,t=g){if((0,a.bytes)(e),8*e.length<128||8*e.length>512)throw new Error(`HDKey: wrong seed length=${e.length}. Should be between 128 and 512 bits; 256 bits is advised)`);const n=(0,r.hmac)(o.sha512,m,e);return new b({versions:t,chainCode:n.slice(32),privateKey:n.slice(0,32)})}static fromExtendedKey(e,t=g){const n=f.decode(e),r=(0,l.createView)(n),i=r.getUint32(0,!1),s={versions:t,depth:n[4],parentFingerprint:r.getUint32(5,!1),index:r.getUint32(9,!1),chainCode:n.slice(13,45)},o=n.slice(45),a=0===o[0];if(i!==t[a?"private":"public"])throw new Error("Version mismatch");return new b(a?{...s,privateKey:o.slice(1)}:{...s,publicKey:o})}static fromJSON(e){return b.fromExtendedKey(e.xpriv)}constructor(e){if(this.depth=0,this.index=0,this.chainCode=null,this.parentFingerprint=0,!e||"object"!=typeof e)throw new Error("HDKey.constructor must not be called directly");if(this.versions=e.versions||g,this.depth=e.depth||0,this.chainCode=e.chainCode,this.index=e.index||0,this.parentFingerprint=e.parentFingerprint||0,!this.depth&&(this.parentFingerprint||this.index))throw new Error("HDKey: zero depth with non-zero index/parent fingerprint");if(e.publicKey&&e.privateKey)throw new Error("HDKey: publicKey and privateKey at same time.");if(e.privateKey){if(!c.secp256k1.utils.isValidPrivateKey(e.privateKey))throw new Error("Invalid private key");this.privKey="bigint"==typeof e.privateKey?e.privateKey:p(e.privateKey),this.privKeyBytes=(t=this.privKey,(0,l.hexToBytes)(t.toString(16).padStart(64,"0"))),this.pubKey=c.secp256k1.getPublicKey(e.privateKey,!0)}else{if(!e.publicKey)throw new Error("HDKey: no public or private key provided");this.pubKey=h.fromHex(e.publicKey).toRawBytes(!0)}var t,n;this.pubHash=(n=this.pubKey,(0,i.ripemd160)((0,s.sha256)(n)))}derive(e){if(!/^[mM]'?/.test(e))throw new Error('Path must start with "m" or "M"');if(/^[mM]'?$/.test(e))return this;const t=e.replace(/^[mM]'?\//,"").split("/");let r=this;for(const e of t){const t=/^(\d+)('?)$/.exec(e);if(!t||3!==t.length)throw new Error(`Invalid child index: ${e}`);let i=+t[1];if(!Number.isSafeInteger(i)||i>=n.HARDENED_OFFSET)throw new Error("Invalid index");"'"===t[2]&&(i+=n.HARDENED_OFFSET),r=r.deriveChild(i)}return r}deriveChild(e){if(!this.pubKey||!this.chainCode)throw new Error("No publicKey or chainCode set");let t=v(e);if(e>=n.HARDENED_OFFSET){const e=this.privateKey;if(!e)throw new Error("Could not derive hardened child key");t=(0,l.concatBytes)(new Uint8Array([0]),e,t)}else t=(0,l.concatBytes)(this.pubKey,t);const i=(0,r.hmac)(o.sha512,this.chainCode,t),s=p(i.slice(0,32)),a=i.slice(32);if(!c.secp256k1.utils.isValidPrivateKey(s))throw new Error("Tweak bigger than curve order");const d={versions:this.versions,chainCode:a,depth:this.depth+1,parentFingerprint:this.fingerprint,index:e};try{if(this.privateKey){const e=(0,u.mod)(this.privKey+s,c.secp256k1.CURVE.n);if(!c.secp256k1.utils.isValidPrivateKey(e))throw new Error("The tweak was out of range or the resulted private key is invalid");d.privateKey=e}else{const e=h.fromHex(this.pubKey).add(h.fromPrivateKey(s));if(e.equals(h.ZERO))throw new Error("The tweak was equal to negative P, which made the result key invalid");d.publicKey=e.toRawBytes(!0)}return new b(d)}catch(t){return this.deriveChild(e+1)}}sign(e){if(!this.privateKey)throw new Error("No privateKey set!");return(0,a.bytes)(e,32),c.secp256k1.sign(e,this.privKey).toCompactRawBytes()}verify(e,t){if((0,a.bytes)(e,32),(0,a.bytes)(t,64),!this.publicKey)throw new Error("No publicKey set!");let n;try{n=c.secp256k1.Signature.fromCompact(t)}catch(e){return!1}return c.secp256k1.verify(n,e,this.publicKey)}wipePrivateData(){return this.privKey=undefined,this.privKeyBytes&&(this.privKeyBytes.fill(0),this.privKeyBytes=undefined),this}toJSON(){return{xpriv:this.privateExtendedKey,xpub:this.publicExtendedKey}}serialize(e,t){if(!this.chainCode)throw new Error("No chainCode set");return(0,a.bytes)(t,33),(0,l.concatBytes)(v(e),new Uint8Array([this.depth]),v(this.parentFingerprint),v(this.index),this.chainCode,t)}}n.HDKey=b}}},{package:"@ethereumjs/tx>ethereum-cryptography>@scure/bip32",file:"node_modules/@scure/bip32/lib/index.js"}],[1853,{assert:2457,buffer:2461,"component-type":2521,"join-component":3140},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){(function(n){(function(){var r=e("component-type"),i=e("join-component"),s=e("assert"),o=32768;t.exports=function(e,t){switch(l(e),t=t||e.type,s(t,"You must pass an event type."),t){case"track":return function(e){s(e.anonymousId||e.userId,'You must pass either an "anonymousId" or a "userId".'),s(e.event,'You must pass an "event".')}(e);case"group":return function(e){s(e.anonymousId||e.userId,'You must pass either an "anonymousId" or a "userId".'),s(e.groupId,'You must pass a "groupId".')}(e);case"identify":case"page":case"screen":return function(e){s(e.anonymousId||e.userId,'You must pass either an "anonymousId" or a "userId".')}(e);case"alias":return function(e){s(e.userId,'You must pass a "userId".'),s(e.previousId,'You must pass a "previousId".')}(e);default:s(0,'Invalid event type: "'+t+'"')}};var a={anonymousId:["string","number"],category:"string",context:"object",event:"string",groupId:["string","number"],integrations:"object",name:"string",previousId:["string","number"],timestamp:"date",userId:["string","number"],type:"string"};function l(e){s("object"===r(e),"You must pass a message object.");var t=JSON.stringify(e);for(var l in s(n.byteLength(t,"utf8")<o,"Your message must be < 32kb."),a){var c=e[l];if(c){var u=a[l];"array"!==r(u)&&(u=[u]);var d="object"===u[0]?"an":"a";s(u.some((function(e){return r(c)===e})),'"'+l+'" must be '+d+" "+i(u,"or")+".")}}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@segment/loosely-validate-event",file:"node_modules/@segment/loosely-validate-event/index.js"}],[186,{"@metamask/utils":1806,lodash:3355,loglevel:3365},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,i.cloneDeep)(e);return t.meta.version=a,t.data=function(e){if(!(0,s.hasProperty)(e,"TokenListController"))return o.default.warn("Skipping migration, TokenListController state is missing"),e;var t,n;if(!(0,s.isObject)(e.TokenListController))return null===(t=global.sentry)||void 0===t||null===(n=t.captureException)||void 0===n||n.call(t,new Error("typeof state.TokenListController is "+typeof e.TokenListController)),e;if(!(0,s.hasProperty)(e.TokenListController,"tokensChainsCache"))return o.default.warn("Skipping migration, TokenListController.tokensChainsCache state is missing"),e;e.TokenListController.tokensChainsCache===undefined&&delete e.TokenListController.tokensChainsCache;return e}(t.data),t},n.version=void 0;var r,i=e("lodash"),s=e("@metamask/utils"),o=(r=e("loglevel"))&&r.__esModule?r:{default:r};const a=n.version=92.1}}},{package:"$root$",file:"app/scripts/migrations/092.1.ts"}],[187,{"@metamask/utils":1806,"@sentry/browser":1886,lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,s.cloneDeep)(e);return t.meta.version=o,t.data=function(e){return function(e){const t=["networkId","networkStatus","providerConfig","networkDetails","networkConfigurations"];if(!(0,r.hasProperty)(e,"NetworkController")||!(0,s.isObject)(e.NetworkController))return(0,i.captureException)(`Migration ${o}: Invalid NetworkController state: ${typeof e.NetworkController}`),e;const n=e.NetworkController,a=(0,s.pick)(n,t);return{...e,NetworkController:a}}(e)}(t.data),t},n.version=void 0;var r=e("@metamask/utils"),i=e("@sentry/browser"),s=e("lodash");const o=n.version=92.2}}},{package:"$root$",file:"app/scripts/migrations/092.2.ts"}],[188,{"@metamask/utils":1806,lodash:3355,loglevel:3365},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,s.cloneDeep)(e);return t.meta.version=a,function(e){!function(e){if((0,i.isNullOrUndefined)(e.PreferencesController))return void o.default.warn(`Migration #${a}: preferences controller null or undefined, skipping migration`);if((0,i.hasProperty)(e,"AppStateController")&&(0,i.isObject)(e.AppStateController)&&(0,i.hasProperty)(e,"PreferencesController")&&(0,i.isObject)(e.PreferencesController)){var t;const n=null===(t=e.PreferencesController)||void 0===t?void 0:t.advancedGasFee,r=(0,i.isObject)(n)&&l(n);e.AppStateController.hadAdvancedGasFeesSetPriorToMigration92_3=r,(null===e.PreferencesController.advancedGasFee||(0,i.isObject)(e.PreferencesController.advancedGasFee)&&l(e.PreferencesController.advancedGasFee))&&(e.PreferencesController.advancedGasFee={})}else if(!1===(0,i.isObject)(e.AppStateController)){var n,r;null===(n=global.sentry)||void 0===n||null===(r=n.captureException)||void 0===r||r.call(n,new Error("typeof state.AppStateController is "+typeof e.AppStateController))}else if(!1===(0,i.isObject)(e.PreferencesController)){var s,c;null===(s=global.sentry)||void 0===s||null===(c=s.captureException)||void 0===c||c.call(s,new Error("typeof state.PreferencesController is "+typeof e.PreferencesController))}}(e)}(t.data),t},n.version=void 0;var r,i=e("@metamask/utils"),s=e("lodash"),o=(r=e("loglevel"))&&r.__esModule?r:{default:r};const a=n.version=92.3;function l(e){const t=Object.keys(e);return!(!t.includes("maxBaseFee")&&!t.includes("priorityFee"))}}}},{package:"$root$",file:"app/scripts/migrations/092.3.ts"}],[189,{"@metamask/utils":1806,lodash:3355,loglevel:3365},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,i.cloneDeep)(e);return t.meta.version=a,t.data=function(e){if((0,s.hasProperty)(e,"PhishingController")&&(0,s.isObject)(e.PhishingController))delete e.PhishingController.stalelistLastFetched,delete e.PhishingController.hotlistLastFetched;else if((0,s.hasProperty)(e,"PhishingController")){var t,n;null===(t=global.sentry)||void 0===t||null===(n=t.captureException)||void 0===n||n.call(t,new Error("typeof state.PhishingController is "+typeof e.PhishingController))}else o.default.warn("typeof state.PhishingController is undefined");return e}(t.data),t},n.version=void 0;var r,i=e("lodash"),s=e("@metamask/utils"),o=(r=e("loglevel"))&&r.__esModule?r:{default:r};const a=n.version=92}}},{package:"$root$",file:"app/scripts/migrations/092.ts"}],[19,{"./background-api":16,"./caveat-mutators":17,"./enums":18,"./selectors":20,"./specifications":21},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r=e("./caveat-mutators");Object.keys(r).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===r[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}}))}));var i=e("./background-api");Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===i[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}}))}));var s=e("./enums");Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===s[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return s[e]}}))}));var o=e("./specifications");Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===o[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}}))}));var a=e("./selectors");Object.keys(a).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===a[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}}))}))}}},{package:"$root$",file:"app/scripts/controllers/permissions/index.js"}],[190,{"@metamask/utils":1806,lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=s,t.data=function(e){if((0,i.hasProperty)(e,"NetworkController")&&(0,i.isObject)(e.NetworkController)&&(0,i.hasProperty)(e.NetworkController,"providerConfig")&&(0,i.isObject)(e.NetworkController.providerConfig)){const{providerConfig:t}=e.NetworkController;return t.ticker?e:(e.NetworkController.providerConfig={ticker:"ETH",...t},{...e,NetworkController:e.NetworkController})}var t,n;if((0,i.isObject)(e.NetworkController)){if((0,i.isObject)(e.NetworkController)&&!(0,i.isObject)(e.NetworkController.providerConfig)){var r,s;null===(r=global.sentry)||void 0===r||null===(s=r.captureException)||void 0===s||s.call(r,new Error("typeof state.NetworkController.providerConfig is "+typeof e.NetworkController.providerConfig))}}else null===(t=global.sentry)||void 0===t||null===(n=t.captureException)||void 0===n||n.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController));return e}(t.data),t},n.version=void 0;var r=e("lodash"),i=e("@metamask/utils");const s=n.version=93}}},{package:"$root$",file:"app/scripts/migrations/093.ts"}],[191,{"@metamask/controller-utils":1069,"@metamask/network-controller":1380,"@metamask/utils":1806,lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=a,t.data=function(e){if((0,i.hasProperty)(e,"NetworkController")&&(0,i.isObject)(e.NetworkController)&&(0,i.hasProperty)(e.NetworkController,"providerConfig")&&(0,i.isObject)(e.NetworkController.providerConfig)&&((0,i.hasProperty)(e.NetworkController.providerConfig,"id")||(0,i.hasProperty)(e.NetworkController.providerConfig,"type")&&e.NetworkController.providerConfig.type!==o.NetworkType.rpc)){const t=e.NetworkController.providerConfig.id||e.NetworkController.providerConfig.type;if(!t||"string"!=typeof t)return e;const n={[t]:{EIPS:{},status:s.NetworkStatus.Unknown}};if((0,i.hasProperty)(e.NetworkController,"networkDetails")&&(0,i.isObject)(e.NetworkController.networkDetails)){const{networkDetails:r}=e.NetworkController;r.EIPS&&(0,i.isObject)(r.EIPS)&&(n[t].EIPS={...r.EIPS}),delete e.NetworkController.networkDetails}return(0,i.hasProperty)(e.NetworkController,"networkStatus")&&"string"==typeof e.NetworkController.networkStatus&&(n[t].status=e.NetworkController.networkStatus,delete e.NetworkController.networkStatus),{...e,NetworkController:{...e.NetworkController,networksMetadata:n,selectedNetworkClientId:t}}}var t,n;if((0,i.isObject)(e.NetworkController)){if((0,i.isObject)(e.NetworkController)&&!(0,i.isObject)(e.NetworkController.providerConfig)){var r,a;null===(r=global.sentry)||void 0===r||null===(a=r.captureException)||void 0===a||a.call(r,new Error("typeof state.NetworkController.providerConfig is "+typeof e.NetworkController.providerConfig))}else if((0,i.isObject)(e.NetworkController)&&(0,i.isObject)(e.NetworkController.providerConfig)){var l,c;null===(l=global.sentry)||void 0===l||null===(c=l.captureException)||void 0===c||c.call(l,new Error(`typeof state.NetworkController.providerConfig.id is ${typeof e.NetworkController.providerConfig.id} and state.NetworkController.providerConfig.type is ${e.NetworkController.providerConfig.type}`))}}else null===(t=global.sentry)||void 0===t||null===(n=t.captureException)||void 0===n||n.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController));return e}(t.data),t},n.version=void 0;var r=e("lodash"),i=e("@metamask/utils"),s=e("@metamask/network-controller"),o=e("@metamask/controller-utils");const a=n.version=94}}},{package:"$root$",file:"app/scripts/migrations/094.ts"}],[192,{lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=i,function(e){(function(e){var t,n;const r=(null===(t=e.IncomingTransactionsController)||void 0===t?void 0:t.incomingTransactions)||{};if(0===Object.keys(r).length)return;const i=(null===(n=e.TransactionController)||void 0===n?void 0:n.transactions)||{},s=Object.values(r).reduce(((e,t)=>(e[t.id]=t,e)),i);e.TransactionController={...e.TransactionController||{},transactions:s}})(e),function(e){var t;const n=(null===(t=e.IncomingTransactionsController)||void 0===t?void 0:t.incomingTransactions)||{};if(0===Object.keys(n).length)return;const r={};for(const e of Object.values(n)){if(!e.blockNumber||!e.chainId||!e.txParams.to)continue;const t=parseInt(e.blockNumber,10),n=`${e.chainId}#${e.txParams.to.toLowerCase()}`,i=r[n]||-1;r[n]=Math.max(i,t)}e.TransactionController={...e.TransactionController,lastFetchedBlockNumbers:r}}(e),function(e){delete e.IncomingTransactionsController}(e)}(t.data),t},n.version=void 0;var r=e("lodash");const i=n.version=95}}},{package:"$root$",file:"app/scripts/migrations/095.ts"}],[193,{"../../../shared/constants/network":4006,"@metamask/utils":1806,lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=o,function(e){if(!((0,i.hasProperty)(e,"PreferencesController")&&(0,i.isObject)(e.PreferencesController)&&(0,i.isObject)(e.NetworkController)&&(0,i.hasProperty)(e.PreferencesController,"featureFlags")&&(0,i.hasProperty)(e.NetworkController,"networkConfigurations")))return e;const{PreferencesController:t,NetworkController:n}=e,{featureFlags:o}=t,{showIncomingTransactions:a}=o,{networkConfigurations:l}=n,c=Object.values(l).map((e=>e.chainId)),u=[s.CHAIN_IDS.MAINNET,s.CHAIN_IDS.LINEA_MAINNET],d=[s.CHAIN_IDS.GOERLI,s.CHAIN_IDS.SEPOLIA,s.CHAIN_IDS.LINEA_GOERLI],h=[...u,...c,...d],f=(0,r.fromPairs)((0,r.map)(h,(e=>[e,a])));(null==o?void 0:o.showIncomingTransactions)!==undefined&&delete o.showIncomingTransactions;e.PreferencesController.incomingTransactionsPreferences=f}(t.data),t},n.version=void 0;var r=e("lodash"),i=e("@metamask/utils"),s=e("../../../shared/constants/network");const o=n.version=96}}},{package:"$root$",file:"app/scripts/migrations/096.ts"}],[194,{lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=i,function(e){const t=(null==e?void 0:e.TransactionController)||{},n=(null==t?void 0:t.transactions)||{};if((0,r.isEmpty)(n))return;const i=Object.keys(n).reduce(((e,t)=>{const r=n[t];return null!=r&&r.nonceDetails&&delete r.nonceDetails,{...e,[t]:r}}),{});e.TransactionController={...t,transactions:i}}(t.data),t},n.version=void 0;var r=e("lodash");const i=n.version=97}}},{package:"$root$",file:"app/scripts/migrations/097.ts"}],[195,{lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=i,function(e){const t=(null==e?void 0:e.TransactionController)||{},n=(null==t?void 0:t.transactions)||{};if((0,r.isEmpty)(n))return;const i=Object.keys(n).reduce(((e,t)=>{const r=n[t];return r.verifiedOnBlockchain=Boolean(r.txReceipt),{...e,[t]:r}}),{});e.TransactionController={...t,transactions:i}}(t.data),t},n.version=void 0;var r=e("lodash");const i=n.version=98}}},{package:"$root$",file:"app/scripts/migrations/098.ts"}],[196,{lodash:3355,uuid:3942},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=s,function(e){const t=(null==e?void 0:e.TransactionController)||{},n=(null==t?void 0:t.transactions)||{};if((0,r.isEmpty)(n))return;const s=Object.keys(n).reduce(((e,t)=>{const s=(0,r.cloneDeep)(n[t]),o=(0,i.v1)();return s.id=o,{...e,[o]:s}}),{});e.TransactionController={...t,transactions:s}}(t.data),t},n.version=void 0;var r=e("lodash"),i=e("uuid");const s=n.version=99}}},{package:"$root$",file:"app/scripts/migrations/099.ts"}],[197,{lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=i,function(e){var t,n;const i=(null==e||null===(t=e.AddressBookController)||void 0===t?void 0:t.addressBook)??{},s=(null==e||null===(n=e.NameController)||void 0===n||null===(n=n.names)||void 0===n?void 0:n.ethereumAddress)??{};if((0,r.isEmpty)(Object.keys(i)))return;for(const e of Object.keys(i)){const t=i[e];for(const n of Object.keys(t)){var o,a;const r=t[n],i=n.toLowerCase(),l=s[i]??{};null!==(o=(l[e]??{}).name)&&void 0!==o&&o.length||null===(a=r.name)||void 0===a||!a.length||null==i||!i.length||(s[i]=l,l[e]={name:r.name,sourceId:r.isEns?"ens":null,proposedNames:{}})}}e.NameController={...e.NameController,names:{ethereumAddress:s}}}(t.data),t},n.version=void 0;var r=e("lodash");const i=n.version=100}}},{package:"$root$",file:"app/scripts/migrations/100.ts"}],[198,{"@metamask/utils":1806,lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,i.cloneDeep)(e);return t.meta.version=s,function(e){if((0,r.hasProperty)(e,"NetworkController")&&(0,r.isObject)(e.NetworkController)&&(0,r.hasProperty)(e.NetworkController,"networkId")){const t=e.NetworkController;return delete t.networkId,{...e,NetworkController:t}}var t,n;(0,r.isObject)(e.NetworkController)||null===(t=global.sentry)||void 0===t||null===(n=t.captureException)||void 0===n||n.call(t,new Error("typeof state.NetworkController is "+typeof e.NetworkController))}(t.data),t},n.version=void 0;var r=e("@metamask/utils"),i=e("lodash");const s=n.version=101}}},{package:"$root$",file:"app/scripts/migrations/101.ts"}],[199,{lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=i,function(e){const t=(null==e?void 0:e.TransactionController)||{},n=(null==t?void 0:t.transactions)||{};if((0,r.isEmpty)(n))return;const i=Object.keys(n).reduce(((e,t)=>{const i=(0,r.cloneDeep)(n[t]);return null!=i&&i.err&&(i.error=i.err,delete i.err),{...e,[t]:i}}),{});e.TransactionController={...t,transactions:i}}(t.data),t},n.version=void 0;var r=e("lodash");const i=n.version=102}}},{package:"$root$",file:"app/scripts/migrations/102.ts"}],[1998,{"@metamask/eth-sig-util":1133},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){r===undefined&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===undefined&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(n,"__esModule",{value:!0}),n.transformTypedData=void 0;const o=s(e("@metamask/eth-sig-util"));function a(e){switch(Object.prototype.toString.call(e)){case"[object Object]":{const t=Object.keys(e).map((t=>[t,a(e[t])]));return Object.fromEntries(t)}case"[object Array]":return e.map((e=>a(e)));case"[object BigInt]":return e.toString();default:return e}}n.transformTypedData=(e,t)=>{if(!t)throw new Error("Trezor: Only version 4 of typed data signing is supported");const n=o.SignTypedDataVersion.V4,{types:r,primaryType:i,domain:s,message:l}=o.TypedDataUtils.sanitizeData(e),c=o.TypedDataUtils.hashStruct("EIP712Domain",a(s),r,n).toString("hex");let u=null;return"EIP712Domain"!==i&&(u=o.TypedDataUtils.hashStruct(i,a(l),r,n).toString("hex")),Object.assign({domain_separator_hash:c,message_hash:u},e)},n.default=n.transformTypedData}}},{package:"@metamask/eth-trezor-keyring>@trezor/connect-plugin-ethereum",file:"node_modules/@trezor/connect-plugin-ethereum/lib/index.js"}],[1999,{"@trezor/connect/lib/exports":2025},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.parseConnectSettings=n.getEnv=void 0;const r=e("@trezor/connect/lib/exports");n.getEnv=()=>{var e;if("undefined"!=typeof chrome&&void 0!==(null===(e=chrome.runtime)||void 0===e?void 0:e.onConnect))return"webextension";if("undefined"!=typeof navigator){if("string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase())return"react-native";if(navigator.userAgent.toLowerCase().indexOf(" electron/")>-1)return"electron"}return"web"};n.parseConnectSettings=(e={})=>{var t;const i=Object.assign({popup:!0},e);let s;if("undefined"!=typeof window?s=window.__TREZOR_CONNECT_SRC:"undefined"!=typeof global&&(s=global.__TREZOR_CONNECT_SRC),"string"==typeof s&&(i.connectSrc=s,i.debug=!0),"undefined"!=typeof window&&"string"==typeof(null===(t=window.location)||void 0===t?void 0:t.search)){const e=window.location.search.split("&").find((e=>e.indexOf("trezor-connect-src")>=0));if(e){const[,t]=e.split("=");i.connectSrc=decodeURIComponent(t),i.debug=!0}}return"string"!=typeof e.env&&(i.env=(0,n.getEnv)()),(0,r.parseConnectSettings)(i)}}}},{package:"@trezor/connect-web",file:"node_modules/@trezor/connect-web/lib/connectSettings.js"}],[20,{"../../../../shared/constants/permissions":4008,reselect:3766},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.getPermittedAccountsByOrigin=n.getChangedAccounts=void 0;var r=e("reselect"),i=e("../../../../shared/constants/permissions");n.getPermittedAccountsByOrigin=(0,r.createSelector)((e=>e.subjects),(e=>Object.values(e).reduce(((e,t)=>{var n;const r=((null===(n=t.permissions)||void 0===n||null===(n=n.eth_accounts)||void 0===n?void 0:n.caveats)||[]).find((({type:e})=>e===i.CaveatTypes.restrictReturnedAccounts));return r&&e.set(t.origin,r.value),e}),new Map)));n.getChangedAccounts=(e,t)=>{if(t===undefined)return e;const n=new Map;if(e===t)return n;const r=new Set([...e.keys()]);for(const i of t.keys()){const s=e.get(i)??[];t.get(i)!==s&&n.set(i,s),r.delete(i)}for(const t of r.keys())n.set(t,e.get(t));return n}}}},{package:"$root$",file:"app/scripts/controllers/permissions/selectors.js"}],[200,{"../../../shared/constants/hardware-wallets":4001,"@metamask/utils":1806,lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,i.cloneDeep)(e);return t.meta.version=o,t.data=function(e){if((0,r.hasProperty)(e,"PreferencesController")&&(0,r.isObject)(e.PreferencesController)&&window.navigator.userAgent.includes("Chrome")){const t=e.PreferencesController;return t.ledgerTransportType=s.LedgerTransportTypes.webhid,{...e,PreferencesController:t}}return e}(t.data),t},n.version=void 0;var r=e("@metamask/utils"),i=e("lodash"),s=e("../../../shared/constants/hardware-wallets");const o=n.version=103}}},{package:"$root$",file:"app/scripts/migrations/103.ts"}],[2e3,{"./inlineStyles":2001,"@trezor/connect/lib/exports":2025,"@trezor/connect/lib/utils/urlUtils":2044,"@trezor/utils":2065,tslib:3897},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.clearTimeout=n.postMessage=n.init=n.dispose=n.messagePromises=n.error=n.timeout=n.initPromise=n.origin=n.instance=void 0;const r=e("tslib"),i=e("@trezor/utils"),s=e("@trezor/connect/lib/exports"),o=e("@trezor/connect/lib/utils/urlUtils"),a=r.__importDefault(e("./inlineStyles"));n.initPromise=(0,i.createDeferred)(),n.timeout=0;let l=0;n.messagePromises={};n.dispose=()=>{if(n.instance&&n.instance.parentNode)try{n.instance.parentNode.removeChild(n.instance)}catch(e){}n.instance=null,n.timeout=0};n.init=async e=>{var t;n.initPromise=(0,i.createDeferred)();const r=document.getElementById("trezorconnect");let l;if(r?n.instance=r:(n.instance=document.createElement("iframe"),n.instance.frameBorder="0",n.instance.width="0px",n.instance.height="0px",n.instance.style.position="absolute",n.instance.style.display="none",n.instance.style.border="0px",n.instance.style.width="0px",n.instance.style.height="0px",n.instance.id="trezorconnect"),"web"===e.env){const t=e.manifest?JSON.stringify(e.manifest):"undefined",n=`version=${e.version}&manifest=${encodeURIComponent(btoa(JSON.stringify(t)))}`;l=`${e.iframeSrc}?${n}`}else l=e.iframeSrc;n.instance.setAttribute("src",l),e.webusb&&console.warn('webusb option is deprecated. use `transports: ["WebUsbTransport"] instead`'),(e.webusb||(null===(t=e.transports)||void 0===t?void 0:t.includes("WebUsbTransport")))&&n.instance.setAttribute("allow","usb"),n.origin=(0,o.getOrigin)(n.instance.src),n.timeout=window.setTimeout((()=>{n.initPromise.reject(s.ERRORS.TypedError("Init_IframeTimeout"))}),1e4);const c=()=>{var t,r;if(!n.instance)return void n.initPromise.reject(s.ERRORS.TypedError("Init_IframeBlocked"));try{const e=null===(t=n.instance.contentWindow)||void 0===t?void 0:t.location.origin;if(!e||"null"===e)return window.clearTimeout(n.timeout),n.error=s.ERRORS.TypedError("Init_IframeBlocked"),(0,n.dispose)(),void n.initPromise.reject(n.error)}catch(e){}let i;"undefined"!=typeof chrome&&chrome.runtime&&void 0!==chrome.runtime.onConnect&&(chrome.runtime.onConnect.addListener((()=>{})),i=chrome.runtime.id),null===(r=n.instance.contentWindow)||void 0===r||r.postMessage({type:s.IFRAME.INIT,payload:{settings:e,extension:i}},n.origin),n.instance.onload=null};n.instance.attachEvent?n.instance.attachEvent("onload",c):n.instance.onload=c,document.body&&(document.body.appendChild(n.instance),(()=>{if(!n.instance)throw s.ERRORS.TypedError("Init_IframeBlocked");const e=n.instance.ownerDocument,t=e.head||e.getElementsByTagName("head")[0],r=document.createElement("style");r.setAttribute("type","text/css"),r.setAttribute("id","TrezorConnectStylesheet"),r.styleSheet?(r.styleSheet.cssText=a.default,t.appendChild(r)):(r.appendChild(document.createTextNode(a.default)),t.append(r))})());try{await n.initPromise.promise}catch(e){throw n.instance&&(n.instance.parentNode&&n.instance.parentNode.removeChild(n.instance),n.instance=null),e}finally{window.clearTimeout(n.timeout),n.timeout=0}};n.postMessage=(e,t=!0)=>{var r,o;if(!n.instance)throw s.ERRORS.TypedError("Init_IframeBlocked");if(t){l++,e.id=l,n.messagePromises[l]=(0,i.createDeferred)();const{promise:t}=n.messagePromises[l];return null===(r=n.instance.contentWindow)||void 0===r||r.postMessage(e,n.origin),t}return null===(o=n.instance.contentWindow)||void 0===o||o.postMessage(e,n.origin),null};n.clearTimeout=()=>{window.clearTimeout(n.timeout)}}}},{package:"@trezor/connect-web",file:"node_modules/@trezor/connect-web/lib/iframe/index.js"}],[2001,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default='.trezorconnect-container{position:fixed!important;display:-webkit-box!important;display:-webkit-flex!important;display:-ms-flexbox!important;display:flex!important;-webkit-box-orient:vertical!important;-webkit-box-direction:normal!important;-webkit-flex-direction:column!important;-ms-flex-direction:column!important;flex-direction:column!important;-webkit-box-align:center!important;-webkit-align-items:center!important;-ms-flex-align:center!important;align-items:center!important;z-index:10000!important;width:100%!important;height:100%!important;top:0!important;left:0!important;background:rgba(0,0,0,.35)!important;overflow:auto!important;padding:20px!important;margin:0!important}.trezorconnect-container .trezorconnect-window{position:relative!important;display:block!important;width:370px!important;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif!important;margin:auto!important;border-radius:3px!important;background-color:#fff!important;text-align:center!important;overflow:hidden!important}.trezorconnect-container .trezorconnect-window .trezorconnect-head{text-align:left;padding:12px 24px!important;display:-webkit-box!important;display:-webkit-flex!important;display:-ms-flexbox!important;display:flex!important;-webkit-box-align:center!important;-webkit-align-items:center!important;-ms-flex-align:center!important;align-items:center!important}.trezorconnect-container .trezorconnect-window .trezorconnect-head .trezorconnect-logo{-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1}.trezorconnect-container .trezorconnect-window .trezorconnect-head .trezorconnect-close{cursor:pointer!important;height:24px!important}.trezorconnect-container .trezorconnect-window .trezorconnect-head .trezorconnect-close svg{fill:#757575;-webkit-transition:fill .3s ease-in-out!important;transition:fill .3s ease-in-out!important}.trezorconnect-container .trezorconnect-window .trezorconnect-head .trezorconnect-close:hover svg{fill:#494949}.trezorconnect-container .trezorconnect-window .trezorconnect-body{padding:24px 24px 32px!important;background:#FBFBFB!important;border-top:1px solid #EBEBEB}.trezorconnect-container .trezorconnect-window .trezorconnect-body h3{color:#505050!important;font-size:16px!important;font-weight:500!important}.trezorconnect-container .trezorconnect-window .trezorconnect-body p{margin:8px 0 24px!important;font-weight:400!important;color:#A9A9A9!important;font-size:12px!important}.trezorconnect-container .trezorconnect-window .trezorconnect-body button{width:100%!important;padding:12px 24px!important;margin:0!important;border-radius:3px!important;font-size:14px!important;font-weight:300!important;cursor:pointer!important;background:#01B757!important;color:#fff!important;border:0!important;-webkit-transition:background-color .3s ease-in-out!important;transition:background-color .3s ease-in-out!important}.trezorconnect-container .trezorconnect-window .trezorconnect-body button:hover{background-color:#00AB51!important}.trezorconnect-container .trezorconnect-window .trezorconnect-body button:active{background-color:#009546!important}/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImlucHV0IiwiJHN0ZGluIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQWNBLHlCQUNJLFNBQUEsZ0JBQ0EsUUFBQSxzQkFDQSxRQUFBLHVCQUNBLFFBQUEsc0JBRUEsUUFBQSxlQUNBLG1CQUFBLG1CQUNBLHNCQUFBLGlCQUNBLHVCQUFBLGlCQUNBLG1CQUFBLGlCQUNBLGVBQUEsaUJBRUEsa0JBQUEsaUJBQ0Esb0JBQUEsaUJBQ0EsZUFBQSxpQkNmTSxZQUFhLGlCREFyQixRQUFTLGdCQWtCSCxNQUFBLGVBQ0EsT0FBQSxlQUNBLElBQUEsWUFDQSxLQUFBLFlBQ0EsV0FBQSwwQkFDQSxTQUFBLGVBQ0EsUUFBQSxlQUNBLE9BQUEsWUNkUiwrQ0RYRSxTQUFVLG1CQTZCQSxRQUFBLGdCQUNBLE1BQUEsZ0JBQ0EsWUFBQSxjQUFBLG1CQUFBLFdBQUEsT0FBQSxpQkFBQSxNQUFBLHFCQUNBLE9BQUEsZUNmVixjQUFlLGNEakJmLGlCQWlCRSxlQWtCWSxXQUFBLGlCQ2ZkLFNBQVUsaUJEbUJJLG1FQUNBLFdBQUEsS0NoQmQsUUFBUyxLQUFLLGVEeEJkLFFBQVMsc0JBMENTLFFBQUEsdUJBQ0EsUUFBQSxzQkNmbEIsUUFBUyxlRGlCSyxrQkE1QlosaUJBOEJvQixvQkFBQSxpQkNoQmxCLGVBQWdCLGlCRC9CWixZQWlCTixpQkFzQ1EsdUZBQ0EsaUJBQUEsRUNwQlYsYUFBYyxFRHBDVixTQUFVLEVBMkRBLEtBQUEsRUFFQSx3RkNwQmQsT0FBUSxrQkR6Q1IsT0FBUSxlQWlFTSw0RkFDQSxLQUFBLFFBQ0EsbUJBQUEsS0FBQSxJQUFBLHNCQ3BCZCxXQUFZLEtBQUssSUFBSyxzQkR3QlIsa0dBQ0EsS0FBQSxRQUVBLG1FQUNBLFFBQUEsS0FBQSxLQUFBLGVBQ0EsV0FBQSxrQkFDQSxXQUFBLElBQUEsTUFBQSxRQUVBLHNFQUNBLE1BQUEsa0JBQ0EsVUFBQSxlQ3JCZCxZQUFhLGNEd0JLLHFFQ3JCbEIsT0FBUSxJQUFJLEVBQUksZUR3QkYsWUFBQSxjQUNJLE1BQUEsa0JDdEJsQixVQUFXLGVBRWIsMEVBQ0UsTUFBTyxlQUNQLFFBQVMsS0FBSyxlQUNkLE9BQVEsWUFDUixjQUFlLGNBQ2YsVUFBVyxlQUNYLFlBQWEsY0FDYixPQUFRLGtCQUNSLFdBQVksa0JBQ1osTUFBTyxlQUNQLE9BQVEsWUFDUixtQkFBb0IsaUJBQWlCLElBQUssc0JBQzFDLFdBQVksaUJBQWlCLElBQUssc0JBRXBDLGdGQUNFLGlCQUFrQixrQkFFcEIsaUZBQ0UsaUJBQWtCIn0= */'}}},{package:"@trezor/connect-web",file:"node_modules/@trezor/connect-web/lib/iframe/inlineStyles.js"}],[2002,{"./connectSettings":1999,"./iframe":2e3,"./popup":2003,"./webusb/button":2005,"@trezor/connect/lib/data/config":2011,"@trezor/connect/lib/exports":2025,"@trezor/connect/lib/factory":2026,"@trezor/connect/lib/utils/debug":2043,events:2788,tslib:3897},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});const r=e("tslib"),i=r.__importDefault(e("events")),s=e("@trezor/connect/lib/exports"),o=e("@trezor/connect/lib/factory"),a=e("@trezor/connect/lib/utils/debug"),l=e("@trezor/connect/lib/data/config"),c=r.__importStar(e("./iframe")),u=r.__importStar(e("./popup")),d=r.__importDefault(e("./webusb/button")),h=e("./connectSettings"),f=new i.default,p=(0,a.initLog)("@trezor/connect");let m,g=(0,h.parseConnectSettings)();const v=()=>{const e=new u.PopupManager(g);return e.on(s.POPUP.CLOSED,(e=>{c.postMessage({type:s.POPUP.CLOSED,payload:e?{error:e}:null},!1)})),e},b=()=>(f.removeAllListeners(),c.dispose(),g=(0,h.parseConnectSettings)(),m&&m.close(),Promise.resolve(undefined)),w=e=>{if(e.origin!==c.origin)return;const t=(0,s.parseMessage)(e.data),n=t.id||0;switch(p.log("handleMessage",t),t.event){case s.RESPONSE_EVENT:c.messagePromises[n]?(c.messagePromises[n].resolve({id:n,success:t.success,payload:t.payload}),delete c.messagePromises[n]):p.warn(`Unknown message id ${n}`);break;case s.DEVICE_EVENT:case s.TRANSPORT_EVENT:case s.BLOCKCHAIN_EVENT:f.emit(t.event,t),f.emit(t.type,t.payload);break;case s.UI_EVENT:if(t.type===s.IFRAME.BOOTSTRAP){c.clearTimeout();break}t.type===s.IFRAME.LOADED&&c.initPromise.resolve(),t.type===s.IFRAME.ERROR&&c.initPromise.reject(t.payload.error),f.emit(t.event,t),f.emit(t.type,t.payload);break;default:p.log("Undefined message",t.event,e)}},y=async(e={})=>{var t;if(c.instance)throw s.ERRORS.TypedError("Init_AlreadyInitialized");if(g=(0,h.parseConnectSettings)(Object.assign(Object.assign({},g),e)),!g.manifest)throw s.ERRORS.TypedError("Init_ManifestMissing");(null===(t=g.transports)||void 0===t?void 0:t.length)||(g.transports=["BridgeTransport","WebUsbTransport"]),g.lazyLoad?g.lazyLoad=!1:(m||(m=v()),p.enabled=!!g.debug,window.addEventListener("message",w),window.addEventListener("unload",b),await c.init(g))},_=async e=>{if(!c.instance&&!c.timeout){if(g=(0,h.parseConnectSettings)(g),!g.manifest)return(0,s.createErrorMessage)(s.ERRORS.TypedError("Init_ManifestMissing"));m||(m=v()),m.request(!0);try{await y(g)}catch(e){return m&&(["Init_IframeBlocked","Init_IframeTimeout"].includes(e.code)?m.postMessage((0,s.createUiMessage)(s.UI.IFRAME_FAILURE)):m.close()),(0,s.createErrorMessage)(e)}}if(c.timeout)return(0,s.createErrorMessage)(s.ERRORS.TypedError("Init_ManifestMissing"));if(c.error)return(0,s.createErrorMessage)(c.error);g.popup&&m&&m.request();try{const t=await c.postMessage({type:s.IFRAME.CALL,payload:e});return t?(!t.success&&"Device_CallInProgress"!==t.payload.code&&m&&m.unlock(),t):(m&&m.unlock(),(0,s.createErrorMessage)(s.ERRORS.TypedError("Method_NoResponse")))}catch(e){return p.error("__call error",e),m&&m.close(),(0,s.createErrorMessage)(e)}},S=(0,o.factory)({eventEmitter:f,manifest:e=>{g=(0,h.parseConnectSettings)(Object.assign(Object.assign({},g),{manifest:e}))},init:y,call:_,requestLogin:async e=>{if("function"==typeof e.callback){const{callback:t}=e,n=async e=>{const{data:n}=e;if(n&&n.type===s.UI.LOGIN_CHALLENGE_REQUEST)try{const e=await t();c.postMessage({event:s.UI_EVENT,type:s.UI.LOGIN_CHALLENGE_RESPONSE,payload:e})}catch(e){c.postMessage({event:s.UI_EVENT,type:s.UI.LOGIN_CHALLENGE_RESPONSE,payload:e.message})}};window.addEventListener("message",n,!1);const r=await _(Object.assign(Object.assign({method:"requestLogin"},e),{asyncChallenge:!0,callback:null}));return window.removeEventListener("message",n),r}return _(Object.assign({method:"requestLogin"},e))},uiResponse:e=>{if(!c.instance)throw s.ERRORS.TypedError("Init_NotInitialized");const{type:t,payload:n}=e;c.postMessage({event:s.UI_EVENT,type:t,payload:n})},renderWebUSBButton:e=>{(0,d.default)(e,g.webusbSrc)},disableWebUSB:()=>{if(!c.instance)throw s.ERRORS.TypedError("Init_NotInitialized");c.postMessage({event:s.UI_EVENT,type:s.TRANSPORT.DISABLE_WEBUSB})},requestWebUSBDevice:async()=>{try{await window.navigator.usb.requestDevice({filters:l.config.webusb}),c.postMessage({event:s.UI_EVENT,type:s.TRANSPORT.REQUEST_DEVICE})}catch(e){}},cancel:e=>{m&&m.emit(s.POPUP.CLOSED,e)},dispose:b});n.default=S,r.__exportStar(e("@trezor/connect/lib/exports"),n)}}},{package:"@trezor/connect-web",file:"node_modules/@trezor/connect-web/lib/index.js"}],[2003,{"./showPopupRequest":2004,"@trezor/connect/lib/exports":2025,"@trezor/connect/lib/utils/urlUtils":2044,"@trezor/utils":2065,events:2788,tslib:3897},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.PopupManager=void 0;const r=e("tslib").__importDefault(e("events")),i=e("@trezor/utils"),s=e("@trezor/connect/lib/exports"),o=e("@trezor/connect/lib/utils/urlUtils"),a=e("./showPopupRequest");class l extends r.default{constructor(e){super(),this.locked=!1,this.requestTimeout=0,this.closeInterval=0,this.extensionTabId=0,this.settings=e,this.origin=(0,o.getOrigin)(e.popupSrc),this.handleMessage=this.handleMessage.bind(this),this.iframeHandshake=(0,i.createDeferred)(s.IFRAME.LOADED),"webextension"===this.settings.env&&(this.handleExtensionConnect=this.handleExtensionConnect.bind(this),this.handleExtensionMessage=this.handleExtensionMessage.bind(this),chrome.runtime.onConnect.addListener(this.handleExtensionConnect)),window.addEventListener("message",this.handleMessage,!1)}request(e=!1){if(this.locked)return void(this.popupWindow&&("webextension"===this.settings.env?chrome.tabs.update(this.popupWindow.id,{active:!0}):this.popupWindow.focus()));const t=this.open.bind(this);this.locked=!0;const n=e||"webextension"===this.settings.env?1:850;this.requestTimeout=window.setTimeout((()=>{this.requestTimeout=0,t(e)}),n)}cancel(){this.close()}unlock(){this.locked=!1}open(e){const t=this.settings.popupSrc;this.popupPromise=(0,i.createDeferred)(s.POPUP.LOADED),this.openWrapper(e?`${t}#loading`:t),this.closeInterval=window.setInterval((()=>{this.popupWindow&&("webextension"===this.settings.env?chrome.tabs.get(this.popupWindow.id,(e=>{e||(this.close(),this.emit(s.POPUP.CLOSED))})):this.popupWindow.closed&&(this.close(),this.emit(s.POPUP.CLOSED)))}),500),this.openTimeout=setTimeout((()=>{this.close(),(0,a.showPopupRequest)(this.open.bind(this),(()=>{this.emit(s.POPUP.CLOSED)}))}),3e3)}openWrapper(e){"webextension"===this.settings.env?chrome.windows.getCurrent((t=>{"normal"!==t.type?chrome.windows.create({url:e},(e=>{chrome.tabs.query({windowId:null==e?void 0:e.id,active:!0},(e=>{this.popupWindow=e[0]}))})):chrome.tabs.query({currentWindow:!0,active:!0},(t=>{this.extensionTabId=t[0].id,chrome.tabs.create({url:e,index:t[0].index+1},(e=>{this.popupWindow=e}))}))})):"electron"===this.settings.env?this.popupWindow=window.open(e,"modal"):(this.popupWindow=window.open("","_blank"),this.popupWindow&&(this.popupWindow.location.href=e))}handleExtensionConnect(e){var t,n;"trezor-connect"===e.name&&(!this.popupWindow||this.popupWindow&&this.popupWindow.id!==(null===(n=null===(t=e.sender)||void 0===t?void 0:t.tab)||void 0===n?void 0:n.id)||(this.openTimeout&&clearTimeout(this.openTimeout),this.extensionPort=e,this.extensionPort.onMessage.addListener(this.handleExtensionMessage)))}handleExtensionMessage(e){if(!this.extensionPort)return;const t=this.extensionPort,{data:n}=e;if(n&&"object"==typeof n)if(n.type===s.POPUP.ERROR){const e=n.payload&&"string"==typeof n.payload.error?n.payload.error:null;this.emit(s.POPUP.CLOSED,e?`Popup error: ${e}`:null),this.close()}else n.type===s.POPUP.LOADED?(this.popupPromise&&this.popupPromise.resolve(),this.iframeHandshake.promise.then((e=>{t.postMessage({type:s.POPUP.INIT,payload:Object.assign(Object.assign({},e),{settings:this.settings})})}))):n.type===s.POPUP.EXTENSION_USB_PERMISSIONS?chrome.tabs.query({currentWindow:!0,active:!0},(e=>{chrome.tabs.create({url:"trezor-usb-permissions.html",index:e[0].index+1},(e=>{}))})):n.type===s.POPUP.CLOSE_WINDOW&&(this.emit(s.POPUP.CLOSED),this.close())}handleMessage(e){const{data:t}=e;if((0,o.getOrigin)(e.origin)===this.origin&&t&&"object"==typeof t)if(t.type===s.IFRAME.LOADED)this.iframeHandshake.resolve(t.payload);else if(t.type===s.POPUP.BOOTSTRAP)this.openTimeout&&clearTimeout(this.openTimeout);else if(t.type===s.POPUP.ERROR&&this.popupWindow){const e=t.payload&&"string"==typeof t.payload.error?t.payload.error:null;this.emit(s.POPUP.CLOSED,e?`Popup error: ${e}`:null),this.close()}else t.type===s.POPUP.LOADED?(this.popupPromise&&this.popupPromise.resolve(),this.iframeHandshake.promise.then((e=>{this.popupWindow.postMessage({type:s.POPUP.INIT,payload:Object.assign(Object.assign({},e),{settings:this.settings})},this.origin)}))):t.type!==s.POPUP.CANCEL_POPUP_REQUEST&&t.type!==s.UI.CLOSE_UI_WINDOW||this.close()}close(){if(this.locked=!1,this.popupPromise=undefined,this.requestTimeout&&(window.clearTimeout(this.requestTimeout),this.requestTimeout=0),this.openTimeout&&(clearTimeout(this.openTimeout),this.openTimeout=undefined),this.closeInterval&&(window.clearInterval(this.closeInterval),this.closeInterval=0),this.extensionPort&&(this.extensionPort.disconnect(),this.extensionPort=undefined),this.extensionTabId&&(chrome.tabs.update(this.extensionTabId,{active:!0}),this.extensionTabId=0),this.popupWindow){if("webextension"===this.settings.env){let e=chrome.runtime.lastError;chrome.tabs.remove(this.popupWindow.id,(()=>{e=chrome.runtime.lastError}))}else this.popupWindow.close();this.popupWindow=null}}async postMessage(e){if(!this.popupWindow&&e.type!==s.UI.REQUEST_UI_WINDOW&&this.openTimeout)return this.close(),void(0,a.showPopupRequest)(this.open.bind(this),(()=>{this.emit(s.POPUP.CLOSED)}));this.popupPromise&&await this.popupPromise.promise,this.popupWindow&&this.popupWindow.postMessage(e,this.origin)}}n.PopupManager=l}}},{package:"@trezor/connect-web",file:"node_modules/@trezor/connect-web/lib/popup/index.js"}],[2004,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.showPopupRequest=void 0;const r="TrezorConnectInteractionLayer",i=`\n    <div class="trezorconnect-container" id="${r}">\n        <div class="trezorconnect-window">\n            <div class="trezorconnect-head">\n                <svg class="trezorconnect-logo" x="0px" y="0px" viewBox="0 0 163.7 41.9" width="78px" height="20px" preserveAspectRatio="xMinYMin meet">\n                    <polygon points="101.1,12.8 118.2,12.8 118.2,17.3 108.9,29.9 118.2,29.9 118.2,35.2 101.1,35.2 101.1,30.7 110.4,18.1 101.1,18.1"/>\n                    <path d="M158.8,26.9c2.1-0.8,4.3-2.9,4.3-6.6c0-4.5-3.1-7.4-7.7-7.4h-10.5v22.3h5.8v-7.5h2.2l4.1,7.5h6.7L158.8,26.9z M154.7,22.5 h-4V18h4c1.5,0,2.5,0.9,2.5,2.2C157.2,21.6,156.2,22.5,154.7,22.5z"/>\n                    <path d="M130.8,12.5c-6.8,0-11.6,4.9-11.6,11.5s4.9,11.5,11.6,11.5s11.7-4.9,11.7-11.5S137.6,12.5,130.8,12.5z M130.8,30.3 c-3.4,0-5.7-2.6-5.7-6.3c0-3.8,2.3-6.3,5.7-6.3c3.4,0,5.8,2.6,5.8,6.3C136.6,27.7,134.2,30.3,130.8,30.3z"/>\n                    <polygon points="82.1,12.8 98.3,12.8 98.3,18 87.9,18 87.9,21.3 98,21.3 98,26.4 87.9,26.4 87.9,30 98.3,30 98.3,35.2 82.1,35.2 "/>\n                    <path d="M24.6,9.7C24.6,4.4,20,0,14.4,0S4.2,4.4,4.2,9.7v3.1H0v22.3h0l14.4,6.7l14.4-6.7h0V12.9h-4.2V9.7z M9.4,9.7 c0-2.5,2.2-4.5,5-4.5s5,2,5,4.5v3.1H9.4V9.7z M23,31.5l-8.6,4l-8.6-4V18.1H23V31.5z"/>\n                    <path d="M79.4,20.3c0-4.5-3.1-7.4-7.7-7.4H61.2v22.3H67v-7.5h2.2l4.1,7.5H80l-4.9-8.3C77.2,26.1,79.4,24,79.4,20.3z M71,22.5h-4V18 h4c1.5,0,2.5,0.9,2.5,2.2C73.5,21.6,72.5,22.5,71,22.5z"/>\n                    <polygon points="40.5,12.8 58.6,12.8 58.6,18.1 52.4,18.1 52.4,35.2 46.6,35.2 46.6,18.1 40.5,18.1 "/>\n                </svg>\n                <div class="trezorconnect-close">\n                    <svg x="0px" y="0px" viewBox="24 24 60 60" width="24px" height="24px" preserveAspectRatio="xMinYMin meet">\n                        <polygon class="st0" points="40,67.9 42.1,70 55,57.1 67.9,70 70,67.9 57.1,55 70,42.1 67.9,40 55,52.9 42.1,40 40,42.1 52.9,55 "/>\n                    </svg>\n                </div>\n            </div>\n            <div class="trezorconnect-body">\n                <h3>Popup was blocked</h3>\n                <p>Please click to "Continue" to open popup manually</p>\n                <button class="trezorconnect-open">Continue</button>\n            </div>\n        </div>\n    </div>\n`;n.showPopupRequest=(e,t)=>{if(document.getElementById(r))return;const n=document.createElement("div");n.id=r,n.className="trezorconnect-container",n.innerHTML=i,document.body&&document.body.appendChild(n);n.getElementsByClassName("trezorconnect-open")[0].onclick=()=>{e(),document.body&&document.body.removeChild(n)};n.getElementsByClassName("trezorconnect-close")[0].onclick=()=>{t(),document.body&&document.body.removeChild(n)}}}}},{package:"@trezor/connect-web",file:"node_modules/@trezor/connect-web/lib/popup/showPopupRequest.js"}],[2005,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});n.default=(e="",t)=>{const n=e||".trezor-webusb-button",r=document.querySelectorAll(n),i=`${t}?${Date.now()}`;r.forEach((e=>{if(e.getElementsByTagName("iframe").length<1){const t=e.getBoundingClientRect(),n=document.createElement("iframe");n.frameBorder="0",n.width=`${Math.round(t.width)}px`,n.height=`${Math.round(t.height)}px`,n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.zIndex="1",n.setAttribute("allow","usb"),n.setAttribute("scrolling","no"),n.src=i,e.append(n)}}))}}}},{package:"@trezor/connect-web",file:"node_modules/@trezor/connect-web/lib/webusb/button.js"}],[2006,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.NETWORK_IDS=n.PROTOCOL_MAGICS=void 0,function(e){e[e.mainnet=764824073]="mainnet",e[e.testnet_preprod=1]="testnet_preprod",e[e.testnet_preview=2]="testnet_preview",e[e.testnet_legacy=1097911063]="testnet_legacy"}(n.PROTOCOL_MAGICS||(n.PROTOCOL_MAGICS={})),function(e){e[e.mainnet=1]="mainnet",e[e.testnet=0]="testnet"}(n.NETWORK_IDS||(n.NETWORK_IDS={}))}}},{package:"@trezor/connect-web>@trezor/connect",file:"node_modules/@trezor/connect/lib/constants/cardano.js"}],[2007,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.LIBUSB_ERROR_MESSAGE=n.WEBUSB_ERROR_MESSAGE=n.INVALID_PIN_ERROR_MESSAGE=n.WRONG_PREVIOUS_SESSION_ERROR_MESSAGE=n.serializeError=n.TypedError=n.TrezorError=n.ERROR_CODES=void 0,n.ERROR_CODES={Init_NotInitialized:"TrezorConnect not initialized",Init_AlreadyInitialized:"TrezorConnect has been already initialized",Init_IframeBlocked:"Iframe blocked",Init_IframeTimeout:"Iframe timeout",Init_ManifestMissing:"Manifest not set. Read more at https://github.com/trezor/trezor-suite/blob/develop/docs/packages/connect/index.md",Popup_ConnectionMissing:"Unable to establish connection with iframe",Transport_Missing:"Transport is missing",Transport_InvalidProtobuf:"",Method_InvalidPackage:"This package is not suitable to work with browser. Use @trezor/connect-web package instead",Method_InvalidParameter:"",Method_NotAllowed:"Method not allowed for this configuration",Method_PermissionsNotGranted:"Permissions not granted",Method_Cancel:"Cancelled",Method_Interrupted:"Popup closed",Method_UnknownCoin:"Coin not found",Method_AddressNotMatch:"Addresses do not match",Method_FirmwareUpdate_DownloadFailed:"Failed to download firmware binary",Method_Discovery_BundleException:"",Method_Override:"override",Method_NoResponse:"Call resolved without response",Backend_NotSupported:"BlockchainLink settings not found in coins.json",Backend_WorkerMissing:"",Backend_Disconnected:"Backend disconnected",Backend_Invalid:"Invalid backend",Backend_Error:"",Runtime:"",Device_NotFound:"Device not found",Device_InitializeFailed:"",Device_FwException:"",Device_ModeException:"",Device_Disconnected:"Device disconnected",Device_UsedElsewhere:"Device is used in another window",Device_InvalidState:"Passphrase is incorrect",Device_CallInProgress:"Device call in progress"};class r extends Error{constructor(e,t){super(t),this.code=e,this.message=t}}n.TrezorError=r;n.TypedError=(e,t)=>new r(e,t||n.ERROR_CODES[e]);n.serializeError=e=>e&&e.error instanceof Error?{error:e.error.message,code:e.error.code}:e,n.WRONG_PREVIOUS_SESSION_ERROR_MESSAGE="wrong previous session",n.INVALID_PIN_ERROR_MESSAGE="PIN invalid",n.WEBUSB_ERROR_MESSAGE="NetworkError: Unable to claim interface.",n.LIBUSB_ERROR_MESSAGE="LIBUSB_ERROR"}}},{package:"@trezor/connect-web>@trezor/connect",file:"node_modules/@trezor/connect/lib/constants/errors.js"}],[2008,{"./cardano":2006,"./errors":2007,"./nem":2009,"./network":2010,"@trezor/transport/lib/types/messages":2047,tslib:2045},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.PROTO=n.NEM=n.CARDANO=n.NETWORK=n.ERRORS=void 0;const r=e("tslib");n.ERRORS=r.__importStar(e("./errors")),n.NETWORK=r.__importStar(e("./network")),n.CARDANO=r.__importStar(e("./cardano")),n.NEM=r.__importStar(e("./nem")),n.PROTO=r.__importStar(e("@trezor/transport/lib/types/messages"))}}},{package:"@trezor/connect-web>@trezor/connect",file:"node_modules/@trezor/connect/lib/constants/index.js"}],[2009,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.TxVersion=n.TxType=n.Networks=void 0,function(e){e[e.mainnet=104]="mainnet",e[e.testnet=152]="testnet",e[e.mijin=96]="mijin"}(n.Networks||(n.Networks={})),function(e){e[e.TRANSFER=257]="TRANSFER",e[e.COSIGNING=258]="COSIGNING",e[e.IMPORTANCE_TRANSFER=2049]="IMPORTANCE_TRANSFER",e[e.AGGREGATE_MODIFICATION=4097]="AGGREGATE_MODIFICATION",e[e.MULTISIG_SIGNATURE=4098]="MULTISIG_SIGNATURE",e[e.MULTISIG=4100]="MULTISIG",e[e.PROVISION_NAMESPACE=8193]="PROVISION_NAMESPACE",e[e.MOSAIC_CREATION=16385]="MOSAIC_CREATION",e[e.SUPPLY_CHANGE=16386]="SUPPLY_CHANGE"}(n.TxType||(n.TxType={})),function(e){e[e.mainnet=1744830464]="mainnet",e[e.testnet=-1744830464]="testnet",e[e.mijin=1610612736]="mijin"}(n.TxVersion||(n.TxVersion={}))}}},{package:"@trezor/connect-web>@trezor/connect",file:"node_modules/@trezor/connect/lib/constants/nem.js"}],[201,{lodash:3355},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.migrate=async function(e){const t=(0,r.cloneDeep)(e);return t.meta.version=i,function(e){const t=null==e?void 0:e.TransactionController;if(!t)return;const n=(null==t?void 0:t.transactions)||{},r=Object.values(n).sort(((e,t)=>e.time>t.time?-1:1));e.TransactionController={...t,transactions:r}}(t.data),t},n.version=void 0;var r=e("lodash");const i=n.version=104}}},{package:"$root$",file:"app/scripts/migrations/104.ts"}],[2010,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.TYPES=void 0,n.TYPES={bitcoin:"Bitcoin",ethereum:"Ethereum",eos:"Eos",nem:"NEM",stellar:"Stellar",cardano:"Cardano",ripple:"Ripple",tezos:"Tezos",binance:"Binance"}}}},{package:"@trezor/connect-web>@trezor/connect",file:"node_modules/@trezor/connect/lib/constants/network.js"}],[2011,{"@trezor/transport/lib/constants":2046},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.config=void 0;const r=e("@trezor/transport/lib/constants");n.config={webusb:r.TREZOR_DESCS,whitelist:[{origin:"chrome-extension://imloifkgjagghnncjkhggdhalmcnfklk",priority:1},{origin:"chrome-extension://niebkpllfhmpfbffbfifagfgoamhpflf",priority:1},{origin:"file://",priority:2},{origin:"trezor.io",priority:0},{origin:"sldev.cz",priority:0},{origin:"localhost",priority:0},{origin:"trezoriovpjcahpzkrewelclulmszwbqpzmzgub37gbcjlvluxtruqad.onion",priority:0}],management:[{origin:"trezor.io"},{origin:"sldev.cz"},{origin:"localhost"}],knownHosts:[{origin:"imloifkgjagghnncjkhggdhalmcnfklk",label:"Trezor Password Manager (Develop)",icon:""},{origin:"niebkpllfhmpfbffbfifagfgoamhpflf",label:"Trezor Password Manager",icon:""},{origin:"trezor-connect@trezor.io",label:"Trezor Connect FF Extension",icon:""},{origin:"efbfhenfhihgdcmnfdkhaphjdnopihlf",label:"Trezor Connect Chrome Extension",icon:""},{origin:"mnpfhpndmjholfdlhpkjfmjkgppmodaf",label:"MetaMask",icon:""},{origin:"webextension@metamask.io",label:"MetaMask",icon:""},{origin:"file://",label:" ",icon:""}],onionDomains:{"trezor.io":"trezoriovpjcahpzkrewelclulmszwbqpzmzgub37gbcjlvluxtruqad.onion"},assets:[{name:"coins",url:"./data/coins.json"},{name:"bridge",url:"./data/bridge/releases.json"},{name:"firmware-t1",url:"./data/firmware/1/releases.json"},{name:"firmware-t2",url:"./data/firmware/2/releases.json"}],messages:"./data/messages/messages.json",supportedBrowsers:{chrome:{version:59,download:"https://www.google.com/chrome/",update:"https://support.google.com/chrome/answer/95414"},chromium:{version:59,download:"https://www.chromium.org/",update:"https://www.chromium.org/"},electron:{version:0,download:"https://www.electronjs.org/",update:"https://www.electronjs.org/"},firefox:{version:54,download:"https://www.mozilla.org/en-US/firefox/new/",update:"https://support.mozilla.org/en-US/kb/update-firefox-latest-version"}},supportedFirmware:[{coin:["xrp","txrp"],methods:["getAccountInfo"],min:["0","2.1.0"],max:undefined,comment:["Since firmware 2.1.0 there is a new protobuf field 'destination_tag' in RippleSignTx"]},{coin:["bnb"],min:["1.9.0","2.3.0"],comment:["There were protobuf backwards incompatible changes with introduction of 1.9.0/2.3.0 firmwares"]},{coin:["eth","tgor"],min:["1.8.0","2.1.0"],comment:["There were protobuf backwards incompatible changes."]},{methods:["rippleGetAddress","rippleSignTransaction"],min:["0","2.1.0"],comment:["Since firmware 2.1.0 there is a new protobuf field 'destination_tag' in RippleSignTx"]},{methods:["cardanoGetAddress","cardanoGetPublicKey"],min:["0","2.3.2"],comment:["Shelley fork support since firmware 2.3.2"]},{methods:["cardanoSignTransaction"],min:["0","2.4.2"],comment:["Non-streamed signing no longer supported"]},{methods:["cardanoGetNativeScriptHash"],min:["0","2.4.3"],comment:["Cardano GetNativeScriptHash call added in 2.4.3"]},{methods:["tezosSignTransaction"],min:["0","2.1.8"],comment:["Since 2.1.8 there are new protobuf fields in tezos transaction (Babylon fork)"]},{methods:["stellarSignTransaction"],min:["1.9.0","2.3.0"],comment:["There were protobuf backwards incompatible changes with introduction of 1.9.0/2.3.0 firmwares"]},{capabilities:["replaceTransaction","amountUnit"],min:["1.9.4","2.3.5"],comment:["new sign tx process since 1.9.4/2.3.5"]},{capabilities:["decreaseOutput"],min:["1.10.0","2.4.0"],comment:["allow reduce output in RBF transaction since 1.10.0/2.4.0"]},{capabilities:["eip1559"],min:["1.10.4","2.4.2"],comment:["new eth transaction pricing mechanism (EIP1559) since 1.10.4/2.4.2"]},{capabilities:["taproot","signMessageNoScriptType"],min:["1.10.4","2.4.3"],comment:["new btc accounts taproot since 1.10.4/2.4.3 (BTC + TEST only)","SignMessage with no_script_type support"]},{coin:["dcr","tdcr"],methods:["signTransaction"],min:["1.10.1","2.4.0"],comment:[""]},{methods:["ethereumSignTypedData"],min:["1.10.5","2.4.3"],comment:["EIP-712 typed signing support added in 1.10.5/2.4.3"]},{capabilities:["eip712-domain-only"],min:["1.10.6","2.4.4"],comment:["EIP-712 domain-only signing, when primaryType=EIP712Domain"]},{capabilities:["coinjoin"],methods:["authorizeCoinjoin","getOwnershipId","getOwnershipProof","setBusy","unlockPath"],min:["1.12.1","2.5.3"]}]}}}},{package:"@trezor/connect-web>@trezor/connect",file:"node_modules/@trezor/connect/lib/data/config.js"}],[2012,{"./version":2013},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.parseConnectSettings=n.corsValidator=n.DEFAULT_PRIORITY=void 0;const r=e("./version");n.DEFAULT_PRIORITY=2;const i={configSrc:"./data/config.json",version:r.VERSION,debug:!1,priority:n.DEFAULT_PRIORITY,trustedHost:!0,connectSrc:r.DEFAULT_DOMAIN,iframeSrc:`${r.DEFAULT_DOMAIN}iframe.html`,popup:!1,popupSrc:`${r.DEFAULT_DOMAIN}popup.html`,webusbSrc:`${r.DEFAULT_DOMAIN}webusb.html`,transports:undefined,pendingTransportEvent:!0,env:"node",lazyLoad:!1,timestamp:(new Date).getTime(),interactionTimeout:600};n.corsValidator=e=>{if("string"==typeof e)return e.match(/^https:\/\/([A-Za-z0-9\-_]+\.)*trezor\.io\//)||e.match(/^https?:\/\/localhost:[58][0-9]{3}\//)||e.match(/^https:\/\/([A-Za-z0-9\-_]+\.)*sldev\.cz\//)||e.match(/^https?:\/\/([A-Za-z0-9\-_]+\.)*trezoriovpjcahpzkrewelclulmszwbqpzmzgub37gbcjlvluxtruqad\.onion\//)?e:void 0};n.parseConnectSettings=(e={})=>{var t;const s={...i};"debug"in e&&("boolean"==typeof e.debug?s.debug=e.debug:"string"==typeof e.debug&&(s.debug="true"===e.debug)),"string"==typeof e.connectSrc&&(null===(t=e.connectSrc)||void 0===t?void 0:t.startsWith("http"))?s.connectSrc=(0,n.corsValidator)(e.connectSrc):s.trustedHost&&(s.connectSrc=e.connectSrc);const o=s.connectSrc||r.DEFAULT_DOMAIN;return s.iframeSrc=`${o}iframe.html`,s.popupSrc=`${o}popup.html`,s.webusbSrc=`${o}webusb.html`,"boolean"==typeof e.transportReconnect&&(s.transportReconnect=e.transportReconnect),"boolean"==typeof e.webusb&&(s.webusb=e.webusb),Array.isArray(e.transports)&&(s.transports=e.transports),"boolean"==typeof e.popup&&(s.popup=e.popup),"boolean"==typeof e.lazyLoad&&(s.lazyLoad=e.lazyLoad),"boolean"==typeof e.pendingTransportEvent&&(s.pendingTransportEvent=e.pendingTransportEvent),"string"==typeof e.extension&&(s.extension=e.extension),"string"==typeof e.env&&(s.env=e.env),"number"==typeof e.timestamp&&(s.timestamp=e.timestamp),"number"==typeof e.interactionTimeout&&(s.interactionTimeout=e.interactionTimeout),"object"==typeof e.manifest&&(s.manifest=(e=>{if(e&&"string"==typeof e.email&&"string"==typeof e.appUrl)return{email:e.email,appUrl:e.appUrl}})(e.manifest)),s}}}},{package:"@trezor/connect-web>@trezor/connect",file:"node_modules/@trezor/connect/lib/data/connectSettings.js"}],[2013,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.DEFAULT_DOMAIN=n.VERSION=void 0,n.VERSION="9.0.11";const r=n.VERSION.split(".").map((e=>parseInt(e,10)));n.DEFAULT_DOMAIN=`https://connect.trezor.io/${r[0]}/`}}},{package:"@trezor/connect-web>@trezor/connect",file:"node_modules/@trezor/connect/lib/data/version.js"}],[2014,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createBlockchainMessage=n.BLOCKCHAIN=n.BLOCKCHAIN_EVENT=void 0,n.BLOCKCHAIN_EVENT="BLOCKCHAIN_EVENT",n.BLOCKCHAIN={CONNECT:"blockchain-connect",ERROR:"blockchain-error",BLOCK:"blockchain-block",NOTIFICATION:"blockchain-notification",FIAT_RATES_UPDATE:"fiat-rates-update"};n.createBlockchainMessage=(e,t)=>({event:n.BLOCKCHAIN_EVENT,type:e,payload:t})}}},{package:"@trezor/connect-web>@trezor/connect",file:"node_modules/@trezor/connect/lib/events/blockchain.js"}],[2015,{"../constants/errors":2007},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createResponseMessage=n.RESPONSE_EVENT=void 0;const r=e("../constants/errors");n.RESPONSE_EVENT="RESPONSE_EVENT";n.createResponseMessage=(e,t,i)=>({event:n.RESPONSE_EVENT,type:n.RESPONSE_EVENT,id:e,success:t,payload:t?i:(0,r.serializeError)(i)})}}},{package:"@trezor/connect-web>@trezor/connect",file:"node_modules/@trezor/connect/lib/events/call.js"}],[2016,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createErrorMessage=n.parseMessage=n.CORE_EVENT=void 0,n.CORE_EVENT="CORE_EVENT";n.parseMessage=e=>{const t={event:e.event,type:e.type,payload:e.payload};return"number"==typeof e.id&&(t.id=e.id),"boolean"==typeof e.success&&(t.success=e.success),t};n.createErrorMessage=e=>({success:!1,payload:{error:e.message,code:e.code}})}}},{package:"@trezor/connect-web>@trezor/connect",file:"node_modules/@trezor/connect/lib/events/core.js"}],[2017,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createDeviceMessage=n.DEVICE=n.DEVICE_EVENT=void 0,n.DEVICE_EVENT="DEVICE_EVENT",n.DEVICE={CONNECT:"device-connect",CONNECT_UNACQUIRED:"device-connect_unacquired",DISCONNECT:"device-disconnect",CHANGED:"device-changed",ACQUIRE:"device-acquire",RELEASE:"device-release",ACQUIRED:"device-acquired",RELEASED:"device-released",USED_ELSEWHERE:"device-used_elsewhere",LOADING:"device-loading",BUTTON:"button",PIN:"pin",PASSPHRASE:"passphrase",PASSPHRASE_ON_DEVICE:"passphrase_on_device",WORD:"word"};n.createDeviceMessage=(e,t)=>({event:n.DEVICE_EVENT,type:e,payload:t})}}},{package:"@trezor/connect-web>@trezor/connect",file:"node_modules/@trezor/connect/lib/events/device.js"}],[2018,{"./ui-request":2023},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createIFrameMessage=n.IFRAME=void 0;const r=e("./ui-request");n.IFRAME={BOOTSTRAP:"iframe-bootstrap",LOADED:"iframe-loaded",INIT:"iframe-init",ERROR:"iframe-error",CALL:"iframe-call"};n.createIFrameMessage=(e,t)=>({event:r.UI_EVENT,type:e,payload:t})}}},{package:"@trezor/connect-web>@trezor/connect",file:"node_modules/@trezor/connect/lib/events/iframe.js"}],[2019,{"./blockchain":2014,"./call":2015,"./core":2016,"./device":2017,"./iframe":2018,"./popup":2020,"./transport":2021,"./ui-promise":2022,"./ui-request":2023,"./ui-response":2024,tslib:2045},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.UI=void 0;const r=e("tslib"),i=e("./ui-request"),s=e("./ui-response");r.__exportStar(e("./blockchain"),n),r.__exportStar(e("./call"),n),r.__exportStar(e("./core"),n),r.__exportStar(e("./device"),n),r.__exportStar(e("./iframe"),n),r.__exportStar(e("./popup"),n),r.__exportStar(e("./transport"),n),r.__exportStar(e("./ui-promise"),n),r.__exportStar(e("./ui-request"),n),r.__exportStar(e("./ui-response"),n),n.UI={...i.UI_REQUEST,...s.UI_RESPONSE}}}},{package:"@trezor/connect-web>@trezor/connect",file:"node_modules/@trezor/connect/lib/events/index.js"}]],[],{});