import{a as Tr}from"./chunk-CHXPHGEW.js";import{a as Bt,b as At,c as tt}from"./chunk-3JCRVFH6.js";import{a as N,j as ug}from"./chunk-UHG6ISVN.js";import{a as lg}from"./chunk-EVXXECVZ.js";import{A as dg,B as mg,C as Ju,D as fg,X as yg,a as pf,z as pg}from"./chunk-TQDE7426.js";import{A as cn,C as eg,D as tg,H as ks,M as rg,N as un,Q as ft,ga as og,ha as ng,hb as wg,i as Gf,j as Kf,la as ln,n as Vf,s as Xa,sa as ri,t as Jr,ta as sg,u as Ja,v as Yf,va as ag,x as Xf,xa as ig,y as Jf}from"./chunk-5RCV3KPE.js";import{a as gg,b as hg}from"./chunk-X5YMBRTT.js";import{a as zf}from"./chunk-CM4ZFCT2.js";import{Ja as za,W as hf,e as wr,qa as yf,s as gf,ua as Es}from"./chunk-RKMQYZSN.js";import{a as vm}from"./chunk-MN377ENM.js";import{$a as Oa,Db as of,E as tn,G as Hu,H as As,Hb as Ma,Ib as sr,Lb as nf,Mb as sf,Nb as af,Pb as cf,Wb as uf,Y as Jm,b as Wm,e as Zm,jc as lf,m as Ym,ma as Ba,n as en,na as yr,nc as Ye,ob as rf,ra as La,rb as _e,s as Xm,va as ef}from"./chunk-COS4XKZ5.js";import{$ as kf,$b as Wa,$c as Ya,A as nn,Ab as If,Ac as an,Bc as Qf,Cc as qf,Ed as ti,Jb as Ff,Kb as vf,Lc as oe,Mc as Mt,Nc as jf,Ob as Pf,Pd as X,Q as Ga,Qb as Rf,Sb as Df,T as Tf,Td as Xu,U as Ee,Ub as Nf,V as Ka,Wb as Bf,Wc as ar,Y as Af,Yb as Lf,Z as xf,Zb as Uf,Zc as ie,_ as Ef,_b as $a,_c as Yu,a as tf,aa as Va,b as Ua,bd as Hf,be as xo,ca as Cf,cd as $f,dd as Wf,f as Wu,h as xt,hb as ja,i as on,j as Sr,jd as Zf,je as cg,k as br,ne as ir,pe as Ke,qd as ei,qe as oi,rb as Ha,sb as _f,t as wf,u as Sf,uc as Of,wc as sn,y as bf,yc as Za,zb as Zu,zc as Mf}from"./chunk-IJLITZAC.js";import{$c as Ot,Ac as P,Db as BE,E as Pm,G as Rm,Gb as LE,Ib as Bm,Nb as Lm,Oc as ze,Pb as x,Pc as Qm,Qb as Dr,Rb as ee,Rc as qm,Sb as ju,Sc as Xo,Tb as Um,Tc as Jo,Td as G,Ub as Ut,Vb as We,Vc as Ht,Wb as M,Wc as $t,X as xe,Xb as Ts,Yb as Om,Z as Dm,_ as se,_b as gr,aa as $o,ae as we,cd as zm,dd as Gm,e as Da,g as _m,gd as Km,i as Tt,ic as Mm,jc as hr,jd as Vm,kd as Qe,m as Im,ma as Nm,md as Ao,nc as Wo,nd as jm,oa as dt,oc as Zo,od as Hm,p as Fm,pa as ye,pd as ae,qd as pe,tb as Vu,ud as $m,w as Fe,wc as Y,x as $e,xc as O,zc as Yo}from"./chunk-GSVPXWLR.js";import{F as km,G as Ho,P as Cm,d as Em}from"./chunk-P42QO3R7.js";import{Fa as xs,Na as df,T as $u,X as Xr,a as B,aa as Qa,bb as mf,ca as fe,d as _,e as U,eb as QE,fb as qE,ga as Nr,hb as zE,ja as mt,la as qa,lb as rn,m as v,r as Ze,rb as ff,s as Ge,v as UE,wa as ME,y as OE}from"./chunk-LYTSCHVN.js";import{h as K,k as le}from"./chunk-P5BPG5MC.js";import{A as To,B as nr,g as i,j as Na,x as ke,z as Lt}from"./chunk-PPQ6BNOX.js";import{a as s,d as qe,g as D,i as u,j as g,l as NE,m as Buffer,n as l}from"./chunk-NSVULBS3.js";var Tg=qe((Br,bg)=>{u();l();var Sg=typeof self<"u"?self:Br,ni=function(){function e(){this.fetch=!1,this.DOMException=Sg.DOMException}return s(e,"F"),e.prototype=Sg,new e}();(function(e){var t=function(r){var o={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};function n(E){return E&&DataView.prototype.isPrototypeOf(E)}if(s(n,"isDataView"),o.arrayBuffer)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],c=ArrayBuffer.isView||function(E){return E&&a.indexOf(Object.prototype.toString.call(E))>-1};function p(E){if(typeof E!="string"&&(E=String(E)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(E))throw new TypeError("Invalid character in header field name");return E.toLowerCase()}s(p,"normalizeName");function m(E){return typeof E!="string"&&(E=String(E)),E}s(m,"normalizeValue");function d(E){var F={next:s(function(){var z=E.shift();return{done:z===void 0,value:z}},"next")};return o.iterable&&(F[Symbol.iterator]=function(){return F}),F}s(d,"iteratorFor");function f(E){this.map={},E instanceof f?E.forEach(function(F,z){this.append(z,F)},this):Array.isArray(E)?E.forEach(function(F){this.append(F[0],F[1])},this):E&&Object.getOwnPropertyNames(E).forEach(function(F){this.append(F,E[F])},this)}s(f,"Headers"),f.prototype.append=function(E,F){E=p(E),F=m(F);var z=this.map[E];this.map[E]=z?z+", "+F:F},f.prototype.delete=function(E){delete this.map[p(E)]},f.prototype.get=function(E){return E=p(E),this.has(E)?this.map[E]:null},f.prototype.has=function(E){return this.map.hasOwnProperty(p(E))},f.prototype.set=function(E,F){this.map[p(E)]=m(F)},f.prototype.forEach=function(E,F){for(var z in this.map)this.map.hasOwnProperty(z)&&E.call(F,this.map[z],z,this)},f.prototype.keys=function(){var E=[];return this.forEach(function(F,z){E.push(z)}),d(E)},f.prototype.values=function(){var E=[];return this.forEach(function(F){E.push(F)}),d(E)},f.prototype.entries=function(){var E=[];return this.forEach(function(F,z){E.push([z,F])}),d(E)},o.iterable&&(f.prototype[Symbol.iterator]=f.prototype.entries);function h(E){if(E.bodyUsed)return Promise.reject(new TypeError("Already read"));E.bodyUsed=!0}s(h,"consumed");function w(E){return new Promise(function(F,z){E.onload=function(){F(E.result)},E.onerror=function(){z(E.error)}})}s(w,"fileReaderReady");function y(E){var F=new FileReader,z=w(F);return F.readAsArrayBuffer(E),z}s(y,"readBlobAsArrayBuffer");function S(E){var F=new FileReader,z=w(F);return F.readAsText(E),z}s(S,"readBlobAsText");function T(E){for(var F=new Uint8Array(E),z=new Array(F.length),W=0;W<F.length;W++)z[W]=String.fromCharCode(F[W]);return z.join("")}s(T,"readArrayBufferAsText");function b(E){if(E.slice)return E.slice(0);var F=new Uint8Array(E.byteLength);return F.set(new Uint8Array(E)),F.buffer}s(b,"bufferClone");function A(){return this.bodyUsed=!1,this._initBody=function(E){this._bodyInit=E,E?typeof E=="string"?this._bodyText=E:o.blob&&Blob.prototype.isPrototypeOf(E)?this._bodyBlob=E:o.formData&&FormData.prototype.isPrototypeOf(E)?this._bodyFormData=E:o.searchParams&&URLSearchParams.prototype.isPrototypeOf(E)?this._bodyText=E.toString():o.arrayBuffer&&o.blob&&n(E)?(this._bodyArrayBuffer=b(E.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):o.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(E)||c(E))?this._bodyArrayBuffer=b(E):this._bodyText=E=Object.prototype.toString.call(E):this._bodyText="",this.headers.get("content-type")||(typeof E=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):o.searchParams&&URLSearchParams.prototype.isPrototypeOf(E)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o.blob&&(this.blob=function(){var E=h(this);if(E)return E;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?h(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(y)}),this.text=function(){var E=h(this);if(E)return E;if(this._bodyBlob)return S(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(T(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o.formData&&(this.formData=function(){return this.text().then(L)}),this.json=function(){return this.text().then(JSON.parse)},this}s(A,"Body");var k=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function C(E){var F=E.toUpperCase();return k.indexOf(F)>-1?F:E}s(C,"normalizeMethod");function I(E,F){F=F||{};var z=F.body;if(E instanceof I){if(E.bodyUsed)throw new TypeError("Already read");this.url=E.url,this.credentials=E.credentials,F.headers||(this.headers=new f(E.headers)),this.method=E.method,this.mode=E.mode,this.signal=E.signal,!z&&E._bodyInit!=null&&(z=E._bodyInit,E.bodyUsed=!0)}else this.url=String(E);if(this.credentials=F.credentials||this.credentials||"same-origin",(F.headers||!this.headers)&&(this.headers=new f(F.headers)),this.method=C(F.method||this.method||"GET"),this.mode=F.mode||this.mode||null,this.signal=F.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&z)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(z)}s(I,"Request"),I.prototype.clone=function(){return new I(this,{body:this._bodyInit})};function L(E){var F=new FormData;return E.trim().split("&").forEach(function(z){if(z){var W=z.split("="),re=W.shift().replace(/\+/g," "),Z=W.join("=").replace(/\+/g," ");F.append(decodeURIComponent(re),decodeURIComponent(Z))}}),F}s(L,"decode");function Q(E){var F=new f,z=E.replace(/\r?\n[\t ]+/g," ");return z.split(/\r?\n/).forEach(function(W){var re=W.split(":"),Z=re.shift().trim();if(Z){var He=re.join(":").trim();F.append(Z,He)}}),F}s(Q,"parseHeaders"),A.call(I.prototype);function R(E,F){F||(F={}),this.type="default",this.status=F.status===void 0?200:F.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in F?F.statusText:"OK",this.headers=new f(F.headers),this.url=F.url||"",this._initBody(E)}s(R,"Response"),A.call(R.prototype),R.prototype.clone=function(){return new R(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},R.error=function(){var E=new R(null,{status:0,statusText:""});return E.type="error",E};var H=[301,302,303,307,308];R.redirect=function(E,F){if(H.indexOf(F)===-1)throw new RangeError("Invalid status code");return new R(null,{status:F,headers:{location:E}})},r.DOMException=e.DOMException;try{new r.DOMException}catch{r.DOMException=function(F,z){this.message=F,this.name=z;var W=Error(F);this.stack=W.stack},r.DOMException.prototype=Object.create(Error.prototype),r.DOMException.prototype.constructor=r.DOMException}function q(E,F){return new Promise(function(z,W){var re=new I(E,F);if(re.signal&&re.signal.aborted)return W(new r.DOMException("Aborted","AbortError"));var Z=new XMLHttpRequest;function He(){Z.abort()}s(He,"abortXhr"),Z.onload=function(){var Le={status:Z.status,statusText:Z.statusText,headers:Q(Z.getAllResponseHeaders()||"")};Le.url="responseURL"in Z?Z.responseURL:Le.headers.get("X-Request-URL");var st="response"in Z?Z.response:Z.responseText;z(new R(st,Le))},Z.onerror=function(){W(new TypeError("Network request failed"))},Z.ontimeout=function(){W(new TypeError("Network request failed"))},Z.onabort=function(){W(new r.DOMException("Aborted","AbortError"))},Z.open(re.method,re.url,!0),re.credentials==="include"?Z.withCredentials=!0:re.credentials==="omit"&&(Z.withCredentials=!1),"responseType"in Z&&o.blob&&(Z.responseType="blob"),re.headers.forEach(function(Le,st){Z.setRequestHeader(st,Le)}),re.signal&&(re.signal.addEventListener("abort",He),Z.onreadystatechange=function(){Z.readyState===4&&re.signal.removeEventListener("abort",He)}),Z.send(typeof re._bodyInit>"u"?null:re._bodyInit)})}return s(q,"fetch"),q.polyfill=!0,e.fetch||(e.fetch=q,e.Headers=f,e.Request=I,e.Response=R),r.Headers=f,r.Request=I,r.Response=R,r.fetch=q,Object.defineProperty(r,"__esModule",{value:!0}),r}({})})(ni);ni.fetch.ponyfill=!0;delete ni.fetch.polyfill;var pn=ni;Br=pn.fetch;Br.default=pn.fetch;Br.fetch=pn.fetch;Br.Headers=pn.Headers;Br.Request=pn.Request;Br.Response=pn.Response;bg.exports=Br});var xg=qe((_B,Ag)=>{u();l();(function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t={rotl:s(function(r,o){return r<<o|r>>>32-o},"rotl"),rotr:s(function(r,o){return r<<32-o|r>>>o},"rotr"),endian:s(function(r){if(r.constructor==Number)return t.rotl(r,8)&16711935|t.rotl(r,24)&4278255360;for(var o=0;o<r.length;o++)r[o]=t.endian(r[o]);return r},"endian"),randomBytes:s(function(r){for(var o=[];r>0;r--)o.push(Math.floor(Math.random()*256));return o},"randomBytes"),bytesToWords:s(function(r){for(var o=[],n=0,a=0;n<r.length;n++,a+=8)o[a>>>5]|=r[n]<<24-a%32;return o},"bytesToWords"),wordsToBytes:s(function(r){for(var o=[],n=0;n<r.length*32;n+=8)o.push(r[n>>>5]>>>24-n%32&255);return o},"wordsToBytes"),bytesToHex:s(function(r){for(var o=[],n=0;n<r.length;n++)o.push((r[n]>>>4).toString(16)),o.push((r[n]&15).toString(16));return o.join("")},"bytesToHex"),hexToBytes:s(function(r){for(var o=[],n=0;n<r.length;n+=2)o.push(parseInt(r.substr(n,2),16));return o},"hexToBytes"),bytesToBase64:s(function(r){for(var o=[],n=0;n<r.length;n+=3)for(var a=r[n]<<16|r[n+1]<<8|r[n+2],c=0;c<4;c++)n*8+c*6<=r.length*8?o.push(e.charAt(a>>>6*(3-c)&63)):o.push("=");return o.join("")},"bytesToBase64"),base64ToBytes:s(function(r){r=r.replace(/[^A-Z0-9+\/]/ig,"");for(var o=[],n=0,a=0;n<r.length;a=++n%4)a!=0&&o.push((e.indexOf(r.charAt(n-1))&Math.pow(2,-2*a+8)-1)<<a*2|e.indexOf(r.charAt(n))>>>6-a*2);return o},"base64ToBytes")};Ag.exports=t})()});var tl=qe((PB,Eg)=>{u();l();var el={utf8:{stringToBytes:s(function(e){return el.bin.stringToBytes(unescape(encodeURIComponent(e)))},"stringToBytes"),bytesToString:s(function(e){return decodeURIComponent(escape(el.bin.bytesToString(e)))},"bytesToString")},bin:{stringToBytes:s(function(e){for(var t=[],r=0;r<e.length;r++)t.push(e.charCodeAt(r)&255);return t},"stringToBytes"),bytesToString:s(function(e){for(var t=[],r=0;r<e.length;r++)t.push(String.fromCharCode(e[r]));return t.join("")},"bytesToString")}};Eg.exports=el});var Cg=qe((BB,kg)=>{u();l();(function(){var e=xg(),t=tl().utf8,r=tl().bin,o=s(function(a){a.constructor==String?a=t.stringToBytes(a):typeof Buffer<"u"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(a)?a=Array.prototype.slice.call(a,0):Array.isArray(a)||(a=a.toString());var c=e.bytesToWords(a),p=a.length*8,m=[],d=1732584193,f=-271733879,h=-1732584194,w=271733878,y=-1009589776;c[p>>5]|=128<<24-p%32,c[(p+64>>>9<<4)+15]=p;for(var S=0;S<c.length;S+=16){for(var T=d,b=f,A=h,k=w,C=y,I=0;I<80;I++){if(I<16)m[I]=c[S+I];else{var L=m[I-3]^m[I-8]^m[I-14]^m[I-16];m[I]=L<<1|L>>>31}var Q=(d<<5|d>>>27)+y+(m[I]>>>0)+(I<20?(f&h|~f&w)+1518500249:I<40?(f^h^w)+1859775393:I<60?(f&h|f&w|h&w)-1894007588:(f^h^w)-899497514);y=w,w=h,h=f<<30|f>>>2,f=d,d=Q}d+=T,f+=b,h+=A,w+=k,y+=C}return[d,f,h,w,y]},"sha1"),n=s(function(a,c){var p=e.wordsToBytes(o(a));return c&&c.asBytes?p:c&&c.asString?r.bytesToString(p):e.bytesToHex(p)},"api");n._blocksize=16,n._digestsize=20,kg.exports=n})()});var Fg=qe((KB,KE)=>{KE.exports={name:"@phantom-labs/blocklist",version:"0.13.0",main:"index.js",types:"index.d.ts",repository:"git@github.com:phantom-labs/blocklist.git",author:"Jordan Leigh <AlwaysBCoding@gmail.com>",license:"MIT",scripts:{build:"node build.js"},dependencies:{"js-yaml":"^4.1.0",sha3:"^2.1.4"}}});var vg=qe((VB,VE)=>{VE.exports={blocklist:["phantomweb.app","aurory.app","solvision.io","staratlas.art","starsatlas.com","sollet.cc","raydlum.io","aurorynft.com","sneks.gg","solletweb.io","i-sollet.com","fancyfrenchienft.art","solanawebwallet.online","phahtom.com","server-syncwallet.com","staratias.app","raydium.network","grapesnetwork.me","staratias.art","soistarter.org","audius-nft.top","aurory.me","degenapes.app","phantom-app.online","phantomwallet.net","dapps-node.com","phantom-app.link","solanaoutage.com","walletconnectdapps.net","staratlas.cx","web-phantom.app","0120tt.com"],whitelist:[],fuzzylist:[],contentHash:"830ea1c9a833213eabc17990adf053081f503b1203ca9a2c711db7199e657293"}});var Pg=qe(nl=>{u();l();var{version:jE}=Fg(),HE=vg(),$E=s(()=>jE,"getVersion"),WE=s(()=>HE,"getBlocklist");nl.getVersion=$E;nl.getBlocklist=WE});var Dg=qe(mn=>{"use strict";u();l();mn.__esModule=!0;mn.distance=mn.closest=void 0;var Lr=new Uint32Array(65536),ZE=s(function(e,t){for(var r=e.length,o=t.length,n=1<<r-1,a=-1,c=0,p=r,m=r;m--;)Lr[e.charCodeAt(m)]|=1<<m;for(m=0;m<o;m++){var d=Lr[t.charCodeAt(m)],f=d|c;d|=(d&a)+a^a,c|=~(d|a),a&=d,c&n&&p++,a&n&&p--,c=c<<1|1,a=a<<1|~(f|c),c&=f}for(m=r;m--;)Lr[e.charCodeAt(m)]=0;return p},"myers_32"),YE=s(function(e,t){for(var r=t.length,o=e.length,n=[],a=[],c=Math.ceil(r/32),p=Math.ceil(o/32),m=0;m<c;m++)a[m]=-1,n[m]=0;for(var d=0;d<p-1;d++){for(var f=0,h=-1,w=d*32,y=Math.min(32,o)+w,S=w;S<y;S++)Lr[e.charCodeAt(S)]|=1<<S;for(var m=0;m<r;m++){var T=Lr[t.charCodeAt(m)],b=a[m/32|0]>>>m&1,A=n[m/32|0]>>>m&1,k=T|f,C=((T|A)&h)+h^h|T|A,I=f|~(C|h),L=h&C;I>>>31^b&&(a[m/32|0]^=1<<m),L>>>31^A&&(n[m/32|0]^=1<<m),I=I<<1|b,L=L<<1|A,h=L|~(k|I),f=I&k}for(var S=w;S<y;S++)Lr[e.charCodeAt(S)]=0}for(var Q=0,R=-1,H=d*32,q=Math.min(32,o-H)+H,S=H;S<q;S++)Lr[e.charCodeAt(S)]|=1<<S;for(var E=o,m=0;m<r;m++){var T=Lr[t.charCodeAt(m)],b=a[m/32|0]>>>m&1,A=n[m/32|0]>>>m&1,k=T|Q,C=((T|A)&R)+R^R|T|A,I=Q|~(C|R),L=R&C;E+=I>>>o-1&1,E-=L>>>o-1&1,I>>>31^b&&(a[m/32|0]^=1<<m),L>>>31^A&&(n[m/32|0]^=1<<m),I=I<<1|b,L=L<<1|A,R=L|~(k|I),Q=I&k}for(var S=H;S<q;S++)Lr[e.charCodeAt(S)]=0;return E},"myers_x"),Rg=s(function(e,t){if(e.length<t.length){var r=t;t=e,e=r}return t.length===0?e.length:e.length<=32?ZE(e,t):YE(e,t)},"distance");mn.distance=Rg;var XE=s(function(e,t){for(var r=1/0,o=0,n=0;n<t.length;n++){var a=Rg(e,t[n]);a<r&&(r=a,o=n)}return t[o]},"closest");mn.closest=XE});var Ng=qe((sl,Cs)=>{u();l();(function(){"use strict";var e;try{e=typeof Intl<"u"&&typeof Intl.Collator<"u"?Intl.Collator("generic",{sensitivity:"base"}):null}catch{console.log("Collator could not be initialized and wouldn't be used")}var t=Dg(),r=[],o=[],n={get:s(function(a,c,p){var m=p&&e&&p.useCollator;if(m){var d=a.length,f=c.length;if(d===0)return f;if(f===0)return d;var h,w,y,S,T;for(y=0;y<f;++y)r[y]=y,o[y]=c.charCodeAt(y);r[f]=f;var b;for(y=0;y<d;++y){for(w=y+1,S=0;S<f;++S)h=w,b=e.compare(a.charAt(y),String.fromCharCode(o[S]))===0,w=r[S]+(b?0:1),T=h+1,w>T&&(w=T),T=r[S+1]+1,w>T&&(w=T),r[S]=h;r[S]=w}return w}return t.distance(a,c)},"get")};typeof define<"u"&&define!==null&&define.amd?define(function(){return n}):typeof Cs<"u"&&Cs!==null&&typeof sl<"u"&&Cs.exports===sl?Cs.exports=n:(typeof self<"u"&&typeof self.postMessage=="function"&&typeof self.importScripts=="function"||typeof self<"u"&&self!==null)&&(self.Levenshtein=n)})()});var Ib=qe(_b=>{"use strict";u();l();var $n=B();function Lv(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}s(Lv,"is");var Uv=typeof Object.is=="function"?Object.is:Lv,Ov=$n.useState,Mv=$n.useEffect,Qv=$n.useLayoutEffect,qv=$n.useDebugValue;function zv(e,t){var r=t(),o=Ov({inst:{value:r,getSnapshot:t}}),n=o[0].inst,a=o[1];return Qv(function(){n.value=r,n.getSnapshot=t,id(n)&&a({inst:n})},[e,r,t]),Mv(function(){return id(n)&&a({inst:n}),e(function(){id(n)&&a({inst:n})})},[e]),qv(r),r}s(zv,"useSyncExternalStore$2");function id(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Uv(e,r)}catch{return!0}}s(id,"checkIfSnapshotChanged");function Gv(e,t){return t()}s(Gv,"useSyncExternalStore$1");var Kv=typeof self>"u"||typeof self.document>"u"||typeof self.document.createElement>"u"?Gv:zv;_b.useSyncExternalStore=$n.useSyncExternalStore!==void 0?$n.useSyncExternalStore:Kv});var vb=qe(Fb=>{"use strict";u();l();g.NODE_ENV!=="production"&&function(){function e(y,S){return y===S&&(y!==0||1/y===1/S)||y!==y&&S!==S}s(e,"is");function t(y,S){f||n.startTransition===void 0||(f=!0,console.error("You are using an outdated, pre-release alpha of React 18 that does not support useSyncExternalStore. The use-sync-external-store shim will not work correctly. Upgrade to a newer pre-release."));var T=S();if(!h){var b=S();a(T,b)||(console.error("The result of getSnapshot should be cached to avoid an infinite loop"),h=!0)}b=c({inst:{value:T,getSnapshot:S}});var A=b[0].inst,k=b[1];return m(function(){A.value=T,A.getSnapshot=S,r(A)&&k({inst:A})},[y,T,S]),p(function(){return r(A)&&k({inst:A}),y(function(){r(A)&&k({inst:A})})},[y]),d(T),T}s(t,"useSyncExternalStore$2");function r(y){var S=y.getSnapshot;y=y.value;try{var T=S();return!a(y,T)}catch{return!0}}s(r,"checkIfSnapshotChanged");function o(y,S){return S()}s(o,"useSyncExternalStore$1"),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error());var n=B(),a=typeof Object.is=="function"?Object.is:e,c=n.useState,p=n.useEffect,m=n.useLayoutEffect,d=n.useDebugValue,f=!1,h=!1,w=typeof self>"u"||typeof self.document>"u"||typeof self.document.createElement>"u"?o:t;Fb.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:w,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error())}()});var ud=qe((Are,cd)=>{"use strict";u();l();g.NODE_ENV==="production"?cd.exports=Ib():cd.exports=vb()});var Rb=qe(Pb=>{"use strict";u();l();var Xc=B(),Vv=ud();function jv(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}s(jv,"is");var Hv=typeof Object.is=="function"?Object.is:jv,$v=Vv.useSyncExternalStore,Wv=Xc.useRef,Zv=Xc.useEffect,Yv=Xc.useMemo,Xv=Xc.useDebugValue;Pb.useSyncExternalStoreWithSelector=function(e,t,r,o,n){var a=Wv(null);if(a.current===null){var c={hasValue:!1,value:null};a.current=c}else c=a.current;a=Yv(function(){function m(y){if(!d){if(d=!0,f=y,y=o(y),n!==void 0&&c.hasValue){var S=c.value;if(n(S,y))return h=S}return h=y}if(S=h,Hv(f,y))return S;var T=o(y);return n!==void 0&&n(S,T)?(f=y,S):(f=y,h=T)}s(m,"memoizedSelector");var d=!1,f,h,w=r===void 0?null:r;return[function(){return m(t())},w===null?void 0:function(){return m(w())}]},[t,r,o,n]);var p=$v(e,a[0],a[1]);return Zv(function(){c.hasValue=!0,c.value=p},[p]),Xv(p),p}});var Nb=qe(Db=>{"use strict";u();l();g.NODE_ENV!=="production"&&function(){function e(d,f){return d===f&&(d!==0||1/d===1/f)||d!==d&&f!==f}s(e,"is"),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error());var t=B(),r=ud(),o=typeof Object.is=="function"?Object.is:e,n=r.useSyncExternalStore,a=t.useRef,c=t.useEffect,p=t.useMemo,m=t.useDebugValue;Db.useSyncExternalStoreWithSelector=function(d,f,h,w,y){var S=a(null);if(S.current===null){var T={hasValue:!1,value:null};S.current=T}else T=S.current;S=p(function(){function A(Q){if(!k){if(k=!0,C=Q,Q=w(Q),y!==void 0&&T.hasValue){var R=T.value;if(y(R,Q))return I=R}return I=Q}if(R=I,o(C,Q))return R;var H=w(Q);return y!==void 0&&y(R,H)?(C=Q,R):(C=Q,I=H)}s(A,"memoizedSelector");var k=!1,C,I,L=h===void 0?null:h;return[function(){return A(f())},L===null?void 0:function(){return A(L())}]},[f,h,w,y]);var b=n(d,S[0],S[1]);return c(function(){T.hasValue=!0,T.value=b},[b]),m(b),b},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error())}()});var Bb=qe((Dre,ld)=>{"use strict";u();l();g.NODE_ENV==="production"?ld.exports=Rb():ld.exports=Nb()});var yA=qe((Sge,hA)=>{"use strict";u();l();hA.exports=e=>{if(Object.prototype.toString.call(e)!=="[object Object]")return!1;let t=Object.getPrototypeOf(e);return t===null||t===Object.prototype}});var xA=qe((TA,AA)=>{"use strict";u();l();var bu=yA(),{hasOwnProperty:SA}=Object.prototype,{propertyIsEnumerable:c1}=Object,ts=s((e,t,r)=>Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0}),"defineProperty"),u1=TA,wA={concatArrays:!1,ignoreUndefined:!1},Tu=s(e=>{let t=[];for(let r in e)SA.call(e,r)&&t.push(r);if(Object.getOwnPropertySymbols){let r=Object.getOwnPropertySymbols(e);for(let o of r)c1.call(e,o)&&t.push(o)}return t},"getEnumerableOwnPropertyKeys");function rs(e){return Array.isArray(e)?l1(e):bu(e)?p1(e):e}s(rs,"clone");function l1(e){let t=e.slice(0,0);return Tu(e).forEach(r=>{ts(t,r,rs(e[r]))}),t}s(l1,"cloneArray");function p1(e){let t=Object.getPrototypeOf(e)===null?Object.create(null):{};return Tu(e).forEach(r=>{ts(t,r,rs(e[r]))}),t}s(p1,"cloneOptionObject");var bA=s((e,t,r,o)=>(r.forEach(n=>{typeof t[n]>"u"&&o.ignoreUndefined||(n in e&&e[n]!==Object.getPrototypeOf(e)?ts(e,n,Rd(e[n],t[n],o)):ts(e,n,rs(t[n])))}),e),"mergeKeys"),d1=s((e,t,r)=>{let o=e.slice(0,0),n=0;return[e,t].forEach(a=>{let c=[];for(let p=0;p<a.length;p++)SA.call(a,p)&&(c.push(String(p)),a===e?ts(o,n++,a[p]):ts(o,n++,rs(a[p])));o=bA(o,a,Tu(a).filter(p=>!c.includes(p)),r)}),o},"concatArrays");function Rd(e,t,r){return r.concatArrays&&Array.isArray(e)&&Array.isArray(t)?d1(e,t,r):!bu(t)||!bu(e)?rs(t):bA(e,t,Tu(t),r)}s(Rd,"merge");AA.exports=function(...e){let t=Rd(rs(wA),this!==u1&&this||{},wA),r={_:{}};for(let o of e)if(o!==void 0){if(!bu(o))throw new TypeError("`"+o+"` is not an Option Object");r=Rd(r,{_:o},t)}return r._}});var Ex=qe((Obe,xx)=>{u();l();function pD(e,t,r,o){for(var n=-1,a=e==null?0:e.length;++n<a;){var c=e[n];t(o,c,r(c),e)}return o}s(pD,"arrayAggregator");xx.exports=pD});var Cx=qe((zbe,kx)=>{u();l();var dD=qE();function mD(e,t,r,o){return dD(e,function(n,a,c){t(o,n,r(n),c)}),o}s(mD,"baseAggregator");kx.exports=mD});var Ix=qe((jbe,_x)=>{u();l();var fD=Ex(),gD=Cx(),hD=ME(),yD=OE();function wD(e,t){return function(r,o){var n=yD(r)?fD:gD,a=t?t():{};return n(r,e,hD(o,2),a)}}s(wD,"createAggregator");_x.exports=wD});var vx=qe((Zbe,Fx)=>{u();l();var SD=UE(),bD=Ix(),TD=bD(function(e,t,r){SD(e,r,t)});Fx.exports=TD});u();l();u();l();var _g=D(Tg(),1),Ig=D(Cg(),1),rl=D(NE(),1);var dn=(e=>(e.BLOCK="BLOCK",e.NONE="NONE",e))(dn||{});function GE(e,t){for(let r=0;r<e.k;r++){let o=(0,Ig.default)(`${e.salt}_${t}_${r}`,{asBytes:!0}),a=rl.Buffer.from(o).subarray(0,4).readUInt32BE(0)%e.bits,c=Math.floor(a/24),p=rl.Buffer.from(e.bitVector.slice(c*4,c*4+4),"base64"),m=a%24,d=Math.floor(m/8),f=m%8;if(!(p[d]&1<<7-f))return!1}return!0}s(GE,"lookup");var MB=typeof self<"u"&&self.fetch?self.fetch:_g.default;function ol(e,t,r,o){let a=new URL(o).hostname.toLowerCase().replace(/\.$/,"").split(".");for(let c=0;c<a.length-1;c++){let p=a.slice(c).join(".");if(t.includes(p)||GE(e,p)&&!r.includes(p))return"BLOCK"}return"NONE"}s(ol,"scanDomain");var si=D(Pg());var Mg=D(Ng());u();l();var Bg="https://blocklist.phantom.app/multichain.json",al="https://blowfish-blocklist-proxy.phantom.app",JE="https://github.com/phantom-labs/blocklist",oL=s((e=3)=>({retry:e,retryDelay:s(t=>Math.min(1e3*2**t,3e4),"retryDelay")}),"reactQueryExponentialBackoff"),ek={SLIPPAGE_EXCEEDED:"SLIPPAGE_EXCEEDED",INSUFFICIENT_FUNDS:"INSUFFICIENT_FUNDS",INSUFFICIENT_GAS:"INSUFFICIENT_GAS",UNKNOWN_ERROR:"UNKNOWN_ERROR",SIMULATION_FAILED:"SIMULATION_FAILED",TRANSACTION_EXPIRED:"TRANSACTION_EXPIRED",ACCOUNT_FROZEN:"ACCOUNT_FROZEN",SIMULATION_TIMEOUT:"SIMULATION_TIMEOUT",STALE_QUOTE:"STALE_QUOTE"},eo;(function(e){e[e.info=5]="info",e[e.error=4]="error",e[e.criticalError=3]="criticalError",e[e.alert=2]="alert",e[e.criticalAlert=1]="criticalAlert"})(eo||(eo={}));function tk(e){return{[eo.criticalAlert]:"1-critical-alert",[eo.alert]:"2-alert",[eo.criticalError]:"3-critical-error",[eo.error]:"4-error",[eo.info]:"5-information"}[e]}s(tk,"scanWarningVariantToUiLevel");var rk=3,ll=6e5,ok=6e4,gL=i.object({type:i.union([i.literal("all"),i.literal("blocklist"),i.literal("whitelist"),i.literal("error"),i.literal("fuzzy"),i.literal("blowfishBloomFilter")]),result:i.boolean(),source:i.optional(i.string()),match:i.string().optional(),isSubdomainDomainWhitelisted:i.boolean().optional()}),hL=i.object({localHash:i.any(),cursor:i.any()}),pl=i.object({bitVector:i.string(),k:i.number(),hash:i.string(),bits:i.number(),salt:i.string()}),Qg=i.union([i.object({bloomFilter:pl,bloomFilterHash:i.string(),recentlyAdded:i.array(i.string()),recentlyRemoved:i.array(i.string()),nextCursor:i.string()}),i.object({bloomFilter:pl.optional(),bloomFilterHash:i.optional(i.string()),recentlyAdded:i.array(i.string()),recentlyRemoved:i.array(i.string()),nextCursor:i.string()})]),qg=i.object({bloomFilter:pl,lastUpdated:i.number()}).nullish(),zg=i.object({recentlyAdded:i.array(i.string()),recentlyRemoved:i.array(i.string()),lastUpdated:i.number().optional()}).nullish(),_s=class{static{s(this,"PhishingDetector")}blocklist;whitelist;fuzzylist;tolerance;constructor(t,r,o,n){this.blocklist=il(t),this.whitelist=il(r),this.fuzzylist=il(o),this.tolerance=n||rk}check(t,r){if(!t)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};let o=ai(t),n=dl(o);if(sk(n,this.whitelist)){let m=new URL(t).hostname;if(cl(dl(m),this.blocklist)){let f={type:"blocklist",result:!0,source:m,isSubdomainDomainWhitelisted:!0};return r.capture("blockedDomain",{data:f}),f}else return{type:"whitelist",result:!1,source:m,isSubdomainDomainWhitelisted:!0}}if(cl(n,this.whitelist))return{type:"whitelist",result:!1,source:o,isSubdomainDomainWhitelisted:!1};if(cl(n,this.blocklist)){let m={type:"blocklist",result:!0,source:o,isSubdomainDomainWhitelisted:!1};return r.capture("blockedDomain",{data:m}),m}if(this.tolerance>0){let m=Lg(n);m=m.replace("www.","");let d=this.fuzzylist.find(f=>{let h=Lg(f);return Mg.default.get(m,h)<=this.tolerance});if(d)return{type:"fuzzy",result:!0,match:nk(d),source:o,isSubdomainDomainWhitelisted:!1}}return{type:"all",result:!1,source:o,isSubdomainDomainWhitelisted:!1}}},ai=s(e=>{let t=new URL(e).hostname.replace(/\.$/,"").split(".");return t.slice(0).slice(-(t.length===4?3:2)).join(".")},"removeSubdomainFromDomain"),il=s(e=>e.map(dl),"processDomainList"),dl=s(e=>e.split(".").reverse(),"domainToParts"),nk=s(e=>e.slice().reverse().join("."),"domainPartsToDomain"),Lg=s(e=>e.slice(1).reverse().join("."),"domainPartsToFuzzyForm"),cl=s((e,t)=>t.some(r=>r.length>e.length?!1:r.every((o,n)=>e[n]===o)),"matchPartsAgainstList"),sk=s((e,t)=>t.some(r=>r[0]===e[0]&&r[1]===e[1]&&r[2]==="*"),"matchWhitelistedHostingDomain"),ak=s(async e=>{let t=(0,si.getBlocklist)(),r=await e.get(pe.CachedBlocklistDiff),o=null;try{o=JSON.parse(`${r}`)}catch(n){P.captureError(new Error(`Error parsing blocklist diff: ${n?.message}`),O.Generic)}if(o&&o.expiresAt&&o.expiresAt>Date.now())return new _s(t.blocklist.concat(o.blocklist),t.whitelist.concat(o.whitelist),t.fuzzylist.concat(o.fuzzylist));{let n={},a=(0,si.getVersion)();o&&(n.lastContentHash=`${o.contentHash}`),a&&(n.localBlocklistVersion=`${a}`);let c=await K.headers(n).get(Bg);if(c.status===200){let p=c.data;return p.expiresAt=Date.now()+ll,e.set(pe.CachedBlocklistDiff,JSON.stringify(p)),new _s(t.blocklist.concat(p.blocklist),t.whitelist.concat(p.whitelist),t.fuzzylist.concat(p.fuzzylist))}else{if(c.status===304)return o.expiresAt=Date.now()+ll,e.set(pe.CachedBlocklistDiff,JSON.stringify(o)),new _s(t.blocklist.concat(o.blocklist),t.whitelist.concat(o.whitelist),t.fuzzylist.concat(o.fuzzylist));throw new Error("Invalid response from blocklist")}}},"updateLocalBlocklist"),ik=s(async(e,t,r)=>{let o,n;try{o=await $t.isFeatureEnabledAsync("kill-blowfish-blocklist-cursor"),n=await $t.isFeatureEnabledAsync("kill-previous-blocklist")}catch{o=!1,n=!1}let a;try{if(n)return o?Og(r,e,t):Ug(r,e,t);{a=await ak(e);let c=a.check(r,t);return c.type==="all"?o?Og(r,e,t):Ug(r,e,t):c}}catch{return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1}}},"detectPhishing"),Ug=s(async(e,t,r)=>{if(!e)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};let o=ai(e),n=await t.getAll([pe.CachedBloomFilter,pe.CachedBloomFilterHash,pe.CachedScanDataRecents,pe.CachedScanDataCursor]),a=n[pe.CachedBloomFilter]??null,c=n[pe.CachedBloomFilterHash]??null,p=n[pe.CachedScanDataCursor]??null,m=n[pe.CachedScanDataRecents]??null,d=null,f={recentlyAdded:[],recentlyRemoved:[],lastUpdated:0},h=null;if(a){let y=qg.safeParse(a);y.success?d=y.data:await ul(t)}if(m){let y=zg.safeParse(m);y.success?f=y.data:await ul(t)}if(p){let S=i.string().safeParse(p);S.success?h=S.data:await ul(t)}if(!f||f.lastUpdated==null||Date.now()>f.lastUpdated+ok){let y={localHash:c,cursor:h},S=await K.post(al,y);if(S.status!==200)return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};let T=S.data,b,A=Qg.safeParse(T);if(A.success)b=A.data;else return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};let k=[],C=[],I=typeof c=="string"&&b.bloomFilterHash?c!==b.bloomFilterHash:!1;f!=null&&!I&&(k=f.recentlyAdded,C=f.recentlyRemoved),k=k.concat(b.recentlyAdded),C=C.concat(b.recentlyRemoved),k=k.filter(Q=>b.recentlyRemoved.indexOf(Q)<0),C=C.filter(Q=>b.recentlyAdded.indexOf(Q)<0);let L={recentlyAdded:k,recentlyRemoved:C,lastUpdated:Date.now()};if(await t.set(pe.CachedScanDataRecents,L),f=L,b.nextCursor!==h&&await t.set(pe.CachedScanDataCursor,b.nextCursor),b.bloomFilter!=null){let Q={bloomFilter:b.bloomFilter,lastUpdated:Date.now()};await Promise.all([t.set(pe.CachedBloomFilter,Q),t.set(pe.CachedBloomFilterHash,b.bloomFilterHash)]),d=Q}}if(!d)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};let w=ol(d.bloomFilter,f.recentlyAdded,f.recentlyRemoved,e);if(w===dn.BLOCK){let y={result:!0,source:o,type:"blowfishBloomFilter"};return r.capture("blockedDomain",{data:y}),y}else if(w===dn.NONE)return{result:!1,type:"all",isSubdomainDomainWhitelisted:!1};return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1}},"checkBlowfishBlocklist");async function ul(e){await e.remove([pe.CachedBloomFilter,pe.CachedBloomFilterHash,pe.CachedScanDataRecents,pe.CachedScanDataCursor])}s(ul,"resetState");var Og=s(async(e,t,r)=>{if(!e)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};let o=ai(e),n=await t.getAll([pe.CachedBloomFilter,pe.CachedBloomFilterHash,pe.CachedScanDataRecents]),a=n[pe.CachedBloomFilter]??null,c=n[pe.CachedBloomFilterHash]??null,p=n[pe.CachedScanDataRecents]??null,m=null,d={recentlyAdded:[],recentlyRemoved:[],lastUpdated:0};if(a){let h=qg.safeParse(a);h.success?m=h.data:await t.remove([pe.CachedBloomFilter,pe.CachedBloomFilterHash,pe.CachedScanDataRecents])}if(p){let h=zg.safeParse(p);h.success?d=h.data:await t.remove([pe.CachedBloomFilter,pe.CachedBloomFilterHash,pe.CachedScanDataRecents])}if(!d||d.lastUpdated==null||Date.now()>d.lastUpdated+ll){let h={localHash:c},w=await K.post(al,h);if(w.status!==200)return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};let y=w.data,S,T=Qg.safeParse(y);if(T.success)S=T.data;else return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};let b={recentlyAdded:S.recentlyAdded,recentlyRemoved:S.recentlyRemoved,lastUpdated:Date.now()};if(await t.set(pe.CachedScanDataRecents,b),d=b,S.bloomFilter!=null){let A={bloomFilter:S.bloomFilter,lastUpdated:Date.now()};await Promise.all([t.set(pe.CachedBloomFilter,A),t.set(pe.CachedBloomFilterHash,S.bloomFilterHash)]),m=A}}if(!m)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};let f=ol(m.bloomFilter,d.recentlyAdded,d.recentlyRemoved,e);if(f===dn.BLOCK){let h={result:!0,source:o,type:"blowfishBloomFilter"};return r.capture("blockedDomain",{data:h}),h}else if(f===dn.NONE)return{result:!1,type:"all",isSubdomainDomainWhitelisted:!1};return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1}},"checkBlowfishBlocklistOld");u();l();u();l();var ck=s(e=>e/1e8,"satsToBTC");u();l();u();l();u();l();var Eo;(function(e){e.Plus="PLUS",e.Minus="MINUS",e.Equal="EQUAL"})(Eo||(Eo={}));var ml;(function(e){e.fungible="fungible",e.collectible="collectible",e.native="native",e.unknown="unknown"})(ml||(ml={}));var fl;(function(e){e.approval="approval",e.revokal="revokal",e.transfer="transfer",e.mint="mint",e.unknown="unknown"})(fl||(fl={}));var fn;(function(e){e.Green="GREEN",e.Red="RED",e.White="WHITE"})(fn||(fn={}));var ii={[fn.Green]:"spotPositive",[fn.Red]:"spotNegative",[fn.White]:"textBase"};function uk(e){switch(e){case Eo.Plus:return ii.GREEN;case Eo.Minus:return ii.RED;case Eo.Equal:return ii.WHITE;default:return ii.WHITE}}s(uk,"getColorForStateChangeSign");function lk(e){let t=e?.advancedDetails&&"safeguard"in e.advancedDetails?e?.advancedDetails?.safeguard:void 0;if(t?.recommended&&!t?.shouldBundle&&!t.error&&!t.verifyError&&t?.transactions&&t.transactions.length>0)return t.transactions}s(lk,"extractSafeguardTransactions");function Gg(e,t){if(e.params&&"safeguard"in e.params&&e.params.safeguard&&t?.advancedDetails&&"safeguard"in t.advancedDetails&&t.advancedDetails.safeguard?.transactions){let r=t.advancedDetails.safeguard;if(r.error)return r.error;let o=e.params.transactions,n=r.transactions;if(n){let a;try{qf(o,n)}catch(c){c instanceof an?a=c:c instanceof Error?a=an.createUnknownError(c.message):a=an.createUnknownError("Non error type",c)}if(a)return t.advancedDetails.safeguard.verifyError=a,a}}}s(Gg,"processSafeguardErrors");function Kg(e){if(e.advancedDetails&&"requestId"in e.advancedDetails)return e.advancedDetails.requestId}s(Kg,"extractRequestId");u();l();var pk=s(async(e,t,r)=>{let o=`/simulation/v1?language=${e}`,n=await K.api().post(o,{...r,chainId:r.networkID,appVersion:ke,platform:Lt,deviceId:t});if(!le(n))throw new Error("Failed to scan message");return n.data},"getScanMessage"),gl=s(async(e,t,r)=>{let o=`/simulation/v1?language=${e}`,n={...r.params,...r.params&&"safeguard"in r.params?{safeguard:{...r.params.safeguard,lighthouseProgramId:Qf}}:{}},a=await K.api().post(o,{...r,chainId:r.networkID,params:n,metadata:r.metadata,appVersion:ke,platform:Lt,deviceId:t});if(!le(a))throw new Error("Failed to scan transaction");let c=a.data,p=Gg(r,c);if(p instanceof an){let m=Kg(c);P.captureMessage(`Verify error ${m??""}: ${p.message}`,O.Safeguard)}return c},"getScanTransaction");var $L=i.union([i.literal("signTransaction"),i.literal("signAllTransactions"),i.literal("signAndSendTransaction"),i.literal("signAndSendAllTransactions")]);u();l();var hl=(J=>(J.HasOnboarded="hasOnboarded",J.ResetHasOnboarded="resetHasOnboarded",J.LockExtension="lockExtension",J.UnlockExtension="unlockExtension",J.IsExtensionUnlocked="IsExtensionUnlocked",J.SetPassword="setPassword",J.VerifyPassword="verifyPassword",J.UpdatePassword="updatePassword",J.ImportPrivateKeyAccount="importPrivateKeyAccount",J.ImportReadOnlyAccount="importReadOnlyAccount",J.ImportSeedAccount="importSeedAccount",J.ImportSeedlessAccount="importSocialSeedAccount",J.IsExistingSeed="isExistingSeed",J.AddAccountForSeed="addAccountForSeed",J.AddAccountForSeedless="addAccountForSeedless",J.AddLedgerAccounts="addLedgerAccounts",J.DeriveAddresses="deriveAddresses",J.ExportPrivateKey="exportPrivateKey",J.ExportEntropy="exportEntropy",J.SetAccountIcon="setAccountIcon",J.RemoveAccount="removeAccount",J.ReorderAccount="reorderAccount",J.GetAllAccounts="getAllAccounts",J.GetAllSeeds="getAllSeeds",J.GetAllSeedless="getAllSeedlessSeeds",J.GetAuthenticationPublicKey="getAuthenticationPublicKey",J.Sign="sign",J.CheckVaultIntegrity="checkVaultIntegrity",J.GetPhantomOrganization="getPhantomOrganization",J.GetOrCreatePhantomOrganization="getOrCreatePhantomOrganization",J.RetrieveKMSWallet="RetrieveKMSWallet",J.GetKMSWalletStatus="GetKMSWalletStatus",J.AddUserToCurrentUserOrganization="addUserToCurrentUserOrganization",J.DeleteUserFromOrganization="deleteUserFromOrganization",J.UpdateUserInOrganization="updateUserInOrganization",J.GetAccounts="getAccounts",J.GetKmsAccounts="getKmsAccounts",J.GetWalletWithTag="getWalletWithTag",J.LogMessage="logMessage",J.DownloadLogs="downloadLogs",J.ProviderInjectionOptions="providerInjectionOptions",J.ServiceWorkerMutexAcquire="serviceWorkerMutexAcquire",J.ServiceWorkerMutexRelease="serviceWorkerMutexRelease",J))(hl||{});u();l();var Vg=i.enum(["Native","Fungible","SemiFungible","NonFungible","Unknown"]),Ur=i.object({id:i.string(),displayName:i.string().optional(),logoURI:i.union([i.string(),i.null()]).optional(),tokenType:Vg,decimals:i.number().optional(),symbol:i.string().optional(),isSpam:i.boolean().optional()}),jg=i.object({id:Dr,displayName:i.string(),logoURI:i.union([i.string(),i.null()]).optional()}),ci=i.object({token:Ur,amount:i.string(),to:Dr,from:Dr}),yl=i.literal("UNCLASSIFIED_APP_INTERACTION"),wl=i.literal("TOKEN_SEND"),Sl=i.literal("TOKEN_BURN"),bl=i.literal("TOKEN_SWAP"),Tl=i.literal("TOKEN_UNWRAP"),Al=i.literal("WITHDRAW_STAKE"),xl=i.literal("DEACTIVATE_STAKE"),El=i.literal("STAKE"),kl=i.literal("COLLECTIBLE_LIST"),Cl=i.literal("COLLECTIBLE_BUY_ITEM"),_l=i.literal("COLLECTIBLE_CANCEL_BID"),Il=i.literal("COLLECTIBLE_BID_ITEM"),Fl=i.literal("COLLECTIBLE_UNLIST"),vl=i.literal("COLLECTIBLE_SELL_ITEM"),Pl=i.literal("CANCEL_TX"),Rl=i.literal("TOKEN_APPROVAL"),Dl=i.literal("CANCEL_ORDER"),Nl=i.literal("COLLECTION_APPROVAL"),Bl=i.literal("BRIDGE_INIT"),dk=i.union([yl,wl,Sl,bl,Tl,Al,xl,El,kl,Cl,_l,Il,Fl,vl,Pl,Rl,Dl,Nl,Bl]),Hg=i.object({transactionType:yl,balanceChanges:i.array(ci),dapp:i.union([Sr,i.null()]).optional()}),$g=i.object({transactionType:wl,balanceChanges:i.array(ci).nonempty(),dapp:i.union([Sr,i.null()]).optional()}),Wg=i.object({transactionType:Sl,dapp:i.union([Sr,i.null()]).optional(),token:Ur,amount:i.string()}),Zg=i.object({transactionType:bl,dapp:i.union([Sr,i.null()]).optional(),receiveToken:Ur,sendToken:Ur,receiveAmount:i.string(),sendAmount:i.string()}),Yg=i.object({transactionType:Tl,token:Ur,amount:i.string()}),Xg=i.object({transactionType:Al,stakeAccount:Dr,amount:i.string()}),Jg=i.object({transactionType:xl,stakeAccount:Dr,amount:i.string()}),eh=i.object({transactionType:El,stakeAccount:Dr,amount:i.string(),validatorName:i.string().optional(),validatorWebsite:i.string().optional(),keybaseUsername:i.string().optional()}),th=i.object({transactionType:Pl}),gn=i.object({dapp:i.union([Sr,i.null()]),itemAmount:i.string().optional(),item:Ur,forAmount:i.string(),forAsset:Ur,listingUrl:i.string().optional()}),rh=gn.merge(i.object({transactionType:kl})),oh=gn.merge(i.object({transactionType:Cl})),nh=gn.merge(i.object({transactionType:_l})),sh=gn.merge(i.object({transactionType:Il})),ah=gn.merge(i.object({transactionType:Fl})),ih=gn.merge(i.object({transactionType:vl})),ch=i.object({transactionType:Rl,dapp:i.union([Sr,i.null()]).optional(),token:Ur,value:i.string().optional(),isApproved:i.boolean()}),uh=i.object({transactionType:Dl,dapp:i.union([Sr,i.null()]).optional(),orderId:i.string()}),lh=i.object({transactionType:Nl,collection:jg,dapp:i.union([Sr,i.null()]).optional(),isApproved:i.boolean()}),ph=i.object({transactionType:Bl,dapp:i.union([Sr,i.null()]).optional(),balanceChanges:i.array(ci).nonempty(),explorerUrl:i.string().optional()}),dh=i.enum(["success","failed"]),mh=i.object({networkFee:i.string().optional(),networkFeePayer:i.string().optional(),status:dh,errorMessage:i.union([i.string(),i.null()]),blockNumber:i.string(),chainId:dt,transactionId:i.string()}),ui=i.object({timestamp:i.number(),owner:Dr,id:Dr,interactionData:i.union([Hg,$g,Wg,Zg,Yg,Xg,Jg,eh,rh,oh,nh,sh,ah,ih,th,ch,uh,lh,ph]),chainMeta:mh}),gt=s(e=>e.split("/")[1]?.split(":").slice(1).join(":"),"extractAddressfromBri");u();l();u();l();var fh=1e-5,gh="0,0.[00000]",mk="0,0.[00]a",fk=1e6,hh=s((e,t=gh)=>{let r=new _(e);if(r.abs().isGreaterThan(0)&&r.abs().isLessThan(fh))return`< ${r.isLessThan(0)?"-":""}${fh}`;let o=(0,Jf.default)(r.toNumber());return t===gh&&r.isGreaterThanOrEqualTo(fk)?o.format(mk):o.format(t)},"formatTokenAmount");var Et=s((e,t)=>{let r=new _(e).div(Tf(t)).toNumber();return hh(r)},"amountToFormattedAmount");u();l();var ko=s(e=>{switch(e){case"SemiFungible":case"NonFungible":return!0;default:return!1}},"isCollectibleTokenType"),Ll=s((e,t)=>{let r=gt(e.to),o=gt(e.from),n=t.some(c=>c.address.toLowerCase()===r.toLowerCase()),a=t.some(c=>c.address.toLowerCase()===o.toLowerCase());return n&&!a},"isReceiveTransaction");u();l();var Ul=D(B());u();l();var yh=s(({interactionData:e,isError:t,selectedAccountAddresses:r,getKnownAddressLabel:o,start:n,networkID:a})=>{let p=e.balanceChanges[0],{token:{symbol:m,displayName:d,tokenType:f,decimals:h},amount:w}=p,y=Ll(p,r),S=ko(f),b=gk({isCollectible:S,sign:y?"+":"-",amount:w,decimals:h,tokenSymbol:m,tokenType:f,isError:t});if(y){let C=gt(p.from),I=Hu(C,void 0,o(C,a));return{topLeft:{text:`${v.t("transactionsReceived")} ${S?d||v.t("richTransactionDetailUnknownNFT"):""}`},topRight:{text:`${b}`,color:"spotPositive"},bottomLeft:{text:v.t("transactionsFromParagraphInterpolated",{from:I,defaultValue:`From ${I}`})},start:n}}let A=gt(p.to),k=Hu(A,void 0,o(A,a));return{topLeft:{text:t?v.t("transactionsSendFailed"):`${v.t("transactionsSent")} ${S?d||v.t("richTransactionDetailUnknownNFT"):""}`},topRight:{text:`${b}`,color:"textBase"},bottomLeft:{text:v.t("transactionsToParagraphInterpolated",{to:k,defaultValue:`To ${k}`})},start:n}},"tokenSendLabel");function gk({isCollectible:e,sign:t,amount:r,decimals:o,tokenSymbol:n,tokenType:a,isError:c}){return c||o===void 0||a==="NonFungible"?"":e?`${t}${Et(r,o)}`:`${t}${Et(r,o)}${n?` ${Tr(n,6)}`:""}`}s(gk,"getValueDisplay");var hk=["So11111111111111111111111111111111111111112","501"],yk=s((e,t,r,o,n)=>{let{interactionData:a,chainMeta:c}=e,{transactionType:p}=a,m=c.status==="failed",d=c.chainId,f=x.getTokenSymbol(d),h=x.getTokenDecimals(d),w=t("historyUnknownDappName"),y=Ul.default.createElement(r,{activityItem:e,size:"small",isDetailViewOrSvg:!1});switch(p){case"TOKEN_SEND":return yh({interactionData:a,isError:m,selectedAccountAddresses:n,getKnownAddressLabel:o,start:y,networkID:d});case"TOKEN_BURN":{let{amount:S,token:T}=a,b="";return T.displayName?S==="1"?b=T.displayName:b=`${T.displayName} (${S})`:b=t("richTransactionDetailUnknownNFT"),{topLeft:{text:m?`${t("transactionsFailedBurn")}`:`${t("transactionsBurned")}`},bottomLeft:{text:b},start:y}}case"TOKEN_UNWRAP":{let{amount:S,token:T}=a;return{topLeft:{text:m?`${t("transactionsUnwrappedFailed")}`:`${t("transactionsUnwrapped")}`},topRight:{text:m?"":`${Et(S,T.decimals??0)} ${T.symbol}`,color:"textBase"},start:y}}case"TOKEN_SWAP":{let{receiveAmount:S,receiveToken:T,sendAmount:b,sendToken:A,dapp:k}=a,C=k?k.displayName:t("historyUnknownDappName"),I=As(gt(A.id)||""),L=As(gt(T.id)||""),Q="";!m&&T.decimals!==void 0&&(Q=`+${Et(S,T.decimals)} ${Tr(T.symbol||L,6)}`);let R="";return!m&&A.decimals!==void 0&&(R=`-${Et(b,A.decimals)} ${Tr(A.symbol||I,6)}`),{topLeft:{text:t(m?"transactionsFailedSwap":"transactionsSwapped")},topRight:{text:Q,color:"spotPositive"},bottomLeft:{text:C},bottomRight:{text:R,color:"textBase"},start:y}}case"BRIDGE_INIT":{let S=a.dapp?a.dapp.displayName:w,b=a.balanceChanges[0],{token:{symbol:A,decimals:k},amount:C}=b,I=A?` ${Tr(A,6)}`:"";if(!m&&k!==void 0){let L=`-${Et(C,k)}${I}`;return{topLeft:{text:m?t("transactionBridgeInitiatedFailed"):`${t("transactionBridgeInitiated")}`},bottomLeft:{text:S},topRight:{text:`${L}`,color:"textBase"},start:y}}return{topLeft:{text:m?t("transactionBridgeInitiatedFailed"):`${t("transactionBridgeInitiated")}`},bottomLeft:{text:S},start:y}}case"WITHDRAW_STAKE":{let{amount:S,stakeAccount:T}=a,b=gt(T),A=x.getTokenSymbol(d);return{topLeft:{text:t(m?"transactionsWithdrawStakeFailed":"transactionsWithdrawStake")},topRight:{text:m?"":`${Et(S,h)} ${Tr(A,6)}`,color:"textBase"},bottomLeft:{text:tn(b,4)},start:y}}case"DEACTIVATE_STAKE":{let{stakeAccount:S}=a,T=gt(S);return{topLeft:{text:t(m?"transactionsDeactivateStakeFailed":"transactionsDeactivateStake")},bottomLeft:{text:tn(T,4)},start:y}}case"STAKE":{let{amount:S,stakeAccount:T,validatorName:b}=a,A=gt(T);return{topLeft:{text:t(m?"transactionsStakedFailed":"transactionsStaked")},topRight:{text:m?"":`${Et(S,h)} ${Tr(f,6)}`,color:"textBase"},bottomLeft:{text:b||tn(A,4)},start:y}}case"COLLECTIBLE_LIST":{let{dapp:S,item:T}=a,b=S?S.displayName:t("historyUnknownDappName"),A=T.displayName||t("richTransactionDetailUnknownNFT");return{topLeft:{text:m?t("transactionsListedFailed"):t("transactionsListedInterpolated",{name:A})},bottomLeft:{text:b},start:y}}case"COLLECTIBLE_BUY_ITEM":{let{dapp:S,itemAmount:T,item:b,forAsset:A,forAmount:k}=a,C=S?S.displayName:t("historyUnknownDappName"),I=wh(k,A.decimals,Tr(A.symbol||"",6)),L=b.symbol||As(gt(b.id)),Q=T&&b.tokenType==="SemiFungible"?`+${T} ${L}`:`+${L}`;return{topLeft:{text:t(m?"transactionsBuyFailed":"transactionsBoughtCollectible")},topRight:{text:m?"":Q,color:"spotPositive"},bottomRight:{text:m?"":`${I}`,color:"textBase"},bottomLeft:{text:C},start:y}}case"COLLECTIBLE_CANCEL_BID":{let{dapp:S,item:T}=a,b=S?S.displayName:t("historyUnknownDappName"),A=T.displayName||t("richTransactionDetailUnknownNFT");return{topLeft:{text:m?t("transactionsCancelBidOnFailed"):t("transactionsCancelBidOnInterpolated",{name:A})},bottomLeft:{text:b},start:y}}case"COLLECTIBLE_BID_ITEM":{let{dapp:S,item:T}=a,b=S?S.displayName:t("historyUnknownDappName"),A=T.displayName||t("richTransactionDetailUnknownNFT");return{topLeft:{text:m?t("transactionsBidFailed"):t("transactionsBidOnInterpolated",{name:A})},bottomLeft:{text:b},start:y}}case"COLLECTIBLE_UNLIST":{let{dapp:S,item:T}=a,b=S?S.displayName:t("historyUnknownDappName"),A=T.displayName||t("richTransactionDetailUnknownNFT");return{topLeft:{text:m?t("transactionsUnlistedFailed"):t("transactionsUnlistedInterpolated",{name:A})},bottomLeft:{text:b},start:y}}case"COLLECTIBLE_SELL_ITEM":{let{dapp:S,itemAmount:T,item:b,forAsset:A,forAmount:k}=a,C=S?S.displayName:t("historyUnknownDappName"),I=A.decimals!==void 0?`+${Et(k,A.decimals)} ${Tr(A.symbol||"",6)}`:t("transactionsUnknownAmount"),L=b.symbol||As(gt(b.id)),Q=T&&b.tokenType==="SemiFungible"?`-${T} ${L}`:`-${L}`;return{topLeft:{text:t(m?"transactionsSoldFailed":"transactionsSoldCollectible")},topRight:{text:m?"":`${I}`,color:"spotPositive"},bottomRight:{text:m?"":Q,color:"textBase"},bottomLeft:{text:C},start:y}}case"CANCEL_TX":return{topLeft:{text:t(m?"transactionCancelledFailed":"transactionCancelled")},start:y};case"TOKEN_APPROVAL":{let{dapp:S,token:T,isApproved:b}=a,A=ko(T.tokenType)?T.displayName:T.symbol,k;return m?b?ko(T.tokenType)?k=t("transactionApproveTokenFailed",{tokenSymbol:A}):k=t("transactionApprovalFailed"):ko(T.tokenType)?k=t("transactionRevokeApproveTokenFailed",{tokenSymbol:A}):k=t("transactionRevokeFailed"):b?k=t("transactionApproveToken",{tokenSymbol:A}):k=t("transactionRevokeApproveToken",{tokenSymbol:A}),{topLeft:{text:k},bottomLeft:{text:S?S.displayName:w,color:"textIncidental"},start:y}}case"COLLECTION_APPROVAL":{let{collection:S,isApproved:T,dapp:b}=a,A=S.displayName,k;return m?T?k=t("transactionApproveTokenFailed",{tokenSymbol:A}):k=t("transactionRevokeApproveTokenFailed",{tokenSymbol:A}):T?k=t("transactionApproveToken",{tokenSymbol:A}):k=t("transactionRevokeApproveToken",{tokenSymbol:A}),{topLeft:{text:k},bottomLeft:{text:b?b.displayName:w,color:"textIncidental"},start:y}}case"CANCEL_ORDER":{let{dapp:S}=a;return{topLeft:{text:t(m?"transactionCancelOrderFailed":"transactionCancelOrder")},bottomLeft:{text:S?.displayName||t("historyUnknownDappName"),color:"textIncidental"},start:y}}case"UNCLASSIFIED_APP_INTERACTION":{let{dapp:S}=a,T=S?S.displayName:w;return{topLeft:{text:t(m?"transactionsFailedAppInteraction":"transactionsAppInteraction")},bottomLeft:{text:T},start:y}}}},"createActivityRowLabels"),wk=s((e,t)=>{let{display:r,type:o}=e,{topLeft:n,topRight:a,bottomLeft:c,bottomRight:p}=r.summary,m=Ul.default.createElement(t,{logoUri:r.summary.logoUri,pendingTransactionType:o,size:"small"});return{topLeft:n,topRight:a,bottomLeft:c,bottomRight:p,start:m}},"createPendingTransactionRowLabels"),Ol=s((e,t,r)=>{let o=(e??[]).map(If);if(t){let n=o.find(a=>a.chainId===t)?.address;if(n){let a={chainId:t,address:n};r&&(a.filters=[{type:"token",value:r}]),o=[a]}}return o},"getAccountsWithFilter"),Ml=s(e=>{if(!e)return;let t=X(e);if(t.resourceType!==ee.nativeToken)return e.type===oe.SPL?e.data.splTokenAccountPubkey:t.address},"getTokenActivityFilterId"),Sk=s((e,t)=>{let r=gt(e.id);return hk.includes(r)&&(e.tokenType="Native"),e.tokenType==="Native"?{chainId:t,slip44:x.getSlip44(t),resourceType:ee.nativeToken}:{chainId:t,address:r,resourceType:ee.address}},"getFungibleCaip19FromToken"),wh=s((e,t,r)=>{if(!e||!t)return v.t("transactionsUnknownAmount");let o=Ee(e,t),n=o.abs(),a=o.isZero()?"":o.isPositive()?"-":"+",c=ir(n);return`${a}${c} ${r}`},"formatPaidAmount");u();l();var Is=D(B());var bk=i.object({orderIds:i.array(i.object({bytesValue:i.string(),bytesArrayValue:i.string(),stringValue:i.string()}))}),Tk=s(async(e,t)=>{if(t==="LI.FI")return{label:v.t("transactionBridgeStatusLink",{dappName:"LI.FI"}),value:`https://explorer.li.fi/tx/${e}`};if(t==="deBridge")try{let r=await K.get(`https://stats-api.dln.trade/api/Transaction/${e}/orderIds`),o=bk.safeParse(r.data);if(!o.success){P.captureError(new Error("Failed to parse deBridge response"),O.History);return}let n=o.data.orderIds[0]?.stringValue;if(!n){P.captureError(new Error("No orderId found in deBridge response"),O.History);return}return{label:v.t("transactionBridgeStatusLink",{dappName:"DeBridge"}),value:`https://app.debridge.finance/order?orderId=${n}`}}catch(r){P.captureError(new Error(`Could not fetch bridge explorer url: ${r}`),O.History);return}},"getBridgeExplorerUrl"),Ak=s((e,t)=>{let[r,o]=(0,Is.useState)(),[n,a]=(0,Is.useState)(!1);return(0,Is.useEffect)(()=>{e&&t&&s(async()=>{a(!0);try{let p=await Tk(e,t);o(p)}finally{a(!1)}},"fetchBridgeUrl")()},[e,t]),{bridgeUrl:r,isLoading:n}},"useBridgeExplorerUrl");u();l();u();l();u();l();var kt={showTimeToMineRowInPendingTransactionDetail:!1,showFeeRowInPendingTransactionDetail:!0};var Sh={...kt};u();l();var bh={...kt};u();l();var Th={showTimeToMineRowInPendingTransactionDetail:!1,showFeeRowInPendingTransactionDetail:!1};u();l();var Ah={...kt,showTimeToMineRowInPendingTransactionDetail:!0};u();l();var xh={...kt};u();l();var Eh={...kt};u();l();var kh={...kt};u();l();var Ch={...kt};u();l();var _h={showTimeToMineRowInPendingTransactionDetail:!1,showFeeRowInPendingTransactionDetail:!1};u();l();var Ih={showTimeToMineRowInPendingTransactionDetail:!1,showFeeRowInPendingTransactionDetail:!1};var xk=new Zo({[se.Solana]:_h,[se.Ethereum]:Ah,[se.Polygon]:Ch,[se.Monad]:kh,[se.Base]:bh,[se.Arbitrum]:Sh,[se.Bitcoin]:Th,[se.Sui]:Ih,[se.Hypercore]:xh,[se.Hyperevm]:Eh}),Fh=Wo(xk);u();l();u();l();u();l();u();l();var Ph=D(B(),1);var vh=new WeakMap;function Rh(e,t){let r=Gf(t),o=Ek(r);for(let[n,a]of e)(!o.has(n)||t?.dangerouslyForceHydrate)&&(o.add(n),r.set(n,a))}s(Rh,"useHydrateAtoms");var Ek=s(e=>{let t=vh.get(e);return t||(t=new WeakSet,vh.set(e,t)),t},"getHydratedSet");var Mh=D(B());u();l();var Uh=D(B());u();l();var kk=10,Ck="/history/v2",Fs=class extends Error{static{s(this,"ActivityItemsFetchCacheBustError")}message="406: Cache bust!"},li=class extends Error{static{s(this,"ActivityItemsFetchResponseMalformed")}message="Server response malformed."},Ql=class extends Error{static{s(this,"ActivityItemsFetchServerError")}},ql=class extends Error{static{s(this,"ActivityItemsFetchClientError")}},Dh=i.object({next:i.union([i.null(),i.string()]),results:i.array(ui)}),Nh=s(async e=>{let t=await K.api().retry(3,2e3).post(`${Ck}`,e);if(t.status===406)throw new Fs;if(t.status>=400&&t.status<500)throw new ql(`FetchActivityItem: Status code: ${t.status}`);if(t.status>=500)throw new Ql(`FetchActivityItem: Status code: ${t.status}`);return t.data},"_fetch"),Bh=s(e=>!Array.isArray(e.results)||typeof e.next!="string"&&e.next!==null,"isResponseMalformed"),zl=s(async e=>{let t=await Nh(e);if(Bh(t))throw new li;for(;t.results?.length<kk&&t.next;){if(Bh(t))throw new li;let r=await Nh({next:t.next,isSpam:e.isSpam});t.next=r.next,t.results=[...t.results,...r.results]}try{return Dh.parse(t)}catch(r){let o=r,n=[],a=o.issues;for(let m=0;m<a.length;++m){let d=a[m].path;if(d[0]!=="results")throw P.captureError(o,O.History),o;let f=d[1];if(typeof f!="number")throw P.captureError(o,O.History),o;n.push(f)}n.sort(function(m,d){return d-m});let c=n.map(m=>t.results[m]).map(m=>m.interactionData?.transactionType||""),p=[];for(let m=0;m<n.length;++m){let d=n[m],f=t.results[d],h={timestamp:f?.timestamp,owner:f?.owner,id:f?.id,chainMeta:f?.chainMeta,interactionData:{transactionType:"UNCLASSIFIED_APP_INTERACTION",balanceChanges:[]}};try{ui.parse(h),t.results[d]=h,p.push(d)}catch{}}for(let m=0;m<n.length;++m){let d=n[m];p.indexOf(d)===-1&&t.results.splice(d,1)}n.length&&console.error(`Removed history items, ${c.join(",")}`);try{return Dh.parse(t)}catch(m){let d=m;throw P.captureError(d,O.History),d}}},"fetchActivityItems");var _k=3e5,vs="fetch-infinite-activity-items",Oh=s(({accounts:e,isSpam:t})=>[vs,e,t],"infiniteActivityItemsQueryKey"),Ik=s((e,t)=>{e.removeQueries({queryKey:t})},"bustCache"),Gl=s(({accounts:e,isSpam:t})=>{let r=Qe();(0,Uh.useEffect)(()=>()=>{r.cancelQueries({queryKey:[vs],exact:!1})},[r]);let o=Oh({accounts:e,isSpam:t});return jm({queryKey:o,queryFn:s(async({pageParam:c})=>{try{let p;c&&c!==""?p=await zl({next:c,isSpam:t}):p=await zl({accounts:e||[],isSpam:t});let m=p.results.map(d=>(d.interactionData.transactionType==="TOKEN_SEND"&&d.interactionData.balanceChanges.sort(Fk(e)),d));return{...p,results:m}}catch(p){throw p instanceof Fs&&Ik(r,o),P.captureError(p,O.History),p}},"queryFn"),getNextPageParam:s(c=>c?.next,"getNextPageParam"),staleTime:_k,retry:!1,enabled:!!e?.length&&e.every(c=>!x.isLocalNetworkID(c.chainId)),initialPageParam:""})},"useFetchInfiniteActivityItems");function Fk(e){return(t,r)=>{let o=Lh(t,e),n=Lh(r,e);return o?-1:n?1:0}}s(Fk,"balanceChangeSort");function Lh(e,t){let r=e.to.split("/address:")[1],o=e.from.split("/address:")[1];return t.some(n=>n.address.toLowerCase()===r.toLowerCase()||n.address.toLowerCase()===o.toLowerCase())}s(Lh,"findRelevantTransfers");var vk=s(({fungible:e,isSpam:t=!1})=>{let{data:r=Zm,status:o}=rf(),n=r.isDeveloperMode,a=Ml(e),{data:c}=lf({address:e?.data.walletAddress,networkID:e?.data.chain.id}),p=(0,Mh.useMemo)(()=>Ol(c?[c]:[],e?.data.chain.id,a),[c,e?.data.chain.id,a]),m=Gl({accounts:p,isSpam:t}),d=m.isPending||o==="pending";return{activityItemsData:m,isLoadingHistory:d,isDeveloperMode:n}},"useFungibleActivityByFungible");u();l();var Qh=s(e=>e.replace(/^(^[\w-_]*:\/\/)?(?:www\.)?/i,"").split("/")[0],"removeWebPrefixes");u();l();u();l();var cr="Auto";var ve={buyFungible:void 0,buyUsdValue:void 0,sellFungible:void 0,sellUsdValue:void 0,sellAmount:"",uiSellAmountCryptoInput:"",amountType:"sell",quoteResponse:void 0,selectedProviderIndex:0,selectedBaseProvider:cr,gasEstimation:{isFetching:!1,estimate:void 0,estimateWithBuffer:void 0},hasNoRoutes:!1,isFetchingQuote:!1,error:null,searchQuery:"",numSearchResults:0,primaryCurrency:"crypto",uiSellAmountLocalFiatInput:"",uiBuyAmountCryptoInput:"",uiBuyAmountLocalFiatInput:"",canInputFiatSellAmount:!1,swapFilter:void 0},V=Ye(e=>({...ve,resetQuote:s(()=>e({quoteResponse:ve.quoteResponse,isFetchingQuote:ve.isFetchingQuote,hasNoRoutes:ve.hasNoRoutes,selectedProviderIndex:ve.selectedProviderIndex,error:ve.error,uiSellAmountLocalFiatInput:ve.uiSellAmountLocalFiatInput,selectedBaseProvider:ve.selectedBaseProvider}),"resetQuote"),resetSwapper:s(()=>e({quoteResponse:ve.quoteResponse,gasEstimation:ve.gasEstimation,error:ve.error,sellAmount:"",uiSellAmountCryptoInput:"",uiBuyAmountCryptoInput:ve.uiBuyAmountCryptoInput,swapFilter:ve.swapFilter,selectedBaseProvider:ve.selectedBaseProvider,selectedProviderIndex:ve.selectedProviderIndex}),"resetSwapper"),setBuyFungible:s(t=>e({buyFungible:t}),"setBuyFungible"),setBuyUsdValue:s(t=>e({buyUsdValue:t}),"setBuyUsdValue"),setHasNoRoutes:s(t=>e({hasNoRoutes:t}),"setHasNoRoutes"),setIsFetchingQuote:s(t=>e({isFetchingQuote:t}),"setIsFetchingQuote"),setQuoteResponse:s(t=>e({quoteResponse:t,hasNoRoutes:!1}),"setQuoteResponse"),setSelectedProviderIndex:s(t=>e({selectedProviderIndex:t}),"setSelectedProviderIndex"),setSelectedBaseProvider:s(t=>e({selectedBaseProvider:t}),"setSelectedBaseProvider"),setGasEstimation:s(({estimate:t,estimateWithBuffer:r,isFetching:o})=>e(n=>({gasEstimation:{...n.gasEstimation,...t!==void 0&&{estimate:t},...r!==void 0&&{estimateWithBuffer:r},...o!==void 0&&{isFetching:o}}})),"setGasEstimation"),setSellAmount:s(t=>e({sellAmount:t}),"setSellAmount"),setAmountType:s(t=>e({amountType:t}),"setAmountType"),setSellUsdValue:s(t=>e({sellUsdValue:t}),"setSellUsdValue"),setSellFungible:s(t=>e({sellFungible:t}),"setSellFungible"),setUiSellAmountCryptoInput:s(t=>e({uiSellAmountCryptoInput:t}),"setUiSellAmountCryptoInput"),setError:s(t=>e({error:t}),"setError"),setSearchQuery:s(t=>e({searchQuery:t}),"setSearchQuery"),setNumSearchResults:s(t=>e({numSearchResults:t}),"setNumSearchResults"),setPrimaryCurrency:s(t=>e({primaryCurrency:t}),"setPrimaryCurrency"),setUiSellAmountLocalFiatInput:s(t=>e({uiSellAmountLocalFiatInput:t}),"setUiSellAmountLocalFiatInput"),setUiBuyAmountCryptoInput:s(t=>e({uiBuyAmountCryptoInput:t}),"setUiBuyAmountCryptoInput"),setUiBuyAmountLocalFiatInput:s(t=>e({uiBuyAmountLocalFiatInput:t}),"setUiBuyAmountLocalFiatInput"),setCanInputFiatSellAmount:s(t=>e({canInputFiatSellAmount:t}),"setCanInputFiatSellAmount"),setSwapFilter:s(t=>e({swapFilter:t}),"setSwapFilter"),switchTokensForSell:s(()=>{e(t=>{let r=t.sellFungible??t.buyFungible,o=t.buyFungible??t.sellFungible,n=t.uiBuyAmountCryptoInput,a=t.uiBuyAmountLocalFiatInput;return{sellFungible:o,buyFungible:r,uiSellAmountCryptoInput:n,uiSellAmountLocalFiatInput:a,uiBuyAmountCryptoInput:ve.uiBuyAmountCryptoInput,uiBuyAmountLocalFiatInput:ve.uiBuyAmountLocalFiatInput,sellAmount:n,swapFilter:void 0,selectedBaseProvider:t.selectedBaseProvider}})},"switchTokensForSell"),switchTokensForBuy:s(()=>{e(t=>{let r=t.sellFungible??t.buyFungible,o=t.buyFungible??t.sellFungible,n=t.uiSellAmountCryptoInput,a=t.uiSellAmountLocalFiatInput;return{sellFungible:o,buyFungible:r,uiSellAmountCryptoInput:ve.uiSellAmountCryptoInput,uiSellAmountLocalFiatInput:ve.uiSellAmountLocalFiatInput,uiBuyAmountCryptoInput:n,uiBuyAmountLocalFiatInput:a,sellAmount:n,swapFilter:void 0,selectedBaseProvider:t.selectedBaseProvider}})},"switchTokensForBuy"),resetUiAmounts:s(()=>e({uiSellAmountCryptoInput:ve.uiSellAmountCryptoInput,uiSellAmountLocalFiatInput:ve.uiSellAmountLocalFiatInput,uiBuyAmountCryptoInput:ve.uiBuyAmountCryptoInput,uiBuyAmountLocalFiatInput:ve.uiBuyAmountLocalFiatInput,sellAmount:ve.sellAmount,selectedBaseProvider:ve.selectedBaseProvider}),"resetUiAmounts"),setPairAndAmount:s(({sell:t,buy:r,swapAmount:o})=>e(n=>{let a="uiSellAmountCryptoInput";return o.perspective==="sell"?n.primaryCurrency==="crypto"?a="uiSellAmountCryptoInput":a="uiSellAmountLocalFiatInput":n.primaryCurrency==="crypto"?a="uiBuyAmountCryptoInput":a="uiBuyAmountLocalFiatInput",{...n,sellFungible:t,buyFungible:r,[a]:o.amount,sellAmount:o.amount}}),"setPairAndAmount")}));u();l();var pi=i.object({name:i.string(),message:i.string()}),Vh=i.object({chainId:dt,name:i.string(),symbol:i.string(),decimals:i.number(),logoURI:i.optional(i.string()),includesBridge:i.optional(i.boolean())}),Pk=Vh.extend({address:i.string(),resourceType:i.literal(ee.address)}),Rk=Vh.extend({slip44:i.string(),resourceType:i.literal(ee.nativeToken)}),b2=i.union([Pk,Rk]),jh=i.object({id:i.string(),name:i.string(),logoUri:i.string()}),Dk=i.union([i.enum(["network","phantom","gasless","ata","gasless_network","tips","priority_fee"]),i.string()]),Nk=i.object({name:i.string(),percentage:i.number(),amount:i.number(),type:Dk}),Bk=i.object({name:i.string(),proportion:i.string()}),Hh=i.object({sellAmount:i.string(),buyAmount:i.string(),rfqProps:i.optional(i.object({expireAt:i.number(),quoteId:i.string()})),analyticsContext:i.optional(i.string())}),di=Hh.extend({priceImpact:i.number(),sources:i.array(Bk),fees:i.array(Nk),slippageTolerance:i.optional(i.number()),baseProvider:jh}),Lk=i.object({success:i.boolean(),error:i.string().optional(),data:i.object({ataFeeUSD:i.number().optional(),networkFeeUSD:i.number().optional(),totalAmountUSD:i.number().optional()}).optional()}),Uk=i.enum(["sync","async"]),mi=di.extend({transactionData:i.array(i.string()),gaslessSignature:i.optional(i.string()),gaslessSwapFeeResult:i.optional(Lk),executionMode:i.optional(Uk)}),Ok=mi,T2=di.extend({transactionData:i.array(i.string())}),Kl=di.extend({allowanceTarget:i.string(),exchangeAddress:i.string(),gas:i.number(),value:i.string(),transactionData:i.string()}),Vl=di.extend({transactionData:i.array(i.string())}),qh=i.object({name:i.string(),amount:i.string(),token:Ut,percentage:i.string(),included:i.boolean(),amountUSD:i.optional(i.string())}),Mk=i.object({name:i.string(),key:i.string(),logoURI:i.string()}),$h=i.object({name:i.string(),symbol:i.string()}),Qk=i.object({transactionData:i.string(),buyToken:Ut,sellToken:Ut,nonIncludedNonGasFees:i.string(),feeCosts:i.array(qh),chainId:dt,tool:Mk,value:i.optional(i.string()),allowanceTarget:i.optional(i.string()),approvalMetadata:i.optional($h),approvalExactAmount:i.optional(i.string()),exchangeAddress:i.optional(i.string()),gasCosts:i.optional(i.array(i.number())),includedFeeCosts:i.optional(i.array(qh))}),jl=Hh.extend({baseProvider:jh,executionDuration:i.number(),tags:i.array(i.string()),steps:i.array(Qk)}),qk=i.union([mi,Kl,Vl,jl,Ok]),Ps=i.enum(["solana","eip155","sui","xchain"]),fi=i.object({type:Ps,taker:Ut,buyToken:Ut,sellToken:Ut,slippageTolerance:i.number(),simulationTolerance:i.optional(i.number()),gasBuffer:i.optional(i.number()),quotes:i.array(qk),tradeFee:i.optional(i.array(i.number())),estimateGasFee:i.optional(i.array(i.number())),includesAllProviders:i.optional(i.boolean())}),zk=i.enum(["swap-approval","swap","bridge-approval","bridge"]),Gk=i.enum(["swap","bridge"]),Kk=i.enum(["swap","bridge"]),Vk=i.enum(["bridge"]),gi=i.object({sellToken:Ut,buyToken:Ut,approvalMetadata:i.optional($h)}),jk=i.object({type:i.literal("solana"),transactions:i.array(i.string()),transactionTypes:i.array(Gk),transactionPairs:i.optional(i.array(gi))});var Hk=i.object({type:i.literal("evm"),transactions:i.array(Ho),transactionTypes:i.array(zk),transactionPairs:i.optional(i.array(gi))}),$k=i.object({type:i.literal("sui"),transactions:i.array(i.string()),transactionTypes:i.array(Kk),transactionPairs:i.optional(i.array(gi))}),Wk=i.object({type:i.literal("bitcoin"),transactions:i.array(i.string()),transactionTypes:i.array(Vk),transactionPairs:i.optional(i.array(gi))}),A2=i.union([jk,Hk,$k,Wk]),zh;(function(e){e.Pricing="pricing",e.Provider="provider",e.ProviderPressable="providerPressable",e.ExchangeRate="exchangeRate",e.PriceImpact="priceImpact",e.Network="network",e.ExecutionDuration="executionDuration",e.Slippage="slippage",e.SlippagePressable="slippagePressable",e.Fees="fees",e.HighPriceImpact="highPriceImpact",e.HighSlippage="highSlippage",e.TransferFees="transferFees"})(zh||(zh={}));var Zk=i.object({name:i.string(),amount:i.string()}).strict(),Yk=i.object({name:i.string(),feeUsd:i.number().nullish(),amount:i.string(),time:i.object({text:i.string(),isFast:i.boolean()}),logoURI:i.string()}),x2=i.union([Zk,Yk]),Gh;(function(e){e.Buy="buy",e.Sell="sell"})(Gh||(Gh={}));var Kh;(function(e){e.SwapProviders="SwapProviders",e.SwapReview="SwapReview",e.SwapTermsOfService="SwapTermsOfService",e.SwapConfirmation="SwapConfirmation",e.InsufficientBalance="InsufficientBalance"})(Kh||(Kh={}));u();l();function ne(e){return jl.safeParse(e).success}s(ne,"isBridgeQuote");var Ct=s(e=>mi.safeParse(e).success,"isSolanaSwapQuote"),Wh=s(e=>Ct(e),"isCashSwapQuote");function ur(e){return Kl.safeParse(e).success}s(ur,"isEvmSwapQuote");function Or(e){return Vl.safeParse(e).success}s(Or,"isSuiSwapQuote");function Zh(e){return e?"gaslessSignature"in e:!1}s(Zh,"isGaslessSwapQuote");function Ar(e){return Ct(e)||ur(e)||Or(e)}s(Ar,"isSingleNetworkSwapQuote");u();l();var Se;(function(e){e.Idle="idle",e.Started="started",e.Simulating="simulating",e.SimulationRequestErrored="simulationRequestErrored",e.SimulationFailed="simulationFailed",e.SimulationSkipped="simulationSkipped",e.Simulated="simulated",e.SubmittingTransaction="submittingTransaction",e.TransactionSubmissionFailed="transactionSubmissionFailed",e.TransactionSubmitted="transactionSubmitted",e.ConfirmingTransaction="confirmingTransaction",e.TransactionNotConfirmed="transactionNotConfirmed",e.TransactionConfirmed="transactionConfirmed"})(Se||(Se={}));u();l();var j;(function(e){e.ExecuteSwapStarted="executeSwapStarted",e.SimulationRequestStarted="simulationRequestStarted",e.SimulationPassed="simulationPassed",e.SimulationFailed="simulationFailed",e.SimulationSkipped="simulationSkipped",e.SubmittingTransaction="submittingTransaction",e.TransactionSubmissionFailed="transactionSubmissionFailed",e.TransactionSubmissionStarted="transactionSubmissionStarted",e.TransactionSubmissionSuccess="transactionSubmissionSuccess",e.TransactionConfirmationStarted="transactionConfirmationStarted",e.TransactionConfirmationFailed="transactionConfirmationFailed",e.TransactionConfirmed="transactionConfirmed"})(j||(j={}));u();l();function ct(e){return e.type==="pair"||e.type==="changingToken"||e.type==="refreshing"}s(ct,"hasPair");u();l();var Pt=D(B());u();l();u();l();u();l();u();l();var to="cash-account",Xk="grouped-balances",Rs=[to,Xk],Hl=[to,"cash-activity"],ro={account:s((e,t)=>[to,"account",{userId:e,isCashEnabled:t}],"account"),balance:s((e,t)=>[to,"balance",{userId:e,isCashEnabled:t}],"balance"),cashKMSAccount:s(e=>[to,"kms-account",{user:e}],"cashKMSAccount"),bankDetails:s(e=>[to,"bankDetails",{user:e}],"bankDetails"),enrollment:s(e=>[to,"enrollment",{userId:e}],"enrollment"),groupedBalances:s((e,t,r)=>[...Rs,{userID:e,addresses:t,isCashEnabled:r}],"groupedBalances"),lastBroadcastDate:s(()=>[to,"lastBroadcastDate"],"lastBroadcastDate"),cashActivity:s((e,t)=>[...Hl,{userID:e?.userID,params:t}],"cashActivity")};var hi=s((e,t)=>e.invalidateQueries({queryKey:ro.balance(t)}),"invalidateCashBalance"),Yh=s(e=>e.invalidateQueries({queryKey:Rs}),"invalidateGroupedBalances"),Xh=s(e=>e.invalidateQueries({queryKey:Hl}),"invalidateCashActivity");var Jh=s(async(e,t)=>{let r=new Date().toISOString();await t.set("cash-account:lastBroadcastDate",r),e.setQueryData(ro.lastBroadcastDate(),r),await e.invalidateQueries({queryKey:ro.lastBroadcastDate()})},"invalidateLastBroadcastDate");u();l();u();l();u();l();function ey(e){return e.toLowerCase().replace(/(^|\s|\.)(\w)/g,(t,r,o)=>r+o.toUpperCase())}s(ey,"toTitleCase");u();l();var $l;(function(e){e.NotEnrolled="not_enrolled",e.Unverified="unverified",e.Verified="verified",e.Suspended="suspended",e.Closed="closed"})($l||($l={}));var Wl;(function(e){e.Crypto="crypto",e.CryptoRecover="crypto_recover",e.Banking="banking",e.Fiat="fiat",e.Cards="cards",e.PaymentLinks="payment_links",e.AccountManagement="account_management"})(Wl||(Wl={}));var Zl;(function(e){e.NotEnrolled="not_enrolled",e.Unverified="unverified",e.Verified="verified"})(Zl||(Zl={}));var Mr;(function(e){e.PhantomUsername="phantom_username",e.Signup="signup",e.Tos="tos",e.Kyc="kyc",e.EmailVerification="email_verification",e.DataSharingConsent="data_sharing_consent",e.L1KycVerification="l1_kyc_verification",e.L2DocumentVerification="l2_document_verification"})(Mr||(Mr={}));var yi;(function(e){e.Pending="pending",e.Completed="completed",e.Verified="verified",e.Failed="failed",e.Rejected="rejected",e.NotStarted="not_started",e.Expired="expired",e.NotApplicable="not_applicable"})(yi||(yi={}));var ty=i.nativeEnum($l),Jk=i.nativeEnum(Wl),ry=i.nativeEnum(Zl),eC=i.nativeEnum(Mr),tC=i.nativeEnum(yi),rC=i.object({type:eC,status:tC.nullish().transform(N),description:i.string().nullish().transform(N),url:i.string().nullish().transform(N),errorMessage:i.string().nullish().transform(N),metadata:i.record(i.string(),i.any()).nullish().transform(N)}),wi;(function(e){e.NotStarted="not_started",e.Pending="pending",e.Failed="failed",e.Rejected="rejected",e.Verified="verified"})(wi||(wi={}));var oC=i.object({kycStartedAt:i.string().nullish().transform(N),idVerificationStatus:i.nativeEnum(wi).nullish().transform(N),kycVerificationStatus:i.nativeEnum(wi).nullish().transform(N)}),nC=i.object({consentTimestamp:i.string().nullish().transform(N),consented:i.boolean().nullish().transform(N)}),sC=i.object({authIntentId:i.string().nullish().transform(N)}),aC=i.object({kycMetadata:oC.nullish().transform(N),dataSharing:nC.nullish().transform(N),authIntent:sC.nullish().transform(N)}),iC=i.object({type:i.string(),required:i.boolean(),description:i.string().nullish().transform(N)}),cC=i.object({type:i.nativeEnum(Mr),required:i.boolean(),description:i.string(),data:i.object({type:i.union([i.literal(Mr.DataSharingConsent),i.literal(Mr.L1KycVerification),i.literal(Mr.L2DocumentVerification)]).nullish().transform(N),currentStatus:i.nativeEnum(yi).nullish().transform(N),authIntentId:i.string().nullish().transform(N),consentRequired:i.boolean().nullish().transform(N)}).nullish().transform(N)}),Si;(function(e){e.NotStarted="not_started",e.Pending="pending",e.Failed="failed",e.RegionLocked="region_locked",e.NeedsMoreInfo="needs_more_info",e.Completed="completed",e.CardReady="card_ready"})(Si||(Si={}));var Yl=i.object({accountStatus:ty.nullish().transform(N),features:i.array(Jk).optional().default([]),availableTransitions:i.array(ty).optional().default([]),canAdvance:i.boolean().optional().default(!1),currentTier:ry.nullish().transform(N),nextTier:ry.nullish().transform(N),nextTierDescription:i.string().nullish().transform(N),nextTierRequirements:i.array(rC).optional().default([]),nextTierRequiredFields:i.record(i.string(),iC).nullish().transform(N),nextSteps:i.array(cC).optional().default([]),verificationState:i.nativeEnum(Si).nullish().transform(N),metadata:aC.nullish().transform(N)});var bi;(function(e){e.NotSubmitted="not_submitted",e.Accepted="accepted",e.NotAccepted="not_accepted"})(bi||(bi={}));var Ti;(function(e){e.NotSubmitted="not_submitted",e.Incomplete="incomplete",e.PendingReview="pending",e.Approved="approved",e.Rejected="rejected"})(Ti||(Ti={}));var Ai;(function(e){e.Crypto="crypto",e.CryptoRecover="crypto_recover",e.Banking="banking",e.Fiat="fiat",e.Cards="cards",e.PaymentLinks="payment_links",e.AccountManagement="account_management"})(Ai||(Ai={}));var uC=s(e=>Object.values(Ai).includes(e),"canUseCashAccountFeature"),Ve;(function(e){e.Pending="pending",e.Processing="processing",e.Completed="completed",e.Failed="failed",e.Canceled="canceled",e.Unknown="unknown"})(Ve||(Ve={}));var xi;(function(e){e.Debit="debit",e.Credit="credit"})(xi||(xi={}));var Ei;(function(e){e.Transfer="transfer",e.Swap="swap",e.PerpsFunding="perps_funding",e.Refund="refund",e.KycUpdate="kyc_update",e.AccountUpdate="account_update",e.Microdeposit="microdeposit",e.UserCardLock="user_card_lock",e.UserCardUnlock="user_card_unlock",e.PhantomCardLock="phantom_card_lock",e.PhantomCardUnlock="phantom_card_unlock",e.CardTransaction="card_transaction",e.CardPinUpdated="card_pin_updated",e.Onramp="onramp",e.Delegation="delegation",e.Unknown="unknown"})(Ei||(Ei={}));var ki=class extends Error{static{s(this,"CashAccountNotFoundError")}constructor(t){super(`Cash account not found for user ${t}. User is not enrolled in cash account.`),this.name="CashAccountNotFoundError"}},Ci=class extends Error{static{s(this,"CashAccountValidationError")}zodError;responseData;constructor(t,r){let o=t.issues.map(n=>`${n.path.length>0?n.path.join("."):"root"}: ${n.message}`).join("; ");super(`Cash account validation failed: ${o}`),this.name="CashAccountValidationError",this.zodError=t,this.responseData=r}},Fi=i.object({id:i.string(),primaryEmail:i.string().nullish().transform(N),accountStatus:i.string().nullish().transform(N),addressDetails:i.object({address:i.string()}),features:i.array(i.string()).transform(e=>e.filter(uC)),limits:i.object({dailyFiatTransfer:i.string().nullish().transform(N),monthlyFiatTransfer:i.string().nullish().transform(N)}).nullish().transform(N),waitlistDetails:i.object({waitlist:i.boolean(),priorityWaitlist:i.boolean()}).nullish().transform(N),isRegionLocked:i.boolean().nullish().transform(N),linkDetails:i.object({cryptoCustomerId:i.string().nullish().transform(N),authIntentId:i.string().nullish().transform(N),linkEmail:i.string().nullish().transform(N)}).nullish().transform(N)});var pQ=i.object({sourceCurrency:i.string().nullish().transform(N),destinationCurrency:i.string().nullish().transform(N),destinationBlockchain:i.string().nullish().transform(N),destinationAddress:i.string().nullish().transform(N),accountNumber:i.string().nullish().transform(N),routingNumber:i.string().nullish().transform(N),accountType:i.string().nullish().transform(N),bankName:i.string().nullish().transform(N),bankAddress:i.string().nullish().transform(N),bankBeneficiaryName:i.string().transform(ey).nullish().transform(N),bankBeneficiaryAddress:i.string().nullish().transform(N)}),lC=i.object({price:i.number(),priceChange24h:i.number(),lastUpdatedAt:i.string().transform(e=>new Date(e))}),pC=i.object({account:i.string(),quantity:i.number(),quantityString:i.string()}),dC=i.object({address:i.string(),quantity:i.number(),quantityString:i.string(),lastTransferredDate:i.string().nullish().transform(N),subaccounts:i.array(pC).nullish().transform(N)}),mC=i.object({isMutable:i.boolean().nullish().transform(N),creators:i.array(i.string()).nullish().transform(N),tokenProgram:i.string().nullish().transform(N),extensions:i.array(i.any()).nullish().transform(N),compression:i.record(i.any()).nullish().transform(N)}),fC=i.object({caip19:i.string(),name:i.string(),symbol:i.string(),decimals:i.number(),spamStatus:i.string().nullish().default(""),logoUri:i.string().nullish().default(""),totalQuantity:i.number(),totalQuantityString:i.string(),price:lC.nullish().transform(N),queriedWalletBalances:i.array(dC),extraMetadata:mC}),gC=i.object({email:i.string().email(),cashAccountAddress:i.string(),idempotencyKey:i.string()}),hC=i.object({enrollmentDetails:i.object({kycStatus:i.nativeEnum(Ti),kycUrl:i.string(),tosStatus:i.nativeEnum(bi),tosUrl:i.string()})}),_i;(function(e){e.TRANSFER_TO_BANK="transfer_to_bank",e.TRANSFER_TO_USERNAME="transfer_to_username",e.TRANSFER_TO_WALLET="transfer_to_wallet",e.WITHDRAWAL_TO_WALLET="withdrawal_to_wallet",e.SELL_TOKENS="sell_tokens",e.CARD_BANK_DEPOSIT="card_bank_deposit",e.VIRTUAL_ACCOUNT_DEPOSIT="virtual_account_deposit",e.DELEGATE_WALLET_ACCOUNT="delegate_wallet_account"})(_i||(_i={}));var yC=i.object({account:i.string(),quantity:i.number(),quantityString:i.string()}),wC=i.object({address:i.string(),quantity:i.number(),quantityString:i.string(),lastTransferredDate:i.string().nullish().transform(N),subaccounts:i.array(yC).nullish().transform(N)}),SC=i.object({isMutable:i.boolean().nullish().default(null),creators:i.array(i.unknown()).nullish().transform(N),tokenProgram:i.string().nullish().transform(N),extensions:i.array(i.unknown()).nullish().transform(N)}),oy=i.object({caip19:i.string(),name:i.string(),symbol:i.string(),decimals:i.number(),logoUri:i.string(),spamStatus:i.string(),totalQuantity:i.number(),totalQuantityString:i.string(),queriedWalletBalances:i.array(wC),extraMetadata:SC.nullish().transform(N),price:i.object({price:i.number(),priceChange24h:i.number().nullish().transform(N),lastUpdatedAt:i.coerce.date(),marketCap:i.number().nullish().transform(N)}).nullish()}),dQ=i.object({stablecoins:i.array(oy),otherTokens:i.array(oy),totalStablecoinsValueUsd:i.string().nullish().transform(N),totalOtherTokensValueUsd:i.string().nullish().transform(N)}),Ii;(function(e){e.UNVERIFIED="unverified",e.VERIFIED="verified"})(Ii||(Ii={}));var Xl;(function(e){e.AlreadyExists="already_exists",e.InProgress="in_progress",e.Pending="pending",e.Completed="completed"})(Xl||(Xl={}));var bC=i.object({targetState:i.nativeEnum(Ii),data:i.object({email:i.string().email().optional(),cashAccountAddress:i.string().optional()}),idempotencyKey:i.string().optional()}),TC=Yl.extend({account:Fi}),AC=i.object({requirementType:i.nativeEnum(Mr),evidence:i.object({authIntentId:i.string(),providerCustomerId:i.string(),dataSharing:i.object({consented:i.boolean()})})}),xC=Yl.extend({account:Fi}),Qr;(function(e){e.BankAccountId="bank_account_id",e.Bank="bank",e.Crypto="crypto",e.PhantomUsername="phantom_username",e.Merchant="merchant"})(Qr||(Qr={}));var EC=i.nativeEnum(Qr),kC=i.object({type:i.literal("fiat"),currency:i.string(),value:i.string()}),CC=i.object({type:i.literal("token"),token:i.string(),symbol:i.string(),value:i.string(),decimals:i.number()}),ay=i.discriminatedUnion("type",[kC,CC]),ny;(function(e){e.Fiat="fiat",e.Token="token"})(ny||(ny={}));var _C=i.record(i.string(),ay),iy=i.object({accountHolderName:i.string().nullish().transform(N),accountNumber:i.string().nullish().transform(N),accountType:i.string().nullish().transform(N),bankName:i.string().nullish().transform(N),nickname:i.string().nullish().transform(N)}),Ds=i.object({type:EC,currency:i.string(),name:i.string().nullish().transform(N),phantomUsername:i.string().nullish().transform(N)}),IC=Ds.extend({type:i.literal(Qr.BankAccountId),bankDetails:iy.nullish().transform(N)}),FC=Ds.extend({type:i.literal(Qr.Bank),bankDetails:iy.nullish().transform(N)}),vC=Ds.extend({type:i.literal(Qr.Crypto),address:i.string().nullish().transform(N),phantomUsername:i.string().nullish().transform(N)}),PC=i.object({merchantName:i.string().nullish().transform(N),merchantCategoryCode:i.string().nullish().transform(N)}),RC=i.object({name:i.string().nullish().transform(N),categoryPrimary:i.string().nullish().transform(N),categoryDetailed:i.string().nullish().transform(N),icon:i.string().nullish().transform(N),website:i.string().nullish().transform(N),location:i.any().nullish().transform(N)}),DC=Ds.extend({type:i.literal(Qr.Merchant),merchantDetails:PC.nullish().transform(N),enrichedMerchantDetails:RC.nullish().transform(N),category:i.string().nullish().transform(N),icon:i.string().nullish().transform(N),website:i.string().nullish().transform(N)}),Jl;(function(e){e.Following="following"})(Jl||(Jl={}));var NC=Ds.extend({type:i.literal(Qr.PhantomUsername),phantomUsername:i.string().nullish().transform(N),icon:i.string().nullish().transform(N),relationship:i.nativeEnum(Jl).nullish().transform(N)}),BC=i.union([IC,FC,vC,NC,DC]),sy=i.object({amount:i.string(),decimals:i.number(),logoUri:i.string().nullish().transform(N),mint:i.string(),name:i.string().nullish().transform(N),owner:i.string(),symbol:i.string().nullish().transform(N)}),Co;(function(e){e.CashOut="cash_out",e.Swap="swap"})(Co||(Co={}));var LC=i.object({input:sy,output:sy,quoteId:i.string().nullish().transform(N),quoteSource:i.string().nullish().transform(N),type:i.nativeEnum(Co).nullish().transform(N)}),mQ=i.object({type:i.nativeEnum(Ei),id:i.string(),state:i.nativeEnum(Ve),occurredAt:i.string(),counterparty:BC,direction:i.nativeEnum(xi),amount:ay,feeBreakdown:_C.nullish().default(null),metadata:i.object({swapInfo:LC.nullish().default(null),merchant:i.any().nullish().default(null),enrichment:i.object({lastEnrichedAt:i.string().nullish().transform(N),source:i.string().nullish().transform(N)}).nullish().transform(N)}).nullish().default(null),onchainTxId:i.string().nullish().transform(N)});var Ns=s(e=>{let{data:t}=yr(),{userID:r}=t??{},o=ze("enable-cash"),{data:n}=uf(),a=!!n?.username,c=!!(r&&e?.enabled!==!1&&o&&a);return ae({...e,queryKey:ro.account(r,o),enabled:c,queryFn:s(async()=>{if(!r)throw new Error("useCashAccount: userID is required");let p=r;try{let m=await K.api().bearer(!0).get(`/cash/v1/users/${p}/cash-account`),d=Fi.safeParse(m.data);if(!d.success)throw new Ci(d.error,m.data);return d.data}catch(m){switch(m?.response?.status||m?.response?.data?.statusCode){case 204:case 404:case 403:throw new ki(p);default:break}throw P.captureError(m,O.Cash),m}},"queryFn")})},"useCashAccount");u();l();var UC=D(B());var OC=s((e,t,r)=>{let o=s(c=>{if(c.caip19!==t)return c;let m=new _(c.totalQuantity).plus(r),d=m.isLessThan(0)?new _(0):m;return{...c,totalQuantity:d.toNumber(),totalQuantityString:d.toString(),queriedWalletBalances:c.queriedWalletBalances}},"updateTokenBalance"),n=e.stablecoins.some(c=>c.caip19===t),a=e.otherTokens.some(c=>c.caip19===t);return!n&&!a?e:{...e,stablecoins:n?e.stablecoins.map(o):e.stablecoins,otherTokens:a?e.otherTokens.map(o):e.otherTokens}},"transformGroupedBalances");function ep(e,t,r){e.getQueriesData({queryKey:Rs,exact:!1}).forEach(([n,a])=>{if(a){let c=OC(a,t,r);e.setQueryData(n,c)}})}s(ep,"updateGroupedBalances");u();l();u();l();function tp(e,t,r){if(Jo("kill-cash-balance-optimistic-update")||!r)return;let n=ro.balance(r,!0);e.setQueryData(n,a=>{if(!a)return a;let p=new _(a.totalQuantity).plus(t);return{...a,totalQuantity:p.toNumber(),totalQuantityString:p.toString()}}),hi(e,r)}s(tp,"updateCashBalance");var MC=G({seconds:3}),rp=s(async({queryClient:e,storage:t,authRepository:r,sellCaip19:o,sellAddress:n,sellAmountBN:a,buyCaip19:c,buyAddress:p,buyAmountBN:m,cashAccountAddress:d})=>{let h=(await r.getUser())?.userID??"";qC({queryClient:e,sellCaip19:o,sellAmountBN:a,sellAddress:n,buyCaip19:c,buyAmountBN:m,buyAddress:p,cashAccountAddress:d,userId:h}),await Jh(e,t),await new Promise(w=>setTimeout(w,MC)),await QC(e,h)},"invalidateCashSwap"),QC=s(async(e,t)=>Promise.all([Yh(e),hi(e,t),Xh(e)]),"invalidateCashSwapQueries"),qC=s(({queryClient:e,sellCaip19:t,sellAmountBN:r,sellAddress:o,buyCaip19:n,buyAmountBN:a,buyAddress:c,cashAccountAddress:p,userId:m})=>{if(!m)return;let d=M(t),f=M(n);p&&o===p?tp(e,r.negated(),m):ep(e,d,r.negated()),p&&c===p?tp(e,a,m):ep(e,f,a),zC({sellCaip19:t,sellAmountBN:r,sellAddress:o,buyCaip19:n,buyAmountBN:a,buyAddress:c,cashAccountAddress:p})},"optimisticUpdate"),zC=s(({sellCaip19:e,sellAmountBN:t,sellAddress:r,buyCaip19:o,buyAmountBN:n,buyAddress:a,cashAccountAddress:c})=>{let p=Jo("kill-cash-balance-optimistic-update");r===c?P.addBreadcrumb(O.Cash,`[optimisticUpdate] buying ${n.toString()} ${o} w/ ${t.toString()} cash, isKillSwitchEnabled: ${p}`,Y.Debug):a===c?P.addBreadcrumb(O.Cash,`[optimisticUpdate] buying ${n.toString()} (cash) w/ ${t.toString()} ${e}, isKillSwitchEnabled: ${p}`,Y.Debug,{amount:n.toString()}):P.addBreadcrumb(O.Cash,`[optimisticUpdate] [non-cash] buying ${n.toString()} ${o} w/ ${t.toString()} ${e}`,Y.Debug)},"logOptimisticUpdate");var uy=D(B());u();l();var cy=s(e=>{let t=e?.addressDetails?.address;return t?{[ye.Solana.Mainnet]:t}:{}},"createSwapperCashAddresses");var vi=s(()=>{let{data:e}=Ns();return(0,uy.useMemo)(()=>cy(e),[e])},"useSwapperCashAddresses");u();l();u();l();u();l();var GC=["SwapperNoQuotes","UnsupportedCountry","UnknownError"],ly=s((e,t,r,o)=>{e instanceof Ge&&GC.includes(e.code)||(!t||t>=400&&t<500)&&P.addBreadcrumb(r,JSON.stringify(o),Y.Info)},"captureClientError");u();l();var py=s(async(e,t,r=void 0)=>{if(le(e))return Promise.resolve();let o;try{o=e.data}catch{throw new Ge({key:r})}let n=pi.safeParse(o);throw n.success?(P.addBreadcrumb(t,JSON.stringify(n.data),Y.Info),new Ge({key:n.data.name})):new Ge({key:r})},"handleBadResponse");u();l();var dy=s(e=>{let t=new Ge({key:"SwapperNoQuotes"});if(Ps.safeParse(e?.type).success===!1)throw P.captureError(new Error("Failed to parse a valid quote type."),O.Swapper),new Error("Invalid input");let r=fi.safeParse(e);if(!r.success)throw P.captureError(new Error("Failed to parse a valid swap quotes response."),O.Swapper),t;if(r.data.quotes.length===0)throw t;return r.data},"parseSwapQuotesResponse");var my="swap-quotes";async function Pi({sellTokenCaip19:e,buyTokenCaip19:t,taker:r,takerDestination:o,exactOut:n,sellAmount:a,sellAmountUsd:c,slippageTolerance:p,signal:m,enableAutoSlippage:d,priorityFee:f,tipAmount:h,phantomCashAccount:w}){let y;try{Ts(r)&&(r.address=r.address.toLowerCase()),o&&Ts(o)&&(o.address=o.address.toLowerCase()),Ts(t)&&(t.address=t.address.toLowerCase()),Ts(e)&&(e.address=e.address.toLowerCase());let S="/swap/v2/quotes",T={sellToken:e,buyToken:t,taker:r,takerDestination:o,exactOut:n,sellAmount:a,sellAmountUsd:c,slippageTolerance:p,autoSlippage:d,priorityFee:f,tipAmount:h,phantomCashAccount:w},b=await K.api().post(S,T,{signal:m});return y=b.status,await py(b,my,"SwapperNoQuotes"),dy(b.data)}catch(S){let T=S instanceof Ge?S:new Ge;throw ly(T,y,my,{sellToken:e,buyToken:t,sellAmount:a,sellAmountUsd:c,slippageTolerance:p}),T}}s(Pi,"getSwapQuotes");var Ri=class{static{s(this,"WalletSwapApiClient")}getQuotes(t){return Pi({sellTokenCaip19:t.sell,buyTokenCaip19:t.buy,taker:t.taker,takerDestination:t.takerDestination,sellAmount:t.amount,sellAmountUsd:t.amountUsd,slippageTolerance:t.slippageTolerance,signal:t.signal,exactOut:t.exactOutEnabled,priorityFee:t.priorityFee,tipAmount:t.tipAmount,enableAutoSlippage:t.autoSlippageEnabled,phantomCashAccount:t.phantomCashAccount})}};u();l();u();l();var Di=class{static{s(this,"BridgeTrackingSwapCommand")}inner;bridgeStatusManager;executingQuote;takerAddress;networkId;quote;executionId;constructor(t,r,o){this.inner=t,this.bridgeStatusManager=r,this.executingQuote=o,this.takerAddress=t.takerAddress,this.networkId=t.networkId,this.quote=t.quote,this.executionId=t.executionId}createTransaction(){return this.inner.createTransaction()}swap(t,r,o,n,a){return this.inner.swap(t,r,o,n,a)}async waitForConfirmation(t){await this.bridgeStatusManager.track({executionId:this.executionId,executingQuote:this.executingQuote,transactionHash:t.id}),await this.inner.waitForConfirmation(t)}};u();l();u();l();u();l();var _t="swapper",rt;(function(e){e.quotes="quotes",e.transactions="transactions",e.slippageTolerance="slippageTolerance",e.priorityFee="priorityFee",e.tipAmount="tipAmount",e.presence="presence",e.lastSubmittedPairs="lastSubmittedPairsV2",e.lastSelectedTokens="lastSelectedTokens",e.slippageSettings="slippageSettings",e.priorityFeeSettings="priorityFeeSettings",e.tipSettings="tipSettings",e.hasViewedAutoSlippageOptIn="hasViewedAutoSlippageOptIn",e.optimisticUpdates="optimisticUpdates",e.autoSlippageMigrationVersion="autoSlippageMigrationVersion"})(rt||(rt={}));var fy=[_t,rt.quotes],he={quotesScope:s(()=>fy,"quotesScope"),quotes:s(({sellTokenCaip19:e,buyTokenCaip19:t,taker:r,amountValue:o,amountType:n,slippageTolerance:a,priorityFee:c,tipAmount:p,takerDestination:m,enableAutoSlippage:d,preferredProvider:f,phantomCashAccount:h})=>[...fy,{sellToken:e,buyToken:t,taker:r,takerDestination:m,amountValue:o,amountType:n,slippageTolerance:a,priorityFee:c,tipAmount:p,enableAutoSlippage:d,preferredProvider:f,phantomCashAccount:h}],"quotes"),transactions:s(e=>[_t,rt.transactions,e],"transactions"),presence:s(e=>[_t,rt.presence,e],"presence"),slippageTolerance:s(()=>[_t,rt.slippageTolerance],"slippageTolerance"),priorityFee:s(()=>[_t,rt.priorityFee],"priorityFee"),tipAmount:s(()=>[_t,rt.tipAmount],"tipAmount"),lastSubmittedPairs:s(()=>[_t,rt.lastSubmittedPairs],"lastSubmittedPairs"),lastSelectedTokens:s(()=>[_t,rt.lastSelectedTokens],"lastSelectedTokens"),slippageSettings:s(()=>[_t,rt.slippageSettings],"slippageSettings"),priorityFeeSettings:s(()=>[_t,rt.priorityFeeSettings],"priorityFeeSettings"),tipSettings:s(()=>[_t,rt.tipSettings],"tipSettings"),hasViewedAutoSlippageOptIn:s(()=>[_t,rt.hasViewedAutoSlippageOptIn],"hasViewedAutoSlippageOptIn"),optimisticUpdates:s(()=>[_t,rt.optimisticUpdates],"optimisticUpdates"),autoSlippageMigrationVersion:s(()=>[_t,rt.autoSlippageMigrationVersion],"autoSlippageMigrationVersion")};u();l();var Ni;(function(e){e[e.Always=1/0]="Always",e[e.Short=G({days:1})]="Short",e[e.Medium=G({days:3})]="Medium",e[e.Long=G({days:7})]="Long"})(Ni||(Ni={}));var Bi;(function(e){e[e.Immediate=0]="Immediate",e[e.Short=G({minutes:1})]="Short",e[e.Medium=G({minutes:2.5})]="Medium",e[e.Long=G({minutes:60})]="Long",e[e.Never=1/0]="Never"})(Bi||(Bi={}));var hn;(function(e){e[e.Short=G({seconds:20})]="Short",e[e.Medium=G({minutes:2.5})]="Medium",e[e.Long=G({minutes:5})]="Long"})(hn||(hn={}));var gy=s(async({callerAddress:e,contractAddress:t,networkId:r,sellAmount:o,allowanceTarget:n,approvalExactAmount:a,exchangeAddress:c,value:p,transactionData:m,type:d})=>{let f=[],h=[];if(t&&(await Df({callerAddress:e,spender:n,networkId:r,contractAddress:t})).lt(a??o.toString())){let S=await Nf({callerAddress:e,spender:n,networkId:r,contractAddress:t,exactAmount:a});f.push(S),h.push(`${d}-approval`)}let w=Ho.parse({type:km.eip1559,from:e,data:m,chainId:x.getEVMNetworkIDValue(r),to:c,...p==="0"?{}:{value:`0x${new U(p).toString(16)}`}});return f.push(w),h.push(d),{transactions:f,transactionTypes:h}},"createEVMTransactions"),Bs=s(async({networkId:e,callerAddress:t,quote:r})=>{let{sellAmount:o,steps:n}=r,a=[],c=[],p=[];for(let m of n){let{allowanceTarget:d,exchangeAddress:f,value:h,transactionData:w,sellToken:y,buyToken:S,approvalMetadata:T}=m,b=y.resourceType===ee.address?y.address:null,A=x.compareNetworkID(y.chainId,S.chainId)===0?"swap":"bridge";if(!d||!f||!w||!h)throw new Error("Missing bridge step data for EVM bridge quote.");let k=await gy({callerAddress:t,contractAddress:b,networkId:e,sellAmount:o,allowanceTarget:d,approvalExactAmount:m.approvalExactAmount,exchangeAddress:f,value:h,transactionData:w,type:A});a.push(...k.transactions),c.push(...k.transactionTypes),p.push({sellToken:y,buyToken:S,approvalMetadata:T}),k.transactionTypes.length==2&&k.transactionTypes.find(C=>C.includes("approval"))&&p.push({sellToken:y,buyToken:S,approvalMetadata:T})}return{type:"evm",transactions:a,transactionTypes:c,transactionPairs:p}},"processEVMBridgeQuote"),Ls=s(async({quote:e,connection:t})=>{let r=[],o=[],n=[];for(let a of e.steps){let{transactionData:c,sellToken:p,buyToken:m}=a,d=x.compareNetworkID(p.chainId,m.chainId)===0?"swap":"bridge",f=await hy(c,t);r.push(Zu.serialize(f).transaction),o.push(d),n.push({sellToken:p,buyToken:m})}return{type:"solana",transactions:r,transactionTypes:o,transactionPairs:n}},"processSolanaBridgeQuote"),Us=s(async({networkId:e,callerAddress:t,quote:r,sellFungible:o})=>{let n=o.type===oe.ERC20&&o?.data.tokenAddress?o.data.tokenAddress:null,{allowanceTarget:a,exchangeAddress:c,sellAmount:p,value:m}=r;return{type:"evm",...await gy({callerAddress:t,contractAddress:n,networkId:e,sellAmount:p,allowanceTarget:a,exchangeAddress:c,value:m,transactionData:r.transactionData,type:"swap"})}},"processEVMSwapQuote"),Os=s(async({quote:e})=>{let t=[],r=[],o=[];for(let n of e.steps){let{transactionData:a,sellToken:c,buyToken:p}=n,m=x.compareNetworkID(c.chainId,p.chainId)===0?"swap":"bridge";t.push(a),r.push(m),o.push({sellToken:c,buyToken:p})}return{type:"sui",transactions:t,transactionTypes:r,transactionPairs:o}},"processSuiBridgeQuote"),Li=s(async({quote:e})=>{let t=[],r=[],o=[];for(let n of e.steps){let{transactionData:a,sellToken:c,buyToken:p}=n;t.push(a),r.push("bridge"),o.push({sellToken:c,buyToken:p})}return{type:"bitcoin",transactions:t,transactionTypes:r,transactionPairs:o}},"processBitcoinBridgeQuote"),hy=s(async(e,t)=>{let r=Tt(e,"bs58");return await _f(r,{connection:t,transactionType:on.Swap})},"addPriorityFeeToEncodedTx"),yn=s(async({quote:e,connection:t})=>{let r=e.transactionData.map(c=>hy(c,t)),n=(await Promise.all(r)).map(c=>Zu.serialize(c).transaction);return{type:"solana",transactionTypes:n.map(()=>"swap"),transactions:n}},"processSolanaSwapQuote"),yy=s(async({quote:e,connection:t})=>yn({quote:e,connection:t}),"processCashSwapQuote"),Ms=s(async({quote:e})=>({type:"sui",transactionTypes:Array(e.transactionData.length).fill("swap"),transactions:e.transactionData}),"processSuiSwapQuote"),wy=s(({callerAddress:e,sellFungible:t,quote:r})=>{let{connection:o}=un(),n=he.transactions(r);return ae({queryKey:n,enabled:!!r&&!!t,gcTime:0,staleTime:0,refetchInterval:hn.Short,async queryFn(){try{if(!r)throw new Error("Missing quote");if(!t)throw new Error("Missing sell token");let a=t.data.chain.id;if(Ar(r)){if(x.isEVMNetworkID(a)&&ur(r))return await Us({networkId:a,callerAddress:e,quote:r,sellFungible:t});if(x.isSolanaNetworkID(a)&&Ct(r))return yn({quote:r,connection:o});if(x.isSuiNetworkID(a)&&Or(r))return Ms({quote:r});throw new Error(`Single network swap quote not supported for network ID ${a}`)}if(ne(r)){if(x.isEVMNetworkID(a))return await Bs({networkId:a,callerAddress:e,quote:r});if(x.isSolanaNetworkID(a))return await Ls({quote:r,connection:o});if(x.isSuiNetworkID(a))return await Os({quote:r});throw new Error(`Bridge quote not supported for network ID ${a}`)}throw new Error("Swap quote type not supported")}catch(a){throw a instanceof Error&&P.captureError(a,O.Swapper),a}}})},"useSwapTransactions");u();l();var oo=D(Bm());u();l();var xy=D(B());u();l();var Sy=D(B());u();l();function Pe(e){let t=e.reduce((r,o)=>r.add(o.name),new Set);return Array.from(t).join(" + ")}s(Pe,"parseSwapSources");function Ui(e){return(0,Sy.useMemo)(()=>Pe(e),[e])}s(Ui,"useProvider");u();l();var Ty=D(B());u();l();var Qs=D(B());var by=s(()=>{let[e,t]=(0,Qs.useState)(!1),r=V(m=>m.selectedProviderIndex),o=V(m=>m.selectedBaseProvider),n=V(m=>m.quoteResponse),a=(0,Qs.useMemo)(()=>n?n.quotes:[],[n]),c=(0,Qs.useMemo)(()=>{if(To){if(!n||n.quotes.length===0)return 0;let m=KC(n,o);return m===-1?(t(o!==cr),0):(t(!1),m)}return r},[n,o,r]),p=a.length>0?a[c]:void 0;return{selectedQuoteIndex:c,selectedBaseProvider:To?o:"",currentQuote:p,hasDefaultedToBestQuote:e}},"useSelectedQuote"),KC=s((e,t)=>e.quotes.findIndex(r=>r.baseProvider.id===t),"getQuoteIndexByProvider");function ot(){let e=V(d=>d.quoteResponse),t=V(d=>d.hasNoRoutes),r=V(d=>d.isFetchingQuote),o=(0,Ty.useMemo)(()=>e?e.quotes:[],[e]),n=o[0]?.buyAmount??"",{selectedQuoteIndex:a,selectedBaseProvider:c,currentQuote:p,hasDefaultedToBestQuote:m}=by();return{bestBuyAmount:n,currentQuote:p,hasNoRoutes:t,quoteResponse:e,quotes:o,selectedProviderIndex:a,selectedBaseProvider:c,isFetchingQuote:r,hasDefaultedToBestQuote:m}}s(ot,"useQuote");u();l();u();l();var wn=s(e=>e.steps.map(t=>t.tool),"getBridgeTools");var Ue=s(e=>e?ne(e)?wn(e):e?.sources??[]:[],"getSwapQuoteSources");function f8({sender:e}){let{t}=Ze(),{currentQuote:r}=ot(),o=V(h=>h.buyFungible),n=V(h=>h.sellFungible),a=Ui(Ue(r)),{data:c}=wy({callerAddress:e,quote:r,sellFungible:n}),p=c?.transactionPairs?.flatMap(h=>[...ti(h.sellToken)??[],...ti(h.buyToken)??[]])??[],m=[...new Set(p)],{fungibles:d}=ln({keys:m});return{pendingActivityRows:(0,xy.useMemo)(()=>lr({swapTransactions:c,sellFungible:n,buyFungible:o,fungibles:d,t,currentQuote:r,provider:a}),[c,n,o,d,t,r,a])}}s(f8,"usePendingActivity");function lr({swapTransactions:e,sellFungible:t,buyFungible:r,fungibles:o,currentQuote:n,provider:a,t:c}){let p={pendingSwapActivityRows:[],pendingApprovalActivityRows:[]};return e?e.type==="evm"?e.transactionTypes.reduce((m,d,f)=>{let h=t,w=r,y,S=e.transactionPairs;if(S&&S[f]){let T=S[f];h=Oi(T.sellToken,o)??t,w=Oi(T.buyToken,o)??r,y=T.approvalMetadata}if(d.includes("approval")){let T=h?.data.symbol??"";m.pendingApprovalActivityRows.push({topLeft:y?{text:`${c("transactionsPendingApproving")} ${y.symbol}`}:{text:`${c("transactionsPendingApproving")} ${T}`}})}else h&&w&&m.pendingSwapActivityRows.push(Ay({sellFungible:h,buyFungible:w,sellAmount:n?.sellAmount,buyAmount:n?.buyAmount,provider:a,isBridge:d.includes("bridge"),t:c}));return m},p):e.transactionTypes.reduce((m,d,f)=>{let h=t,w=r,y=e.transactionPairs;if(y&&y[f]){let S=y[f];h=Oi(S.sellToken,o)??t,w=Oi(S.buyToken,o)??r}return h&&w&&m.pendingSwapActivityRows.push(Ay({sellFungible:h,buyFungible:w,sellAmount:n?.sellAmount,buyAmount:n?.buyAmount,provider:a,isBridge:d.includes("bridge"),t:c})),m},p):p}s(lr,"getPendingActivityRows");var Ay=s(({sellFungible:e,buyFungible:t,sellAmount:r,buyAmount:o,provider:n,isBridge:a,t:c})=>{let p=e.data.symbol,m=t.data.symbol,d=Ee(r??0,e.data.decimals??0),f=Ee(o??0,t.data.decimals??0);return{topLeft:{text:`${c(a?"transactionsPendingBridging":"transactionsPendingSwapping")} on ${n}`},topRight:{text:`${f} ${m}`,color:"spotPositive"},bottomLeft:{text:`${p} \u2192 ${m}`},bottomRight:{text:`${d} ${p}`}}},"getPendingSwapActivityRows"),Oi=s((e,t)=>t.find(r=>(ti(e)??[]).includes(r.data.key)),"getFungibleFromFungibleCaip19");var Mi=class{static{s(this,"BitcoinSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;constructor(t,r,o,n,a){this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a}async createTransaction(){return Li({quote:this.quote})}async swap(t,r,o,n,a){let c=r.transactions[0];if(!c)throw new Error("No transaction found");let p=oo.Psbt.fromHex(c),m=this.analyzePsbtInputs(p,this.takerAddress),d=await Pf({accountSigner:n,storage:a,accountIdentifier:t,pendingTransactionInput:this.parsePendingTransactionInput(this.executingQuote,r,p),psbt:p,psbtChain:void 0,inputsToSign:m,utxoManager:vf(new Ff(a))});return{networkID:this.networkId,id:d}}async waitForConfirmation(t){await Rf(this.networkId,t.id)}analyzePsbtInputs(t,r){let o=[];if(t.data.inputs.forEach((n,a)=>{let c;if(n.witnessUtxo?c=n.witnessUtxo.script:n.nonWitnessUtxo&&(c=oo.Transaction.fromBuffer(n.nonWitnessUtxo).outs[t.txInputs[a].index].script),c)try{oo.address.fromOutputScript(c,oo.networks.bitcoin)===r&&o.push(a)}catch(p){console.warn(`Could not decode script for input ${a}:`,p)}}),o.length===0)throw new Error(`No inputs found for user address ${r}`);return[{address:r,signingIndexes:o}]}parsePendingTransactionInput(t,r,o){let n=Pe(Ue(t.quote)),c=lr({swapTransactions:r,sellFungible:t.sell,buyFungible:t.buy,fungibles:[],currentQuote:t.quote,provider:n,t:v.t}).pendingSwapActivityRows[0];return{ownerAddress:this.takerAddress,networkID:this.networkId,data:{txID:"",psbtHex:o.toHex()},type:xt.Swap,display:{summary:{topLeft:c.topLeft,topRight:c.topRight,bottomLeft:c.bottomLeft,bottomRight:c.bottomRight}}}}};var Qi=class{static{s(this,"BtcBridgeSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;bitcoinSwapCommand;constructor(t,r,o,n,a){this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a,this.bitcoinSwapCommand=new Mi(t,r,o,n,a)}async createTransaction(){return Li({quote:this.quote})}async swap(t,r,o,n,a){return this.bitcoinSwapCommand.swap(t,r,o,n,a)}async waitForConfirmation(t){return this.bitcoinSwapCommand.waitForConfirmation(t)}};u();l();u();l();u();l();u();l();u();l();function VC(e){if(e.length>=255)throw new TypeError("Alphabet too long");let t=new Uint8Array(256);for(let d=0;d<t.length;d++)t[d]=255;for(let d=0;d<e.length;d++){let f=e.charAt(d),h=f.charCodeAt(0);if(t[h]!==255)throw new TypeError(f+" is ambiguous");t[h]=d}let r=e.length,o=e.charAt(0),n=Math.log(r)/Math.log(256),a=Math.log(256)/Math.log(r);function c(d){if(d instanceof Uint8Array||(ArrayBuffer.isView(d)?d=new Uint8Array(d.buffer,d.byteOffset,d.byteLength):Array.isArray(d)&&(d=Uint8Array.from(d))),!(d instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(d.length===0)return"";let f=0,h=0,w=0,y=d.length;for(;w!==y&&d[w]===0;)w++,f++;let S=(y-w)*a+1>>>0,T=new Uint8Array(S);for(;w!==y;){let k=d[w],C=0;for(let I=S-1;(k!==0||C<h)&&I!==-1;I--,C++)k+=256*T[I]>>>0,T[I]=k%r>>>0,k=k/r>>>0;if(k!==0)throw new Error("Non-zero carry");h=C,w++}let b=S-h;for(;b!==S&&T[b]===0;)b++;let A=o.repeat(f);for(;b<S;++b)A+=e.charAt(T[b]);return A}s(c,"encode");function p(d){if(typeof d!="string")throw new TypeError("Expected String");if(d.length===0)return new Uint8Array;let f=0,h=0,w=0;for(;d[f]===o;)h++,f++;let y=(d.length-f)*n+1>>>0,S=new Uint8Array(y);for(;d[f];){let k=t[d.charCodeAt(f)];if(k===255)return;let C=0;for(let I=y-1;(k!==0||C<w)&&I!==-1;I--,C++)k+=r*S[I]>>>0,S[I]=k%256>>>0,k=k/256>>>0;if(k!==0)throw new Error("Non-zero carry");w=C,f++}let T=y-w;for(;T!==y&&S[T]===0;)T++;let b=new Uint8Array(h+(y-T)),A=h;for(;T!==y;)b[A++]=S[T++];return b}s(p,"decodeUnsafe");function m(d){let f=p(d);if(f)return f;throw new Error("Non-base"+r+" character")}return s(m,"decode"),{encode:c,decodeUnsafe:p,decode:m}}s(VC,"base");var Ey=VC;var jC="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",qi=Ey(jC);u();l();var HC=i.object({id:i.string(),state:i.nativeEnum(Ve)}).passthrough(),op=class extends Error{static{s(this,"CashActivityError")}activityId;userId;constructor(t,r,o){super(t),this.activityId=r,this.userId=o,this.name="CashActivityError"}},qs=class extends Error{static{s(this,"CashActivityNotFoundError")}constructor(t,r){super(`Cash activity ${t} not found for user ${r}`),this.name="CashActivityNotFoundError"}},ky=s(async({userID:e,activityId:t,accessToken:r})=>{let o=await K.api().bearer(r).get(`/cash/v1/users/${e}/cash-activity/${t}`);if(o.status===404)throw new qs(t,e);let n=HC.safeParse(o.data);if(!n.success)throw new op(`Failed to parse cash activity response: ${n.error.message}`,t,e);return n.data},"fetchCashActivity");u();l();var np;(function(e){e.Base58="base58",e.Base64="base64"})(np||(np={}));var $C=i.object({activityId:i.string(),transactionId:i.string()}),WC=3,ZC=1e3,Cy=s(({accessToken:e,userID:t,idempotencyKey:r,signedTransaction:o,skipActivityRecording:n,skipNotification:a,swapInfo:c,perpsInfo:p,skipPreflight:m,awaitConfirmation:d})=>{if(!e)throw new Error("Access token is required");if(!t)throw new Error("User ID is required");return Ua(async()=>{let f=await K.api().bearer(e).post(`/cash/v1/users/${t}/cash-account/send`,{idempotencyKey:r,chainId:$o.Mainnet,signedTransaction:qi.encode(_m(o)?o.serialize():o.serialize({requireAllSignatures:!1,verifySignatures:!1})),encoding:np.Base58,skipActivityRecording:n,skipNotification:a,...c&&{swapInfo:c},...p&&{perpsInfo:p},...m!==void 0&&{skipPreflight:m},...d!==void 0&&{awaitConfirmation:d}}),h=$C.safeParse(f.data);if(!h.success)throw new Error("Failed to parse transaction response");return h.data},()=>!0,WC,ZC)},"broadcastTransaction");var YC=8,XC=G({seconds:1.5}),JC=s(e=>{switch(e){case Ve.Failed:case Ve.Canceled:case Ve.Completed:case Ve.Processing:return!0;case Ve.Pending:case Ve.Unknown:return!1}},"isTerminalState"),e0=s(e=>{switch(e){case Ve.Completed:case Ve.Processing:return!0;case Ve.Failed:case Ve.Canceled:case Ve.Pending:case Ve.Unknown:return!1}},"isSuccessTerminalState");var sp=s(async({unsignedTransaction:e,vaultProxy:t,accountIdentifier:r,signerAddress:o,idempotencyKey:n,isCash:a=!0,accessToken:c,userID:p,skipActivityRecording:m,skipNotification:d,swapInfo:f,perpsInfo:h,skipPreflight:w,awaitConfirmation:y,forceLegacySigning:S})=>{let T;typeof e=="string"?T=Tt(e,"bs58"):T=e;let b=S?!1:await t0(t,o);P.addBreadcrumb(O.Cash,"Signing transaction ...",Y.Info),P.addBreadcrumb(O.Cash,`Using vault proxy signing (isCash: ${a}, isCashKMS: ${b})`,Y.Info);let A;a&&b?A={isCash:a,isCashKMS:b,data:{chainType:xe.Solana,signingType:"transaction",message:new Uint8Array(Da(T))}}:a?A={isCash:a,data:{chainType:xe.Solana,signingType:"transaction",message:new Uint8Array(Da(T))}}:A={chainType:xe.Solana,signingType:"transaction",message:new Uint8Array(Da(T))};let k=await t.sign(r,A);if(k.status==="error")throw new Error(k.message);let{signature:C}=k;if(!C)throw new Error("Failed to sign transaction: No signature returned");T.addSignature(new Fe.PublicKey(o),qi.decode(C));let I=T;P.addBreadcrumb(O.Cash,"Signed transaction",Y.Info),P.addBreadcrumb(O.Cash,"Broadcasting transaction ...",Y.Info);let{activityId:L,transactionId:Q}=await Cy({accessToken:c,userID:p,idempotencyKey:n,signedTransaction:I,skipActivityRecording:m,skipNotification:d,swapInfo:f,perpsInfo:h,skipPreflight:w,awaitConfirmation:y});P.addBreadcrumb(O.Cash,"Polling for cash activity...",Y.Info);try{await Ua(async()=>{let R=await ky({userID:p,activityId:L,accessToken:c});if(JC(R.state)){if(e0(R.state))return P.addBreadcrumb(O.Cash,`Activity reached success terminal state: ${R.state}`,Y.Info),R;{let H=`Activity reached failed terminal state: ${R.state}.`;throw P.addBreadcrumb(O.Cash,H,Y.Info),new Error(H)}}else throw new Error(`Activity state is ${R.state}, waiting for a terminal state.`)},R=>R instanceof qs||!!(R instanceof Error&&R.message.includes("waiting for")),YC,XC,!0)}catch(R){throw P.addBreadcrumb(O.Cash,`Failed to poll for cash activity: ${R}`,Y.Error),new Error(`Transaction broadcast succeeded but activity confirmation failed: ${R}`)}return P.addBreadcrumb(O.Cash,"Broadcasted transaction",Y.Info),Q},"signAndBroadcastTransaction");async function t0(e,t){try{let o=(await e.getCashKMSAccount()).account.address;return t===o}catch{return P.addBreadcrumb(O.Cash,"Unable to get Cash-KMS account.",Y.Error),!1}}s(t0,"isCashKMSEnabled");u();l();var r0=i.object({activityId:i.string()}),ap=s(async({accessToken:e,userID:t,idempotencyKey:r,swapInfo:o,chainId:n,signedTransaction:a,encoding:c,onchainTxId:p,failureReason:m,skipActivityRecording:d,skipNotification:f,occurredAt:h})=>{if(Jo("kill-cash-swap-listener"))return;if(!e)throw new Error("Access token is required");if(!t)throw new Error("User ID is required");let y=await K.api().bearer(e).post(`/cash/v1/users/${t}/cash-account/transaction/failed`,{idempotencyKey:r,swapInfo:o,...n&&{chainId:n},...a&&{signedTransaction:a},...c&&{encoding:c},...p&&{onchainTxId:p},...m&&{failureReason:m},...d!==void 0&&{skipActivityRecording:d},...f!==void 0&&{skipNotification:f},...h&&{occurredAt:h}}),S=r0.safeParse(y.data);if(!S.success)throw new Error("Failed to parse record failed swap response");return S.data},"recordFailedCashSwap");u();l();var _o=s((e,t)=>!e||!t?{}:{sellAmount:t.sellAmount,buyAmount:t.buyAmount,sellToken:e.sell.data.symbol||"unknown",buyToken:e.buy.data.symbol||"unknown"},"swapTelemetryMetadata"),zi=class{static{s(this,"CashSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;connection;authRepository;cashAccount;constructor(t,r,o,n,a,c,p,m){this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a,this.connection=c,this.authRepository=p,this.cashAccount=m}async createTransaction(){P.addBreadcrumb(O.Cash,"Creating cash swap transaction",Y.Info,_o(this.executingQuote,this.quote));try{return await yy({quote:this.quote,connection:this.connection})}catch(t){throw P.addBreadcrumb(O.Cash,"Failed to create cash swap transaction",Y.Error,_o(this.executingQuote,this.quote)),t}}async swap(t,r,o,n,a){P.addBreadcrumb(O.Cash,"Starting cash swap",Y.Info,_o(this.executingQuote,this.quote));let c=r.transactions[0],p=Tt(c,"bs58"),m=Fm(p),d=p.message.header.numRequiredSignatures,f=m.slice(0,d),h=this.cashAccount?.addressDetails.address;if(!h)throw new Error("Cash account address not found");let w=f[0]?.toBase58(),y=w===this.takerAddress?"taker address":w===h?"cash account address":null;y&&P.addBreadcrumb(O.Cash,`Fee payer is ${y}`,Y.Info,_o(this.executingQuote,this.quote));let S=f.some(I=>I.toBase58()===h),T=S?h:this.takerAddress,b=await this.authRepository?.getUser();if(!b)throw new Error("User not found for swap");let{accessToken:A,userID:k}=b,C=this.getSwapInfo(this.executingQuote,this.quote);try{return{id:await sp({unsignedTransaction:c,vaultProxy:n,accountIdentifier:t,signerAddress:T,idempotencyKey:this.executionId,isCash:S,accessToken:A,userID:k,skipActivityRecording:!1,skipNotification:!0,swapInfo:C,waitForActivityState:Ve.Completed}),networkID:this.networkId}}catch(I){throw P.addBreadcrumb(O.Cash,"Swap failed",Y.Error,_o(this.executingQuote,this.quote)),I}}async waitForConfirmation(t){P.addBreadcrumb(O.Cash,"Waiting for cash swap confirmation",Y.Info,_o(this.executingQuote,this.quote));try{let r=ja(t.networkID);await sn({connection:r,signature:t.id}),P.addBreadcrumb(O.Cash,"Cash swap confirmed",Y.Info)}catch(r){throw P.addBreadcrumb(O.Cash,"Cash swap confirmation failed",Y.Error,_o(this.executingQuote,this.quote)),r}}parsePendingActivity(t,r){let o=Pe(Ue(t.quote));return lr({swapTransactions:r,sellFungible:t.sell,buyFungible:t.buy,fungibles:[],currentQuote:t.quote,provider:o,t:v.t})}getSwapInfo(t,r){let o=t.sell,n=t.buy,a=t.quoteInput,c=o.data.walletAddress,p=n.data.walletAddress;if(!c&&a?.taker){let m=We(a?.taker);m.resourceType===ee.address&&(c=m.address)}if(!p&&a?.takerDestination){let m=We(a?.takerDestination);m.resourceType===ee.address&&(p=m.address)}return{type:Co.Swap,input:{owner:c,mint:o.data.tokenAddress??"",amount:r.sellAmount,symbol:o.data.symbol??void 0,name:o.data.name??void 0,decimals:o.data.decimals,logoUri:o.data.logoUri??void 0},output:{owner:p,mint:n.data.tokenAddress??"",amount:r.buyAmount,symbol:n.data.symbol??void 0,name:n.data.name??void 0,decimals:n.data.decimals,logoUri:n.data.logoUri??void 0},quoteId:r.rfqProps?.quoteId,quoteSource:Ue(r).map(m=>m.name).join(",")}}};u();l();var Gi=class{static{s(this,"EvmBridgeSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;evmSwapCommand;constructor(t,r,o,n,a,c){this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a,this.evmSwapCommand=c}createTransaction(){return Bs({networkId:this.networkId,callerAddress:this.takerAddress,quote:this.quote})}async swap(t,r,o,n,a){return this.evmSwapCommand.swap(t,r,o,n,a)}async waitForConfirmation(t){return this.evmSwapCommand.waitForConfirmation(t)}};u();l();u();l();var o0=1.3,n0=s(e=>{switch(e){case ye.Ethereum.Mainnet:case ye.Ethereum.Sepolia:return 8e5;case ye.Polygon.Mainnet:case ye.Polygon.Amoy:return 5e5;case ye.Base.Mainnet:case ye.Base.Sepolia:return 5e5;case ye.Arbitrum.Mainnet:case ye.Arbitrum.Sepolia:return 5e5;case ye.Hyperevm.Mainnet:case ye.Hyperevm.Testnet:return 5e5;default:return 0}},"getDefaultBridgeGasLimit"),s0=s(e=>{switch(e){case ye.Ethereum.Mainnet:case ye.Ethereum.Sepolia:return 6e4;case ye.Polygon.Mainnet:case ye.Polygon.Amoy:return 6e4;case ye.Base.Mainnet:case ye.Base.Sepolia:return 6e4;case ye.Arbitrum.Mainnet:case ye.Arbitrum.Sepolia:return 6e4;case ye.Hyperevm.Mainnet:case ye.Hyperevm.Testnet:return 6e4;default:return 0}},"getDefaultApprovalGasLimit"),a0=s((e,t)=>e.steps.flatMap(o=>o.gasCosts??[n0(t)]),"getBridgeGasLimit"),i0=s((e,t,r)=>{let o=ur(t)?[t.gas]:a0(t,r);return e?e.transactionTypes.map(n=>n.includes("approval")?s0(r):o.shift()??0):o},"getQuoteGasLimit"),Sn={estimateGas:s(({swapTransactions:e,evmGasEstimation:t,currentQuote:r,scanResult:o,networkID:n,includeGasBuffer:a,gasBuffer:c})=>{let{maxFeePerGas:p,maxPriorityFeePerGas:m}=t,d=i0(e,r,n),f=o?.advancedDetails?.gas;return o?.advancedDetails?.gasLimit>0&&(d=f),d.map(w=>({maxFeePerGas:p,maxPriorityFeePerGas:m,networkID:n,gasLimit:new _(w).multipliedBy(a?c??o0:1).integerValue(_.ROUND_CEIL)}))},"estimateGas")};u();l();var c0=s(({networkID:e,unsignedTransaction:t,pendingActivityRows:r,accountIdentifier:o,accountSigner:n,storage:a,includeCallPayload:c})=>({accountSigner:n,accountIdentifier:o,networkID:e,unsignedTransaction:t,...c&&{callPayload:{from:t.from,to:t.to,data:t.data,value:t.value}},pendingTransactionInput:{ownerAddress:t.from,networkID:e,data:{nonce:"",unsignedTransaction:t,hash:""},type:xt.Swap,display:{summary:r}},storage:a}),"buildArgs"),Ki=s(async({transactions:e,transactionTypes:t,networkID:r,gasEstimation:o,pendingApprovalActivityRows:n,pendingSwapActivityRows:a,accountIdentifier:c,accountSigner:p,storage:m})=>{let d=!0,f="";for(let[h,w]of e.entries()){let y=o[h],S={gas:`0x${y.gasLimit.toString(16)}`,maxFeePerGas:`0x${y.maxFeePerGas.toString(16)}`,maxPriorityFeePerGas:`0x${y.maxPriorityFeePerGas.toString(16)}`},T=Ho.parse({...w,...S}),A=t[h].includes("approval")?n:a,k=c0({networkID:r,accountIdentifier:c,pendingActivityRows:A.shift(),accountSigner:p,storage:m,unsignedTransaction:T,includeCallPayload:d});try{f="",f=await Bf(k)}catch(C){return{signature:f,error:C instanceof Error?C:new Error("Failed to process EVM swap transaction")}}d&&(d=!1)}return{signature:f}},"swapTransactionEvm");var _y=br.standard,Vi=class{static{s(this,"EvmSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;gasEstimation;constructor(t,r,o,n,a,c){this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a,this.gasEstimation=c}createTransaction(){return Us({quote:this.quote,callerAddress:this.takerAddress,networkId:this.networkId,sellFungible:this.executingQuote.sell})}async swap(t,r,o,n,a){let c=this.gasEstimation??await this.estimateGas(this.quote,this.executingQuote.response,_y,r,o);if(!c)throw new Error(`No gas estimation found for ${_y}`);let p=this.parsePendingActivity(this.executingQuote,r),{signature:m,error:d}=await P.startSpan("Process EVM Swap Txns",()=>Ki({transactions:r.transactions,transactionTypes:r.transactionTypes,networkID:this.networkId,gasEstimation:c,pendingSwapActivityRows:p.pendingSwapActivityRows,pendingApprovalActivityRows:p.pendingApprovalActivityRows,accountIdentifier:t,accountSigner:n,storage:a}));if(d)throw d;return{networkID:this.networkId,id:m}}async waitForConfirmation(t){await bf(t.networkID,t.id)}async estimateGas(t,r,o,n,a){let c=await nn(this.networkId,!0);if(!c)return;let p=c[o];if(!p)return;let m={networkID:this.networkId,gasLimit:new U(1),maxFeePerGas:p.maxFeePerGas,maxPriorityFeePerGas:p.maxPriorityFeePerGas};return Sn.estimateGas({swapTransactions:n,evmGasEstimation:m,currentQuote:t,scanResult:a??void 0,includeGasBuffer:!0,networkID:this.networkId,gasBuffer:r.gasBuffer})}parsePendingActivity(t,r){let o=Pe(Ue(t.quote));return lr({swapTransactions:r,sellFungible:t.sell,buyFungible:t.buy,fungibles:[],currentQuote:t.quote,provider:o,t:v.t})}};u();l();var Iy=D(Em());u();l();u();l();var u0=s(({networkID:e,transaction:t,feePayer:r,connection:o,pendingActivityRows:n,accountIdentifier:a,accountSigner:c,storage:p})=>({accountSigner:c,accountIdentifier:a,transaction:t,feePayer:r,connection:o,opts:{skipPreflight:!0},pendingTransactionInput:{ownerAddress:r.toBase58(),networkID:e,data:{signature:""},type:xt.Swap,display:{summary:n}},storage:p}),"buildArgs"),ji=s(async({callerAddress:e,connection:t,networkID:r,transactions:o,pendingSwapActivityRows:n,accountIdentifier:a,accountSigner:c,storage:p})=>{let m=new Fe.PublicKey(e),d="";for(let[f,h]of o.entries()){let w=Tt(h,"bs58"),y=u0({networkID:r,transaction:w,feePayer:m,connection:t,pendingActivityRows:n[f],accountIdentifier:a,accountSigner:c,storage:p});try{d="",d=await Mf(y),f!==o.length-1&&await sn({connection:t,signature:d})}catch(S){return{signature:d??"",error:S instanceof Error?S:new Error("Failed to process solana swap transaction")}}}return{signature:d??""}},"swapTransactionSolana");var xr=class{static{s(this,"SolanaSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;connection;constructor(t,r,o,n,a,c){this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a,this.connection=c}async createTransaction(){return yn({quote:this.quote,connection:this.connection})}async swap(t,r,o,n,a){let c=this.parsePendingActivity(this.executingQuote,r),{signature:p,error:m}=await ji({callerAddress:this.takerAddress,connection:this.connection,networkID:this.networkId,transactions:r.transactions,pendingSwapActivityRows:c.pendingSwapActivityRows,accountIdentifier:t,accountSigner:n,storage:a});if(m)throw m;return{networkID:this.networkId,id:p}}async waitForConfirmation(t){let r=ja(t.networkID);await sn({connection:r,signature:t.id})}parsePendingActivity(t,r){let o=Pe(Ue(t.quote));return lr({swapTransactions:r,sellFungible:t.sell,buyFungible:t.buy,fungibles:[],currentQuote:t.quote,provider:o,t:v.t})}};var l0=i.object({signature:i.string()}),Hi=class extends xr{static{s(this,"GaslessSolanaSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;connection;gaslessSignature;constructor(t,r,o,n,a,c,p){super(t,r,o,n,a,c),this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a,this.connection=c,this.gaslessSignature=p}async swap(t,r,o,n,a){let c=this.quote.transactionData[0];if(!c)throw new Error("No transaction data found in quote");let p=new Fe.PublicKey(this.takerAddress),d=this.parsePendingActivity(this.executingQuote,r).pendingSwapActivityRows[0];if(!d)throw new Error("Unable to create pending activity for gasless");let f=await Za({accountIdentifier:t,feePayer:p,connection:this.connection,accountSigner:n,transaction:Tt(c,"bs58"),pendingTransactionInput:{ownerAddress:p.toBase58(),networkID:this.networkId,data:{signature:this.gaslessSignature},type:xt.Swap,display:{summary:d}},storage:a,opts:{}});return{id:(await this.submitGaslessSwap(this.gaslessSignature,f)).signature,networkID:this.networkId}}async submitGaslessSwap(t,r){let o=await K.api().post("/gasless-swap/v1/submit",{quoteSignature:t,encoding:"bs58",chainId:this.networkId,transaction:Iy.default.encode(r.serialize())}),n=l0.safeParse(o.data);if(!n.success)throw new Error("Failed to submit gasless swap");return n.data}};u();l();var p0=i.object({quoteId:i.string(),transactionId:i.string()}),$i=class extends xr{static{s(this,"RFQSolanaSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;connection;constructor(t,r,o,n,a,c){super(t,r,o,n,a,c),this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a,this.connection=c}async swap(t,r,o,n,a){let c=this.quote.transactionData[0];if(!c)throw new Error("No transaction data found in quote");let p=new Fe.PublicKey(this.takerAddress),d=this.parsePendingActivity(this.executingQuote,r).pendingSwapActivityRows[0];if(!d)throw new Error("Unable to create pending activity for rfq");let f=await Za({accountIdentifier:t,feePayer:p,connection:this.connection,accountSigner:n,transaction:Tt(c,"bs58"),pendingTransactionInput:{ownerAddress:p.toBase58(),networkID:this.networkId,data:{signature:""},type:xt.Swap,display:{summary:d}},storage:a,opts:{}});return{id:(await this.submitRFQSwap(f)).transactionId,networkID:this.networkId}}async submitRFQSwap(t){let r=Buffer.from(t.serialize()).toString("base64"),o=await K.api().post("/v0/rfq/swap",{chainId:this.networkId,quoteId:this.quote.rfqProps?.quoteId,signedPayload:r},{headers:{"X-Request-Id":this.executionId}}),n=p0.safeParse(o.data);if(!n.success)throw new Error("Failed to submit rfq swap");return n.data}};u();l();var Wi=class{static{s(this,"SolanaBridgeSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;connection;solanaSwapCommand;constructor(t,r,o,n,a,c){this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a,this.connection=c,this.solanaSwapCommand=new xr(t,r,o,t.quote,a,c)}createTransaction(){return Ls({quote:this.quote,connection:this.connection})}async swap(t,r,o,n,a){return this.solanaSwapCommand.swap(t,r,o,n,a)}async waitForConfirmation(t){return this.solanaSwapCommand.waitForConfirmation(t)}};u();l();u();l();u();l();var d0=s(({networkID:e,transaction:t,feePayer:r,pendingActivityRows:o,accountIdentifier:n,accountSigner:a,storage:c})=>({accountSigner:a,accountIdentifier:n,transaction:t,pendingTransactionInput:{ownerAddress:r,networkID:e,data:{digest:""},type:xt.Swap,display:{summary:o}},storage:c}),"buildArgs"),Zi=s(async({callerAddress:e,networkID:t,transactions:r,pendingSwapActivityRows:o,accountIdentifier:n,accountSigner:a,storage:c})=>{let p="";for(let[m,d]of r.entries()){let f=d0({networkID:t,transaction:$a.deserializeTransactionString(d),feePayer:e,pendingActivityRows:o[m],accountIdentifier:n,accountSigner:a,storage:c});try{p=(await Uf(f)).digest,m!==r.length-1&&await Wa(t,p)}catch(h){return{signature:p??"",error:h instanceof Error?h:new Error("Failed to process sui swap transaction")}}}return{signature:p??""}},"swapTransactionSui");var bn=class{static{s(this,"SuiSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;constructor(t,r,o,n,a){this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a}async createTransaction(){return Ms({quote:this.quote})}async swap(t,r,o,n,a){let c=this.parsePendingActivity(this.executingQuote,r),{signature:p,error:m}=await Zi({callerAddress:this.takerAddress,networkID:this.networkId,transactions:r.transactions,pendingSwapActivityRows:c.pendingSwapActivityRows,accountIdentifier:t,accountSigner:n,storage:a});if(m)throw m;return{networkID:this.networkId,id:p}}async waitForConfirmation(t){await Wa(this.networkId,t.id)}parsePendingActivity(t,r){let o=Pe(Ue(t.quote));return lr({swapTransactions:r,sellFungible:t.sell,buyFungible:t.buy,fungibles:[],currentQuote:t.quote,provider:o,t:v.t})}};var Yi=class{static{s(this,"SuiBridgeSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;suiSwapCommand;constructor(t,r,o,n,a){this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a,this.suiSwapCommand=new bn(t,r,o,t.quote,a)}async createTransaction(){return Os({quote:this.quote})}async swap(t,r,o,n,a){return this.suiSwapCommand.swap(t,r,o,n,a)}async waitForConfirmation(t){return this.suiSwapCommand.waitForConfirmation(t)}};var Xi=class{static{s(this,"WalletSwapCommandFactory")}bridgeStatusManager;constructor(t){this.bridgeStatusManager=t}create(t,r,o,n,a,c,p){if(Wh(t.quote)&&(Ke(t.buy)||Ke(t.sell)))return new zi(t,r,o,t.quote,$e(),n,a,c);if(x.isSolanaNetworkID(o)&&Ct(t.quote)){let m=new xr(t,r,o,t.quote,$e(),n);return t.quote.rfqProps?new $i(t,r,o,t.quote,$e(),n):t.quote.gaslessSignature?new Hi(t,r,o,t.quote,$e(),n,t.quote.gaslessSignature):m}else{if(x.isEVMNetworkID(o)&&ur(t.quote))return this.createEvmSwapCommand(t,r,o,p);if(x.isSuiNetworkID(o)&&Or(t.quote))return new bn(t,r,o,t.quote,$e());if(ne(t.quote)){if(x.isSolanaNetworkID(o))return this.wrapBridgeTrackingCommand(new Wi(t,r,o,t.quote,$e(),n),t);if(x.isEVMNetworkID(o)){let m=this.createEvmSwapCommand(t,r,o,p);return this.wrapBridgeTrackingCommand(new Gi(t,r,o,t.quote,$e(),m),t)}else{if(x.isSuiNetworkID(o))return this.wrapBridgeTrackingCommand(new Yi(t,r,o,t.quote,$e()),t);if(x.isBitcoinNetworkID(o))return this.wrapBridgeTrackingCommand(new Qi(t,r,o,t.quote,$e()),t)}}}throw new Error("Unsupported SwapQuote}")}createEvmSwapCommand(t,r,o,n){let a=n?n.filter(Va):void 0;return a&&a.length===0&&(a=void 0),new Vi(t,r,o,t.quote,$e(),a)}wrapBridgeTrackingCommand(t,r){return!this.bridgeStatusManager||!ne(r.quote)?t:new Di(t,this.bridgeStatusManager,r)}};u();l();u();l();var zs={name:"SwapperNoQuotes",message:"No quotes found"},Tn=class extends Yf{static{s(this,"SwapperQuoteStreamEventProducer")}createStreamUrl({amount:t,amountUsd:r,buy:o,sell:n,taker:a,takerDestination:c,slippageTolerance:p,exactOut:m,autoSlippage:d,priorityFee:f,tipAmount:h,isLedger:w,phantomCashAccount:y}){let S=new URLSearchParams({taker:a,takerDestination:c,buyToken:M(X(o)),sellToken:M(X(n)),sellAmount:t,sellAmountUsd:r??"",exactOut:m?"true":"false",autoSlippage:d?"true":"false",clientEnableGaslessSwap:"true",phantomCashAccount:y?"true":"false"});return p&&S.set("slippageTolerance",String(p)),f&&S.set("priorityFee",String(f)),h&&S.set("tipAmount",String(h)),w!==void 0&&S.set("isLedger",String(w)),`${this.getApiEnvironment()}/swap/v2/stream/quotes?${S.toString()}`}handleNewQuoteResponse(t,r){let o=this.safeJsonParse(t);if(!o.success||!o.data){r({type:"error",errorResponse:zs});return}try{let n=this.parseSwapQuotesResponse(o.data);r({type:"newQuoteResponse",quoteResponse:n})}catch{r({type:"error",errorResponse:zs})}}handleErrorQuoteResponse(t,r){let o=this.safeJsonParse(t);if(!o.success||!o.data){r({type:"error",errorResponse:zs});return}try{let n=pi.safeParse(o.data);r({type:"error",errorResponse:n.success?n.data:zs})}catch{r({type:"error",errorResponse:zs})}}parseSwapQuotesResponse(t){let r=new Ge({key:"SwapperNoQuotes"});if(Ps.safeParse(t?.type).success===!1)throw P.captureError(new Error("Failed to parse a valid quote type."),O.Swapper),new Error("Invalid input");let o=fi.safeParse(t);if(!o.success)throw P.captureError(new Error("Failed to parse a valid swap quotes response."),O.Swapper),r;if(o.data.includesAllProviders&&o.data.quotes.length===0)throw r;return o.data}};var Ji=class extends Tn{static{s(this,"EventStreamQuoteStreamProducer")}eventSource;open(t,r){this.close();let o=this.createStreamUrl(t);this.eventSource=new Ja(o,this.getOptionsWithAuth(o));let n=s(a=>{switch(a.type){case"new-quote-response":this.handleNewQuoteResponse(a.data,r);break;case"error-quote-response":this.handleErrorQuoteResponse(a.data,r);break;case"open":r({type:"open"});break;case"error":r({type:"error",errorResponse:{name:"UnknownError",message:a.message}});break;case"close":r({type:"close"});break}},"eventSourceListener");this.eventSource.addEventListener("new-quote-response",n),this.eventSource.addEventListener("error-quote-response",n),this.eventSource.addEventListener("open",n),this.eventSource.addEventListener("error",n),this.eventSource.addEventListener("close",n)}close(){this.eventSource&&(this.eventSource.removeAllEventListeners(),this.eventSource.close())}};u();l();var ec=class extends Tn{static{s(this,"NativeEventStreamQuoteStreamProducer")}eventSource;open(t,r){this.close();let o=this.createStreamUrl(t);this.eventSource=new Ja(o,this.getOptionsWithAuth(o));let n=s(a=>{switch(a.type){case"new-quote-response":this.handleNewQuoteResponse(a.data,r);break;case"error-quote-response":this.handleErrorQuoteResponse(a.data,r);break;case"open":r({type:"open"});break;case"error":r({type:"error",errorResponse:{name:"UnknownError",message:a.message}});break;case"close":r({type:"close"});break}},"eventSourceListener");this.eventSource.addEventListener("new-quote-response",n),this.eventSource.addEventListener("error-quote-response",n),this.eventSource.addEventListener("open",n),this.eventSource.addEventListener("error",n),this.eventSource.addEventListener("close",n)}close(){this.eventSource&&(this.eventSource.removeAllEventListeners(),this.eventSource.close())}};u();l();var tc=class{static{s(this,"QuoteStreamer")}producer;listeners=new Set;constructor(t){this.producer=t}openStream(t){this.listeners.forEach(r=>r.onEvent({type:"openRequested"})),this.producer.close(),this.producer.open(t,r=>{this.listeners.forEach(o=>o.onEvent(r)),r.type==="error"&&this.closeStream()})}closeStream(){this.producer.close()}subscribe(t){this.listeners.add(t)}unsubscribe(t){this.listeners.delete(t)}};u();l();u();l();function Fy(e){return e<3e5?1e4:e<6e5?15e3:3e4}s(Fy,"getBridgeStatusPollInterval");function m0(e){let t="pending";switch(e.status){case"DONE":t="completed";break;case"FAILED":t="failed";break;case"PENDING":case"NOT_FOUND":default:t="pending";break}return{state:t,rawStatus:e.status,updatedAt:Date.now(),fromAddress:e.fromAddress,toAddress:e.toAddress}}s(m0,"normalizeSwapperStatus");var ip=class{static{s(this,"BridgeStatusPoller")}args;timeoutId=null;isActive=!1;client;constructor(t){this.args=t,this.client=t.client}start(){this.isActive||(this.isActive=!0,this.scheduleNext(0))}stop(){this.isActive=!1,this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}scheduleNext(t){this.isActive&&(this.timeoutId=setTimeout(()=>{this.poll()},t))}async poll(){if(this.isActive)try{let t=await this.client.fetchStatus(this.args.record.transactionHash),r=m0(t),o;switch(r.state){case"completed":o={type:"completed",status:r},this.stop();break;case"failed":o={type:"failed",status:r},this.stop();break;case"pending":default:{o={type:"pending",status:r};let n=Date.now()-this.args.record.startedAt;this.scheduleNext(Fy(n));break}}this.args.onEvent(o)}catch(t){this.args.onEvent({type:"error",error:t});let r=Date.now()-this.args.record.startedAt;this.scheduleNext(Fy(r))}}};function vy(e){return new ip(e)}s(vy,"createBridgeStatusPoller");u();l();var f0=i.object({status:i.string(),sending:i.object({txHash:i.string().optional()}).optional(),receiving:i.object({txHash:i.string().optional()}).optional(),fromAddress:i.string().optional(),toAddress:i.string().optional()}).passthrough(),rc=class{static{s(this,"SwapperStatusClient")}async fetchStatus(t){let r=await K.api().get("/swap/v2/status/lifi",{params:{txHash:t}}),o=r?.data??r,n=f0.safeParse(o);if(!n.success)throw new Error("Unable to parse bridge status response");return n.data}};u();l();var cp="sdk.bridgeStatus.pending";var up=class{static{s(this,"BridgeStatusManager")}storage;client;createPoller;records=new Map;pollers=new Map;listeners=new Set;hydratePromise;constructor(t,r={}){this.storage=t,this.client=r.client??new rc,this.createPoller=r.createPoller??vy}async initialize(){this.hydratePromise||(this.hydratePromise=this.hydrate()),await this.hydratePromise}destroy(){this.pollers.forEach(t=>t.stop()),this.pollers.clear(),this.records.clear()}addListener(t){this.listeners.add(t)}removeListener(t){this.listeners.delete(t)}getPendingRecords(){return Array.from(this.records.values())}getPendingActivityRows(t,r){return this.getPendingBridgeActivities(t,r).map(o=>o.row)}getPendingBridgeActivities(t,r){return this.filterRecordsByAddresses(r?.addresses).map(n=>({record:n,row:By(n,t)}))}getPendingBridgeTransactions(t,r){return this.filterRecordsByAddresses(r?.addresses).map(n=>Ry(n,t))}getPendingBridgeTransactionById(t,r){let o=this.records.get(t);if(o)return Ry(o,r)}isPendingBridgeTransaction(t){return this.records.has(t)}async track(t){if(await this.initialize(),!this.shouldTrackQuote(t.executingQuote))return;let r=Py(t.executingQuote),o=this.records.get(t.executionId),n={executionId:t.executionId,transactionHash:t.transactionHash,startedAt:o?.startedAt??Date.now(),quote:r,status:o?.status};this.records.set(t.executionId,n),this.restartPoller(n),await this.persistRecords()}async hydrate(){try{let t=await this.storage.get(cp)??[];for(let r of t){let o=this.normalizePersistedRecord(r);o&&(this.records.set(o.executionId,o),this.startPoller(o))}}catch(t){console.error("Failed to hydrate bridge status records",t)}}shouldTrackQuote(t){if(!ne(t.quote))return!1;let r=t.sell?.data?.chain?.id,o=t.buy?.data?.chain?.id;return o&&x.isBitcoinNetworkID(o)||r&&x.isBitcoinNetworkID(r)||!1}startPoller(t){let r=this.createPoller({record:t,client:this.client,onEvent:s(o=>this.handlePollerEvent(t.executionId,o),"onEvent")});this.pollers.set(t.executionId,r),r.start()}restartPoller(t){this.stopPoller(t.executionId),this.startPoller(t)}stopPoller(t){let r=this.pollers.get(t);r&&(r.stop(),this.pollers.delete(t))}async persistRecords(){try{let t=Array.from(this.records.values()).map(r=>({executionId:r.executionId,transactionHash:r.transactionHash,startedAt:r.startedAt,quote:r.quote,status:r.status}));await this.storage.set(cp,t)}catch(t){console.error("Failed to persist bridge status records",t)}}removeRecord(t){this.records.delete(t),this.stopPoller(t),this.persistRecords()}normalizePersistedRecord(t){return"quote"in t&&g0(t.quote)?t:"executingQuote"in t&&this.shouldTrackQuote(t.executingQuote)?{executionId:t.executionId,transactionHash:t.transactionHash,startedAt:t.startedAt,status:t.status,quote:Py(t.executingQuote)}:null}handlePollerEvent(t,r){let o=this.records.get(t);if(o)switch(r.type){case"pending":o.status=r.status,this.notifyListeners({type:"pending",record:o,status:r.status}),this.persistRecords();break;case"completed":o.status=r.status,this.notifyListeners({type:"completed",record:o,status:r.status}),this.removeRecord(t);break;case"failed":o.status=r.status,this.notifyListeners({type:"failed",record:o,status:r.status}),this.removeRecord(t);break;case"error":this.notifyListeners({type:"error",record:o,error:r.error});break}}notifyListeners(t){this.listeners.forEach(r=>{try{r.onBridgeStatusChange(t)}catch(o){console.error("BridgeStatusListener error",o)}})}filterRecordsByAddresses(t){if(!t?.length)return this.getPendingRecords();let r=h0(t);return this.getPendingRecords().filter(o=>o.quote.accountAddresses.some(n=>r.has(Ny(n))))}};function Py(e){if(!ne(e.quote))throw new Error("Non-bridge quotes cannot be tracked");return{sell:e.sell,buy:e.buy,quote:e.quote,amount:e.amount,accountAddresses:e.account.addresses}}s(Py,"createQuoteSnapshot");function g0(e){return!!(e&&ne(e.quote))}s(g0,"isValidSnapshot");function h0(e){return new Set(e.map(Ny))}s(h0,"createAddressLookup");function Ny(e){return`${e.networkID}:${y0(e.address,e.networkID)}`}s(Ny,"createAddressKey");function y0(e,t){return x.isEVMNetworkID(t)?e.toLowerCase():e}s(y0,"normalizeAddress");function By(e,t){let r=e.quote.quote,o=e.quote.sell,n=e.quote.buy,a=Ee(r.sellAmount,o?.data.decimals??0),c=Ee(r.buyAmount,n?.data.decimals??0),p=o?.data.symbol??"",m=n?.data.symbol??"",d=e.startedAt+G({minutes:20}),f=Date.now(),h=d-f,w=Math.max(0,Math.ceil(h/(60*1e3))),y=w>0?`Est. ${w}m`:"Est. <1m";return{topLeft:{text:t("transactionsPendingSwapping")},topRight:{text:`${c} ${m}`,color:"spotPositive"},bottomLeft:{text:y},bottomRight:{text:`${a} ${p}`}}}s(By,"createPendingBridgeActivityRow");function w0(e,t){if(x.isEVMNetworkID(e))return{nonce:0,transactions:[{hash:t.transactionHash,timestamp:t.startedAt,unsignedTransaction:{},confirmations:0}]};if(x.isBitcoinNetworkID(e))return{txID:t.transactionHash,psbtHex:"",confirmations:0};if(x.isSolanaNetworkID(e))return{signature:t.transactionHash};if(x.isSuiNetworkID(e))return{digest:t.transactionHash};throw new Error(`Unsupported network for bridge transaction: ${e}`)}s(w0,"createBridgePendingTransactionData");function Ry(e,t){let r=e.quote.sell,o=e.quote.buy,n=r?.data.chain?.id;if(!n)throw new Error("Cannot create pending transaction: missing network ID");let a=By(e,t),c=e.quote.accountAddresses.find(y=>y.networkID===n)?.address??"",p=o?.data.chain?.id,m=p?e.quote.accountAddresses.find(y=>y.networkID===p)?.address:void 0,d=m?tn(m,4):"",f=Ee(e.quote.quote.buyAmount,o?.data.decimals??0),h=o?.data.symbol??"",w=`${f} ${h}`;return{id:e.executionId,timestamp:e.startedAt,ownerAddress:c,networkID:n,type:xt.Swap,display:{summary:{topLeft:a.topLeft,topRight:a.topRight,bottomLeft:a.bottomLeft,bottomRight:a.bottomRight},detail:{header:w,assetSymbol:h,uiRecipient:d}},data:w0(n,e)}}s(Ry,"createPendingTransactionFromBridgeRecord");var oc=null,Dy=null;function Ly(e){return oc||(oc=new up(e)),Dy||(Dy=oc.initialize()),oc}s(Ly,"getBridgeStatusManager");u();l();u();l();var Wt=s((e,t)=>!!e&&!!t&&x.compareNetworkID(e,t)!==0,"isBridgeSwap");u();l();var sc=D(Bm()),Uy=D(LE()),ac=D(BE());u();l();u();l();function Qt(e,t,r){if(t.lte(0))return null;let o=M({chainId:e,resourceType:ee.nativeToken,slip44:x.getSlip44(e)}),n=x.getTokenDecimals(e),a=x.getTokenSymbol(e);if(!o||!n||!a)return null;let c=t.div(Ka(n)),p=r[o];return p?.usd?c.times(p.usd).toNumber():null}s(Qt,"getFeeInUsd");var S0={"Allbridge's fee":"destinationNetwork","Allbridge Liquidity Fee":"liquidityProvider"};function b0(e,t){return{type:e,amountUsd:new _(t.amountUSD??0),amount:new _(t.amount??0)}}s(b0,"bridgeFeeToFee");function no(e){return e.steps.flatMap(r=>r.includedFeeCosts).reduce((r,o)=>{if(!o)return r;let n=S0[o.name];return n&&new _(o.amount).gt(0)&&r.push(b0(n,o)),r},[])}s(no,"getIncludedBridgeFees");function so(e,t,r){let o=e.steps.reduce((n,a)=>n.plus(a.nonIncludedNonGasFees),new _(0));return o.isZero()?[]:[{type:"nonIncludedNonGas",amountUsd:new _(Qt(t,o,r)??0),amount:o}]}s(so,"getNonIncludedBridgeFees");var nc=class{static{s(this,"BtcProcessBridgeQuoteCommand")}networkID;priceClient;constructor(t,r){this.networkID=t,this.priceClient=r}getNativeTokenCaip19(){return M({chainId:this.networkID,resourceType:ee.nativeToken,slip44:x.getSlip44(this.networkID)})}async processQuote(t,r){let o=await this.createSwapTransactions(t),n=await this.priceClient.getPrice(this.getNativeTokenCaip19());if(!n.usd)throw new Error("Price data not found");let a=await this.calculateNetworkFee(t,n),c=this.appendBridgeFees([a],t,n),p=this.appendPhantomFee(c,t);return{quote:t,fees:{totalFees:this.sumFees(p),fees:p},swapTransactions:o}}createSwapTransactions(t){let r=[],o=[],n=[];for(let a of t.steps){let{transactionData:c,sellToken:p,buyToken:m}=a;r.push(c),o.push("bridge"),n.push({sellToken:p,buyToken:m})}return Promise.resolve({type:"bitcoin",transactions:r,transactionTypes:o,transactionPairs:n})}appendPhantomFee(t,r){let o=r.steps.flatMap(n=>n.feeCosts).find(n=>n.name==="phantom");return o?[...t,{type:"phantom",percentage:new _(o.percentage),amountUsd:new _(0),amount:new _(0)}]:t}appendBridgeFees(t,r,o){let n={[this.getNativeTokenCaip19()]:o},a=so(r,this.networkID,n),c=no(r);return[...t,...c,...a]}async calculateNetworkFee(t,r){if(!r.usd)throw new Error("Price data not found");let o=t.steps.flatMap(n=>n.gasCosts??[]);if(o.length>0){let n=o.reduce((p,m)=>p+m,0);return{type:"bitcoinNetwork",amountUsd:new _(n).shiftedBy(-8).times(r.usd),amount:new _(n)}}try{let n=t.steps[0];if(!n?.transactionData)throw new Error("No transaction data available for fee estimation");let a=sc.Psbt.fromHex(n.transactionData),c=T0(a),m=(await eg(this.networkID))[br.standard]?.btcPerKilobyte;if(!m)throw new Error("Failed to get standard fee rate");let f=Af(m).times(c).integerValue(_.ROUND_UP);return{type:"bitcoinNetwork",amountUsd:f.shiftedBy(-8).times(r.usd),amount:f}}catch{let a=new _(1e4);return{type:"bitcoinNetwork",amountUsd:a.shiftedBy(-8).times(r.usd),amount:a}}}sumFees(t){return t.reduce((r,o)=>r.plus(o.amountUsd),new _(0))}};function T0(e){let{header:t,perInput:r}=Ga[xf(e)],{inputs:o}=e.data,n=new _(t),a=new _(o.length).times(r),c=e.txOutputs.reduce((p,m)=>{let d=ac.decompile(m.script);if(d&&d[0]===ac.OPS.OP_RETURN)return p;let f;if(m.address)f=m.address;else try{f=(0,Uy.fromOutputScript)(m.script,sc.networks.bitcoin)}catch{return p.plus(Ga[xe.BitcoinNativeSegwit].perOutput)}let h=Mm(ye.Bitcoin.Mainnet,f);return p.plus(Ga[h].perOutput)},new _(0));return n.plus(a).plus(c)}s(T0,"calculateVirtualBytes");u();l();u();l();var Oy=D(B());u();l();var Ce;(function(e){e.SlippageTolerance="slippageTolerance",e.PriorityFee="priorityFee",e.TipAmount="tipAmount",e.LastSubmittedPairs="lastSubmittedPairsV2",e.LastSelectedTokens="lastSelectedTokens",e.SlippageSettings="slippageSettings",e.HasViewedAutoSlippageOptIn="hasViewedAutoSlippageOptIn",e.PriorityFeeSettings="priorityFeeSettings",e.TipSettings="tipSettings"})(Ce||(Ce={}));function It({key:e,queryKey:t,defaultValue:r=null}){let o=Ot();return ae({enabled:!0,queryKey:t,gcTime:Ni.Long,staleTime:Bi.Never,async queryFn(){try{return await o.get(e)}catch(n){return n instanceof Error&&P.captureError(n,O.Swapper),r}}})}s(It,"useSwapStorageValue");function Ft({key:e,queryKey:t}){let r=Ot(),o=Qe();return Ao({async mutationFn(n){try{return await r.set(e,n)}catch(a){a instanceof Error&&P.captureError(a,O.Swapper);return}},async onMutate(n){await o.cancelQueries({queryKey:t});let a=o.getQueryData(t);return o.setQueryData(t,n),{previousValue:a}},onError(n,a,c){o.setQueryData(t,c?.previousValue)}})}s(Ft,"useSetSwapStorageValue");var ce;(function(e){e.Auto="auto",e.Fixed="fixed"})(ce||(ce={}));var A0={type:ce.Auto},ao=s(()=>{let{slippageSetting:e,isFetched:t,save:r}=x0();return{isFetched:t,selectedSetting:e??A0,setSlippageSetting:r}},"useSlippageSettings"),x0=s(()=>{let{data:e,isFetched:t}=It({key:Ce.SlippageSettings,queryKey:he.slippageSettings()}),{mutateAsync:r}=Ft({key:Ce.SlippageSettings,queryKey:he.slippageSettings()}),o=(0,Oy.useCallback)(async n=>{await r(n)},[r]);return{isFetched:t,slippageSetting:e,save:o}},"useSlippageSettingsStore");u();l();async function An({transactions:e,locale:t,url:r,deviceId:o,takerAddress:n,networkId:a,slippageType:c,quote:p,quoteResponse:m,isSimulationKilled:d}){try{return d?{status:"skipped"}:x.isHyperevmNetworkID(a)?{status:"skipped"}:{status:"success",result:await gl(t,o,{type:"transaction",userAccount:n,params:E0(e),url:r,networkID:a,context:ne(p)?"bridge":Zh(p)?"gaslessSwap":"swap",provider:k0(p),slippageType:c,metadata:{swapper:{quoteOutputAmount:p.buyAmount,quoteOutputToken:M(m.buyToken),quoteInputAmount:p.sellAmount,quoteInputToken:M(m.sellToken)}}})}}catch(f){return{status:"error",error:f}}}s(An,"simulateSwap");var E0=s(e=>{switch(e.type){case"evm":return{transactions:e.transactions};case"solana":return{transactions:e.transactions,method:"signAndSendTransaction",simulatorConfig:{decodeAccounts:!1}};case"sui":case"bitcoin":return{transactions:e.transactions,method:"signAndSendTransaction"}}},"getScannedTransactionParams"),k0=s(e=>{let t=ne(e)?wn(e):e?.sources??[];return Pe(t)},"getProvider");var ic=class{static{s(this,"EVMProcessBridgeQuoteCommand")}networkID;account;priceClient;quoteInput;quoteResponse;constructor(t,r,o,n,a){this.networkID=t,this.account=r,this.priceClient=o,this.quoteInput=n,this.quoteResponse=a}getNativeTokenCaip19(){return M({chainId:this.networkID,resourceType:ee.nativeToken,slip44:x.getSlip44(this.networkID)})}async processQuote(t,r){let o=await this.createSwapTransactions(t),n=await this.priceClient.getPrice(this.getNativeTokenCaip19());if(!n.usd)throw new Error("Price data not found");let a=await this.calculateNetworkFee(o,t,n,r),c=this.appendBridgeFees([a],t,n),p=this.appendPhantomFee(c,t);return{quote:t,fees:{totalFees:this.sumFees(p),fees:p},swapTransactions:o}}createSwapTransactions(t){return Bs({networkId:this.networkID,callerAddress:this.checkChainAddress().address,quote:t})}appendPhantomFee(t,r){let o=r.steps.flatMap(n=>n.feeCosts).find(n=>n.name==="phantom");return o?[...t,{type:"phantom",percentage:new _(o.percentage),amountUsd:new _(0),amount:new _(0)}]:t}appendBridgeFees(t,r,o){let n={[this.getNativeTokenCaip19()]:o},a=so(r,this.networkID,n),c=no(r);return[...t,...c,...a]}async calculateNetworkFee(t,r,o,n){let a=await this.estimateGas(r,t,n);if(!a)throw new Error("Unable to estimate gas");if(!o.usd)throw new Error("Price data not found");let c=a[0],p=x.getTokenDecimals(this.networkID),m=c.gasLimit.times(c.maxFeePerGas);return{type:"evmGas",amountUsd:new _(m).shiftedBy(-p).times(o.usd),amount:m}}async estimateGas(t,r,o){let n=await nn(this.networkID,!0);if(!n)return;let a=n[br.standard];if(!a)return;let c={networkID:this.networkID,gasLimit:new _(1),maxFeePerGas:a.maxFeePerGas,maxPriorityFeePerGas:a.maxPriorityFeePerGas},p=await An({transactions:r,locale:"en-us",url:"https://phantom.app",deviceId:"123",takerAddress:this.checkChainAddress().address,networkId:this.networkID,slippageType:this.quoteInput.autoSlippage?ce.Auto:ce.Fixed,quote:t,quoteResponse:this.quoteResponse,isSimulationKilled:o});return Sn.estimateGas({swapTransactions:r,evmGasEstimation:c,currentQuote:t,scanResult:p.status==="success"?p.result:void 0,includeGasBuffer:!0,networkID:this.networkID,gasBuffer:this.quoteResponse.gasBuffer})}checkChainAddress(){let t=this.account.addresses.find(o=>o.networkID===this.networkID);if(!t)throw new Error(`No address found for chain ${this.networkID}`);let r={...t};return gr(r)&&(r.address=r.address.toLowerCase()),r}sumFees(t){return t.reduce((r,o)=>r.plus(o.amountUsd),new _(0))}};u();l();var cc=class{static{s(this,"EVMProcessQuoteCommand")}networkID;account;priceClient;quoteInput;quoteResponse;constructor(t,r,o,n,a){this.networkID=t,this.account=r,this.priceClient=o,this.quoteInput=n,this.quoteResponse=a}getNativeTokenCaip19(){return M({chainId:this.networkID,resourceType:ee.nativeToken,slip44:x.getSlip44(this.networkID)})}async processQuote(t,r){let o=await this.createSwapTransactions(t),n=await this.calculateNetworkFee(o,t,r),a=this.appendPhantomFee([n],t);return{quote:t,fees:{totalFees:this.sumFees(a),fees:a},swapTransactions:o}}createSwapTransactions(t){return Us({networkId:this.networkID,callerAddress:this.checkChainAddress().address,quote:t,sellFungible:this.quoteInput.sell})}appendPhantomFee(t,r){let o=r.fees.find(n=>n.type==="phantom");return o?[...t,{type:"phantom",percentage:new _(o.percentage),amountUsd:new _(0),amount:new _(0)}]:t}async calculateNetworkFee(t,r,o){let n=await this.estimateGas(r,t,o);if(!n)throw new Error("Unable to estimate gas");let a=await this.priceClient.getPrice(this.getNativeTokenCaip19());if(!a.usd)throw new Error("Price data not found");let c=n[0],p=x.getTokenDecimals(this.networkID),m=c.gasLimit.times(c.maxFeePerGas);return{type:"evmGas",amountUsd:new _(m).shiftedBy(-p).times(a.usd),amount:m}}async estimateGas(t,r,o){let n=await nn(this.networkID,!0);if(!n)return;let a=n[br.standard];if(!a)return;let c={networkID:this.networkID,gasLimit:new _(1),maxFeePerGas:a.maxFeePerGas,maxPriorityFeePerGas:a.maxPriorityFeePerGas},p=await An({transactions:r,locale:"en-us",url:"https://phantom.app",deviceId:"123",takerAddress:this.checkChainAddress().address,networkId:this.networkID,slippageType:this.quoteInput.autoSlippage?ce.Auto:ce.Fixed,quote:t,quoteResponse:this.quoteResponse,isSimulationKilled:o});return Sn.estimateGas({swapTransactions:r,evmGasEstimation:c,currentQuote:t,scanResult:p.status==="success"?p.result:void 0,includeGasBuffer:!0,networkID:this.networkID,gasBuffer:this.quoteResponse.gasBuffer})}checkChainAddress(){let t=this.account.addresses.find(o=>o.networkID===this.networkID);if(!t)throw new Error(`No address found for chain ${this.networkID}`);let r={...t};return gr(r)&&(r.address=r.address.toLowerCase()),r}sumFees(t){return t.reduce((r,o)=>r.plus(o.amountUsd),new _(0))}};u();l();var uc=class{static{s(this,"SolanaProcessBridgeQuoteCommand")}networkID;priceClient;connection;constructor(t,r,o){this.networkID=t,this.priceClient=r,this.connection=o}getNativeTokenCaip19(){return M({chainId:this.networkID,resourceType:ee.nativeToken,slip44:x.getSlip44(this.networkID)})}async processQuote(t,r){let o=await this.createSwapTransactions(t),n=await this.priceClient.getPrice(this.getNativeTokenCaip19());if(!n.usd)throw new Error("Price data not found");let a=await this.calculateNetworkFee(o,n),c=this.appendBridgeFees([a],t,n),p=this.appendPhantomFee(c,t);return{quote:t,fees:{totalFees:this.sumFees(p),fees:p},swapTransactions:o}}createSwapTransactions(t){return Ls({quote:t,connection:this.connection})}appendPhantomFee(t,r){let o=r.steps.flatMap(n=>n.feeCosts).find(n=>n.name==="phantom");return o?[...t,{type:"phantom",percentage:new _(o.percentage),amountUsd:new _(0),amount:new _(0)}]:t}appendBridgeFees(t,r,o){let n={[this.getNativeTokenCaip19()]:o},a=so(r,this.networkID,n),c=no(r);return[...t,...c,...a]}async calculateNetworkFee(t,r){if(!r.usd)throw new Error("Price data not found");let o=t.transactions.map(d=>this.processEncodedTx(d,this.networkID,this.connection)),a=(await Promise.all(o)).map(d=>d.networkFeeEstimation.value),c=new _(a[0]);return{type:"solanaNetwork",amountUsd:c.div(new _(Fe.LAMPORTS_PER_SOL)).times(r.usd),amount:c}}async processEncodedTx(t,r,o){let n=Tt(t,"bs58");return await Im(n,o),{networkFeeEstimation:await Of(r,[n.message])}}sumFees(t){return t.reduce((r,o)=>r.plus(o.amountUsd),new _(0))}};u();l();u();l();function My(e,t){return C0(e.fees,r=>{switch(r.type){case"gasless":return{type:"gasless",amountUsd:new _(0),amount:new _(0),percentage:new _(r.percentage)};case"phantom":return{type:"phantom",percentage:new _(r.percentage),amountUsd:new _(0),amount:new _(0)};case"ata":return new _(r.amount).isZero()?void 0:{type:"ata",amountUsd:new _(r.amount),amount:new _(0)};case"gasless_network":return{type:"solanaGaslessNetwork",amountUsd:new _(r.amount),amount:new _(0)};case"network":{let{amountUsd:o,amount:n}=lp(r,t);return{type:"solanaNetwork",amountUsd:o,amount:n}}case"tips":{let{amountUsd:o,amount:n}=lp(r,t);return{type:"tips",amountUsd:o,amount:n}}case"priority_fee":{let{amountUsd:o,amount:n}=lp(r,t);return{type:"priorityFee",amountUsd:o,amount:n}}default:return}})}s(My,"parseFees");function lp(e,t){let r=new _(e.amount);return{amountUsd:r.div(new _(Fe.LAMPORTS_PER_SOL)).times(t),amount:r}}s(lp,"getAmountsFromNativeAmount");function C0(e,t){return e.reduce((r,o,n)=>{let a=t(o,n,e);return a!=null&&r.push(a),r},[])}s(C0,"compactMap");var Qy=["solanaNetwork","tips","priorityFee"],lc=class{static{s(this,"SolanaProcessQuoteCommand")}networkID;priceClient;connection;constructor(t,r,o){this.networkID=t,this.priceClient=r,this.connection=o}getNativeTokenCaip19(){return M({chainId:this.networkID,resourceType:ee.nativeToken,slip44:x.getSlip44(this.networkID)})}async processQuote(t,r){let n=(await this.priceClient.getPrice(this.getNativeTokenCaip19())).usd;if(!n)throw new Error(`Price data not found for native token ${this.getNativeTokenCaip19()}`);let a=await this.createSwapTransactions(t),c=My(t,n),p=await this.processParsedFees(c,n);return{quote:t,fees:{totalFees:this.sumFees(p),fees:p},swapTransactions:a}}async processParsedFees(t,r){if(t.find(m=>m.type==="solanaGaslessNetwork"))return t;let o=t.filter(m=>!Qy.includes(m.type)),n=t.filter(m=>Qy.includes(m.type)),a=t.find(m=>m.type==="priorityFee"),c=await this.calculateNetworkFee(a,r),p=this.sumNetworkFees(c,n);return[...o,p]}sumNetworkFees(t,r){return r.reduce((o,n)=>({...o,amount:o.amount.plus(n.amount),amountUsd:o.amountUsd.plus(n.amountUsd)}),t)}createSwapTransactions(t){return yn({quote:t,connection:this.connection})}getAmountsFromNativeAmount(t,r){let o=new _(t.amount);return{amountUsd:o.div(new _(Fe.LAMPORTS_PER_SOL)).times(r),amount:o}}async calculateNetworkFee(t,r){let o=new _(t?.amount??0);return{type:"solanaNetwork",amountUsd:o.div(new _(Fe.LAMPORTS_PER_SOL)).times(r),amount:o}}sumFees(t){return t.reduce((r,o)=>r.plus(o.amountUsd),new _(0))}};u();l();u();l();var xn=class{static{s(this,"SuiProcessQuoteCommand")}networkID;priceClient;constructor(t,r){this.networkID=t,this.priceClient=r}getNativeTokenCaip19(){return M({chainId:this.networkID,resourceType:ee.nativeToken,slip44:x.getSlip44(this.networkID)})}async processQuote(t,r){let o=await this.createSwapTransactions(t),n=await this.calculateNetworkFee(o),a=this.appendPhantomFee([n],t);return{quote:t,fees:{totalFees:this.sumFees(a),fees:a},swapTransactions:o}}createSwapTransactions(t){return Ms({quote:t})}appendPhantomFee(t,r){let o=r.fees.find(n=>n.type==="phantom");return o?[...t,{type:"phantom",percentage:new _(o.percentage),amountUsd:new _(0),amount:new _(0)}]:t}async calculateNetworkFee(t){let r=await this.priceClient.getPrice(this.getNativeTokenCaip19());if(!r.usd)throw new Error("Price data not found");let o=new _(0),n=new _(0);try{let a=await Promise.all(t.transactions.map(c=>Lf({networkID:this.networkID,transaction:$a.deserializeTransactionString(c)})));n=new _(a.reduce((c,p)=>c+p.gasBudget.toNumber(),0)),o=n.dividedBy(1e9).multipliedBy(r.usd)}catch{return{type:"suiNetwork",amountUsd:new _(0),amount:new _(0)}}return{type:"suiNetwork",amountUsd:o,amount:n}}sumFees(t){return t.reduce((r,o)=>r.plus(o.amountUsd),new _(0))}};var pc=class{static{s(this,"SuiBridgeProcessQuoteCommand")}networkID;priceClient;suiProcessQuoteCommand;constructor(t,r){this.networkID=t,this.priceClient=r,this.suiProcessQuoteCommand=new xn(t,r)}getNativeTokenCaip19(){return this.suiProcessQuoteCommand.getNativeTokenCaip19()}async processQuote(t,r){let o=await this.createSwapTransactions(t),n=await this.priceClient.getPrice(this.getNativeTokenCaip19());if(!n.usd)throw new Error("Price data not found");let a=await this.suiProcessQuoteCommand.calculateNetworkFee(o),c=this.appendBridgeFees([a],t,n),p=this.appendPhantomFee(c,t);return{quote:t,fees:{totalFees:this.sumFees(p),fees:p},swapTransactions:o}}appendBridgeFees(t,r,o){let n={[this.getNativeTokenCaip19()]:o},a=so(r,this.networkID,n),c=no(r);return[...t,...c,...a]}appendPhantomFee(t,r){let o=r.steps.flatMap(n=>n.feeCosts).find(n=>n.name==="phantom");return o?[...t,{type:"phantom",percentage:new _(o.percentage),amountUsd:new _(0),amount:new _(0)}]:t}createSwapTransactions(t){return Os({quote:t})}sumFees(t){return t.reduce((r,o)=>r.plus(o.amountUsd),new _(0))}};var dc=class{static{s(this,"ProcessQuoteCommandFactoryImpl")}create(t,r,o,n){let a=r.sell.data.chain.id,c=r.buy.data.chain.id,p=Wt(a,c);if(x.isSolanaNetworkID(a)){let m=rg(t).connection;return p?new uc(a,this.priceClient,m):new lc(a,this.priceClient,m)}else{if(x.isEVMNetworkID(a))return p?new ic(a,t,this.priceClient,r,o):new cc(a,t,this.priceClient,r,o);if(x.isSuiNetworkID(a))return p?new pc(a,this.priceClient):new xn(a,this.priceClient);if(x.isBitcoinNetworkID(a)&&p)return new nc(a,this.priceClient)}throw new Error(`Unsupported network ID: ${a}`)}priceClient={getPrice:s(async t=>(await Xa({tokens:[We(t)]}))[t],"getPrice")};isSupportedNetwork(t){return x.isSolanaNetworkID(t)||x.isEVMNetworkID(t)}},mc=class{static{s(this,"NoOpProcessQuoteCommandFactory")}create(t,r,o,n){return{processQuote:s(async(a,c)=>({quote:a,fees:{totalFees:new _(0),fees:[]}}),"processQuote")}}};u();l();u();l();u();l();var qy="CASH";u();l();var zy=s(e=>e.reduce((t,r)=>{if(!r||r.type!==oe.SPL)return t;let o;return r.type===oe.SPL&&(o=_0(r)),o?{fees:[...t.fees,o],totalPercentFees:t.totalPercentFees+o.percentFee}:t},{fees:[],totalPercentFees:0}),"getSwapTransferFees"),_0=s(e=>{if(e.type!==oe.SPL)return;let r=(e.data.mintExtensions??[]).find(o=>o.extension===Ya.transferFeeConfig);if(r)return{caip19:M(X(e)),fungibleKey:e.data.key,symbol:e.data.symbol??"",name:e.data.name??"",percentFee:r.state.newerTransferFee.transferFeeBasisPoints/100}},"getSplTransferFee");u();l();var I0=s(e=>e.isGreaterThanOrEqualTo(1)?"0,0.[00]":"0,0.[00000]","getFormatString"),En=s(e=>{let t=_(e);return lg(e,I0(t))},"formatTokenAmountGreaterThan1");var F0=.05,v0=5,P0=.5;function pp(e,t,r,o){let{priceImpact:n,quoteSlippageTolerance:a}=R0(e),c=t.autoSlippage?a??r.slippageTolerance:r.slippageTolerance,p={type:"slippage",slippage:c,slippageType:t.autoSlippage?ce.Auto:ce.Fixed,alert:c&&c>=v0?"highSlippage":void 0},m={type:"priceImpact",priceImpactPercentage:n.gt(0)?mg(n.toNumber()):"-",alert:n&&n.gte(F0)?"highPriceImpact":void 0,warning:n&&n.gte(P0)?"veryHighPriceImpact":void 0},f=[dp(e,t.buy,t.sell),p,m],h=zy([t.sell,t.buy]);return h.fees.length>0&&f.push({type:"transferFees",transferFees:h.totalPercentFees,transferTokenSymbol:t.sell.data.symbol??"",alert:"transferFees"}),o&&f.push({type:"fees",quoteFees:o}),f}s(pp,"entriesForQuote");function R0(e){return Ct(e)?{priceImpact:e.priceImpact?_(e.priceImpact):_(0),quoteSlippageTolerance:e.slippageTolerance}:ur(e)?{priceImpact:e.priceImpact?_(e.priceImpact):_(0),quoteSlippageTolerance:e.slippageTolerance}:Or(e)?{priceImpact:e.priceImpact?_(e.priceImpact):_(0),quoteSlippageTolerance:e.slippageTolerance}:{priceImpact:_(0),quoteSlippageTolerance:void 0}}s(R0,"extractQuoteInfo");function dp(e,t,r){let{buyAmount:o,sellAmount:n}=e,a=new _(o).shiftedBy(-t.data.decimals).dividedBy(new _(n).shiftedBy(-r.data.decimals));return{type:"pricing",ratio:a,exchangeRate:`1 ${fc(r)} \u2248 ${En(a)} ${fc(t)}`,exchangeRateFlipped:`1 ${fc(t)} \u2248 ${En(_(1).dividedBy(a))} ${fc(r)}`}}s(dp,"parsePricing");function fc(e){return oi(e)?qy:e.data.symbol??""}s(fc,"cashDeobfuscatedSymbol");u();l();var gc=class{static{s(this,"AsyncQueue")}queue=[];processing=!1;enqueue(t){this.queue.push(t),this.processNext()}clearQueue(){this.queue=[],this.processing=!1}async processNext(){if(this.processing||this.queue.length===0)return;this.processing=!0;let t=this.queue.shift();if(t)try{await t()}catch(r){console.error("Error processing task:",r)}this.processing=!1,this.processNext()}};u();l();var Gs=class{static{s(this,"QuoteDetails")}entries;alerts=[];warnings=[];constructor(t){this.entries=t;for(let r of t)r.alert&&this.alerts.push(r.alert),r.warning&&this.warnings.push(r.warning)}};u();l();var mp;(function(e){e.SwapperNoQuotes="SwapperNoQuotes",e.InsufficientSellAmount="InsufficientSellAmount",e.CrossChainUnavailable="CrossChainUnavailable",e.TokenNotTradable="TokenNotTradable",e.NotEnoughSuiObjects="NotEnoughSuiObjects",e.FromTokenIsHoneyPotToken="FromTokenIsHoneyPotToken",e.ToTokenIsHoneyPotToken="ToTokenIsHoneyPotToken",e.InsufficientLiquidity="InsufficientLiquidity",e.SwapInitializationFailed="SwapInitializationFailed",e.pSolHighImpactError="pSolHighImpactError"})(mp||(mp={}));var hc=class e extends Error{static{s(this,"QuoteError")}name;type;constructor(t,r,o){super(r),this.name=t,this.type=o}static fromErrorResponse(t,r){return s(n=>Object.values(mp).includes(n),"isValidType")(t)?new e(t,r,t):new e(t,r)}};var D0="swap-quotes",yc=class{static{s(this,"QuoteProcessor")}quoteStreamer;commandFactory;state={type:"idle"};listeners=[];swapTransactionQueue=new gc;constructor(t,r){this.quoteStreamer=t,this.commandFactory=r}start(t,r){this.setState({type:"starting",input:t,account:r}),this.quoteStreamer.subscribe(this.quoteStreamListener),this.quoteStreamer.openStream(t)}stop(){this.swapTransactionQueue.clearQueue(),this.setState({type:"idle"}),this.quoteStreamer.closeStream(),this.quoteStreamer.unsubscribe(this.quoteStreamListener)}setQuoteStreamer(t){this.stop(),this.quoteStreamer=t}quoteStreamListener={onEvent:s(t=>{switch(t.type){case"newQuoteResponse":switch(this.state.type){case"starting":let n=this.findPreferredQuote(this.state.input,t.quoteResponse);this.setState({type:"firstQuoteReceived",input:this.state.input,quote:n,response:t.quoteResponse,account:this.state.account,quoteDetails:new Gs(pp(n,this.state.input,t.quoteResponse))}),this.enqueueQuoteToProcess(this.state.input,t.quoteResponse,this.state.account);break;case"quoteProcessed":this.enqueueQuoteToProcess(this.state.input,t.quoteResponse,this.state.account,this.state.prevProcessedQuote);break}break;case"error":let r=hc.fromErrorResponse(t.errorResponse.name,t.errorResponse.message),o=new Ge({key:r.name});switch(P.addBreadcrumb(D0,JSON.stringify(r.name),Y.Info),this.state.type){case"starting":case"firstQuoteReceived":case"quoteProcessed":case"error":this.setState({type:"error",error:o,quoteError:r,account:this.state.account,input:this.state.input});break}break;case"openRequested":break;case"close":this.setState({type:"idle"});break}},"onEvent")};enqueueQuoteToProcess(t,r,o,n){this.swapTransactionQueue.enqueue(()=>this.processQuote(r,t,o,n))}async processQuote(t,r,o,n){try{let a=this.findPreferredQuote(r,t),p=await this.commandFactory.create(o,r,t,r.isSimulationKilled).processQuote(a,r.isSimulationKilled);switch(this.state.type){case"firstQuoteReceived":case"quoteProcessed":case"error":this.setState({type:"quoteProcessed",input:r,response:t,quote:a,prevProcessedQuote:n,nextProcessedQuote:p,account:o,quoteDetails:new Gs(pp(a,r,t,p.fees))});break}return p}catch(a){throw P.captureError(a,O.Swapper),a}}subscribe(t){this.listeners.push(t)}unsubscribe(t){this.listeners=this.listeners.filter(r=>r!==t)}getState(){return this.state}findPreferredQuote(t,r){let o=t.preferredProvider;return o&&r.quotes.find(n=>n.baseProvider.id===o)||r.quotes[0]}setState(t){let r=this.state;this.state=t,this.listeners.forEach(o=>o.onStateChange(r,t))}};u();l();u();l();u();l();u();l();function vn(e){let t=e.length;for(;--t>=0;)e[t]=0}s(vn,"zero$1");var N0=0,_w=1,B0=2,L0=3,U0=258,Up=29,na=256,Zs=na+1+Up,_n=30,Op=19,Iw=2*Zs+1,Io=15,fp=16,O0=7,Mp=256,Fw=16,vw=17,Pw=18,Ip=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),xc=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),M0=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Rw=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Q0=512,zr=new Array((Zs+2)*2);vn(zr);var Hs=new Array(_n*2);vn(Hs);var Ys=new Array(Q0);vn(Ys);var Xs=new Array(U0-L0+1);vn(Xs);var Qp=new Array(Up);vn(Qp);var Ec=new Array(_n);vn(Ec);function gp(e,t,r,o,n){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=o,this.max_length=n,this.has_stree=e&&e.length}s(gp,"StaticTreeDesc");var Dw,Nw,Bw;function hp(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}s(hp,"TreeDesc");var Lw=s(e=>e<256?Ys[e]:Ys[256+(e>>>7)],"d_code"),Js=s((e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},"put_short"),vt=s((e,t,r)=>{e.bi_valid>fp-r?(e.bi_buf|=t<<e.bi_valid&65535,Js(e,e.bi_buf),e.bi_buf=t>>fp-e.bi_valid,e.bi_valid+=r-fp):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},"send_bits"),kr=s((e,t,r)=>{vt(e,r[t*2],r[t*2+1])},"send_code"),Uw=s((e,t)=>{let r=0;do r|=e&1,e>>>=1,r<<=1;while(--t>0);return r>>>1},"bi_reverse"),q0=s(e=>{e.bi_valid===16?(Js(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},"bi_flush"),z0=s((e,t)=>{let r=t.dyn_tree,o=t.max_code,n=t.stat_desc.static_tree,a=t.stat_desc.has_stree,c=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,m=t.stat_desc.max_length,d,f,h,w,y,S,T=0;for(w=0;w<=Io;w++)e.bl_count[w]=0;for(r[e.heap[e.heap_max]*2+1]=0,d=e.heap_max+1;d<Iw;d++)f=e.heap[d],w=r[r[f*2+1]*2+1]+1,w>m&&(w=m,T++),r[f*2+1]=w,!(f>o)&&(e.bl_count[w]++,y=0,f>=p&&(y=c[f-p]),S=r[f*2],e.opt_len+=S*(w+y),a&&(e.static_len+=S*(n[f*2+1]+y)));if(T!==0){do{for(w=m-1;e.bl_count[w]===0;)w--;e.bl_count[w]--,e.bl_count[w+1]+=2,e.bl_count[m]--,T-=2}while(T>0);for(w=m;w!==0;w--)for(f=e.bl_count[w];f!==0;)h=e.heap[--d],!(h>o)&&(r[h*2+1]!==w&&(e.opt_len+=(w-r[h*2+1])*r[h*2],r[h*2+1]=w),f--)}},"gen_bitlen"),Ow=s((e,t,r)=>{let o=new Array(Io+1),n=0,a,c;for(a=1;a<=Io;a++)n=n+r[a-1]<<1,o[a]=n;for(c=0;c<=t;c++){let p=e[c*2+1];p!==0&&(e[c*2]=Uw(o[p]++,p))}},"gen_codes"),G0=s(()=>{let e,t,r,o,n,a=new Array(Io+1);for(r=0,o=0;o<Up-1;o++)for(Qp[o]=r,e=0;e<1<<Ip[o];e++)Xs[r++]=o;for(Xs[r-1]=o,n=0,o=0;o<16;o++)for(Ec[o]=n,e=0;e<1<<xc[o];e++)Ys[n++]=o;for(n>>=7;o<_n;o++)for(Ec[o]=n<<7,e=0;e<1<<xc[o]-7;e++)Ys[256+n++]=o;for(t=0;t<=Io;t++)a[t]=0;for(e=0;e<=143;)zr[e*2+1]=8,e++,a[8]++;for(;e<=255;)zr[e*2+1]=9,e++,a[9]++;for(;e<=279;)zr[e*2+1]=7,e++,a[7]++;for(;e<=287;)zr[e*2+1]=8,e++,a[8]++;for(Ow(zr,Zs+1,a),e=0;e<_n;e++)Hs[e*2+1]=5,Hs[e*2]=Uw(e,5);Dw=new gp(zr,Ip,na+1,Zs,Io),Nw=new gp(Hs,xc,0,_n,Io),Bw=new gp(new Array(0),M0,0,Op,O0)},"tr_static_init"),Mw=s(e=>{let t;for(t=0;t<Zs;t++)e.dyn_ltree[t*2]=0;for(t=0;t<_n;t++)e.dyn_dtree[t*2]=0;for(t=0;t<Op;t++)e.bl_tree[t*2]=0;e.dyn_ltree[Mp*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},"init_block"),Qw=s(e=>{e.bi_valid>8?Js(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},"bi_windup"),Gy=s((e,t,r,o)=>{let n=t*2,a=r*2;return e[n]<e[a]||e[n]===e[a]&&o[t]<=o[r]},"smaller"),yp=s((e,t,r)=>{let o=e.heap[r],n=r<<1;for(;n<=e.heap_len&&(n<e.heap_len&&Gy(t,e.heap[n+1],e.heap[n],e.depth)&&n++,!Gy(t,o,e.heap[n],e.depth));)e.heap[r]=e.heap[n],r=n,n<<=1;e.heap[r]=o},"pqdownheap"),Ky=s((e,t,r)=>{let o,n,a=0,c,p;if(e.sym_next!==0)do o=e.pending_buf[e.sym_buf+a++]&255,o+=(e.pending_buf[e.sym_buf+a++]&255)<<8,n=e.pending_buf[e.sym_buf+a++],o===0?kr(e,n,t):(c=Xs[n],kr(e,c+na+1,t),p=Ip[c],p!==0&&(n-=Qp[c],vt(e,n,p)),o--,c=Lw(o),kr(e,c,r),p=xc[c],p!==0&&(o-=Ec[c],vt(e,o,p)));while(a<e.sym_next);kr(e,Mp,t)},"compress_block"),Fp=s((e,t)=>{let r=t.dyn_tree,o=t.stat_desc.static_tree,n=t.stat_desc.has_stree,a=t.stat_desc.elems,c,p,m=-1,d;for(e.heap_len=0,e.heap_max=Iw,c=0;c<a;c++)r[c*2]!==0?(e.heap[++e.heap_len]=m=c,e.depth[c]=0):r[c*2+1]=0;for(;e.heap_len<2;)d=e.heap[++e.heap_len]=m<2?++m:0,r[d*2]=1,e.depth[d]=0,e.opt_len--,n&&(e.static_len-=o[d*2+1]);for(t.max_code=m,c=e.heap_len>>1;c>=1;c--)yp(e,r,c);d=a;do c=e.heap[1],e.heap[1]=e.heap[e.heap_len--],yp(e,r,1),p=e.heap[1],e.heap[--e.heap_max]=c,e.heap[--e.heap_max]=p,r[d*2]=r[c*2]+r[p*2],e.depth[d]=(e.depth[c]>=e.depth[p]?e.depth[c]:e.depth[p])+1,r[c*2+1]=r[p*2+1]=d,e.heap[1]=d++,yp(e,r,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],z0(e,t),Ow(r,m,e.bl_count)},"build_tree"),Vy=s((e,t,r)=>{let o,n=-1,a,c=t[0*2+1],p=0,m=7,d=4;for(c===0&&(m=138,d=3),t[(r+1)*2+1]=65535,o=0;o<=r;o++)a=c,c=t[(o+1)*2+1],!(++p<m&&a===c)&&(p<d?e.bl_tree[a*2]+=p:a!==0?(a!==n&&e.bl_tree[a*2]++,e.bl_tree[Fw*2]++):p<=10?e.bl_tree[vw*2]++:e.bl_tree[Pw*2]++,p=0,n=a,c===0?(m=138,d=3):a===c?(m=6,d=3):(m=7,d=4))},"scan_tree"),jy=s((e,t,r)=>{let o,n=-1,a,c=t[0*2+1],p=0,m=7,d=4;for(c===0&&(m=138,d=3),o=0;o<=r;o++)if(a=c,c=t[(o+1)*2+1],!(++p<m&&a===c)){if(p<d)do kr(e,a,e.bl_tree);while(--p!==0);else a!==0?(a!==n&&(kr(e,a,e.bl_tree),p--),kr(e,Fw,e.bl_tree),vt(e,p-3,2)):p<=10?(kr(e,vw,e.bl_tree),vt(e,p-3,3)):(kr(e,Pw,e.bl_tree),vt(e,p-11,7));p=0,n=a,c===0?(m=138,d=3):a===c?(m=6,d=3):(m=7,d=4)}},"send_tree"),K0=s(e=>{let t;for(Vy(e,e.dyn_ltree,e.l_desc.max_code),Vy(e,e.dyn_dtree,e.d_desc.max_code),Fp(e,e.bl_desc),t=Op-1;t>=3&&e.bl_tree[Rw[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},"build_bl_tree"),V0=s((e,t,r,o)=>{let n;for(vt(e,t-257,5),vt(e,r-1,5),vt(e,o-4,4),n=0;n<o;n++)vt(e,e.bl_tree[Rw[n]*2+1],3);jy(e,e.dyn_ltree,t-1),jy(e,e.dyn_dtree,r-1)},"send_all_trees"),j0=s(e=>{let t=4093624447,r;for(r=0;r<=31;r++,t>>>=1)if(t&1&&e.dyn_ltree[r*2]!==0)return 0;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return 1;for(r=32;r<na;r++)if(e.dyn_ltree[r*2]!==0)return 1;return 0},"detect_data_type"),Hy=!1,H0=s(e=>{Hy||(G0(),Hy=!0),e.l_desc=new hp(e.dyn_ltree,Dw),e.d_desc=new hp(e.dyn_dtree,Nw),e.bl_desc=new hp(e.bl_tree,Bw),e.bi_buf=0,e.bi_valid=0,Mw(e)},"_tr_init$1"),qw=s((e,t,r,o)=>{vt(e,(N0<<1)+(o?1:0),3),Qw(e),Js(e,r),Js(e,~r),r&&e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r},"_tr_stored_block$1"),$0=s(e=>{vt(e,_w<<1,3),kr(e,Mp,zr),q0(e)},"_tr_align$1"),W0=s((e,t,r,o)=>{let n,a,c=0;e.level>0?(e.strm.data_type===2&&(e.strm.data_type=j0(e)),Fp(e,e.l_desc),Fp(e,e.d_desc),c=K0(e),n=e.opt_len+3+7>>>3,a=e.static_len+3+7>>>3,a<=n&&(n=a)):n=a=r+5,r+4<=n&&t!==-1?qw(e,t,r,o):e.strategy===4||a===n?(vt(e,(_w<<1)+(o?1:0),3),Ky(e,zr,Hs)):(vt(e,(B0<<1)+(o?1:0),3),V0(e,e.l_desc.max_code+1,e.d_desc.max_code+1,c+1),Ky(e,e.dyn_ltree,e.dyn_dtree)),Mw(e),o&&Qw(e)},"_tr_flush_block$1"),Z0=s((e,t,r)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=r,t===0?e.dyn_ltree[r*2]++:(e.matches++,t--,e.dyn_ltree[(Xs[r]+na+1)*2]++,e.dyn_dtree[Lw(t)*2]++),e.sym_next===e.sym_end),"_tr_tally$1"),Y0=H0,X0=qw,J0=W0,e_=Z0,t_=$0,r_={_tr_init:Y0,_tr_stored_block:X0,_tr_flush_block:J0,_tr_tally:e_,_tr_align:t_},o_=s((e,t,r,o)=>{let n=e&65535|0,a=e>>>16&65535|0,c=0;for(;r!==0;){c=r>2e3?2e3:r,r-=c;do n=n+t[o++]|0,a=a+n|0;while(--c);n%=65521,a%=65521}return n|a<<16|0},"adler32"),ea=o_,n_=s(()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var o=0;o<8;o++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},"makeTable"),s_=new Uint32Array(n_()),a_=s((e,t,r,o)=>{let n=s_,a=o+r;e^=-1;for(let c=o;c<a;c++)e=e>>>8^n[(e^t[c])&255];return e^-1},"crc32"),it=a_,Po={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},No={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},{_tr_init:i_,_tr_stored_block:vp,_tr_flush_block:c_,_tr_tally:uo,_tr_align:u_}=r_,{Z_NO_FLUSH:lo,Z_PARTIAL_FLUSH:l_,Z_FULL_FLUSH:p_,Z_FINISH:Zt,Z_BLOCK:$y,Z_OK:ut,Z_STREAM_END:Wy,Z_STREAM_ERROR:Cr,Z_DATA_ERROR:d_,Z_BUF_ERROR:wp,Z_DEFAULT_COMPRESSION:m_,Z_FILTERED:f_,Z_HUFFMAN_ONLY:wc,Z_RLE:g_,Z_FIXED:h_,Z_DEFAULT_STRATEGY:y_,Z_UNKNOWN:w_,Z_DEFLATED:_c}=No,S_=9,b_=15,T_=8,A_=29,x_=256,Pp=x_+1+A_,E_=30,k_=19,C_=2*Pp+1,__=15,ge=3,co=258,_r=co+ge+1,I_=32,In=42,qp=57,Rp=69,Dp=73,Np=91,Bp=103,Fo=113,Vs=666,St=1,Pn=2,Ro=3,Rn=4,F_=3,vo=s((e,t)=>(e.msg=Po[t],t),"err"),Zy=s(e=>e*2-(e>4?9:0),"rank"),io=s(e=>{let t=e.length;for(;--t>=0;)e[t]=0},"zero"),v_=s(e=>{let t,r,o,n=e.w_size;t=e.hash_size,o=t;do r=e.head[--o],e.head[o]=r>=n?r-n:0;while(--t);t=n,o=t;do r=e.prev[--o],e.prev[o]=r>=n?r-n:0;while(--t)},"slide_hash"),P_=s((e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask,"HASH_ZLIB"),po=P_,qt=s(e=>{let t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),r!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,t.pending===0&&(t.pending_out=0))},"flush_pending"),zt=s((e,t)=>{c_(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,qt(e.strm)},"flush_block_only"),Te=s((e,t)=>{e.pending_buf[e.pending++]=t},"put_byte"),Ks=s((e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},"putShortMSB"),Lp=s((e,t,r,o)=>{let n=e.avail_in;return n>o&&(n=o),n===0?0:(e.avail_in-=n,t.set(e.input.subarray(e.next_in,e.next_in+n),r),e.state.wrap===1?e.adler=ea(e.adler,t,n,r):e.state.wrap===2&&(e.adler=it(e.adler,t,n,r)),e.next_in+=n,e.total_in+=n,n)},"read_buf"),zw=s((e,t)=>{let r=e.max_chain_length,o=e.strstart,n,a,c=e.prev_length,p=e.nice_match,m=e.strstart>e.w_size-_r?e.strstart-(e.w_size-_r):0,d=e.window,f=e.w_mask,h=e.prev,w=e.strstart+co,y=d[o+c-1],S=d[o+c];e.prev_length>=e.good_match&&(r>>=2),p>e.lookahead&&(p=e.lookahead);do if(n=t,!(d[n+c]!==S||d[n+c-1]!==y||d[n]!==d[o]||d[++n]!==d[o+1])){o+=2,n++;do;while(d[++o]===d[++n]&&d[++o]===d[++n]&&d[++o]===d[++n]&&d[++o]===d[++n]&&d[++o]===d[++n]&&d[++o]===d[++n]&&d[++o]===d[++n]&&d[++o]===d[++n]&&o<w);if(a=co-(w-o),o=w-co,a>c){if(e.match_start=t,c=a,a>=p)break;y=d[o+c-1],S=d[o+c]}}while((t=h[t&f])>m&&--r!==0);return c<=e.lookahead?c:e.lookahead},"longest_match"),Fn=s(e=>{let t=e.w_size,r,o,n;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-_r)&&(e.window.set(e.window.subarray(t,t+t-o),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),v_(e),o+=t),e.strm.avail_in===0)break;if(r=Lp(e.strm,e.window,e.strstart+e.lookahead,o),e.lookahead+=r,e.lookahead+e.insert>=ge)for(n=e.strstart-e.insert,e.ins_h=e.window[n],e.ins_h=po(e,e.ins_h,e.window[n+1]);e.insert&&(e.ins_h=po(e,e.ins_h,e.window[n+ge-1]),e.prev[n&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=n,n++,e.insert--,!(e.lookahead+e.insert<ge)););}while(e.lookahead<_r&&e.strm.avail_in!==0)},"fill_window"),Gw=s((e,t)=>{let r=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,o,n,a,c=0,p=e.strm.avail_in;do{if(o=65535,a=e.bi_valid+42>>3,e.strm.avail_out<a||(a=e.strm.avail_out-a,n=e.strstart-e.block_start,o>n+e.strm.avail_in&&(o=n+e.strm.avail_in),o>a&&(o=a),o<r&&(o===0&&t!==Zt||t===lo||o!==n+e.strm.avail_in)))break;c=t===Zt&&o===n+e.strm.avail_in?1:0,vp(e,0,0,c),e.pending_buf[e.pending-4]=o,e.pending_buf[e.pending-3]=o>>8,e.pending_buf[e.pending-2]=~o,e.pending_buf[e.pending-1]=~o>>8,qt(e.strm),n&&(n>o&&(n=o),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+n),e.strm.next_out),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n,e.block_start+=n,o-=n),o&&(Lp(e.strm,e.strm.output,e.strm.next_out,o),e.strm.next_out+=o,e.strm.avail_out-=o,e.strm.total_out+=o)}while(c===0);return p-=e.strm.avail_in,p&&(p>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=p&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-p,e.strm.next_in),e.strstart),e.strstart+=p,e.insert+=p>e.w_size-e.insert?e.w_size-e.insert:p),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),c?Rn:t!==lo&&t!==Zt&&e.strm.avail_in===0&&e.strstart===e.block_start?Pn:(a=e.window_size-e.strstart,e.strm.avail_in>a&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,a+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),a>e.strm.avail_in&&(a=e.strm.avail_in),a&&(Lp(e.strm,e.window,e.strstart,a),e.strstart+=a,e.insert+=a>e.w_size-e.insert?e.w_size-e.insert:a),e.high_water<e.strstart&&(e.high_water=e.strstart),a=e.bi_valid+42>>3,a=e.pending_buf_size-a>65535?65535:e.pending_buf_size-a,r=a>e.w_size?e.w_size:a,n=e.strstart-e.block_start,(n>=r||(n||t===Zt)&&t!==lo&&e.strm.avail_in===0&&n<=a)&&(o=n>a?a:n,c=t===Zt&&e.strm.avail_in===0&&o===n?1:0,vp(e,e.block_start,o,c),e.block_start+=o,qt(e.strm)),c?Ro:St)},"deflate_stored"),Sp=s((e,t)=>{let r,o;for(;;){if(e.lookahead<_r){if(Fn(e),e.lookahead<_r&&t===lo)return St;if(e.lookahead===0)break}if(r=0,e.lookahead>=ge&&(e.ins_h=po(e,e.ins_h,e.window[e.strstart+ge-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),r!==0&&e.strstart-r<=e.w_size-_r&&(e.match_length=zw(e,r)),e.match_length>=ge)if(o=uo(e,e.strstart-e.match_start,e.match_length-ge),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=ge){e.match_length--;do e.strstart++,e.ins_h=po(e,e.ins_h,e.window[e.strstart+ge-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=po(e,e.ins_h,e.window[e.strstart+1]);else o=uo(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(o&&(zt(e,!1),e.strm.avail_out===0))return St}return e.insert=e.strstart<ge-1?e.strstart:ge-1,t===Zt?(zt(e,!0),e.strm.avail_out===0?Ro:Rn):e.sym_next&&(zt(e,!1),e.strm.avail_out===0)?St:Pn},"deflate_fast"),kn=s((e,t)=>{let r,o,n;for(;;){if(e.lookahead<_r){if(Fn(e),e.lookahead<_r&&t===lo)return St;if(e.lookahead===0)break}if(r=0,e.lookahead>=ge&&(e.ins_h=po(e,e.ins_h,e.window[e.strstart+ge-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=ge-1,r!==0&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-_r&&(e.match_length=zw(e,r),e.match_length<=5&&(e.strategy===f_||e.match_length===ge&&e.strstart-e.match_start>4096)&&(e.match_length=ge-1)),e.prev_length>=ge&&e.match_length<=e.prev_length){n=e.strstart+e.lookahead-ge,o=uo(e,e.strstart-1-e.prev_match,e.prev_length-ge),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=n&&(e.ins_h=po(e,e.ins_h,e.window[e.strstart+ge-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=ge-1,e.strstart++,o&&(zt(e,!1),e.strm.avail_out===0))return St}else if(e.match_available){if(o=uo(e,0,e.window[e.strstart-1]),o&&zt(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return St}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(o=uo(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<ge-1?e.strstart:ge-1,t===Zt?(zt(e,!0),e.strm.avail_out===0?Ro:Rn):e.sym_next&&(zt(e,!1),e.strm.avail_out===0)?St:Pn},"deflate_slow"),R_=s((e,t)=>{let r,o,n,a,c=e.window;for(;;){if(e.lookahead<=co){if(Fn(e),e.lookahead<=co&&t===lo)return St;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=ge&&e.strstart>0&&(n=e.strstart-1,o=c[n],o===c[++n]&&o===c[++n]&&o===c[++n])){a=e.strstart+co;do;while(o===c[++n]&&o===c[++n]&&o===c[++n]&&o===c[++n]&&o===c[++n]&&o===c[++n]&&o===c[++n]&&o===c[++n]&&n<a);e.match_length=co-(a-n),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=ge?(r=uo(e,1,e.match_length-ge),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=uo(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(zt(e,!1),e.strm.avail_out===0))return St}return e.insert=0,t===Zt?(zt(e,!0),e.strm.avail_out===0?Ro:Rn):e.sym_next&&(zt(e,!1),e.strm.avail_out===0)?St:Pn},"deflate_rle"),D_=s((e,t)=>{let r;for(;;){if(e.lookahead===0&&(Fn(e),e.lookahead===0)){if(t===lo)return St;break}if(e.match_length=0,r=uo(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(zt(e,!1),e.strm.avail_out===0))return St}return e.insert=0,t===Zt?(zt(e,!0),e.strm.avail_out===0?Ro:Rn):e.sym_next&&(zt(e,!1),e.strm.avail_out===0)?St:Pn},"deflate_huff");function Er(e,t,r,o,n){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=o,this.func=n}s(Er,"Config");var js=[new Er(0,0,0,0,Gw),new Er(4,4,8,4,Sp),new Er(4,5,16,8,Sp),new Er(4,6,32,32,Sp),new Er(4,4,16,16,kn),new Er(8,16,32,32,kn),new Er(8,16,128,128,kn),new Er(8,32,128,256,kn),new Er(32,128,258,1024,kn),new Er(32,258,258,4096,kn)],N_=s(e=>{e.window_size=2*e.w_size,io(e.head),e.max_lazy_match=js[e.level].max_lazy,e.good_match=js[e.level].good_length,e.nice_match=js[e.level].nice_length,e.max_chain_length=js[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=ge-1,e.match_available=0,e.ins_h=0},"lm_init");function B_(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=_c,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(C_*2),this.dyn_dtree=new Uint16Array((2*E_+1)*2),this.bl_tree=new Uint16Array((2*k_+1)*2),io(this.dyn_ltree),io(this.dyn_dtree),io(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(__+1),this.heap=new Uint16Array(2*Pp+1),io(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Pp+1),io(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}s(B_,"DeflateState");var sa=s(e=>{if(!e)return 1;let t=e.state;return!t||t.strm!==e||t.status!==In&&t.status!==qp&&t.status!==Rp&&t.status!==Dp&&t.status!==Np&&t.status!==Bp&&t.status!==Fo&&t.status!==Vs?1:0},"deflateStateCheck"),Kw=s(e=>{if(sa(e))return vo(e,Cr);e.total_in=e.total_out=0,e.data_type=w_;let t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?qp:t.wrap?In:Fo,e.adler=t.wrap===2?0:1,t.last_flush=-2,i_(t),ut},"deflateResetKeep"),Vw=s(e=>{let t=Kw(e);return t===ut&&N_(e.state),t},"deflateReset"),L_=s((e,t)=>sa(e)||e.state.wrap!==2?Cr:(e.state.gzhead=t,ut),"deflateSetHeader"),jw=s((e,t,r,o,n,a)=>{if(!e)return Cr;let c=1;if(t===m_&&(t=6),o<0?(c=0,o=-o):o>15&&(c=2,o-=16),n<1||n>S_||r!==_c||o<8||o>15||t<0||t>9||a<0||a>h_||o===8&&c!==1)return vo(e,Cr);o===8&&(o=9);let p=new B_;return e.state=p,p.strm=e,p.status=In,p.wrap=c,p.gzhead=null,p.w_bits=o,p.w_size=1<<p.w_bits,p.w_mask=p.w_size-1,p.hash_bits=n+7,p.hash_size=1<<p.hash_bits,p.hash_mask=p.hash_size-1,p.hash_shift=~~((p.hash_bits+ge-1)/ge),p.window=new Uint8Array(p.w_size*2),p.head=new Uint16Array(p.hash_size),p.prev=new Uint16Array(p.w_size),p.lit_bufsize=1<<n+6,p.pending_buf_size=p.lit_bufsize*4,p.pending_buf=new Uint8Array(p.pending_buf_size),p.sym_buf=p.lit_bufsize,p.sym_end=(p.lit_bufsize-1)*3,p.level=t,p.strategy=a,p.method=r,Vw(e)},"deflateInit2"),U_=s((e,t)=>jw(e,t,_c,b_,T_,y_),"deflateInit"),O_=s((e,t)=>{if(sa(e)||t>$y||t<0)return e?vo(e,Cr):Cr;let r=e.state;if(!e.output||e.avail_in!==0&&!e.input||r.status===Vs&&t!==Zt)return vo(e,e.avail_out===0?wp:Cr);let o=r.last_flush;if(r.last_flush=t,r.pending!==0){if(qt(e),e.avail_out===0)return r.last_flush=-1,ut}else if(e.avail_in===0&&Zy(t)<=Zy(o)&&t!==Zt)return vo(e,wp);if(r.status===Vs&&e.avail_in!==0)return vo(e,wp);if(r.status===In&&r.wrap===0&&(r.status=Fo),r.status===In){let n=_c+(r.w_bits-8<<4)<<8,a=-1;if(r.strategy>=wc||r.level<2?a=0:r.level<6?a=1:r.level===6?a=2:a=3,n|=a<<6,r.strstart!==0&&(n|=I_),n+=31-n%31,Ks(r,n),r.strstart!==0&&(Ks(r,e.adler>>>16),Ks(r,e.adler&65535)),e.adler=1,r.status=Fo,qt(e),r.pending!==0)return r.last_flush=-1,ut}if(r.status===qp){if(e.adler=0,Te(r,31),Te(r,139),Te(r,8),r.gzhead)Te(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),Te(r,r.gzhead.time&255),Te(r,r.gzhead.time>>8&255),Te(r,r.gzhead.time>>16&255),Te(r,r.gzhead.time>>24&255),Te(r,r.level===9?2:r.strategy>=wc||r.level<2?4:0),Te(r,r.gzhead.os&255),r.gzhead.extra&&r.gzhead.extra.length&&(Te(r,r.gzhead.extra.length&255),Te(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=it(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=Rp;else if(Te(r,0),Te(r,0),Te(r,0),Te(r,0),Te(r,0),Te(r,r.level===9?2:r.strategy>=wc||r.level<2?4:0),Te(r,F_),r.status=Fo,qt(e),r.pending!==0)return r.last_flush=-1,ut}if(r.status===Rp){if(r.gzhead.extra){let n=r.pending,a=(r.gzhead.extra.length&65535)-r.gzindex;for(;r.pending+a>r.pending_buf_size;){let p=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+p),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>n&&(e.adler=it(e.adler,r.pending_buf,r.pending-n,n)),r.gzindex+=p,qt(e),r.pending!==0)return r.last_flush=-1,ut;n=0,a-=p}let c=new Uint8Array(r.gzhead.extra);r.pending_buf.set(c.subarray(r.gzindex,r.gzindex+a),r.pending),r.pending+=a,r.gzhead.hcrc&&r.pending>n&&(e.adler=it(e.adler,r.pending_buf,r.pending-n,n)),r.gzindex=0}r.status=Dp}if(r.status===Dp){if(r.gzhead.name){let n=r.pending,a;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>n&&(e.adler=it(e.adler,r.pending_buf,r.pending-n,n)),qt(e),r.pending!==0)return r.last_flush=-1,ut;n=0}r.gzindex<r.gzhead.name.length?a=r.gzhead.name.charCodeAt(r.gzindex++)&255:a=0,Te(r,a)}while(a!==0);r.gzhead.hcrc&&r.pending>n&&(e.adler=it(e.adler,r.pending_buf,r.pending-n,n)),r.gzindex=0}r.status=Np}if(r.status===Np){if(r.gzhead.comment){let n=r.pending,a;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>n&&(e.adler=it(e.adler,r.pending_buf,r.pending-n,n)),qt(e),r.pending!==0)return r.last_flush=-1,ut;n=0}r.gzindex<r.gzhead.comment.length?a=r.gzhead.comment.charCodeAt(r.gzindex++)&255:a=0,Te(r,a)}while(a!==0);r.gzhead.hcrc&&r.pending>n&&(e.adler=it(e.adler,r.pending_buf,r.pending-n,n))}r.status=Bp}if(r.status===Bp){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(qt(e),r.pending!==0))return r.last_flush=-1,ut;Te(r,e.adler&255),Te(r,e.adler>>8&255),e.adler=0}if(r.status=Fo,qt(e),r.pending!==0)return r.last_flush=-1,ut}if(e.avail_in!==0||r.lookahead!==0||t!==lo&&r.status!==Vs){let n=r.level===0?Gw(r,t):r.strategy===wc?D_(r,t):r.strategy===g_?R_(r,t):js[r.level].func(r,t);if((n===Ro||n===Rn)&&(r.status=Vs),n===St||n===Ro)return e.avail_out===0&&(r.last_flush=-1),ut;if(n===Pn&&(t===l_?u_(r):t!==$y&&(vp(r,0,0,!1),t===p_&&(io(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),qt(e),e.avail_out===0))return r.last_flush=-1,ut}return t!==Zt?ut:r.wrap<=0?Wy:(r.wrap===2?(Te(r,e.adler&255),Te(r,e.adler>>8&255),Te(r,e.adler>>16&255),Te(r,e.adler>>24&255),Te(r,e.total_in&255),Te(r,e.total_in>>8&255),Te(r,e.total_in>>16&255),Te(r,e.total_in>>24&255)):(Ks(r,e.adler>>>16),Ks(r,e.adler&65535)),qt(e),r.wrap>0&&(r.wrap=-r.wrap),r.pending!==0?ut:Wy)},"deflate$2"),M_=s(e=>{if(sa(e))return Cr;let t=e.state.status;return e.state=null,t===Fo?vo(e,d_):ut},"deflateEnd"),Q_=s((e,t)=>{let r=t.length;if(sa(e))return Cr;let o=e.state,n=o.wrap;if(n===2||n===1&&o.status!==In||o.lookahead)return Cr;if(n===1&&(e.adler=ea(e.adler,t,r,0)),o.wrap=0,r>=o.w_size){n===0&&(io(o.head),o.strstart=0,o.block_start=0,o.insert=0);let m=new Uint8Array(o.w_size);m.set(t.subarray(r-o.w_size,r),0),t=m,r=o.w_size}let a=e.avail_in,c=e.next_in,p=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,Fn(o);o.lookahead>=ge;){let m=o.strstart,d=o.lookahead-(ge-1);do o.ins_h=po(o,o.ins_h,o.window[m+ge-1]),o.prev[m&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=m,m++;while(--d);o.strstart=m,o.lookahead=ge-1,Fn(o)}return o.strstart+=o.lookahead,o.block_start=o.strstart,o.insert=o.lookahead,o.lookahead=0,o.match_length=o.prev_length=ge-1,o.match_available=0,e.next_in=c,e.input=p,e.avail_in=a,o.wrap=n,ut},"deflateSetDictionary"),q_=U_,z_=jw,G_=Vw,K_=Kw,V_=L_,j_=O_,H_=M_,$_=Q_,W_="pako deflate (from Nodeca project)",$s={deflateInit:q_,deflateInit2:z_,deflateReset:G_,deflateResetKeep:K_,deflateSetHeader:V_,deflate:j_,deflateEnd:H_,deflateSetDictionary:$_,deflateInfo:W_},Z_=s((e,t)=>Object.prototype.hasOwnProperty.call(e,t),"_has"),Y_=s(function(e){let t=Array.prototype.slice.call(arguments,1);for(;t.length;){let r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(let o in r)Z_(r,o)&&(e[o]=r[o])}}return e},"assign"),X_=s(e=>{let t=0;for(let o=0,n=e.length;o<n;o++)t+=e[o].length;let r=new Uint8Array(t);for(let o=0,n=0,a=e.length;o<a;o++){let c=e[o];r.set(c,n),n+=c.length}return r},"flattenChunks"),Ic={assign:Y_,flattenChunks:X_},Hw=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Hw=!1}var ta=new Uint8Array(256);for(let e=0;e<256;e++)ta[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;ta[254]=ta[254]=1;var J_=s(e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,o,n,a,c=e.length,p=0;for(n=0;n<c;n++)r=e.charCodeAt(n),(r&64512)===55296&&n+1<c&&(o=e.charCodeAt(n+1),(o&64512)===56320&&(r=65536+(r-55296<<10)+(o-56320),n++)),p+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(p),a=0,n=0;a<p;n++)r=e.charCodeAt(n),(r&64512)===55296&&n+1<c&&(o=e.charCodeAt(n+1),(o&64512)===56320&&(r=65536+(r-55296<<10)+(o-56320),n++)),r<128?t[a++]=r:r<2048?(t[a++]=192|r>>>6,t[a++]=128|r&63):r<65536?(t[a++]=224|r>>>12,t[a++]=128|r>>>6&63,t[a++]=128|r&63):(t[a++]=240|r>>>18,t[a++]=128|r>>>12&63,t[a++]=128|r>>>6&63,t[a++]=128|r&63);return t},"string2buf"),eI=s((e,t)=>{if(t<65534&&e.subarray&&Hw)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let o=0;o<t;o++)r+=String.fromCharCode(e[o]);return r},"buf2binstring"),tI=s((e,t)=>{let r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let o,n,a=new Array(r*2);for(n=0,o=0;o<r;){let c=e[o++];if(c<128){a[n++]=c;continue}let p=ta[c];if(p>4){a[n++]=65533,o+=p-1;continue}for(c&=p===2?31:p===3?15:7;p>1&&o<r;)c=c<<6|e[o++]&63,p--;if(p>1){a[n++]=65533;continue}c<65536?a[n++]=c:(c-=65536,a[n++]=55296|c>>10&1023,a[n++]=56320|c&1023)}return eI(a,n)},"buf2string"),rI=s((e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+ta[e[r]]>t?r:t},"utf8border"),ra={string2buf:J_,buf2string:tI,utf8border:rI};function oI(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}s(oI,"ZStream");var $w=oI,Ww=Object.prototype.toString,{Z_NO_FLUSH:nI,Z_SYNC_FLUSH:sI,Z_FULL_FLUSH:aI,Z_FINISH:iI,Z_OK:kc,Z_STREAM_END:cI,Z_DEFAULT_COMPRESSION:uI,Z_DEFAULT_STRATEGY:lI,Z_DEFLATED:pI}=No;function aa(e){this.options=Ic.assign({level:uI,method:pI,chunkSize:16384,windowBits:15,memLevel:8,strategy:lI},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new $w,this.strm.avail_out=0;let r=$s.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==kc)throw new Error(Po[r]);if(t.header&&$s.deflateSetHeader(this.strm,t.header),t.dictionary){let o;if(typeof t.dictionary=="string"?o=ra.string2buf(t.dictionary):Ww.call(t.dictionary)==="[object ArrayBuffer]"?o=new Uint8Array(t.dictionary):o=t.dictionary,r=$s.deflateSetDictionary(this.strm,o),r!==kc)throw new Error(Po[r]);this._dict_set=!0}}s(aa,"Deflate$1");aa.prototype.push=function(e,t){let r=this.strm,o=this.options.chunkSize,n,a;if(this.ended)return!1;for(t===~~t?a=t:a=t===!0?iI:nI,typeof e=="string"?r.input=ra.string2buf(e):Ww.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){if(r.avail_out===0&&(r.output=new Uint8Array(o),r.next_out=0,r.avail_out=o),(a===sI||a===aI)&&r.avail_out<=6){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(n=$s.deflate(r,a),n===cI)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),n=$s.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===kc;if(r.avail_out===0){this.onData(r.output);continue}if(a>0&&r.next_out>0){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(r.avail_in===0)break}return!0};aa.prototype.onData=function(e){this.chunks.push(e)};aa.prototype.onEnd=function(e){e===kc&&(this.result=Ic.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function zp(e,t){let r=new aa(t);if(r.push(e,!0),r.err)throw r.msg||Po[r.err];return r.result}s(zp,"deflate$1");function dI(e,t){return t=t||{},t.raw=!0,zp(e,t)}s(dI,"deflateRaw$1");function mI(e,t){return t=t||{},t.gzip=!0,zp(e,t)}s(mI,"gzip$1");var fI=aa,gI=zp,hI=dI,yI=mI,wI=No,SI={Deflate:fI,deflate:gI,deflateRaw:hI,gzip:yI,constants:wI},Sc=16209,bI=16191,TI=s(function(t,r){let o,n,a,c,p,m,d,f,h,w,y,S,T,b,A,k,C,I,L,Q,R,H,q,E,F=t.state;o=t.next_in,q=t.input,n=o+(t.avail_in-5),a=t.next_out,E=t.output,c=a-(r-t.avail_out),p=a+(t.avail_out-257),m=F.dmax,d=F.wsize,f=F.whave,h=F.wnext,w=F.window,y=F.hold,S=F.bits,T=F.lencode,b=F.distcode,A=(1<<F.lenbits)-1,k=(1<<F.distbits)-1;e:do{S<15&&(y+=q[o++]<<S,S+=8,y+=q[o++]<<S,S+=8),C=T[y&A];t:for(;;){if(I=C>>>24,y>>>=I,S-=I,I=C>>>16&255,I===0)E[a++]=C&65535;else if(I&16){L=C&65535,I&=15,I&&(S<I&&(y+=q[o++]<<S,S+=8),L+=y&(1<<I)-1,y>>>=I,S-=I),S<15&&(y+=q[o++]<<S,S+=8,y+=q[o++]<<S,S+=8),C=b[y&k];r:for(;;){if(I=C>>>24,y>>>=I,S-=I,I=C>>>16&255,I&16){if(Q=C&65535,I&=15,S<I&&(y+=q[o++]<<S,S+=8,S<I&&(y+=q[o++]<<S,S+=8)),Q+=y&(1<<I)-1,Q>m){t.msg="invalid distance too far back",F.mode=Sc;break e}if(y>>>=I,S-=I,I=a-c,Q>I){if(I=Q-I,I>f&&F.sane){t.msg="invalid distance too far back",F.mode=Sc;break e}if(R=0,H=w,h===0){if(R+=d-I,I<L){L-=I;do E[a++]=w[R++];while(--I);R=a-Q,H=E}}else if(h<I){if(R+=d+h-I,I-=h,I<L){L-=I;do E[a++]=w[R++];while(--I);if(R=0,h<L){I=h,L-=I;do E[a++]=w[R++];while(--I);R=a-Q,H=E}}}else if(R+=h-I,I<L){L-=I;do E[a++]=w[R++];while(--I);R=a-Q,H=E}for(;L>2;)E[a++]=H[R++],E[a++]=H[R++],E[a++]=H[R++],L-=3;L&&(E[a++]=H[R++],L>1&&(E[a++]=H[R++]))}else{R=a-Q;do E[a++]=E[R++],E[a++]=E[R++],E[a++]=E[R++],L-=3;while(L>2);L&&(E[a++]=E[R++],L>1&&(E[a++]=E[R++]))}}else if(I&64){t.msg="invalid distance code",F.mode=Sc;break e}else{C=b[(C&65535)+(y&(1<<I)-1)];continue r}break}}else if(I&64)if(I&32){F.mode=bI;break e}else{t.msg="invalid literal/length code",F.mode=Sc;break e}else{C=T[(C&65535)+(y&(1<<I)-1)];continue t}break}}while(o<n&&a<p);L=S>>3,o-=L,S-=L<<3,y&=(1<<S)-1,t.next_in=o,t.next_out=a,t.avail_in=o<n?5+(n-o):5-(o-n),t.avail_out=a<p?257+(p-a):257-(a-p),F.hold=y,F.bits=S},"inflate_fast"),Cn=15,Yy=852,Xy=592,Jy=0,bp=1,ew=2,AI=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),xI=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),EI=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),kI=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),CI=s((e,t,r,o,n,a,c,p)=>{let m=p.bits,d=0,f=0,h=0,w=0,y=0,S=0,T=0,b=0,A=0,k=0,C,I,L,Q,R,H=null,q,E=new Uint16Array(Cn+1),F=new Uint16Array(Cn+1),z=null,W,re,Z;for(d=0;d<=Cn;d++)E[d]=0;for(f=0;f<o;f++)E[t[r+f]]++;for(y=m,w=Cn;w>=1&&E[w]===0;w--);if(y>w&&(y=w),w===0)return n[a++]=1<<24|64<<16|0,n[a++]=1<<24|64<<16|0,p.bits=1,0;for(h=1;h<w&&E[h]===0;h++);for(y<h&&(y=h),b=1,d=1;d<=Cn;d++)if(b<<=1,b-=E[d],b<0)return-1;if(b>0&&(e===Jy||w!==1))return-1;for(F[1]=0,d=1;d<Cn;d++)F[d+1]=F[d]+E[d];for(f=0;f<o;f++)t[r+f]!==0&&(c[F[t[r+f]]++]=f);if(e===Jy?(H=z=c,q=20):e===bp?(H=AI,z=xI,q=257):(H=EI,z=kI,q=0),k=0,f=0,d=h,R=a,S=y,T=0,L=-1,A=1<<y,Q=A-1,e===bp&&A>Yy||e===ew&&A>Xy)return 1;for(;;){W=d-T,c[f]+1<q?(re=0,Z=c[f]):c[f]>=q?(re=z[c[f]-q],Z=H[c[f]-q]):(re=96,Z=0),C=1<<d-T,I=1<<S,h=I;do I-=C,n[R+(k>>T)+I]=W<<24|re<<16|Z|0;while(I!==0);for(C=1<<d-1;k&C;)C>>=1;if(C!==0?(k&=C-1,k+=C):k=0,f++,--E[d]===0){if(d===w)break;d=t[r+c[f]]}if(d>y&&(k&Q)!==L){for(T===0&&(T=y),R+=h,S=d-T,b=1<<S;S+T<w&&(b-=E[S+T],!(b<=0));)S++,b<<=1;if(A+=1<<S,e===bp&&A>Yy||e===ew&&A>Xy)return 1;L=k&Q,n[L]=y<<24|S<<16|R-a|0}}return k!==0&&(n[R+k]=d-T<<24|64<<16|0),p.bits=y,0},"inflate_table"),Ws=CI,_I=0,Zw=1,Yw=2,{Z_FINISH:tw,Z_BLOCK:II,Z_TREES:bc,Z_OK:Do,Z_STREAM_END:FI,Z_NEED_DICT:vI,Z_STREAM_ERROR:Yt,Z_DATA_ERROR:Xw,Z_MEM_ERROR:Jw,Z_BUF_ERROR:PI,Z_DEFLATED:rw}=No,Fc=16180,ow=16181,nw=16182,sw=16183,aw=16184,iw=16185,cw=16186,uw=16187,lw=16188,pw=16189,Cc=16190,qr=16191,Tp=16192,dw=16193,Ap=16194,mw=16195,fw=16196,gw=16197,hw=16198,Tc=16199,Ac=16200,yw=16201,ww=16202,Sw=16203,bw=16204,Tw=16205,xp=16206,Aw=16207,xw=16208,Ne=16209,eS=16210,tS=16211,RI=852,DI=592,NI=15,BI=NI,Ew=s(e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24),"zswap32");function LI(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}s(LI,"InflateState");var Bo=s(e=>{if(!e)return 1;let t=e.state;return!t||t.strm!==e||t.mode<Fc||t.mode>tS?1:0},"inflateStateCheck"),rS=s(e=>{if(Bo(e))return Yt;let t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=Fc,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(RI),t.distcode=t.distdyn=new Int32Array(DI),t.sane=1,t.back=-1,Do},"inflateResetKeep"),oS=s(e=>{if(Bo(e))return Yt;let t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,rS(e)},"inflateReset"),nS=s((e,t)=>{let r;if(Bo(e))return Yt;let o=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?Yt:(o.window!==null&&o.wbits!==t&&(o.window=null),o.wrap=r,o.wbits=t,oS(e))},"inflateReset2"),sS=s((e,t)=>{if(!e)return Yt;let r=new LI;e.state=r,r.strm=e,r.window=null,r.mode=Fc;let o=nS(e,t);return o!==Do&&(e.state=null),o},"inflateInit2"),UI=s(e=>sS(e,BI),"inflateInit"),kw=!0,Ep,kp,OI=s(e=>{if(kw){Ep=new Int32Array(512),kp=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Ws(Zw,e.lens,0,288,Ep,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Ws(Yw,e.lens,0,32,kp,0,e.work,{bits:5}),kw=!1}e.lencode=Ep,e.lenbits=9,e.distcode=kp,e.distbits=5},"fixedtables"),aS=s((e,t,r,o)=>{let n,a=e.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),o>=a.wsize?(a.window.set(t.subarray(r-a.wsize,r),0),a.wnext=0,a.whave=a.wsize):(n=a.wsize-a.wnext,n>o&&(n=o),a.window.set(t.subarray(r-o,r-o+n),a.wnext),o-=n,o?(a.window.set(t.subarray(r-o,r),0),a.wnext=o,a.whave=a.wsize):(a.wnext+=n,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=n))),0},"updatewindow"),MI=s((e,t)=>{let r,o,n,a,c,p,m,d,f,h,w,y,S,T,b=0,A,k,C,I,L,Q,R,H,q=new Uint8Array(4),E,F,z=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Bo(e)||!e.output||!e.input&&e.avail_in!==0)return Yt;r=e.state,r.mode===qr&&(r.mode=Tp),c=e.next_out,n=e.output,m=e.avail_out,a=e.next_in,o=e.input,p=e.avail_in,d=r.hold,f=r.bits,h=p,w=m,H=Do;e:for(;;)switch(r.mode){case Fc:if(r.wrap===0){r.mode=Tp;break}for(;f<16;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}if(r.wrap&2&&d===35615){r.wbits===0&&(r.wbits=15),r.check=0,q[0]=d&255,q[1]=d>>>8&255,r.check=it(r.check,q,2,0),d=0,f=0,r.mode=ow;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((d&255)<<8)+(d>>8))%31){e.msg="incorrect header check",r.mode=Ne;break}if((d&15)!==rw){e.msg="unknown compression method",r.mode=Ne;break}if(d>>>=4,f-=4,R=(d&15)+8,r.wbits===0&&(r.wbits=R),R>15||R>r.wbits){e.msg="invalid window size",r.mode=Ne;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=d&512?pw:qr,d=0,f=0;break;case ow:for(;f<16;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}if(r.flags=d,(r.flags&255)!==rw){e.msg="unknown compression method",r.mode=Ne;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=Ne;break}r.head&&(r.head.text=d>>8&1),r.flags&512&&r.wrap&4&&(q[0]=d&255,q[1]=d>>>8&255,r.check=it(r.check,q,2,0)),d=0,f=0,r.mode=nw;case nw:for(;f<32;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}r.head&&(r.head.time=d),r.flags&512&&r.wrap&4&&(q[0]=d&255,q[1]=d>>>8&255,q[2]=d>>>16&255,q[3]=d>>>24&255,r.check=it(r.check,q,4,0)),d=0,f=0,r.mode=sw;case sw:for(;f<16;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}r.head&&(r.head.xflags=d&255,r.head.os=d>>8),r.flags&512&&r.wrap&4&&(q[0]=d&255,q[1]=d>>>8&255,r.check=it(r.check,q,2,0)),d=0,f=0,r.mode=aw;case aw:if(r.flags&1024){for(;f<16;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}r.length=d,r.head&&(r.head.extra_len=d),r.flags&512&&r.wrap&4&&(q[0]=d&255,q[1]=d>>>8&255,r.check=it(r.check,q,2,0)),d=0,f=0}else r.head&&(r.head.extra=null);r.mode=iw;case iw:if(r.flags&1024&&(y=r.length,y>p&&(y=p),y&&(r.head&&(R=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(o.subarray(a,a+y),R)),r.flags&512&&r.wrap&4&&(r.check=it(r.check,o,y,a)),p-=y,a+=y,r.length-=y),r.length))break e;r.length=0,r.mode=cw;case cw:if(r.flags&2048){if(p===0)break e;y=0;do R=o[a+y++],r.head&&R&&r.length<65536&&(r.head.name+=String.fromCharCode(R));while(R&&y<p);if(r.flags&512&&r.wrap&4&&(r.check=it(r.check,o,y,a)),p-=y,a+=y,R)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=uw;case uw:if(r.flags&4096){if(p===0)break e;y=0;do R=o[a+y++],r.head&&R&&r.length<65536&&(r.head.comment+=String.fromCharCode(R));while(R&&y<p);if(r.flags&512&&r.wrap&4&&(r.check=it(r.check,o,y,a)),p-=y,a+=y,R)break e}else r.head&&(r.head.comment=null);r.mode=lw;case lw:if(r.flags&512){for(;f<16;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}if(r.wrap&4&&d!==(r.check&65535)){e.msg="header crc mismatch",r.mode=Ne;break}d=0,f=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=qr;break;case pw:for(;f<32;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}e.adler=r.check=Ew(d),d=0,f=0,r.mode=Cc;case Cc:if(r.havedict===0)return e.next_out=c,e.avail_out=m,e.next_in=a,e.avail_in=p,r.hold=d,r.bits=f,vI;e.adler=r.check=1,r.mode=qr;case qr:if(t===II||t===bc)break e;case Tp:if(r.last){d>>>=f&7,f-=f&7,r.mode=xp;break}for(;f<3;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}switch(r.last=d&1,d>>>=1,f-=1,d&3){case 0:r.mode=dw;break;case 1:if(OI(r),r.mode=Tc,t===bc){d>>>=2,f-=2;break e}break;case 2:r.mode=fw;break;case 3:e.msg="invalid block type",r.mode=Ne}d>>>=2,f-=2;break;case dw:for(d>>>=f&7,f-=f&7;f<32;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}if((d&65535)!==(d>>>16^65535)){e.msg="invalid stored block lengths",r.mode=Ne;break}if(r.length=d&65535,d=0,f=0,r.mode=Ap,t===bc)break e;case Ap:r.mode=mw;case mw:if(y=r.length,y){if(y>p&&(y=p),y>m&&(y=m),y===0)break e;n.set(o.subarray(a,a+y),c),p-=y,a+=y,m-=y,c+=y,r.length-=y;break}r.mode=qr;break;case fw:for(;f<14;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}if(r.nlen=(d&31)+257,d>>>=5,f-=5,r.ndist=(d&31)+1,d>>>=5,f-=5,r.ncode=(d&15)+4,d>>>=4,f-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=Ne;break}r.have=0,r.mode=gw;case gw:for(;r.have<r.ncode;){for(;f<3;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}r.lens[z[r.have++]]=d&7,d>>>=3,f-=3}for(;r.have<19;)r.lens[z[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,E={bits:r.lenbits},H=Ws(_I,r.lens,0,19,r.lencode,0,r.work,E),r.lenbits=E.bits,H){e.msg="invalid code lengths set",r.mode=Ne;break}r.have=0,r.mode=hw;case hw:for(;r.have<r.nlen+r.ndist;){for(;b=r.lencode[d&(1<<r.lenbits)-1],A=b>>>24,k=b>>>16&255,C=b&65535,!(A<=f);){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}if(C<16)d>>>=A,f-=A,r.lens[r.have++]=C;else{if(C===16){for(F=A+2;f<F;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}if(d>>>=A,f-=A,r.have===0){e.msg="invalid bit length repeat",r.mode=Ne;break}R=r.lens[r.have-1],y=3+(d&3),d>>>=2,f-=2}else if(C===17){for(F=A+3;f<F;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}d>>>=A,f-=A,R=0,y=3+(d&7),d>>>=3,f-=3}else{for(F=A+7;f<F;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}d>>>=A,f-=A,R=0,y=11+(d&127),d>>>=7,f-=7}if(r.have+y>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=Ne;break}for(;y--;)r.lens[r.have++]=R}}if(r.mode===Ne)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=Ne;break}if(r.lenbits=9,E={bits:r.lenbits},H=Ws(Zw,r.lens,0,r.nlen,r.lencode,0,r.work,E),r.lenbits=E.bits,H){e.msg="invalid literal/lengths set",r.mode=Ne;break}if(r.distbits=6,r.distcode=r.distdyn,E={bits:r.distbits},H=Ws(Yw,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,E),r.distbits=E.bits,H){e.msg="invalid distances set",r.mode=Ne;break}if(r.mode=Tc,t===bc)break e;case Tc:r.mode=Ac;case Ac:if(p>=6&&m>=258){e.next_out=c,e.avail_out=m,e.next_in=a,e.avail_in=p,r.hold=d,r.bits=f,TI(e,w),c=e.next_out,n=e.output,m=e.avail_out,a=e.next_in,o=e.input,p=e.avail_in,d=r.hold,f=r.bits,r.mode===qr&&(r.back=-1);break}for(r.back=0;b=r.lencode[d&(1<<r.lenbits)-1],A=b>>>24,k=b>>>16&255,C=b&65535,!(A<=f);){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}if(k&&!(k&240)){for(I=A,L=k,Q=C;b=r.lencode[Q+((d&(1<<I+L)-1)>>I)],A=b>>>24,k=b>>>16&255,C=b&65535,!(I+A<=f);){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}d>>>=I,f-=I,r.back+=I}if(d>>>=A,f-=A,r.back+=A,r.length=C,k===0){r.mode=Tw;break}if(k&32){r.back=-1,r.mode=qr;break}if(k&64){e.msg="invalid literal/length code",r.mode=Ne;break}r.extra=k&15,r.mode=yw;case yw:if(r.extra){for(F=r.extra;f<F;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}r.length+=d&(1<<r.extra)-1,d>>>=r.extra,f-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=ww;case ww:for(;b=r.distcode[d&(1<<r.distbits)-1],A=b>>>24,k=b>>>16&255,C=b&65535,!(A<=f);){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}if(!(k&240)){for(I=A,L=k,Q=C;b=r.distcode[Q+((d&(1<<I+L)-1)>>I)],A=b>>>24,k=b>>>16&255,C=b&65535,!(I+A<=f);){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}d>>>=I,f-=I,r.back+=I}if(d>>>=A,f-=A,r.back+=A,k&64){e.msg="invalid distance code",r.mode=Ne;break}r.offset=C,r.extra=k&15,r.mode=Sw;case Sw:if(r.extra){for(F=r.extra;f<F;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}r.offset+=d&(1<<r.extra)-1,d>>>=r.extra,f-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=Ne;break}r.mode=bw;case bw:if(m===0)break e;if(y=w-m,r.offset>y){if(y=r.offset-y,y>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=Ne;break}y>r.wnext?(y-=r.wnext,S=r.wsize-y):S=r.wnext-y,y>r.length&&(y=r.length),T=r.window}else T=n,S=c-r.offset,y=r.length;y>m&&(y=m),m-=y,r.length-=y;do n[c++]=T[S++];while(--y);r.length===0&&(r.mode=Ac);break;case Tw:if(m===0)break e;n[c++]=r.length,m--,r.mode=Ac;break;case xp:if(r.wrap){for(;f<32;){if(p===0)break e;p--,d|=o[a++]<<f,f+=8}if(w-=m,e.total_out+=w,r.total+=w,r.wrap&4&&w&&(e.adler=r.check=r.flags?it(r.check,n,w,c-w):ea(r.check,n,w,c-w)),w=m,r.wrap&4&&(r.flags?d:Ew(d))!==r.check){e.msg="incorrect data check",r.mode=Ne;break}d=0,f=0}r.mode=Aw;case Aw:if(r.wrap&&r.flags){for(;f<32;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}if(r.wrap&4&&d!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=Ne;break}d=0,f=0}r.mode=xw;case xw:H=FI;break e;case Ne:H=Xw;break e;case eS:return Jw;case tS:default:return Yt}return e.next_out=c,e.avail_out=m,e.next_in=a,e.avail_in=p,r.hold=d,r.bits=f,(r.wsize||w!==e.avail_out&&r.mode<Ne&&(r.mode<xp||t!==tw))&&aS(e,e.output,e.next_out,w-e.avail_out),h-=e.avail_in,w-=e.avail_out,e.total_in+=h,e.total_out+=w,r.total+=w,r.wrap&4&&w&&(e.adler=r.check=r.flags?it(r.check,n,w,e.next_out-w):ea(r.check,n,w,e.next_out-w)),e.data_type=r.bits+(r.last?64:0)+(r.mode===qr?128:0)+(r.mode===Tc||r.mode===Ap?256:0),(h===0&&w===0||t===tw)&&H===Do&&(H=PI),H},"inflate$2"),QI=s(e=>{if(Bo(e))return Yt;let t=e.state;return t.window&&(t.window=null),e.state=null,Do},"inflateEnd"),qI=s((e,t)=>{if(Bo(e))return Yt;let r=e.state;return r.wrap&2?(r.head=t,t.done=!1,Do):Yt},"inflateGetHeader"),zI=s((e,t)=>{let r=t.length,o,n,a;return Bo(e)||(o=e.state,o.wrap!==0&&o.mode!==Cc)?Yt:o.mode===Cc&&(n=1,n=ea(n,t,r,0),n!==o.check)?Xw:(a=aS(e,t,r,r),a?(o.mode=eS,Jw):(o.havedict=1,Do))},"inflateSetDictionary"),GI=oS,KI=nS,VI=rS,jI=UI,HI=sS,$I=MI,WI=QI,ZI=qI,YI=zI,XI="pako inflate (from Nodeca project)",Gr={inflateReset:GI,inflateReset2:KI,inflateResetKeep:VI,inflateInit:jI,inflateInit2:HI,inflate:$I,inflateEnd:WI,inflateGetHeader:ZI,inflateSetDictionary:YI,inflateInfo:XI};function JI(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}s(JI,"GZheader");var eF=JI,iS=Object.prototype.toString,{Z_NO_FLUSH:tF,Z_FINISH:rF,Z_OK:oa,Z_STREAM_END:Cp,Z_NEED_DICT:_p,Z_STREAM_ERROR:oF,Z_DATA_ERROR:Cw,Z_MEM_ERROR:nF}=No;function ia(e){this.options=Ic.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});let t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new $w,this.strm.avail_out=0;let r=Gr.inflateInit2(this.strm,t.windowBits);if(r!==oa)throw new Error(Po[r]);if(this.header=new eF,Gr.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=ra.string2buf(t.dictionary):iS.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=Gr.inflateSetDictionary(this.strm,t.dictionary),r!==oa)))throw new Error(Po[r])}s(ia,"Inflate$1");ia.prototype.push=function(e,t){let r=this.strm,o=this.options.chunkSize,n=this.options.dictionary,a,c,p;if(this.ended)return!1;for(t===~~t?c=t:c=t===!0?rF:tF,iS.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(o),r.next_out=0,r.avail_out=o),a=Gr.inflate(r,c),a===_p&&n&&(a=Gr.inflateSetDictionary(r,n),a===oa?a=Gr.inflate(r,c):a===Cw&&(a=_p));r.avail_in>0&&a===Cp&&r.state.wrap>0&&e[r.next_in]!==0;)Gr.inflateReset(r),a=Gr.inflate(r,c);switch(a){case oF:case Cw:case _p:case nF:return this.onEnd(a),this.ended=!0,!1}if(p=r.avail_out,r.next_out&&(r.avail_out===0||a===Cp))if(this.options.to==="string"){let m=ra.utf8border(r.output,r.next_out),d=r.next_out-m,f=ra.buf2string(r.output,m);r.next_out=d,r.avail_out=o-d,d&&r.output.set(r.output.subarray(m,m+d),0),this.onData(f)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(a===oa&&p===0)){if(a===Cp)return a=Gr.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};ia.prototype.onData=function(e){this.chunks.push(e)};ia.prototype.onEnd=function(e){e===oa&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Ic.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Gp(e,t){let r=new ia(t);if(r.push(e),r.err)throw r.msg||Po[r.err];return r.result}s(Gp,"inflate$1");function sF(e,t){return t=t||{},t.raw=!0,Gp(e,t)}s(sF,"inflateRaw$1");var aF=ia,iF=Gp,cF=sF,uF=Gp,lF=No,pF={Inflate:aF,inflate:iF,inflateRaw:cF,ungzip:uF,constants:lF},{Deflate:dF,deflate:mF,deflateRaw:fF,gzip:gF}=SI,{Inflate:hF,inflate:yF,inflateRaw:wF,ungzip:SF}=pF,bF=dF,TF=mF,AF=fF,xF=gF,EF=hF,kF=yF,CF=wF,_F=SF,IF=No,Kp={Deflate:bF,deflate:TF,deflateRaw:AF,gzip:xF,Inflate:EF,inflate:kF,inflateRaw:CF,ungzip:_F,constants:IF};u();l();var vc=class{static{s(this,"StreamedQuoteQueue")}maxSize=5;items=[];enqueue(t,r,o){let n=this.processQuoteResponse(t,r,o?.join(","));this.items.push(n),this.items.length>this.maxSize&&this.items.shift()}getItems(){return[...this.items]}size(){return this.items.length}clear(){this.items=[]}processQuoteResponse(t,r,o){return{quotes:t.quotes.map(a=>({amountIn:a.sellAmount,amountOut:a.buyAmount,tokenIn:M(t.sellToken),tokenOut:M(t.buyToken),provider:a.baseProvider.name})),timestamp:Date.now(),selectedProvider:r,alerts:o}}};var FF="Sq+",Vp=class{static{s(this,"StreamedQuoteLogger")}queue=new vc;addQuoteResponse(t,r,o){this.queue.enqueue(t,r,o)}reset(){this.queue.clear()}getQuotes(){return this.queue.getItems()}logState(t){let r=this.getStateData(t);P.addBreadcrumb(O.Generic,`${FF}${r}`,Y.Info)}processQuoteProcessorState(t){switch(t.type){case"starting":this.reset();break;case"quoteProcessed":this.addQuoteResponse(t.response,t.input.preferredProvider,[...t.quoteDetails.alerts,...t.quoteDetails.warnings].map(r=>r.toString()));break;default:break}}getStateData(t){let r=this.queue.getItems(),o=this.compactData(r,t),n=Kp.gzip(JSON.stringify(o));return Buffer.from(n).toString("base64")}compactData(t,r){return t.length===0?null:{items:t.map(o=>({q:o.quotes.map(n=>({i:n.amountIn,o:n.amountOut,p:n.provider,ti:n.tokenIn,to:n.tokenOut})),t:o.timestamp,sp:o.selectedProvider,a:o.alerts})),th:r}}expandData(t){return t.items.map(r=>({quotes:r.q.map(o=>({amountIn:o.i,amountOut:o.o,tokenIn:o.ti,tokenOut:o.to,provider:o.p})),timestamp:r.t,selectedProvider:r.sp,alerts:r.a}))}decode(t){try{let r=Buffer.from(t,"base64"),o=Kp.inflate(r,{to:"string"}),n=JSON.parse(o);return n?{items:this.expandData(n),txnHash:n.th}:{items:[]}}catch(r){return console.error("Failed to decode compressed data:",r),{items:[]}}}},mo=new Vp;u();l();u();l();var $;(function(e){e.AccountFrozen="AccountFrozen",e.NoCurrentQuoteError="Trying to execute swap with no current quote",e.NoQuoteResponseError="Trying to execute swap with no quote response",e.NoGasEstimation="No gas estimation available",e.NoSwapTransactions="No swap transactions available",e.InsufficientFunds="INSUFFICIENT_FUNDS",e.InsufficientGas="INSUFFICIENT_GAS",e.SlippageExceeded="slippageToleranceExceeded",e.SimulationTimeout="SIMULATION_TIMEOUT",e.NotValidScanResultsError="Scan results are not valid",e.StaleQuote="STALE_QUOTE",e.NotEnoughSol="NotEnoughSol",e.TransactionConfirmationFailed="Transaction confirmation failed",e.SimulationUnknownError="SimulationUnknownError",e.UnknownError="UnknownError",e.MissingArgument="MissingArgument",e.EmptyRoute="EmptyRoute",e.InvalidCalculation="InvalidCalculation",e.MissingPlatformFeeAccount="MissingPlatformFeeAccount",e.InvalidSlippage="InvalidSlippage",e.NotEnoughPercent="NotEnoughPercent",e.InvalidInputIndex="InvalidInputIndex",e.InvalidOutputIndex="InvalidOutputIndex",e.NotEnoughAccountKeys="NotEnoughAccountKeys",e.NonZeroMinimumOutAmountNotSupported="NonZeroMinimumOutAmountNotSupported",e.InvalidRoutePlan="InvalidRoutePlan",e.InvalidReferralAuthority="InvalidReferralAuthority",e.LedgerTokenAccountDoesNotMatch="LedgerTokenAccountDoesNotMatch",e.InvalidTokenLedger="InvalidTokenLedger",e.IncorrectTokenProgramID="IncorrectTokenProgramID",e.TokenProgramNotProvided="TokenProgramNotProvided",e.SwapNotSupported="SwapNotSupported",e.ExactOutAmountNotMatched="ExactOutAmountNotMatched",e.SourceAndDstinationMintCannotBeTheSame="SourceAndDstinationMintCannotBeTheSame",e.LedgerConnectionError="LedgerConnectionError",e.LedgerRejectAction="LedgerRejectAction",e.LedgerUnknownSignError="LedgerUnknownSignError",e.LedgerUnknownError="LedgerUnknownError"})($||($={}));var Xe=class extends Error{static{s(this,"SwapperError")}code;detailMessage;constructor(t,r){super(t),this.code=t,this.detailMessage=r}};var vF=$.SlippageExceeded,PF=$.InsufficientFunds,RF=Sf,DF="insufficient lamports",NF="lower balance than rent-exempt minimum",BF=wf,LF="Transaction confirmation failed",UF=["Ledger App not open","Ledger not connected","Unable to connect to Ledger","Unable to connect to Ledger device","Need permission to connect to Ledger"],OF="Ledger user rejected action",MF="Ledger Sign Error";function QF(e){try{return Number(e.split('"Custom":')[1].split("}")[0])}catch{return null}}s(QF,"parseProgramErrorCode");function qF(e){switch(QF(e.message)){case 301:return $.SlippageExceeded;case 6e3:return $.EmptyRoute;case 6001:return $.SlippageExceeded;case 6002:return $.InvalidCalculation;case 6003:return $.MissingPlatformFeeAccount;case 6004:return $.InvalidSlippage;case 6005:return $.NotEnoughPercent;case 6006:return $.InvalidInputIndex;case 6007:return $.InvalidOutputIndex;case 6008:return $.NotEnoughAccountKeys;case 6009:return $.NonZeroMinimumOutAmountNotSupported;case 6010:return $.InvalidRoutePlan;case 6011:return $.InvalidReferralAuthority;case 6012:return $.LedgerTokenAccountDoesNotMatch;case 6013:return $.InvalidTokenLedger;case 6014:return $.IncorrectTokenProgramID;case 6015:return $.TokenProgramNotProvided;case 6016:return $.SwapNotSupported;case 6017:return $.ExactOutAmountNotMatched;case 6018:return $.SourceAndDstinationMintCannotBeTheSame;default:return null}}s(qF,"parseProgramError");function zF(e){return UF.some(r=>e.message.includes(r))?$.LedgerConnectionError:e.message.includes(OF)?$.LedgerRejectAction:e.message.includes(MF)?$.LedgerUnknownSignError:e.message.toLowerCase().includes("ledger")?$.LedgerUnknownError:null}s(zF,"parseLedgerError");function Pc(e){if(e===void 0)return new Xe($.UnknownError,"No error provided");if(e instanceof Xe)return e;let t=GF(e);if(t.message.includes(PF))return new Xe($.InsufficientFunds);if(KF(t.message))return new Xe($.SlippageExceeded);if(t.message===$.NotValidScanResultsError)return new Xe($.NotValidScanResultsError);if([RF,DF,BF,NF].some(m=>t.message.includes(m)))return new Xe($.NotEnoughSol);let a=qF(t);if(a!==null)return new Xe(a);if(t.message.includes(LF))return new Xe($.TransactionConfirmationFailed);let p=zF(t);return p!==null?new Xe(p):new Xe($.UnknownError,t.message)}s(Pc,"parseSwapError");function GF(e){return typeof e=="string"?new Error(e):typeof e=="object"&&"logs"in e&&e.logs?.length?new Error(e.logs.join(`
`)):e}s(GF,"normalizeError");function KF(e){return e.includes(vF)}s(KF,"errorMessageFailsFromSlippage");u();l();u();l();var cS=3;function Rc(){try{let e=$t.getMultivariateAssignment("swapper-high-slippage-threshold"),t=Number(e);return!e||isNaN(t)?cS:t}catch{return cS}}s(Rc,"getHighSlippageThreshold");var uS=s(({currentQuote:e,quoteResponse:t,gasEstimation:r,swapTransactions:o,scanResults:n,isSwapSimulationDisabled:a,slippageTolerance:c})=>{if(!e)throw new Xe($.NoCurrentQuoteError);if(!t)throw new Xe($.NoQuoteResponseError);if(x.isEVMNetworkID(t.sellToken.chainId)&&(!r||r?.length===0||r?.length<(o?.transactions.length??1)))throw new Xe($.NoGasEstimation);if(!o)throw new Xe($.NoSwapTransactions);if(n.state!=="valid"&&(P.addBreadcrumb(O.Swapper,"swapSimulationNotValid",Y.Info,Yo({scanResults:n.state})),!a)){let m=[$.NotValidScanResultsError,$.AccountFrozen,$.InsufficientFunds,$.InsufficientGas,$.SlippageExceeded,$.SimulationTimeout,$.MissingArgument,$.StaleQuote,$.SimulationUnknownError];if(jF(n.state)&&m.includes(n.state.code)){if(VF(n.state,c))return;throw n.state}else throw new Xe($.NotValidScanResultsError)}},"validateSwap");function VF(e,t){return e.code===$.SlippageExceeded&&t&&t>=Rc()}s(VF,"shouldSuppressError");function jF(e){return e instanceof Xe}s(jF,"isSwapperError");var HF={swap:{solana:"executeSolanaSwap",evm:"executeEvmSwap",sui:"executeSuiSwap",bitcoin:"executeBitcoinSwap"},bridge:{solana:"executeSolanaBridge",evm:"executeEvmBridge",sui:"executeSuiBridge",bitcoin:"executeBitcoinBridge"}},jp=s((e,t)=>HF[e?"bridge":"swap"][t??"solana"],"getExecuteSwapSpanName"),lH=s(async({isBridge:e,addressType:t,isSwapSimulationDisabled:r,sender:o,currentQuote:n,quoteResponse:a,gasEstimation:c,swapTransactions:p,scanResults:m,pendingActivityRows:d,connection:f,logSwapFailureNoSignature:h,logTransactionSubmitted:w,onTransactionReceiptReceived:y,onTransactionSubmissionError:S,resetToInitialState:T,slippageTolerance:b,swapFungibles:A})=>{await P.startSpan(jp(e,p?.type),async()=>{T();let k;try{uS({currentQuote:n,quoteResponse:a,gasEstimation:c,swapTransactions:p,scanResults:m,isSwapSimulationDisabled:r,slippageTolerance:b});let C=await A({type:t,callerAddress:o,swapTransactions:p,pendingSwapActivityRows:d.pendingSwapActivityRows,pendingApprovalActivityRows:d.pendingApprovalActivityRows,gasEstimation:c,connection:f});if(y(C),C.error)throw C.id||h(),k=C.id,C.error;w(C),mo.logState(C.id)}catch(C){let I=Pc(C);S(I,k)}})},"executeSwap");u();l();var lt;(function(e){e.SetPair="setPair",e.QuoteRequestStarted="quoteRequestStarted",e.QuoteResponseReceived="quoteResponseReceived",e.QuoteResponseStreamed="quoteResponseStreamed",e.QuoteRequestError="quoteRequestError",e.UserSelectedQuote="userSelectedQuote"})(lt||(lt={}));u();l();u();l();var be;(function(e){e.SlippageExceeded="SLIPPAGE_EXCEEDED",e.InsufficientFunds="INSUFFICIENT_FUNDS",e.InsufficientGas="INSUFFICIENT_GAS",e.AccountFrozen="ACCOUNT_FROZEN",e.SimulationTimeout="SIMULATION_TIMEOUT",e.StaleQuote="STALE_QUOTE",e.UnknownError="UNKNOWN_ERROR",e.SimulationFailed="SIMULATION_FAILED"})(be||(be={}));var Dn=class e extends Error{static{s(this,"SimulationError")}scannedTransactionResult;type;detailMessage;constructor(t,r,o){super(t),this.scannedTransactionResult=r,this.type=o,r&&(this.detailMessage=r.simulationError?.humanReadableError??(r.warnings.length>0?r.warnings[0].message:void 0)),this.type=o}static fromError(t){return t instanceof e?t:new e(t.message)}static fromScannedTransactionResult(t,r){return s(n=>Object.values(be).includes(n),"isSimulationErrorType")(t)?new e(t,r,t):new e(t,r)}};u();l();var Nn=class e extends Error{static{s(this,"SubmissionError")}type;constructor(t,r){super(t),this.type=r}static fromError(t){return new e(t.message)}static fromType(t){return new e(t,t)}};var lS="https://phantom.com",Dc=class{static{s(this,"EventfulSwapCommand")}swapCommand;send;executingQuote;takerAddress;networkId;quote;executionId;constructor(t,r,o){this.swapCommand=t,this.send=r,this.executingQuote=o,this.takerAddress=t.takerAddress,this.networkId=t.networkId,this.quote=t.quote,this.executionId=t.executionId}createTransaction(){return this.send({type:j.ExecuteSwapStarted,executionId:this.executionId,executingQuote:this.executingQuote}),this.swapCommand.createTransaction()}async fetchSimulation(t){let{transactions:r,deviceId:o,isSimulationKilled:n}=t,a=wr(v.language)??"en";if(x.isSuiNetworkID(this.networkId))return{type:"transaction",expectedChanges:[],warnings:[],advancedDetails:void 0,error:void 0,simulationError:void 0,block:void 0};if(x.isBitcoinNetworkID(this.networkId))return{type:"transaction",expectedChanges:[],warnings:[],advancedDetails:void 0,error:void 0,simulationError:void 0,block:void 0};let c=await An({transactions:r,locale:a,url:lS,deviceId:o,takerAddress:this.takerAddress,networkId:this.networkId,slippageType:this.executingQuote.slippageType,quote:this.quote,quoteResponse:this.executingQuote.response,isSimulationKilled:n});return c.status==="success"?c.result:null}async simulate(t,r,o,n){try{this.send({type:j.SimulationRequestStarted,executionId:this.executionId,executingQuote:this.executingQuote,networkId:this.networkId});let a=await this.fetchSimulation({transactions:t,deviceId:o,isSimulationKilled:n});if(!a)return this.send({type:j.SimulationSkipped,executionId:this.executionId,networkId:this.networkId}),null;switch(a.error){case void 0:break;case be.SimulationFailed:break;case be.SlippageExceeded:if(this.executingQuote.response.slippageTolerance>=Rc())break;default:throw Dn.fromScannedTransactionResult(a.error,a)}return this.send({type:j.SimulationPassed,scannedTransactionResult:a,executionId:this.executionId,networkId:this.networkId}),a}catch(a){throw this.send({type:j.SimulationFailed,error:Dn.fromError(a),executionId:this.executionId,networkId:this.networkId,url:lS}),a}}async swap(t,r,o,n,a){this.send({type:j.TransactionSubmissionStarted,executionId:this.executionId});try{let c=await this.swapCommand.swap(t,r,o,n,a);if(!c.id)throw Nn.fromType("noSignature");return this.send({type:j.TransactionSubmissionSuccess,txReceipt:c,executionId:this.executionId}),c}catch(c){let p=c instanceof Nn?c:Nn.fromError(c);throw this.send({type:j.TransactionSubmissionFailed,error:p,executionId:this.executionId}),p}}async waitForConfirmation(t){this.send({type:j.TransactionConfirmationStarted,executionId:this.executionId,txReceipt:t});try{let r=await this.swapCommand.waitForConfirmation(t);return this.send({type:j.TransactionConfirmed,executionId:this.executionId,txReceipt:t}),r}catch(r){throw this.send({type:j.TransactionConfirmationFailed,error:r,txReceipt:t,executionId:this.executionId}),r}}};u();l();var Nc=class extends Error{static{s(this,"ExecuteSwapIllegalTransitionError")}constructor(t,r){let n=(Array.isArray(r)?r:[r]).join(", ");super(`Can't transition to ${n} from ${t.type}`)}},Bc=class{static{s(this,"ExecuteSwapStateMachine")}state=new Map;listeners=new Set;send(t){t.type===j.ExecuteSwapStarted&&this.state.set(t.executionId,{type:Se.Idle,executingQuote:t.executingQuote});let r=this.state.get(t.executionId);if(!r)throw new Error(`No previous state found for execution id: ${t.executionId}`);let o=r;try{return o=this.detectNextState(r,t),o.type===Se.TransactionConfirmed?this.state.delete(t.executionId):this.state.set(t.executionId,o),o}catch{return r}finally{this.notifyListeners(t,r,o,this.state)}}notifyListeners(t,r,o,n){this.listeners.forEach(a=>{try{a.onStateChange(t,r,o,n)}catch(c){console.error("Error notifying ExecuteSwapStateListener:",c)}})}getState(){return this.state}addListener(t){this.listeners.add(t)}removeListener(t){this.listeners.delete(t)}detectNextState(t,r){switch(r.type){case j.ExecuteSwapStarted:return Ir(t,Se.Idle),{type:Se.Started,executingQuote:r.executingQuote};case j.SimulationRequestStarted:return Ir(t,Se.Started),{type:Se.Simulating,executingQuote:t.executingQuote};case j.SimulationPassed:return Ir(t,Se.Simulating),{type:Se.Simulated,scannedTransactionResult:r.scannedTransactionResult,executingQuote:t.executingQuote};case j.SimulationFailed:return Ir(t,Se.Simulating),{type:Se.SimulationFailed,error:r.error,executingQuote:t.executingQuote};case j.SimulationSkipped:return Ir(t,Se.Simulating),{type:Se.SimulationSkipped,executingQuote:t.executingQuote};case j.TransactionSubmissionStarted:return $F(t,[Se.Simulated,Se.SimulationSkipped]),{type:Se.SubmittingTransaction,executingQuote:t.executingQuote,scannedTransactionResult:t.type===Se.Simulated?t.scannedTransactionResult:void 0};case j.TransactionSubmissionFailed:return Ir(t,Se.SubmittingTransaction),{type:Se.TransactionSubmissionFailed,error:r.error,executingQuote:t.executingQuote,scannedTransactionResult:t.scannedTransactionResult};case j.TransactionSubmissionSuccess:return Ir(t,Se.SubmittingTransaction),{type:Se.TransactionSubmitted,txReceipt:r.txReceipt,executingQuote:t.executingQuote,scannedTransactionResult:t.scannedTransactionResult};case j.TransactionConfirmationStarted:return Ir(t,Se.TransactionSubmitted),{type:Se.ConfirmingTransaction,txReceipt:t.txReceipt,scannedTransactionResult:t.scannedTransactionResult,executingQuote:t.executingQuote};case j.TransactionConfirmationFailed:return Ir(t,Se.TransactionSubmitted),{type:Se.TransactionNotConfirmed,txReceipt:t.txReceipt,scannedTransactionResult:t.scannedTransactionResult,error:r.error,executingQuote:t.executingQuote};case j.TransactionConfirmed:return Ir(t,Se.ConfirmingTransaction),{type:Se.TransactionConfirmed,txReceipt:t.txReceipt,scannedTransactionResult:t.scannedTransactionResult,executingQuote:t.executingQuote}}}};function Ir(e,t){if(e.type!==t)throw new Nc(e,t)}s(Ir,"checkState");function $F(e,t){if(!t.includes(e.type))throw new Nc(e,t)}s($F,"checkStateAny");u();l();var Be;(function(e){e.Idle="idle",e.Pair="pair",e.FetchingQuote="fetchingQuote",e.QuoteError="quoteError",e.Quote="quote",e.ExecutingSwap="executingSwap",e.SwapConfirmed="swapConfirmed"})(Be||(Be={}));function pS(e){return e.type===Be.Quote}s(pS,"isExecutableSwapState");u();l();u();l();var WF={"Could not find any routes":"noRoute"},Lc=class e extends Error{static{s(this,"QuoteError")}type;constructor(t,r){super(r??t),this.type=t}static fromMessage(t){let r=t?WF[t]??"undefinedError":"undefinedError";return new e(r,t)}};var Lo=class extends Error{static{s(this,"SwapperIllegalTransitionError")}constructor(t,r){super(`Can't transition to ${r} from ${t.type}`)}},Uc=class{static{s(this,"SwapperStateMachine")}state;listeners=new Set;constructor(t){this.state=t??{type:Be.Idle}}send(t){let r=this.state;try{return r=this.detectNextState(this.state,t),this.state=r,r}catch{return this.state}finally{this.notifyListeners(t,this.state,r)}}getState(){return this.state}addListener(t){this.listeners.add(t)}removeListener(t){this.listeners.delete(t)}notifyListeners(t,r,o){try{this.listeners.forEach(n=>n.onStateChange(t,r,o))}catch{}}detectNextState(t,r){switch(r.type){case lt.SetPair:return{type:Be.Pair,buy:r.buy,sell:r.sell,amount:r.amount};case lt.QuoteRequestStarted:switch(t.type){case Be.Pair:case Be.Quote:case Be.QuoteError:return{type:Be.FetchingQuote,buy:t.buy,sell:t.sell,amount:r.amount,slippageType:r.slippageType};default:throw new Lo(t,r.type)}case lt.QuoteRequestError:if(t.type!==Be.FetchingQuote)throw new Lo(t,r.type);return{type:Be.QuoteError,buy:t.buy,sell:t.sell,amount:t.amount,error:r.error,slippageType:t.slippageType};case lt.QuoteResponseReceived:if(t.type!==Be.FetchingQuote)throw new Lo(t,r.type);let o=r.response.quotes[0];return o?{type:Be.Quote,response:r.response,buy:t.buy,sell:t.sell,quote:o,amount:t.amount,slippageType:t.slippageType}:{type:Be.QuoteError,buy:t.buy,sell:t.sell,amount:t.amount,error:new Lc("noRoute"),slippageType:t.slippageType};case lt.QuoteResponseStreamed:switch(t.type){case Be.Pair:case Be.FetchingQuote:case Be.Quote:case Be.QuoteError:return{type:Be.Quote,response:r.response,buy:t.buy,sell:t.sell,quote:r.quote,amount:{amount:r.quoteInput.amount,perspective:r.quoteInput.exactOut?"buy":"sell"},slippageType:r.quoteInput.autoSlippage?ce.Auto:ce.Fixed,input:r.quoteInput};default:throw new Lo(t,r.type)}case lt.UserSelectedQuote:if(t.type!==Be.Quote)throw new Lo(t,r.type);return{type:Be.Quote,quote:r.quote,buy:t.buy,sell:t.sell,response:t.response,amount:t.amount,slippageType:t.slippageType}}}};u();l();u();l();var dS=i.object({buyToken:i.custom(),sellToken:i.custom(),buyTokenPrice:i.custom().optional(),sellTokenPrice:i.custom().optional(),maxSellAmount:i.string().optional()}),ca=class e extends Error{static{s(this,"SwapInitializationError")}type;constructor(t,r){super(r??t.name),this.type=t}static fromError(t){return new e({name:"unknown"},t.message)}};function Hp(e,t){if(e.type!==t.type)return!1;switch(e.type){case"buy":return t.type!=="buy"?!1:e.buyCaip19===t.buyCaip19&&e.sellCaip19===t.sellCaip19&&e.takerCaip19===t.takerCaip19&&e.takerDestinationCaip19===t.takerDestinationCaip19&&e.options===t.options&&e.buyFungibleKey===t.buyFungibleKey;case"sell":return t.type!=="sell"?!1:e.sellCaip19===t.sellCaip19&&e.buyCaip19===t.buyCaip19&&e.takerCaip19===t.takerCaip19&&e.takerDestinationCaip19===t.takerDestinationCaip19&&e.options===t.options&&e.sellFungibleKey===t.sellFungibleKey;case"swap":return t.type!=="swap"?!1:e.network===t.network&&e.sellCaip19===t.sellCaip19&&e.buyCaip19===t.buyCaip19&&e.takerCaip19===t.takerCaip19&&e.takerDestinationCaip19===t.takerDestinationCaip19&&e.options===t.options;case"prediction":return t.type!=="prediction"?!1:e.network===t.network&&e.sellCaip19===t.sellCaip19&&e.marketTicker===t.marketTicker&&e.takerCaip19===t.takerCaip19&&e.takerDestinationCaip19===t.takerDestinationCaip19&&e.options===t.options;default:{let r=e;return!1}}}s(Hp,"isSwapModeEqual");var Bn=class{static{s(this,"BackendSwapInitializer")}async initialize(t,r,o,n){let a=r.reduce((d,f)=>(d[f.networkID]=f.address,d),{}),c=await K.api().headers({"Content-Type":"application/json"}).timeout(G({seconds:20})).post("/swap/v2/initialize",{...t,addresses:a,cashAddresses:nr?o:void 0,...n?{settings:n}:{}});if(c.status!==200)throw new Ge({key:"SwapInitializationFailed"});let p=dS.safeParse(c.data);if(!p.success)throw new Ge({key:"SwapInitializationFailed"});return{...p.data,takerCaip19:this.takerCaip19ForToken({token:p.data.sellToken,addresses:r}),takerDestinationCaip19:this.takerCaip19ForToken({token:p.data.buyToken,addresses:r})}}takerCaip19ForToken({token:t,addresses:r}){if(t.data.walletAddress&&oi(t))return M({chainId:t.data.chain.id,resourceType:ee.address,address:t.data.walletAddress});let o=this.findChainAddress({chain:t.data.chain,addresses:r});return M({chainId:o.networkID,resourceType:ee.address,address:o.address})}findChainAddress({chain:t,addresses:r}){let{id:o}=t,n=r.find(c=>c.networkID===o);if(!n)throw new Error(`No address found for chain ${o}`);let a={...n};return gr(a)&&(a.address=a.address.toLowerCase()),a}};u();l();var Ln=class{static{s(this,"BitcoinSwapInitializer")}proxyInitializer;constructor(t){this.proxyInitializer=t}async initialize(t,r,o,n){let a=this.getBitcoinAddressTypeForKey(t);if(!a)return this.proxyInitializer.initialize(t,r,o,n);let{key:c,addressType:p,direction:m}=a,d=ZF(r,w=>{if(!(Om(w)&&w.addressType!==p))return w}),f=r.find(w=>w.addressType===p);if(!f)return this.proxyInitializer.initialize(t,r,o,n);switch(m){case"buy":t.takerDestinationCaip19=M({chainId:f.networkID,resourceType:ee.address,address:f.address});break;case"sell":t.takerCaip19=M({chainId:f.networkID,resourceType:ee.address,address:f.address});break}let h=await this.proxyInitializer.initialize(t,d,o,n);switch(m){case"buy":h.buyToken.data.key=c;break;case"sell":h.sellToken.data.key=c;break}switch(m){case"buy":h.takerCaip19=this.takerCaip19ForToken({token:h.sellToken,addresses:d});break;case"sell":h.takerDestinationCaip19=this.takerCaip19ForToken({token:h.buyToken,addresses:d});break}return h}keyToAddressType={"BitcoinNative-bip122_p2wpkh":xe.BitcoinNativeSegwit,"BitcoinNative-bip122_p2tr":xe.BitcoinTaproot,BitcoinNative:xe.BitcoinTaproot};getBitcoinAddressTypeForKey(t){if(!(t.type!=="buy"&&t.type!=="sell"&&t.type!=="swap")){if(t.sellFungibleKey){let r=this.keyToAddressType[t.sellFungibleKey];if(r)return{key:t.sellFungibleKey,addressType:r,direction:"sell"}}if(t.buyFungibleKey){let r=this.keyToAddressType[t.buyFungibleKey];if(r)return{key:t.buyFungibleKey,addressType:r,direction:"buy"}}}}takerCaip19ForToken({token:t,addresses:r}){if(t.data.walletAddress)return M({chainId:t.data.chain.id,resourceType:ee.address,address:t.data.walletAddress});let o=this.findChainAddress({chain:t.data.chain,addresses:r});return M({chainId:o.networkID,resourceType:ee.address,address:o.address})}findChainAddress({chain:t,addresses:r}){let{id:o}=t,n=r.find(c=>c.networkID===o);if(!n)throw new Error(`No address found for chain ${o}`);let a={...n};return gr(a)&&(a.address=a.address.toLowerCase()),a}};function ZF(e,t){return e.reduce((r,o)=>{let n=t(o);return n!=null&&r.push(n),r},[])}s(ZF,"compactMap");u();l();function mS(e){if(e.type!=="pair")return;let{mode:t,buyToken:r,sellToken:o}=e;if(t.type!=="swap")throw new Error("Can't switch swap mode for: "+t.type);let n=M(X(e.buyToken)),a=M(X(e.sellToken)),c=e.takerDestinationCaip19,p=e.takerCaip19,m=r.data.key,d=o.data.key;return{type:"swap",network:n?We(n).chainId:x.solana.mainnetID,sellCaip19:n,buyCaip19:a,takerCaip19:c,takerDestinationCaip19:p,sellFungibleKey:m,buyFungibleKey:d}}s(mS,"switchSwapMode");u();l();u();l();u();l();u();l();u();l();u();l();var fS={id:x.solana.mainnetID,imageUrl:x.solana.iconUrl,name:x.solana.name,symbol:x.solana.tokenSymbol},gS={type:oe.SolanaNative,data:{amount:"0",balance:new U(0),chain:fS,decimals:9,key:"SolanaNative",logoUri:"https://cdn.jsdelivr.net/gh/solana-labs/token-list@main/assets/mainnet/So11111111111111111111111111111111111111112/logo.png",name:"Solana",symbol:"SOL",tokenAddress:void 0,walletAddress:"",spamStatus:ie.Verified}},hS={type:oe.SPL,data:{amount:"0",balance:new U(0),chain:fS,decimals:6,key:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",logoUri:"https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v/logo.png",mintAddress:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",name:"USD Coin",splTokenAccountPubkey:"EAF7dH8Jy43Xgp68PhyybKhfKxk46NFRkWN4PMCLqMfS",symbol:"USDC",tokenAddress:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",walletAddress:"",programId:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA",spamStatus:ie.Verified}},yS={type:oe.SuiNative,data:{chain:{id:x.sui.mainnetID,name:x.sui.name,symbol:x.sui.tokenSymbol,imageUrl:x.sui.iconUrl},walletAddress:"",decimals:18,amount:"0",logoUri:"https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/sui/info/logo.png",name:"Sui",symbol:"SUI",balance:new U(0),key:"SuiNative",usd:85.14215868842653,price:1858.01,usd_24h_change:.0009391170983548136,tokenAddress:void 0,spamStatus:ie.Verified}},wS={type:oe.SuiCoin,data:{chain:{id:x.sui.mainnetID,name:x.sui.name,symbol:x.sui.tokenSymbol,imageUrl:x.sui.iconUrl},walletAddress:"",contractAddress:"0xdba34672e30cb065b1f93e3ab55318768fd6fef66c15942c9f7cb846e2f900e7::usdc::USDC",decimals:6,amount:"0",logoUri:"https://assets.coingecko.com/coins/images/6319/large/USD_Coin_icon.png?1547042389",name:"USD Coin",symbol:"USDC",balance:new U(0),key:"0xdba34672e30cb065b1f93e3ab55318768fd6fef66c15942c9f7cb846e2f900e7::usdc::USDC",tokenAddress:"0xdba34672e30cb065b1f93e3ab55318768fd6fef66c15942c9f7cb846e2f900e7::usdc::USDC",usd:1.8807026139560001,price:.999793,usd_24h_change:-.0005475429199477411,spamStatus:ie.Verified}},SS={type:oe.PolygonNative,data:{chain:{id:x.polygon.mainnetID,name:x.polygon.name,symbol:x.polygon.tokenSymbol,imageUrl:x.polygon.iconUrl},walletAddress:"",decimals:18,amount:"72172806352057410682",logoUri:"https://wallet-asset.matic.network/img/tokens/matic.svg",name:"Polygon",symbol:x.polygon.tokenSymbol,balance:new U(0),key:"PolygonNative",usd:79.02922295550286,price:1.095,usd_24h_change:-.19903579005681138,tokenAddress:void 0,spamStatus:ie.Verified}},bS={type:oe.BaseNative,data:{chain:{id:x.base.mainnetID,name:x.base.name,symbol:x.base.tokenSymbol,imageUrl:x.base.iconUrl},walletAddress:"",decimals:18,amount:"72172806352057410682",logoUri:"https://cdn.jsdelivr.net/gh/trustwallet/assets@master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",name:"Base",symbol:x.base.tokenSymbol,balance:new U(0),key:"BaseNative",usd:79.02922295550286,price:1.095,usd_24h_change:-.19903579005681138,tokenAddress:void 0,spamStatus:ie.Verified}},TS={type:oe.ArbitrumNative,data:{chain:{id:x.arbitrum.mainnetID,name:x.arbitrum.name,symbol:x.arbitrum.tokenSymbol,imageUrl:x.arbitrum.iconUrl},walletAddress:"",decimals:18,amount:"72172806352057410682",logoUri:"https://cdn.jsdelivr.net/gh/trustwallet/assets@master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",name:"Ethereum",symbol:"ETH",balance:new U(0),key:"ArbitrumNative",usd:79.02922295550286,price:1.095,usd_24h_change:-.19903579005681138,tokenAddress:void 0,spamStatus:ie.Verified}},AS={type:oe.MonadNative,data:{chain:{id:x.monad.mainnetID,name:x.monad.name,symbol:x.monad.tokenSymbol,imageUrl:x.monad.iconUrl},walletAddress:"",decimals:18,amount:"0",logoUri:"https://static.phantom.app/assets/monad.png",name:"Monad",symbol:x.monad.tokenSymbol,balance:new U(0),key:"MonadNative",usd:0,price:0,usd_24h_change:0,tokenAddress:void 0,spamStatus:ie.Verified}},xS={type:oe.ERC20,data:{amount:"0",balance:new U(0),decimals:6,key:"0x3c499c542cef5e3811e1192ce70d8cc03d5c3359",logoUri:"https://wallet-asset.matic.network/img/tokens/usdc.svg",name:"USD Coin",symbol:"USDC",tokenAddress:"0x3c499c542cef5e3811e1192ce70d8cc03d5c3359",walletAddress:"",chain:{id:x.polygon.mainnetID,imageUrl:x.polygon.iconUrl,name:x.polygon.name,symbol:x.polygon.tokenSymbol},contractAddress:"0x3c499c542cef5e3811e1192ce70d8cc03d5c3359",spamStatus:ie.Verified}},ES={type:oe.ERC20,data:{amount:"0",balance:new U(0),decimals:6,key:"0x833589fcd6edb6e08f4c7c32d4f71b54bda02913",logoUri:"https://wallet-asset.matic.network/img/tokens/usdc.svg",name:"USD Coin",symbol:"USDC",tokenAddress:"0x833589fcd6edb6e08f4c7c32d4f71b54bda02913",walletAddress:"",chain:{id:x.base.mainnetID,imageUrl:x.base.iconUrl,name:x.base.name,symbol:x.base.tokenSymbol},contractAddress:"0x833589fcd6edb6e08f4c7c32d4f71b54bda02913",spamStatus:ie.Verified}},kS={type:oe.ERC20,data:{amount:"0",balance:new U(0),decimals:6,key:"0xaf88d065e77c8cC2239327C5EDb3A432268e5831",logoUri:"https://wallet-asset.matic.network/img/tokens/usdc.svg",name:"USD Coin",symbol:"USDC",tokenAddress:"0xaf88d065e77c8cC2239327C5EDb3A432268e5831",walletAddress:"",chain:{id:x.arbitrum.mainnetID,imageUrl:x.arbitrum.iconUrl,name:x.arbitrum.name,symbol:x.arbitrum.tokenSymbol},contractAddress:"0xaf88d065e77c8cC2239327C5EDb3A432268e5831",spamStatus:ie.Verified}},CS={type:oe.ERC20,data:{amount:"0",balance:new U(0),decimals:6,key:"0x0000000000000000000000000000000000000000",logoUri:"https://wallet-asset.matic.network/img/tokens/usdc.svg",name:"USD Coin",symbol:"USDC",tokenAddress:"0x0000000000000000000000000000000000000000",walletAddress:"",chain:{id:x.monad.mainnetID,imageUrl:x.monad.iconUrl,name:x.monad.name,symbol:x.monad.tokenSymbol},contractAddress:"0x0000000000000000000000000000000000000000",spamStatus:ie.Verified}},_S={type:oe.HyperevmNative,data:{chain:{id:x.hyperevm.mainnetID,name:x.hyperevm.name,symbol:x.hyperevm.tokenSymbol,imageUrl:x.hyperevm.iconUrl},walletAddress:"",decimals:18,amount:"0",logoUri:"",name:"Ethereum",symbol:"ETH",balance:new U(0),key:"HyperevmNative",usd:79.02922295550286,price:1.095,usd_24h_change:-.19903579005681138,tokenAddress:void 0,spamStatus:ie.Verified}},IS={type:oe.ERC20,data:{amount:"0",balance:new U(0),decimals:6,key:"0xb88339cb7199b77e23db6e890353e22632ba630f",logoUri:"https://wallet-asset.matic.network/img/tokens/usdc.svg",name:"USD Coin",symbol:"USDC",tokenAddress:"0xb88339cb7199b77e23db6e890353e22632ba630f",walletAddress:"",chain:{id:x.hyperevm.mainnetID,imageUrl:x.hyperevm.iconUrl,name:x.hyperevm.name,symbol:x.hyperevm.tokenSymbol},contractAddress:"0xb88339cb7199b77e23db6e890353e22632ba630f",spamStatus:ie.Verified}},FS={type:oe.EthereumNative,data:{chain:{id:x.ethereum.mainnetID,name:x.ethereum.name,symbol:x.ethereum.tokenSymbol,imageUrl:x.ethereum.iconUrl},walletAddress:"",decimals:18,amount:"45824381294194610",logoUri:"https://cdn.jsdelivr.net/gh/trustwallet/assets@master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",name:"Ethereum",symbol:"ETH",balance:new U(0),key:"EthereumNative",usd:85.14215868842653,price:1858.01,usd_24h_change:.0009391170983548136,tokenAddress:void 0,spamStatus:ie.Verified}},vS={type:oe.ERC20,data:{chain:{id:x.ethereum.mainnetID,name:x.ethereum.name,symbol:x.ethereum.tokenSymbol,imageUrl:x.ethereum.iconUrl},walletAddress:"",contractAddress:"0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",decimals:6,amount:"1881092",logoUri:"https://assets.coingecko.com/coins/images/6319/large/USD_Coin_icon.png?1547042389",name:"USD Coin",symbol:"USDC",balance:new U(0),key:"0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",tokenAddress:"0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",usd:1.8807026139560001,price:.999793,usd_24h_change:-.0005475429199477411,spamStatus:ie.Verified}};var O$="https://help.phantom.com/hc/en-us/articles/5985106844435",M$="https://help.phantom.com/hc/en-us/articles/29763090277139";var fo={amount:new U(0),amountUsd:null,pct:0};u();l();var Xt={};var PS={...Xt,bridgeMinimumUsdAmounts:0,swapDefaultFee:new U(15e-5*10**18),bridgeDefaultFee:new U(.025*10**18),averageNetworkFee:new U(15e-5*10**18),nativeFungible:TS,usdcFungible:kS};u();l();var RS={...Xt,bridgeMinimumUsdAmounts:0,swapDefaultFee:new U(15e-5*10**18),bridgeDefaultFee:new U(.025*10**18),averageNetworkFee:new U(15e-5*10**18),nativeFungible:bS,usdcFungible:ES};u();l();var DS={bridgeMinimumUsdAmounts:10,swapDefaultFee:new U(1e4),bridgeDefaultFee:new U(1e4),averageNetworkFee:new U(1e4),nativeFungible:{type:oe.BitcoinNative,data:{chain:{id:x.bitcoin.mainnetID,name:x.bitcoin.name,symbol:x.bitcoin.tokenSymbol,imageUrl:x.bitcoin.iconUrl},walletAddress:"",decimals:18,amount:"45824381294194610",logoUri:"https://cdn.jsdelivr.net/gh/trustwallet/assets@master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",name:"Bitcoin",symbol:"BTC",balance:new U(0),key:"BitcoinNative",usd:85.14215868842653,price:1858.01,usd_24h_change:.0009391170983548136,tokenAddress:void 0,spamStatus:ie.Verified}},usdcFungible:{type:oe.BitcoinNative,data:{chain:{id:x.bitcoin.mainnetID,name:x.bitcoin.name,symbol:x.bitcoin.tokenSymbol,imageUrl:x.bitcoin.iconUrl},walletAddress:"",decimals:18,amount:"45824381294194610",logoUri:"https://cdn.jsdelivr.net/gh/trustwallet/assets@master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",name:"Bitcoin",symbol:"BTC",balance:new U(0),key:"BitcoinNative",usd:85.14215868842653,price:1858.01,usd_24h_change:.0009391170983548136,tokenAddress:void 0,spamStatus:ie.Verified}}};u();l();var NS={...Xt,bridgeMinimumUsdAmounts:20,swapDefaultFee:new U(2.5*10**16),bridgeDefaultFee:new U(3.75*10**16),averageNetworkFee:new U(0),nativeFungible:FS,usdcFungible:vS};u();l();var BS={...Xt,bridgeMinimumUsdAmounts:0,swapDefaultFee:new U(15e-5*10**18),bridgeDefaultFee:new U(.025*10**18),averageNetworkFee:new U(15e-5*10**18),nativeFungible:_S,usdcFungible:IS};u();l();var LS={...Xt,bridgeMinimumUsdAmounts:0,swapDefaultFee:new U(.015*10**18),bridgeDefaultFee:new U(.025*10**18),averageNetworkFee:new U(.0021*10**18),nativeFungible:AS,usdcFungible:CS,requiredFeatureFlag:"enable-monad-swapper"};u();l();var US={...Xt,bridgeMinimumUsdAmounts:2,swapDefaultFee:new U(6*10**16),bridgeDefaultFee:new U(6*10**16),averageNetworkFee:new U(.0015*10**18),nativeFungible:SS,usdcFungible:xS};u();l();var OS={bridgeMinimumUsdAmounts:1,swapDefaultFee:new U(3*10**6),bridgeDefaultFee:new U(30*10**6),averageNetworkFee:new U(15e3),nativeFungible:gS,usdcFungible:hS};u();l();var MS={bridgeMinimumUsdAmounts:1,swapDefaultFee:new U(50*10**6),bridgeDefaultFee:new U(50*10**6),averageNetworkFee:new U(50*10**6),nativeFungible:yS,usdcFungible:wS};var t7=[se.Solana,se.Ethereum,se.Polygon,se.Monad,se.Base,se.Sui,se.Arbitrum,se.Hyperevm,se.Bitcoin],YF=new Zo({[se.Solana]:OS,[se.Ethereum]:NS,[se.Polygon]:US,[se.Monad]:LS,[se.Base]:RS,[se.Sui]:MS,[se.Arbitrum]:PS,[se.Hyperevm]:BS,[se.Bitcoin]:DS}),Jt=Wo(YF);var ua=s((e,t)=>{let r=[];if(XF(e)&&r.push({type:"permanentDelegate",level:"warn",titleKey:"swapAssetWarningPermanentDelegate",shortTitleKey:"swapAssetWarningPermanentDelegateShort",modalTitleKey:"swapAssetWarningPermanentDelegateModalTitle"}),(e.data.spamStatus===ie.NotVerified||e.data.spamStatus===ie.Spam||e.data.spamStatus===ie.PossibleSpam)&&r.push({type:"unverified",level:"info",titleKey:"swapAssetWarningUnverified",shortTitleKey:"swapAssetWarningUnverifiedShort",modalTitleKey:"swapAssetWarningUnverifiedModalTitle"}),!Mt(e.type)&&t&&JF(t)){let o=Jt.get(e.data.chain.id).nativeFungible;r.push({type:"lowBalance",level:"info",titleKey:"swapAssetWarningLowTokenBalance",shortTitleKey:"swapAssetWarningLowTokenBalanceShort",modalTitleKey:"swapAssetWarningLowTokenBalanceModalTitle",options:{token:o.data.symbol??"",network:o.data.chain.name}})}return r},"detectAssetWarnings");function XF(e){let t=e.data;return t?.mintExtensions?t.mintExtensions.some(r=>r.extension===Ya.permanentDelegate):!1}s(XF,"hasPermanentDelegateExtension");function JF(e){let t=Jt.get(e.data.chain.id);return new _(e.data.amount?e.data.amount:0).lt(t.swapDefaultFee)}s(JF,"isLowNativeTokenBalance");u();l();var ev=3,QS=new _(2039280),tv=new _(356190);function Oc(e,t){if(!Mt(e.type))return new _(e.data.balance);let{balance:r,decimals:o}=e.data,n=r?new _(r).multipliedBy(10**o):new _(0),a=rv(e,t);return(n.gt(a)?n.minus(a):n).dividedBy(10**o)}s(Oc,"getMaxSellAmountWithDefaults");function rv(e,t){let r=e.data.chain.id;if(x.isSolanaNetworkID(r))return ov(e,t);if(x.isEVMNetworkID(r))return nv(e,t);if(x.isSuiNetworkID(r))return sv(e,t);throw new Error("Chain not supported by swapper")}s(rv,"calculateFees");function ov(e,t){let{defaultSwapFee:r,networkFeeBuffer:o}=$p(e,t),n=r.plus(o),a=QS,c=!t||new _(t.data.balance).isZero()?QS:new _(0);return n.plus(a).plus(c)}s(ov,"calculateSolanaFees");function nv(e,t){let{networkFeeBuffer:r}=$p(e,t),o=av(e.data.chain.id),n=new _(o.maxFeePerGas),a=new _(o.maxPriorityFeePerGas);return tv.multipliedBy(n.plus(a)).plus(r)}s(nv,"calculateEVMFees");function sv(e,t){let{defaultSwapFee:r,networkFeeBuffer:o}=$p(e,t);return r.plus(o)}s(sv,"calculateSuiFees");function $p(e,t){let r=Wt(e.data.chain.id,t?.data.chain.id),o=Jt.get(e.data.chain.id),n=r?o.bridgeDefaultFee:o.swapDefaultFee,a=o.averageNetworkFee.multipliedBy(ev);return{defaultSwapFee:n,networkFeeBuffer:a}}s($p,"getCommonFeeComponents");function av(e){if(x.isEthereumNetworkID(e))return{maxFeePerGas:new _("5000000000"),maxPriorityFeePerGas:new _("79000000")};if(x.isPolygonNetworkID(e))return{maxFeePerGas:new _("30000000000"),maxPriorityFeePerGas:new _("30000000000")};if(x.isBaseNetworkID(e))return{maxFeePerGas:new _("25000000"),maxPriorityFeePerGas:new _("1100000")};if(x.isArbitrumNetworkID(e))return{maxFeePerGas:new _("29000000"),maxPriorityFeePerGas:new _("0")};throw new Error("Chain not supported by swapper")}s(av,"getEVMDefaultTransactionUnitCost");var Mc=class{static{s(this,"TokenStateMachine")}state={type:"idle"};eventListeners=[];send(t){let r=this.state,o=r;try{return o=this.detectNextState(t),this.state=o,o}catch{return r}finally{this.eventListeners.forEach(n=>n.onStateChange(t,r,o))}}detectNextState(t){switch(t.type){case"initializeStarted":return{type:"initializing",mode:t.mode};case"initializeCompleted":if(this.state.type==="initializing"||this.state.type==="refreshing"){let r=new _(t.result.maxSellAmount??t.result.sellToken.data.balance);return{type:"pair",mode:this.state.mode,sellToken:t.result.sellToken,buyToken:t.result.buyToken,sellTokenPrice:t.result.sellTokenPrice,buyTokenPrice:t.result.buyTokenPrice,warnings:ua(t.result.buyToken),maxSellAmount:r,takerCaip19:t.result.takerCaip19,takerDestinationCaip19:t.result.takerDestinationCaip19}}throw new Error("Invalid state");case"initializeFailed":if(this.state.type!=="initializing")throw new Error("Invalid state");return{type:"error",error:t.error};case"switchTokens":{if(this.state.type!=="pair")throw new Error("Invalid state");let r=this.state.buyToken,o=this.state.sellToken,n=this.state.buyTokenPrice,a=this.state.sellTokenPrice;return{type:"pair",mode:t.mode,sellToken:r,buyToken:o,sellTokenPrice:n,buyTokenPrice:a,maxSellAmount:Oc(r,o),warnings:ua(o),takerCaip19:this.state.takerDestinationCaip19,takerDestinationCaip19:this.state.takerCaip19}}case"changeToken":{if(this.state.type!=="pair")throw new Error("Invalid state");let r=t.perspective==="sell"?t.token:this.state.sellToken,o=t.perspective==="buy"?t.token:this.state.buyToken;return{type:"pair",mode:t.mode,sellToken:r,buyToken:o,sellTokenPrice:t.sellTokenPrice??this.state.buyTokenPrice,buyTokenPrice:t.buyTokenPrice??this.state.sellTokenPrice,maxSellAmount:Oc(r,o),warnings:ua(t.perspective==="buy"?t.token:this.state.buyToken),takerCaip19:this.state.takerCaip19,takerDestinationCaip19:this.state.takerDestinationCaip19}}case"updateBalances":{if(this.state.type!=="pair")throw new Error("Invalid state");if(M(X(this.state.sellToken))!==t.sellTokenCaip19)throw new Error("Invalid state");let r={...this.state.sellToken,data:{...this.state.sellToken.data,balance:t.sellTokenBalance}},o=this.state.buyToken;return{type:"pair",mode:this.state.mode,sellToken:r,buyToken:o,sellTokenPrice:this.state.sellTokenPrice,buyTokenPrice:this.state.buyTokenPrice,warnings:ua(o),maxSellAmount:Oc(r,o),takerCaip19:this.state.takerCaip19,takerDestinationCaip19:this.state.takerDestinationCaip19}}case"refreshing":if(this.state.type!=="pair")throw new Error("Invalid state");return{type:"refreshing",mode:this.state.mode,sellToken:this.state.sellToken,buyToken:this.state.buyToken,sellTokenPrice:this.state.sellTokenPrice,buyTokenPrice:this.state.buyTokenPrice,maxSellAmount:this.state.maxSellAmount,warnings:this.state.warnings,takerCaip19:this.state.takerCaip19,takerDestinationCaip19:this.state.takerDestinationCaip19}}}getState(){return this.state}subscribe(t){this.eventListeners.push(t)}unsubscribe(t){this.eventListeners=this.eventListeners.filter(r=>r!==t)}};var Qc=class{static{s(this,"Swapper")}apiClient;swapCommandFactory;quoteProcessor;stateMachine=new Uc;executeSwapStateMachine=new Bc;account;cashAccount;config={slippageType:ce.Auto,slippageTolerance:1.3,isSimulationKilled:!1};swapInitializer=new Ln(new Bn);tokenStateMachine=new Mc;accountChangeListeners=[];constructor(t,r,o,n){this.apiClient=t,this.swapCommandFactory=r,this.quoteProcessor=o,this.quoteProcessor.subscribe(this.quoteProcessorListener),this.tokenStateMachine.subscribe(this.tokenStateListener),n&&(this.account=n)}tokenStateListener={onStateChange:s((t,r,o)=>{o.type==="pair"&&(this.setPair(o.buyToken,o.sellToken,{amount:"0",perspective:"sell"}),t.type==="changeToken"&&this.refreshQuoteProcessor())},"onStateChange")};refreshPair({swapMode:t,cashAddresses:r,settings:o}){this.initializeSwap({swapMode:t,cashAddresses:r,settings:o,refresh:!0})}initializeSwap({swapMode:t,cashAddresses:r,settings:o,refresh:n=!1}){let a=this.checkAccount();this.getTokenState().type==="pair"&&n?this.tokenStateMachine.send({type:"refreshing"}):this.tokenStateMachine.send({type:"initializeStarted",mode:t}),this.swapInitializer.initialize(t,a.addresses,r,o).then(p=>{this.tokenStateMachine.send({type:"initializeCompleted",result:p})}).catch(p=>{P.captureError(p,O.Swapper),p instanceof ca?this.tokenStateMachine.send({type:"initializeFailed",error:p}):this.tokenStateMachine.send({type:"initializeFailed",error:ca.fromError(p)})})}updateBalances({sellTokenBalance:t,sellTokenCaip19:r}){this.getTokenState().type==="pair"&&this.tokenStateMachine.send({type:"updateBalances",sellTokenBalance:t,sellTokenCaip19:r})}getTokenState(){return this.tokenStateMachine.getState()}subscribeToken(t){return this.tokenStateMachine.subscribe(t),()=>this.unsubscribeToken(t)}unsubscribeToken(t){this.tokenStateMachine.unsubscribe(t)}quoteProcessorListener={onStateChange:s((t,r)=>{(r.type==="firstQuoteReceived"||r.type==="quoteProcessed")&&this.send({type:lt.QuoteResponseStreamed,response:r.response,quoteInput:r.input,quote:r.quote})},"onStateChange")};isValidAmount(t){try{let r=new _(t);return r.isFinite()?!r.isNegative():!1}catch{return!1}}setAmount(t,r){let o=this.getTokenState();if(!ct(o)){console.error(`Can't set amount from tokenState ${o.type}`);return}let{amount:n}=t;if(n===""&&(n="0"),!this.isValidAmount(n))return;this.quoteProcessor.stop();let a=this.checkAccount(),c={...this.config,...r,isSimulationKilled:r?.isSimulationKilled??this.config.isSimulationKilled??!1};if(n==="0"||n===""){this.send({type:lt.SetPair,buy:o.buyToken,sell:o.sellToken,amount:t});return}let{buyToken:p,sellToken:m,takerCaip19:d,takerDestinationCaip19:f}=o;try{let h={amount:new _(t.amount).shiftedBy(t.perspective==="buy"?p.data.decimals:m.data.decimals).toString(),amountUsd:_(t.amount).times(t.perspective==="buy"?p.data.price??0:m.data.price??0).toString(),buy:p,sell:m,taker:d,takerDestination:f,slippageTolerance:c.slippageTolerance,autoSlippage:c.slippageType===ce.Auto,exactOut:t.perspective==="buy",priorityFee:c.priorityFee,tipAmount:c.tipAmount,preferredProvider:c.preferredProvider,isLedger:a.type==="ledger",phantomCashAccount:c.phantomCashAccount??!1,isSimulationKilled:c.isSimulationKilled};this.quoteProcessor.start(h,a)}catch(h){console.error("Error when streaming quotes",h)}}setPair(t,r,o){this.send({type:lt.SetPair,buy:t,sell:r,amount:o})}switchTokens(){let t=this.getTokenState();if(t.type!=="pair")return;let r=mS(t);r&&this.tokenStateMachine.send({type:"switchTokens",mode:r})}setAccount(t){this.account=t,this.accountChangeListeners.forEach(r=>r.onAccountChange(t))}setCashAccount(t){this.cashAccount=t}getAccount(){return this.account}getInitializer(){return this.swapInitializer}setInitializer(t){this.swapInitializer=t}async fetchQuotes({amount:t,amountUsd:r,buy:o,sell:n,slippageTolerance:a,autoSlippageEnabled:c,priorityFee:p,tipAmount:m,signal:d,phantomCashAccount:f}){let h=X(n),w=X(o),y=t.perspective==="buy",S=new _(t.amount).shiftedBy(t.perspective==="buy"?o.data.decimals:n.data.decimals).toString();this.send({type:lt.QuoteRequestStarted,amount:t,slippageType:c?ce.Auto:ce.Fixed});let T=this.checkChainAddress(n.data),b={chainId:T.networkID,resourceType:ee.address,address:T.address},A;if(Wt(n.data.chain.id,o.data.chain.id)){let k=this.checkChainAddress(o.data);A={chainId:k.networkID,resourceType:ee.address,address:k.address}}try{let k=await this.apiClient.getQuotes({sell:h,buy:w,amount:S,amountUsd:r,taker:b,takerDestination:A,slippageTolerance:a??0,autoSlippageEnabled:c,exactOutEnabled:y,priorityFee:p,tipAmount:m,signal:d,phantomCashAccount:f});return this.send({type:lt.QuoteResponseReceived,response:k}),k}catch(k){throw this.send({type:lt.QuoteRequestError,error:k}),k}}async swap(t){let{signer:r,storage:o,locale:n,deviceId:a,connection:c,authRepository:p,isSimulationKilled:m,gasEstimation:d,preprocessor:f}=t,h=this.getState();if(!pS(h))throw new Error(`Can't swap from ${h.type}`);this.quoteProcessor.stop();let w=this.checkAccount(),y={account:w,buy:h.buy,sell:h.sell,amount:h.amount,quote:h.quote,response:h.response,slippageType:h.slippageType,quoteInput:h.input},S=this.getAddressFromCaip19({caip19:h.response.taker}),T=this.swapCommandFactory.create(y,S,h.sell.data.chain.id,c,p,this.cashAccount,d),b=new Dc(T,k=>this.executeSwapStateMachine.send(k),y),A=await b.createTransaction();await P.startSpan(jp(ne(h.quote),A.type),async()=>{let k=await b.simulate(A,n,a,m),C=s(async()=>{let I=await b.swap(w.identifier,A,k,r,o);await b.waitForConfirmation(I)},"performSwap");f?await f(C):await C()})}changeToken(t,r,o){let n=this.getTokenState();if(n.type!=="pair")return;let a=r==="buy"?t:n.buyToken,c=r==="sell"?t:n.sellToken,p=X(c),m=X(a),d;n.mode.type==="swap"?d={...n.mode,network:c.data.chain.id,sellCaip19:M(p),buyCaip19:M(m),takerCaip19:r==="sell"?o:n.mode.takerCaip19,takerDestinationCaip19:r==="buy"?o:n.mode.takerDestinationCaip19,sellFungibleKey:r==="sell"?t.data.key:n.mode.sellFungibleKey,buyFungibleKey:r==="buy"?t.data.key:n.mode.buyFungibleKey}:n.mode.type==="buy"?d={...n.mode,buyCaip19:M(m),sellCaip19:M(p),takerCaip19:r==="buy"?o:n.mode.takerCaip19}:n.mode.type==="sell"&&(d={...n.mode,sellCaip19:M(p),buyCaip19:M(m),takerDestinationCaip19:r==="sell"?o:n.mode.takerDestinationCaip19}),Xa({tokens:[m,p]}).then(f=>{let h=f[M(m)],w=f[M(p)];this.tokenStateMachine.send({type:"changeToken",mode:d,token:t,perspective:r,buyTokenPrice:h,sellTokenPrice:w})}).catch(f=>{P.captureError(f,O.Swapper),this.tokenStateMachine.send({type:"changeToken",mode:d,token:t,perspective:r})})}selectQuote(t){this.send({type:lt.UserSelectedQuote,quote:t})}setQuoteConfig(t){this.config={...this.config,...t},this.refreshQuoteProcessor()}refreshQuoteProcessor(){let t=this.getLastQuoteProcessorSwapAmount();t&&this.setAmount(t)}getLastQuoteProcessorSwapAmount(){let t=this.getQuoteProcessorState();switch(t.type){case"starting":case"firstQuoteReceived":case"quoteProcessed":case"error":let r=t.input;return{amount:new _(r.amount).shiftedBy(-1*(r.exactOut?r.buy.data.decimals:r.sell.data.decimals)).toString(),perspective:r.exactOut?"buy":"sell"};default:return}}getState(){return this.stateMachine.getState()}getExecuteState(){return this.executeSwapStateMachine.getState()}stopProcessingQuotes(){this.quoteProcessor.stop()}subscribeExecution(t){return this.executeSwapStateMachine.addListener(t),()=>this.unsubscribeExecution(t)}unsubscribeExecution(t){this.executeSwapStateMachine.removeListener(t)}getQuoteProcessorState(){return this.quoteProcessor.getState()}subscribeQuoteProcessor(t){return this.quoteProcessor.subscribe(t),()=>this.unsubscribeQuoteProcessor(t)}unsubscribeQuoteProcessor(t){this.quoteProcessor.unsubscribe(t)}stopQuoteProcessor(){this.quoteProcessor.stop()}subscribeAccountChange(t){return this.accountChangeListeners.push(t),()=>this.unsubscribeAccountChange(t)}unsubscribeAccountChange(t){this.accountChangeListeners=this.accountChangeListeners.filter(r=>r!==t)}setQuoteStreamer(t){this.quoteProcessor.setQuoteStreamer(t)}getSwapCommandFactory(){return this.swapCommandFactory}setSwapCommandFactory(t){this.swapCommandFactory=t}send(t){return this.stateMachine.send(t)}checkAccount(){if(!this.account)throw new Error("Must set a MultiChainAccount");return this.account}checkChainAddress({chain:t,walletAddress:r}){let{id:o}=t;if(r)return{networkID:o,address:r};let a=this.checkAccount().addresses.find(p=>p.networkID===o);if(!a)throw new Error(`No address found for chain ${o}`);let c={...a};return gr(c)&&(c.address=c.address.toLowerCase()),c}getAddressFromCaip19(t){let r;if("encodedCaip19"in t?r=We(t.encodedCaip19):r=t.caip19,r.resourceType===ee.address)return r.address;throw new Error(`CAIP19 ${r} is not an address`)}};u();l();var Wp=D(B());var iv=(0,Wp.createContext)(null),qS=iv.Provider;u();l();var zS=D(B());u();l();u();l();var la=class{static{s(this,"WarmSwapAnalytics")}analytics;constructor(t){this.analytics=t}warmingStarted(t){this.analytics.capture("swapperWarmingStarted",{data:{mode:t.type,caip19:this.getCaip19(t)}})}warmingCompleted(t,r){this.analytics.capture("swapperWarmingCompleted",{data:{mode:t.type,caip19:this.getCaip19(t),durationMs:r}})}warmingFailed(t){this.analytics.capture("swapperWarmingFailed",{data:{mode:t.type,caip19:this.getCaip19(t)}})}cacheHit(t){this.analytics.capture("swapperWarmCacheHit",{data:{mode:t.type,caip19:this.getCaip19(t)}})}cacheMiss(t){this.analytics.capture("swapperWarmCacheMiss",{data:{mode:t.type,caip19:this.getCaip19(t)}})}warmingAwaited(t){this.analytics.capture("swapperWarmingAwaited",{data:{mode:t.type,caip19:this.getCaip19(t)}})}getCaip19(t){switch(t.type){case"buy":return t.buyCaip19;case"sell":return t.sellCaip19;default:return}}};var qc=class{static{s(this,"WarmSwapInitializer")}proxyInitializer;multiChainAccount;cashAddresses;cache;analytics;constructor(t,r,o){this.proxyInitializer=t,this.cache=new Zp(r),this.analytics=o?new la(o):void 0}async initialize(t,r,o,n){let a=this.cache.get(t);if(!a)return this.analytics?.cacheMiss(t),this.proxyInitializer.initialize(t,r,o,n);switch(a.type){case"idle":return this.analytics?.cacheMiss(t),this.proxyInitializer.initialize(t,r,o,n);case"warming":return this.analytics?.warmingAwaited(t),a.promise.catch(()=>this.proxyInitializer.initialize(t,r,o,n)).finally(()=>{this.cache.delete(t)});case"warmed":return this.analytics?.cacheHit(t),this.cache.delete(t),a.initializationResult}}warmInitialization(t){if(!this.multiChainAccount)return;let r=this.cache.peek(t);if(r&&r.type==="warmed"&&Hp(r.swapMode,t))return;this.analytics?.warmingStarted(t);let o=Date.now(),n=this.proxyInitializer.initialize(t,this.multiChainAccount.addresses,this.cashAddresses??{},{});this.cache.set(t,{type:"warming",swapMode:t,promise:n}),n.then(a=>{let c=Date.now()-o;this.analytics?.warmingCompleted(t,c),this.cache.set(t,{type:"warmed",swapMode:t,initializationResult:a})}).catch(()=>{this.analytics?.warmingFailed(t),this.cache.delete(t)})}setMultiChainAccount(t){this.cache.clear(),this.multiChainAccount=t}setCashAddresses(t){this.cache.clear(),this.cashAddresses=t}setAnalytics(t){this.analytics||(this.analytics=new la(t))}},Zp=class{static{s(this,"Cache")}capacity;entries=new Map;constructor(t){this.capacity=t}getKey(t){let r={type:t.type},o=s(n=>{if(n?.minimumOrderSize)return{minimumOrderSize:{base:n.minimumOrderSize.base?.toString(),quote:n.minimumOrderSize.quote?.toString()}}},"serializeOptions");switch(t.type){case"buy":return JSON.stringify({...r,buyCaip19:t.buyCaip19,sellCaip19:t.sellCaip19,takerCaip19:t.takerCaip19,takerDestinationCaip19:t.takerDestinationCaip19,options:o(t.options)});case"sell":return JSON.stringify({...r,sellCaip19:t.sellCaip19,buyCaip19:t.buyCaip19,takerCaip19:t.takerCaip19,takerDestinationCaip19:t.takerDestinationCaip19,options:o(t.options)});case"swap":return JSON.stringify({...r,network:t.network,sellCaip19:t.sellCaip19,buyCaip19:t.buyCaip19,takerCaip19:t.takerCaip19,takerDestinationCaip19:t.takerDestinationCaip19,options:o(t.options)});case"prediction":return JSON.stringify({...r,network:t.network,marketTicker:t.marketTicker,sellCaip19:t.sellCaip19,takerCaip19:t.takerCaip19,takerDestinationCaip19:t.takerDestinationCaip19,options:o(t.options)});default:let n=t;return JSON.stringify(r)}}get(t){return this.entries.get(this.getKey(t))}peek(t){return this.entries.get(this.getKey(t))}set(t,r){let o=this.getKey(t);if(this.entries.set(o,r),this.entries.size>this.capacity){let n=Array.from(this.entries.keys())[0];this.entries.delete(n)}}delete(t){this.entries.delete(this.getKey(t))}clear(){this.entries.clear()}};var cv=2,zc=new qc(new Ln(new Bn),cv);var GS=(0,Pt.createContext)(null);function uv({children:e,processorMode:t="noOp"}){let{data:r}=_e(),o=Ot(),n=(0,Pt.useMemo)(()=>Ly(o),[o]);(0,Pt.useEffect)(()=>{n.initialize()},[n]);let a=(0,Pt.useMemo)(()=>KS(t,n),[t,n]);(0,Pt.useEffect)(()=>{r&&(a.setAccount(r),zc.setMultiChainAccount(r))},[r,a]);let c=vi();return(0,Pt.useEffect)(()=>{c&&zc.setCashAddresses(c)},[c,a]),Pt.default.createElement(qS,{value:n},Pt.default.createElement(GS.Provider,{value:a},e))}s(uv,"SwapperProvider");function je(){let e=(0,Pt.useContext)(GS);return e||KS("noOp")}s(je,"useSwapper");function KS(e,t){let r=new Qc(new Ri,new Xi(t),new yc(new tc(nr?new ec:new Ji),e==="noOp"?new mc:new dc));return r.setInitializer(zc),r}s(KS,"createSwapper");u();l();var Kr=D(B());u();l();var Fr=s(e=>{let t=Math.floor(e/3600),r=Math.floor((e-t*3600)/60),o=e%60;if(t>0)return v.t("swapProviderEstimatedTimeHM",{hours:t,minutes:r});if(r>0){let n=o>0?r+1:r;return v.t("swapProviderEstimatedTimeM",{minutes:n})}return v.t("swapProviderEstimatedTimeS",{seconds:o})},"formatSecondsAsSwapTime");u();l();var Gc=s(e=>e.steps.reduce((t,r)=>t.plus(new U(r.nonIncludedNonGasFees)),new U(0)),"getBridgeStepsFees"),Un=s(e=>e.steps.flatMap(o=>o.feeCosts).reduce((o,n)=>o.plus(n.amountUSD??0),new U(0)),"getBridgeStepsFeesInUsd");u();l();var go=s(e=>e&&ne(e)?e.executionDuration:0,"getSwapExecutionDuration");var lv=s(({selectProvider:e})=>{let{currencySymbol:t,fromUsd:r}=ft(),o=je(),[n,a]=(0,Kr.useState)(!1),[c,p]=(0,Kr.useState)(o.getQuoteProcessorState());(0,Kr.useEffect)(()=>{let h=o.subscribeQuoteProcessor({onStateChange(w,y){p(y)}});return()=>h()},[o]);let[m,d]=(0,Kr.useState)(o.getTokenState());return(0,Kr.useEffect)(()=>{let h=o.subscribeToken({onStateChange(w,y,S){d(S)}});return()=>h()},[o]),{details:(0,Kr.useMemo)(()=>{if(c.type!=="quoteProcessed"&&c.type!=="firstQuoteReceived"||m.type!=="pair")return[];let h=c.quote,w=fv(h),y=h.baseProvider.name,S=mv({currentQuote:h,buyToken:m.buyToken,sellToken:m.sellToken,isFlipped:n,setIsFlipped:a});return ne(h)?dv({quote:h,selectProvider:e,exchangeRate:S,currencySymbol:t,fromUsd:r}):pv({provider:y,sources:w,exchangeRate:S,selectProvider:e})},[c,m,e,t,r,n]),footnote:v.t("swapProviderPricingFootnote")}},"useSwapPricing"),pv=s(({provider:e,sources:t,exchangeRate:r,selectProvider:o})=>[{label:v.t("swapProviderPricingProvider"),value:e,icon:"chevron-right",onPress:o},{label:v.t("swapProviderPricingMarket"),value:t},{label:v.t("swapProviderPricingPrice"),value:r.rate,icon:"swap",onPress:r.flip}],"getStandardRows"),dv=s(({quote:e,selectProvider:t,exchangeRate:r,currencySymbol:o,fromUsd:n})=>{let a=e.baseProvider.name,c=Un(e).toString(),p=Fr(go(e));return[{label:v.t("swapProviderPricingProvider"),value:a,icon:"chevron-right",onPress:t},{label:v.t("swapProviderPricingPrice"),value:r.rate,icon:"swap",onPress:r.flip},{label:v.t("swapProviderPricingFees"),value:`${o}${n(Number(c),2)} ${v.t("swapProvidersFee")}`},{label:v.t("swapProviderPricingTime"),value:p}]},"getBridgeRows");function mv({currentQuote:e,buyToken:t,sellToken:r,isFlipped:o,setIsFlipped:n}){let{exchangeRate:a,exchangeRateFlipped:c}=dp(e,t,r);return{rate:o?c:a,flip:s(()=>n(!o),"flip")}}s(mv,"getExchangeRate");function fv(e){return Pe(Ue(e))}s(fv,"getSources");u();l();u();l();u();l();function Uo(e){return{chain:se.Solana,type:"fungible",address:e.type===oe.SPL?e.data.mintAddress:void 0,symbol:e.data.symbol??""}}s(Uo,"getAnalyticsAsset");var Kc=class{static{s(this,"NextGenAnalytics")}analytics;additionalAnalyticsTags;constructor(t,r){this.analytics=t,this.additionalAnalyticsTags=r}captureEvent(t,r){let o={...r,data:{...r.data,...this.additionalAnalyticsTags}};this.analytics.capture(t,o)}swapperOpen(t,r,o){this.captureEvent("swapperOpen",{data:{uiContext:o??"swapperInterstitial",swapMode:t,comingFrom:r}})}swapperClose(t,r){this.captureEvent("swapperClose",{data:{uiContext:r??"swapperInterstitial",reason:t}})}swapperUpdateAsset(t,r){switch(t.type){case"sell":this.captureEvent("swapperUpdateToAsset",{data:Uo(r)});break;case"buy":this.captureEvent("swapperUpdateFromAsset",{data:Uo(r)});break}}swapperSwapDefaultQuoteSelected(t){this.captureEvent("swapperSwapDefaultQuoteSelected",{data:{quotePercentageValue:t}})}swapperDetailPanelClicked(){this.captureEvent("swapperDetailPanelClicked",{data:{uiContext:"swapperInterstitial"}})}swapperToggleQuoteCurrency(){this.captureEvent("swapperToggleQuoteCurrency",{data:{uiContext:"swapperInterstitial"}})}swapperQuotesResult(t,r,o){this.captureEvent("swapperQuotesResult",{data:{...pa(t,o),numQuotes:r.quotes.length,sellToken:M(X(t.sell)),buyToken:M(X(t.buy)),fromNetworkId:t.sell.data.chain.id,toNetworkId:t.buy.data.chain.id,isGasless:r.quotes.some(n=>"gaslessSwapFeeResult"in n&&n.gaslessSwapFeeResult?.success===!0)}})}swapperQuotesError({input:t,quoteError:r}){this.captureEvent("swapperQuotesError",{data:{...pa(t),error:r.name}})}};function pa(e,t){let r=t?gv(t):void 0;return{isSellTokenVerified:ei({minimum:ie.Verified,spamStatus:e.sell.data.spamStatus}),sellTokenCaip19:M(X(e.sell)),sellTokenNetworkId:e.sell.data.chain.id,sellTokenSymbol:e.sell.data.symbol??void 0,sellTokenMarketCap:e.sell.data.marketCap,sellTokenAmount:e.amount,buyTokenCaip19:M(X(e.buy)),buyTokenNetworkId:e.buy.data.chain.id,buyTokenSymbol:e.buy.data.symbol??void 0,isAutoSlippageEnabled:e.autoSlippage,manualSlippagePercent:e.slippageTolerance,isExactOut:e.exactOut,isManualTipInput:e.tipAmount!==void 0,gaslessError:r?.error,gaslessAtaFeeUSD:r?.data?.ataFeeUSD,gaslessNetworkFeeUSD:r?.data?.networkFeeUSD,gaslessTotalAmountUSD:r?.data?.totalAmountUSD}}s(pa,"createSwapperAnalyticsFields");function Yp(e){if(e.type==="quoteProcessed")return pa(e.input,e.quote)}s(Yp,"createSwapperAnalyticsFieldsFromQuoteProcessorState");function gv(e){if(Ct(e))return e.gaslessSwapFeeResult}s(gv,"getGaslessSwapFeeResult");u();l();var On=D(B());var hv=(0,On.createContext)(void 0);var VS=s(()=>{let e=(0,On.useContext)(hv);if(!e)throw new Error("useSwapToken must be used within a SwapTokenProvider");return e},"useSwapToken");u();l();function jS(e,t,r,o){let a=t.find(p=>p.percentage===1)?.amount;if(o==="sell"&&a&&new U(e).gt(a))return["insufficientBalance"];let c=r.type==="buy"?r.options?.minimumOrderSize?.quote:r.options?.minimumOrderSize?.base;return c!=null&&new U(e).lt(c)?["minimumBalance"]:[]}s(jS,"createQuoteInputErrors");u();l();var yv=[.25,.5,1],Xp=class{static{s(this,"SellPercentage")}percentage;amount;fiatAmount;constructor(t,r,o){this.percentage=t,this.amount=r,this.fiatAmount=o}getAmountForDenomination(t){return t==="crypto"?this.amount:this.fiatAmount}};function HS({maxSellAmount:e,sellTokenPrice:t,allowedPercentages:r=yv}){return r.map(o=>{let n=e.multipliedBy(o);return new Xp(o,n,n.multipliedBy(t?.usd??0))})}s(HS,"getSellPercentages");u();l();var ed=D(B());u();l();var Mn=s(()=>It({key:Ce.PriorityFee,queryKey:he.priorityFee()}),"usePriorityFee"),ZZ=s(()=>Ft({key:Ce.PriorityFee,queryKey:he.priorityFee()}),"useSetPriorityFee");u();l();var Qn=s(()=>It({key:Ce.TipAmount,queryKey:he.tipAmount()}),"useTip"),oY=s(()=>Ft({key:Ce.TipAmount,queryKey:he.tipAmount()}),"useSetTip");u();l();function Jp(e){return new _(e??0).multipliedBy(10**Lm.tokenDecimals)}s(Jp,"getCustomFee");u();l();var wv=3,Sv=new U(356190),bv=s(e=>Jt.get(e).averageNetworkFee.times(wv),"getNetworkFeeBuffer");function $S({sellFungible:e,totalFees:t,transactionSpeedsToUnitCost:r,minRequiredBalance:o,customPriorityFee:n,customTip:a,isBridge:c=!1}){let{decimals:p,amount:m,balance:d,chain:f}=e.data,h=m?new U(m):d?new U(d).multipliedBy(Ka(p)):new U(0),w=Mt(e.type),y=Ke(e),{source:S,destination:T}=o;if(y)return Ju(h.toString(),p);let A=Tv({isNativeToken:w,network:f,totalFees:t,isBridge:c,transactionSpeedsToUnitCost:r,customPriorityFee:n,customTip:a}).plus(T),k=w?Av(h,A,S):h.toString();return Ju(k,p)}s($S,"getMaxSellAmount");function Tv({isNativeToken:e,network:t,totalFees:r,isBridge:o,transactionSpeedsToUnitCost:n,customPriorityFee:a,customTip:c}){if(!e)return r;let p=Jt.get(t.id),m=o?p.bridgeDefaultFee:p.swapDefaultFee,d=n?.[br.standard];return Cf(d)&&(m=Sv.multipliedBy(d.maxFeePerGas.plus(d.maxPriorityFeePerGas))),x.isSolanaNetworkID(t.id)&&a&&(m=m.plus(a)),x.isSolanaNetworkID(t.id)&&c&&(m=m.plus(c)),m.plus(bv(t.id))}s(Tv,"calculateFees");function Av(e,t,r){let o=r.plus(t);return e.gt(o)?e.minus(o).toString():e.toString()}s(Av,"calculateNativeTokenMaxSell");u();l();var da=D(B());var WS=s(e=>{let t=e?.data.chain.id,{data:r}=_e(),o=(0,da.useMemo)(()=>r?.addresses.find(a=>a.networkID===t),[r,t]),{data:n=0}=xo(o);return(0,da.useMemo)(()=>new _(n),[n])},"useSourceMinRequiredBalance"),ZS=s((e,t)=>{let r=e?.data.chain.id,n=t?.data.chain.id??r,{data:a}=_e(),c=(0,da.useMemo)(()=>a?.addresses.find(m=>m.networkID===n),[a,n]),{data:p=0}=xo(c);return(0,da.useMemo)(()=>t?.data.amount||t?.data.balance&&new _(t.data.balance).gt(0)?new _(0):new _(p),[t?.data.amount,t?.data.balance,p])},"useDestinationMinRequiredBalance");function YS(e){let t=e.type==="pair"?e.sellToken:null,r=e.type==="pair"?e.buyToken:null,o=WS(t),n=ZS(t,r),{data:a}=tg({networkID:t?.data.chain.id}),{data:c}=Mn(),{data:p}=Qn(),m=(0,ed.useMemo)(()=>!t||!r?!1:Wt(t.data.chain.id,r.data.chain.id),[t,r]);return(0,ed.useMemo)(()=>t?$S({sellFungible:t,totalFees:new _(0),transactionSpeedsToUnitCost:x.isEVMNetworkID(t.data.chain.id)?a:void 0,isBridge:m,minRequiredBalance:{source:o,destination:n},customPriorityFee:Jp(c??0),customTip:Jp(p??0)}):"0",[t,a,m,o,n,c,p])}s(YS,"useGetMaxSellAmount");u();l();var Vr=Ye(e=>({preferredProvider:void 0,setPreferredProvider:s(t=>e({preferredProvider:t}),"setPreferredProvider")}));u();l();var cb=D(B());u();l();var tb=D(B());u();l();var JS=D(B());u();l();var Vc=D(B());var XS=s(()=>{let e=je(),[t,r]=(0,Vc.useState)(e.getTokenState());return(0,Vc.useEffect)(()=>e.subscribeToken({onStateChange(n,a,c){r(c)}}),[e]),t},"useTokenState");var eb=s(()=>{let e=XS();return(0,JS.useMemo)(()=>ct(e)?{buyToken:e.buyToken,sellToken:e.sellToken}:{buyToken:void 0,sellToken:void 0},[e])},"useSwapTokens");var rb=s(()=>{let{buyToken:e,sellToken:t}=eb(),{data:[r]}=Ht(["enable-cash"]);return(0,tb.useMemo)(()=>!!(r&&(e&&Ke(e)||t&&Ke(t))),[e,t,r])},"usePhantomCashAccount");u();l();var ob=s(()=>It({key:Ce.SlippageTolerance,queryKey:he.slippageTolerance()}),"useSlippageTolerance"),hX=s(()=>Ft({key:Ce.SlippageTolerance,queryKey:he.slippageTolerance()}),"useSetSlippageTolerance");u();l();var nb=D(B());var qn;(function(e){e.Auto="auto",e.Fixed="fixed"})(qn||(qn={}));var xv={type:qn.Auto},sb=s(()=>{let{priorityFeeSetting:e,isFetched:t,save:r}=Ev();return{isFetched:t,selectedSetting:e,setPriorityFeeSetting:r}},"usePriorityFeeSettings"),Ev=s(()=>{let{data:e,isFetched:t}=It({key:Ce.PriorityFeeSettings,queryKey:he.priorityFeeSettings()}),{mutateAsync:r}=Ft({key:Ce.PriorityFeeSettings,queryKey:he.priorityFeeSettings()}),o=(0,nb.useCallback)(async n=>{await r(n)},[r]);return{isFetched:t,priorityFeeSetting:e??xv,save:o}},"usePriorityFeeSettingsStore");u();l();var ab=D(B());var zn;(function(e){e.Auto="auto",e.Fixed="fixed"})(zn||(zn={}));var kv={type:zn.Auto},ib=s(()=>{let{tipSetting:e,isFetched:t,save:r}=Cv();return{isFetched:t,selectedSetting:e,setTipSetting:r}},"useTipSettings"),Cv=s(()=>{let{data:e,isFetched:t}=It({key:Ce.TipSettings,queryKey:he.tipSettings()}),{mutateAsync:r}=Ft({key:Ce.TipSettings,queryKey:he.tipSettings()}),o=(0,ab.useCallback)(async n=>{await r(n)},[r]);return{isFetched:t,tipSetting:e??kv,save:o}},"useTipSettingsStore");var ub=s(()=>{let{selectedSetting:e}=ao(),{data:t}=ob(),{data:r}=Mn(),{selectedSetting:o}=sb(),{data:n}=Qn(),{selectedSetting:a}=ib(),c=Vr(f=>f.preferredProvider),p=Xo("kill-swapper-simulation")??!1,m=rb();return(0,cb.useMemo)(()=>({slippageTolerance:t??void 0,priorityFee:o.type==="fixed"?r??void 0:void 0,tipAmount:a.type==="fixed"?n??void 0:void 0,slippageType:e.type,preferredProvider:c,phantomCashAccount:m,isSimulationKilled:p}),[t,r,o.type,n,a.type,e,c,m,p])},"useQuoteConfig");u();l();var lb=D(B());var pb=s(()=>{let{data:e,isFetched:t}=Mn(),{data:r,isFetched:o}=Qn();return(0,lb.useMemo)(()=>{if(!t||!o||!e&&!r)return;let n={};return e&&(n.priorityFee=new _(e)),r&&(n.tip=new _(r)),n},[t,o,e,r])},"useSwapModeSettings");u();l();var ht=D(B());var _v=s((e,t=[],r)=>{let o=je(),n=we(),a;try{a=VS().nextGenAnalytics}catch{}let c=(0,ht.useMemo)(()=>a||new Kc(n,r),[n,r,a]),p=ze("enable-be-swapper-max-amount"),[m,d]=(0,ht.useState)([]),[f,h]=(0,ht.useState)(o.getTokenState());(0,ht.useEffect)(()=>{let F=o.subscribeToken({onStateChange(z,W,re){h(re)}});return()=>F()},[o,h]);let[w,y]=(0,ht.useState)(o.getQuoteProcessorState());(0,ht.useEffect)(()=>{let F=o.subscribeQuoteProcessor({onStateChange:s((z,W)=>{W.type==="firstQuoteReceived"&&c.swapperQuotesResult(W.input,W.response,W.quote),y(W),mo.processQuoteProcessorState(W)},"onStateChange")});return()=>{o.stopQuoteProcessor(),F()}},[o,c]);let S=(0,ht.useMemo)(()=>Fv(f,w),[f,w]),T=ub();(0,ht.useEffect)(()=>{o.setQuoteConfig(T)},[T,o]);let b=YS(f),A=(0,ht.useMemo)(()=>ct(f)?HS({sellTokenPrice:f.sellTokenPrice,allowedPercentages:t,maxSellAmount:p?f.maxSellAmount:new _(b)}):[],[f,t,p,b]),k=Vr(F=>F.setPreferredProvider);(0,ht.useEffect)(()=>{let F=o.subscribeToken({onStateChange(z,W,re){z.type==="initializeStarted"&&k(void 0)}});return()=>F()},[o,k]);let C=(0,ht.useCallback)(({amount:F,denomination:z,perspective:W,tokenStateOverride:re})=>{try{let Z=Iv(re??f,F,z,W),He=jS(Z,A,e,W);d(He),k(void 0),o.setAmount({amount:Z,perspective:W},{...T,preferredProvider:void 0})}catch(Z){P.captureError(Z,O.Swapper)}},[f,A,e,k,o,T]),{connection:I}=un(),L=Ot(),Q=en(),R=Ba(),H=v.language,q=Xo("kill-swapper-simulation")??!1,E=(0,ht.useCallback)(async F=>{F.forEach(W=>o.subscribeExecution(W));let z=await n.getDeviceId();await o.swap({signer:Q,storage:L,locale:H,deviceId:z,connection:I,authRepository:R,isSimulationKilled:q}),F.forEach(W=>o.unsubscribeExecution(W))},[o,n,Q,L,H,I,R,q]);return{setAmount:C,swap:E,tokenState:f,quoteProcessorState:w,quotedAmounts:S,inputErrors:m,sellPercentages:A}},"useSwapperQuotes");function Iv(e,t,r,o){if(!ct(e))throw new Error("Token state is not a pair");let{sellTokenPrice:n,sellToken:a,buyToken:c,buyTokenPrice:p}=e;switch(r){case"fiat":switch(o){case"buy":if(!p?.usd)throw new Error("Token price not found");return new _(t).dividedBy(p.usd).decimalPlaces(c.data.decimals).toString();case"sell":if(!n?.usd)throw new Error("Token price not found");return new _(t).dividedBy(n.usd).decimalPlaces(a.data.decimals).toString()}break;case"crypto":switch(o){case"buy":return new _(t).decimalPlaces(c.data.decimals).toString();case"sell":return new _(t).decimalPlaces(a.data.decimals).toString()}break}}s(Iv,"parseAmount");function Fv(e,t){if(!ct(e)||t.type!=="firstQuoteReceived"&&t.type!=="quoteProcessed")return;let r=t.quote,{sellToken:o,buyToken:n,sellTokenPrice:a,buyTokenPrice:c}=e;return{buyAmount:new _(r.buyAmount).shiftedBy(-n.data.decimals),buyAmountUsd:c?.usd?new _(r.buyAmount).shiftedBy(-n.data.decimals).multipliedBy(c.usd):void 0,sellAmount:new _(r.sellAmount).shiftedBy(-o.data.decimals),sellAmountUsd:a?.usd?new _(r.sellAmount).shiftedBy(-o.data.decimals).multipliedBy(a.usd):void 0}}s(Fv,"parseQuoteAmounts");u();l();function db(e){switch(e.type){case be.SlippageExceeded:return v.t("swapTxConfirmationSwapFailedSlippageLimit");case be.InsufficientFunds:return v.t("swapTxConfirmationSwapFailedInsufficientBalance");case be.InsufficientGas:return v.t("swapTxConfirmationSwapFailedInsufficientGas");case be.AccountFrozen:return v.t("swapTxConfirmationSwapFailedAcountFrozen");case be.SimulationTimeout:return v.t("swapTxConfirmationSwapFailedSimulationTimeout");case be.StaleQuote:return v.t("swapTxConfirmationSwapFailedStaleQuote");case be.UnknownError:return v.t("swapTxConfirmationSwapFailedSimulationUnknownError");default:return v.t("swapTxConfirmationSwapFailedTryAgain")}}s(db,"getSimulationErrorMessage");u();l();var pr=D(B());u();l();var td=class{static{s(this,"FullBalanceDisplayStrategy")}format(t,r){return`${ir(t)} ${r}`}},rd=class{static{s(this,"CompactBalanceDisplayStrategy")}format(t,r){return`${cn(t,{compact:!0})} ${r}`}},od=class{static{s(this,"CompactNoSymbolBalanceDisplayStrategy")}format(t){return cn(t,{compact:!0})}};function nd(e){switch(e){case"full":return new td;case"compact":return new rd;case"compactNoSymbol":return new od}}s(nd,"createBalanceDisplayStrategy");u();l();var jc=class{static{s(this,"DefaultGetSwapQuotesStrategy")}async fetch(t){return await Pi(t)}stopFetching(){}getFetchInterval(t){return t}};u();l();u();l();var Gn=class{static{s(this,"QuoteLoggerExecuteSwapStateListener")}streamedQuoteLogger;constructor(t){this.streamedQuoteLogger=t}onStateChange(t,r,o){o.type===Se.TransactionSubmitted&&this.streamedQuoteLogger.logState(o.txReceipt.id)}};u();l();u();l();u();l();var Hc=s((e,t,r)=>{if(r)return Ee(e,t).times(_(r)).toNumber()},"getAssetVolumeUsd"),mb=s((e,t)=>t&&e?t>e?t:e:t??e,"getTotalUsdVolume");function fb({buyAssetUsdValue:e,buyToken:t,sellAssetUsdValue:r,sellToken:o,buyAmount:n,sellAmount:a,phantomFeeUiAmount:c,priceImpact:p,provider:m,baseProvider:d,slippageTolerance:f,slippageType:h,sellSwapFilter:w,isRetry:y,analyticsContext:S}){if(t&&o){let T=Hc(n,t.data.decimals,e),b=Hc(a,o.data.decimals,r),A=mb(T,b);return{networkId:o.data.chain.id,chainId:x.getChainID(o.data.chain.id),toNetworkId:t.data.chain.id,toChainId:x.getChainID(t.data.chain.id),isBridge:o.data.chain.id!==t.data.chain.id,marketName:`${o.data.symbol}/${t.data.symbol}`,tradeDirection:"sell",swapSource:m,baseProvider:d,priceImpact:p,fromAssetSymbol:o.data.symbol??"",fromAssetAddress:o.data.tokenAddress,fromAssetAmount:Ee(a,o.data.decimals),fromAssetUsdPrice:r,fromAssetUsdVolume:b,toAssetSymbol:t.data.symbol??"",toAssetAddress:t.data.tokenAddress,toAssetAmount:Ee(n,t.data.decimals),toAssetUsdPrice:e,toAssetUsdVolume:T,totalUsdVolume:A,feeUsd:c,slippageTolerance:f,slippageType:h,sellSwapFilter:w,isRetry:y,analyticsContext:S}}return null}s(fb,"legacyAnalyticsPayload");function $c({buyAssetUsdValue:e,buyToken:t,sellAssetUsdValue:r,sellToken:o,quote:n,slippageTolerance:a,slippageType:c,sellSwapFilter:p,isRetry:m,analyticsContext:d,baseProvider:f}){if(t&&o){let{buyAmount:h,sellAmount:w}=n,y="priceImpact"in n?n.priceImpact:0,S="sources"in n?Pe(n.sources):"",T=("fees"in n?n.fees.find(C=>C.type==="phantom")?.amount.toString():"")??"",b=Hc(h,t.data.decimals,e),A=Hc(w,o.data.decimals,r),k=mb(b,A);return{chainId:o.data.chain.id??t.data.chain.id,swap:{marketName:`${o.data.symbol}/${t.data.symbol}`,tradeDirection:"sell",swapSource:S,priceImpact:y,fromAssetSymbol:o.data.symbol??"",fromAssetAddress:o.data.tokenAddress??"",fromAssetAmount:Ee(w,o.data.decimals),fromAssetUsdPrice:r??0,fromAssetUsdVolume:A??0,toAssetSymbol:t.data.symbol??"",toAssetAddress:t.data.tokenAddress??"",toAssetAmount:Ee(h,t.data.decimals),toAssetUsdPrice:e,toAssetUsdVolume:b,totalUsdVolume:k??0,feeUsd:Number(T),slippageTolerance:a,slippageType:c,sellSwapFilter:p,isRetry:m,analyticsContext:d,baseProvider:f}}}return null}s($c,"analyticsPayload");function gb({buyAssetUsdValue:e,buyToken:t,sellAssetUsdValue:r,sellToken:o,buyAmount:n,sellAmount:a,phantomFeeUiAmount:c,priceImpact:p,provider:m,baseProvider:d,slippageTolerance:f,transactionId:h,slippageType:w,sellSwapFilter:y,isRetry:S,analyticsContext:T}){let b=fb({buyAssetUsdValue:e,buyToken:t,sellAssetUsdValue:r,sellToken:o,buyAmount:n,sellAmount:a,phantomFeeUiAmount:c,priceImpact:p,provider:m,baseProvider:d,slippageTolerance:f,slippageType:w,sellSwapFilter:y,isRetry:S,analyticsContext:T});return b?{data:{...b,id:h}}:{}}s(gb,"getAnalyticsPayload");u();l();var hb=s(({txReceipt:e,networkID:t,amountType:r,swapAnalytics:o,walletAddress:n})=>{let a=Es(t);P.addBreadcrumb(O.Swapper,"submittedTransaction",Y.Info,{...a,txReceipt:e.id,method:a.chainType===xe.Solana?"signAndSendTransaction":a.chainType===xe.EVM?"eth_sendRawTransaction":a.chainType===xe.Sui?"signAndExecuteTransaction":"UNKNOWN"}),a.chainType===xe.Solana?o.submittedTransaction(e.id,{...a,method:"signAndSendTransaction",swapType:r==="sell"?"exactIn":"exactOut",walletAddress:n}):a.chainType===xe.EVM?o.submittedTransaction(e.id,{...a,method:"eth_sendRawTransaction",swapType:r==="sell"?"exactIn":"exactOut",walletAddress:n}):a.chainType===xe.Sui&&o.submittedTransaction(e.id,{...a,method:"signAndExecuteTransaction",swapType:r==="sell"?"exactIn":"exactOut",walletAddress:n})},"logTransactionSubmitted");u();l();var yb=D(B());var vv={calculate(e){let t=(e?.fees??[]).find(r=>r.type==="phantom");return{amount:new _(t?.amount??0),amountUsd:null,pct:t?.percentage??0}}},Pv={calculate(e){let t=e.steps.flatMap(r=>r.feeCosts).find(r=>r.name==="phantom");return{amount:new _(t?.amount??0),amountUsd:null,pct:parseFloat(t?.percentage??"0")}}},wb=s(()=>{let{currentQuote:e}=ot();return{phantomFee:(0,yb.useMemo)(()=>sd(e),[e])}},"usePhantomFee");function sd(e){return Ar(e)?vv.calculate(e):ne(e)?Pv.calculate(e):fo}s(sd,"calculatePhantomFee");u();l();var Sb=s(e=>e?ne(e)?void 0:e.priceImpact:0,"getSwapPriceImpact");u();l();var bb=Ye(e=>({lastFailedSwap:void 0,setLastFailedSwap:s(t=>{e({lastFailedSwap:t})},"setLastFailedSwap")}));function Tb(){return bb.getState().lastFailedSwap}s(Tb,"getLastFailedSwap");function ad(e){bb.getState().setLastFailedSwap(e)}s(ad,"setLastFailedSwap");var Kn=class{static{s(this,"AnalyticsExecuteSwapStateListener")}swapAnalytics;analytics;uiContext;additionalAnalyticsTags;constructor(t,r,o="swapperClassic",n){this.swapAnalytics=t,this.analytics=r,this.uiContext=o,this.additionalAnalyticsTags=n}captureEvent(t,r){let o={...r,data:{...r?.data,...this.additionalAnalyticsTags}};this.analytics.capture(t,o)}onStateChange(t,r,o,n){switch(t.type){case j.ExecuteSwapStarted:this.captureEvent("swapperSwap",{data:{...this.createAnalyticsPayload(o.executingQuote).data,uiContext:this.uiContext}});let a=$c({buyAssetUsdValue:o.executingQuote.buy.data.usd,buyToken:o.executingQuote.buy,sellAssetUsdValue:o.executingQuote.sell.data.usd,sellToken:o.executingQuote.sell,quote:o.executingQuote.quote,slippageTolerance:this.parseSlippageTolerance(o.executingQuote.slippageType,o.executingQuote.quote,o.executingQuote.response),slippageType:o.executingQuote.slippageType,sellSwapFilter:V.getState().swapFilter,isRetry:this.isRetry(o.executingQuote),analyticsContext:o.executingQuote.quote.analyticsContext,baseProvider:o.executingQuote.quote.baseProvider?.id??""});a&&(P.addBreadcrumb(O.Swapper,"approved",Y.Info,Yo(a.swap)),this.swapAnalytics.approved(a));break;case j.SimulationFailed:t.error.type!==be.SlippageExceeded&&P.captureError(t.error,O.Swapper),this.captureEvent("swapperSwapFailure",{data:{...this.createAnalyticsPayload(o.executingQuote).data,error:Rv(t.error)}});break;case j.TransactionSubmissionFailed:P.captureError(t.error,O.Swapper),t.error.type==="noSignature"&&this.captureEvent("swapperSwapFailureNoSignature"),this.captureEvent("swapperSwapFailure",{data:{...this.createAnalyticsPayload(o.executingQuote).data,error:t.error.message,uiContext:this.uiContext}});break;case j.TransactionSubmissionSuccess:hb({txReceipt:t.txReceipt,networkID:t.txReceipt.networkID,amountType:o.executingQuote.amount.perspective==="buy"?"buy":"sell",swapAnalytics:this.swapAnalytics});break;case j.TransactionConfirmationFailed:let c=Pc(t.error);P.captureError(t.error,O.Swapper),this.captureEvent("swapperSwapFailure",{data:{...this.createAnalyticsPayload(o.executingQuote).data,error:c.message,uiContext:this.uiContext}});let p=Es(t.txReceipt.networkID),m={chainId:x.getChainID(t.txReceipt.networkID),networkId:t.txReceipt.networkID},d=t.txReceipt;switch(this.captureEvent("waitForTransactionConfirmationError",{data:{...m,errorMessage:c.message}}),p.chainType){case xe.EVM:case xe.Solana:case xe.Sui:P.addBreadcrumb(O.Swapper,"transactionStatus",Y.Error,{...p,txReceipt:d.id}),this.swapAnalytics.transactionStatus(d.id,{...p,status:{type:"error"}});break}break;case j.TransactionConfirmed:this.captureEvent("swapperSwapSuccess",{data:{...this.createAnalyticsPayload(o.executingQuote,t.txReceipt).data,uiContext:this.uiContext}});let f=Es(t.txReceipt.networkID);switch(P.addBreadcrumb(O.Swapper,"transactionStatus",Y.Info,{...f,txReceipt:t.txReceipt.id}),f.chainType){case xe.EVM:case xe.Solana:case xe.Sui:this.swapAnalytics.transactionStatus(t.txReceipt.id,{...f,status:{type:"confirmed"}});break}break}this.isFailureEvent(t)?ad(o.executingQuote):t.type===j.TransactionSubmissionSuccess&&ad(void 0)}createAnalyticsPayload(t,r){let o=t.quote,n=V.getState(),a=gb({buyToken:t.buy,sellToken:t.sell,buyAmount:o.buyAmount.toString(),sellAmount:o.sellAmount.toString(),phantomFeeUiAmount:sd(o).amountUsd?.toString()??"",priceImpact:Sb(o),provider:Pe(Ue(o)),buyAssetUsdValue:n.buyUsdValue,sellAssetUsdValue:n.sellUsdValue,slippageTolerance:this.parseSlippageTolerance(t.slippageType,o,t.response),transactionId:r?.id??"",slippageType:t.slippageType,sellSwapFilter:n.swapFilter,isRetry:this.isRetry(t),analyticsContext:t.quote.analyticsContext,baseProvider:t.quote.baseProvider?.id??""}),c=t.quoteInput;return c?{data:{...a.data,...pa(c,o)}}:a}parseSlippageTolerance(t,r,o){switch(t){case ce.Fixed:return o.slippageTolerance;case ce.Auto:return Ar(r)?r.slippageTolerance:o.slippageTolerance}}isRetry(t){let r=Tb();if(!r)return!1;let o=M(X(r.buy)),n=M(X(r.sell)),a=M(X(t.buy)),c=M(X(t.sell));return o===a&&n===c}isFailureEvent(t){switch(t.type){case j.SimulationFailed:case j.TransactionSubmissionFailed:case j.TransactionConfirmationFailed:return!0;default:return!1}}};function Rv(e){switch(e.type){case be.SlippageExceeded:return $.SlippageExceeded;case be.InsufficientFunds:return $.InsufficientFunds;case be.InsufficientGas:return $.InsufficientGas;case be.AccountFrozen:return $.AccountFrozen;case be.StaleQuote:return $.StaleQuote;case be.SimulationTimeout:return $.SimulationTimeout;case be.UnknownError:return $.SimulationUnknownError;case be.SimulationFailed:return"SIMULATION_FAILED";default:return $.NotValidScanResultsError}}s(Rv,"toSimulationErrorMessage");u();l();u();l();function Ab(e,t){let r=he.optimisticUpdates(),o=e.getQueryData(r)??[];e.setQueryData(r,[...o.filter(n=>n.id!==t.id),t])}s(Ab,"pushOptimisticUpdate");function xb(e){return`${e.type}-${e.data.key}`}s(xb,"getOptimisticUpdateKey");var Vn=class{static{s(this,"ConfirmationExecuteSwapStateListener")}queryClient;storage;authRepository;constructor(t,r,o){this.queryClient=t,this.storage=r,this.authRepository=o}onStateChange(t,r,o,n){let{sell:a,quote:c,account:p}=o.executingQuote;if(t.type===j.TransactionConfirmed){this.storage.set(Ce.PriorityFee,null),this.storage.set(Ce.PriorityFeeSettings,{type:qn.Auto}),this.queryClient.setQueryData(he.priorityFee(),null),this.queryClient.setQueryData(he.priorityFeeSettings(),{type:qn.Auto}),this.storage.set(Ce.TipAmount,null),this.storage.set(Ce.TipSettings,{type:zn.Auto}),this.queryClient.setQueryData(he.tipAmount(),null),this.queryClient.setQueryData(he.tipSettings(),{type:zn.Auto});let m=new U(a.data.amount),d=new U(c.sellAmount),f=m.minus(d).toString();Ab(this.queryClient,{id:xb(a),amount:f}),this.queryClient.invalidateQueries({queryKey:Zf.tokens(p.addresses)}),this.queryClient.invalidateQueries({queryKey:sg.tokenBalance({wallets:p.addresses,encodedCaip19:M(X(a))})})}}};u();l();u();l();var Wc=class{static{s(this,"SimulationAnalytics")}#e;constructor(t){this.#e=t}onScannedMessageByUser=s(t=>{this.#e.capture("simulation",{data:{simulation:{...t,type:"message",status:"success"}}})},"onScannedMessageByUser");onFailedScannedMessageByUser=s(t=>{this.#e.capture("simulation",{data:{simulation:{...t,type:"message",status:"error"}}})},"onFailedScannedMessageByUser");onScannedTransactionByUser=s(t=>{this.#e.capture("simulation",{data:{simulation:{...t,type:"transaction",status:"success"}}})},"onScannedTransactionByUser");onFailedScannedTransactionByUser=s(t=>{this.#e.capture("simulation",{data:{simulation:{...t,type:"transaction",status:"error"}}})},"onFailedScannedTransactionByUser");onSkippedTransactionByUser=s(t=>{this.#e.capture("simulation",{data:{simulation:{...t,type:"transaction",status:"skipped"}}})},"onSkippedTransactionByUser")};var Eb="swap-validation",jn=class{static{s(this,"SimulationAnalyticsExecuteSwapStateListener")}simulationAnalytics;constructor(t){this.simulationAnalytics=new Wc(t)}onStateChange(t,r,o){switch(t.type){case j.SimulationPassed:let n=t.scannedTransactionResult;this.simulationAnalytics.onScannedTransactionByUser({networkId:t.networkId,warnings:n.warnings.map(c=>c.severity),shouldBlock:!!n.block,errorCode:n.error??""});break;case j.SimulationFailed:let a=t.error.scannedTransactionResult;if(a){this.simulationAnalytics.onScannedTransactionByUser({networkId:t.networkId,warnings:a.warnings.map(c=>c.severity),shouldBlock:!!a.block,errorCode:a.error??""}),a?.error&&P.addBreadcrumb(Eb,`Simulation error: ${JSON.stringify({error:a.error})}`,Y.Info);return}this.simulationAnalytics.onFailedScannedTransactionByUser({networkId:t.networkId,url:t.url}),P.addBreadcrumb("simulation",`networkID: ${t.networkId}, url: ${t.url}, type: transaction`,Y.Info);break;case j.SimulationSkipped:this.simulationAnalytics.onSkippedTransactionByUser({networkId:t.networkId}),P.addBreadcrumb(Eb,`Simulation skipped for networkID: ${t.networkId}`,Y.Info);break}}};u();l();u();l();u();l();var ue;(function(e){e.Idle="idle",e.FetchingQuote="fetchingQuote",e.Quote="quote",e.SimulationRequestErrored="simulationRequestErrored",e.SimulationFailed="simulationFailed",e.Simulated="simulated",e.TransactionSubmissionFailed="transactionSubmissionFailed",e.TransactionNotConfirmed="transactionNotConfirmed"})(ue||(ue={}));var Dv=10,Nv=Ye(e=>({transitions:[],addTransition:s((t,r)=>e(o=>{let n=Bv(r,t);return n?{transitions:[n,...o.transitions].slice(0,Dv)}:o}),"addTransition")}));function Yc(e,t){Nv.getState().addTransition(e,t)}s(Yc,"addSwapperTransition");function Bv(e,t){switch(t.type){case ue.Idle:return;case ue.FetchingQuote:return;case ue.Quote:return{sell:vr(t.response,t.sell,"sell"),buy:vr(t.response,t.buy,"buy"),sellAmount:t.quote.sellAmount,buyAmount:t.quote.buyAmount,provider:ma(t.quote),slippage:t.response.slippageTolerance,stateType:t.type,eventType:e.type,timestamp:Date.now()};case ue.SimulationRequestErrored:return{sell:vr(t.response,t.sell,"sell"),buy:vr(t.response,t.buy,"buy"),sellAmount:t.quote.sellAmount,buyAmount:t.quote.buyAmount,provider:ma(t.quote),slippage:t.response.slippageTolerance,stateType:t.type,eventType:e.type,error:t.error,quoteTransactionData:Zc(t.quote),timestamp:Date.now()};case ue.Simulated:return;case ue.SimulationFailed:return{sell:vr(t.response,t.sell,"sell"),buy:vr(t.response,t.buy,"buy"),sellAmount:t.quote.sellAmount,buyAmount:t.quote.buyAmount,provider:ma(t.quote),slippage:t.response.slippageTolerance,simulationError:t.simulationError,stateType:t.type,eventType:e.type,simulationWarning:t.scannedTransactionResult?.warnings,quoteTransactionData:Zc(t.quote),simulationHumanReadableError:t.scannedTransactionResult?.simulationError?.humanReadableError,simulationRequestId:t.scannedTransactionResult?.advancedDetails?.requestId,timestamp:Date.now()};case ue.TransactionSubmissionFailed:return{sell:vr(t.response,t.sell,"sell"),buy:vr(t.response,t.buy,"buy"),sellAmount:t.quote.sellAmount,buyAmount:t.quote.buyAmount,provider:ma(t.quote),slippage:t.response.slippageTolerance,error:t.error,stateType:t.type,eventType:e.type,quoteTransactionData:Zc(t.quote),timestamp:Date.now()};case ue.TransactionNotConfirmed:return{sell:vr(t.response,t.sell,"sell"),buy:vr(t.response,t.buy,"buy"),sellAmount:t.quote.sellAmount,buyAmount:t.quote.buyAmount,provider:ma(t.quote),slippage:t.response.slippageTolerance,stateType:t.type,eventType:e.type,quoteTransactionData:Zc(t.quote),timestamp:Date.now(),error:t.error};default:return}}s(Bv,"toSparseTransition");var ma=s(e=>{let t=Ue(e);return Pe(t)},"parseProvider"),vr=s((e,t,r)=>{switch(r){case"sell":return{caip19:e.sellToken,symbol:t.data.symbol??void 0};case"buy":return{caip19:e.buyToken,symbol:t.data.symbol??void 0}}},"parseTokens"),Zc=s(e=>{if(!ne(e))return e.transactionData},"parseQuoteTransactionData");u();l();var yt;(function(e){e.QuoteRequestStarted="quoteRequestStarted",e.QuoteResponseReceived="quoteResponseReceived",e.QuoteSelected="quoteSelected",e.SimulationResponseReceived="simulationResponseReceived",e.SimulationRequestError="simulationRequestError",e.TransactionSubmissionFailed="transactionSubmissionFailed",e.TransactionConfirmationFailed="transactionConfirmationFailed"})(yt||(yt={}));var Hn=class{static{s(this,"TransitionsExecuteSwapStateListener")}onStateChange(t,r,o,n){let a=this.toLegacyTransition(t,o);a&&Yc(a.nextState,a.event)}toLegacyTransition(t,r){let{buy:o,sell:n,quote:a,response:c}=r.executingQuote;switch(t.type){case j.SimulationFailed:return{event:{type:yt.SimulationRequestError,error:t.error},nextState:{type:ue.SimulationFailed,buy:o,sell:n,response:c,quote:a,scannedTransactionResult:t.error.scannedTransactionResult,simulationError:t.error.message}};case j.TransactionSubmissionFailed:return{event:{type:yt.TransactionSubmissionFailed,error:t.error},nextState:{type:ue.TransactionSubmissionFailed,buy:o,sell:n,response:c,quote:a,error:t.error}};case j.TransactionConfirmationFailed:return{event:{type:yt.TransactionConfirmationFailed,error:t.error,txReceipt:t.txReceipt},nextState:{type:ue.TransactionNotConfirmed,buy:o,sell:n,response:c,quote:a,error:t.error,txReceipt:t.txReceipt}};default:return}}};u();l();u();l();u();l();u();l();u();l();var kb=s(e=>{let t,r=new Set,o=s((f,h)=>{let w=typeof f=="function"?f(t):f;if(!Object.is(w,t)){let y=t;t=h??(typeof w!="object"||w===null)?w:Object.assign({},t,w),r.forEach(S=>S(t,y))}},"setState"),n=s(()=>t,"getState"),m={setState:o,getState:n,getInitialState:s(()=>d,"getInitialState"),subscribe:s(f=>(r.add(f),()=>r.delete(f)),"subscribe"),destroy:s(()=>{(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()},"destroy")},d=t=e(o,n,m);return m},"createStoreImpl"),Cb=s(e=>e?kb(e):kb,"createStore");var Ob=D(B(),1),Mb=D(Bb(),1);var{useDebugValue:Jv}=Ob.default,{useSyncExternalStoreWithSelector:eP}=Mb.default,Lb=!1,tP=s(e=>e,"identity");function rP(e,t=tP,r){(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&r&&!Lb&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Lb=!0);let o=eP(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return Jv(o),o}s(rP,"useStore");var Ub=s(e=>{(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");let t=typeof e=="function"?Cb(e):e,r=s((o,n)=>rP(t,o,n),"useBoundStore");return Object.assign(r,t),r},"createImpl"),oP=s(e=>e?Ub(e):Ub,"create"),Qb=s(e=>((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&console.warn("[DEPRECATED] Default export is deprecated. Instead use `import { create } from 'zustand'`."),oP(e)),"react");u();l();var ho;(function(e){e.Failed="Failed",e.Progress="Progress",e.Success="Success",e.Default="Default"})(ho||(ho={}));var nP=3e3,er=Qb(e=>({toast:void 0,toastId:void 0,visible:!1,currentTimer:null,hideToast(t){e(r=>t&&r.toastId!==t?r:(r.currentTimer&&clearTimeout(r.currentTimer),{visible:!1,currentTimer:null}))},removeToast(){e(t=>(t.currentTimer&&clearTimeout(t.currentTimer),{toast:void 0,toastId:void 0,visible:!1,currentTimer:null}))},success(t){e(r=>{r.currentTimer&&clearTimeout(r.currentTimer);let o=setTimeout(()=>{e({visible:!1,currentTimer:null})},nP);return{toast:{type:ho.Success,...t},toastId:t.id??$e(),visible:!0,currentTimer:o}})},failed(t){e(r=>(r.currentTimer&&clearTimeout(r.currentTimer),{toast:{type:ho.Failed,...t},toastId:t.id??$e(),visible:!0,currentTimer:null}))},progress(t){e(r=>(r.currentTimer&&clearTimeout(r.currentTimer),{toast:{type:ho.Progress,...t},toastId:t.id??$e(),visible:!0,currentTimer:null}))},message(t){e(r=>(r.currentTimer&&clearTimeout(r.currentTimer),{toast:{type:ho.Default,...t},toastId:t.id??$e(),visible:!0,currentTimer:null}))}}));u();l();var pd=s(e=>{let t=go(e);return Fr(t)},"getEstimatedTime");u();l();function qb(e,t,r,o){let n=Ke(e),a=n?e:t,c=n?t:e,p=n?r.sellAmount:r.buyAmount,m=Ee(p,a.data.decimals),d=Qa(m,!0),f=c.data.symbol,h="";return o?h=n?"swapTokenConfirmationBuyToast":"swapTokenConfirmationSellToast":h=n?"swapSwappingCashBuyToast":"swapSwappingCashSellToast",v.t(h,{amount:d,symbol:f})}s(qb,"cashSwapToastMessage");u();l();u();l();function zb({sell:e,buy:t,onBuyFungiblePress:r}){let o=`${v.t("swapTxConfirmationSwapFailed")} ${e.data.symbol} \u2192 ${t.data.symbol}`,n=x.getChainDefinition(e.data.chain.id).tokenSymbol,a=v.t("buyAssetInterpolated",{tokenSymbol:n});return{title:o,message:v.t("swapTabInsufficientFunds"),onPress:r,buttonText:a}}s(zb,"getInsufficientFundsToastProps");function Gb(e,t,r,o,n,a){let{sell:c,buy:p}=t,m=sP(e,c,p,n,o,r,a);return m||{title:`${v.t("swapTxConfirmationSwapFailed")} ${c.data.symbol} \u2192 ${p.data.symbol}`,message:db(e),onPress:s(()=>{er.getState().hideToast(),o()},"onPress"),buttonText:v.t("commandRetry")}}s(Gb,"createSimulationErrorToast");function sP(e,t,r,o,n,a,c){if(!(e.type&&!c.includes(e.type)))switch(e.type){case be.InsufficientFunds:return zb({sell:t,buy:r,onBuyFungiblePress:s(()=>{er.getState().hideToast(),a()},"onBuyFungiblePress")});case be.SlippageExceeded:return o.selectedSetting.type===ce.Auto?void 0:{title:v.t("swapEnableAutoSlippageTitleToast",{sellSymbol:t.data.symbol,buySymbol:r.data.symbol}),buttonText:v.t("swapEnableAutoSlippageButtonToast"),message:"",onPress:s(()=>{o.setSlippageSetting({type:ce.Auto}),n(),er.getState().hideToast()},"onPress")}}}s(sP,"createCustomSimulationErrorToast");u();l();u();l();var aP=["Ledger App not open","Ledger not connected","Unable to connect to Ledger","Unable to connect to Ledger device","Need permission to connect to Ledger"],iP="Ledger user rejected action",cP="Ledger Sign Error";function Kb(e){return aP.some(r=>e.message.includes(r))?v.t("swapTxConfirmationSwapFailedLedgerConnectionError"):e.message.includes(iP)?v.t("swapTxConfirmationSwapFailedLedgerReject"):e.message.includes(cP)?v.t("swapTxConfirmationSwapFailedLedgerSignError"):e.message.toLowerCase().includes("ledger")?v.t("swapTxConfirmationSwapFailedLedgerError"):null}s(Kb,"parseLedgerError");function Vb({sellSymbol:e,buySymbol:t,error:r,onPress:o}){let n=v.t("unknownToken"),a=`${v.t("swapTxConfirmationSwapFailed")} ${e??n} \u2192 ${t??n}`,c=v.t("commandRetry"),p=v.t("swapTxConfirmationSwapFailedUnknownError"),m=Kb(r);return m&&(p=m),{title:a,message:p,onPress:o,buttonText:c}}s(Vb,"createSwapFailedToast");var Wn=class{static{s(this,"ToastExecuteSwapStateListener")}showFungibleDetails;showBuyFungibleScreen;slippageSettings;supportedCustomSimulationToastErrorTypes;retryAndNavigateToSwapper;toastMessageParser;constructor(t,r,o,n,a,c=lP){this.showFungibleDetails=t,this.showBuyFungibleScreen=r,this.slippageSettings=o,this.supportedCustomSimulationToastErrorTypes=n,this.retryAndNavigateToSwapper=a,this.toastMessageParser=c}onStateChange(t,r,o,n){let{sell:a,buy:c,quote:p}=o.executingQuote;switch(t.type){case j.ExecuteSwapStarted:let m;if(ne(p)){if(x.isBitcoinNetworkID(a.data.chain.id)){jb(v.t("swapBitcoinSellBridgeProgressToast",{estimatedTime:pd(p)}),()=>{this.showFungibleDetails(c)});return}x.isBitcoinNetworkID(c.data.chain.id)?m=v.t("swapBitcoinBuyingToast"):m=v.t("swapInitiatingBridgeToast",{sellSymbol:a.data.symbol,sellChain:a.data.chain.name,buySymbol:c.data.symbol,buyChain:c.data.chain.name})}else Ke(a)||Ke(c)?m=qb(a,c,p,!1):m=v.t("swapSwappingToast",{sellSymbol:a.data.symbol,buySymbol:c.data.symbol});uP(m);break;case j.TransactionConfirmed:jb(this.toastMessageParser.parseTransactionConfirmed(a,c,p),()=>this.showFungibleDetails(c));break;case j.SimulationFailed:Hb(Gb(t.error,o.executingQuote,this.showBuyFungibleScreen,()=>this.handleRetryPress(o.executingQuote),this.slippageSettings,this.supportedCustomSimulationToastErrorTypes));break;case j.TransactionSubmissionFailed:case j.TransactionConfirmationFailed:Hb(Vb({sellSymbol:a.data.symbol,buySymbol:c.data.symbol,error:t.error,onPress:s(()=>this.handleRetryPress(o.executingQuote),"onPress")}));break}}handleRetryPress(t){er.getState().hideToast(),this.retryAndNavigateToSwapper(t)}};function uP(e){er.getState().progress({message:e,onPress:s(()=>{er.getState().hideToast()},"onPress")})}s(uP,"progress");function jb(e,t){er.getState().success({id:"swap-success",message:e,onPress:s(()=>{er.getState().hideToast(),t()},"onPress")})}s(jb,"success");function Hb(e){er.getState().failed(e)}s(Hb,"failed");var lP={parseTransactionConfirmed(e,t,r){return ne(r)?v.t("swapBridgeInitiatedToast",{sellSymbol:e.data.symbol,sellChain:e.data.chain.name,buySymbol:t.data.symbol,buyChain:t.data.chain.name,estimatedTime:pd(r)}):v.t("swapSwappedToast",{sellSymbol:e.data.symbol,buySymbol:t.data.symbol})}};var Jc=class{static{s(this,"ToastsSwapReviewInterceptor")}intercept(t){let{swapper:r,connection:o,storage:n,vaultProxy:a,locale:c,analytics:p,resetSwapper:m,queryClient:d,showFungibleDetails:f,showBuyFungibleScreen:h,swapAnalytics:w,gasEstimation:y,slippageSettings:S,supportedCustomSimulationToastErrorTypes:T,navigateToSwapper:b,storePairs:A,isMobile:k,enableExtSwapCommands:C,authRepository:I,isSimulationKilled:L}=t;if(r.getAccount()?.type===Xm.Ledger||!k&&!C)return"continue";let R=r.getState();if(R.type!==Be.Quote)return"continue";let{quote:H,sell:q,buy:E}=R;return this.isSupportedQuote(H)&&(async()=>{A(q,E);let F=await p.getDeviceId(),z=new Wn(f,h,S,T,st=>{b(st)}),W=new Vn(d,n,I),re=new Kn(w,p),Z=new jn(p),He=new Hn,Le=new Gn(mo);try{r.subscribeExecution(W),r.subscribeExecution(Z),r.subscribeExecution(re),r.subscribeExecution(z),r.subscribeExecution(He),r.subscribeExecution(Le),await r.swap({signer:a,storage:n,locale:c,deviceId:F,connection:o,authRepository:I,isSimulationKilled:L,gasEstimation:y}),m()}catch{}finally{r.unsubscribeExecution(W),r.unsubscribeExecution(Z),r.unsubscribeExecution(re),r.unsubscribeExecution(z),r.unsubscribeExecution(He),r.unsubscribeExecution(Le)}})(),"continue"}isSupportedQuote(t){return Ct(t)||ur(t)||Or(t)||ne(t)}};u();l();var eu=class{static{s(this,"StreamGetSwapQuotesStrategy")}swapper;queryClient;constructor(t,r){this.swapper=t,this.queryClient=r}queryKey;quoteProcessorListener={onStateChange:s((t,r)=>{if(!this.queryKey){console.error("queryKey is not set");return}r.type==="quoteProcessed"&&this.queryClient.setQueryData(this.queryKey,r.response)},"onStateChange")};async fetch(t,r){return this.queryKey=r,this.swapper.unsubscribeQuoteProcessor(this.quoteProcessorListener),new Promise((o,n)=>{let a=pP(t.amount,t.sell,t.buy),c={onStateChange:s((p,m)=>{switch(m.type){case"firstQuoteReceived":o(m.response),this.swapper.unsubscribeQuoteProcessor(c);break;case"error":n(m.error),this.swapper.unsubscribeQuoteProcessor(c),this.swapper.unsubscribeQuoteProcessor(this.quoteProcessorListener);break}},"onStateChange")};this.swapper.subscribeQuoteProcessor(this.quoteProcessorListener),this.swapper.subscribeQuoteProcessor(c),this.swapper.setPair($b(t.buy),$b(t.sell),a),this.swapper.setAmount(a,{slippageTolerance:t.slippageTolerance,slippageType:t.enableAutoSlippage?ce.Auto:ce.Fixed,priorityFee:t.priorityFee,tipAmount:t.tipAmount,preferredProvider:t.preferredProvider})})}stopFetching(){this.swapper.getQuoteProcessorState().type!=="idle"&&(this.swapper.stopProcessingQuotes(),this.swapper.unsubscribeQuoteProcessor(this.quoteProcessorListener))}getFetchInterval(t){return!1}};function pP(e,t,r){let o=e.type==="sell"?t:r;return{amount:new _(e.value).shiftedBy(-o.data.decimals).toString(),perspective:e.type}}s(pP,"normalizeAmount");function $b(e){return{...e,data:{...e.data,walletAddress:""}}}s($b,"removeWalletAddress");u();l();u();l();var tu;(function(e){e.AutoSlippageOptIn="autoSlippageOptIn"})(tu||(tu={}));var ru=class{static{s(this,"AutoSlippageOptInInterceptor")}intercept({hasViewedAutoSlippageOptIn:t,selectedSetting:r,setHasViewedAutoSlippageOptIn:o,showOverlay:n}){return!t&&r!==ce.Auto?(n(tu.AutoSlippageOptIn),o(!0),"interrupt"):"continue"}};u();l();var md=D(B());u();l();var Zb=D(B());u();l();var dP=i.object({swapper:i.number(),review:i.number().nullish().default(null)}),ou={swapper:hn.Short,review:null},Wb=s(()=>{let e=$t.getMultivariateAssignment("swapper-poll-interval-json");if(!e)return ou;try{let t=JSON.parse(e);return dP.parse(t)}catch{return ou}},"getQuotePollIntervalConfig");var ga=s(()=>{let e=fa(n=>n.intervalMs),t=fa(n=>n.state),r=fa(n=>n.setState),o=(0,Zb.useCallback)(n=>{r("resumed",n??Yb())},[r]);return{state:t,pause:s(()=>r("paused"),"pause"),resume:o,intervalMs:e}},"useQuotePoller"),ha=s(e=>{fa.getState().setState("resumed",e??Yb())},"resumePoller"),dd=s(()=>{fa.getState().setState("paused")},"pausePoller"),Yb=s(()=>Wb().swapper,"getDefaultInterval"),fa=Ye(e=>({state:"resumed",intervalMs:ou.swapper,setState(t,r){e(r?{state:t,intervalMs:r}:{state:t})}}));var Xb=s(()=>{let e=(0,md.useCallback)(()=>{ha()},[]),t=(0,md.useCallback)(()=>{dd()},[]);return{onSwapTabEnter:e,onSwapTabExit:t}},"useSwapTabSwitchActions");var Jb=(0,pr.createContext)(void 0),cse=s(({children:e})=>{let t=[ce.Auto,ce.Fixed],r=[be.SlippageExceeded],o=(0,pr.useMemo)(()=>[new ru,new Jc],[]),n=!0,a=je(),c=Qe(),p=(0,pr.useMemo)(()=>To?new eu(a,c):new jc,[a,c]),{onSwapTabEnter:m,onSwapTabExit:d}=Xb(),f=qm("trade-hub-variant"),h=ze("enable-replace-classic-ngs"),w=(0,pr.useMemo)(()=>{if(h||f==="remove-buy-sell")return"remove-buy-sell";if(f==="swapper-modal")return"swapper-modal";if(f==="trade-menu")return"trade-menu"},[f,h]),y=(0,pr.useMemo)(()=>nr?nd("full"):nd("compactNoSymbol"),[]);return pr.default.createElement(Jb.Provider,{value:{slippageSettingTypes:t,reviewInterceptors:o,showStickyCTAButton:n,getSwapQuotesStrategy:p,supportedCustomSimulationToastErrorTypes:r,onSwapTabEnter:m,onSwapTabExit:d,balanceDisplayStrategy:y,tradeHubVariant:w}},e)},"SwapTabProvider"),eT=s(()=>{let e=(0,pr.useContext)(Jb);if(!e)throw new Error("useSwapTab must be used within a SwapTabProvider");return e},"useSwapTab");u();l();var Oo=D(B());u();l();u();l();var mP=i.enum(["pumpFun","moonshot"]),fP=i.object({type:mP,programId:i.string(),name:i.string(),iconUrl:i.string()}),gP=i.object({programs:i.array(fP)}),tT=s(e=>{try{return gP.parse(e)}catch{return}},"parseUgcPrograms");var hP={type:"pumpFun",programId:"6EF8rrecthR5Dkzon8Nwu78hRvfCKubJ14M5uBEwF6P",name:"Pump.fun",iconUrl:"https://dhc7eusqrdwa0.cloudfront.net/assets/pumpfun.svg"},fd=[],jr=s(()=>{try{let e=$t.getMultivariateAssignment("enabled-ugc-programs");if(!e)return $t.isFeatureEnabled("enabled-ugc-programs")?[hP]:fd;let t=JSON.parse(e);return tT(t)?.programs??fd}catch{return fd}},"getSupportedUgcPrograms");var yP=i.object({programId:i.string(),complete:i.boolean(),progress:i.string()}),wP=i.object({bondingCurves:i.record(i.string(),yP)}),tr;(function(e){e.Loading="Loading",e.BondingCurve="BondingCurve",e.BondingCurveRefreshing="BondingCurveRefreshing",e.NoBondingCurve="NoBondingCurve",e.Graduated="Graduated",e.Error="Error"})(tr||(tr={}));function SP(e){let t=rT(e),o=Qe().getQueryData(t.queryKey),{data:n,isFetching:a,isError:c}=ae({...t,initialData:o,staleTime:0}),p=(0,Oo.useMemo)(()=>jr(),[]);return(0,Oo.useMemo)(()=>{let m=o===n;if(a&&!m)return{type:tr.Loading};if(c)return{type:tr.Error};let d=wP.safeParse(n);if(!d.success)return{type:tr.Error};let f=d.data.bondingCurves[e];if(!f)return{type:tr.NoBondingCurve};let h=p.find(y=>y.programId===f.programId);if(!h)return{type:tr.NoBondingCurve};let w=AP(f.progress);return w?f.complete?{type:tr.Graduated,ugcProgram:h}:{type:m&&a?tr.BondingCurveRefreshing:tr.BondingCurve,progressPercentage:w,ugcProgram:h}:{type:tr.Error}},[o,e,n,c,a,p])}s(SP,"useBondingCurveProgress");var bP=s(e=>{let t=Qe(),r=rT(e);return(0,Oo.useCallback)(async()=>{await t.refetchQueries({queryKey:r.queryKey,type:"active"})},[t,r.queryKey])},"useUgcEnabledAwareBondingCurveRefetch"),rT=s(e=>{let t=(0,Oo.useMemo)(()=>jr(),[]),r=(0,Oo.useMemo)(()=>t.map(n=>n.programId),[t]);return{queryKey:["bonding-curve",e,r],queryFn:s(()=>TP(e,r),"queryFn")}},"useQueryOptions"),TP=s(async(e,t)=>{let r=encodeURIComponent(e),o=encodeURIComponent(t.join(","));return(await K.api().get(`/ugc/v1/bonding-curve/${r}/${o}`)).data},"queryFn"),AP=s(e=>{let t=Number(e);if(!isNaN(t))return Math.round(t*100)},"parseProgressPercentage");u();l();var xP="https://help.phantom.com/hc/en-us/articles/33745013398675";u();l();u();l();var sT=D(B());u();l();var EP="swap",kP=s(e=>new yf(e,EP),"createSwapAnalytics"),nu=af(we,e=>kP(e));u();l();function oT(e,t,r){if(!r)return;if(t===ce.Fixed)return r.slippageTolerance;let o=r.quotes[e];if(o)return ne(o)?r.slippageTolerance:Ar(o)?o.slippageTolerance:r.slippageTolerance}s(oT,"parseSlippage");u();l();var su=D(B());var Zn=s(()=>{let{data:e,isFetching:t}=It({key:Ce.LastSubmittedPairs,queryKey:he.lastSubmittedPairs()}),r=(0,su.useMemo)(()=>e??null,[e]),{mutateAsync:o}=Ft({key:Ce.LastSubmittedPairs,queryKey:he.lastSubmittedPairs()}),n=(0,su.useCallback)(async(a,c)=>{await o({sellFungible:nT(a),buyFungible:nT(c)})},[o]);return{pairs:r,isLoading:t,storePairs:n}},"useLastSubmittedPairs");function nT(e){return{...e,data:{...e.data,walletAddress:""}}}s(nT,"removeWalletAddress");var CP=s(({goToConfirmation:e})=>{let t=V(b=>b.sellUsdValue),r=V(b=>b.buyUsdValue),{currentQuote:o,quoteResponse:n,selectedProviderIndex:a,selectedBaseProvider:c}=ot(),p=V(b=>b.sellFungible),m=V(b=>b.buyFungible),d=V(b=>b.swapFilter),{selectedSetting:f}=ao(),{storePairs:h}=Zn(),w=we(),y=nu(),{pause:S}=ga();return(0,sT.useCallback)(()=>{if(!o||!p||!m)return;let b=oT(a,f.type,n);w.capture("swapperSwap");let A=$c({buyToken:m,sellToken:p,sellAssetUsdValue:t,buyAssetUsdValue:r,quote:o,slippageTolerance:b,slippageType:f.type,sellSwapFilter:d,baseProvider:c});A&&(P.addBreadcrumb(O.Swapper,"approved",Y.Info,Yo(A.swap)),y.approved(A)),S(),e(),x.compareNetworkID(p.data.chain.id,m.data.chain.id)===0&&h(p,m)},[o,p,m,a,f.type,n,w,t,r,S,e,y,h,d,c])},"useOnSwap");u();l();var aT=D(B());u();l();var gd=D(B());u();l();function yo(){return Jt.supportedChains.filter(e=>{let t=Jt.get(e);return t.requiredFeatureFlag?Qm(t.requiredFeatureFlag):!0})}s(yo,"useSwapperChains");var Mo=s(()=>{let{data:e}=_e(),t=yo(),r=(0,gd.useMemo)(()=>t.map(o=>x.getMainnetNetworkID(o)),[t]);return(0,gd.useMemo)(()=>_P(e,r),[e,r])},"useSupportedNetworkIDs"),_P=s((e,t)=>[...new Set((e?.addresses??[]).map(r=>r.networkID).filter(r=>t.includes(r)))],"getSupportedNetworkIDs");var hd=s(()=>{let e=Mo(),t=ze("enable-bitcoin-swap");return(0,aT.useCallback)(r=>!t&&r&&x.isBitcoinNetworkID(r)?!1:!!r&&e.includes(r),[e,t])},"useIsSupportedNetworkId");u();l();var cu=D(B());u();l();u();l();var au=class{static{s(this,"SwapperTransitionsStateListener")}onStateChange(t,r,o){Yc(o,t)}};u();l();var iu=class{static{s(this,"SwapperStateMachine")}listeners;constructor(t){this.listeners=t}transition(t,r){try{let o=this.detectNextState(t,r);return this.listeners.forEach(n=>n.onStateChange(r,t,o)),o}catch{return t}}detectNextState(t,r){switch(r.type){case yt.QuoteRequestStarted:return{type:ue.FetchingQuote,buy:r.buy,sell:r.sell,amount:r.amount};case yt.QuoteResponseReceived:switch(t.type){case ue.FetchingQuote:case ue.Quote:case ue.Simulated:case ue.SimulationRequestErrored:case ue.TransactionSubmissionFailed:case ue.TransactionNotConfirmed:let o=r.response.quotes[r.quoteIndex];if(!o)throw new Error("Quote index out of bounds");return{type:ue.Quote,response:r.response,buy:t.buy,sell:t.sell,quote:o};default:throw new Error("Can't transition from this state")}case yt.QuoteSelected:switch(t.type){case ue.Quote:let o=t.response.quotes[r.quoteIndex];if(!o)throw new Error("Quote index out of bounds");return{type:ue.Quote,quote:o,buy:t.buy,sell:t.sell,response:t.response};default:throw new Error("Can only transition to QuoteChanged from Quote")}case yt.SimulationResponseReceived:switch(t.type){case ue.Quote:return r.scannedTransactionResult.error?{type:ue.SimulationFailed,quote:t.quote,buy:t.buy,sell:t.sell,response:t.response,scannedTransactionResult:r.scannedTransactionResult,simulationError:r.scannedTransactionResult.error}:{type:ue.Simulated,quote:t.quote,buy:t.buy,sell:t.sell,response:t.response,scannedTransactionResult:r.scannedTransactionResult};default:throw new Error("Can only transition to Simulated from Simulating")}case yt.SimulationRequestError:switch(t.type){case ue.Quote:return{type:ue.SimulationRequestErrored,buy:t.buy,sell:t.sell,quote:t.quote,response:t.response,error:r.error};default:throw new Error("Can only transition to SimulationRequestErrored from Simulating")}case yt.TransactionSubmissionFailed:switch(t.type){case ue.Simulated:case ue.SimulationFailed:return{type:ue.TransactionSubmissionFailed,quote:t.quote,buy:t.buy,sell:t.sell,response:t.response,scannedTransactionResult:t.scannedTransactionResult,error:r.error};default:throw new Error("Can only transition to SwapSubmitFailed from SubmittingSwap")}case yt.TransactionConfirmationFailed:switch(t.type){case ue.Simulated:return{type:ue.TransactionNotConfirmed,quote:t.quote,buy:t.buy,sell:t.sell,txReceipt:r.txReceipt,response:t.response,scannedTransactionResult:t.scannedTransactionResult,error:r.error};default:throw new Error("Can only transition to TransactionNotConfirmed from ConfirmingTransaction")}}}};var IP=new iu(new Set([new au])),iT=Ye(e=>({state:{type:ue.Idle},transition:s(t=>{e(r=>{let o=r.state;return{state:IP.transition(o,t)}})},"transition")}));var cT=s(()=>{let e=iT(r=>r.state),t=iT(r=>r.transition);return{state:e,transition:t}},"useSwapperState");u();l();var FP=5*60,uT=s(e=>{if(ne(e))return Pe(wn(e));let{sources:t}=e;return Pe(t)},"getProviderLabel"),lT=s(({quotes:e,buyTokenNetworkId:t,buyTokenDecimals:r,buyTokenSymbol:o})=>e.map(n=>{let{buyAmount:a}=n,c=ar.get(t).formDisplayPrecision;return{name:uT(n),amount:`${ir(Ee(a,r),c)} ${o}`}}),"parseSwapProviders"),pT=s(({quotes:e,buyTokenNetworkId:t,buyTokenDecimals:r,buyTokenSymbol:o,networkIDForFees:n,networkFee:a,priceMap:c})=>e.filter(ne).map(p=>{let{buyAmount:m,executionDuration:d,steps:f}=p,w=Gc(p).plus(a),y=f.find(T=>!!T.tool.logoURI),S=ar.get(t).formDisplayPrecision;return{name:uT(p),feeUsd:n&&c?Qt(n,w,c):null,amount:`${ir(Ee(m,r),S)} ${o}`,time:{text:Fr(d),isFast:d<=FP},logoURI:y?.tool.logoURI??""}}),"parseBridgeProviders");u();l();var vP={aggregate(e){return e.reduce((t,r)=>({...t,gasLimit:t.gasLimit.plus(r.gasLimit)}),{networkID:x.ethereum.mainnetID,gasLimit:new U(0),maxFeePerGas:e[0].maxFeePerGas,maxPriorityFeePerGas:e[0].maxPriorityFeePerGas})}},PP={aggregate(e){return e.reduce((t,r)=>({...t,value:t.value+r.value}),{networkID:x.solana.mainnetID,value:0})}},RP={aggregate(e){return e.reduce((t,r)=>({...t,gasBudget:t.gasBudget.plus(r.gasBudget)}),{networkID:x.sui.mainnetID,gasBudget:new U(0)})}},ya=s(e=>{if(!(!e||e.length===0)){if(Va(e[0]))return vP.aggregate(e);if(Ef(e[0]))return PP.aggregate(e);if(kf(e[0]))return RP.aggregate(e)}},"aggregateGasEstimation");function DP({selectQuote:e}){let{quoteResponse:t,isFetchingQuote:r,quotes:o,selectedProviderIndex:n}=ot(),a=V(C=>C.setSelectedProviderIndex),c=V(C=>C.gasEstimation.estimateWithBuffer),p=V(C=>C.sellFungible),m=V(C=>C.buyFungible),d=p?.data.chain.id,{data:f}=ks(d,ya(c)),w=yo().map(C=>hr(C)),{data:y={}}=Jr({query:{data:w}}),S=t?.type==="xchain",T=(0,cu.useMemo)(()=>m?S?pT({quotes:o,buyTokenNetworkId:m.data.chain.id,buyTokenDecimals:m.data.decimals,buyTokenSymbol:m.data.symbol,networkIDForFees:d,networkFee:f?.gasEstimationAmount??new U(0),priceMap:y}):lT({quotes:o,buyTokenNetworkId:m.data.chain.id,buyTokenDecimals:m.data.decimals,buyTokenSymbol:m.data.symbol}):[],[m,S,o,d,f?.gasEstimationAmount,y]),b=we(),{transition:A}=cT(),k=(0,cu.useCallback)(C=>{let I=T[C];b.capture("swapperProviderSelected",{data:{provider:I.name}}),a(C),e(o,C),A({type:yt.QuoteSelected,quoteIndex:C})},[a,T,b,A,o,e]);return{rows:T,selectedProviderIndex:n,isLoadingProviders:r,setSelectedProviderIndex:k}}s(DP,"useSwapProvidersProps");u();l();var pu=D(B());u();l();var mT=D(B());u();l();var dT=D(B());var uu=s(()=>{let e=Qe();return{cancelQuotes:(0,dT.useCallback)(async()=>{await e.cancelQueries({queryKey:he.quotesScope()}),await tf(1)},[e])}},"useSwapCancelQuotes");u();l();function Qo(e,t){return e.data.key===t.data.key}s(Qo,"areFungiblesEqual");function yd(){let e=we(),t=V(n=>n.setBuyFungible),r=V(n=>n.buyFungible),{cancelQuotes:o}=uu();return(0,mT.useCallback)(async n=>{if(r&&Qo(n,r))return;await o();let a=Uo(n);e.capture("swapperUpdateToAsset",{data:a}),t(n)},[e,r,o,t])}s(yd,"useSwapSetBuyAsset");u();l();var uce=s((e,t)=>{lu.getState().setAsset(e,t)},"setUgcSelectedAsset"),lu=Ye(e=>({asset:void 0,onConfirm:void 0,setAsset(t,r){e({asset:t,onConfirm:r})}}));var NP=s(({onClose:e})=>{let t=je(),r=yd(),o=lu(p=>p.asset),n=lu(p=>p.onConfirm),a=(0,pu.useMemo)(()=>jr().find(m=>m.programId===o?.data?.ugcTokenMeta?.programId),[o]),c=(0,pu.useCallback)(async()=>{o&&(t.changeToken(o,"buy"),await r(o),n?.(),e())},[r,t,o,n,e]);return{asset:o,program:a,handleConfirmPress:c}},"useUGCTradeWarningProps");u();l();u();l();var BP=s(()=>{let e=Qe(),t=V();return{clearQuotes:s(async()=>{t.resetQuote(),await e.invalidateQueries({queryKey:he.quotesScope()})},"clearQuotes")}},"useSwapClearQuotes");u();l();var Uce=s(({accountIdentifier:e,networkID:t})=>{let r=Ot(),o=en();return Ao({mutationFn:s(async a=>{let{swapTransactions:c,type:p}=a;if(c.type==="evm"&&p===xe.EVM){let{gasEstimation:m,pendingApprovalActivityRows:d,pendingSwapActivityRows:f}=a,{signature:h,error:w}=await P.startSpan("Process EVM Swap Txns",()=>Ki({transactions:c.transactions,transactionTypes:c.transactionTypes,networkID:t,gasEstimation:m,pendingSwapActivityRows:f,pendingApprovalActivityRows:d,accountIdentifier:e,accountSigner:o,storage:r}));return{networkID:t,chainType:p,id:h,error:w}}else if(c.type==="solana"&&p===xe.Solana){let{callerAddress:m,connection:d,pendingSwapActivityRows:f}=a;if(!d)throw new Error("missing connection");let{signature:h,error:w}=await P.startSpan("Process Solana Swap Txns",()=>ji({callerAddress:m,connection:d,networkID:t,transactions:c.transactions,pendingSwapActivityRows:f,accountIdentifier:e,accountSigner:o,storage:r}));return{networkID:t,chainType:p,id:h,error:w}}else if(c.type==="sui"&&p===xe.Sui){let{callerAddress:m,pendingSwapActivityRows:d}=a,{signature:f,error:h}=await P.startSpan("Process Sui Swap Txns",()=>Zi({callerAddress:m,networkID:t,transactions:c.transactions,pendingSwapActivityRows:d,accountIdentifier:e,accountSigner:o,storage:r}));return{networkID:t,chainType:p,id:f,error:h}}throw new Error("unsupported")},"mutationFn")})},"useSwapFungibles");u();l();u();l();u();l();u();l();var wa;(function(e){e.Fungible="fungible"})(wa||(wa={}));var LP=i.object({type:i.literal(wa.Fungible),data:$f}),fT=i.object({results:i.array(i.any()).transform(e=>e.reduce((t,r)=>{let o=LP.safeParse(r);return o.success&&t.push(o.data),t},[])),prevCursor:i.string().nullish().default(null),nextCursor:i.string().nullish().default(null),hasMore:i.boolean()});async function gT(e){let{query:t,networkIds:r,searchContext:o,supportedNetworkIds:n,pageSize:a=50,cursor:c}=e,p=await K.api().noBearer().headers({"Content-Type":"application/json"}).get("/search/v1",{params:{query:t.trim(),chainIds:r.join(","),platform:Lt,pageSize:a.toString(),searchTypes:wa.Fungible,searchContext:o,...c&&{cursor:c},...n&&{supportedNetworkIds:n.join(",")}}});if(!le(p))throw new Ge({key:"UnknownError"});let m=fT.safeParse(p.data);if(m.success)return m.data;throw new Ge({key:"UnknownError"})}s(gT,"getFungibleSearch");u();l();var hT=s(e=>{let t=e.data,r=Xu(t)??void 0;return{type:t.type,data:{...t.data,tokenAddress:Xu(t)??void 0,key:r}}},"searchResultToFungible");u();l();var UP="search",yT={searchResults:s((e,t,r,o,n)=>[UP,{query:e,networkIds:t,supportedNetworkIds:o,chainAddresses:r,cursor:n}],"searchResults")};u();l();var du;(function(e){e[e.Always=1/0]="Always",e[e.Short=G({minutes:5})]="Short",e[e.Medium=G({minutes:30})]="Medium",e[e.Long=G({hours:1})]="Long",e[e.Never=0]="Never"})(du||(du={}));var mu;(function(e){e[e.Immediate=0]="Immediate",e[e.Short=G({minutes:5})]="Short",e[e.Medium=G({minutes:30})]="Medium",e[e.Long=G({hours:1})]="Long"})(mu||(mu={}));var OP=s(async e=>(await gT(e)).results.map(r=>hT(r)),"queryFn"),Sa=s(({query:e,networkIds:t,enableQuery:r=!0,keepPreviousData:o=!1,searchContext:n,supportedNetworkIds:a,chainAddresses:c,pageSize:p})=>{let m=yT.searchResults(e,t,c,a);return ae({queryKey:m,gcTime:du.Short,staleTime:mu.Short,enabled:r,placeholderData:o?Gm:void 0,queryFn:s(()=>OP({query:e,networkIds:t,searchContext:n,supportedNetworkIds:a,pageSize:p}),"queryFn")})},"useFungibleSearch");u();l();var wd=D(B());function MP({enablePrices:e,enableSorting:t}){let{fungibles:r,isLoadingTokens:o,tokensError:n,refetch:a}=ln({enablePrices:e,enableSorting:t}),c=hd(),p=V(f=>f.sellFungible),m=r.filter(f=>c(f.data.chain.id)&&f.type!==oe.CompressedSPL),d=(0,wd.useMemo)(()=>{if(p){let f=m.findIndex(w=>Qo(w,p)),h=m[f];h&&h.data.amount!==p.data.amount&&(m[f]=p)}return m.filter(f=>f.data.amount!=="0")},[m,p]);return(0,wd.useMemo)(()=>({assets:d,isLoading:o,error:n,refetchTokens:a}),[d,o,n,a])}s(MP,"useSwapSellAssetList");u();l();var Gt=D(B());u();l();var QP=50,wT=s(({includeOwnedAssets:e,sellAsset:t,sellCaip19:r,ownedAssets:o,searchAssets:n})=>{if(!e||!t)return n;let a=s(w=>M(X(w)),"getEncodedCaip19"),c=a(t)??r,p=t.data.chain.id??(r&&We(r).chainId),m=o.filter(w=>a(w)!==c&&x.compareNetworkID(p,w.data.chain.id)===0&&w.type!==oe.CompressedSPL).slice(0,QP-1),d=m.map(w=>[a(w),w]),f=new Map(d),h=n.filter(w=>!f.has(a(w)));return[...m,...h]},"getDisplayedBuyAssets");function qP({enableQuery:e=!0,chainFilter:t,sellCaip19:r}={}){let o=(0,Gt.useMemo)(()=>r?We(r):void 0,[r]),{sellFungible:n,searchQuery:a,setSearchQuery:c,setNumSearchResults:p}=V(),m=za(a,150),{fungibles:d,isLoadingTokens:f,isRefetchingTokens:h,tokensError:w}=ln(),y=Mo(),[S,T]=(0,Gt.useState)(""),{data:b}=_e(),A=(0,Gt.useMemo)(()=>b?.addresses??[],[b]),{data:k,isSuccess:C,isFetching:I,error:L}=Sa({query:m,networkIds:t?[t]:[o?.chainId??n?.data.chain.id??x.solana.mainnetID],enableQuery:e,keepPreviousData:!0,searchContext:"swapper",supportedNetworkIds:y,chainAddresses:A}),Q=!C&&I,R=(0,Gt.useMemo)(()=>d.filter(W=>W.type!==oe.CompressedSPL).map(W=>[M(X(W)),W]),[d]),H=(0,Gt.useMemo)(()=>{let W=Rm(R.map(([Z])=>Z).join("~")),re=$m(W);return Pm(re)},[R]),q=(0,Gt.useMemo)(()=>new Map(R),[H]),E=(0,Gt.useMemo)(()=>{if(!k||k.length===0)return[];T($e());let W=k.reduce((re,Z)=>{let He="";if(Mt(Z.type)){if(n&&Mt(n.type)&&Z.data.chain.id===n.data.chain.id||o&&o.chainId===Z.data.chain.id&&o.resourceType===ee.nativeToken)return re;He=M(hr(x.getChainID(Z.data.chain.id)))}else{if(n&&Z.data.tokenAddress===n.data.tokenAddress&&!t||o&&o.chainId===Z.data.chain.id&&o.resourceType===ee.address&&o.address===Z.data.tokenAddress)return re;He=M(X(Z))}let Le,st=q.get(He);return st&&st.data.balance?Le=st:Le=Z,Le&&re.push(Le),re},[]);return p(W.length),W},[q,k,n,p,t,o]),F=we();(0,Gt.useEffect)(()=>{C&&E.length===0&&F.capture("swapperNullSearchResult",{data:{searchQuery:m}})},[C,E,m,F]);let z=(0,Gt.useMemo)(()=>wT({includeOwnedAssets:!m,sellAsset:n,sellCaip19:r,ownedAssets:d,searchAssets:E}),[m,d,E,n,r]);return(0,Gt.useMemo)(()=>({assets:z,initialFilterKey:t??n?.data.chain.id??o?.chainId,isLoading:f||Q,isFetching:f||Q||h,error:w??L,searchRef:S,setSearchQuery:c,searchQuery:a}),[z,f,Q,h,w,L,n,S,c,o?.chainId,t,a])}s(qP,"useLiveSwapBuyAssetList");u();l();u();l();var ale=s((e,t=9)=>{let r=(e.match(/\./g)||[]).length;return e.endsWith(".")&&r>1?e.substring(0,e.length-1):e.length===0||e.endsWith(".")||e.endsWith("0")?e:new _(e).decimalPlaces(t).toString()},"formatTokenAmountToMaxDecimals");var fu=D(B());u();l();var ST="https://help.phantom.com/hc/en-us/articles/27085326202515";var zP=[.3,.5,1],GP=zP.map(e=>`${e}%`),KP=[...GP,"custom"],VP=[.5,1,2],jP=VP.map(e=>`${e}%`),fle=[...jP,"custom"],gle=KP.length-1,hle=5,yle=2,bT=.1,TT=30,HP=2,wle=s((e,t)=>{if(!e)return;let r=parseFloat(e);if(isNaN(r))return{message:t("swapSettingsCustomInvalidValue"),severity:"critical"};if(r>TT)return{message:t("swapSlippageSettingsCustomMaxError",{maxSlippage:TT}),severity:"critical"};if(r>HP)return{message:t("swapSlippageSettingsHighSlippageWarning"),severity:"warning"};if(r<bT)return{message:t("swapSlippageSettingsCustomMinError",{minSlippage:bT}),severity:"critical"}},"getCustomSlippageError");u();l();var Yn=D(B());var $P={input:{maxLength:10,maxDecimals:6},bounds:{min:1e-6,low:5e-6,high:1,max:5}},kle=s((e,t,r)=>{let o=parseFloat(e);if(isNaN(o))return{message:t("swapSettingsCustomInvalidValue"),severity:"critical"};if(o>r.max)return{message:t("swapPriorityFeeSettingsCustomMaxError",{maxPriorityFee:r.max}),severity:"critical"};if(o<r.min)return{message:t("swapPriorityFeeSettingsCustomMinError",{minPriorityFee:r.min}),severity:"critical"};if(o>r.high)return{message:t("swapPriorityFeeSettingsHighFeeWarning"),severity:"warning"};if(o<r.low)return{message:t("swapPriorityFeeSettingsLowFeeWarning"),severity:"warning"}},"validatePriorityFee"),Cle=s(()=>{let[e,t]=(0,Yn.useState)($P.bounds);return(0,Yn.useEffect)(()=>{s(async()=>{try{let o=await Ha({accounts:[],transactionType:on.Swap});t({min:o.min,low:o.low,high:o.high,max:o.max})}catch(o){P.captureError(o instanceof Error?o:new Error("Unable to fetch priority fee bounds."),O.Swapper)}},"fetchBounds")()},[]),e},"usePriorityFeeBounds");u();l();var Xn=D(B());var WP={input:{maxLength:10,maxDecimals:6},bounds:{min:1e-6,low:5e-6,high:1,max:5}},Dle=s((e,t,r)=>{let o=parseFloat(e);if(isNaN(o))return{message:t("swapSettingsCustomInvalidValue"),severity:"critical"};if(o>r.max)return{message:t("swapTipSettingsCustomMaxError",{maxTip:r.max}),severity:"critical"};if(o<r.min)return{message:t("swapTipSettingsCustomMinError",{minTip:r.min}),severity:"critical"};if(o>r.high)return{message:t("swapTipSettingsHighFeeWarning"),severity:"warning"};if(o<r.low)return{message:t("swapTipSettingsLowFeeWarning"),severity:"warning"}},"validateTip"),Nle=s(()=>{let[e,t]=(0,Xn.useState)(WP.bounds);return(0,Xn.useEffect)(()=>{s(async()=>{try{let o=await Ha({accounts:[],transactionType:on.Swap});t({min:o.min,low:o.low,high:o.high,max:o.max})}catch(o){P.captureError(o instanceof Error?o:new Error("Unable to fetch tip bounds."),O.Swapper)}},"fetchBounds")()},[]),e},"useTipBounds");u();l();var ZP=[rt.lastSubmittedPairs,rt.slippageTolerance],Sd=s(e=>{let t=String(e.queryKey[1]);return ZP.includes(t)},"swapperShouldDehydrateQueryPredicate");u();l();var xT=D(B());u();l();function AT(){return[new bd,new Ad,new Td]}s(AT,"getBuyAmountEditableRules");var bd=class{static{s(this,"SwapAssetEditableRule")}isEditable({sellAsset:t}){return!!t&&x.isSolanaNetworkID(t.data.chain.id)}},Td=class{static{s(this,"CryptoCurrencyDenominationEditableRule")}isEditable({currencyDenomination:t}){return t==="crypto"}},Ad=class{static{s(this,"BridgeSwapAssetEditableRule")}isEditable({sellAsset:t,buyAsset:r}){return!Wt(t?.data.chain.id,r?.data.chain.id)}};var ET=s(({sellAsset:e,buyAsset:t,currencyDenomination:r})=>{let o=ze("enable-swapper-exact-out"),n=(0,xT.useMemo)(()=>AT(),[]);return!t||!o?!1:n.every(a=>a.isEditable({sellAsset:e,buyAsset:t,currencyDenomination:r}))},"useBuyAmountEditableRules");u();l();var xd=class{static{s(this,"NoPriceCurrencyDenominationSwitchSupportRule")}isSupported(t,r,o,n,a){switch(t){case"sell":return!!(o&&a);case"buy":return!1}}},Ed=class{static{s(this,"BuyNotSupportedCurrencyDenominationSwitchSupportRule")}isSupported(t){return t!=="buy"}};function kT(){return[new xd,new Ed]}s(kT,"getCurrencyDenominationSwitchSupportRules");u();l();var UT=D(B());u();l();var CT=D(B());var YP={"Allbridge's fee":"destinationNetwork","Allbridge Liquidity Fee":"liquidityProvider"},_T=s(()=>{let{currentQuote:e}=ot(),{destinationNetworkFee:t,liquidityFee:r}=(0,CT.useMemo)(()=>{function o(a){return a?{amount:new _(a.amount??0),amountUsd:a.amountUSD?parseFloat(a.amountUSD):null,pct:parseFloat(a.percentage??"0")}:fo}s(o,"bridgeFeeToFee");let n=new Map([]);return e&&ne(e)&&(n=e.steps.flatMap(a=>a.includedFeeCosts).reduce((a,c)=>{if(!c)return a;let p=YP[c.name];return p&&a.set(p,c),a},n)),{destinationNetworkFee:o(n.get("destinationNetwork")),liquidityFee:o(n.get("liquidityProvider"))}},[e]);return{destinationNetworkFee:t,liquidityFee:r}},"useBridgeFees");u();l();var IT=D(B());var XP={calculate({currentQuote:e,gasEstimationPriceData:t}){return{amount:(e&&t?.gasEstimationAmount)??new _(0),amountUsd:(e&&t?.gasEstimationPriceUSDNumber)??null,pct:0}}},JP={calculate({currentQuote:e,gasEstimationPriceData:t,priceMap:r,networkID:o}){let n=(e?.fees??[]).find(p=>p.type==="tips"||p.type==="network"&&p.name!=="Token account deposits"),a=(e&&t?.gasEstimationAmount)??new _(0),c=(e&&t?.gasEstimationPriceUSDNumber)??null;if(n&&n.amount&&(a=a.plus(new _(n.amount)),c)){let p=Qt(o,new _(n.amount),r);p&&(c+=p)}return{amount:a,amountUsd:c,pct:0}}},eR={calculate({currentQuote:e,gasEstimationPriceData:t,maxGasEstimationPriceData:r}){return{amount:(e&&t?.gasEstimationAmount)??new _(0),amountUsd:(e&&t?.gasEstimationPriceUSDNumber)??null,maxAmount:(e&&r?.gasEstimationAmount)??new _(0),maxAmountUsd:(e&&r?.gasEstimationPriceUSDNumber)??null,pct:0}}},FT=s(({priceMap:e})=>{let{currentQuote:t}=ot(),r=V(d=>d.sellFungible),o=V(d=>d.gasEstimation),n=r?.data.chain.id??ye.Solana.Mainnet,{data:a,isLoading:c}=ks(n,ya(o.estimate)),{data:p}=ks(n,ya(o.estimateWithBuffer));return{networkFee:(0,IT.useMemo)(()=>x.isEVMNetworkID(n)?eR.calculate({currentQuote:t,gasEstimationPriceData:a,maxGasEstimationPriceData:p}):x.isSolanaNetworkID(n)?JP.calculate({currentQuote:t,gasEstimationPriceData:a,networkID:n,priceMap:e}):XP.calculate({currentQuote:t,gasEstimationPriceData:a}),[t,a,p,n,e]),isFetchingGasEstimationPrice:c}},"useNetworkFee");u();l();var vT=D(B());var tR={calculate(){return fo}},rR={calculate({currentQuote:e,networkID:t,priceMap:r}){let o=Gc(e);return{amount:o,amountUsd:Qt(t,o,r),pct:0}}},PT=s(({priceMap:e})=>{let{currentQuote:t}=ot(),o=V(a=>a.sellFungible)?.data.chain.id??ye.Solana.Mainnet;return{nonIncludedFees:(0,vT.useMemo)(()=>t&&ne(t)?rR.calculate({currentQuote:t,networkID:o,priceMap:e}):tR.calculate(),[o,t,e])}},"useNonIncludedFees");u();l();var RT=D(B());var oR={calculate({currentQuote:e,networkID:t,priceMap:r}){let o=(e?.fees??[]).find(n=>n.name==="Token account deposits");return{amount:new _(o?.amount??0),amountUsd:o?.amount?Qt(t,new _(o.amount),r):null,pct:o?.percentage??0}}},nR={calculate(){return fo}},DT=s(({priceMap:e})=>{let{currentQuote:t}=ot(),o=V(a=>a.sellFungible)?.data.chain.id??ye.Solana.Mainnet;return{tokenAccountFee:(0,RT.useMemo)(()=>Ar(t)?oR.calculate({currentQuote:t,networkID:o,priceMap:e}):nR.calculate(),[t,o,e])}},"useTokenAccountFee");u();l();var NT=D(B());var BT={calculate:s(({tokenAccountFee:e,networkFee:t,nonIncludedFees:r,networkID:o,priceMap:n})=>{let a=e.amount.plus(t.amount).plus(r.amount);return{amount:a,amountUsd:Qt(o,a,n),pct:0}},"calculate")},sR={calculate:s(({tokenAccountFee:e,networkFee:t,nonIncludedFees:r,networkID:o,priceMap:n})=>{let a=BT.calculate({tokenAccountFee:e,networkFee:t,nonIncludedFees:r,networkID:o,priceMap:n}),c=e.amount.plus(t.maxAmount??0).plus(r.amount);return{...a,maxAmount:c,maxAmountUsd:Qt(o,c,n)}},"calculate")},LT=s(({tokenAccountFee:e,networkFee:t,nonIncludedFees:r,priceMap:o})=>{let a=V(p=>p.sellFungible)?.data.chain.id??ye.Solana.Mainnet;return{totalFees:(0,NT.useMemo)(()=>x.isEVMNetworkID(a)?sR.calculate({tokenAccountFee:e,networkFee:t,nonIncludedFees:r,networkID:a,priceMap:o}):BT.calculate({tokenAccountFee:e,networkFee:t,nonIncludedFees:r,networkID:a,priceMap:o}),[t,a,r,o,e])}},"useTotalFees");var aR=s(()=>{let e=V(w=>w.gasEstimation.isFetching),t=yo(),{data:r={}}=Jr({query:{data:t.map(w=>hr(w))}}),{networkFee:o,isFetchingGasEstimationPrice:n}=FT({priceMap:r}),a=e||n,{phantomFee:c}=wb(),{tokenAccountFee:p}=DT({priceMap:r}),{nonIncludedFees:m}=PT({priceMap:r}),{totalFees:d}=LT({tokenAccountFee:p,networkFee:o,nonIncludedFees:m,priceMap:r}),{destinationNetworkFee:f,liquidityFee:h}=_T();return(0,UT.useMemo)(()=>({phantomFee:c,networkFee:o,tokenAccountFee:p,totalFees:d,nonIncludedFees:m,destinationNetworkFee:f,liquidityFee:h,isFetchingFees:a}),[c,o,p,d,m,f,h,a])},"useFees");u();l();var OT=D(B());var iR=s(()=>{let{resume:e}=ga(),t=V(r=>r.resetSwapper);return(0,OT.useCallback)(()=>{e(),t()},[t,e])},"useResetSwapper");u();l();var MT=D(B());function cR(){let e=we(),t=V(h=>h.buyFungible),r=V(h=>h.sellFungible),o=V(h=>h.setBuyFungible),n=V(h=>h.setSellFungible),a=V(h=>h.setSellAmount),c=V(h=>h.setUiSellAmountCryptoInput),p=V(h=>h.resetQuote),m=V(h=>h.setSwapFilter),d=r?.data.amount,{cancelQuotes:f}=uu();return(0,MT.useCallback)(async h=>{if(r&&Qo(h,r)){h&&h.data.amount!==d&&(n(h),m(void 0));return}await f();let w=Uo(h);e.capture("swapperUpdateFromAsset",{data:w}),n(h),m(void 0),t&&r&&Qo(h,t)&&o(r),h&&r?.data.chain.id!==h.data.chain.id&&(p(),o(void 0),a(""),c(""))},[e,t,f,d,p,r,o,a,n,m,c])}s(cR,"useSwapSetSellAsset");u();l();var qo=D(B());u();l();var Hr;(function(e){e.Collapsible="collapsible",e.Static="static"})(Hr||(Hr={}));u();l();var wo=D(B());u();l();u();l();var gu=class{static{s(this,"UgcAwareAssetsSectionAdapter")}sections(t){let r=jr().map(a=>a.programId),o=t.reduce((a,c)=>{if(ei({minimum:ie.Verified,spamStatus:c.data.spamStatus}))return a.verified.push(c),a;if(c.type!==oe.SPL||!c.data.ugcTokenMeta||c.data.ugcTokenMeta.status===Hf.Graduated||!r.includes(c.data.ugcTokenMeta.programId))return a.unverified.push(c),a;let p=c.data.ugcTokenMeta.programId,m=a[p]??[];return m.push(c),a[p]=m,a},{verified:[],unverified:[]}),n=jr().map(a=>{let c=o[a.programId]??[];return{id:a.programId,header:{title:v.t("swapSectionTitleTokens",{section:a.name}),iconUrl:a.iconUrl},data:c,behavior:Hr.Collapsible}});return[{id:"verified",data:o.verified,behavior:Hr.Static},{id:"unverified",header:{title:v.t("swapUnverifiedTokens")},data:o.unverified,behavior:Hr.Collapsible},...n]}};function QT(){return new gu}s(QT,"getBuyAssetsSectionAdapter");var qT=(0,wo.createContext)(void 0),Hde=s(({children:e})=>{let t=(0,wo.useMemo)(()=>QT(),[]);return wo.default.createElement(qT.Provider,{value:{buyAssetSectionAdapter:t}},e)},"SwapAssetSelectProvider"),zT=s(()=>{let e=(0,wo.useContext)(qT);if(!e)throw new Error("useSwapAssetSelect must be used within a SwapAssetSelectProvider");return e},"useSwapAssetSelect");var GT=3;function kd(e){return{id:e.id,data:e.data,...e.header?{header:e.header}:{}}}s(kd,"convertToBaseSection");var uR=s(e=>{let[t,r]=(0,qo.useState)({}),o=(0,qo.useCallback)((c,p)=>r(m=>({...m,[c]:p})),[]),{buyAssetSectionAdapter:n}=zT(),a=(0,qo.useMemo)(()=>n.sections(e),[n,e]);return(0,qo.useMemo)(()=>a.map(c=>{switch(c.behavior){case Hr.Static:return kd(c);case Hr.Collapsible:{if(c.data.length<=GT)return kd(c);let p=t[c.id],m=p?c.data:c.data.slice(0,GT),d=s(()=>o(c.id,!p),"onClick"),f=kd(c);return{...f,header:{...f.header,title:f.header?.title||"",button:{label:p?v.t("commandShowLess"):v.t("commandShowMore"),onClick:d}},data:m}}}}),[a,t,o])},"useSwapAssetCollapsibleSections");u();l();u();l();u();l();var ba=G({days:1}),Cd=G({seconds:5}),KT=G({seconds:30}),kme=G({seconds:30}),Cme=G({seconds:5}),_me=G({seconds:5}),Ime=G({seconds:30}),Fme=G({seconds:2}),vme=G({seconds:10}),VT=s(e=>`/v1/actors-search?query=${encodeURIComponent(e)}`,"actorSearchEndpoint");u();l();var rA=i.object({actors:sr.array()}),nt;(function(e){e.Buy="Buy",e.Sell="Sell",e.WhaleBuy="WhaleBuy",e.WhaleSell="WhaleSell",e.TrendingToken="TrendingToken",e.TokenFollow="TokenFollow",e.SuggestedFollow="SuggestedFollow",e.TopActorList="TopActorList",e.AggregatedBuy="AggregatedBuy",e.AggregatedSell="AggregatedSell",e.RecommendedToken="RecommendedToken",e.TopTraderActivity="TopTraderActivity",e.TokenCategory="TokenCategory",e.TopTraderBuySell="TopTraderBuySell",e.HighlightedTrade="HighlightedTrade",e.SuggestedTopTraders="SuggestedTopTraders"})(nt||(nt={}));var lR=i.object({type:i.literal("followers")}),pR=i.object({type:i.literal("actor"),id:i.string()}),dR=i.union([lR,pR]),rr=i.object({actorId:i.string(),id:i.string(),published:i.coerce.string(),storyType:i.nativeEnum(nt),destinations:i.array(dR)}),oA=rr.extend({chainId:dt}),Ta=oA.extend({storyType:i.literal(nt.Buy),tokenBoughtAmount:i.string().nullish(),tokenBoughtUsdValue:i.string().nullish(),tokenBoughtPrice:i.string().nullish(),tokenBoughtAddress:i.string()}),Aa=oA.extend({storyType:i.literal(nt.Sell),tokenSoldAmount:i.string().nullish(),tokenSoldUsdValue:i.string().nullish(),tokenSoldPrice:i.string().nullish(),tokenSoldAddress:i.string()}),mR=Ta.extend({storyType:i.literal(nt.WhaleBuy)}),fR=Aa.extend({storyType:i.literal(nt.WhaleSell)}),gR=rr.extend({storyType:i.literal(nt.TrendingToken),chainId:dt,tokenAddress:i.string(),tokenLogoUrl:i.string(),tokenMarketCap:i.string(),tokenName:i.string(),tokenPrice:i.string(),tokenPriceChange:i.string(),tokenRank:i.string(),tokenSymbol:i.string(),tokenVolume:i.string(),tokenVolumeChange:i.string()}),hR=rr.extend({storyType:i.literal(nt.SuggestedFollow),suggestedActorId:i.string(),mutualFollowsCount:i.number(),mutualFollowsIds:i.array(i.string())}),yR=rr.extend({storyType:i.literal(nt.TokenFollow),tokenId:i.string(),otherTokenFollowers:i.array(i.string())}),wR=i.object({actorId:i.string(),percentChange:i.number()}),SR=rr.extend({storyType:i.literal(nt.TopActorList),items:i.array(wR),listName:i.string()}),nA=rr.extend({chainId:dt,tokenAddress:i.string()}),bR=nA.extend({storyType:i.literal(nt.AggregatedBuy),tokenBuyStories:i.array(Ta)}),TR=nA.extend({storyType:i.literal(nt.AggregatedSell),tokenSellStories:i.array(Aa)}),AR=rr.extend({storyType:i.literal(nt.RecommendedToken),chainId:dt,tokenAddress:i.string()}),sA=i.object({type:i.enum(["buy","sell"]),chainId:dt,tokenAddress:i.string(),published:i.coerce.string()}),xR=rr.extend({storyType:i.literal(nt.TopTraderActivity),rank:i.coerce.number(),trades:i.array(sA),percentChange:i.number()}),ER={TopGainers:"top-gainers"},kR=i.union([i.literal(ER.TopGainers),i.string()]).transform(e=>e),CR=rr.extend({storyType:i.literal(nt.TokenCategory),categoryId:kR,name:i.string(),imageUrl:i.string(),tokenIds:i.array(i.string())}),_R=rr.extend({storyType:i.literal(nt.TopTraderBuySell),rank:i.coerce.number(),percentChange:i.number(),trade:i.union([Ta,Aa])}),_d;(function(e){e.TopMiss="topMiss",e.TopSave="topSave",e.TopLoss="topLoss",e.TopWin="topWin"})(_d||(_d={}));var IR=rr.extend({storyType:i.literal(nt.HighlightedTrade),chainId:dt,tokenAddress:i.string(),category:i.nativeEnum(_d),categoryRank:i.number(),tradeType:i.enum(["buy","sell"]),trade:i.union([Ta,Aa])}),FR=i.object({actorId:i.string(),rank:i.coerce.number(),percentChange:i.number(),evaluationWindow:i.enum(["24h","1w"]),trades:i.array(sA)}),vR=rr.extend({storyType:i.literal(nt.SuggestedTopTraders),traders:i.array(FR)}),Qme=i.union([Ta,Aa,mR,fR,gR,yR,hR,SR,bR,TR,AR,xR,CR,_R,IR,vR]),hu;(function(e){e.TokenMetadataV2="TokenMetadataV2",e.Actor="Actor"})(hu||(hu={}));var PR=Wf.pick({name:!0,symbol:!0,decimals:!0,logoUri:!0,extraMetadata:!0,price:!0}),aA=i.object({id:i.string(),type:i.string()}),Fd=aA.extend({type:i.literal(hu.TokenMetadataV2),attributes:PR}),RR=aA.extend({type:i.literal(hu.Actor),attributes:sr});var jT;(function(e){e.SUGGESTED="suggested",e.BY_LIST="by-list"})(jT||(jT={}));var HT;(function(e){e.EXPLORE="explore",e.ONBOARDING="onboarding",e.PROFILE="profile",e.TOKEN="token"})(HT||(HT={}));var $T;(function(e){e.TOP_PNL_1W="top_pnl_1w",e.TOP_PNL_1M="top_pnl_1m",e.SOCIAL_ONBOARDING="social_onboarding"})($T||($T={}));var yu;(function(e){e.PNL="pnl",e.PNL_BY_TOKEN="pnl-by-token",e.FOLLOWS_YOU="follows-you",e.SEND_INTERACTION="send-interaction"})(yu||(yu={}));var iA=i.object({actorId:i.string()}),DR=iA.extend({type:i.literal(yu.PNL),percentChange:i.number().optional()}),NR=iA.extend({type:i.literal(yu.PNL_BY_TOKEN),caip19:ju,percentChange:i.number().optional()}),BR=i.discriminatedUnion("type",[DR,NR]),qme=i.object({items:BR.array().default([]),included:RR.array().default([]),next:i.string().nullish()}),zme=i.object({data:i.string().array().default([]),included:Fd.array().default([])}),Gme=i.object({data:i.string().array().default([]),meta:i.object({model:i.string()}),included:Fd.array().default([])}),Kme=i.object({orderedItems:sr.array().default([]),next:i.string().optional()}),Vme=i.object({orderedItems:sr.array().default([]),next:i.string().optional()}),jme=i.object({orderedItems:sr.array().default([]),next:i.string().optional()}),WT;(function(e){e.ABUSE_AND_HARASSMENT="abuse_and_harassment",e.PRIVACY_AND_IMPERSONATION="privacy_and_impersonation",e.SPAM="spam"})(WT||(WT={}));var Hme=i.object({orderedItems:sr.array().default([]),next:i.string().optional()}),$me=i.object({orderedItems:sr.array().default([]),next:i.string().optional()}),LR=i.object({id:i.string(),username:i.string(),icon:i.string().nullish()}),Wme=i.object({followingHolders:LR.array().default([])}),UR=i.object({targetId:i.string(),actorId:i.string(),type:i.string(),content:i.string()}),OR=i.object({targetId:i.string(),content:i.string(),type:i.string(),count:i.number({coerce:!0})});function MR(e,t){return e==="emoji"&&vd.includes(t)}s(MR,"canUseReactionCount");var QR=UR.transform(e=>({...e,content:vd.includes(e.content)?e.content:te.Eyes})),Zme=i.object({reactions:i.array(QR),counts:i.array(OR).transform(e=>e.filter(t=>MR(t.type,t.content))).optional()}),Yme=i.object({actors:sr.array().default([]),nextCursor:i.string().optional()}),te;(function(e){e.Bear="\u{1F43B}",e.Bull="\u{1F402}",e.CashFlying="\u{1F4B8}",e.Celebrate="\u{1F389}",e.ChartDown="\u{1F4C9}",e.ChartUp="\u{1F4C8}",e.Coin="\u{1FA99}",e.Cool="\u{1F60E}",e.CreditCard="\u{1F4B3}",e.CryLaughing="\u{1F602}",e.Crying="\u{1F62D}",e.DevilHappy="\u{1F608}",e.DevilMad="\u{1F47F}",e.Diamond="\u{1F48E}",e.Disgusted="\u{1F922}",e.Distressed="\u{1F62B}",e.Eggplant="\u{1F346}",e.Expressionless="\u{1F611}",e.Eyes="\u{1F440}",e.Fire="\u{1F525}",e.Flag="\u{1F3C1}",e.HeartEyes="\u{1F60D}",e.Heart="\u2764\uFE0F",e.Mad="\u{1F620}",e.MiddleFinger="\u{1F595}",e.MoneyBag="\u{1F4B0}",e.Moon="\u{1F319}",e.OkHand="\u{1F44C}",e.OpenMouth="\u{1F62E}",e.Peace="\u270C\uFE0F",e.Peach="\u{1F351}",e.PointUp="\u{1F446}",e.PileOfPoo="\u{1F4A9}",e.Pray="\u{1F64F}",e.Rocket="\u{1F680}",e.Siren="\u{1F6A8}",e.Skull="\u{1F480}",e.SmileWithTear="\u{1F972}",e.Smile="\u{1F600}",e.StopSign="\u{1F6D1}",e.Surprised="\u{1F632}",e.SweatDrops="\u{1F4A6}",e.Ufo="\u{1F6F8}",e.UpsideDownFace="\u{1F643}",e.Whale="\u{1F40B}"})(te||(te={}));var vd=[te.CryLaughing,te.Disgusted,te.Mad,te.Distressed,te.HeartEyes,te.OpenMouth,te.SmileWithTear,te.UpsideDownFace,te.Smile,te.Crying,te.Surprised,te.Expressionless,te.Cool,te.DevilHappy,te.DevilMad,te.Skull,te.Eyes,te.Diamond,te.Fire,te.Eggplant,te.Peach,te.CreditCard,te.Heart,te.SweatDrops,te.Coin,te.Siren,te.MoneyBag,te.PileOfPoo,te.Celebrate,te.OkHand,te.MiddleFinger,te.PointUp,te.Peace,te.Pray,te.Rocket,te.Ufo,te.Moon,te.ChartUp,te.ChartDown,te.Flag,te.StopSign,te.Bear,te.Bull,te.CashFlying,te.Whale],wu;(function(e){e.Image="image",e.Emoji="emoji"})(wu||(wu={}));var Id;(function(e){e.Circle="circle",e.Square="square"})(Id||(Id={}));var qR=i.object({type:i.literal(wu.Image),imageUrl:i.string(),shape:i.nativeEnum(Id)}),zR=i.object({type:i.literal(wu.Emoji),unicode:i.string()}),GR=i.discriminatedUnion("type",[qR,zR]),Su;(function(e){e.Reaction="reaction",e.Icon="icon"})(Su||(Su={}));var KR=i.object({type:i.literal(Su.Reaction),content:i.string()}).transform((e,t)=>{let r=e.content;return vd.includes(r)?{...e,content:r}:(t.addIssue({code:i.ZodIssueCode.custom,message:`Not a supported reaction ${r}`}),i.NEVER)}),VR=i.object({type:i.literal(Su.Icon),icon:i.string(),size:i.number(),backgroundColor:i.string(),foregroundColor:i.string()}),jR=i.union([KR,VR]),HR=i.object({start:i.number(),length:i.number()}),Jn;(function(e){e.Profile="profile",e.Story="story",e.Token="token",e.Dapp="dapp"})(Jn||(Jn={}));var $R=i.object({type:i.literal(Jn.Profile),profileId:i.string()}),WR=i.object({type:i.literal(Jn.Story),storyId:i.string()}),ZR=i.object({type:i.literal(Jn.Token),tokenId:ju}),YR=i.object({type:i.literal(Jn.Dapp),dappId:i.string()}),XR=i.discriminatedUnion("type",[$R,WR,ZR,YR]),JR=i.object({data:i.record(i.string(),i.any()),event:i.string()}),Xme=i.object({id:i.string(),startImage:GR.array(),startImageBadge:jR,text:i.string(),highlight:HR.array(),action:XR,isRead:i.boolean(),published:i.coerce.string(),onActionAnalytics:JR}),Jme=i.object({isFollowing:i.boolean()}),ZT;(function(e){e.Blocking="blocking",e.Chat="chat",e.Deeplink="deeplink",e.Feed="feed",e.Followers="followers",e.FollowRequest="followRequest",e.ManageAccounts="manageAccounts",e.Notifications="notifications",e.Nux="nux",e.Onboarding="onboarding",e.PerpsLeaderboard="perpsLeaderboard",e.ReactionsDetails="reactionsDetails",e.Search="search",e.SuggestedFollows="suggestedFollows",e.SuggestedFollowsByList="suggestedFollowsByList"})(ZT||(ZT={}));var YT;(function(e){e.FeedTab="feed",e.Profile="profile",e.ShareStory="shareStory"})(YT||(YT={}));var efe=i.object({channelType:i.string(),channelId:i.string(),enabled:i.boolean()}),e1=i.object({userId:i.string(),username:i.string(),text:i.string(),createdAt:i.coerce.string()}),t1=i.object({id:i.string(),name:i.string(),image:i.string().nullish()}),tfe=i.object({channelId:i.string(),watcherCount:i.number(),watchers:i.array(t1).default([]),lastMessages:i.array(e1)}),cA=i.object({color:i.string(),icon:i.string(),name:i.string(),requirement:i.number()}),rfe=i.object({quantity:i.number(),quantityString:i.string(),decimals:i.number(),price:i.number().nullish(),badge:cA.nullish()}),r1=i.object({profileId:i.string(),username:i.string(),quantity:i.number()}),ofe=i.object({channelId:i.string(),leaderboard:i.array(r1)}),nfe=i.object({badges:i.array(cA)}),XT;(function(e){e.Buy="buy",e.Sell="sell",e.BadgeUnlocked="badge_unlocked"})(XT||(XT={}));var o1=i.object({id:i.string(),tokenId:i.string(),createdAt:i.string(),updatedAt:i.string()}),sfe=i.object({data:i.array(o1),included:Fd.array().default([])}),afe=i.object({channelId:i.string(),tokenId:i.string(),channelType:i.string(),watcherCount:i.number()}),JT;(function(e){e.TokenPage="tokenPage",e.TrendingList="trendingList",e.RecentList="recentList",e.Banner="banner",e.Notification="notification"})(JT||(JT={}));var eA;(function(e){e.Chat="chat",e.Badges="badges"})(eA||(eA={}));var n1=i.object({profileId:i.string(),userId:i.string(),username:i.string(),icon:Wm}),s1=i.object({accountValueUsd:i.number(),pnlUsd:i.number(),roiPct:i.number(),volumeUsd:i.number()}),tA=i.object({rank:i.number(),isViewer:i.boolean(),actor:n1,performance:s1}),ife=i.object({leaderboard:i.array(tA),viewer:tA.nullish()}),cfe=i.object({accountValueUsd:i.number(),pnlUsd:i.number(),roiPct:i.number(),volumeUsd:i.number(),error:i.string().optional()});u();l();var es=s(({name:e,response:t,current:r,target:o})=>{let n=`Failed to ${e}: 
`,a=[r!==void 0?`Current: ${r}`:null,o!==void 0?`Target: ${o}`:null].filter(Boolean);return a.length>0&&(n+=`${a.join(" | ")} 
`),n+=`${t.status} ${t.statusText} 
`,n+=`${JSON.stringify(t.data)}`,n},"getFetcherErrorMessage"),uA=s(({name:e,error:t,current:r,target:o})=>{let n=`Failed to parse ${e}: 
`,a=[r!==void 0?`Current: ${r}`:null,o!==void 0?`Target: ${o}`:null].filter(Boolean);return a.length>0&&(n+=`${a.join(" | ")} 
`),n+=`${JSON.stringify(t)}`,n},"getParserErrorMessage");var lA=s(async e=>{P.addBreadcrumb(O.Network,"User is searching for actors.",Y.Info,{query:e});let t=await K.api().bearer(!0).get(VT(e));if(!le(t)){let o=new Error(es({name:"searchForActor",response:t}));throw P.captureError(o,O.UserSearch),o}let r=rA.safeParse(t.data);return r.success?{actors:r.data.actors}:{actors:[]}},"searchForActor");u();l();u();l();function pA(e){let t=e.match(/\/v1\/actors\/([^/]+)/)?.[1];return t?Ma.parse(t):void 0}s(pA,"userProfileIdFromUrl");u();l();function dA(e){return pA(e)??Ma.parse(e)}s(dA,"userProfileIdFromUrlOrProfileId");u();l();var de="social",me="@phantom/social",Pr={actor(e){return[de,`${me}:actor`,{profileId:e}]},actorAndFollowers(e){return[de,`${me}:actor-and-followers`,{profileId:e}]},actorAndFollowing(e){return[de,`${me}:actor-and-following`,{profileId:e}]},userProfileByUsernameOrUserProfileId(e){return[de,`${me}:user-profile-by-username-or-user-profile-id`,{usernameOrUserProfileId:e}]},followUser(e,t){return[de,`${me}:follow-user`,{currentId:e,targetId:t}]},followingTokens(e){return[de,`${me}:following-tokens`,{limit:e}]},feed(e,t,r){return[de,`${me}:feed`,{profileId:e,userEnabledNetworks:t,viewFeedAsUsername:r}]},feedStory(e){return[de,`${me}:feed-story`,{storyId:e}]},notifications(e){return[de,`${me}:notifications`,{profileId:e}]},searchForActorBase(){return[de,`${me}:search`]},searchForActor(e){return[de,`${me}:search`,{query:e}]},followRequests(e){return[de,`${me}:follow-requests`,{profileId:e}]},suggestedActors(e,t){return[de,`${me}:suggested-follows`,{profileId:t,source:e}]},actorList(e,t,r){return[de,`${me}:actor-list`,{profileId:r,listName:t,source:e}]},blocking(e){return[de,`${me}:blocking`,{profileId:e}]},pendingFollowRequests(e,t){return[de,`${me}:pending-follow-requests`,{profileId:e,targetId:t}]},reaction(e){return e?[de,`${me}:reaction`,{targetId:e}]:[de,`${me}:reaction`]},reactionDetails(e){return e.targetId?[de,`${me}:reaction-details`,e]:[de,`${me}:reaction-details`,{content:e.content}]},followingHolders(e,t){return[de,`${me}:following-holders`,{profileId:e,caip19:t}]},tokenFollows(e,t){return[de,`${me}:token-follows`,{profileId:e,caip19:t}]},reportedFeedTokens(){return[de,`${me}:reported-feed-tokens`]},userProfileFeed(e,t){return[de,`${me}:user-profile-feed`,{username:e,userEnabledNetworks:t}]},feedEnabledBeta(){return[de,`${me}:feed-enabled-beta`]},tokenChatEnabled(e){return[de,`${me}:token-chat-enabled`,{caip19:e}]},tokenChatStats(e){return[de,`${me}:token-chat-stats`,{caip19:e}]},tokenChatBalance(e,t){return[de,`${me}:token-chat-balance`,{caip19:e,userId:t}]},chatLeaderboard(e){return[de,`${me}:chat-leaderboard`,{caip19:e}]},tokensForYou(e,t){return[de,`${me}:tokens-for-you`,{profileId:t,limit:e}]},similarTokens(e,t,r){return[de,`${me}:similar-tokens`,{caip19:e,profileId:r,limit:t}]},popularChats(){return[de,`${me}:popular-chats`]},chatChannel(e,t){return[de,`${me}:chat-channel`,{channelType:e,channelId:t}]},perpsLeaderboard(e,t){return[de,`${me}:perps-leaderboard`,{limit:e,windowPeriod:t}]},perpsPortfolio(e,t){return[de,`${me}:perps-portfolio`,{windowPeriod:e,userId:t}]},badgeStatus(e){return[de,`${me}:badge-status`,{caip19:e}]}};var mA=s((e,t)=>{let r=dA(t.id);r&&e.setQueryData(Pr.actor(r),t)},"setActorInQueryCache");var fA=s(async(e,t)=>{let r=t?.startsWith("@")?t.slice(1):t;if(!r)throw new Error("No sanitized username or user profile id");let o=await e.getUserProfileByUsernameOrUserProfileId(r);if(!o)throw new Error("No user profile");return o},"getUserProfileByUsernameOrUserProfileIdQueryFn");function a1({usernameOrUserProfileId:e}){let t=cf(),r=Pr.userProfileByUsernameOrUserProfileId(e);return ae({enabled:!!e,queryKey:r,queryFn:s(async()=>fA(t,e),"queryFn"),gcTime:ba,staleTime:Cd})}s(a1,"useGetUserProfileByUsernameOrUserProfileId");function i1({query:e}){let t=Qe(),r=e?.startsWith("@")?e.slice(1).trim():e.trim(),o=Pr.searchForActor(r),n=s(async()=>{let{actors:a}=await lA(r);for(let c of a)mA(t,c);return a.sort((c,p)=>c.isFollowing?-1:p.isFollowing?1:0),{actors:a}},"queryFn");return La({enabled:r.length>1,queryKey:o,queryFn:n,gcTime:ba,staleTime:Cd})}s(i1,"useSearchForActor");u();l();u();l();u();l();async function gA(e){let t=await K.api().bearer(!0).headers({Accept:"application/activity+json"}).get(`/v1/actors/${e}`);if(!le(t)){let o=new Error(es({name:"getActor",response:t,target:e}));throw P.captureError(o,O.Profiles),o}let r=sr.safeParse(t.data);if(r.success)return r.data;{let o=new Error(uA({name:"getActor",error:r.error,target:e}));throw P.captureError(o,O.Profiles),o}}s(gA,"getActor");function Pd(e){let t=s(async()=>{if(!e)throw new Error("No profile ID or access token");return gA(e)},"queryFn");return La({queryKey:Pr.actor(e),queryFn:t,enabled:!!e,gcTime:ba,staleTime:KT})}s(Pd,"useGetActor");u();l();u();l();u();l();var EA=D(xA(),1),kA=EA.default;var m1=kA.bind({concatArrays:!0,ignoreUndefined:!0});function f1(e,t){let r=self.localStorage.getItem(e);if(r){let o=JSON.parse(r),n=JSON.parse(t),a=JSON.stringify(m1(o,n));self.localStorage.setItem(e,a)}else self.localStorage.setItem(e,t)}s(f1,"mergeLocalStorageItem");function os(e,t){return new Promise((r,o)=>{try{let n=e();t?.(null,n),r(n)}catch(n){t?.(n),o(n)}})}s(os,"createPromise");function Au(e,t,r){return Promise.all(e).then(o=>{let n=r?.(o)??null;return t?.(null,n),Promise.resolve(n)},o=>(t?.(o),Promise.reject(o)))}s(Au,"createPromiseAll");var xa={getItem:s((e,t)=>os(()=>self.localStorage.getItem(e),t),"getItem"),setItem:s((e,t,r)=>os(()=>self.localStorage.setItem(e,t),r),"setItem"),removeItem:s((e,t)=>os(()=>self.localStorage.removeItem(e),t),"removeItem"),mergeItem:s((e,t,r)=>os(()=>f1(e,t),r),"mergeItem"),clear:s(e=>os(()=>self.localStorage.clear(),e),"clear"),getAllKeys:s(e=>os(()=>{let t=self.localStorage.length,r=[];for(let o=0;o<t;o+=1){let n=self.localStorage.key(o)||"";r.push(n)}return r},e),"getAllKeys"),flushGetRequests:s(()=>{},"flushGetRequests"),multiGet:s((e,t)=>{let r=e.map(n=>xa.getItem(n));return Au(r,t,s(n=>n.map((a,c)=>[e[c],a]),"processResult"))},"multiGet"),multiSet:s((e,t)=>{let r=e.map(o=>xa.setItem(o[0],o[1]));return Au(r,t)},"multiSet"),multiRemove:s((e,t)=>{let r=e.map(o=>xa.removeItem(o));return Au(r,t)},"multiRemove"),multiMerge:s((e,t)=>{let r=e.map(o=>xa.mergeItem(o[0],o[1]));return Au(r,t)},"multiMerge")},Dd=xa;u();l();var CA=Dd;u();l();var g1=Object.defineProperty,_A=Object.getOwnPropertySymbols,h1=Object.prototype.hasOwnProperty,y1=Object.prototype.propertyIsEnumerable,IA=s((e,t,r)=>t in e?g1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,"__defNormalProp"),ns=s((e,t)=>{for(var r in t||(t={}))h1.call(t,r)&&IA(e,r,t[r]);if(_A)for(var r of _A(t))y1.call(t,r)&&IA(e,r,t[r]);return e},"__spreadValues"),xu=s(e=>t=>{try{let r=e(t);return r instanceof Promise?r:{then(o){return xu(o)(r)},catch(o){return this}}}catch(r){return{then(o){return this},catch(o){return xu(o)(r)}}}},"toThenable"),FA=s((e,t)=>(r,o,n)=>{let a=ns({getStorage:s(()=>localStorage,"getStorage"),serialize:JSON.stringify,deserialize:JSON.parse,partialize:s(b=>b,"partialize"),version:0,merge:s((b,A)=>ns(ns({},A),b),"merge")},t);(a.blacklist||a.whitelist)&&console.warn(`The ${a.blacklist?"blacklist":"whitelist"} option is deprecated and will be removed in the next version. Please use the 'partialize' option instead.`);let c=!1,p=new Set,m=new Set,d;try{d=a.getStorage()}catch{}if(d)d.removeItem||console.warn(`[zustand persist middleware] The given storage for item '${a.name}' does not contain a 'removeItem' method, which will be required in v4.`);else return e((...b)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),r(...b)},o,n);let f=xu(a.serialize),h=s(()=>{let b=a.partialize(ns({},o()));a.whitelist&&Object.keys(b).forEach(C=>{var I;!((I=a.whitelist)!=null&&I.includes(C))&&delete b[C]}),a.blacklist&&a.blacklist.forEach(C=>delete b[C]);let A,k=f({state:b,version:a.version}).then(C=>d.setItem(a.name,C)).catch(C=>{A=C});if(A)throw A;return k},"setItem"),w=n.setState;n.setState=(b,A)=>{w(b,A),h()};let y=e((...b)=>{r(...b),h()},o,n),S,T=s(()=>{var b;if(!d)return;c=!1,p.forEach(k=>k(o()));let A=((b=a.onRehydrateStorage)==null?void 0:b.call(a,o()))||void 0;return xu(d.getItem.bind(d))(a.name).then(k=>{if(k)return a.deserialize(k)}).then(k=>{if(k)if(typeof k.version=="number"&&k.version!==a.version){if(a.migrate)return a.migrate(k.state,k.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return k.state}).then(k=>{var C;return S=a.merge(k,(C=o())!=null?C:y),r(S,!0),h()}).then(()=>{A?.(S,void 0),c=!0,m.forEach(k=>k(S))}).catch(k=>{A?.(void 0,k)})},"hydrate");return n.persist={setOptions:s(b=>{a=ns(ns({},a),b),b.getStorage&&(d=b.getStorage())},"setOptions"),clearStorage:s(()=>{var b;(b=d?.removeItem)==null||b.call(d,a.name)},"clearStorage"),rehydrate:s(()=>T(),"rehydrate"),hasHydrated:s(()=>c,"hasHydrated"),onHydrate:s(b=>(p.add(b),()=>{p.delete(b)}),"onHydrate"),onFinishHydration:s(b=>(m.add(b),()=>{m.delete(b)}),"onFinishHydration")},T(),S||y},"persist");u();l();u();l();var w1=10,vA={chatJoinTimestamps:new Map,chatHistory:[]},S1=Ye(FA((e,t)=>({...vA,recordChatJoin:s(r=>{e(o=>{let n=new Map(o.chatJoinTimestamps);n.set(r,Date.now());let a=[{chatId:r,lastJoinedTimestamp:Date.now()},...o.chatHistory.filter(c=>c.chatId!==r)].slice(0,w1);return{chatJoinTimestamps:n,chatHistory:a}})},"recordChatJoin"),recordChatLeave:s(r=>{e(o=>{let n=new Map(o.chatJoinTimestamps);return n.delete(r),{chatJoinTimestamps:n}})},"recordChatLeave"),clearChatHistory:s(()=>{e(r=>({...r,chatHistory:[]}))},"clearChatHistory"),removeChatFromHistory:s(r=>{e(o=>({...o,chatHistory:o.chatHistory.filter(n=>n.chatId!==r)}))},"removeChatFromHistory"),reset:s(()=>e(vA),"reset")}),{name:"chat-activity",getStorage:s(()=>CA,"getStorage"),partialize:s(e=>({chatHistory:e.chatHistory}),"partialize")})),PA=s(e=>S1.getState().chatJoinTimestamps.get(e),"getChatJoinTimestamp");var Nd=s(async({chatTokenId:e,transactionId:t,tokenBoughtCaip19:r,tokenBoughtAmount:o,tokenBoughtUsdValue:n,tokenSoldCaip19:a,tokenSoldAmount:c,tokenSoldUsdValue:p,walletCaip19:m,chatTokenBalance:d,system:f})=>{if(!PA(e))return;let w=await K.api().bearer(!0).post("/social/v1/events/trades",{chatTokenId:e,tokenBoughtCaip19:r,tokenBoughtAmount:o,tokenBoughtUsdValue:n,tokenSoldCaip19:a,tokenSoldAmount:c,tokenSoldUsdValue:p,transactionId:t,walletCaip19:m,chatTokenBalance:d,system:f});if(!le(w)){let y=new Error(es({name:"publishSystemChatTradeMessage",response:w}));throw P.captureError(y,O.Chat),y}},"publishSystemChatTradeMessage");u();l();var b1=s(e=>{let{data:t}=Pd(e);return RA(t)},"useFollowersAndFollowingCount"),RA=s(e=>{let t={followers:e?.followers&&typeof e.followers=="object"&&e?.followers?.totalItems||0,following:e?.following&&typeof e.following=="object"&&e?.following?.totalItems||0};return{...t,formattedFollowers:cn(t.followers||0,{compact:!0}),formattedFollowing:cn(t.following||0,{compact:!0})}},"getFollowersAndFollowingCount");u();l();u();l();u();l();var DA=D(B());var Bd=s(()=>{let{data:[e]}=Ht(["enable-perps"]),{data:t}=_e(),r=(0,DA.useMemo)(()=>t?.addresses.some(o=>x.isEVMNetworkID(o.networkID))??!1,[t]);return e&&r},"useIsPerpsSupported");u();l();var NA;(function(e){e.BID="B",e.ASK="A"})(NA||(NA={}));var BA;(function(e){e.OPEN="open",e.FILLED="filled",e.CANCELED="canceled",e.TRIGGERED="triggered",e.REJECTED="rejected",e.MARGIN_CANCELED="margin_canceled"})(BA||(BA={}));var Ld=i.string().regex(/^\d*\.?\d+$/,"Invalid numeric string"),Ea=i.string().regex(/^-?\d*\.?\d+$/,"Invalid signed numeric string");u();l();var T1=Um.extend({chainId:Nm,address:i.string()}),LA=i.object({symbol:i.string(),name:i.string(),token:T1,logoUri:i.string(),szDecimals:i.number(),maxLeverage:i.number(),price:Ea,priceChange24h:i.object({amount:Ea,percentage:Ea}),volume24h:Ld,openInterest:Ld,fundingRate:Ea,assetId:i.number(),isAtOpenInterestCap:i.boolean().optional()}),UA=i.object({markets:i.array(LA).transform(e=>e.reduce((t,r)=>{let o=LA.safeParse(r);return o.success&&(t[M(o.data.token)]=o.data),t},{}))}),Uhe=i.object({id:i.string(),name:i.string(),logoUri:i.string(),currentPrice:i.number(),maxLeverage:i.number(),szDecimals:i.number(),assetId:i.number(),symbol:i.string()});u();l();var MA=D(B());u();l();var Eu=class{static{s(this,"CashSwapStateListener")}queryClient;storage;authRepository;cashAccount;constructor(t,r,o,n){this.queryClient=t,this.storage=r,this.authRepository=o,this.cashAccount=n}onStateChange(t,r,o,n){if(t.type===j.TransactionConfirmed){let{sell:a,buy:c,quote:p}=o.executingQuote,m=new U(p.sellAmount),d=new U(p.buyAmount);rp({queryClient:this.queryClient,storage:this.storage,authRepository:this.authRepository,sellCaip19:X(a),sellAmountBN:m,sellAddress:a.data.walletAddress,buyCaip19:X(c),buyAmountBN:d,buyAddress:c.data.walletAddress,cashAccountAddress:this.cashAccount?.addressDetails.address})}}};u();l();var ku=class{static{s(this,"FailedCashSwapExecuteSwapStateListener")}authRepository;constructor(t){this.authRepository=t}onStateChange(t,r,o,n){let{executingQuote:a}=o,{sell:c,buy:p}=a;if(!(!Ke(c)&&!Ke(p)))switch(t.type){case j.SimulationFailed:P.addBreadcrumb(O.Cash,"Cash swap simulation failure detected, recording...",Y.Info,{sellToken:c.data.symbol,buyToken:p.data.symbol}),this.recordFailure(a,"simulation",t.error,t.executionId);break;case j.TransactionSubmissionFailed:P.addBreadcrumb(O.Cash,"Cash swap submission failure detected, recording...",Y.Info,{sellToken:c.data.symbol,buyToken:p.data.symbol}),this.recordFailure(a,"submission",t.error,t.executionId);break}}async recordFailure(t,r,o,n){try{let a=await this.authRepository?.getUser();if(!a){P.addBreadcrumb(O.Cash,"Cannot record failed cash swap: user not found",Y.Info);return}let{accessToken:c,userID:p}=a,m=t.sell,d=t.buy,f=t.quote,h=t.quoteInput,w=m.data.walletAddress,y=d.data.walletAddress;if(!w&&h?.taker){let A=We(h.taker);A.resourceType===ee.address&&(w=A.address)}if(!y&&h?.takerDestination){let A=We(h.takerDestination);A.resourceType===ee.address&&(y=A.address)}let S={type:Co.Swap,input:{owner:w,mint:m.data.tokenAddress??"",amount:f.sellAmount,symbol:m.data.symbol??void 0,name:m.data.name??void 0,decimals:m.data.decimals,logoUri:m.data.logoUri??void 0},output:{owner:y,mint:d.data.tokenAddress??"",amount:f.buyAmount,symbol:d.data.symbol??void 0,name:d.data.name??void 0,decimals:d.data.decimals,logoUri:d.data.logoUri??void 0},quoteId:f.rfqProps?.quoteId,quoteSource:Ue(f).map(A=>A.name).join(",")},T=m.data.chain.id,b=o?.message||o?.type||"Unknown error";await ap({accessToken:c,userID:p,idempotencyKey:n,swapInfo:S,chainId:T,failureReason:b,skipNotification:!0,occurredAt:new Date().toISOString()}),P.addBreadcrumb(O.Cash,"Recorded failed cash swap",Y.Info,{failureType:r,sellToken:m.data.symbol,buyToken:d.data.symbol})}catch(a){P.addBreadcrumb(O.Cash,"Failed to record failed cash swap",Y.Error,a instanceof Error?{error:a.message}:{})}}};u();l();var Cu=class{static{s(this,"SocialExecuteSwapStateListener")}swapMode;queryClient;enableChatBadges;dismissChatBadgeSheet;constructor(t,r,o,n){this.swapMode=t,this.queryClient=r,this.enableChatBadges=o,this.dismissChatBadgeSheet=n}dismissBadgeSheet(){this.enableChatBadges&&this.dismissChatBadgeSheet()}onStateChange(t,r,o,n){if(t.type===j.TransactionSubmissionStarted&&this.dismissBadgeSheet(),t.type===j.TransactionConfirmed){let{buy:a,sell:c,quote:p,account:m}=o.executingQuote,d=a.data.chain.id,f=m.addresses.find(h=>h.networkID===d);if(f){let h=X(a),w=X(c),y=Ee(p.buyAmount,a.data.decimals).toNumber(),S=Ee(p.sellAmount,c.data.decimals).toNumber(),T=M({chainId:f.networkID,address:f.address,resourceType:ee.address}),b=this.swapMode.type==="buy"?M(h):M(w),k=this.queryClient.getQueryData(nf.userProfile())?.id??"",C=this.queryClient.getQueryData(Pr.tokenChatBalance(b,k)),I=0;C&&(I=C.quantity>0?C.quantity/10**C.decimals:0);let L=["trades"];this.enableChatBadges&&L.push("badges"),Nd({chatTokenId:b,transactionId:t.txReceipt.id,tokenBoughtCaip19:M(h),tokenBoughtAmount:y,tokenBoughtUsdValue:a.data.price?y*a.data.price:0,tokenSoldCaip19:M(w),tokenSoldAmount:S,tokenSoldUsdValue:c.data.price?S*c.data.price:0,walletCaip19:T,chatTokenBalance:I,system:{messages:L}})}}}};var OA=s(()=>{},"noop"),QA=s(e=>{let t=je(),{connection:r}=un(),o=Ot(),n=en(),a=v.language,c=we(),p=Qe(),m=nu(),d=ao(),f=Ba(),h=Xo("kill-swapper-simulation")??!1,w=ze("enable-chat-badges"),{data:y}=Ns();return(0,MA.useCallback)(async({showFungibleDetails:T,showBuyFungibleScreen:b=OA,showRetrySwap:A,swapMode:k,executeSwapStateListeners:C,toastMessageParser:I,uiContext:L="swapperInterstitial",preprocessor:Q,dismissChatBadgeSheet:R=OA})=>{let H=new Wn(T,b,d,[be.SlippageExceeded],A,I),q=new Vn(p,o,f),E=new Eu(p,o,f,y),F=new Kn(m,c,L,e),z=new jn(c),W=new Hn,re=new Gn(mo),Z=new Cu(k,p,w,R),He=new ku(f);try{t.subscribeExecution(q),t.subscribeExecution(E),t.subscribeExecution(z),t.subscribeExecution(F),t.subscribeExecution(H),t.subscribeExecution(W),t.subscribeExecution(re),t.subscribeExecution(He),nr&&t.subscribeExecution(Z),C.forEach(st=>t.subscribeExecution(st));let Le=await c.getDeviceId();await t.swap({signer:n,storage:o,locale:a,deviceId:Le,connection:r,authRepository:f,isSimulationKilled:h,preprocessor:Q})}catch{}finally{t.unsubscribeExecution(q),t.unsubscribeExecution(E),t.unsubscribeExecution(z),t.unsubscribeExecution(F),t.unsubscribeExecution(H),t.unsubscribeExecution(W),t.unsubscribeExecution(re),t.unsubscribeExecution(He),t.unsubscribeExecution(Z),C.forEach(Le=>t.unsubscribeExecution(Le))}},[d,p,m,c,t,n,o,a,r,f,h,e,w,y])},"useExecuteSwapTokenSwap");u();l();u();l();var $r="perps",qA={historicalOrders:s((e,t)=>[$r,"historical-orders",e,t],"historicalOrders"),market:s(e=>[$r,"market",e],"market"),markets:s(e=>[$r,"markets",e.sort()],"markets"),defaultLeverage:s(()=>[$r,"default-leverage"],"defaultLeverage"),assetLeverage:s(()=>[$r,"asset-leverage"],"assetLeverage"),permissions:s(()=>[$r,"config"],"permissions"),fungibleToPerpMap:s(()=>[$r,"fungible-to-perp-map"],"fungibleToPerpMap"),fundsInTransitBanner:s(e=>[$r,"funds-in-transit-banner",e],"fundsInTransitBanner"),fundsInTransitBannerDismissed:s(()=>[$r,"funds-in-transit-banner-dismissed"],"fundsInTransitBannerDismissed")};u();l();var A1={perp:6,spot:8};function zA(e,t,r="perp",o=_.ROUND_HALF_UP){let n=new _(e);if(n.isInteger())return n.toString();let a=A1[r],c=Math.max(a-t,0);return n.precision(5,o).toFixed(c,o).replace(/\.?0+$/,"")}s(zA,"formatUiPrice");var x1=G({days:1}),E1=G({minutes:5});var Ud=s((e,t=!1)=>ae({enabled:e.length>0,queryKey:qA.markets(e),gcTime:x1,staleTime:E1,async queryFn(){try{return await k1(e,t)}catch(r){throw P.addBreadcrumb(O.Perps,"Failed to get perp markets",Y.Error,{caip19s:e.join(","),error:r instanceof Error?r.message:"Unknown error"}),r}}}),"useGetPerpMarkets");async function k1(e,t=!1){let r=await K.api().get("/swap/v2/perp/markets",{params:{tokens:e.join(",")}});if(!le(r))throw new Error("Failed to get perp markets: response is not okay");let o=r.data,n=UA.safeParse(o);if(!n.success)throw new Error("Failed to get perp markets: schema validation failed");if(t){let a=n.data.markets,c={};for(let[p,m]of Object.entries(a))c[p]={...m,price:zA(m.price,m.szDecimals),priceChange24h:{...m.priceChange24h,percentage:String(Number(m.priceChange24h.percentage)/100)}};return c}return n.data.markets}s(k1,"getPerpMarkets");var Fu=D(B());u();l();var ZA=D(zE()),YA=D(QE());var C1=i.object({domain:i.string(),url:i.string(),name:i.string(),category:i.string(),imageUrl:i.string(),slug:i.string()}),XA=i.object({uuid:i.string(),data:i.array(C1)}),_1=i.object({type:i.literal("site"),url:i.string(),name:i.string(),category:i.string(),imageUrl:i.string(),description:i.string().optional()}),I1=i.object({type:i.literal("tokenCategory"),id:i.string(),name:i.string(),subtitle:i.string().optional(),imageUrl:i.string(),description:i.string().optional()}),JA=i.discriminatedUnion("type",[_1,I1]),bwe=s(e=>e.type==="site","isFeaturedSite");var F1=i.object({chainId:dt,address:i.string(),name:i.string(),symbol:i.string(),logoUrl:i.string(),marketCap:i.number(),price:i.number(),priceChange:i.number(),volume:i.number(),volumeChange:i.number(),spamStatus:Yu.optional().default(ie.NotVerified)}),v1=i.object({chainId:dt,address:i.string(),name:i.string(),symbol:i.string(),logoUrl:i.string(),marketCap:i.number(),price:i.number(),priceChange:i.number(),volume:i.number(),volumeChange:i.number(),spamStatus:Yu.optional().default(ie.NotVerified)}),Twe=i.object({id:i.string(),name:i.string(),imageUri:i.string()}),ex=i.object({items:i.array(F1)}),Awe=i.object({items:i.array(v1)}),P1=i.object({paymentTokenId:i.string(),name:i.string(),symbol:i.string(),decimals:i.number()}),R1=i.object({verified:i.boolean(),collectionUrl:i.string(),marketplaceId:i.string(),marketplaceName:i.string(),marketplaceCollectionId:i.string()}),D1=i.object({marketplaceId:i.string(),paymentToken:P1,value:i.string()}),N1=i.object({id:i.string(),name:i.string(),volume:i.string().optional(),volumePercentChange:i.number(),marketplacePages:i.array(R1),floorPrices:i.array(D1),imageUrl:i.string()}),tx=i.object({uuid:i.string(),data:i.array(N1)}),B1=["tokens","perps","sites","collections","learn","suggested-users-to-follow","suggested-users-to-follow-by-pnl","token-categories","tokens-for-you","trending-perps"],or=i.enum(["shortcuts","carousel",...B1]),L1=i.object({type:i.literal(or.enum.shortcuts)}),U1=i.object({type:i.literal(or.enum.carousel)}),O1=i.object({type:i.literal(or.enum["suggested-users-to-follow"]),limit:i.number()}),M1=["7d","30d"],GA=i.enum(M1),Q1=i.object({type:i.literal(or.enum["suggested-users-to-follow-by-pnl"]),limit:i.number(),timeFrame:i.array(GA).refine(e=>new Set(e).size===e.length),timeFrameDefault:GA}),ka="all_networks",ss=i.union([dt,i.literal(ka)]),q1=["asc","desc"],Od=i.enum(q1),z1=["rank","volume","price","price-change","market-cap"],KA=i.enum(z1),G1=["1h","24h","7d","30d"],VA=i.enum(G1),K1=i.object({type:i.literal(or.enum.tokens),sortBy:i.array(KA).refine(e=>new Set(e).size===e.length),sortByDefault:KA,sortDirectionDefault:Od,network:i.array(ss).refine(e=>new Set(e).size===e.length),networkDefault:ss,timeFrame:i.array(VA).refine(e=>new Set(e).size===e.length),timeFrameDefault:VA,rankAlgo:i.string(),limit:i.number(),listLimit:i.number()}),V1=i.object({type:i.literal(or.enum["token-categories"])}),j1=["volume","price-change","open-interest","trending"],_u=i.enum(j1),H1=["1h","24h","7d","30d"],Iu=i.enum(H1),$1=i.object({type:i.literal(or.enum.perps),sortBy:i.array(_u).refine(e=>new Set(e).size===e.length),sortByDefault:_u,sortDirectionDefault:Od,timeFrame:i.array(Iu).refine(e=>new Set(e).size===e.length),timeFrameDefault:Iu,limit:i.number(),listLimit:i.number()}),W1=i.object({type:i.literal(or.enum["trending-perps"]),sortBy:i.array(_u).refine(e=>new Set(e).size===e.length),sortByDefault:_u,sortDirectionDefault:Od,timeFrame:i.array(Iu).refine(e=>new Set(e).size===e.length),timeFrameDefault:Iu,limit:i.number(),listLimit:i.number()}),Z1=["top","rank"],jA=i.enum(Z1),Y1=["24h","7d","30d"],HA=i.enum(Y1),X1=i.object({type:i.literal(or.enum.sites),sortBy:i.array(jA).refine(e=>new Set(e).size===e.length),sortByDefault:jA,network:i.array(ss).refine(e=>new Set(e).size===e.length),networkDefault:ss,timeFrame:i.array(HA).refine(e=>new Set(e).size===e.length),timeFrameDefault:HA,rankAlgo:i.string(),limit:i.number(),listLimit:i.number()}),J1=["top","rank"],$A=i.enum(J1),eD=["24h","7d","30d"],WA=i.enum(eD),tD=i.object({type:i.literal(or.enum.collections),sortBy:i.array($A).refine(e=>new Set(e).size===e.length),sortByDefault:$A,network:i.array(ss).refine(e=>new Set(e).size===e.length),networkDefault:ss,timeFrame:i.array(WA).refine(e=>new Set(e).size===e.length),timeFrameDefault:WA,rankAlgo:i.string(),limit:i.number(),listLimit:i.number()}),rD=i.object({type:i.literal(or.enum.learn),limit:i.number()}),oD=i.object({type:i.literal(or.enum["tokens-for-you"]),limit:i.number(),listLimit:i.number()}),Md=i.discriminatedUnion("type",[L1,U1,O1,Q1,K1,$1,W1,X1,tD,rD,V1,oD]),rx=i.object({sections:i.array(Md).refine(e=>(0,ZA.default)(e,(0,YA.default)(e,"type")))}),xwe=i.object({uuid:i.string(),data:i.array(Cm)}),Ewe=i.object({tokenAddress:i.string(),bondingCurve:i.string(),migratedPool:i.string().optional(),name:i.string(),image:i.string(),symbol:i.string(),marketCap:i.coerce.number(),liquidity:i.coerce.number(),bondingCurvePercentage:i.coerce.number(),tokenCreatedAt:i.coerce.date(),twitter:i.string(),website:i.string(),telegram:i.string(),discord:i.string(),migratedAt:i.coerce.date().optional(),type:i.enum(["NEW","ABOUT_TO_MIGRATE","MIGRATED"]).optional(),slot:i.coerce.number().optional(),devHolding:i.coerce.number(),snipersHolding:i.coerce.number(),bundlersHolding:i.coerce.number(),top10Holding:i.coerce.number(),volume:i.coerce.number(),buysCount:i.coerce.number(),sellsCount:i.coerce.number(),uniqueHolders:i.coerce.number(),telegramCallCount:i.coerce.number(),bondingCurvePlatform:i.string()});var ox=rx.parse({sections:[{type:"shortcuts"},{type:"carousel"},{type:"tokens",sortBy:["rank","volume","price","price-change","market-cap"],sortByDefault:"rank",sortDirectionDefault:"asc",network:["solana:101","eip155:1","eip155:137","eip155:8453","sui:mainnet","bip122:000000000019d6689c085ae165831e93","all_networks"],networkDefault:"solana:101",timeFrame:["1h","24h","7d","30d"],timeFrameDefault:"24h",rankAlgo:"default",limit:3,listLimit:100},{type:"perps",sortBy:["volume","price-change","open-interest"],sortByDefault:"volume",sortDirectionDefault:"desc",timeFrame:["24h"],timeFrameDefault:"24h",limit:3,listLimit:100},{type:"trending-perps",sortBy:["trending"],sortByDefault:"trending",sortDirectionDefault:"desc",timeFrame:["24h"],timeFrameDefault:"24h",limit:3,listLimit:100},{type:"tokens-for-you",limit:3,listLimit:50},{type:"token-categories"},{type:"suggested-users-to-follow-by-pnl",limit:3,timeFrame:["7d","30d"],timeFrameDefault:"7d"},{type:"sites",sortBy:["rank","top"],sortByDefault:"rank",network:["solana:101","eip155:1","eip155:137","eip155:8453","sui:mainnet","bip122:000000000019d6689c085ae165831e93","all_networks"],networkDefault:"solana:101",timeFrame:["24h","7d","30d"],timeFrameDefault:"24h",rankAlgo:"default",limit:3,listLimit:50},{type:"learn",limit:3}]}),nD=s(e=>{try{let t=JSON.parse(e??"");return t?.sections?{sections:t.sections.filter(o=>Md.safeParse(o).success)}:ox}catch{return ox}},"parseFeatureFlagConfig"),Qd=s(()=>{let e=$t.getMultivariateAssignment("explore-config"),{data:[t]}=Ht(["enable-fungible-categories"]),r=ze("enable-social-tokens-for-you"),o=Bd(),n=ze("enable-trending-perps");return(0,Fu.useMemo)(()=>{let a=nD(e);return nr||(a={...a,sections:a.sections.filter(c=>c.type!=="suggested-users-to-follow")}),(!r||!nr)&&(a={...a,sections:a.sections.filter(c=>c.type!=="tokens-for-you")}),t||(a={...a,sections:a.sections.filter(c=>c.type!=="token-categories")}),o||(a={...a,sections:a.sections.filter(c=>c.type!=="perps")}),n||(a={...a,sections:a.sections.filter(c=>c.type!=="trending-perps")}),a},[e,t,o,r,n])},"useExploreConfig"),qd=s(()=>{let e=Qd();return(0,Fu.useMemo)(()=>{let t=[];for(let r of e.sections)(r.type==="collections"||r.type==="tokens"||r.type==="perps"||r.type==="sites"||r.type==="learn"||r.type==="suggested-users-to-follow"||r.type==="suggested-users-to-follow-by-pnl"||r.type==="token-categories"||r.type==="tokens-for-you"||r.type==="trending-perps")&&t.push(r);return t},[e.sections])},"useExploreConfigNavigatableSections"),zd=s(e=>{let t=Qd();return(0,Fu.useMemo)(()=>t.sections.find(o=>o.type===e)??null,[t.sections,e])},"useExploreConfigSection");u();l();u();l();u();l();u();l();var nx="@phantom/fungible-categories",vu={fungibleCategories:s(e=>[nx,"fungible-categories",e],"fungibleCategories"),fungibleCategoryById:s(e=>[nx,"fungible-category",e],"fungibleCategoryById")};u();l();var sx=i.object({items:i.array(ag)}),ax=i.object({id:i.string(),name:i.string(),imageUri:i.string().nullish().transform(e=>e??""),items:ig.array()});var Gd=s(({limit:e,searchQuery:t}={})=>{let{data:[r]}=Ht(["enable-fungible-categories"]);return ae({enabled:r,queryKey:vu.fungibleCategories({enabled:r,searchQuery:t}),queryFn:s(async()=>{let o=await K.api().get("/fungibles/v1/categories",{params:{limit:"100",...t?{query:t}:{}}});return sx.parse(o.data)},"queryFn"),select:s(o=>e?o.items.slice(0,e):o.items,"select")})},"useFungibleCategories");u();l();var sD=s(({id:e})=>{let{data:[t]}=Ht(["enable-fungible-categories"]);return ae({enabled:t,queryKey:vu.fungibleCategoryById({id:e,enabled:t}),queryFn:s(async()=>{let r=await K.api().get(`/fungibles/v1/categories/${e}`,{params:{includePrices:"true"}});return ax.parse(r.data)},"queryFn")})},"useFungibleCategoryById");var Oe=D(B());u();l();u();l();u();l();var ix={tokenSearchEnabled:s(()=>!0,"tokenSearchEnabled"),trendingTokensEnabled:s(()=>!1,"trendingTokensEnabled")};u();l();var cx={tokenSearchEnabled:s(()=>!0,"tokenSearchEnabled"),trendingTokensEnabled:s(()=>!0,"trendingTokensEnabled")};u();l();var ux={tokenSearchEnabled:s(()=>!0,"tokenSearchEnabled"),trendingTokensEnabled:s(()=>!1,"trendingTokensEnabled")};u();l();var lx={tokenSearchEnabled:s(()=>!0,"tokenSearchEnabled"),trendingTokensEnabled:s(()=>!0,"trendingTokensEnabled")};u();l();var px={tokenSearchEnabled:s(()=>!0,"tokenSearchEnabled"),trendingTokensEnabled:s(()=>!1,"trendingTokensEnabled")};u();l();var dx={tokenSearchEnabled:s(()=>!0,"tokenSearchEnabled"),trendingTokensEnabled:s(()=>!1,"trendingTokensEnabled")};u();l();var mx={tokenSearchEnabled:s(()=>!1,"tokenSearchEnabled"),trendingTokensEnabled:s(()=>!1,"trendingTokensEnabled")};u();l();var fx={tokenSearchEnabled:s(()=>!0,"tokenSearchEnabled"),trendingTokensEnabled:s(()=>!0,"trendingTokensEnabled")};u();l();var gx={tokenSearchEnabled:s(()=>!0,"tokenSearchEnabled"),trendingTokensEnabled:s(()=>!0,"trendingTokensEnabled")};u();l();var hx={tokenSearchEnabled:s(()=>!0,"tokenSearchEnabled"),trendingTokensEnabled:s(()=>!1,"trendingTokensEnabled")};var aD=new Zo({[se.Solana]:gx,[se.Ethereum]:lx,[se.Polygon]:fx,[se.Base]:cx,[se.Arbitrum]:ix,[se.Bitcoin]:ux,[se.Monad]:mx,[se.Sui]:hx,[se.Hypercore]:px,[se.Hyperevm]:dx}),Kd=Wo(aD);u();l();var yx=s(e=>["explore-dapp",e],"createExploreDappQueryKey");var wx=s(e=>e.addresses.map(t=>x.getMainnetNetworkID(t.networkID))??[],"getAccountMainnetNetworkIds");function Sx(e){try{return ar.get(e).nonNativeFungibleTokenType}catch{return oe.SolanaNative}}s(Sx,"getExploreTokenTypeFromChain");u();l();u();l();var Kt="@phantom/explore",pt={RecentlyViewedSearchItems:[Kt,"RecentlyViewedSearchItems"],sitesV2({sortBy:e,timeFrame:t,networkIDs:r,limit:o,locale:n,rankAlgo:a}){return[Kt,"sitesV2",ke,n,{sortBy:e,timeFrame:t,networkIDs:r,rankAlgo:a,limit:o}]},recommendedSites(e,t){return[Kt,"sites","recommended",ke,t,e]},featuredItems(e,t){return[Kt,"items","featured",ke,t,e]},tokensV2({sortBy:e,sortDirection:t,timeFrame:r,networkIDs:o,limit:n,rankAlgo:a}){return[Kt,"tokensV2",{sortBy:e,sortDirection:t,timeFrame:r,networkIDs:o,rankAlgo:a,limit:n}]},curated({networkIDs:e,limit:t}){return[Kt,"curated",{networkIDs:e,limit:t}]},collectionsV2({sortBy:e,timeFrame:t,networkIDs:r,limit:o,locale:n,rankAlgo:a}){return[Kt,"collectionsV2",ke,n,{sortBy:e,timeFrame:t,networkIDs:r,rankAlgo:a,limit:o}]},featuredTransactions(e,t){return[Kt,"transactions","featured",ke,t,e]},learn(e,t){return[Kt,"learn",ke,t,e]},perpMarkets(e,t,r,o,n,a){return[Kt,"perp-markets",{chainId:e,sortBy:t,sortDirection:r,timeFrame:o,limit:n,search:a}]}};var iD=10,Tx=pe.RecentlyViewedSearchItems;async function cD(e){return await e.get(Tx)??[]}s(cD,"getRecentlyViewedSearchItem");async function Ax(e,t){await e.set(Tx,t)}s(Ax,"setRecentlyViewedSearchItem");function Vd(e){return ae({queryKey:pt.RecentlyViewedSearchItems,queryFn:s(async()=>cD(e),"queryFn"),staleTime:0,enabled:!0})}s(Vd,"useGetRecentlyViewedSearchItems");function uD(e){let t=Qe();return Ao({mutationFn:s(async o=>{let n=bx(o),c=(t.getQueryData(pt.RecentlyViewedSearchItems)??[]).filter(p=>bx(p)!==n);c.unshift(o),c=c.slice(0,iD),await Ax(e,c),t.setQueryData(pt.RecentlyViewedSearchItems,c),await t.refetchQueries({queryKey:pt.RecentlyViewedSearchItems})},"mutationFn")})}s(uD,"useAddRecentlyViewedSearchItem");function lD(e){let t=Qe();return Ao({mutationFn:s(async()=>{await Ax(e,[]),t.setQueryData(pt.RecentlyViewedSearchItems,[]),await t.refetchQueries({queryKey:pt.RecentlyViewedSearchItems})},"mutationFn")})}s(lD,"useClearRecentlyViewedSearchItem");function bx(e){return e.type==="token"||e.type==="perp"?M(X(e.data)):e.data.id}s(bx,"keyFromSearchItem");u();l();var jd=D(vx()),Pu=D(B());u();l();var Px={fields:["domain","name","category","tags"],storeFields:["domain","name","category","tags","imageUrl"],searchOptions:{boost:{name:2},prefix:!0,fuzzy:s(e=>e.length>3?.2:!1,"fuzzy")}};var Rx=s(e=>{try{let{hostname:t,pathname:r}=new URL(e);return t+r}catch{return e}},"getHostnameAndPath"),AD=s((e=[],t=[])=>{let r=[...e,...t],o=(0,jd.default)(t,a=>Rx(a.domain)),n=new Map;return r.forEach(a=>{let c=Rx(a.domain);if(!n.has(c)){let p=o[c]||a;n.set(c,p)}}),Array.from(n.values())},"combineAndDeduplicateDapps"),xD=s(e=>{let t={isRecommended:"true"};return e.networkIds&&(t.chainIds=e.networkIds.join(",")),`/dapps/v1?${new URLSearchParams(t).toString()}`},"getRecommendedDappsEndpoint"),ED=s(async e=>{let t=await K.api().get(xD(e));if(!le(t))throw new Error("Error fetching recommended dapps from registry");if(!t?.data||!t?.data?.data)throw new Error("No data returned from registry");let r=t.data,o=(0,jd.default)(r.data??[],a=>a.id);return Object.values(o)},"fetchRecommendedDapps"),kD=s(e=>{let t=Qe();return ae({queryKey:["dapps","recommended",e],queryFn:s(async()=>{try{let o=await ED(e);return Km.batch(()=>{for(let n of o){let a=yx(n.domain),c=t.getQueryState(a);t.setQueryData(a,()=>n??c?.data??null)}}),o}catch(o){throw P.captureError(o,O.DappRegistry),o}},"queryFn"),gcTime:G({days:1}),staleTime:G({days:1})})},"useRecommendedSearchDapps"),Dx=s((e,t)=>{let{searchQuery:r,networkIds:o}=e,{data:n=[],...a}=kD({networkIds:o}),c=(0,Pu.useMemo)(()=>n.sort((h,w)=>w.recommendationScore-h.recommendationScore),[n]),p=(0,Pu.useMemo)(()=>AD(t,c),[t,c]),m=Qh(r),d=dg(p,m,Px);return{data:(0,Pu.useMemo)(()=>{let h=new Map(p.map(w=>[w.id,w]));return d.map(w=>h.get(w.id)).filter(w=>w!==void 0)},[d,p]),...a}},"useRecommendedSearchDappsWithQuery");u();l();u();l();var Nx=s(async({sortBy:e,sortDirection:t,timeFrame:r,networkIDs:o,limit:n,rankAlgo:a,anonymousId:c})=>{let p=new URLSearchParams({timeFrame:r,sortBy:e,sortDirection:t,limit:n.toString(),rankAlgo:a,...c?{anonymousId:c}:{}});o.forEach(f=>{p.append("chainIds[]",f)});let m=await K.api().noBearer().get("/explore/v2/trending-tokens",{params:p});if(!le(m))throw new Error("Failed to fetch tokens");let d=ex.safeParse(m.data);if(!d.success)throw new Error("Failed to parse tokens");return d.data},"getTokensV2");u();l();var as=s((e,t)=>{let r=Oa(),n=qd().find(c=>c.type===t),a=[];return n&&"network"in n?n.network.forEach(c=>{c!==ka&&r.includes(c)&&a.push(c)}):a=r,e!==ka&&!a.includes(e)?[]:e===ka?a:[e]},"useExploreNetwork");var CD=G({minutes:1}),_D=G({minutes:1}),ID=100,Hd=s(({sortBy:e,sortDirection:t,timeFrame:r,network:o,limit:n,rankAlgo:a,enableQuery:c=!0})=>{let p=we(),m=as(o,"tokens"),d=ID;return ae({queryKey:pt.tokensV2({sortBy:e,sortDirection:t,timeFrame:r,networkIDs:m,limit:d,rankAlgo:a}),enabled:c,async queryFn(){let f=await p.getDeviceId();return Nx({sortBy:e,sortDirection:t,timeFrame:r,networkIDs:m,limit:d,rankAlgo:a,anonymousId:f})},gcTime:_D,staleTime:CD,retry:3,select:s(f=>n>=d?f:{...f,items:f.items.slice(0,n)},"select")})},"useTokensV2");var is=3,FD=15,Ru=50,Bx={[ie.Trusted]:1,[ie.Verified]:2,[ie.NotVerified]:3,[ie.PossibleSpam]:4,[ie.Spam]:5},vD=s((e,t=100)=>{let[r,o]=(0,Oe.useState)(!1);return(0,Oe.useEffect)(()=>{let n;return e?n=setTimeout(()=>o(!0),t):o(!1),()=>clearTimeout(n)},[e,t]),r},"useDelayedLoading"),PD=s(e=>{let t=Sx(e.chainId),r=x.getChainDefinition(e.chainId),o={name:e.name,symbol:e.symbol,logoUri:e.logoUrl,spamStatus:e.spamStatus,chain:{id:e.chainId,symbol:r.tokenSymbol,name:r.name,imageUrl:r.iconUrl}};switch(t){case oe.SPL:return{type:t,data:{...o,mintAddress:e.address}};case oe.ERC20:return{type:t,data:{...o,contractAddress:e.address}};case oe.BRC20:return{type:t,data:{...o,firstCreatedInscriptionId:e.address}};default:return null}},"mapExploreTokenToTokenMetadata"),RD=s(e=>e.reduce((t,r)=>{let o=PD(r);return o&&t.push(o),t},[]),"reduceExploreTokensToTokenMetadata"),DD=s(({searchQuery:e,networkIds:t,excludePlaceholderTokens:r=!1,extraDapps:o=[],actorSearchHook:n})=>{let[a,c]=(0,Oe.useState)(!1),[p,m]=(0,Oe.useState)(!1),[d,f]=(0,Oe.useState)(!1),[h,w]=(0,Oe.useState)(!1),[y,S]=(0,Oe.useState)(!1),T=ze("enable-monad-mainnet"),b=(0,Oe.useMemo)(()=>t.filter(Nt=>x.isMonadNetworkID(Nt)&&x.isMainnetNetworkID(Nt)?T:Kd.get(Nt).tokenSearchEnabled()),[t,T]);(0,Oe.useEffect)(()=>{c(!1),m(!1),f(!1),w(!1),S(!1)},[e]);let{data:A=[],isLoading:k}=Sa({query:e,networkIds:b,searchContext:"explore",enableQuery:!!e}),{data:C,isLoading:I}=Gd({limit:e?void 0:10,searchQuery:e}),L=zd("tokens"),{data:Q}=Hd({sortBy:L?.sortByDefault??"rank",sortDirection:L?.sortDirectionDefault??"asc",timeFrame:L?.timeFrameDefault??"24h",network:L?.networkDefault??$o.Mainnet,limit:10,rankAlgo:L?.rankAlgo??"default",enableQuery:!e&&!r}),{tokens:R,perps:H}=(0,Oe.useMemo)(()=>A.sort((Yr,bs)=>Bx[Yr.data.spamStatus??ie.NotVerified]-Bx[bs.data.spamStatus??ie.NotVerified]).reduce((Yr,bs)=>(bs.type===oe.HypercoreAsset?Yr.perps.push(bs):Yr.tokens.push(bs),Yr),{tokens:[],perps:[]}),[A]),q=(0,Oe.useMemo)(()=>Q?.items?RD(Q.items):[],[Q?.items]),E=e.length===0?FD:is,F=(0,Oe.useMemo)(()=>R.slice(0,p?Ru:E),[p,R,E]),z=(0,Oe.useMemo)(()=>H.slice(0,d?Ru:E),[d,H,E]),W=(0,Oe.useMemo)(()=>[...F.map(Nt=>M(X(Nt))),...q.map(Nt=>M(X(Nt)))],[F,q]),{data:re={},isLoading:Z}=Jr({query:{data:W},enabled:W.length>0}),He=(0,Oe.useMemo)(()=>z.map(Nt=>M(X(Nt))),[z]),{data:Le,isPending:st}=Ud(He,!0),{data:jo=[],isLoading:bo}=Dx({networkIds:b,searchQuery:e},o),Ra=jo.slice(0,a?Ru:is),Ie=n??(()=>({data:void 0,isLoading:!1})),{data:Re,isLoading:at}=Ie({query:e}),De=!!e,bt=bo||k||I||at,J=De&&!bt,Sm=Ot(),{data:ws}=Vd(Sm),{actorsAll:bm,actors:Tm}=(0,Oe.useMemo)(()=>{let Nt=Re?.actors??[],Yr=Nt.slice(0,h?Ru:is);return{actorsAll:Nt,actors:Yr}},[h,Re?.actors]),Am=(0,Oe.useMemo)(()=>{if(C)return y?C:C.slice(0,E)},[C,y,E]),Ss=(0,Oe.useMemo)(()=>({actors:Tm,dapps:jo,searchedDapps:Ra,renderShowMoreDappsButton:De&&jo.length>is,isLoading:bt,tokens:F,perps:z,trendingTokens:q,renderShowMoreTokensButton:De&&R.length>E,renderShowMorePerpsButton:De&&H.length>E,renderShowMoreUsersButton:De&&bm.length>is,priceMap:re,isPriceMapLoading:Z,showSearchResults:J,showMoreTokens:p,setShowMoreTokens:m,showMorePerps:d,setShowMorePerps:f,showMoreDapps:a,setShowMoreDapps:c,showMoreUsers:h,setShowMoreUsers:w,recentlyViewedSearchItems:ws,categories:Am,showMoreCategories:y,setShowMoreCategories:S,renderShowMoreCategoriesButton:De&&C&&C?.length>is,perpMarketMap:Le,isPerpMarketMapLoading:st}),[Tm,jo,Ra,De,bt,F,z,q,R.length,H.length,E,bm.length,re,Z,J,p,d,a,h,ws,Am,y,C,Le,st]),[xm,RE]=(0,Oe.useState)(null),DE=vD(bt);return(0,Oe.useEffect)(()=>{Ss.isLoading||RE(e?Ss:null)},[Ss.isLoading,e]),{...Ss.isLoading&&xm?xm:Ss,showSpinner:DE&&De}},"useExploreSearchList");u();l();u();l();var Ux=D(B());u();l();var Lx=s(async(e,t)=>{let r=new URLSearchParams({appVersion:ke,limit:"6",locale:t,platform:Lt});e.forEach(c=>{r.append("chainIds[]",c)});let o=await K.api().noBearer().get("/explore/v1/featured-items",{params:r});if(!le(o))throw new Error("Failed to fetch featured items");let n=await o.data;if(!n.data||!Array.isArray(n.data))return[];let a=[];for(let c of n.data)try{let p=JA.parse(c);a.push(p)}catch{}return a},"getFeaturedItems");var ND=G({minutes:10}),BD=G({minutes:10}),LD=s(()=>{let{data:e}=_e(),t=(0,Ux.useMemo)(()=>e?wx(e):[],[e]),r=wr(v.language)??"en",o=s(async()=>{if(!e)throw new Error("No account found");return Lx(t,r)},"queryFn");return ae({queryKey:pt.featuredItems(t,r),enabled:!!e,queryFn:o,gcTime:ND,staleTime:BD})},"useExploreFeaturedItems");u();l();u();l();var UD={rank:"trending",top:"top"},Ox=s(async({sortBy:e,timeFrame:t,networkIDs:r,limit:o,locale:n,rankAlgo:a})=>{let c=new URLSearchParams({appVersion:ke,limit:o.toString(),locale:n,platform:Lt,rankAlgo:a,rankBy:UD[e],timeframe:t});r.forEach(d=>{c.append("chainIds[]",d)});let p=await K.api().noBearer().get("/explore/v1/trending-dapps",{params:c});if(!le(p))throw new Error("Failed to fetch sites");let m=XA.safeParse(p.data);if(!m.success)throw new Error("Failed to parse sites");return m.data},"getSitesV2");var OD=G({minutes:10}),MD=G({minutes:10}),QD=s(({sortBy:e,timeFrame:t,network:r,limit:o,rankAlgo:n})=>{let{data:a}=_e(),c=as(r,"sites"),p=wr(v.language)??"en";return ae({queryKey:pt.sitesV2({sortBy:e,timeFrame:t,networkIDs:c,locale:p,limit:o,rankAlgo:n}),enabled:!!a,async queryFn(){if(!a)throw new Error("No account found");return Ox({sortBy:e,timeFrame:t,networkIDs:c,locale:p,limit:o,rankAlgo:n})},gcTime:MD,staleTime:OD,retry:3})},"useSitesV2");u();l();u();l();var qD={rank:"trending",top:"volume"},zD=s(e=>e.floorPrices.length>0&&e.marketplacePages.length>0,"collectionWithValueAndMarketPlace"),Mx=s(async({sortBy:e,timeFrame:t,networkIDs:r,limit:o,locale:n,rankAlgo:a})=>{let c=new URLSearchParams({appVersion:ke,limit:o.toString(),locale:n,platform:Lt,rankAlgo:a,rankBy:qD[e],timeframe:t});r.forEach(d=>{c.append("chainIds[]",d.toString())});let p=await K.api().noBearer().get("/explore/v1/trending-collections",{params:c});if(!le(p))throw new Error("Failed to fetch collections");let m=tx.safeParse(p.data);if(!m.success)throw new Error("Failed to parse collections");return{...m.data,data:m.data.data.filter(zD)}},"getCollectionsV2");var GD=G({minutes:10}),KD=G({minutes:10}),VD=s(({sortBy:e,timeFrame:t,network:r,limit:o,rankAlgo:n})=>{let{data:a}=_e(),c=as(r,"collections"),p=wr(v.language)??"en";return ae({queryKey:pt.collectionsV2({sortBy:e,timeFrame:t,networkIDs:c,locale:p,limit:o,rankAlgo:n}),enabled:!!a,async queryFn(){if(!a)throw new Error("No account found");return Mx({sortBy:e,timeFrame:t,networkIDs:c,locale:p,limit:o,rankAlgo:n})},gcTime:KD,staleTime:GD,retry:3})},"useCollectionsV2");u();l();u();l();var Qx=s(async(e,t)=>{let r=new URLSearchParams({appVersion:ke,locale:t,platform:Lt});e.forEach(a=>{r.append("chainIds[]",a)});let o=await K.api().noBearer().get("/explore/v1/learn-grid",{params:r});if(!le(o))throw new Error("Failed to fetch learn grid");return o.data},"getLearnItems");var jD=G({minutes:10}),HD=G({minutes:10}),$D=s(()=>{let e=Oa(),t=wr(v.language)??"en";return ae({queryKey:pt.learn(e,t),enabled:e.length>0,async queryFn(){return Qx(e,t)},gcTime:HD,staleTime:jD})},"useLearnV2");u();l();var gs=D(B(),1);u();l();var ps=D(B(),1);u();l();var $d={location:0,distance:50,threshold:.2,shouldSort:!0,keys:[{name:"token.name",weight:.4},{name:"token.symbol",weight:.4},{name:"token.caip19.chainId",weight:.2}]};var Wd=30,WD=6,Zd=3e4,Yd=5,Xd=["100","500","1000"];u();l();u();l();var cs="@phantom/fiat-ramp",Ca=`${cs}:fungibles`,ZD=`${cs}:payment-methods`,YD=`${cs}:providers`,XD=`${cs}:recommended-quote`,JD=`${cs}:status`,eN=`${cs}:completed`,So={fiatRampTokens(e,t,r){return[Ca,e,t,r]},fiatRampPaymentMethods(e,t,r){return[ZD,e,t,r]},fiatRampProviders(e,t,r){return[YD,e,t,r]},fiatRampRecommendedQuote(e,t,r){return[XD,e,t,r]},fiatRampStatus(e,t,r){return[JD,e,t,r]},fiatRampCompleted(e,t,r){return[eN,e,t,r]}};u();l();u();l();u();l();var tN=i.object({name:i.string().nullish().default(null),symbol:i.string().nullish().default(null),decimals:i.number(),caip19:Ut,logoURI:i.string().nullish().default(null)}),rN=i.object({token:tN,addressType:Dm.optional()}),em=i.object({id:i.string(),name:i.string(),tag:i.string(),logo:i.string(),quote:i.object({displaySourceAmount:i.string(),displayDestinationAmount:i.string(),displayFee:i.string()}).optional()}),zo;(function(e){e.CARD="CARD",e.MOBILE_WALLET="MOBILE_WALLET",e.BANK_TRANSFER="BANK_TRANSFER",e.EXCHANGE="EXCHANGE",e.LOCAL="LOCAL"})(zo||(zo={}));var tm=i.object({id:i.string(),type:i.nativeEnum(zo),name:i.string(),estimatedArrival:i.string(),assets:i.object({icon:i.string(),roundIcon:i.string()}),description:i.string().optional()}),Vxe=i.object({groups:i.array(i.object({groupName:i.string(),tokens:i.array(rN)}))}),jxe=i.object({paymentMethods:i.array(tm),provider:em.optional()}),Hxe=i.object({providers:i.array(em),paymentMethod:tm,token:Ut}),$xe=i.object({provider:em,paymentMethod:tm,location:i.object({countryCode:i.string(),subdivision:i.string().optional()}).optional(),token:Ut.optional(),tokenAmount:i.string().optional(),fiatAmount:i.string().optional(),fiatCurrencyCode:i.string().optional(),minPurchaseAmount:i.string().optional(),maxPurchaseAmount:i.string().optional(),quickSelectDenominations:i.array(i.string()).optional()}),Wxe=i.object({url:i.string(),sessionId:i.string()}),Jd;(function(e){e.PENDING="PENDING",e.COMPLETED="COMPLETED",e.FAILED="FAILED"})(Jd||(Jd={}));var Zxe=i.object({status:i.nativeEnum(Jd),tokenAmount:i.number().optional(),fiatCurrencyCode:i.string().optional(),usdFiatAmount:i.number().optional(),usdFiatFeeAmount:i.number().optional(),fiatFeeAmount:i.number().optional(),cryptoTransactionId:i.string().optional(),createdAt:i.date().optional(),updatedAt:i.date().optional()}),Rt=class extends Error{static{s(this,"FiatRampError")}constructor(t){super(t),this.name="FiatRampError"}};var qx=new Rt("Failed to get FiatRampPaymentMethods"),zx=s(async(e,t,r)=>{try{let o=await K.api().headers(e).bearer(r).post("/fiat_ramp/v2/onramp/payment_methods",t);if(!le(o))throw qx;return o.data}catch{throw qx}},"getPaymentMethods");var oN=G({days:7}),nN=G({hours:1}),_a=s((e,t,r,o)=>{let n={"x-client-platform":e,"x-client-app-version":t,"x-client-locale":r},{data:a}=yr(),c=a?.userID,p=a?.accessToken;return ae({queryKey:So.fiatRampPaymentMethods(n,o,c),queryFn:s(()=>zx(n,o,p),"queryFn"),gcTime:oN,staleTime:nN})},"useFiatRampPaymentMethods");u();l();u();l();var Gx=new Rt("Failed to get FiatRampProviders"),Kx=s(async(e,t,r)=>{try{let o=await K.api().headers(e).bearer(r).post("/fiat_ramp/v2/onramp/providers",t);if(!le(o))throw Gx;return o.data}catch{throw Gx}},"getProviders");var sN=G({seconds:Wd}),aN=G({hours:1}),rm=s((e,t,r,o)=>{let n={"x-client-platform":e,"x-client-app-version":t,"x-client-locale":r},{data:a}=yr(),c=a?.userID,p=a?.accessToken;return ae({queryKey:So.fiatRampProviders(n,o,c),queryFn:s(()=>Kx(n,o,p),"queryFn"),gcTime:aN,staleTime:sN,enabled:!!o.destinationAddress})},"useFiatRampProviders");u();l();u();l();var Vx=new Rt("Failed to get FiatRampRecommendedQuote"),jx=s(async(e,t,r)=>{try{let o=await K.api().headers(e).bearer(r).post("/fiat_ramp/v2/onramp/recommended_quote",t);if(!le(o))throw Vx;return o.data}catch{throw Vx}},"getRecommendedQuote");var iN=G({days:7}),cN=G({hours:1}),Du=s((e,t,r,o,n=!0)=>{let a={"x-client-platform":e,"x-client-app-version":t,"x-client-locale":r},{data:c}=yr(),p=c?.userID,m=c?.accessToken;return ae({queryKey:So.fiatRampRecommendedQuote(a,o,p),queryFn:s(()=>jx(a,o,m),"queryFn"),gcTime:iN,staleTime:cN,enabled:n})},"useFiatRampRecommendedQuote");u();l();u();l();var Hx=new Rt("Failed to get FiatRampTokens"),$x=s(async(e,t,r)=>{try{let o=await K.api().headers(e).bearer(r).post("/fiat_ramp/v2/onramp/tokens",t);if(!le(o))throw Hx;return o.data}catch{throw Hx}},"getSupportedFiatRampTokens");u();l();var Nu=s(e=>e.sort((t,r)=>x.compareNetworkID(t.token.caip19.chainId,r.token.caip19.chainId)),"sortFiatTokens");var uN=G({days:7}),lN=G({hours:1}),us=s((e,t,r,o=!0,n)=>{let{data:a}=_e(),c=Array.from(new Set(a?.addresses?.map(y=>y.networkID))),p=Array.from(new Set(a?.addresses?.map(y=>y.addressType))),m={chainIDs:c},d={"x-client-platform":e,"x-client-app-version":t,"x-client-locale":r},{data:f}=yr(),h=f?.userID,w=f?.accessToken;return ae({queryKey:So.fiatRampTokens(d,m,h),queryFn:s(()=>$x(d,m,w),"queryFn"),gcTime:uN,staleTime:lN,enabled:o&&c.length>0,select:s(y=>{let S={...y,groups:y.groups.map(T=>({...T,tokens:Nu(T.tokens.filter(b=>b.addressType?p.includes(b.addressType):!0))}))};return n?n(S):S},"select")})},"useFiatRampGroupedTokens");u();l();u();l();var Wx=s(e=>{let t=e?.groups.flatMap(r=>r.tokens)??[];return Nu(t)},"flattenAndSortTokens");var ls=s((e,t,r,o=!0)=>us(e,t,r,o,Wx),"useAllFiatRampTokens");u();l();var Wr={onClose:s(()=>{},"onClose"),context:"modal",fungible:void 0,purchaseAmount:"0",purchaseType:"currency",isPurchaseAmountValid:!1,error:void 0,redirectErrorMessage:void 0,ownerPublicKey:"",price:0,minPurchaseAmountUsd:Yd,maxPurchaseAmountUsd:Zd,quickSelectDenominations:Xd,paymentMethod:void 0,provider:void 0,checkoutQuoteType:"recommended",redirectURL:void 0,stripePaymentMethod:void 0},Dt=Ye(e=>({...Wr,setState:s(t=>e(r=>({...r,...t})),"setState"),reset:s(()=>{e(Wr)},"reset")}));var Zx=s(({platform:e,version:t,onClosePress:r,onNextPress:o})=>{let n=we(),{i18n:a}=Ze(),c=a.language,{setState:p}=Dt(),{data:m}=_e(),d=Array.from(new Set(m?.addresses?.map(R=>R.addressType))),{data:f=[]}=ls(e,t,c),{data:h,isPending:w,isFetching:y,isError:S}=us(e,t,c),T=h?.groups??[],b=w||y||S,[A,k]=(0,ps.useState)(""),C=za(A)??"",I=A.length>0,L=pg(f,C,$d),Q=(0,ps.useCallback)(({tokenWithMetadata:R,ownerPublicKey:H})=>{let{token:q}=R,{name:E,symbol:F,caip19:z}=q,{chainId:W}=z;n.capture("fiatOnrampFungibleSelected",{data:{networkId:W,chainId:x.getChainID(W),asset:{name:E,symbol:F,type:"fungible"}}}),p({...Wr,onClose:r,ownerPublicKey:H,fungible:R.token}),o()},[n,r,o,p]);return(0,ps.useEffect)(()=>{n.capture("fiatOnrampInitiated")},[n]),{enabledAddressTypes:d,groupedTokens:T,isLoading:b,isSearching:I,searchedTokens:L,searchTerm:A,selectedAccount:m,onClosePress:r,onTokenPress:Q,setSearchTerm:k}},"useFiatRampSelectFungible");u();l();var jt=D(B(),1);u();l();var ms=D(B(),1);u();l();var om=D(B(),1);var nm=s(({marginBottom:e=0})=>{let{t}=Ze(),{data:[r]}=Ht(["enable-buy-flow-warning"]);return r?om.default.createElement(fe,{marginBottom:e},om.default.createElement(mf,{level:"4-error"},t("buyFlowHealthWarning"))):null},"BuyFlowWarning");u();l();var Go=D(B(),1);u();l();var Vt=D(B(),1);u();l();var dr=D(B(),1);var Bu=48,sm=dr.default.memo(({networkId:e,logoURI:t,type:r})=>{let o=pN({disableBadge:!1,tokenType:r,chain:x.getChainID(e)});return dr.default.createElement(fe,{size:Bu,position:"relative"},t?dr.default.createElement(Nr,{src:t,height:Bu,width:Bu,borderRadius:"circle",fallback:dr.default.createElement(Yx,null)}):dr.default.createElement(Yx,null),o?dr.default.createElement(dN,{networkId:e}):null)}),Yx=s(()=>dr.default.createElement(fe,{alignItems:"center",justifyContent:"center",size:Bu,backgroundColor:"areaBase",borderRadius:"circle"},dr.default.createElement(Xr.Coin,{size:"50%",color:"borderBase"})),"TokenImageFallback"),pN=s(({disableBadge:e,tokenType:t,chain:r})=>e?!1:ar.get(r).alwaysShowNetworkBadge?!0:!Mt(t),"showNetworkBadge"),dN=s(({networkId:e})=>dr.default.createElement(fe,{right:"-2",bottom:"-2",position:"absolute",borderColor:"elementBase",borderStyle:"solid",borderWidth:2,style:{borderRadius:9}},dr.default.createElement(gg,{networkID:e,size:18})),"ChainBadge");u();l();var ds=D(B(),1);var Xx=s(({image:e,name:t,symbol:r,onPress:o})=>ds.default.createElement(fe,{backgroundColor:"elementBase",borderRadius:"base",padding:16,onPress:o},ds.default.createElement(fe,{gap:12},e,ds.default.createElement(fe,{gap:4,alignItems:"flex-start"},ds.default.createElement(mt,null,t),ds.default.createElement(mt,{color:"textDiminished"},r)))),"TokenCard");var Ia=Vt.default.memo(({enabledAddressTypes:e,selectedAccount:t,tokenWithMetadata:r,type:o,onPress:n})=>{let{token:a,addressType:c}=r,{caip19:p,logoURI:m,name:d,symbol:f}=a,{chainId:h}=p,w=jf(p),{t:y}=Ze(),S=d??y("assetDetailUnknownToken"),T=(0,Vt.useMemo)(()=>{let A=t?.addresses.find(k=>c?k.addressType===c&&k.networkID===h:k.networkID===h)?.address??"";return x.isEVMNetworkID(h)?A.toLowerCase():A},[t,c,h]),b=(0,Vt.useCallback)(()=>{n({tokenWithMetadata:r,ownerPublicKey:T})},[n,r,T]);return c&&!e.includes(c)?Vt.default.createElement(Vt.default.Fragment,null):o==="card"?Vt.default.createElement(Xx,{onPress:b,image:Vt.default.createElement(sm,{logoURI:m,networkId:p.chainId,type:w}),name:S,symbol:f}):Vt.default.createElement(qa,{onPress:b,start:Vt.default.createElement(sm,{logoURI:m,networkId:p.chainId,type:w}),topLeft:{text:S,after:Vt.default.createElement(hg,{networkID:p.chainId,address:T})},bottomLeft:f})});var Jx=s(({enabledAddressTypes:e,group:t,groupIndex:r,selectedAccount:o,onTokenPress:n})=>{let a=r===0;return Go.default.createElement(fe,{key:t.groupName,marginTop:a?8:24},Go.default.createElement(mt,{font:To?"bodyMedium":"title3Semibold",color:"textDiminished",marginBottom:8},t.groupName),Go.default.createElement(fe,{flexWrap:"wrap",direction:"row",gap:a?0:"list"},t.tokens.map((c,p)=>{let{token:m,addressType:d}=c,f=`${m.symbol}-${m.caip19.chainId}-${p}`;return d&&!e.includes(d)?null:a?Go.default.createElement(fe,{key:f,flexBasis:"50%",paddingLeft:p%2===0?0:4,paddingRight:p%2===0?4:0,paddingBottom:p>=t.tokens.length-2?0:8},Go.default.createElement(Ia,{enabledAddressTypes:e,selectedAccount:o,tokenWithMetadata:t.tokens[p],type:"card",onPress:n})):Go.default.createElement(Ia,{key:f,tokenWithMetadata:t.tokens[p],enabledAddressTypes:e,selectedAccount:o,type:"row",onPress:n})})))},"FiatRampTokenGroup");var eE=ms.default.memo(({groupedTokens:e,enabledAddressTypes:t,selectedAccount:r,onTokenPress:o})=>ms.default.createElement(ms.default.Fragment,null,ms.default.createElement(nm,{marginBottom:16}),e.map((n,a)=>ms.default.createElement(Jx,{enabledAddressTypes:t,group:n,groupIndex:a,key:n.groupName,onTokenPress:o,selectedAccount:r}))));u();l();var fs=D(B(),1);var tE=fs.default.memo(({enabledAddressTypes:e,searchedTokens:t,selectedAccount:r,onTokenPress:o})=>fs.default.createElement(fs.default.Fragment,null,t.map((n,a)=>fs.default.createElement(fe,{key:`${n.token.symbol}-${n.token.caip19.chainId}-${a}`,marginBottom:8},fs.default.createElement(Ia,{enabledAddressTypes:e,selectedAccount:r,tokenWithMetadata:n,type:"row",onPress:o})))));var rE=s(e=>{let{isLoading:t,isSearching:r,searchedTokens:o,selectedAccount:n,enabledAddressTypes:a,onTokenPress:c,groupedTokens:p}=e;return jt.default.createElement(jt.default.Fragment,null,t?jt.default.createElement(mN,null):r?jt.default.createElement(jt.default.Fragment,null,o.length>0?jt.default.createElement(tE,{searchedTokens:o,selectedAccount:n,enabledAddressTypes:a,onTokenPress:c}):jt.default.createElement(fN,null)):jt.default.createElement(eE,{enabledAddressTypes:a,groupedTokens:p,selectedAccount:n,onTokenPress:c}))},"FiatRampFungiblesCore"),mN=s(()=>jt.default.createElement(fe,{gap:"list",paddingTop:"screen"},[...Array(3)].map((e,t)=>jt.default.createElement(rn,{key:t,topRight:!1,bottomRight:!1}))),"FiatRampTokensLoading"),fN=s(()=>{let{t:e}=Ze();return jt.default.createElement(fe,{flex:1,alignItems:"center",justifyContent:"center"},jt.default.createElement(mt,{font:"body",color:"textDiminished",align:"center"},e("noBuyOptionsAvailableInCountry")))},"FiatRampTokensEmpty");var oE={container:$u({display:"flex",flexDirection:"column",height:"100%"}),listContainer:$u({overflow:"auto",minHeight:0,paddingTop:16,paddingBottom:80})},nE=s(({platform:e,navigateToForm:t,onBackPress:r})=>{let{t:o}=Ze(),n=Zx({platform:e,version:ke,onClosePress:r,onNextPress:t});return gs.default.createElement(fe,{flex:1,className:oE.container},gs.default.createElement(df,{id:"search",label:"Search",showLabel:!1,placeholder:o("assetListSearch"),setValue:n.setSearchTerm,value:n.searchTerm||""},gs.default.createElement(Xr.Search,{size:16,color:"textDiminished"})),gs.default.createElement(fe,{flex:1,className:oE.listContainer},gs.default.createElement(rE,{...n})))},"FiatRampFungibles");u();l();u();l();var iE=D(B(),1);u();l();var Je=D(B(),1);u();l();var Fa=D(B());var sE=s(({platform:e,navigateToAllProviders:t})=>{let{t:r}=Ze(),o=Dt(),{provider:n,fungible:a}=o,{currencyCode:c}=ft(),{data:p}=_a(e,ke,v.language,{token:a?.caip19,fiatCurrencyCode:c,providerId:n?.id}),m=p?.provider||n;return Fa.default.createElement(fe,{onPress:t,direction:"row",alignItems:"center",justifyContent:"flex-start",gap:4},Fa.default.createElement(Nr,{borderRadius:6,width:20,height:20,src:m?.logo??""}),Fa.default.createElement(mt,{font:"captionSemibold",color:"textBase",children:m?.name||r("fiatRampChangeProviderTitle")}),Fa.default.createElement(Xr.ChevronDown,{size:16}))},"FiatRampSelectedProvider");u();l();var mr=D(B(),1);var am=s(({assets:e,type:t,name:r,onClick:o,estimatedArrival:n})=>{let a=(0,mr.useMemo)(()=>{let c=mr.default.createElement(fe,{borderRadius:"circle",size:48,alignItems:"center",justifyContent:"center",backgroundColor:"black"},mr.default.createElement(Nr,{width:28,height:28,src:e.icon}));switch(t){case zo.CARD:return mr.default.createElement(xs,{icon:"CreditCard",size:48,backgroundColor:"black",color:"white"});case zo.BANK_TRANSFER:return mr.default.createElement(xs,{icon:"Bank",size:48,backgroundColor:"black",color:"white"});case zo.MOBILE_WALLET:return r.toLowerCase().includes("apple")?mr.default.createElement(xs,{icon:"LogoApplePay",size:48,backgroundColor:"black",color:"white"}):r.toLowerCase().includes("google")?mr.default.createElement(xs,{icon:"LogoGooglePay",size:48,backgroundColor:"black",color:"white"}):c;default:return c}},[e.icon,r,t]);return mr.default.createElement(ff,{rows:[{type:"base",start:a,topLeft:{text:r,font:"title3Semibold"},bottomLeft:{before:mr.default.createElement(Xr.Clock,{color:"textDiminished",size:14}),text:n},onPress:o}]})},"FiatRampPaymentMethodRow");var gN=["ios","android"],aE=s(({platform:e,navigateToAllProviders:t,navigateToForm:r})=>{let{t:o}=Ze(),n=we(),a=Dt(),c=Dt(k=>k.setState),{provider:p,fungible:m}=a,{currencyCode:d}=ft(),{data:f,isFetching:h,isPending:w}=_a(e,ke,v.language,{token:m?.caip19,fiatCurrencyCode:d,providerId:p?.id}),{provider:y,paymentMethods:S}=f??{},T=y||p,b=(0,Je.useCallback)(k=>{c({paymentMethod:k,provider:T,checkoutQuoteType:"selected"}),n.capture("fiatOnrampPaymentMethodSelected",{data:{paymentMethodId:k.id}}),r()},[n,r,T,c]),A=(0,Je.useMemo)(()=>h||w?Je.default.createElement(Je.default.Fragment,null,[...Array(3)].map((k,C)=>Je.default.createElement(rn,{key:C,topRight:!1,bottomRight:!1}))):S?.length===0?Je.default.createElement(hN,null):Je.default.createElement(Je.default.Fragment,null,S?.map(k=>Je.default.createElement(am,{key:k.id,onClick:s(()=>b(k),"onClick"),...k}))),[h,w,b,S]);return Je.default.createElement(fe,{gap:12},!gN.includes(e)&&Je.default.createElement(fe,{direction:"row",alignItems:"center",gap:16,justifyContent:"space-between"},Je.default.createElement(mt,{font:"title1Semibold",color:"textBase",children:o("fiatRampPaymentMethodsTitle")}),Je.default.createElement(sE,{platform:e,navigateToAllProviders:t})),Je.default.createElement(mt,{font:"label",color:"textDiminished",children:o("buyThirdPartyScreenPaymentMethodDescription")}),Je.default.createElement(fe,{gap:8},A))},"FiatRampPaymentMethodsCore"),hN=s(()=>{let{t:e}=Ze();return Je.default.createElement(fe,{flex:1,alignItems:"center",justifyContent:"center"},Je.default.createElement(mt,{font:"body",color:"textDiminished",align:"center"},e("buyThirdPartyScreenPaymentMethodEmptyState")))},"FiatRampPaymentMethodsEmpty");var cE=s(({platform:e,navigateToAllProviders:t,navigateToForm:r})=>iE.default.createElement(aE,{platform:e,navigateToAllProviders:t,navigateToForm:r}),"FiatRampPaymentMethods");u();l();var lE=D(B(),1);u();l();var wt=D(B(),1);var uE=s(({platform:e,navigateToPaymentMethods:t})=>{let{t:r}=Ze(),o=we(),n=ze("enable-fiat-ramp-provider-quotes"),a=Dt(),c=Dt(C=>C.setState),{paymentMethod:p,purchaseType:m,purchaseAmount:d,fungible:f,ownerPublicKey:h}=a,{currencyCode:w}=ft(),{data:y,isFetching:S,isPending:T}=rm(e,ke,v.language,{...m==="currency"?{fiatAmount:d}:{tokenAmount:d},token:f?.caip19,fiatCurrencyCode:w,destinationAddress:h&&f?{address:h,chainId:f?.caip19.chainId,resourceType:ee.address}:void 0}),b=y?.paymentMethod||p,A=(0,wt.useCallback)(C=>{o.capture("fiatOnrampProviderSelected",{data:{chainId:y?.token?.chainId,providerId:C.id,paymentMethodId:b?.id,destinationAmount:C.quote?.displayDestinationAmount,sourceAmount:C.quote?.displaySourceAmount,asset:y?.token,tag:C.tag}}),c({provider:C,paymentMethod:b,checkoutQuoteType:"selected"}),t?.()},[o,y?.token,c,b,t]),k=(0,wt.useMemo)(()=>y?.providers.map((C,I)=>{let L=C.id===a.provider?.id;return n?{type:"base",start:wt.default.createElement(Nr,{width:48,height:48,borderRadius:6,src:C.logo}),topLeft:C.name,topRight:{text:C.quote?.displayDestinationAmount,color:"textBase"},bottomRight:C.quote?.displaySourceAmount?{text:`~${C.quote.displaySourceAmount}`}:void 0,bottomLeft:C.tag&&{text:C.tag,color:I===0?"spotPositive":"textDiminished"},onPress:s(()=>A(C),"onPress")}:{type:"radio",active:L,start:wt.default.createElement(Nr,{width:24,height:24,borderRadius:6,src:C.logo}),topLeft:C.name,topRight:C.tag,onPress:s(()=>A(C),"onPress")}})??[],[a.provider?.id,n,A,y?.providers]);return wt.default.createElement(fe,{gap:16},wt.default.createElement(mt,{font:"label",color:"textDiminished",children:r("buyThirdPartyScreenProvidersDescription")}),wt.default.createElement(fe,{gap:8},S||T?wt.default.createElement(wN,null):y?.providers.length===0?wt.default.createElement(yN,null):k.map(C=>wt.default.createElement(qa,{...C,key:C.topLeft}))))},"FiatRampProvidersCore"),yN=s(()=>{let{t:e}=Ze();return wt.default.createElement(fe,{flex:1,alignItems:"center",justifyContent:"center"},wt.default.createElement(mt,{font:"body",color:"textDiminished",align:"center"},e("buyThirdPartyScreenProvidersEmptyState")))},"FiatRampProvidersEmpty"),wN=s(()=>[...Array(3)].map((e,t)=>wt.default.createElement(rn,{key:t,topRight:!1,bottomRight:!1})),"LoadingTable");var pE=s(({platform:e,navigateToPaymentMethods:t})=>lE.default.createElement(uE,{platform:e,navigateToPaymentMethods:t}),"FiatRampProviders");u();l();u();l();u();l();var Ko=D(B(),1);u();l();var Lu=D(B(),1);var im=s(({clientPlatform:e,appVersion:t,locale:r,caip19:o,addressType:n,enabled:a=!0,destinationAddress:c})=>{let{data:p,isLoading:m,isError:d,isFetched:f}=_e(),{data:h=[],isLoading:w,isError:y,isFetched:S}=ls(e,t,r,a),T=(0,Lu.useMemo)(()=>{if(o)return h.find(A=>n&&x.getChainName(We(o).chainId)===x.bitcoin.name?M(A.token.caip19)===o&&"addressType"in A&&A.addressType===n:M(A.token.caip19)===o)},[n,o,h]),b=(0,Lu.useMemo)(()=>{if(!T)return"";if(c)return c;let A=p?.addresses.find(k=>T?.addressType?k.addressType===T.addressType&&k.networkID===T?.token.caip19.chainId:k.networkID===T?.token.caip19.chainId)?.address??"";return T?.token.caip19.chainId&&x.isEVMNetworkID(T.token.caip19.chainId)&&(A=A.toLowerCase()),A},[c,p?.addresses,T]);return(0,Lu.useMemo)(()=>({tokenToBuy:T,destinationAddress:b,isLoading:m||w,isError:d||y,isFetched:f&&S}),[b,y,d,S,f,w,m,T])},"useFiatRampTokenMetadataFromCaip19");var dE=s(({caip19:e,amount:t,clientPlatform:r,redirectURL:o,addressType:n,destinationAddress:a,provider:c,paymentMethod:p,navigateToFiatRampForm:m,onClose:d,captureAnalyticsEvent:f})=>{let{setState:h}=Dt(),{tokenToBuy:w,destinationAddress:y,isLoading:S,isError:T,isFetched:b}=im({clientPlatform:r,appVersion:ke,locale:v.language,caip19:e,addressType:n,destinationAddress:a}),A=(0,Ko.useMemo)(()=>{if(w)return{token:w?.token.caip19,providerId:c,paymentMethodId:p,destinationAddress:{address:y,chainId:w?.token.caip19?.chainId,resourceType:ee.address}}},[w,c,p,y]),{data:k,isLoading:C}=Du(r,ke,v.language,A??{},!!A&&!!c&&!!p),I=(0,Ko.useMemo)(()=>e?C?!1:!!w&&!!y:!0,[e,C,y,w]),L=(0,Ko.useCallback)(()=>{!e||!w||!y||h({...Wr,onClose:d??(()=>{}),ownerPublicKey:y,fungible:w?.token,purchaseAmount:t??Wr.purchaseAmount,redirectURL:o,provider:k?.provider,paymentMethod:k?.paymentMethod})},[e,w,y,h,d,t,o,k?.provider,k?.paymentMethod]),Q=(0,Ko.useCallback)(()=>{if(!e){f?.(),m?.();return}!w||!y||(L(),f?.(),m?.())},[e,f,y,m,L,w]);return(0,Ko.useMemo)(()=>({canBuy:I,openBuy:Q,saturateState:L,resolvedDestinationAddress:y,token:w,isLoading:S,isError:T,isFetched:b}),[I,y,T,b,S,Q,L,w])},"useBuyFlowForToken");u();l();var SN=new Rt("Failed to get FiatRampProviderUrl"),bN=s(async(e,t,r,o,n)=>{try{let a={"x-client-platform":e,"x-client-app-version":t,"x-client-locale":r},c=await K.api().headers(a).bearer(n).post("/fiat_ramp/v2/onramp/provider_url",o);if(!le(c))throw new Rt(c.data.message);return c.data}catch(a){throw a instanceof Rt?a:SN}},"getProviderUrl");u();l();var Uu=D(B());var TN=["enable","reject"],AN=s(({continueSwap:e,dismiss:t})=>{let r=we(),{setSlippageSetting:o}=ao(),n=(0,Uu.useCallback)(c=>{switch(t(),c){case"enable":r.capture("autoSlippageOptIn",{data:{step:"enabledAutoSlippage"}}),o({type:ce.Auto}),ha();break;case"reject":r.capture("autoSlippageOptIn",{data:{step:"rejectedAutoSlippage"}}),o({type:ce.Fixed}),e();break}},[e,t,o,r]),a=(0,Uu.useMemo)(()=>TN.map(c=>({label:v.t(c==="enable"?"swapSlippageOptInEnableOption":"swapSlippageOptInRejectOption"),variant:c==="enable"?"primary":"secondary",onPress:s(()=>n(c),"onPress")})),[n]);return{title:v.t("swapSlippageOptInTitle"),description:v.t("swapSlippageOptInSubtitle"),learnMoreText:v.t("commandLearnMore"),learnMoreUrl:ST,options:a}},"useAutoSlippageOptInProps");u();l();var fE=D(B());u();l();var hs=D(B());var xN=U(1);function mE(e,t,r){let o=we(),[n,a]=(0,hs.useState)(!1),c=(0,hs.useCallback)(async()=>{await o.capture("swapperToggleBestPriceRatio",{data:{unitCurrency:n?"buy token":"sell token"}}),a(!n)},[o,n]),p=V(d=>d.sellFungible),m=V(d=>d.buyFungible);return(0,hs.useMemo)(()=>{let d=!1,f="";if(t&&r){let h=m?.data,w=p?.data;if(h&&w){let{buyAmount:y,sellAmount:S}=r,T=Ee(y,h.decimals),b=Ee(S,w.decimals),A=T.dividedBy(b),k=`1 ${w.symbol} \u2248 ${En(A)} ${h.symbol}`,C=`1 ${h.symbol} \u2248 ${En(xN.dividedBy(A))} ${w.symbol}`;d=new U(r.buyAmount).isEqualTo(e),f=n?C:k}}return{isBestRate:d,rate:f,flip:c}},[e,r,n,t,p,m,c])}s(mE,"useExchangeRate");var EN=s(({selectProvider:e})=>{let{currentQuote:t,quoteResponse:r}=ot(),{currencySymbol:o,fromUsd:n}=ft(),a=t?.buyAmount??"",c=mE(a,r,t),p=Ui(Ue(t)),m=t?.baseProvider.name??"";return{details:(0,fE.useMemo)(()=>t?ne(t)?CN({quote:t,selectProvider:e,exchangeRate:c,currencySymbol:o,fromUsd:n}):kN({provider:m,sources:p,exchangeRate:c,selectProvider:e}):[],[t,m,p,c,e,o,n]),footnote:v.t("swapProviderPricingFootnote")}},"useSwapPricing"),kN=s(({provider:e,sources:t,exchangeRate:r,selectProvider:o})=>[{label:v.t("swapProviderPricingProvider"),value:e,icon:"chevron-right",onPress:o},{label:v.t("swapProviderPricingMarket"),value:t},{label:v.t("swapProviderPricingPrice"),value:r.rate,icon:"swap",onPress:r.flip}],"getStandardRows"),CN=s(({quote:e,selectProvider:t,exchangeRate:r,currencySymbol:o,fromUsd:n})=>{let a=e.baseProvider.name,c=Un(e).toString(),p=Fr(go(e));return[{label:v.t("swapProviderPricingProvider"),value:a,icon:"chevron-right",onPress:t},{label:v.t("swapProviderPricingPrice"),value:r.rate,icon:"swap",onPress:r.flip},{label:v.t("swapProviderPricingFees"),value:`${o}${n(Number(c),2)} ${v.t("swapProvidersFee")}`},{label:v.t("swapProviderPricingTime"),value:p}]},"getBridgeRows");u();l();u();l();var cm=D(B());var _N=.05,IN=s(({sellNetworkId:e,buyNetworkId:t,destinationMinRequiredBalance:r,priceMap:o})=>{if(!e||!t||!o)return new _(0);let n=M(hr(x.getChainID(e))),a=M(hr(x.getChainID(t))),c=o[n]?.usd,p=o[a]?.usd;if(!c||!p)return new _(0);let m=Ee(r.toNumber(),x.getTokenDecimals(t)),d=og(m.toNumber(),p),f=ng(d,c,x.getTokenDecimals(e));return new _(f).times(1+_N)},"getSourceBridgeFeeForMinRequiredBalance"),gE=s(({sellFungible:e,buyFungible:t})=>{let r=e?.data.chain.id,o=t?.data.chain.id,n=o??r,a=Wt(r,o),{fungible:c}=ri({key:t?.data.key}),{data:p}=_e(),m=(0,cm.useMemo)(()=>p?.addresses.find(y=>y.networkID===n),[p,n]),f=yo().map(y=>hr(y)),{data:h}=Jr({query:{data:f},queryOptions:{refetchInterval:!1}}),{data:w=0}=xo(m);return(0,cm.useMemo)(()=>{if(c)return new _(0);let y=new _(w);return a?IN({sellNetworkId:r,buyNetworkId:o,destinationMinRequiredBalance:y,priceMap:h}):y},[c,w,a,r,o,h])},"useDestinationMinRequiredBalance");u();l();var um=D(B());var hE=s(e=>{let t=e?.data.chain.id,{data:r}=_e(),o=(0,um.useMemo)(()=>r?.addresses.find(a=>a.networkID===t),[r,t]),{data:n=0}=xo(o);return(0,um.useMemo)(()=>new _(n),[n])},"useSourceMinRequiredBalance");u();l();function yE({sellFungible:e,totalFees:t,minRequiredBalance:r,currentQuote:o}){let n=e?.type?Mt(e?.type):!1,{source:a,destination:c}=r;if(n){let p=new _(o?.sellAmount??0);return t.plus(p)}else{let p=a.plus(c);return t.plus(p)}}s(yE,"getTotalNativeRequirement");u();l();function wE({sellFungible:e,sellNativeFungible:t,totalNativeRequirement:r}){let o=e?.data.chain.id,n=t?Et(t.data.amount,t.data.decimals):"-",a=t?Et(r,t.data.decimals):"-";return{networkId:o,balance:n,required:a}}s(wE,"getInsufficientBalanceArgs");u();l();var SE=D(B());var FN=s(({goToAssetSelect:e})=>{let{setSearchQuery:t}=V();return(0,SE.useCallback)(r=>{r==="buy"&&t(""),e(r)},[e,t])},"useOnSwapAssetSelect");u();l();var Rr=D(B());u();l();u();l();var Ou=class{static{s(this,"StandardProviderRowStrategy")}getRow({quote:t,buyToken:r}){let o=`${ir(Ee(t.buyAmount,r.decimals),ar.get(r.networkId).formDisplayPrecision)} ${r.symbol}`;return{type:"standard",key:t.baseProvider.id,logoUri:t.baseProvider.logoUri,topLeft:{text:t.baseProvider.name},topRight:{text:o,color:"textDiminished"}}}getAutoRow(){return{type:"standard",key:cr,topLeft:{text:v.t("selectSwapProviderAutoLabel")},topRight:{text:v.t("selectSwapProviderAutoDescription"),color:"textDiminished"}}}},lm=class extends Ou{static{s(this,"BridgeProviderRowStrategy")}getRow(t){let{quote:r,currencySymbol:o,fromUsd:n}=t;if(!ne(r))throw new Error("Quote is not a bridge quote");let a=super.getRow(t),c=Fr(go(r)),p=Un(r).toString();return{...a,type:"bridge",bottomLeft:{text:c},bottomRight:{text:`${o}${n(Number(p),2)} ${v.t("swapProvidersFee")}`}}}getAutoRow(){return{type:"bridge",key:cr,topLeft:{text:v.t("selectSwapProviderAutoLabel")},topRight:{text:v.t("selectSwapProviderAutoDescription"),color:"textDiminished"},bottomLeft:{text:v.t("selectSwapProviderAutoTBD")},bottomRight:{text:v.t("selectSwapProviderAutoTBD")}}}},pm=new Ou,dm=new lm;var Mu=s(({quoteResponse:e,buyToken:t,currencySymbol:r,setSelectedProvider:o,fromUsd:n})=>{let a=e.type==="xchain",c=a?dm.getAutoRow():pm.getAutoRow(),p={...c,onPress:s(()=>o(c.key),"onPress")},m=e.quotes.reduce((d,f)=>{let w=(a?dm:pm).getRow({quote:f,buyToken:t,currencySymbol:r,fromUsd:n});return[...d,{...w,onPress:s(()=>o(f.baseProvider.id),"onPress")}]},[]);return[p,...m]},"getSwapProviderRows");var vN=s(({dismiss:e})=>{let{fromUsd:t,currencySymbol:r}=ft(),o=we(),n=je(),a=Vr(S=>S.setPreferredProvider),c=Vr(S=>S.preferredProvider),[p,m]=(0,Rr.useState)(c??cr),[d,f]=(0,Rr.useState)(n.getQuoteProcessorState());(0,Rr.useEffect)(()=>{let S=n.subscribeQuoteProcessor({onStateChange(T,b){f(b)}});return()=>S()},[n]);let h=(0,Rr.useMemo)(()=>{let S=d.type;if(S!=="firstQuoteReceived"&&S!=="quoteProcessed")return[];let{response:T,input:b}=d,{buy:A}=b;return Mu({quoteResponse:T,buyToken:{networkId:A.data.chain.id,decimals:A.data.decimals,symbol:A.data.symbol??""},currencySymbol:r,setSelectedProvider:m,fromUsd:t})},[d,r,t]),w=(0,Rr.useCallback)(()=>{let S=p===cr?void 0:p;a(S),o.capture("swapperProviderSelected",{data:{provider:S}}),e()},[p,a,e,o]),y=(0,Rr.useMemo)(()=>[{theme:"secondary",disabled:!1,label:v.t("commandCancel"),onPress:e},{theme:"primary",disabled:p===(c??cr),label:v.t("commandApply"),onPress:w}],[w,e,p,c]);return{selectedProvider:p,rows:h,buttons:y}},"useSelectPreferredProvider");u();l();var Vo=D(B());var PN=s(({dismiss:e})=>{let{fromUsd:t,currencySymbol:r}=ft(),o=we(),n=V(S=>S.quoteResponse),a=V(S=>S.buyFungible),c=V(S=>S.selectedBaseProvider),p=V(S=>S.setSelectedBaseProvider),m=Vr(S=>S.setPreferredProvider),[d,f]=(0,Vo.useState)(c),h=(0,Vo.useMemo)(()=>!n||!a?[]:Mu({quoteResponse:n,buyToken:{networkId:a.data.chain.id,decimals:a.data.decimals,symbol:a.data.symbol??""},currencySymbol:r,setSelectedProvider:f,fromUsd:t}),[n,a,r,t,f]),w=(0,Vo.useCallback)(()=>{p(d),m(d),o.capture("swapperProviderSelected",{data:{provider:d}}),e()},[d,p,m,e,o]),y=(0,Vo.useMemo)(()=>[{background:"element",disabled:!1,label:v.t("commandCancel"),onPress:e},{background:"spot",disabled:d===c,label:v.t("commandApply"),onPress:w}],[w,e,d,c]);return{selectedProvider:d,rows:h,buttons:y}},"useSelectSwapProvider");u();l();var ys=D(B());var va=Ye(e=>({isInitializeComplete:!0,swapMode:void 0,setSwapMode:s(t=>e({swapMode:t,isInitializeComplete:!1}),"setSwapMode"),setIsInitializeComplete:s(t=>e({isInitializeComplete:t}),"setIsInitializeComplete")})),RN=va.getState().setSwapMode,DN=s(()=>va(e=>e.isInitializeComplete===!1),"useInitializingClassicSwapMode"),NN=s(()=>{let e=je(),t=of(),r=Mo(),{pairs:o}=Zn(),n=(0,ys.useMemo)(()=>t.find(d=>r.includes(d))??$o.Mainnet,[t,r]),a=va(d=>d.swapMode),c=va(d=>d.setSwapMode),p=va(d=>d.setIsInitializeComplete);(0,ys.useEffect)(()=>e.subscribeToken({onStateChange:s(f=>{f.type==="initializeCompleted"&&p(!0)},"onStateChange")}),[e,p]);let m=(0,ys.useMemo)(()=>{if(!o)return{sellCaip19:void 0,buyCaip19:void 0};let d=s(w=>w&&t.includes(w.data.chain.id)&&r.includes(w.data.chain.id),"isValidToken"),f=d(o.sellFungible)?o.sellFungible:void 0,h=d(o.buyFungible)?o.buyFungible:void 0;return{sellCaip19:f?M(X(f)):void 0,buyCaip19:h?M(X(h)):void 0}},[o,t,r]);return(0,ys.useMemo)(()=>{if(a)return a;let d,f=BN(m);return f?d=f:d={type:"swap",network:n,takerCaip19:void 0,takerDestinationCaip19:void 0},c(d),d},[n,m,a,c])},"useClassicSwapMode"),BN=s(e=>e.sellCaip19&&e.buyCaip19?{type:"swap",network:We(e.sellCaip19).chainId,sellCaip19:e.sellCaip19,buyCaip19:e.buyCaip19,takerCaip19:void 0,takerDestinationCaip19:void 0}:null,"parseFromLastSubmitted");u();l();var Me=D(B());u();l();function Qu(e,t,r,o){if(r==="sell")return o.includes("insufficientBalance");let n=e?.sellAmount,a=t.find(c=>c.percentage===1)?.amount.toString();return!!n&&!!a&&new _(n).gt(a)}s(Qu,"hasInsufficientSellBalance");var LN=s(e=>{let{tokenState:t,quotedAmounts:r,quoteProcessorState:o,sellPercentages:n,inputErrors:a,setAmount:c}=e,p=ze("enable-be-swapper-max-amount"),[m,d]=(0,Me.useState)(void 0),[f,h]=(0,Me.useState)(""),[w,y]=(0,Me.useState)("crypto"),[S,T]=(0,Me.useState)("sell"),b=(0,Me.useRef)(!1),{currencySymbol:A,toUsd:k,fromUsd:C,formatLocalizedPrice:I}=ft(),L=hf(),{balanceDisplayStrategy:Q}=eT(),R=vi(),H=pb(),q=je(),E=(0,Me.useCallback)((Ie,Re,at,De)=>{if(d(void 0),Ie===""){h(Ie),c({amount:"0",denomination:De??w,perspective:Re,tokenStateOverride:at});return}let bt=fg(Ie);jN(bt)&&(h(bt),c({amount:w==="fiat"?String(k(bt)):bt,denomination:De??w,perspective:Re,tokenStateOverride:at}))},[w,h,c,k]),F=(0,Me.useCallback)((Ie,Re)=>{S==="buy"&&T("sell"),d(Ie);let at=Ie.getAmountForDenomination(w),De=w==="fiat"?C(at.toString()):at.toString();h(HN(new U(De),w,Re)),c({amount:at.toString(),denomination:w,perspective:"sell"})},[d,S,w,c,C]),z=(0,Me.useCallback)(()=>{q.switchTokens()},[q]),W=(0,Me.useCallback)(Ie=>{let Re=GN({perspective:S,currencyDenomination:w,quotedAmounts:r,fromUsd:C});Re&&E(Re.toString(),S,Ie)},[w,S,E,r,C]);(0,Me.useEffect)(()=>q.subscribeToken({onStateChange:s((Re,at,De)=>{Re.type==="switchTokens"&&(W(De),b.current=!0,p&&q.refreshPair({swapMode:Re.mode,cashAddresses:R,settings:H})),p&&Re.type==="changeToken"&&(b.current=!0,q.refreshPair({swapMode:Re.mode,cashAddresses:R,settings:H}))},"onStateChange")}),[q,W,R,H,p]),(0,Me.useEffect)(()=>{b.current&&(b.current=!1,E(f,S))},[n]);let re=(0,Me.useCallback)(()=>{let Ie=w==="crypto"?"fiat":"crypto";if(y(Ie),!!r)switch(Ie){case"crypto":let Re=fm(S,r);h(Re.toString());break;case"fiat":let at=mm(S,r)?.toFixed(2)??"0",De=C(at);h(String(De));break}},[w,S,r,C]),Z=(0,Me.useMemo)(()=>kT(),[]),{sellAsset:He,buyAsset:Le}=bE(t),st=ET({sellAsset:He,buyAsset:Le,currencyDenomination:w}),jo=(0,Me.useMemo)(()=>zN(["sell","buy"],Ie=>UN({perspective:Ie,tokenState:t,quoteProcessorState:o,currencyDenomination:w,currentPerspective:S,inputAmount:f,inputErrors:a,isBalanceHidden:L,balanceDisplayStrategy:Q,sellPercentages:n,currencyDenominationSupportRules:Z,isBuyAmountEditable:st,quotedAmounts:r,currencySymbol:A,fromUsd:C,formatLocalizedPrice:I})),[w,f,a,L,Q,n,S,o,r,t,Z,st,A,C,I]),bo=(0,Me.useCallback)(()=>{E("",S)},[E,S]);(0,Me.useEffect)(()=>{let Ie=q.subscribeToken({onStateChange(Re,at,De){!ct(at)||!ct(De)||Re.type==="changeToken"&&at.sellToken.data.tokenAddress!==De.sellToken.data.tokenAddress&&bo()}});return()=>Ie()},[q,bo]),(0,Me.useEffect)(()=>q.subscribeAccountChange({onAccountChange:s(Re=>{bo(),q.stopQuoteProcessor();let at=q.getTokenState(),De=Re.addresses[0];ct(at)&&De&&q.initializeSwap({swapMode:{type:"swap",network:De.networkID,takerCaip19:void 0,takerDestinationCaip19:void 0},cashAddresses:R,settings:H})},"onAccountChange")}),[q,bo,R,H]);let Ra=(0,Me.useCallback)(Ie=>{if(T(Ie),!r||!ct(t))return;let{sellAsset:Re,buyAsset:at}=bE(t);if(!(Ie==="sell"?Re:at))return;let bt,J;switch(w){case"crypto":bt=fm(Ie,r).toString(),J=bt;break;case"fiat":let ws=mm(Ie,r)?.toFixed(2)??"0";bt=String(C(ws)),J=ws;break}h(bt),c({amount:J,denomination:w,perspective:Ie})},[w,r,t,C,h,c]);return{inputAmount:f,tokens:jo,currencyDenomination:w,inputPerspective:S,tokenState:t,quotedAmounts:r,quoteProcessorState:o,inputErrors:a,currentSellPercentage:m,sellPercentages:n,switchTokens:z,setInputAmount:E,switchCurrencyDenomination:re,setSellPercentage:F,clearInput:bo,setInputPerspective:Ra,setCurrencyDenomination:y}},"useClassicSwapperAssets");function UN({perspective:e,tokenState:t,quoteProcessorState:r,currencyDenomination:o,currentPerspective:n,inputAmount:a,inputErrors:c,isBalanceHidden:p,balanceDisplayStrategy:m,sellPercentages:d,currencyDenominationSupportRules:f,isBuyAmountEditable:h,quotedAmounts:w,currencySymbol:y,fromUsd:S,formatLocalizedPrice:T}){if(!ct(t))return;let b=QN(e,w),A=qN(e,n,t,a,w),k=o==="crypto"?b:new U(S(A)).toFixed(2),C=VN(a);e===n?k=a:C.gt(0)||(k="");let I=f.every(F=>F.isSupported(e,t.sellToken,t.sellTokenPrice?.usd,t.buyToken,t.buyTokenPrice?.usd)),L=e==="sell"?t.sellToken:t.buyToken,Q=o==="crypto"?T(new U(S(A)).toNumber()):MN(b,L),R=d.find(F=>F.percentage===1)?.amount.toString(),H=e==="sell"?R:void 0,q=ON(w,d,n,c);return{perspective:e,fungible:L,balance:KN(L,m,p,H),amount:k,secondaryAmount:C.gt(0)?Q:"",isAmountLoading:r.type==="starting"&&e!==n,isSecondaryAmountLoading:r.type==="starting",hasAmountWarning:q,isAmountEditable:e==="sell"?!0:h,supportsCurrencyDenominationSwitching:I,amountPrefix:o==="fiat"?y:void 0,percentages:e==="sell"?d:[],warnings:e==="buy"?t.warnings:[]}}s(UN,"createSwapperAsset");function ON(e,t,r,o){return Qu(e,t,r,o)?!0:o.length>0}s(ON,"hasInputAmountWarning");function MN(e,t){let r=ar.get(t.data.chain.id).formDisplayPrecision;return`${ir(new U(e),r)} ${t.data.symbol??""}`}s(MN,"formatSecondaryAmount");function QN(e,t){return t?fm(e,t).toString():"0"}s(QN,"parseCyrptoAmount");function qN(e,t,r,o,n){if(n)return mm(e,n)?.toString()??"0";{if(e!==t||!ct(r))return"0";let a=e==="sell"?r.sellTokenPrice:r.buyTokenPrice;return a?.usd?new U(o).times(a.usd).toString():"0"}}s(qN,"parseFiatAmount");function mm(e,t){switch(e){case"sell":return t?.sellAmountUsd;case"buy":return t?.buyAmountUsd}}s(mm,"getQuotedUsdAmount");function fm(e,t){switch(e){case"sell":return t.sellAmount;case"buy":return t.buyAmount}}s(fm,"getQuotedCryptoAmount");function zN(e,t){return e.reduce((r,o,n)=>{let a=t(o,n,e);return a!=null&&r.push(a),r},[])}s(zN,"compactMap");function GN({perspective:e,currencyDenomination:t,quotedAmounts:r,fromUsd:o}){if(r)switch(e){case"sell":return t==="crypto"?r.buyAmount:r.buyAmountUsd?new U(o(r.buyAmountUsd.toString(),2)):void 0;case"buy":return t==="crypto"?r.sellAmount:r.sellAmountUsd?new U(o(r.sellAmountUsd.toString(),2)):void 0}}s(GN,"getOppositeQuotedAmount");function KN(e,t,r,o){let n=o?U(o):e.data?.balance;if(!(!n||r))return Ke(e)?Qa(n):t.format(n,e.data?.symbol??"")}s(KN,"parseBalance");function VN(e){return e==null?new U(0):e===""?new U(0):new U(e)}s(VN,"normalizeInputAmount");function jN(e){try{let t=new U(e);return t.isFinite()?!t.isNegative():!1}catch{return!1}}s(jN,"isValidAmount");function bE(e){return ct(e)?{sellAsset:e.sellToken,buyAsset:e.buyToken}:{sellAsset:void 0,buyAsset:void 0}}s(bE,"getTokens");var HN=s((e,t,r)=>t==="fiat"?e.gte(.01)?e.decimalPlaces(2).toString():e.decimalPlaces(5,U.ROUND_UP).toString():e.decimalPlaces(r.data.decimals).toString(),"truncateDisplayAmount");u();l();var kE=D(B());u();l();var hm=D(B());u();l();var Gu=D(B());u();l();u();l();var qu=class{static{s(this,"GaslessSwapInterceptor")}gaslessSwapFeeResult;insufficientFundsInterceptor;constructor(t,r){this.gaslessSwapFeeResult=t,this.insufficientFundsInterceptor=r}intercept(t){return this.gaslessSwapFeeResult.success?"continue":this.insufficientFundsInterceptor.intercept(t)}};u();l();var zu=class{static{s(this,"InsufficientFundsInterceptor")}intercept({hasInsufficientFunds:t,showInsufficientFunds:r}){return t?(r(),"interrupt"):"continue"}};var TE=s(e=>{let t=new zu,r=$N(e);return r?[new qu(r,t)]:[t]},"getExecuteSwapInterceptors"),$N=s(e=>{if(e.type!=="firstQuoteReceived"&&e.type!=="quoteProcessed")return;let t=e.quote;if(Ct(t))return t.gaslessSwapFeeResult},"getGaslessSwapFeeResult");var AE=s(e=>{let t=(0,Gu.useMemo)(()=>TE(e.quoteProcessorState),[e.quoteProcessorState]);return{executeSwapInterceptors:(0,Gu.useCallback)(()=>{for(let o of t){let n=o.intercept(e);if(n==="interrupt")return n}return"continue"},[t,e])}},"useExecuteSwapInterceptors");u();l();var gm=D(B());var xE=s((e,t)=>{let{sellFungible:r,buyFungible:o}=WN(e),n=YN(t),a=hE(r),c=gE({sellFungible:r,buyFungible:o}),p=(0,gm.useMemo)(()=>ZN(t),[t]),m=r?.data.chain.id,{fungible:d}=ri({key:m?cg(m,void 0):void 0,enableSorting:!1,enablePrices:!1});return(0,gm.useMemo)(()=>{if(!r||!d||!o||!n)return{hasInsufficientFunds:!1,insufficientFundsArgs:void 0,analyticsFields:void 0};if(Ke(r)||Ke(o))return{hasInsufficientFunds:!1,insufficientFundsArgs:void 0,analyticsFields:Yp(t)};let f=yE({sellFungible:r,totalFees:p,minRequiredBalance:{source:a,destination:c},currentQuote:n}),h=Yp(t);return{hasInsufficientFunds:new _(d?.data.amount??0).lt(f),insufficientFundsArgs:wE({sellFungible:r,sellNativeFungible:d,totalNativeRequirement:f}),analyticsFields:h}},[r,o,n,p,a,c,d,t])},"useHasInsufficientFunds");function WN(e){return e.type!=="pair"?{sellFungible:void 0,buyFungible:void 0}:{sellFungible:e.sellToken,buyFungible:e.buyToken}}s(WN,"getTokens");function ZN(e){return e.type!=="quoteProcessed"?new _(0):e.nextProcessedQuote.fees.fees.reduce((t,r)=>t.plus(r.amount),new _(0))}s(ZN,"getTotalFees");function YN(e){if(e.type==="quoteProcessed")return e.quote}s(YN,"getQuote");var EE=s(({performSwap:e,goToInsufficientFunds:t,tokenState:r,quoteProcessorState:o})=>{let{hasInsufficientFunds:n,insufficientFundsArgs:a,analyticsFields:c}=xE(r,o),p=(0,hm.useCallback)(()=>a&&t(a,c),[t,a,c]),{executeSwapInterceptors:m}=AE({hasInsufficientFunds:n,showInsufficientFunds:p,quoteProcessorState:o});return{swap:(0,hm.useCallback)(()=>{m()==="continue"&&e()},[m,e])}},"useExecuteSwapAction");var ym=class{static{s(this,"ClassicExecuteSwapStateListener")}resetSwapper;storePairs;constructor(t,r){this.resetSwapper=t,this.storePairs=r}onStateChange(t,r,o,n){t.type===j.ExecuteSwapStarted&&(this.resetSwapper(),this.storePairs(t.executingQuote.sell,t.executingQuote.buy))}},wm=class{static{s(this,"UpdateBalancesExecuteSwapStateListener")}swapper;constructor(t){this.swapper=t}onStateChange(t,r,o,n){let{sell:a,quote:c}=o.executingQuote;if(t.type===j.TransactionConfirmed){let p=a.data.balance?new _(a.data.balance):void 0;if(!p)return;let m=new _(c.sellAmount).shiftedBy(-a.data.decimals),d=p.minus(m);this.swapper.updateBalances({sellTokenBalance:d,sellTokenCaip19:M(X(a))})}}},XN=s(({swapMode:e,quotedAmounts:t,tokenState:r,inputErrors:o,quoteProcessorState:n,currentPerspective:a,sellPercentages:c,showFungibleDetails:p,showBuyFungibleScreen:m,retryAndNavigateToSwapper:d,resetSwapper:f,goToInsufficientFunds:h,preprocessor:w})=>{let y=je(),S=QA(),{storePairs:T}=Zn(),b=(0,kE.useCallback)(()=>{S({showFungibleDetails:p,showBuyFungibleScreen:m,showRetrySwap:d,swapMode:e,executeSwapStateListeners:[new ym(f,T),new wm(y)],quotedAmounts:t,uiContext:"swapperClassic",preprocessor:w})},[S,p,m,d,e,f,T,t,y,w]),{swap:A}=EE({performSwap:b,goToInsufficientFunds:h,tokenState:r,quoteProcessorState:n});return{buttonState:JN(r,o,t,n,a,c),swap:A}},"useClassicSwapperButton"),JN=s((e,t,r,o,n,a)=>e.type!=="pair"?{type:"untradable",label:""}:o.type==="error"?{type:"untradable",label:v.t("swapNoQuotesFound")}:Qu(r,a,n,t)?{type:"insufficientBalance",label:v.t("swapReviewInsufficientBalance")}:o.type!=="quoteProcessed"?{type:"loading",label:v.t("swapReviewFlowActionButtonPrimary")}:r?{type:"tradable",label:v.t("swapReviewFlowActionButtonPrimary")}:{type:"untradable",label:v.t("swapReviewFlowActionButtonPrimary")},"parseTradeButtonState");u();l();var Ku=D(B(),1);u();l();var Zr=s(()=>!0,"defaultShouldDehydrateQueryPredicate"),CE={auth:Zr,tokens:Zr,prices:Xf,collectibles:ug,currency:gf,staking:yg,swapper:Sd,transferFungibleLoggingContext:Zr,user:sf,[Wu]:Zr,[pf]:Zr,[Ca]:Zr,[wg]:Zr,[vs]:Zr,[Kt]:Zr,"test-debug-query":Na},_E=s(e=>{if(e.queryKey.length===0)return!1;let t=String(e.queryKey[0]);return e.state.status!=="success"?!1:CE[t]?CE[t](e):!1},"shouldDehydrateQuery");var IE=new Vm({defaultOptions:{mutations:{retry:!1,networkMode:"offlineFirst"},queries:{retry:!1,staleTime:1/0,gcTime:1/0,refetchOnWindowFocus:!1,networkMode:"offlineFirst"}}}),eB=zm({underlyingStorage:new zf,throttleMs:1e3,enableDebugLogs:Na()}),tB=s(({children:e})=>(Rh([[Vf,IE]]),e),"HydrateAtoms"),wRe=s(e=>Ku.default.createElement(Hm,{client:IE,persistOptions:{persister:eB,dehydrateOptions:{shouldDehydrateQuery:_E},buster:rB,maxAge:1/0}},Ku.default.createElement(Kf,null,Ku.default.createElement(tB,null,e.children))),"QueryProvider"),rB="25.2.0";u();l();var Pa=D(Em(),1),vE=D(B(),1),et=D(vm(),1);u();l();function Ae(e,t,r=$e()){return{jsonrpc:"2.0",id:r,method:e,params:t}}s(Ae,"createRpcRequest");u();l();var fr=D(vm(),1);var nB=s(async()=>{let e=Ae("getPhantomOrganization",[]),t=await tt(fr.default.runtime,e);if("error"in t)throw new Error(t.error.message);return t.result},"getPhantomOrganization"),sB=s(async()=>{let e=Ae("getOrCreatePhantomOrganization",[]),t=await tt(fr.default.runtime,e);if("error"in t)throw new Error(t.error.message);return t.result},"getOrCreatePhantomOrganization"),aB=s(async()=>{let e=Ae("RetrieveKMSWallet",[]),t=await tt(fr.default.runtime,e);if("error"in t)throw new Error(t.error.message);return t.result},"retrieveKMSWallet"),vRe=s(async()=>{let e=Ae("GetKMSWalletStatus",[]),t=await tt(fr.default.runtime,e);if("error"in t)throw new Error(t.error.message);return t.result},"getKMSWalletStatus"),PRe=s(async(e,t,r,o,n)=>{let a=Ae("addUserToCurrentUserOrganization",[e,t,r,o,n]),c=await tt(fr.default.runtime,a);if("error"in c)throw new Error(c.error.message);return c.result},"addUserToCurrentUserOrganization"),iB=s(async(e,t)=>{let r=Ae("deleteUserFromOrganization",[e,t]),o=await tt(fr.default.runtime,r);if("error"in o)throw new Error(o.error.message);return o.result},"deleteUserFromOrganization"),FE=s(()=>({getPhantomOrganization:s(async()=>await nB(),"getPhantomOrganization"),getOrCreatePhantomOrganization:s(async()=>await sB(),"getOrCreatePhantomOrganization"),retrieveKMSWallet:s(async()=>await aB(),"retrieveKMSWallet"),deleteUserFromOrganization:s(async({organizationId:e,username:t})=>await iB(e,t),"deleteUserFromOrganization"),getKmsAccounts:s(async()=>{let e=Ae("getKmsAccounts",[]),t=await tt(fr.default.runtime,e);if("error"in t)throw new Error(t.error.message);return t.result},"getKmsAccounts"),getWalletWithTag:s(async({organizationId:e,tag:t})=>{let r=Ae("getWalletWithTag",[e,t]),o=await tt(fr.default.runtime,r);if("error"in o)throw new Error(o.error.message);return o.result},"getWalletWithTag"),updateUserInOrganization:s(async({organizationId:e,username:t,newPolicy:r,addTraits:o,removeTraits:n})=>{let a=Ae("updateUserInOrganization",[e,t,n,o,r]),c=await tt(fr.default.runtime,a);if("error"in c)throw new Error(c.error.message);return c.result},"updateUserInOrganization"),getAccounts:s(async({organizationId:e,walletId:t,accounts:r})=>{let o=Ae("getAccounts",[e,t,r]),n=await tt(fr.default.runtime,o);if("error"in n)throw new Error(n.error.message);return n.result},"getAccounts")}),"createKMSProxy");var cB=FE(),uB=s(async(e,t,r)=>{let o=t.fold(c=>Buffer.from(c.buffer).toString("base64")),n=Ae("importPrivateKeyAccount",[e,o,r]),a=await P.startSpan("importPrivateKeyAccount",()=>tt(et.default.runtime,n));if("error"in a)throw new Error(a.error.message);if(typeof a.result=="string")return JSON.parse(a.result);throw new Error("importPrivateKeyAccount: Invalid response from background script")},"importPrivateKeyAccount"),KRe=s(async(e,t,r)=>{let o=e.getEntropy(),n=Ae("importSeedAccount",[Pa.default.encode(o),t,r]);o.fill(0);let a=await P.startSpan("importSeedAccount",()=>tt(et.default.runtime,n));if("error"in a)throw new Error(a.error.message);if(typeof a.result=="string")return JSON.parse(a.result);throw new Error("importS*edAccount: Invalid response from background script")},"importSeedAccount"),VRe=s(async(e,t,r)=>{let o=e.getEntropy(),n=Ae("importSocialSeedAccount",[Pa.default.encode(o),t,r]);o.fill(0);let a=await P.startSpan("importSeedlessAccount",()=>tt(et.default.runtime,n));if("error"in a)throw new Error(a.error.message);if(typeof a.result=="string")return JSON.parse(a.result);throw new Error("importS*edlessAccount: Invalid response from background script")},"importSeedlessAccount"),jRe=s(async e=>{let t=e.getEntropy(),r=Ae("isExistingSeed",Pa.default.encode(t));t.fill(0);let o=await P.startSpan("isExistingSeed",()=>tt(et.default.runtime,r));if("error"in o)throw new Error(o.error.message);if(typeof o.result=="boolean"||o.result===null)return o.result;throw new Error("isExistingS*ed: Invalid response from background script")},"isExistingSeed"),lB=s(async e=>{let t=Ae("addAccountForSeed",[e]),r=await P.startSpan("addAccountForSeed",async()=>At(await et.default.runtime.sendMessage(Bt(t))));if("error"in r)throw new Error(r.error.message);if(typeof r.result=="string")return JSON.parse(r.result);throw new Error("addAccountForS*ed: Invalid response from background script")},"addAccountForSeed"),pB=s(async e=>{let t=Ae("addAccountForSeedless",[e]),r=await P.startSpan("addAccountForSeedless",async()=>At(await et.default.runtime.sendMessage(Bt(t))));if("error"in r)throw new Error(r.error.message);if(typeof r.result=="string")return JSON.parse(r.result);throw new Error("addAccountForS*ed: Invalid response from background script")},"addAccountForSeedless"),dB=s(async(e,t)=>{let r=Ae("addLedgerAccounts",[e,t]),o=await P.startSpan("connectLedgerAccounts",async()=>At(await et.default.runtime.sendMessage(Bt(r))));if("error"in o)throw new Error(o.error.message);if(typeof o.result=="string")return JSON.parse(o.result);throw new Error("connectLedgerAccounts: Invalid response from background script")},"connectLedgerAccounts"),mB=s(async e=>{let t=Ae("importReadOnlyAccount",e),r=await P.startSpan("addReadonlyAccount",async()=>At(await et.default.runtime.sendMessage(Bt(t))));if("error"in r)throw new Error(r.error.message);if(typeof r.result=="string")return JSON.parse(r.result);throw new Error("addReadonlyAccount: Invalid response from background script")},"addReadonlyAccount"),HRe=s(async(e,t,r)=>{let o=Ae("exportPrivateKey",[e,t,r]),n=await P.startSpan("exportPrivateKey",async()=>At(await et.default.runtime.sendMessage(Bt(o))));if("error"in n)throw new Error(n.error.message);if(typeof n.result=="string")return Vu.from(Buffer.from(n.result,"hex"));throw new Error("exportPrivateKey: Invalid response from background script")},"exportPrivateKey"),$Re=s(async(e,t)=>{let r=Ae("exportEntropy",[e,t]),o=await P.startSpan("exportEntropy",async()=>At(await et.default.runtime.sendMessage(Bt(r))));if("error"in o)throw new Error(o.error.message);if(typeof o.result=="string")return Vu.from(Buffer.from(o.result,"hex"));throw new Error("exportEntropy: Invalid response from background script")},"exportEntropy"),fB=s(async()=>{let e=Ae("deriveAddresses",void 0),t=await tt(et.default.runtime,e);if("error"in t)throw new Error(t.error.message);return t.result},"deriveAddresses"),gB=s(async e=>{let t=Ae("removeAccount",e),r=await tt(et.default.runtime,t);if("error"in r)throw new Error(r.error.message);return r.result},"removeAccount"),hB=s(async(e,t)=>{let r=Ae("reorderAccount",{identifier:e,toIndex:t}),o=await tt(et.default.runtime,r);if("error"in o)throw new Error(o.error.message);return o.result},"reorderAccount"),yB=s(async()=>{let e=Ae("getAllAccounts",void 0),t=At(await et.default.runtime.sendMessage(Bt(e)));if("error"in t)throw new Error(t.error.message);if(typeof t.result=="string"){let r=JSON.parse(t.result);return Jm({accounts:r}).accounts}throw new Error("fetchAllAccounts: Invalid response from background script")},"fetchAllAccounts"),wB=s(async()=>{let e=Ae("getAllSeeds",void 0),t=At(await et.default.runtime.sendMessage(Bt(e)));if("error"in t)throw new Error(t.error.message);if(typeof t.result=="string")return JSON.parse(t.result);throw new Error("fetchAllSe*dMetas: Invalid response from background script")},"fetchAllSeedMetas"),SB=s(async()=>{let e=Ae("getAllSeedlessSeeds",void 0),t=At(await et.default.runtime.sendMessage(Bt(e)));if("error"in t)throw new Error(t.error.message);if(typeof t.result=="string")return JSON.parse(t.result);throw new Error("fetchAllSe*dlessMetas: Invalid response from background script")},"fetchAllSeedlessMetas"),bB=s(async e=>{let t=Ae("getAuthenticationPublicKey",{secretIdentifier:e}),r=At(await et.default.runtime.sendMessage(Bt(t)));if("error"in r)throw new Error(r.error.message);if(typeof r.result=="string")return JSON.parse(r.result);throw new Error("getAuthenticationPublicK*y: Invalid response from background script")},"getAuthenticationPublicKey"),TB=s(async()=>{let e=Ae("checkVaultIntegrity",void 0),t=At(await et.default.runtime.sendMessage(Bt(e)));if("error"in t)throw new Error(t.error.message);return t.result},"checkVaultIntegrity"),AB=s(async(e,t)=>{let r=ef.parse(t);"chainType"in r&&r.chainType===xe.Solana&&r.signingType==="transaction"&&typeof r.message!="string"&&(r.message=Pa.default.encode(r.message));let o=Ae("sign",{accountIdentifier:e,params:r}),n=At(await et.default.runtime.sendMessage(Bt(o)));if("error"in n)throw new Error(n.error.message);if(typeof n.result=="string")return At(n.result);throw new Error("sign: Invalid response from background script")},"sign"),PE={addAccountForSeed:lB,addReadonlyAccount:mB,importPrivateKeyAccount:uB,connectLedgerAccounts:dB,fetchAllAccounts:yB,fetchAllSeedMetas:wB,fetchAllSeedlessMetas:SB,connectSolanaSeedVaultAccounts:s(()=>{throw new Error("Solana Seed Vault is not supported on browser extension.")},"connectSolanaSeedVaultAccounts"),deriveAddresses:fB,removeAccount:s(async e=>{if(!await gB(e))throw new Error("Error while removing account")},"removeAccount"),reorderAccount:s(async(e,t)=>{if(!await hB(e,t))throw new Error("Error while reordering account")},"reorderAccount"),sign:AB,getAuthenticationPublicKey:bB,addAccountForSeedless:pB,checkVaultIntegrity:TB,getCashAddress:s(async()=>{throw new Error("getCashAddress: Not implemented on browser extension")},"getCashAddress"),getAgentAddress:s(async()=>{throw new Error("getAgentAddress: Not implemented on browser extension")},"getAgentAddress"),getCashKMSAccount:s(async()=>{throw new Error("getCashKMSAccount: Not implemented on browser extension")},"getCashKMSAccount"),getKMSInstance:s(()=>cB,"getKMSInstance"),addKMSVaultAccount:s(()=>{throw new Error("addKMSVaultAccount: Only callable from background script, not UI")},"addKMSVaultAccount")},WRe=s(()=>PE,"getVaultProxy");function ZRe({children:e}){return vE.default.createElement(Ym,{vault:PE},e)}s(ZRe,"VaultProxyProvider");export{ck as a,JE as b,oL as c,ek as d,eo as e,tk as f,ai as g,ik as h,Eo as i,fl as j,uk as k,lk as l,pk as m,gl as n,hl as o,gt as p,Gl as q,Et as r,ko as s,Ll as t,yk as u,wk as v,Sk as w,wh as x,vk as y,Ak as z,Fh as A,Qh as B,bwe as C,ka as D,LD as E,Gd as F,sD as G,Bd as H,Ld as I,Ea as J,T1 as K,ho as L,er as M,cr as N,V as O,gS as P,O$ as Q,M$ as R,nu as S,Pe as T,Yk as U,Gh as V,Kh as W,ne as X,cy as Y,he as Z,Ce as _,It as $,Ft as aa,ce as ba,ao as ca,qn as da,sb as ea,Se as fa,gb as ga,hb as ha,$ as ia,Xe as ja,ot as ka,Uo as la,Kc as ma,j as na,Sb as oa,Ue as pa,Pc as qa,Ab as ra,xb as sa,zn as ta,ib as ua,Wc as va,lH as wa,Wt as xa,Hp as ya,Bn as za,ct as Aa,Ve as Ba,wy as Ca,f8 as Da,sp as Ea,uv as Fa,je as Ga,Mn as Ha,ZZ as Ia,Qn as Ja,oY as Ka,ob as La,hX as Ma,lv as Na,_v as Oa,yt as Pa,pd as Qa,db as Ra,ga as Sa,cse as Ta,tr as Ua,SP as Va,bP as Wa,xP as Xa,Hde as Ya,BP as Za,Uce as _a,cT as $a,oT as ab,CP as bb,Mo as cb,hd as db,MP as eb,qP as fb,ale as gb,VP as hb,hle as ib,yle as jb,wle as kb,$P as lb,kle as mb,Cle as nb,WP as ob,Dle as pb,Nle as qb,DP as rb,aR as sb,iR as tb,yd as ub,cR as vb,uce as wb,NP as xb,uR as yb,Pd as zb,a1 as Ab,i1 as Bb,b1 as Cb,Qd as Db,qd as Eb,zd as Fb,uD as Gb,lD as Hb,Hd as Ib,DD as Jb,QD as Kb,VD as Lb,$D as Mb,WD as Nb,Zd as Ob,Yd as Pb,Xd as Qb,Dt as Rb,Du as Sb,dE as Tb,nE as Ub,cE as Vb,pE as Wb,bN as Xb,AN as Yb,FN as Zb,vN as _b,PN as $b,EN as ac,DN as bc,NN as cc,LN as dc,XN as ec,_E as fc,IE as gc,wRe as hc,Ae as ic,aB as jc,vRe as kc,PRe as lc,FE as mc,KRe as nc,VRe as oc,jRe as pc,HRe as qc,$Re as rc,SB as sc,WRe as tc,ZRe as uc};
/*! Bundled license information:

use-sync-external-store/cjs/use-sync-external-store-shim.production.js:
  (**
   * @license React
   * use-sync-external-store-shim.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

use-sync-external-store/cjs/use-sync-external-store-shim.development.js:
  (**
   * @license React
   * use-sync-external-store-shim.development.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.production.js:
  (**
   * @license React
   * use-sync-external-store-shim/with-selector.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.development.js:
  (**
   * @license React
   * use-sync-external-store-shim/with-selector.development.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

pako/dist/pako.esm.mjs:
  (*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) *)
*/
//# sourceMappingURL=chunk-44NW6BSR.js.map
