import{d as ue}from"./chunk-365YWPIP.js";import{o as ce}from"./chunk-F74QCQCY.js";import{a as ae}from"./chunk-XVSHIHTB.js";import{a as pe,b as me}from"./chunk-TQE77AJX.js";import{a as N,b as F,e as C,f as y,g as X,h as Y,i as Z,j as D,k as R,m as u,n as L,p as ee,q as te,r as re,s as M,t as k,u as q}from"./chunk-RNES5QWV.js";import{a as J}from"./chunk-5HTF5CEZ.js";import{b as ne}from"./chunk-YLX2CXTY.js";import{a as ie,c as se,d as de}from"./chunk-GWKXKPCT.js";import{A as oe,db as H,m as x}from"./chunk-FMF67RFP.js";import{a as _}from"./chunk-IJLITZAC.js";import{Ac as V,kd as S,pd as T,qa as j,xc as z}from"./chunk-GSVPXWLR.js";import{V as K,a as U,r as Q}from"./chunk-LYTSCHVN.js";import{j as G}from"./chunk-PPQ6BNOX.js";import{a as i,g as I,i as p,n as m}from"./chunk-NSVULBS3.js";p();m();p();m();p();m();var W=i(()=>{let n=y.isLedgerSupported();return T({queryKey:n,queryFn:i(async()=>q().isSupported(),"queryFn")})},"default");p();m();var ge=i((n,e=[],o=!1,r=!1,g=()=>{})=>{let{defaultTransportTimeout:f}=q(),a=S(),d=ee(j.getAddressType(e[0].pathType)),c=n.isConnected&&e.length>0&&d===n.selectedApp?.app,l=y.ledgerAddresses(e,r);return T({enabled:c,queryKey:l,queryFn:i(async()=>{let s=await a.getQueryData(y.ledgerTransportState());if(!s)throw new R;return te({transportTimeout:f,state:s,derivationPathParams:e,enableDebugLogs:o,enableLedgerXPubDerivation:r,onSuccess:g})},"queryFn"),retry:!1})},"default");p();m();var w=i((n=!1,e,o)=>{if(e?.status===o.status)return;let r,g="";switch(o.status){case"connected":r="\u{1F7E2} Connected",g=`, selected app: ${o.selectedApp?L(o.selectedApp.app):"None"}`;break;case"needs-permission":r="\u{1F7E0} Needs Permission";break;case"reconnecting":r="\u{1F7E0} Reconnecting";break;case"waiting-for-approval":r="\u{1F7E0} Waiting For Approval";break;case"not-connected":r="\u26AA\uFE0F Not Connected";break}u(n,`${r}${g}`)},"debugLogStateChange");p();m();var E=I(U());var fe=5,Ae=500,$=i((n=!0,e=!1,o=2e3)=>{let r=S(),[g,f]=(0,E.useState)(o),a=(0,E.useCallback)(()=>{u(e,"disconnect event received from Ledger transport."),Z(r)},[e,r]);(0,E.useEffect)(()=>("hid"in self.navigator&&self.navigator.hid.addEventListener("disconnect",a),()=>"hid"in self.navigator&&self.navigator.hid.removeEventListener("disconnect",a)),[a]);let{data:d=!1}=W(),c=n&&d,l=y.ledgerTransportState();return T({enabled:c,queryKey:l,queryFn:i(async()=>{if(!c)return N;let s=r.getQueryData(l),A,P=!1,O=0;do{try{A=(await Promise.all([J(M(k(),e,O>0?F:s),o),_(200)]))[0]}catch{A=N}P=!!s?.isConnected&&A.status==="not-connected"&&++O<fe,P&&(D(r,F),u(e,"Attempting to reconnect..."),O===1&&w(e,s,F),await _(Ae))}while(P);return O>0&&(s=F),w(e,s,A),s?.isConnected&&!A.isConnected&&X(r).then(()=>Y(r)),f(A.isConnected?3500:o),A},"queryFn"),refetchOnMount:!0,refetchInterval:g,initialData:N})},"useLedgerWireTransportState");p();m();var ye=i((n=!0,e=!1)=>{let o=k(),r=S(),g=y.requestLedgerPermission();return T({enabled:n,queryKey:g,queryFn:i(async()=>{let a;try{u(e,"Requesting permission to connect to Ledger..."),a=await o.request()}catch(c){if(u(e,`Received error trying to request permission: ${c}`),typeof c.message=="string"&&c.message?.includes("device is already open")){u(e,"\u2705 Permission granted, device already open. Connecting to device...");let l=y.ledgerTransportState(),h=await r.getQueryData(l),s;try{s=await M(o,e,h)}catch{}return s?.isConnected?(u(e,`\u2705 Permission granted. Connected to Ledger device: ${s.transport.deviceModel?.productName??"Unknown device"}. Selected app: ${s?.selectedApp?.app??"none"}`),await D(r,s),w(e,void 0,s),{type:"granted",transport:s.transport}):(u(e,"\u274C Unable to connect. Try again and make sure device is unlocked."),{type:"unable-to-connect"})}return u(e,"\u274C Permission denied."),{type:"denied"}}if(!a)return u(e,"\u274C Unable to connect to Ledger device. Permission granted, but no Transport received."),{type:"unable-to-connect"};let d={status:"connected",isConnected:!0,transport:a,selectedApp:await re(a,o.defaultTransportTimeout)};return await D(r,d),w(e,void 0,d),u(e,`\u2705 Permission granted. Connected to Ledger device: ${a.deviceModel?.productName??"Unknown device"}`),{type:"granted",transport:a}},"queryFn"),gcTime:0,staleTime:0,refetchOnMount:!0})},"default");var t=I(U(),1);var Te=x.div`
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  height: 100%;
  width: 100%;
`,Ce=x(ue)`
  margin: auto 0px;
  padding-left: 10px;
  padding-right: 10px;
`,Le=x.div`
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
`,xe=x.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  margin-top: 55px;
`,B=x(H).attrs({size:28,lineHeight:34,weight:500})`
  margin-bottom: 8px;
  margin-top: 22px;
`,b=x(H).attrs({size:16,color:K.colors.legacy.textDiminished})`
  max-width: 275px;
  span {
    color: white;
  }
`,he={ledgerActionNeedToConfirm:"ledgerActionNeedToConfirm",ledgerActionNeedToConfirmMany:"ledgerActionNeedToConfirmMany",ledgerActionNeedToConfirmBlind:"ledgerActionNeedToConfirmBlind",ledgerActionNeedToConfirmBlindMany:"ledgerActionNeedToConfirmBlindMany",ledgerActionPleaseConnect:"ledgerActionPleaseConnect",ledgerActionConfirm:"ledgerActionConfirm",ledgerActionNeedPermission:"ledgerActionNeedPermission",ledgerActionPleaseConnectAndConfirm:"ledgerActionPleaseConnectAndConfirm",commandContinue:"commandContinue",commandCancel:"commandCancel"},Jt=i(n=>!!(n&&(n.statusCode===26632||n.statusCode===27013||n.statusCode===27404||n.name==="DisconnectedDeviceDuringOperation")),"isKnownLedgerActionError"),le=i(n=>{switch(n){case C.Bitcoin:return!1;case C.EVM:return!0;case C.Solana:return!0;case C.Sui:return!1}},"ledgerAppHasBlindSigning"),Se=i(n=>{let{data:e=N}=$(!0,G());return(0,t.useMemo)(()=>({status:e.status,isConnected:e.isConnected,isExpectedSelectedAppOpen:e.isConnected&&e.selectedApp?.app===n,transport:e.isConnected?e.transport:void 0}),[n,e])},"useMultiChainLedgerConnectivity"),Ne=i((n,e,o)=>{let{ledgerApp:r=C.Solana,ledgerAction:g,numberOfTransactions:f=1,cancel:a=ae}=n,{t:d}=Q(),c,l;f>1?le(r)?l=d(o.ledgerActionNeedToConfirmBlindMany,{numberOfTransactions:f,chainType:L(r)}):l=d(o.ledgerActionNeedToConfirmMany,{numberOfTransactions:f,chainType:L(r)}):le(r)?l=d(o.ledgerActionNeedToConfirmBlind,{chainType:L(r)}):l=d(o.ledgerActionNeedToConfirm,{chainType:L(r)});let h=d(o.commandCancel),s="default",A=a;switch(e.status){case"not-connected":{c=d(o.ledgerActionPleaseConnect);break}case"reconnecting":case"waiting-for-approval":case"connected":{c=d(o.ledgerActionConfirm);break}case"needs-permission":{c=d(o.ledgerActionNeedPermission),l=d(o.ledgerActionPleaseConnectAndConfirm),s="primary",h=d(o.commandContinue),A=i(()=>{ne({url:"connect_hardware.html?permission=true"}),a()},"buttonAction");break}}return(0,t.useEffect)(()=>{if(e.isConnected&&e.transport&&(e.isExpectedSelectedAppOpen===null||e.isExpectedSelectedAppOpen))try{g(e.transport)}catch(P){V.captureError(P,z.Ledger)}},[e]),{primaryText:c,secondaryText:l,buttonTheme:s,buttonText:h,buttonAction:A}},"useStatelessLedgerActionProps"),ve=t.default.memo(n=>{let{primaryText:e,secondaryText:o,buttonAction:r,buttonTheme:g,buttonText:f}=n;return t.default.createElement(Te,null,t.default.createElement(Ce,{icon:t.default.createElement(ie,{diameter:75}),primaryText:e,secondaryText:o}),t.default.createElement(se,{onClick:r,theme:g},f))}),we=i(n=>{let e=Se(n.ledgerApp??C.Solana),o=Ne(n,e,he);return t.default.createElement(ve,{...o})},"MultiChainLedgerAction"),Xt=i(n=>t.default.createElement(we,{...n}),"LedgerAction"),Yt=i(({ledgerActionError:n,onRetryClick:e,onCancelClick:o})=>{let{t:r}=Q();return t.default.createElement(Le,null,t.default.createElement("div",null,t.default.createElement(ce,null,r("ledgerActionErrorHeader")),t.default.createElement(xe,null,t.default.createElement(me,{color:pe(K.colors.legacy.spotNegative,.1),diameter:94},t.default.createElement(oe,{width:32})),n?.statusCode===26632?t.default.createElement(t.default.Fragment,null,t.default.createElement(B,null,r("ledgerActionErrorBlindSignDisabledPrimaryText")),t.default.createElement(b,null,r("ledgerActionErrorBlindSignDisabledSecondaryText"))):t.default.createElement(t.default.Fragment,null),n?.statusCode===27013?t.default.createElement(t.default.Fragment,null,t.default.createElement(B,null,r("ledgerActionErrorUserRejectionPrimaryText")),t.default.createElement(b,null,r("ledgerActionErrorUserRejectionSecondaryText"))):t.default.createElement(t.default.Fragment,null),n?.statusCode===27404?t.default.createElement(t.default.Fragment,null,t.default.createElement(B,null,r("ledgerActionErrorDeviceLockedPrimaryText")),t.default.createElement(b,null,r("ledgerActionErrorDeviceLockedSecondaryText"))):t.default.createElement(t.default.Fragment,null),n?.name==="DisconnectedDeviceDuringOperation"?t.default.createElement(t.default.Fragment,null,t.default.createElement(B,null,r("ledgerActionErrorDeviceDisconnectedDuringOperationPrimaryText")),t.default.createElement(b,null,r("ledgerActionErrorDeviceDisconnectedDuringOperationSecondaryText"))):t.default.createElement(t.default.Fragment,null))),t.default.createElement(de,{primaryText:r("commandRetry"),secondaryText:r("commandCancel"),onPrimaryClicked:e,onSecondaryClicked:o}))},"LedgerActionError");export{W as a,ge as b,$ as c,ye as d,Jt as e,Xt as f,Yt as g};
//# sourceMappingURL=chunk-6WMUBTJC.js.map
