import{c as Oi}from"./chunk-6XVVS35Q.js";import{Ma as Ci,O as Si,P as ht,Qb as Ti,R as En,Rb as Li,S as Er,Sa as Lo,fa as _i,ga as Ai,hb as Ii,j as vi,ma as Bi,n as Qr,s as xr,y as To}from"./chunk-COS4XKZ5.js";import{$c as pe,Ac as Ge,Ad as xi,Oc as mi,Pb as Me,Rc as gi,Td as vn,Wc as bi,X as Tt,_ as it,aa as br,ae as et,bd as Ke,ca as Eo,da as vo,ea as So,fa as _o,ga as Ao,ha as Bo,ja as Yr,kd as le,la as Co,md as ae,nc as pi,oa as wn,oc as yi,pd as oe,qa as Io,qd as me,vb as xn,w as It,wc as dt,xb as hi,xc as We,zd as wi}from"./chunk-GSVPXWLR.js";import{V as st,d as Vl}from"./chunk-P42QO3R7.js";import{_ as Lt,a as rr,m as wr,r as Ei}from"./chunk-LYTSCHVN.js";import{h as mr,k as gr}from"./chunk-P5BPG5MC.js";import{E as di,g as V,n as fi,o as gn,q as xo,x as bn}from"./chunk-PPQ6BNOX.js";import{a as s,d as ne,e as kl,g as ot,i as g,j as I,m as Buffer,n as b}from"./chunk-NSVULBS3.js";var Do=ne((ma,In)=>{g();b();(function(e,t){"use strict";typeof define=="function"&&define.amd?define(t):typeof In=="object"&&In.exports?In.exports=t():e.log=t()})(ma,function(){"use strict";var e=s(function(){},"noop"),t="undefined",r=typeof self!==t&&typeof self.navigator!==t&&/Trident\/|MSIE /.test(self.navigator.userAgent),n=["trace","debug","info","warn","error"],o={},i=null;function a(h,w){var m=h[w];if(typeof m.bind=="function")return m.bind(h);try{return Function.prototype.bind.call(m,h)}catch{return function(){return Function.prototype.apply.apply(m,[h,arguments])}}}s(a,"bindMethod");function c(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}s(c,"traceForIE");function u(h){return h==="debug"&&(h="log"),typeof console===t?!1:h==="trace"&&r?c:console[h]!==void 0?a(console,h):console.log!==void 0?a(console,"log"):e}s(u,"realMethod");function l(){for(var h=this.getLevel(),w=0;w<n.length;w++){var m=n[w];this[m]=w<h?e:this.methodFactory(m,h,this.name)}if(this.log=this.debug,typeof console===t&&h<this.levels.SILENT)return"No console available for logging"}s(l,"replaceLoggingMethods");function f(h){return function(){typeof console!==t&&(l.call(this),this[h].apply(this,arguments))}}s(f,"enableLoggingWhenConsoleArrives");function p(h,w,m){return u(h)||f.apply(this,arguments)}s(p,"defaultMethodFactory");function d(h,w){var m=this,x,E,_,C="loglevel";typeof h=="string"?C+=":"+h:typeof h=="symbol"&&(C=void 0);function M(O){var R=(n[O]||"silent").toUpperCase();if(!(typeof m===t||!C)){try{m.localStorage[C]=R;return}catch{}try{m.document.cookie=encodeURIComponent(C)+"="+R+";"}catch{}}}s(M,"persistLevelIfPossible");function q(){var O;if(!(typeof m===t||!C)){try{O=m.localStorage[C]}catch{}if(typeof O===t)try{var R=m.document.cookie,D=encodeURIComponent(C),v=R.indexOf(D+"=");v!==-1&&(O=/^([^;]+)/.exec(R.slice(v+D.length+1))[1])}catch{}return m.levels[O]===void 0&&(O=void 0),O}}s(q,"getPersistedLevel");function W(){if(!(typeof m===t||!C)){try{m.localStorage.removeItem(C)}catch{}try{m.document.cookie=encodeURIComponent(C)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}s(W,"clearPersistedLevel");function k(O){var R=O;if(typeof R=="string"&&m.levels[R.toUpperCase()]!==void 0&&(R=m.levels[R.toUpperCase()]),typeof R=="number"&&R>=0&&R<=m.levels.SILENT)return R;throw new TypeError("log.setLevel() called with invalid level: "+O)}s(k,"normalizeLevel"),m.name=h,m.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},m.methodFactory=w||p,m.getLevel=function(){return _??E??x},m.setLevel=function(O,R){return _=k(O),R!==!1&&M(_),l.call(m)},m.setDefaultLevel=function(O){E=k(O),q()||m.setLevel(O,!1)},m.resetLevel=function(){_=null,W(),l.call(m)},m.enableAll=function(O){m.setLevel(m.levels.TRACE,O)},m.disableAll=function(O){m.setLevel(m.levels.SILENT,O)},m.rebuild=function(){if(i!==m&&(x=k(i.getLevel())),l.call(m),i===m)for(var O in o)o[O].rebuild()},x=k(i?i.getLevel():"WARN");var B=q();B!=null&&(_=k(B)),l.call(m)}s(d,"Logger"),i=new d,i.getLogger=s(function(w){if(typeof w!="symbol"&&typeof w!="string"||w==="")throw new TypeError("You must supply a name when creating a logger.");var m=o[w];return m||(m=o[w]=new d(w,i.methodFactory)),m},"getLogger");var y=typeof self!==t?self.log:void 0;return i.noConflict=function(){return typeof self!==t&&self.log===i&&(self.log=y),i},i.getLoggers=s(function(){return o},"getLoggers"),i.default=i,i})});var Xe=ne(te=>{"use strict";g();b();Object.defineProperty(te,"__esModule",{value:!0});te.wrapCipher=te.Hash=te.nextTick=te.isLE=void 0;te.isBytes=Qo;te.abool=qa;te.anumber=$o;te.abytes=ct;te.ahash=vd;te.aexists=Sd;te.aoutput=_d;te.u8=Ad;te.u32=Bd;te.clean=Cd;te.createView=ka;te.bytesToHex=Fa;te.hexToBytes=ja;te.hexToNumber=za;te.bytesToNumberBE=Td;te.numberToBytesBE=Ld;te.utf8ToBytes=Wa;te.bytesToUtf8=Pd;te.toBytes=Ud;te.overlapBytes=Ga;te.complexOverlapBytes=Rd;te.concatBytes=Dd;te.checkOpts=Nd;te.equalBytes=Hd;te.getOutput=Kd;te.setBigUint64=Yo;te.u64Lengths=qd;te.isAligned32=$a;te.copyBytes=Za;function Qo(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}s(Qo,"isBytes");function qa(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}s(qa,"abool");function $o(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}s($o,"anumber");function ct(e,...t){if(!Qo(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}s(ct,"abytes");function vd(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");$o(e.outputLen),$o(e.blockLen)}s(vd,"ahash");function Sd(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}s(Sd,"aexists");function _d(e,t){ct(e);let r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}s(_d,"aoutput");function Ad(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}s(Ad,"u8");function Bd(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}s(Bd,"u32");function Cd(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}s(Cd,"clean");function ka(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}s(ka,"createView");te.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;var Va=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Id=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Fa(e){if(ct(e),Va)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=Id[e[r]];return t}s(Fa,"bytesToHex");var Ut={_0:48,_9:57,A:65,F:70,a:97,f:102};function Ka(e){if(e>=Ut._0&&e<=Ut._9)return e-Ut._0;if(e>=Ut.A&&e<=Ut.F)return e-(Ut.A-10);if(e>=Ut.a&&e<=Ut.f)return e-(Ut.a-10)}s(Ka,"asciiToBase16");function ja(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(Va)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let n=new Uint8Array(r);for(let o=0,i=0;o<r;o++,i+=2){let a=Ka(e.charCodeAt(i)),c=Ka(e.charCodeAt(i+1));if(a===void 0||c===void 0){let u=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+u+'" at index '+i)}n[o]=a*16+c}return n}s(ja,"hexToBytes");function za(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":"0x"+e)}s(za,"hexToNumber");function Td(e){return za(Fa(e))}s(Td,"bytesToNumberBE");function Ld(e,t){return ja(e.toString(16).padStart(t*2,"0"))}s(Ld,"numberToBytesBE");var Od=s(async()=>{},"nextTick");te.nextTick=Od;function Wa(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}s(Wa,"utf8ToBytes");function Pd(e){return new TextDecoder().decode(e)}s(Pd,"bytesToUtf8");function Ud(e){if(typeof e=="string")e=Wa(e);else if(Qo(e))e=Za(e);else throw new Error("Uint8Array expected, got "+typeof e);return e}s(Ud,"toBytes");function Ga(e,t){return e.buffer===t.buffer&&e.byteOffset<t.byteOffset+t.byteLength&&t.byteOffset<e.byteOffset+e.byteLength}s(Ga,"overlapBytes");function Rd(e,t){if(Ga(e,t)&&e.byteOffset<t.byteOffset)throw new Error("complex overlap of input and output is not supported")}s(Rd,"complexOverlapBytes");function Dd(...e){let t=0;for(let n=0;n<e.length;n++){let o=e[n];ct(o),t+=o.length}let r=new Uint8Array(t);for(let n=0,o=0;n<e.length;n++){let i=e[n];r.set(i,o),o+=i.length}return r}s(Dd,"concatBytes");function Nd(e,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(e,t)}s(Nd,"checkOpts");function Hd(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return r===0}s(Hd,"equalBytes");var Zo=class{static{s(this,"Hash")}};te.Hash=Zo;var Md=s((e,t)=>{function r(n,...o){if(ct(n),!te.isLE)throw new Error("Non little-endian hardware is not yet supported");if(e.nonceLength!==void 0){let f=o[0];if(!f)throw new Error("nonce / iv required");e.varSizeNonce?ct(f):ct(f,e.nonceLength)}let i=e.tagLength;i&&o[1]!==void 0&&ct(o[1]);let a=t(n,...o),c=s((f,p)=>{if(p!==void 0){if(f!==2)throw new Error("cipher output not supported");ct(p)}},"checkOutput"),u=!1;return{encrypt(f,p){if(u)throw new Error("cannot encrypt() twice with same key + nonce");return u=!0,ct(f),c(a.encrypt.length,p),a.encrypt(f,p)},decrypt(f,p){if(ct(f),i&&f.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return c(a.decrypt.length,p),a.decrypt(f,p)}}}return s(r,"wrappedCipher"),Object.assign(r,e),r},"wrapCipher");te.wrapCipher=Md;function Kd(e,t,r=!0){if(t===void 0)return new Uint8Array(e);if(t.length!==e)throw new Error("invalid output length, expected "+e+", got: "+t.length);if(r&&!$a(t))throw new Error("invalid output, must be aligned");return t}s(Kd,"getOutput");function Yo(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let o=BigInt(32),i=BigInt(4294967295),a=Number(r>>o&i),c=Number(r&i),u=n?4:0,l=n?0:4;e.setUint32(t+u,a,n),e.setUint32(t+l,c,n)}s(Yo,"setBigUint64");function qd(e,t,r){qa(r);let n=new Uint8Array(16),o=ka(n);return Yo(o,0,BigInt(t),r),Yo(o,8,BigInt(e),r),n}s(qd,"u64Lengths");function $a(e){return e.byteOffset%4===0}s($a,"isAligned32");function Za(e){return Uint8Array.from(e)}s(Za,"copyBytes")});var Pn=ne(De=>{"use strict";g();b();Object.defineProperty(De,"__esModule",{value:!0});De.AEAD_TAG_LENGTH=De.XCHACHA20_NONCE_LENGTH=De.CURVE25519_PUBLIC_KEY_SIZE=De.ETH_PUBLIC_KEY_SIZE=De.UNCOMPRESSED_PUBLIC_KEY_SIZE=De.COMPRESSED_PUBLIC_KEY_SIZE=De.SECRET_KEY_LENGTH=void 0;De.SECRET_KEY_LENGTH=32;De.COMPRESSED_PUBLIC_KEY_SIZE=33;De.UNCOMPRESSED_PUBLIC_KEY_SIZE=65;De.ETH_PUBLIC_KEY_SIZE=64;De.CURVE25519_PUBLIC_KEY_SIZE=32;De.XCHACHA20_NONCE_LENGTH=24;De.AEAD_TAG_LENGTH=16});var en=ne(we=>{"use strict";g();b();Object.defineProperty(we,"__esModule",{value:!0});we.ephemeralKeySize=we.symmetricNonceLength=we.symmetricAlgorithm=we.isHkdfKeyCompressed=we.isEphemeralKeyCompressed=we.ellipticCurve=we.ECIES_CONFIG=void 0;var Un=Pn(),kd=function(){function e(){this.ellipticCurve="secp256k1",this.isEphemeralKeyCompressed=!1,this.isHkdfKeyCompressed=!1,this.symmetricAlgorithm="aes-256-gcm",this.symmetricNonceLength=16}return s(e,"Config"),e}();we.ECIES_CONFIG=new kd;var Vd=s(function(){return we.ECIES_CONFIG.ellipticCurve},"ellipticCurve");we.ellipticCurve=Vd;var Fd=s(function(){return we.ECIES_CONFIG.isEphemeralKeyCompressed},"isEphemeralKeyCompressed");we.isEphemeralKeyCompressed=Fd;var jd=s(function(){return we.ECIES_CONFIG.isHkdfKeyCompressed},"isHkdfKeyCompressed");we.isHkdfKeyCompressed=jd;var zd=s(function(){return we.ECIES_CONFIG.symmetricAlgorithm},"symmetricAlgorithm");we.symmetricAlgorithm=zd;var Wd=s(function(){return we.ECIES_CONFIG.symmetricNonceLength},"symmetricNonceLength");we.symmetricNonceLength=Wd;var Gd=s(function(){var e={secp256k1:we.ECIES_CONFIG.isEphemeralKeyCompressed?Un.COMPRESSED_PUBLIC_KEY_SIZE:Un.UNCOMPRESSED_PUBLIC_KEY_SIZE,x25519:Un.CURVE25519_PUBLIC_KEY_SIZE,ed25519:Un.CURVE25519_PUBLIC_KEY_SIZE};if(we.ECIES_CONFIG.ellipticCurve in e)return e[we.ECIES_CONFIG.ellipticCurve];throw new Error("Not implemented")},"ephemeralKeySize");we.ephemeralKeySize=Gd});var Ya=ne(Rn=>{"use strict";g();b();Object.defineProperty(Rn,"__esModule",{value:!0});Rn.crypto=void 0;Rn.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var es=ne(qe=>{"use strict";g();b();Object.defineProperty(qe,"__esModule",{value:!0});qe.gcm=qe.ctr=qe.cbc=qe.utils=void 0;qe.randomBytes=Qa;qe.getWebcryptoSubtle=Xo;qe.managedNonce=$d;var yt=Ya(),Ir=Xe();function Qa(e=32){if(yt.crypto&&typeof yt.crypto.getRandomValues=="function")return yt.crypto.getRandomValues(new Uint8Array(e));if(yt.crypto&&typeof yt.crypto.randomBytes=="function")return Uint8Array.from(yt.crypto.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}s(Qa,"randomBytes");function Xo(){if(yt.crypto&&typeof yt.crypto.subtle=="object"&&yt.crypto.subtle!=null)return yt.crypto.subtle;throw new Error("crypto.subtle must be defined")}s(Xo,"getWebcryptoSubtle");function $d(e){let{nonceLength:t}=e;return(0,Ir.anumber)(t),(r,...n)=>({encrypt(o,...i){let a=Qa(t),c=e(r,a,...n).encrypt(o,...i),u=(0,Ir.concatBytes)(a,c);return c.fill(0),u},decrypt(o,...i){let a=o.subarray(0,t),c=o.subarray(t);return e(r,a,...n).decrypt(c,...i)}})}s($d,"managedNonce");qe.utils={async encrypt(e,t,r,n){let o=Xo(),i=await o.importKey("raw",e,t,!0,["encrypt"]),a=await o.encrypt(r,i,n);return new Uint8Array(a)},async decrypt(e,t,r,n){let o=Xo(),i=await o.importKey("raw",e,t,!0,["decrypt"]),a=await o.decrypt(r,i,n);return new Uint8Array(a)}};var pt={CBC:"AES-CBC",CTR:"AES-CTR",GCM:"AES-GCM"};function Zd(e,t,r){if(e===pt.CBC)return{name:pt.CBC,iv:t};if(e===pt.CTR)return{name:pt.CTR,counter:t,length:64};if(e===pt.GCM)return r?{name:pt.GCM,iv:t,additionalData:r}:{name:pt.GCM,iv:t};throw new Error("unknown aes block mode")}s(Zd,"getCryptParams");function Jo(e){return(t,r,n)=>{(0,Ir.abytes)(t),(0,Ir.abytes)(r);let o={name:e,length:t.length*8},i=Zd(e,r,n),a=!1;return{encrypt(c){if((0,Ir.abytes)(c),a)throw new Error("Cannot encrypt() twice with same key / nonce");return a=!0,qe.utils.encrypt(t,o,i,c)},decrypt(c){return(0,Ir.abytes)(c),qe.utils.decrypt(t,o,i,c)}}}}s(Jo,"generate");qe.cbc=Jo(pt.CBC);qe.ctr=Jo(pt.CTR);qe.gcm=Jo(pt.GCM)});var Xa=ne(Dn=>{"use strict";g();b();Object.defineProperty(Dn,"__esModule",{value:!0});Dn.crypto=void 0;Dn.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var mt=ne(Z=>{"use strict";g();b();Object.defineProperty(Z,"__esModule",{value:!0});Z.wrapXOFConstructorWithOpts=Z.wrapConstructorWithOpts=Z.wrapConstructor=Z.Hash=Z.nextTick=Z.swap32IfBE=Z.byteSwapIfBE=Z.swap8IfBE=Z.isLE=void 0;Z.isBytes=ec;Z.anumber=ts;Z.abytes=Lr;Z.ahash=Yd;Z.aexists=Qd;Z.aoutput=Xd;Z.u8=Jd;Z.u32=e0;Z.clean=t0;Z.createView=r0;Z.rotr=n0;Z.rotl=o0;Z.byteSwap=ns;Z.byteSwap32=tc;Z.bytesToHex=i0;Z.hexToBytes=a0;Z.asyncLoop=u0;Z.utf8ToBytes=os;Z.bytesToUtf8=l0;Z.toBytes=Nn;Z.kdfInputToBytes=f0;Z.concatBytes=d0;Z.checkOpts=h0;Z.createHasher=nc;Z.createOptHasher=oc;Z.createXOFer=sc;Z.randomBytes=p0;var Tr=Xa();function ec(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}s(ec,"isBytes");function ts(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}s(ts,"anumber");function Lr(e,...t){if(!ec(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}s(Lr,"abytes");function Yd(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");ts(e.outputLen),ts(e.blockLen)}s(Yd,"ahash");function Qd(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}s(Qd,"aexists");function Xd(e,t){Lr(e);let r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}s(Xd,"aoutput");function Jd(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}s(Jd,"u8");function e0(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}s(e0,"u32");function t0(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}s(t0,"clean");function r0(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}s(r0,"createView");function n0(e,t){return e<<32-t|e>>>t}s(n0,"rotr");function o0(e,t){return e<<t|e>>>32-t>>>0}s(o0,"rotl");Z.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function ns(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}s(ns,"byteSwap");Z.swap8IfBE=Z.isLE?e=>e:e=>ns(e);Z.byteSwapIfBE=Z.swap8IfBE;function tc(e){for(let t=0;t<e.length;t++)e[t]=ns(e[t]);return e}s(tc,"byteSwap32");Z.swap32IfBE=Z.isLE?e=>e:tc;var rc=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",s0=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function i0(e){if(Lr(e),rc)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=s0[e[r]];return t}s(i0,"bytesToHex");var Rt={_0:48,_9:57,A:65,F:70,a:97,f:102};function Ja(e){if(e>=Rt._0&&e<=Rt._9)return e-Rt._0;if(e>=Rt.A&&e<=Rt.F)return e-(Rt.A-10);if(e>=Rt.a&&e<=Rt.f)return e-(Rt.a-10)}s(Ja,"asciiToBase16");function a0(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(rc)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let n=new Uint8Array(r);for(let o=0,i=0;o<r;o++,i+=2){let a=Ja(e.charCodeAt(i)),c=Ja(e.charCodeAt(i+1));if(a===void 0||c===void 0){let u=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+u+'" at index '+i)}n[o]=a*16+c}return n}s(a0,"hexToBytes");var c0=s(async()=>{},"nextTick");Z.nextTick=c0;async function u0(e,t,r){let n=Date.now();for(let o=0;o<e;o++){r(o);let i=Date.now()-n;i>=0&&i<t||(await(0,Z.nextTick)(),n+=i)}}s(u0,"asyncLoop");function os(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}s(os,"utf8ToBytes");function l0(e){return new TextDecoder().decode(e)}s(l0,"bytesToUtf8");function Nn(e){return typeof e=="string"&&(e=os(e)),Lr(e),e}s(Nn,"toBytes");function f0(e){return typeof e=="string"&&(e=os(e)),Lr(e),e}s(f0,"kdfInputToBytes");function d0(...e){let t=0;for(let n=0;n<e.length;n++){let o=e[n];Lr(o),t+=o.length}let r=new Uint8Array(t);for(let n=0,o=0;n<e.length;n++){let i=e[n];r.set(i,o),o+=i.length}return r}s(d0,"concatBytes");function h0(e,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("options should be object or undefined");return Object.assign(e,t)}s(h0,"checkOpts");var rs=class{static{s(this,"Hash")}};Z.Hash=rs;function nc(e){let t=s(n=>e().update(Nn(n)).digest(),"hashC"),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}s(nc,"createHasher");function oc(e){let t=s((n,o)=>e(o).update(Nn(n)).digest(),"hashC"),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=n=>e(n),t}s(oc,"createOptHasher");function sc(e){let t=s((n,o)=>e(o).update(Nn(n)).digest(),"hashC"),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=n=>e(n),t}s(sc,"createXOFer");Z.wrapConstructor=nc;Z.wrapConstructorWithOpts=oc;Z.wrapXOFConstructorWithOpts=sc;function p0(e=32){if(Tr.crypto&&typeof Tr.crypto.getRandomValues=="function")return Tr.crypto.getRandomValues(new Uint8Array(e));if(Tr.crypto&&typeof Tr.crypto.randomBytes=="function")return Uint8Array.from(Tr.crypto.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}s(p0,"randomBytes")});var ac=ne(ke=>{"use strict";g();b();Object.defineProperty(ke,"__esModule",{value:!0});ke.SHA512_IV=ke.SHA384_IV=ke.SHA224_IV=ke.SHA256_IV=ke.HashMD=void 0;ke.setBigUint64=ic;ke.Chi=y0;ke.Maj=m0;var gt=mt();function ic(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let o=BigInt(32),i=BigInt(4294967295),a=Number(r>>o&i),c=Number(r&i),u=n?4:0,l=n?0:4;e.setUint32(t+u,a,n),e.setUint32(t+l,c,n)}s(ic,"setBigUint64");function y0(e,t,r){return e&t^~e&r}s(y0,"Chi");function m0(e,t,r){return e&t^e&r^t&r}s(m0,"Maj");var ss=class extends gt.Hash{static{s(this,"HashMD")}constructor(t,r,n,o){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=o,this.buffer=new Uint8Array(t),this.view=(0,gt.createView)(this.buffer)}update(t){(0,gt.aexists)(this),t=(0,gt.toBytes)(t),(0,gt.abytes)(t);let{view:r,buffer:n,blockLen:o}=this,i=t.length;for(let a=0;a<i;){let c=Math.min(o-this.pos,i-a);if(c===o){let u=(0,gt.createView)(t);for(;o<=i-a;a+=o)this.process(u,a);continue}n.set(t.subarray(a,a+c),this.pos),this.pos+=c,a+=c,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){(0,gt.aexists)(this),(0,gt.aoutput)(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:o,isLE:i}=this,{pos:a}=this;r[a++]=128,(0,gt.clean)(this.buffer.subarray(a)),this.padOffset>o-a&&(this.process(n,0),a=0);for(let p=a;p<o;p++)r[p]=0;ic(n,o-8,BigInt(this.length*8),i),this.process(n,0);let c=(0,gt.createView)(t),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let l=u/4,f=this.get();if(l>f.length)throw new Error("_sha2: outputLen bigger than state");for(let p=0;p<l;p++)c.setUint32(4*p,f[p],i)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:n,length:o,finished:i,destroyed:a,pos:c}=this;return t.destroyed=a,t.finished=i,t.length=o,t.pos=c,o%r&&t.buffer.set(n),t}clone(){return this._cloneInto()}};ke.HashMD=ss;ke.SHA256_IV=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);ke.SHA224_IV=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]);ke.SHA384_IV=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]);ke.SHA512_IV=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209])});var Tc=ne(X=>{"use strict";g();b();Object.defineProperty(X,"__esModule",{value:!0});X.toBig=X.shrSL=X.shrSH=X.rotrSL=X.rotrSH=X.rotrBL=X.rotrBH=X.rotr32L=X.rotr32H=X.rotlSL=X.rotlSH=X.rotlBL=X.rotlBH=X.add5L=X.add5H=X.add4L=X.add4H=X.add3L=X.add3H=void 0;X.add=vc;X.fromBig=as;X.split=cc;var Hn=BigInt(2**32-1),is=BigInt(32);function as(e,t=!1){return t?{h:Number(e&Hn),l:Number(e>>is&Hn)}:{h:Number(e>>is&Hn)|0,l:Number(e&Hn)|0}}s(as,"fromBig");function cc(e,t=!1){let r=e.length,n=new Uint32Array(r),o=new Uint32Array(r);for(let i=0;i<r;i++){let{h:a,l:c}=as(e[i],t);[n[i],o[i]]=[a,c]}return[n,o]}s(cc,"split");var uc=s((e,t)=>BigInt(e>>>0)<<is|BigInt(t>>>0),"toBig");X.toBig=uc;var lc=s((e,t,r)=>e>>>r,"shrSH");X.shrSH=lc;var fc=s((e,t,r)=>e<<32-r|t>>>r,"shrSL");X.shrSL=fc;var dc=s((e,t,r)=>e>>>r|t<<32-r,"rotrSH");X.rotrSH=dc;var hc=s((e,t,r)=>e<<32-r|t>>>r,"rotrSL");X.rotrSL=hc;var pc=s((e,t,r)=>e<<64-r|t>>>r-32,"rotrBH");X.rotrBH=pc;var yc=s((e,t,r)=>e>>>r-32|t<<64-r,"rotrBL");X.rotrBL=yc;var mc=s((e,t)=>t,"rotr32H");X.rotr32H=mc;var gc=s((e,t)=>e,"rotr32L");X.rotr32L=gc;var bc=s((e,t,r)=>e<<r|t>>>32-r,"rotlSH");X.rotlSH=bc;var wc=s((e,t,r)=>t<<r|e>>>32-r,"rotlSL");X.rotlSL=wc;var xc=s((e,t,r)=>t<<r-32|e>>>64-r,"rotlBH");X.rotlBH=xc;var Ec=s((e,t,r)=>e<<r-32|t>>>64-r,"rotlBL");X.rotlBL=Ec;function vc(e,t,r,n){let o=(t>>>0)+(n>>>0);return{h:e+r+(o/2**32|0)|0,l:o|0}}s(vc,"add");var Sc=s((e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),"add3L");X.add3L=Sc;var _c=s((e,t,r,n)=>t+r+n+(e/2**32|0)|0,"add3H");X.add3H=_c;var Ac=s((e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),"add4L");X.add4L=Ac;var Bc=s((e,t,r,n,o)=>t+r+n+o+(e/2**32|0)|0,"add4H");X.add4H=Bc;var Cc=s((e,t,r,n,o)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(o>>>0),"add5L");X.add5L=Cc;var Ic=s((e,t,r,n,o,i)=>t+r+n+o+i+(e/2**32|0)|0,"add5H");X.add5H=Ic;var g0={fromBig:as,split:cc,toBig:uc,shrSH:lc,shrSL:fc,rotrSH:dc,rotrSL:hc,rotrBH:pc,rotrBL:yc,rotr32H:mc,rotr32L:gc,rotlSH:bc,rotlSL:wc,rotlBH:xc,rotlBL:Ec,add:vc,add3L:Sc,add3H:_c,add4L:Ac,add4H:Bc,add5H:Ic,add5L:Cc};X.default=g0});var Vn=ne(ye=>{"use strict";g();b();Object.defineProperty(ye,"__esModule",{value:!0});ye.sha512_224=ye.sha512_256=ye.sha384=ye.sha512=ye.sha224=ye.sha256=ye.SHA512_256=ye.SHA512_224=ye.SHA384=ye.SHA512=ye.SHA224=ye.SHA256=void 0;var $=ac(),re=Tc(),Be=mt(),b0=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),$t=new Uint32Array(64),tn=class extends $.HashMD{static{s(this,"SHA256")}constructor(t=32){super(64,t,8,!1),this.A=$.SHA256_IV[0]|0,this.B=$.SHA256_IV[1]|0,this.C=$.SHA256_IV[2]|0,this.D=$.SHA256_IV[3]|0,this.E=$.SHA256_IV[4]|0,this.F=$.SHA256_IV[5]|0,this.G=$.SHA256_IV[6]|0,this.H=$.SHA256_IV[7]|0}get(){let{A:t,B:r,C:n,D:o,E:i,F:a,G:c,H:u}=this;return[t,r,n,o,i,a,c,u]}set(t,r,n,o,i,a,c,u){this.A=t|0,this.B=r|0,this.C=n|0,this.D=o|0,this.E=i|0,this.F=a|0,this.G=c|0,this.H=u|0}process(t,r){for(let p=0;p<16;p++,r+=4)$t[p]=t.getUint32(r,!1);for(let p=16;p<64;p++){let d=$t[p-15],y=$t[p-2],h=(0,Be.rotr)(d,7)^(0,Be.rotr)(d,18)^d>>>3,w=(0,Be.rotr)(y,17)^(0,Be.rotr)(y,19)^y>>>10;$t[p]=w+$t[p-7]+h+$t[p-16]|0}let{A:n,B:o,C:i,D:a,E:c,F:u,G:l,H:f}=this;for(let p=0;p<64;p++){let d=(0,Be.rotr)(c,6)^(0,Be.rotr)(c,11)^(0,Be.rotr)(c,25),y=f+d+(0,$.Chi)(c,u,l)+b0[p]+$t[p]|0,w=((0,Be.rotr)(n,2)^(0,Be.rotr)(n,13)^(0,Be.rotr)(n,22))+(0,$.Maj)(n,o,i)|0;f=l,l=u,u=c,c=a+y|0,a=i,i=o,o=n,n=y+w|0}n=n+this.A|0,o=o+this.B|0,i=i+this.C|0,a=a+this.D|0,c=c+this.E|0,u=u+this.F|0,l=l+this.G|0,f=f+this.H|0,this.set(n,o,i,a,c,u,l,f)}roundClean(){(0,Be.clean)($t)}destroy(){this.set(0,0,0,0,0,0,0,0),(0,Be.clean)(this.buffer)}};ye.SHA256=tn;var Mn=class extends tn{static{s(this,"SHA224")}constructor(){super(28),this.A=$.SHA224_IV[0]|0,this.B=$.SHA224_IV[1]|0,this.C=$.SHA224_IV[2]|0,this.D=$.SHA224_IV[3]|0,this.E=$.SHA224_IV[4]|0,this.F=$.SHA224_IV[5]|0,this.G=$.SHA224_IV[6]|0,this.H=$.SHA224_IV[7]|0}};ye.SHA224=Mn;var Lc=re.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),w0=Lc[0],x0=Lc[1],Zt=new Uint32Array(80),Yt=new Uint32Array(80),nr=class extends $.HashMD{static{s(this,"SHA512")}constructor(t=64){super(128,t,16,!1),this.Ah=$.SHA512_IV[0]|0,this.Al=$.SHA512_IV[1]|0,this.Bh=$.SHA512_IV[2]|0,this.Bl=$.SHA512_IV[3]|0,this.Ch=$.SHA512_IV[4]|0,this.Cl=$.SHA512_IV[5]|0,this.Dh=$.SHA512_IV[6]|0,this.Dl=$.SHA512_IV[7]|0,this.Eh=$.SHA512_IV[8]|0,this.El=$.SHA512_IV[9]|0,this.Fh=$.SHA512_IV[10]|0,this.Fl=$.SHA512_IV[11]|0,this.Gh=$.SHA512_IV[12]|0,this.Gl=$.SHA512_IV[13]|0,this.Hh=$.SHA512_IV[14]|0,this.Hl=$.SHA512_IV[15]|0}get(){let{Ah:t,Al:r,Bh:n,Bl:o,Ch:i,Cl:a,Dh:c,Dl:u,Eh:l,El:f,Fh:p,Fl:d,Gh:y,Gl:h,Hh:w,Hl:m}=this;return[t,r,n,o,i,a,c,u,l,f,p,d,y,h,w,m]}set(t,r,n,o,i,a,c,u,l,f,p,d,y,h,w,m){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=o|0,this.Ch=i|0,this.Cl=a|0,this.Dh=c|0,this.Dl=u|0,this.Eh=l|0,this.El=f|0,this.Fh=p|0,this.Fl=d|0,this.Gh=y|0,this.Gl=h|0,this.Hh=w|0,this.Hl=m|0}process(t,r){for(let _=0;_<16;_++,r+=4)Zt[_]=t.getUint32(r),Yt[_]=t.getUint32(r+=4);for(let _=16;_<80;_++){let C=Zt[_-15]|0,M=Yt[_-15]|0,q=re.rotrSH(C,M,1)^re.rotrSH(C,M,8)^re.shrSH(C,M,7),W=re.rotrSL(C,M,1)^re.rotrSL(C,M,8)^re.shrSL(C,M,7),k=Zt[_-2]|0,B=Yt[_-2]|0,O=re.rotrSH(k,B,19)^re.rotrBH(k,B,61)^re.shrSH(k,B,6),R=re.rotrSL(k,B,19)^re.rotrBL(k,B,61)^re.shrSL(k,B,6),D=re.add4L(W,R,Yt[_-7],Yt[_-16]),v=re.add4H(D,q,O,Zt[_-7],Zt[_-16]);Zt[_]=v|0,Yt[_]=D|0}let{Ah:n,Al:o,Bh:i,Bl:a,Ch:c,Cl:u,Dh:l,Dl:f,Eh:p,El:d,Fh:y,Fl:h,Gh:w,Gl:m,Hh:x,Hl:E}=this;for(let _=0;_<80;_++){let C=re.rotrSH(p,d,14)^re.rotrSH(p,d,18)^re.rotrBH(p,d,41),M=re.rotrSL(p,d,14)^re.rotrSL(p,d,18)^re.rotrBL(p,d,41),q=p&y^~p&w,W=d&h^~d&m,k=re.add5L(E,M,W,x0[_],Yt[_]),B=re.add5H(k,x,C,q,w0[_],Zt[_]),O=k|0,R=re.rotrSH(n,o,28)^re.rotrBH(n,o,34)^re.rotrBH(n,o,39),D=re.rotrSL(n,o,28)^re.rotrBL(n,o,34)^re.rotrBL(n,o,39),v=n&i^n&c^i&c,S=o&a^o&u^a&u;x=w|0,E=m|0,w=y|0,m=h|0,y=p|0,h=d|0,{h:p,l:d}=re.add(l|0,f|0,B|0,O|0),l=c|0,f=u|0,c=i|0,u=a|0,i=n|0,a=o|0;let A=re.add3L(O,D,S);n=re.add3H(A,B,R,v),o=A|0}({h:n,l:o}=re.add(this.Ah|0,this.Al|0,n|0,o|0)),{h:i,l:a}=re.add(this.Bh|0,this.Bl|0,i|0,a|0),{h:c,l:u}=re.add(this.Ch|0,this.Cl|0,c|0,u|0),{h:l,l:f}=re.add(this.Dh|0,this.Dl|0,l|0,f|0),{h:p,l:d}=re.add(this.Eh|0,this.El|0,p|0,d|0),{h:y,l:h}=re.add(this.Fh|0,this.Fl|0,y|0,h|0),{h:w,l:m}=re.add(this.Gh|0,this.Gl|0,w|0,m|0),{h:x,l:E}=re.add(this.Hh|0,this.Hl|0,x|0,E|0),this.set(n,o,i,a,c,u,l,f,p,d,y,h,w,m,x,E)}roundClean(){(0,Be.clean)(Zt,Yt)}destroy(){(0,Be.clean)(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};ye.SHA512=nr;var Kn=class extends nr{static{s(this,"SHA384")}constructor(){super(48),this.Ah=$.SHA384_IV[0]|0,this.Al=$.SHA384_IV[1]|0,this.Bh=$.SHA384_IV[2]|0,this.Bl=$.SHA384_IV[3]|0,this.Ch=$.SHA384_IV[4]|0,this.Cl=$.SHA384_IV[5]|0,this.Dh=$.SHA384_IV[6]|0,this.Dl=$.SHA384_IV[7]|0,this.Eh=$.SHA384_IV[8]|0,this.El=$.SHA384_IV[9]|0,this.Fh=$.SHA384_IV[10]|0,this.Fl=$.SHA384_IV[11]|0,this.Gh=$.SHA384_IV[12]|0,this.Gl=$.SHA384_IV[13]|0,this.Hh=$.SHA384_IV[14]|0,this.Hl=$.SHA384_IV[15]|0}};ye.SHA384=Kn;var Ne=Uint32Array.from([2352822216,424955298,1944164710,2312950998,502970286,855612546,1738396948,1479516111,258812777,2077511080,2011393907,79989058,1067287976,1780299464,286451373,2446758561]),He=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]),qn=class extends nr{static{s(this,"SHA512_224")}constructor(){super(28),this.Ah=Ne[0]|0,this.Al=Ne[1]|0,this.Bh=Ne[2]|0,this.Bl=Ne[3]|0,this.Ch=Ne[4]|0,this.Cl=Ne[5]|0,this.Dh=Ne[6]|0,this.Dl=Ne[7]|0,this.Eh=Ne[8]|0,this.El=Ne[9]|0,this.Fh=Ne[10]|0,this.Fl=Ne[11]|0,this.Gh=Ne[12]|0,this.Gl=Ne[13]|0,this.Hh=Ne[14]|0,this.Hl=Ne[15]|0}};ye.SHA512_224=qn;var kn=class extends nr{static{s(this,"SHA512_256")}constructor(){super(32),this.Ah=He[0]|0,this.Al=He[1]|0,this.Bh=He[2]|0,this.Bl=He[3]|0,this.Ch=He[4]|0,this.Cl=He[5]|0,this.Dh=He[6]|0,this.Dl=He[7]|0,this.Eh=He[8]|0,this.El=He[9]|0,this.Fh=He[10]|0,this.Fl=He[11]|0,this.Gh=He[12]|0,this.Gl=He[13]|0,this.Hh=He[14]|0,this.Hl=He[15]|0}};ye.SHA512_256=kn;ye.sha256=(0,Be.createHasher)(()=>new tn);ye.sha224=(0,Be.createHasher)(()=>new Mn);ye.sha512=(0,Be.createHasher)(()=>new nr);ye.sha384=(0,Be.createHasher)(()=>new Kn);ye.sha512_256=(0,Be.createHasher)(()=>new kn);ye.sha512_224=(0,Be.createHasher)(()=>new qn)});var Nt=ne(Y=>{"use strict";g();b();Object.defineProperty(Y,"__esModule",{value:!0});Y.notImplemented=Y.bitMask=Y.utf8ToBytes=Y.randomBytes=Y.isBytes=Y.hexToBytes=Y.concatBytes=Y.bytesToUtf8=Y.bytesToHex=Y.anumber=Y.abytes=void 0;Y.abool=E0;Y._abool2=v0;Y._abytes2=S0;Y.numberToHexUnpadded=Oc;Y.hexToNumber=us;Y.bytesToNumberBE=_0;Y.bytesToNumberLE=A0;Y.numberToBytesBE=Pc;Y.numberToBytesLE=B0;Y.numberToVarBytesBE=C0;Y.ensureBytes=I0;Y.equalBytes=T0;Y.copyBytes=L0;Y.asciiToBytes=O0;Y.inRange=Uc;Y.aInRange=P0;Y.bitLen=U0;Y.bitGet=R0;Y.bitSet=D0;Y.createHmacDrbg=H0;Y.validateObject=K0;Y.isHash=q0;Y._validateObject=k0;Y.memoized=F0;var bt=mt(),Dt=mt();Object.defineProperty(Y,"abytes",{enumerable:!0,get:s(function(){return Dt.abytes},"get")});Object.defineProperty(Y,"anumber",{enumerable:!0,get:s(function(){return Dt.anumber},"get")});Object.defineProperty(Y,"bytesToHex",{enumerable:!0,get:s(function(){return Dt.bytesToHex},"get")});Object.defineProperty(Y,"bytesToUtf8",{enumerable:!0,get:s(function(){return Dt.bytesToUtf8},"get")});Object.defineProperty(Y,"concatBytes",{enumerable:!0,get:s(function(){return Dt.concatBytes},"get")});Object.defineProperty(Y,"hexToBytes",{enumerable:!0,get:s(function(){return Dt.hexToBytes},"get")});Object.defineProperty(Y,"isBytes",{enumerable:!0,get:s(function(){return Dt.isBytes},"get")});Object.defineProperty(Y,"randomBytes",{enumerable:!0,get:s(function(){return Dt.randomBytes},"get")});Object.defineProperty(Y,"utf8ToBytes",{enumerable:!0,get:s(function(){return Dt.utf8ToBytes},"get")});var Fn=BigInt(0),rn=BigInt(1);function E0(e,t){if(typeof t!="boolean")throw new Error(e+" boolean expected, got "+t)}s(E0,"abool");function v0(e,t=""){if(typeof e!="boolean"){let r=t&&`"${t}"`;throw new Error(r+"expected boolean, got type="+typeof e)}return e}s(v0,"_abool2");function S0(e,t,r=""){let n=(0,bt.isBytes)(e),o=e?.length,i=t!==void 0;if(!n||i&&o!==t){let a=r&&`"${r}" `,c=i?` of length ${t}`:"",u=n?`length=${o}`:`type=${typeof e}`;throw new Error(a+"expected Uint8Array"+c+", got "+u)}return e}s(S0,"_abytes2");function Oc(e){let t=e.toString(16);return t.length&1?"0"+t:t}s(Oc,"numberToHexUnpadded");function us(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?Fn:BigInt("0x"+e)}s(us,"hexToNumber");function _0(e){return us((0,bt.bytesToHex)(e))}s(_0,"bytesToNumberBE");function A0(e){return(0,bt.abytes)(e),us((0,bt.bytesToHex)(Uint8Array.from(e).reverse()))}s(A0,"bytesToNumberLE");function Pc(e,t){return(0,bt.hexToBytes)(e.toString(16).padStart(t*2,"0"))}s(Pc,"numberToBytesBE");function B0(e,t){return Pc(e,t).reverse()}s(B0,"numberToBytesLE");function C0(e){return(0,bt.hexToBytes)(Oc(e))}s(C0,"numberToVarBytesBE");function I0(e,t,r){let n;if(typeof t=="string")try{n=(0,bt.hexToBytes)(t)}catch(i){throw new Error(e+" must be hex string or Uint8Array, cause: "+i)}else if((0,bt.isBytes)(t))n=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");let o=n.length;if(typeof r=="number"&&o!==r)throw new Error(e+" of length "+r+" expected, got "+o);return n}s(I0,"ensureBytes");function T0(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return r===0}s(T0,"equalBytes");function L0(e){return Uint8Array.from(e)}s(L0,"copyBytes");function O0(e){return Uint8Array.from(e,(t,r)=>{let n=t.charCodeAt(0);if(t.length!==1||n>127)throw new Error(`string contains non-ASCII character "${e[r]}" with code ${n} at position ${r}`);return n})}s(O0,"asciiToBytes");var cs=s(e=>typeof e=="bigint"&&Fn<=e,"isPosBig");function Uc(e,t,r){return cs(e)&&cs(t)&&cs(r)&&t<=e&&e<r}s(Uc,"inRange");function P0(e,t,r,n){if(!Uc(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}s(P0,"aInRange");function U0(e){let t;for(t=0;e>Fn;e>>=rn,t+=1);return t}s(U0,"bitLen");function R0(e,t){return e>>BigInt(t)&rn}s(R0,"bitGet");function D0(e,t,r){return e|(r?rn:Fn)<<BigInt(t)}s(D0,"bitSet");var N0=s(e=>(rn<<BigInt(e))-rn,"bitMask");Y.bitMask=N0;function H0(e,t,r){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=s(y=>new Uint8Array(y),"u8n"),o=s(y=>Uint8Array.of(y),"u8of"),i=n(e),a=n(e),c=0,u=s(()=>{i.fill(1),a.fill(0),c=0},"reset"),l=s((...y)=>r(a,i,...y),"h"),f=s((y=n(0))=>{a=l(o(0),y),i=l(),y.length!==0&&(a=l(o(1),y),i=l())},"reseed"),p=s(()=>{if(c++>=1e3)throw new Error("drbg: tried 1000 values");let y=0,h=[];for(;y<t;){i=l();let w=i.slice();h.push(w),y+=i.length}return(0,bt.concatBytes)(...h)},"gen");return s((y,h)=>{u(),f(y);let w;for(;!(w=h(p()));)f();return u(),w},"genUntil")}s(H0,"createHmacDrbg");var M0={bigint:s(e=>typeof e=="bigint","bigint"),function:s(e=>typeof e=="function","function"),boolean:s(e=>typeof e=="boolean","boolean"),string:s(e=>typeof e=="string","string"),stringOrUint8Array:s(e=>typeof e=="string"||(0,bt.isBytes)(e),"stringOrUint8Array"),isSafeInteger:s(e=>Number.isSafeInteger(e),"isSafeInteger"),array:s(e=>Array.isArray(e),"array"),field:s((e,t)=>t.Fp.isValid(e),"field"),hash:s(e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen),"hash")};function K0(e,t,r={}){let n=s((o,i,a)=>{let c=M0[i];if(typeof c!="function")throw new Error("invalid validator function");let u=e[o];if(!(a&&u===void 0)&&!c(u,e))throw new Error("param "+String(o)+" is invalid. Expected "+i+", got "+u)},"checkField");for(let[o,i]of Object.entries(t))n(o,i,!1);for(let[o,i]of Object.entries(r))n(o,i,!0);return e}s(K0,"validateObject");function q0(e){return typeof e=="function"&&Number.isSafeInteger(e.outputLen)}s(q0,"isHash");function k0(e,t,r={}){if(!e||typeof e!="object")throw new Error("expected valid options object");function n(o,i,a){let c=e[o];if(a&&c===void 0)return;let u=typeof c;if(u!==i||c===null)throw new Error(`param "${o}" is invalid: expected ${i}, got ${u}`)}s(n,"checkField"),Object.entries(t).forEach(([o,i])=>n(o,i,!1)),Object.entries(r).forEach(([o,i])=>n(o,i,!0))}s(k0,"_validateObject");var V0=s(()=>{throw new Error("not implemented")},"notImplemented");Y.notImplemented=V0;function F0(e){let t=new WeakMap;return(r,...n)=>{let o=t.get(r);if(o!==void 0)return o;let i=e(r,...n);return t.set(r,i),i}}s(F0,"memoized")});var Qt=ne(xe=>{"use strict";g();b();Object.defineProperty(xe,"__esModule",{value:!0});xe.isNegativeLE=void 0;xe.mod=Ze;xe.pow=W0;xe.pow2=G0;xe.invert=jn;xe.tonelliShanks=fs;xe.FpSqrt=qc;xe.validateField=X0;xe.FpPow=ds;xe.FpInvertBatch=kc;xe.FpDiv=J0;xe.FpLegendre=zn;xe.FpIsSquare=eh;xe.nLength=hs;xe.Field=Wn;xe.FpSqrtOdd=th;xe.FpSqrtEven=rh;xe.hashToPrivateScalar=nh;xe.getFieldBytesLength=ps;xe.getMinHashLength=Vc;xe.mapHashToField=oh;var Ye=Nt(),Ve=BigInt(0),Ce=BigInt(1),or=BigInt(2),Rc=BigInt(3),Dc=BigInt(4),Nc=BigInt(5),j0=BigInt(7),Hc=BigInt(8),z0=BigInt(9),Mc=BigInt(16);function Ze(e,t){let r=e%t;return r>=Ve?r:t+r}s(Ze,"mod");function W0(e,t,r){return ds(Wn(r),e,t)}s(W0,"pow");function G0(e,t,r){let n=e;for(;t-- >Ve;)n*=n,n%=r;return n}s(G0,"pow2");function jn(e,t){if(e===Ve)throw new Error("invert: expected non-zero number");if(t<=Ve)throw new Error("invert: expected positive modulus, got "+t);let r=Ze(e,t),n=t,o=Ve,i=Ce,a=Ce,c=Ve;for(;r!==Ve;){let l=n/r,f=n%r,p=o-a*l,d=i-c*l;n=r,r=f,o=a,i=c,a=p,c=d}if(n!==Ce)throw new Error("invert: does not exist");return Ze(o,t)}s(jn,"invert");function ls(e,t,r){if(!e.eql(e.sqr(t),r))throw new Error("Cannot find square root")}s(ls,"assertIsSquare");function Kc(e,t){let r=(e.ORDER+Ce)/Dc,n=e.pow(t,r);return ls(e,n,t),n}s(Kc,"sqrt3mod4");function $0(e,t){let r=(e.ORDER-Nc)/Hc,n=e.mul(t,or),o=e.pow(n,r),i=e.mul(t,o),a=e.mul(e.mul(i,or),o),c=e.mul(i,e.sub(a,e.ONE));return ls(e,c,t),c}s($0,"sqrt5mod8");function Z0(e){let t=Wn(e),r=fs(e),n=r(t,t.neg(t.ONE)),o=r(t,n),i=r(t,t.neg(n)),a=(e+j0)/Mc;return(c,u)=>{let l=c.pow(u,a),f=c.mul(l,n),p=c.mul(l,o),d=c.mul(l,i),y=c.eql(c.sqr(f),u),h=c.eql(c.sqr(p),u);l=c.cmov(l,f,y),f=c.cmov(d,p,h);let w=c.eql(c.sqr(f),u),m=c.cmov(l,f,w);return ls(c,m,u),m}}s(Z0,"sqrt9mod16");function fs(e){if(e<Rc)throw new Error("sqrt is not defined for small field");let t=e-Ce,r=0;for(;t%or===Ve;)t/=or,r++;let n=or,o=Wn(e);for(;zn(o,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return Kc;let i=o.pow(n,t),a=(t+Ce)/or;return s(function(u,l){if(u.is0(l))return l;if(zn(u,l)!==1)throw new Error("Cannot find square root");let f=r,p=u.mul(u.ONE,i),d=u.pow(l,t),y=u.pow(l,a);for(;!u.eql(d,u.ONE);){if(u.is0(d))return u.ZERO;let h=1,w=u.sqr(d);for(;!u.eql(w,u.ONE);)if(h++,w=u.sqr(w),h===f)throw new Error("Cannot find square root");let m=Ce<<BigInt(f-h-1),x=u.pow(p,m);f=h,p=u.sqr(x),d=u.mul(d,p),y=u.mul(y,x)}return y},"tonelliSlow")}s(fs,"tonelliShanks");function qc(e){return e%Dc===Rc?Kc:e%Hc===Nc?$0:e%Mc===z0?Z0(e):fs(e)}s(qc,"FpSqrt");var Y0=s((e,t)=>(Ze(e,t)&Ce)===Ce,"isNegativeLE");xe.isNegativeLE=Y0;var Q0=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function X0(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},r=Q0.reduce((n,o)=>(n[o]="function",n),t);return(0,Ye._validateObject)(e,r),e}s(X0,"validateField");function ds(e,t,r){if(r<Ve)throw new Error("invalid exponent, negatives unsupported");if(r===Ve)return e.ONE;if(r===Ce)return t;let n=e.ONE,o=t;for(;r>Ve;)r&Ce&&(n=e.mul(n,o)),o=e.sqr(o),r>>=Ce;return n}s(ds,"FpPow");function kc(e,t,r=!1){let n=new Array(t.length).fill(r?e.ZERO:void 0),o=t.reduce((a,c,u)=>e.is0(c)?a:(n[u]=a,e.mul(a,c)),e.ONE),i=e.inv(o);return t.reduceRight((a,c,u)=>e.is0(c)?a:(n[u]=e.mul(a,n[u]),e.mul(a,c)),i),n}s(kc,"FpInvertBatch");function J0(e,t,r){return e.mul(t,typeof r=="bigint"?jn(r,e.ORDER):e.inv(r))}s(J0,"FpDiv");function zn(e,t){let r=(e.ORDER-Ce)/or,n=e.pow(t,r),o=e.eql(n,e.ONE),i=e.eql(n,e.ZERO),a=e.eql(n,e.neg(e.ONE));if(!o&&!i&&!a)throw new Error("invalid Legendre symbol result");return o?1:i?0:-1}s(zn,"FpLegendre");function eh(e,t){return zn(e,t)===1}s(eh,"FpIsSquare");function hs(e,t){t!==void 0&&(0,Ye.anumber)(t);let r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}s(hs,"nLength");function Wn(e,t,r=!1,n={}){if(e<=Ve)throw new Error("invalid field: expected ORDER > 0, got "+e);let o,i,a=!1,c;if(typeof t=="object"&&t!=null){if(n.sqrt||r)throw new Error("cannot specify opts in two arguments");let d=t;d.BITS&&(o=d.BITS),d.sqrt&&(i=d.sqrt),typeof d.isLE=="boolean"&&(r=d.isLE),typeof d.modFromBytes=="boolean"&&(a=d.modFromBytes),c=d.allowedLengths}else typeof t=="number"&&(o=t),n.sqrt&&(i=n.sqrt);let{nBitLength:u,nByteLength:l}=hs(e,o);if(l>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let f,p=Object.freeze({ORDER:e,isLE:r,BITS:u,BYTES:l,MASK:(0,Ye.bitMask)(u),ZERO:Ve,ONE:Ce,allowedLengths:c,create:s(d=>Ze(d,e),"create"),isValid:s(d=>{if(typeof d!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof d);return Ve<=d&&d<e},"isValid"),is0:s(d=>d===Ve,"is0"),isValidNot0:s(d=>!p.is0(d)&&p.isValid(d),"isValidNot0"),isOdd:s(d=>(d&Ce)===Ce,"isOdd"),neg:s(d=>Ze(-d,e),"neg"),eql:s((d,y)=>d===y,"eql"),sqr:s(d=>Ze(d*d,e),"sqr"),add:s((d,y)=>Ze(d+y,e),"add"),sub:s((d,y)=>Ze(d-y,e),"sub"),mul:s((d,y)=>Ze(d*y,e),"mul"),pow:s((d,y)=>ds(p,d,y),"pow"),div:s((d,y)=>Ze(d*jn(y,e),e),"div"),sqrN:s(d=>d*d,"sqrN"),addN:s((d,y)=>d+y,"addN"),subN:s((d,y)=>d-y,"subN"),mulN:s((d,y)=>d*y,"mulN"),inv:s(d=>jn(d,e),"inv"),sqrt:i||(d=>(f||(f=qc(e)),f(p,d))),toBytes:s(d=>r?(0,Ye.numberToBytesLE)(d,l):(0,Ye.numberToBytesBE)(d,l),"toBytes"),fromBytes:s((d,y=!0)=>{if(c){if(!c.includes(d.length)||d.length>l)throw new Error("Field.fromBytes: expected "+c+" bytes, got "+d.length);let w=new Uint8Array(l);w.set(d,r?0:w.length-d.length),d=w}if(d.length!==l)throw new Error("Field.fromBytes: expected "+l+" bytes, got "+d.length);let h=r?(0,Ye.bytesToNumberLE)(d):(0,Ye.bytesToNumberBE)(d);if(a&&(h=Ze(h,e)),!y&&!p.isValid(h))throw new Error("invalid field element: outside of range 0..ORDER");return h},"fromBytes"),invertBatch:s(d=>kc(p,d),"invertBatch"),cmov:s((d,y,h)=>h?y:d,"cmov")});return Object.freeze(p)}s(Wn,"Field");function th(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?r:e.neg(r)}s(th,"FpSqrtOdd");function rh(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?e.neg(r):r}s(rh,"FpSqrtEven");function nh(e,t,r=!1){e=(0,Ye.ensureBytes)("privateHash",e);let n=e.length,o=hs(t).nByteLength+8;if(o<24||n<o||n>1024)throw new Error("hashToPrivateScalar: expected "+o+"-1024 bytes of input, got "+n);let i=r?(0,Ye.bytesToNumberLE)(e):(0,Ye.bytesToNumberBE)(e);return Ze(i,t-Ce)+Ce}s(nh,"hashToPrivateScalar");function ps(e){if(typeof e!="bigint")throw new Error("field order must be bigint");let t=e.toString(2).length;return Math.ceil(t/8)}s(ps,"getFieldBytesLength");function Vc(e){let t=ps(e);return t+Math.ceil(t/2)}s(Vc,"getMinHashLength");function oh(e,t,r=!1){let n=e.length,o=ps(t),i=Vc(t);if(n<16||n<i||n>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+n);let a=r?(0,Ye.bytesToNumberLE)(e):(0,Ye.bytesToNumberBE)(e),c=Ze(a,t-Ce)+Ce;return r?(0,Ye.numberToBytesLE)(c,o):(0,Ye.numberToBytesBE)(c,o)}s(oh,"mapHashToField")});var Gn=ne(ut=>{"use strict";g();b();Object.defineProperty(ut,"__esModule",{value:!0});ut.wNAF=void 0;ut.negateCt=bs;ut.normalizeZ=sh;ut.mulEndoUnsafe=ih;ut.pippenger=ah;ut.precomputeMSMUnsafe=ch;ut.validateBasic=uh;ut._createCurveFields=lh;var nn=Nt(),on=Qt(),Or=BigInt(0),sr=BigInt(1);function bs(e,t){let r=t.negate();return e?r:t}s(bs,"negateCt");function sh(e,t){let r=(0,on.FpInvertBatch)(e.Fp,t.map(n=>n.Z));return t.map((n,o)=>e.fromAffine(n.toAffine(r[o])))}s(sh,"normalizeZ");function xs(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}s(xs,"validateW");function ys(e,t){xs(e,t);let r=Math.ceil(t/e)+1,n=2**(e-1),o=2**e,i=(0,nn.bitMask)(e),a=BigInt(e);return{windows:r,windowSize:n,mask:i,maxNumber:o,shiftBy:a}}s(ys,"calcWOpts");function Fc(e,t,r){let{windowSize:n,mask:o,maxNumber:i,shiftBy:a}=r,c=Number(e&o),u=e>>a;c>n&&(c-=i,u+=sr);let l=t*n,f=l+Math.abs(c)-1,p=c===0,d=c<0,y=t%2!==0;return{nextN:u,offset:f,isZero:p,isNeg:d,isNegF:y,offsetF:l}}s(Fc,"calcOffsets");function Wc(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((r,n)=>{if(!(r instanceof t))throw new Error("invalid point at index "+n)})}s(Wc,"validateMSMPoints");function Gc(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((r,n)=>{if(!t.isValid(r))throw new Error("invalid scalar at index "+n)})}s(Gc,"validateMSMScalars");var ms=new WeakMap,$c=new WeakMap;function gs(e){return $c.get(e)||1}s(gs,"getW");function jc(e){if(e!==Or)throw new Error("invalid wNAF")}s(jc,"assert0");var ws=class{static{s(this,"wNAF")}constructor(t,r){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=r}_unsafeLadder(t,r,n=this.ZERO){let o=t;for(;r>Or;)r&sr&&(n=n.add(o)),o=o.double(),r>>=sr;return n}precomputeWindow(t,r){let{windows:n,windowSize:o}=ys(r,this.bits),i=[],a=t,c=a;for(let u=0;u<n;u++){c=a,i.push(c);for(let l=1;l<o;l++)c=c.add(a),i.push(c);a=c.double()}return i}wNAF(t,r,n){if(!this.Fn.isValid(n))throw new Error("invalid scalar");let o=this.ZERO,i=this.BASE,a=ys(t,this.bits);for(let c=0;c<a.windows;c++){let{nextN:u,offset:l,isZero:f,isNeg:p,isNegF:d,offsetF:y}=Fc(n,c,a);n=u,f?i=i.add(bs(d,r[y])):o=o.add(bs(p,r[l]))}return jc(n),{p:o,f:i}}wNAFUnsafe(t,r,n,o=this.ZERO){let i=ys(t,this.bits);for(let a=0;a<i.windows&&n!==Or;a++){let{nextN:c,offset:u,isZero:l,isNeg:f}=Fc(n,a,i);if(n=c,!l){let p=r[u];o=o.add(f?p.negate():p)}}return jc(n),o}getPrecomputes(t,r,n){let o=ms.get(r);return o||(o=this.precomputeWindow(r,t),t!==1&&(typeof n=="function"&&(o=n(o)),ms.set(r,o))),o}cached(t,r,n){let o=gs(t);return this.wNAF(o,this.getPrecomputes(o,t,n),r)}unsafe(t,r,n,o){let i=gs(t);return i===1?this._unsafeLadder(t,r,o):this.wNAFUnsafe(i,this.getPrecomputes(i,t,n),r,o)}createCache(t,r){xs(r,this.bits),$c.set(t,r),ms.delete(t)}hasCache(t){return gs(t)!==1}};ut.wNAF=ws;function ih(e,t,r,n){let o=t,i=e.ZERO,a=e.ZERO;for(;r>Or||n>Or;)r&sr&&(i=i.add(o)),n&sr&&(a=a.add(o)),o=o.double(),r>>=sr,n>>=sr;return{p1:i,p2:a}}s(ih,"mulEndoUnsafe");function ah(e,t,r,n){Wc(r,e),Gc(n,t);let o=r.length,i=n.length;if(o!==i)throw new Error("arrays of points and scalars must have equal length");let a=e.ZERO,c=(0,nn.bitLen)(BigInt(o)),u=1;c>12?u=c-3:c>4?u=c-2:c>0&&(u=2);let l=(0,nn.bitMask)(u),f=new Array(Number(l)+1).fill(a),p=Math.floor((t.BITS-1)/u)*u,d=a;for(let y=p;y>=0;y-=u){f.fill(a);for(let w=0;w<i;w++){let m=n[w],x=Number(m>>BigInt(y)&l);f[x]=f[x].add(r[w])}let h=a;for(let w=f.length-1,m=a;w>0;w--)m=m.add(f[w]),h=h.add(m);if(d=d.add(h),y!==0)for(let w=0;w<u;w++)d=d.double()}return d}s(ah,"pippenger");function ch(e,t,r,n){xs(n,t.BITS),Wc(r,e);let o=e.ZERO,i=2**n-1,a=Math.ceil(t.BITS/n),c=(0,nn.bitMask)(n),u=r.map(l=>{let f=[];for(let p=0,d=l;p<i;p++)f.push(d),d=d.add(l);return f});return l=>{if(Gc(l,t),l.length>r.length)throw new Error("array of scalars must be smaller than array of points");let f=o;for(let p=0;p<a;p++){if(f!==o)for(let y=0;y<n;y++)f=f.double();let d=BigInt(a*n-(p+1)*n);for(let y=0;y<l.length;y++){let h=l[y],w=Number(h>>d&c);w&&(f=f.add(u[y][w-1]))}}return f}}s(ch,"precomputeMSMUnsafe");function uh(e){return(0,on.validateField)(e.Fp),(0,nn.validateObject)(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,on.nLength)(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}s(uh,"validateBasic");function zc(e,t,r){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return(0,on.validateField)(t),t}else return(0,on.Field)(e,{isLE:r})}s(zc,"createField");function lh(e,t,r={},n){if(n===void 0&&(n=e==="edwards"),!t||typeof t!="object")throw new Error(`expected valid ${e} CURVE object`);for(let u of["p","n","h"]){let l=t[u];if(!(typeof l=="bigint"&&l>Or))throw new Error(`CURVE.${u} must be positive bigint`)}let o=zc(t.p,r.Fp,n),i=zc(t.n,r.Fn,n),c=["Gx","Gy","a",e==="weierstrass"?"b":"d"];for(let u of c)if(!o.isValid(t[u]))throw new Error(`CURVE.${u} must be valid field element of CURVE.Fp`);return t=Object.freeze(Object.assign({},t)),{CURVE:t,Fp:o,Fn:i}}s(lh,"_createCurveFields")});var Qc=ne(ar=>{"use strict";g();b();Object.defineProperty(ar,"__esModule",{value:!0});ar.PrimeEdwardsPoint=void 0;ar.edwards=Zc;ar.eddsa=Yc;ar.twistedEdwards=mh;var ce=Nt(),ir=Gn(),fh=Qt(),Xt=BigInt(0),Te=BigInt(1),Es=BigInt(2),dh=BigInt(8);function hh(e,t,r,n){let o=e.sqr(r),i=e.sqr(n),a=e.add(e.mul(t.a,o),i),c=e.add(e.ONE,e.mul(t.d,e.mul(o,i)));return e.eql(a,c)}s(hh,"isEdValidXY");function Zc(e,t={}){let r=(0,ir._createCurveFields)("edwards",e,t,t.FpFnLE),{Fp:n,Fn:o}=r,i=r.CURVE,{h:a}=i;(0,ce._validateObject)(t,{},{uvRatio:"function"});let c=Es<<BigInt(o.BYTES*8)-Te,u=s(m=>n.create(m),"modP"),l=t.uvRatio||((m,x)=>{try{return{isValid:!0,value:n.sqrt(n.div(m,x))}}catch{return{isValid:!1,value:Xt}}});if(!hh(n,i,i.Gx,i.Gy))throw new Error("bad curve params: generator point");function f(m,x,E=!1){let _=E?Te:Xt;return(0,ce.aInRange)("coordinate "+m,x,_,c),x}s(f,"acoord");function p(m){if(!(m instanceof h))throw new Error("ExtendedPoint expected")}s(p,"aextpoint");let d=(0,ce.memoized)((m,x)=>{let{X:E,Y:_,Z:C}=m,M=m.is0();x==null&&(x=M?dh:n.inv(C));let q=u(E*x),W=u(_*x),k=n.mul(C,x);if(M)return{x:Xt,y:Te};if(k!==Te)throw new Error("invZ was invalid");return{x:q,y:W}}),y=(0,ce.memoized)(m=>{let{a:x,d:E}=i;if(m.is0())throw new Error("bad point: ZERO");let{X:_,Y:C,Z:M,T:q}=m,W=u(_*_),k=u(C*C),B=u(M*M),O=u(B*B),R=u(W*x),D=u(B*u(R+k)),v=u(O+u(E*u(W*k)));if(D!==v)throw new Error("bad point: equation left != right (1)");let S=u(_*C),A=u(M*q);if(S!==A)throw new Error("bad point: equation left != right (2)");return!0});class h{static{s(this,"Point")}constructor(x,E,_,C){this.X=f("x",x),this.Y=f("y",E),this.Z=f("z",_,!0),this.T=f("t",C),Object.freeze(this)}static CURVE(){return i}static fromAffine(x){if(x instanceof h)throw new Error("extended point not allowed");let{x:E,y:_}=x||{};return f("x",E),f("y",_),new h(E,_,Te,u(E*_))}static fromBytes(x,E=!1){let _=n.BYTES,{a:C,d:M}=i;x=(0,ce.copyBytes)((0,ce._abytes2)(x,_,"point")),(0,ce._abool2)(E,"zip215");let q=(0,ce.copyBytes)(x),W=x[_-1];q[_-1]=W&-129;let k=(0,ce.bytesToNumberLE)(q),B=E?c:n.ORDER;(0,ce.aInRange)("point.y",k,Xt,B);let O=u(k*k),R=u(O-Te),D=u(M*O-C),{isValid:v,value:S}=l(R,D);if(!v)throw new Error("bad point: invalid y coordinate");let A=(S&Te)===Te,P=(W&128)!==0;if(!E&&S===Xt&&P)throw new Error("bad point: x=0 and x_0=1");return P!==A&&(S=u(-S)),h.fromAffine({x:S,y:k})}static fromHex(x,E=!1){return h.fromBytes((0,ce.ensureBytes)("point",x),E)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(x=8,E=!0){return w.createCache(this,x),E||this.multiply(Es),this}assertValidity(){y(this)}equals(x){p(x);let{X:E,Y:_,Z:C}=this,{X:M,Y:q,Z:W}=x,k=u(E*W),B=u(M*C),O=u(_*W),R=u(q*C);return k===B&&O===R}is0(){return this.equals(h.ZERO)}negate(){return new h(u(-this.X),this.Y,this.Z,u(-this.T))}double(){let{a:x}=i,{X:E,Y:_,Z:C}=this,M=u(E*E),q=u(_*_),W=u(Es*u(C*C)),k=u(x*M),B=E+_,O=u(u(B*B)-M-q),R=k+q,D=R-W,v=k-q,S=u(O*D),A=u(R*v),P=u(O*v),U=u(D*R);return new h(S,A,U,P)}add(x){p(x);let{a:E,d:_}=i,{X:C,Y:M,Z:q,T:W}=this,{X:k,Y:B,Z:O,T:R}=x,D=u(C*k),v=u(M*B),S=u(W*_*R),A=u(q*O),P=u((C+M)*(k+B)-D-v),U=A-S,H=A+S,L=u(v-E*D),N=u(P*U),K=u(H*L),z=u(P*L),se=u(U*H);return new h(N,K,se,z)}subtract(x){return this.add(x.negate())}multiply(x){if(!o.isValidNot0(x))throw new Error("invalid scalar: expected 1 <= sc < curve.n");let{p:E,f:_}=w.cached(this,x,C=>(0,ir.normalizeZ)(h,C));return(0,ir.normalizeZ)(h,[E,_])[0]}multiplyUnsafe(x,E=h.ZERO){if(!o.isValid(x))throw new Error("invalid scalar: expected 0 <= sc < curve.n");return x===Xt?h.ZERO:this.is0()||x===Te?this:w.unsafe(this,x,_=>(0,ir.normalizeZ)(h,_),E)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}isTorsionFree(){return w.unsafe(this,i.n).is0()}toAffine(x){return d(this,x)}clearCofactor(){return a===Te?this:this.multiplyUnsafe(a)}toBytes(){let{x,y:E}=this.toAffine(),_=n.toBytes(E);return _[_.length-1]|=x&Te?128:0,_}toHex(){return(0,ce.bytesToHex)(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get ex(){return this.X}get ey(){return this.Y}get ez(){return this.Z}get et(){return this.T}static normalizeZ(x){return(0,ir.normalizeZ)(h,x)}static msm(x,E){return(0,ir.pippenger)(h,o,x,E)}_setWindowSize(x){this.precompute(x)}toRawBytes(){return this.toBytes()}}h.BASE=new h(i.Gx,i.Gy,Te,u(i.Gx*i.Gy)),h.ZERO=new h(Xt,Te,Te,Xt),h.Fp=n,h.Fn=o;let w=new ir.wNAF(h,o.BITS);return h.BASE.precompute(8),h}s(Zc,"edwards");var vs=class{static{s(this,"PrimeEdwardsPoint")}constructor(t){this.ep=t}static fromBytes(t){(0,ce.notImplemented)()}static fromHex(t){(0,ce.notImplemented)()}get x(){return this.toAffine().x}get y(){return this.toAffine().y}clearCofactor(){return this}assertValidity(){this.ep.assertValidity()}toAffine(t){return this.ep.toAffine(t)}toHex(){return(0,ce.bytesToHex)(this.toBytes())}toString(){return this.toHex()}isTorsionFree(){return!0}isSmallOrder(){return!1}add(t){return this.assertSame(t),this.init(this.ep.add(t.ep))}subtract(t){return this.assertSame(t),this.init(this.ep.subtract(t.ep))}multiply(t){return this.init(this.ep.multiply(t))}multiplyUnsafe(t){return this.init(this.ep.multiplyUnsafe(t))}double(){return this.init(this.ep.double())}negate(){return this.init(this.ep.negate())}precompute(t,r){return this.init(this.ep.precompute(t,r))}toRawBytes(){return this.toBytes()}};ar.PrimeEdwardsPoint=vs;function Yc(e,t,r={}){if(typeof t!="function")throw new Error('"hash" function param is required');(0,ce._validateObject)(r,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});let{prehash:n}=r,{BASE:o,Fp:i,Fn:a}=e,c=r.randomBytes||ce.randomBytes,u=r.adjustScalarBytes||(B=>B),l=r.domain||((B,O,R)=>{if((0,ce._abool2)(R,"phflag"),O.length||R)throw new Error("Contexts/pre-hash are not supported");return B});function f(B){return a.create((0,ce.bytesToNumberLE)(B))}s(f,"modN_LE");function p(B){let O=_.secretKey;B=(0,ce.ensureBytes)("private key",B,O);let R=(0,ce.ensureBytes)("hashed private key",t(B),2*O),D=u(R.slice(0,O)),v=R.slice(O,2*O),S=f(D);return{head:D,prefix:v,scalar:S}}s(p,"getPrivateScalar");function d(B){let{head:O,prefix:R,scalar:D}=p(B),v=o.multiply(D),S=v.toBytes();return{head:O,prefix:R,scalar:D,point:v,pointBytes:S}}s(d,"getExtendedPublicKey");function y(B){return d(B).pointBytes}s(y,"getPublicKey");function h(B=Uint8Array.of(),...O){let R=(0,ce.concatBytes)(...O);return f(t(l(R,(0,ce.ensureBytes)("context",B),!!n)))}s(h,"hashDomainToScalar");function w(B,O,R={}){B=(0,ce.ensureBytes)("message",B),n&&(B=n(B));let{prefix:D,scalar:v,pointBytes:S}=d(O),A=h(R.context,D,B),P=o.multiply(A).toBytes(),U=h(R.context,P,S,B),H=a.create(A+U*v);if(!a.isValid(H))throw new Error("sign failed: invalid s");let L=(0,ce.concatBytes)(P,a.toBytes(H));return(0,ce._abytes2)(L,_.signature,"result")}s(w,"sign");let m={zip215:!0};function x(B,O,R,D=m){let{context:v,zip215:S}=D,A=_.signature;B=(0,ce.ensureBytes)("signature",B,A),O=(0,ce.ensureBytes)("message",O),R=(0,ce.ensureBytes)("publicKey",R,_.publicKey),S!==void 0&&(0,ce._abool2)(S,"zip215"),n&&(O=n(O));let P=A/2,U=B.subarray(0,P),H=(0,ce.bytesToNumberLE)(B.subarray(P,A)),L,N,K;try{L=e.fromBytes(R,S),N=e.fromBytes(U,S),K=o.multiplyUnsafe(H)}catch{return!1}if(!S&&L.isSmallOrder())return!1;let z=h(v,N.toBytes(),L.toBytes(),O);return N.add(L.multiplyUnsafe(z)).subtract(K).clearCofactor().is0()}s(x,"verify");let E=i.BYTES,_={secretKey:E,publicKey:E,signature:2*E,seed:E};function C(B=c(_.seed)){return(0,ce._abytes2)(B,_.seed,"seed")}s(C,"randomSecretKey");function M(B){let O=k.randomSecretKey(B);return{secretKey:O,publicKey:y(O)}}s(M,"keygen");function q(B){return(0,ce.isBytes)(B)&&B.length===a.BYTES}s(q,"isValidSecretKey");function W(B,O){try{return!!e.fromBytes(B,O)}catch{return!1}}s(W,"isValidPublicKey");let k={getExtendedPublicKey:d,randomSecretKey:C,isValidSecretKey:q,isValidPublicKey:W,toMontgomery(B){let{y:O}=e.fromBytes(B),R=_.publicKey,D=R===32;if(!D&&R!==57)throw new Error("only defined for 25519 and 448");let v=D?i.div(Te+O,Te-O):i.div(O-Te,O+Te);return i.toBytes(v)},toMontgomerySecret(B){let O=_.secretKey;(0,ce._abytes2)(B,O);let R=t(B.subarray(0,O));return u(R).subarray(0,O)},randomPrivateKey:C,precompute(B=8,O=e.BASE){return O.precompute(B,!1)}};return Object.freeze({keygen:M,getPublicKey:y,sign:w,verify:x,utils:k,Point:e,lengths:_})}s(Yc,"eddsa");function ph(e){let t={a:e.a,d:e.d,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},r=e.Fp,n=(0,fh.Field)(t.n,e.nBitLength,!0),o={Fp:r,Fn:n,uvRatio:e.uvRatio},i={randomBytes:e.randomBytes,adjustScalarBytes:e.adjustScalarBytes,domain:e.domain,prehash:e.prehash,mapToCurve:e.mapToCurve};return{CURVE:t,curveOpts:o,hash:e.hash,eddsaOpts:i}}s(ph,"_eddsa_legacy_opts_to_new");function yh(e,t){let r=t.Point;return Object.assign({},t,{ExtendedPoint:r,CURVE:e,nBitLength:r.Fn.BITS,nByteLength:r.Fn.BYTES})}s(yh,"_eddsa_new_output_to_legacy");function mh(e){let{CURVE:t,curveOpts:r,hash:n,eddsaOpts:o}=ph(e),i=Zc(t,r),a=Yc(i,n,o);return yh(e,a)}s(mh,"twistedEdwards")});var Ss=ne(wt=>{"use strict";g();b();Object.defineProperty(wt,"__esModule",{value:!0});wt._DST_scalar=void 0;wt.expand_message_xmd=eu;wt.expand_message_xof=tu;wt.hash_to_field=$n;wt.isogenyMap=wh;wt.createHasher=xh;var Le=Nt(),Xc=Qt(),gh=Le.bytesToNumberBE;function Jt(e,t){if(sn(e),sn(t),e<0||e>=1<<8*t)throw new Error("invalid I2OSP input: "+e);let r=Array.from({length:t}).fill(0);for(let n=t-1;n>=0;n--)r[n]=e&255,e>>>=8;return new Uint8Array(r)}s(Jt,"i2osp");function bh(e,t){let r=new Uint8Array(e.length);for(let n=0;n<e.length;n++)r[n]=e[n]^t[n];return r}s(bh,"strxor");function sn(e){if(!Number.isSafeInteger(e))throw new Error("number expected")}s(sn,"anum");function Jc(e){if(!(0,Le.isBytes)(e)&&typeof e!="string")throw new Error("DST must be Uint8Array or string");return typeof e=="string"?(0,Le.utf8ToBytes)(e):e}s(Jc,"normDST");function eu(e,t,r,n){(0,Le.abytes)(e),sn(r),t=Jc(t),t.length>255&&(t=n((0,Le.concatBytes)((0,Le.utf8ToBytes)("H2C-OVERSIZE-DST-"),t)));let{outputLen:o,blockLen:i}=n,a=Math.ceil(r/o);if(r>65535||a>255)throw new Error("expand_message_xmd: invalid lenInBytes");let c=(0,Le.concatBytes)(t,Jt(t.length,1)),u=Jt(0,i),l=Jt(r,2),f=new Array(a),p=n((0,Le.concatBytes)(u,e,l,Jt(0,1),c));f[0]=n((0,Le.concatBytes)(p,Jt(1,1),c));for(let y=1;y<=a;y++){let h=[bh(p,f[y-1]),Jt(y+1,1),c];f[y]=n((0,Le.concatBytes)(...h))}return(0,Le.concatBytes)(...f).slice(0,r)}s(eu,"expand_message_xmd");function tu(e,t,r,n,o){if((0,Le.abytes)(e),sn(r),t=Jc(t),t.length>255){let i=Math.ceil(2*n/8);t=o.create({dkLen:i}).update((0,Le.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(t).digest()}if(r>65535||t.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return o.create({dkLen:r}).update(e).update(Jt(r,2)).update(t).update(Jt(t.length,1)).digest()}s(tu,"expand_message_xof");function $n(e,t,r){(0,Le._validateObject)(r,{p:"bigint",m:"number",k:"number",hash:"function"});let{p:n,k:o,m:i,hash:a,expand:c,DST:u}=r;if(!(0,Le.isHash)(r.hash))throw new Error("expected valid hash");(0,Le.abytes)(e),sn(t);let l=n.toString(2).length,f=Math.ceil((l+o)/8),p=t*i*f,d;if(c==="xmd")d=eu(e,u,p,a);else if(c==="xof")d=tu(e,u,p,o,a);else if(c==="_internal_pass")d=e;else throw new Error('expand must be "xmd" or "xof"');let y=new Array(t);for(let h=0;h<t;h++){let w=new Array(i);for(let m=0;m<i;m++){let x=f*(m+h*i),E=d.subarray(x,x+f);w[m]=(0,Xc.mod)(gh(E),n)}y[h]=w}return y}s($n,"hash_to_field");function wh(e,t){let r=t.map(n=>Array.from(n).reverse());return(n,o)=>{let[i,a,c,u]=r.map(p=>p.reduce((d,y)=>e.add(e.mul(d,n),y))),[l,f]=(0,Xc.FpInvertBatch)(e,[a,u],!0);return n=e.mul(i,l),o=e.mul(o,e.mul(c,f)),{x:n,y:o}}}s(wh,"isogenyMap");wt._DST_scalar=(0,Le.utf8ToBytes)("HashToScalar-");function xh(e,t,r){if(typeof t!="function")throw new Error("mapToCurve() must be defined");function n(i){return e.fromAffine(t(i))}s(n,"map");function o(i){let a=i.clearCofactor();return a.equals(e.ZERO)?e.ZERO:(a.assertValidity(),a)}return s(o,"clear"),{defaults:r,hashToCurve(i,a){let c=Object.assign({},r,a),u=$n(i,2,c),l=n(u[0]),f=n(u[1]);return o(l.add(f))},encodeToCurve(i,a){let c=r.encodeDST?{DST:r.encodeDST}:{},u=Object.assign({},r,c,a),l=$n(i,1,u),f=n(l[0]);return o(f)},mapToCurve(i){if(!Array.isArray(i))throw new Error("expected array of bigints");for(let a of i)if(typeof a!="bigint")throw new Error("expected array of bigints");return o(n(i))},hashToScalar(i,a){let c=e.Fn.ORDER,u=Object.assign({},r,{p:c,m:1,DST:wt._DST_scalar},a);return $n(i,1,u)[0][0]}}}s(xh,"createHasher")});var ru=ne(_s=>{"use strict";g();b();Object.defineProperty(_s,"__esModule",{value:!0});_s.montgomery=Sh;var xt=Nt(),Eh=Qt(),an=BigInt(0),Pr=BigInt(1),Zn=BigInt(2);function vh(e){return(0,xt._validateObject)(e,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...e})}s(vh,"validateOpts");function Sh(e){let t=vh(e),{P:r,type:n,adjustScalarBytes:o,powPminus2:i,randomBytes:a}=t,c=n==="x25519";if(!c&&n!=="x448")throw new Error("invalid type");let u=a||xt.randomBytes,l=c?255:448,f=c?32:56,p=BigInt(c?9:5),d=BigInt(c?121665:39081),y=c?Zn**BigInt(254):Zn**BigInt(447),h=c?BigInt(8)*Zn**BigInt(251)-Pr:BigInt(4)*Zn**BigInt(445)-Pr,w=y+h+Pr,m=s(v=>(0,Eh.mod)(v,r),"modP"),x=E(p);function E(v){return(0,xt.numberToBytesLE)(m(v),f)}s(E,"encodeU");function _(v){let S=(0,xt.ensureBytes)("u coordinate",v,f);return c&&(S[31]&=127),m((0,xt.bytesToNumberLE)(S))}s(_,"decodeU");function C(v){return(0,xt.bytesToNumberLE)(o((0,xt.ensureBytes)("scalar",v,f)))}s(C,"decodeScalar");function M(v,S){let A=k(_(S),C(v));if(A===an)throw new Error("invalid private or public key received");return E(A)}s(M,"scalarMult");function q(v){return M(v,x)}s(q,"scalarMultBase");function W(v,S,A){let P=m(v*(S-A));return S=m(S-P),A=m(A+P),{x_2:S,x_3:A}}s(W,"cswap");function k(v,S){(0,xt.aInRange)("u",v,an,r),(0,xt.aInRange)("scalar",S,y,w);let A=S,P=v,U=Pr,H=an,L=v,N=Pr,K=an;for(let se=BigInt(l-1);se>=an;se--){let ie=A>>se&Pr;K^=ie,{x_2:U,x_3:L}=W(K,U,L),{x_2:H,x_3:N}=W(K,H,N),K=ie;let J=U+H,ue=m(J*J),he=U-H,be=m(he*he),fe=ue-be,Ie=L+N,yr=L-N,$r=m(yr*J),Zr=m(Ie*he),ui=$r+Zr,li=$r-Zr;L=m(ui*ui),N=m(P*m(li*li)),U=m(ue*be),H=m(fe*(ue+m(d*fe)))}({x_2:U,x_3:L}=W(K,U,L)),{x_2:H,x_3:N}=W(K,H,N);let z=i(H);return m(U*z)}s(k,"montgomeryLadder");let B={secretKey:f,publicKey:f,seed:f},O=s((v=u(f))=>((0,xt.abytes)(v,B.seed),v),"randomSecretKey");function R(v){let S=O(v);return{secretKey:S,publicKey:q(S)}}return s(R,"keygen"),{keygen:R,getSharedSecret:s((v,S)=>M(v,S),"getSharedSecret"),getPublicKey:s(v=>q(v),"getPublicKey"),scalarMult:M,scalarMultBase:q,utils:{randomSecretKey:O,randomPrivateKey:O},GuBytes:x.slice(),lengths:B}}s(Sh,"montgomery")});var pu=ne(Q=>{"use strict";g();b();Object.defineProperty(Q,"__esModule",{value:!0});Q.hash_to_ristretto255=Q.hashToRistretto255=Q.encodeToCurve=Q.hashToCurve=Q.RistrettoPoint=Q.edwardsToMontgomery=Q.ED25519_TORSION_SUBGROUP=Q.ristretto255_hasher=Q.ristretto255=Q.ed25519_hasher=Q.x25519=Q.ed25519ph=Q.ed25519ctx=Q.ed25519=void 0;Q.edwardsToMontgomeryPub=hu;Q.edwardsToMontgomeryPriv=Hh;var cn=Vn(),Qn=mt(),_h=Gn(),Jn=Qc(),Yn=Ss(),de=Qt(),Ah=ru(),cr=Nt(),Bh=BigInt(0),Et=BigInt(1),Xn=BigInt(2),iu=BigInt(3),au=BigInt(5),Is=BigInt(8),Ht=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),un={p:Ht,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:Is,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function cu(e){let t=BigInt(10),r=BigInt(20),n=BigInt(40),o=BigInt(80),i=Ht,c=e*e%i*e%i,u=(0,de.pow2)(c,Xn,i)*c%i,l=(0,de.pow2)(u,Et,i)*e%i,f=(0,de.pow2)(l,au,i)*l%i,p=(0,de.pow2)(f,t,i)*f%i,d=(0,de.pow2)(p,r,i)*p%i,y=(0,de.pow2)(d,n,i)*d%i,h=(0,de.pow2)(y,o,i)*y%i,w=(0,de.pow2)(h,o,i)*y%i,m=(0,de.pow2)(w,t,i)*f%i;return{pow_p_5_8:(0,de.pow2)(m,Xn,i)*e%i,b2:c}}s(cu,"ed25519_pow_2_252_3");function uu(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}s(uu,"adjustScalarBytes");var As=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function Ts(e,t){let r=Ht,n=(0,de.mod)(t*t*t,r),o=(0,de.mod)(n*n*t,r),i=cu(e*o).pow_p_5_8,a=(0,de.mod)(e*n*i,r),c=(0,de.mod)(t*a*a,r),u=a,l=(0,de.mod)(a*As,r),f=c===e,p=c===(0,de.mod)(-e,r),d=c===(0,de.mod)(-e*As,r);return f&&(a=u),(p||d)&&(a=l),(0,de.isNegativeLE)(a,r)&&(a=(0,de.mod)(-a,r)),{isValid:f||p,value:a}}s(Ts,"uvRatio");var F=(0,de.Field)(un.p,{isLE:!0}),lu=(0,de.Field)(un.n,{isLE:!0}),Ls={...un,Fp:F,hash:cn.sha512,adjustScalarBytes:uu,uvRatio:Ts};Q.ed25519=(0,Jn.twistedEdwards)(Ls);function fu(e,t,r){if(t.length>255)throw new Error("Context is too big");return(0,Qn.concatBytes)((0,Qn.utf8ToBytes)("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,t.length]),t,e)}s(fu,"ed25519_domain");Q.ed25519ctx=(0,Jn.twistedEdwards)({...Ls,domain:fu});Q.ed25519ph=(0,Jn.twistedEdwards)(Object.assign({},Ls,{domain:fu,prehash:cn.sha512}));Q.x25519=(()=>{let e=F.ORDER;return(0,Ah.montgomery)({P:e,type:"x25519",powPminus2:s(t=>{let{pow_p_5_8:r,b2:n}=cu(t);return(0,de.mod)((0,de.pow2)(r,iu,e)*n,e)},"powPminus2"),adjustScalarBytes:uu})})();var Ch=(Ht+iu)/Is,Ih=F.pow(Xn,Ch),nu=F.sqrt(F.neg(F.ONE));function Th(e){let t=(Ht-au)/Is,r=BigInt(486662),n=F.sqr(e);n=F.mul(n,Xn);let o=F.add(n,F.ONE),i=F.neg(r),a=F.sqr(o),c=F.mul(a,o),u=F.mul(n,r);u=F.mul(u,i),u=F.add(u,a),u=F.mul(u,i);let l=F.sqr(c);a=F.sqr(l),l=F.mul(l,c),l=F.mul(l,u),a=F.mul(a,l);let f=F.pow(a,t);f=F.mul(f,l);let p=F.mul(f,nu);a=F.sqr(f),a=F.mul(a,c);let d=F.eql(a,u),y=F.cmov(p,f,d),h=F.mul(i,n),w=F.mul(f,e);w=F.mul(w,Ih);let m=F.mul(w,nu),x=F.mul(u,n);a=F.sqr(w),a=F.mul(a,c);let E=F.eql(a,x),_=F.cmov(m,w,E);a=F.sqr(y),a=F.mul(a,c);let C=F.eql(a,u),M=F.cmov(h,i,C),q=F.cmov(_,y,C),W=F.isOdd(q);return q=F.cmov(q,F.neg(q),C!==W),{xMn:M,xMd:o,yMn:q,yMd:Et}}s(Th,"map_to_curve_elligator2_curve25519");var Lh=(0,de.FpSqrtEven)(F,F.neg(BigInt(486664)));function Oh(e){let{xMn:t,xMd:r,yMn:n,yMd:o}=Th(e),i=F.mul(t,o);i=F.mul(i,Lh);let a=F.mul(r,n),c=F.sub(t,r),u=F.add(t,r),l=F.mul(a,u),f=F.eql(l,F.ZERO);i=F.cmov(i,F.ZERO,f),a=F.cmov(a,F.ONE,f),c=F.cmov(c,F.ONE,f),u=F.cmov(u,F.ONE,f);let[p,d]=(0,de.FpInvertBatch)(F,[a,u],!0);return{x:F.mul(i,p),y:F.mul(c,d)}}s(Oh,"map_to_curve_elligator2_edwards25519");Q.ed25519_hasher=(0,Yn.createHasher)(Q.ed25519.Point,e=>Oh(e[0]),{DST:"edwards25519_XMD:SHA-512_ELL2_RO_",encodeDST:"edwards25519_XMD:SHA-512_ELL2_NU_",p:Ht,m:1,k:128,expand:"xmd",hash:cn.sha512});var Bs=As,Ph=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Uh=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Rh=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Dh=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),ou=s(e=>Ts(Et,e),"invertSqrt"),Nh=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),Cs=s(e=>Q.ed25519.Point.Fp.create((0,cr.bytesToNumberLE)(e)&Nh),"bytes255ToNumberLE");function su(e){let{d:t}=un,r=Ht,n=s(x=>F.create(x),"mod"),o=n(Bs*e*e),i=n((o+Et)*Rh),a=BigInt(-1),c=n((a-t*o)*n(o+t)),{isValid:u,value:l}=Ts(i,c),f=n(l*e);(0,de.isNegativeLE)(f,r)||(f=n(-f)),u||(l=f),u||(a=o);let p=n(a*(o-Et)*Dh-c),d=l*l,y=n((l+l)*c),h=n(p*Ph),w=n(Et-d),m=n(Et+d);return new Q.ed25519.Point(n(y*m),n(w*h),n(h*m),n(y*w))}s(su,"calcElligatorRistrettoMap");function du(e){(0,Qn.abytes)(e,64);let t=Cs(e.subarray(0,32)),r=su(t),n=Cs(e.subarray(32,64)),o=su(n);return new lt(r.add(o))}s(du,"ristretto255_map");var lt=class e extends Jn.PrimeEdwardsPoint{static{s(this,"_RistrettoPoint")}constructor(t){super(t)}static fromAffine(t){return new e(Q.ed25519.Point.fromAffine(t))}assertSame(t){if(!(t instanceof e))throw new Error("RistrettoPoint expected")}init(t){return new e(t)}static hashToCurve(t){return du((0,cr.ensureBytes)("ristrettoHash",t,64))}static fromBytes(t){(0,Qn.abytes)(t,32);let{a:r,d:n}=un,o=Ht,i=s(C=>F.create(C),"mod"),a=Cs(t);if(!(0,cr.equalBytes)(F.toBytes(a),t)||(0,de.isNegativeLE)(a,o))throw new Error("invalid ristretto255 encoding 1");let c=i(a*a),u=i(Et+r*c),l=i(Et-r*c),f=i(u*u),p=i(l*l),d=i(r*n*f-p),{isValid:y,value:h}=ou(i(d*p)),w=i(h*l),m=i(h*w*d),x=i((a+a)*w);(0,de.isNegativeLE)(x,o)&&(x=i(-x));let E=i(u*m),_=i(x*E);if(!y||(0,de.isNegativeLE)(_,o)||E===Bh)throw new Error("invalid ristretto255 encoding 2");return new e(new Q.ed25519.Point(x,E,Et,_))}static fromHex(t){return e.fromBytes((0,cr.ensureBytes)("ristrettoHex",t,32))}static msm(t,r){return(0,_h.pippenger)(e,Q.ed25519.Point.Fn,t,r)}toBytes(){let{X:t,Y:r,Z:n,T:o}=this.ep,i=Ht,a=s(m=>F.create(m),"mod"),c=a(a(n+r)*a(n-r)),u=a(t*r),l=a(u*u),{value:f}=ou(a(c*l)),p=a(f*c),d=a(f*u),y=a(p*d*o),h;if((0,de.isNegativeLE)(o*y,i)){let m=a(r*Bs),x=a(t*Bs);t=m,r=x,h=a(p*Uh)}else h=d;(0,de.isNegativeLE)(t*y,i)&&(r=a(-r));let w=a((n-r)*h);return(0,de.isNegativeLE)(w,i)&&(w=a(-w)),F.toBytes(w)}equals(t){this.assertSame(t);let{X:r,Y:n}=this.ep,{X:o,Y:i}=t.ep,a=s(l=>F.create(l),"mod"),c=a(r*i)===a(n*o),u=a(n*i)===a(r*o);return c||u}is0(){return this.equals(e.ZERO)}};lt.BASE=new lt(Q.ed25519.Point.BASE);lt.ZERO=new lt(Q.ed25519.Point.ZERO);lt.Fp=F;lt.Fn=lu;Q.ristretto255={Point:lt};Q.ristretto255_hasher={hashToCurve(e,t){let r=t?.DST||"ristretto255_XMD:SHA-512_R255MAP_RO_",n=(0,Yn.expand_message_xmd)(e,r,64,cn.sha512);return du(n)},hashToScalar(e,t={DST:Yn._DST_scalar}){let r=(0,Yn.expand_message_xmd)(e,t.DST,64,cn.sha512);return lu.create((0,cr.bytesToNumberLE)(r))}};Q.ED25519_TORSION_SUBGROUP=["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"];function hu(e){return Q.ed25519.utils.toMontgomery((0,cr.ensureBytes)("pub",e))}s(hu,"edwardsToMontgomeryPub");Q.edwardsToMontgomery=hu;function Hh(e){return Q.ed25519.utils.toMontgomerySecret((0,cr.ensureBytes)("pub",e))}s(Hh,"edwardsToMontgomeryPriv");Q.RistrettoPoint=lt;Q.hashToCurve=Q.ed25519_hasher.hashToCurve;Q.encodeToCurve=Q.ed25519_hasher.encodeToCurve;Q.hashToRistretto255=Q.ristretto255_hasher.hashToCurve;Q.hash_to_ristretto255=Q.ristretto255_hasher.hashToCurve});var Os=ne(lr=>{"use strict";g();b();Object.defineProperty(lr,"__esModule",{value:!0});lr.hmac=lr.HMAC=void 0;var ur=mt(),ln=class extends ur.Hash{static{s(this,"HMAC")}constructor(t,r){super(),this.finished=!1,this.destroyed=!1,(0,ur.ahash)(t);let n=(0,ur.toBytes)(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,i=new Uint8Array(o);i.set(n.length>o?t.create().update(n).digest():n);for(let a=0;a<i.length;a++)i[a]^=54;this.iHash.update(i),this.oHash=t.create();for(let a=0;a<i.length;a++)i[a]^=106;this.oHash.update(i),(0,ur.clean)(i)}update(t){return(0,ur.aexists)(this),this.iHash.update(t),this}digestInto(t){(0,ur.aexists)(this),(0,ur.abytes)(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:o,destroyed:i,blockLen:a,outputLen:c}=this;return t=t,t.finished=o,t.destroyed=i,t.blockLen=a,t.outputLen=c,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};lr.HMAC=ln;var Mh=s((e,t,r)=>new ln(e,t).update(r).digest(),"hmac");lr.hmac=Mh;lr.hmac.create=(e,t)=>new ln(e,t)});var Ns=ne(ge=>{"use strict";g();b();Object.defineProperty(ge,"__esModule",{value:!0});ge.DER=ge.DERErr=void 0;ge._splitEndoScalar=mu;ge._normFnElement=er;ge.weierstrassN=Ds;ge.SWUFpSqrtRatio=bu;ge.mapToCurveSimpleSWU=kh;ge.ecdh=xu;ge.ecdsa=Eu;ge.weierstrassPoints=Vh;ge._legacyHelperEquat=Su;ge.weierstrass=Wh;var Kh=Os(),qh=mt(),G=Nt(),Mt=Gn(),Rr=Qt(),yu=s((e,t)=>(e+(e>=0?t:-t)/vt)/t,"divNearest");function mu(e,t,r){let[[n,o],[i,a]]=t,c=yu(a*e,r),u=yu(-o*e,r),l=e-c*n-u*i,f=-c*o-u*a,p=l<ft,d=f<ft;p&&(l=-l),d&&(f=-f);let y=(0,G.bitMask)(Math.ceil((0,G.bitLen)(r)/2))+Oe;if(l<ft||l>=y||f<ft||f>=y)throw new Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:p,k1:l,k2neg:d,k2:f}}s(mu,"_splitEndoScalar");function Us(e){if(!["compact","recovered","der"].includes(e))throw new Error('Signature format must be "compact", "recovered", or "der"');return e}s(Us,"validateSigFormat");function Ps(e,t){let r={};for(let n of Object.keys(t))r[n]=e[n]===void 0?t[n]:e[n];return(0,G._abool2)(r.lowS,"lowS"),(0,G._abool2)(r.prehash,"prehash"),r.format!==void 0&&Us(r.format),r}s(Ps,"validateSigOpts");var eo=class extends Error{static{s(this,"DERErr")}constructor(t=""){super(t)}};ge.DERErr=eo;ge.DER={Err:eo,_tlv:{encode:s((e,t)=>{let{Err:r}=ge.DER;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length&1)throw new r("tlv.encode: unpadded data");let n=t.length/2,o=(0,G.numberToHexUnpadded)(n);if(o.length/2&128)throw new r("tlv.encode: long form length too big");let i=n>127?(0,G.numberToHexUnpadded)(o.length/2|128):"";return(0,G.numberToHexUnpadded)(e)+i+o+t},"encode"),decode(e,t){let{Err:r}=ge.DER,n=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[n++]!==e)throw new r("tlv.decode: wrong tlv");let o=t[n++],i=!!(o&128),a=0;if(!i)a=o;else{let u=o&127;if(!u)throw new r("tlv.decode(long): indefinite length not supported");if(u>4)throw new r("tlv.decode(long): byte length is too big");let l=t.subarray(n,n+u);if(l.length!==u)throw new r("tlv.decode: length bytes not complete");if(l[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(let f of l)a=a<<8|f;if(n+=u,a<128)throw new r("tlv.decode(long): not minimal encoding")}let c=t.subarray(n,n+a);if(c.length!==a)throw new r("tlv.decode: wrong value length");return{v:c,l:t.subarray(n+a)}}},_int:{encode(e){let{Err:t}=ge.DER;if(e<ft)throw new t("integer: negative integers are not allowed");let r=(0,G.numberToHexUnpadded)(e);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){let{Err:t}=ge.DER;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return(0,G.bytesToNumberBE)(e)}},toSig(e){let{Err:t,_int:r,_tlv:n}=ge.DER,o=(0,G.ensureBytes)("signature",e),{v:i,l:a}=n.decode(48,o);if(a.length)throw new t("invalid signature: left bytes after parsing");let{v:c,l:u}=n.decode(2,i),{v:l,l:f}=n.decode(2,u);if(f.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(c),s:r.decode(l)}},hexFromSig(e){let{_tlv:t,_int:r}=ge.DER,n=t.encode(2,r.encode(e.r)),o=t.encode(2,r.encode(e.s)),i=n+o;return t.encode(48,i)}};var ft=BigInt(0),Oe=BigInt(1),vt=BigInt(2),Ur=BigInt(3),Rs=BigInt(4);function er(e,t){let{BYTES:r}=e,n;if(typeof t=="bigint")n=t;else{let o=(0,G.ensureBytes)("private key",t);try{n=e.fromBytes(o)}catch{throw new Error(`invalid private key: expected ui8a of size ${r}, got ${typeof t}`)}}if(!e.isValidNot0(n))throw new Error("invalid private key: out of range [1..N-1]");return n}s(er,"_normFnElement");function Ds(e,t={}){let r=(0,Mt._createCurveFields)("weierstrass",e,t),{Fp:n,Fn:o}=r,i=r.CURVE,{h:a,n:c}=i;(0,G._validateObject)(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});let{endo:u}=t;if(u&&(!n.is0(i.a)||typeof u.beta!="bigint"||!Array.isArray(u.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');let l=wu(n,o);function f(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}s(f,"assertCompressionIsSupported");function p(D,v,S){let{x:A,y:P}=v.toAffine(),U=n.toBytes(A);if((0,G._abool2)(S,"isCompressed"),S){f();let H=!n.isOdd(P);return(0,G.concatBytes)(gu(H),U)}else return(0,G.concatBytes)(Uint8Array.of(4),U,n.toBytes(P))}s(p,"pointToBytes");function d(D){(0,G._abytes2)(D,void 0,"Point");let{publicKey:v,publicKeyUncompressed:S}=l,A=D.length,P=D[0],U=D.subarray(1);if(A===v&&(P===2||P===3)){let H=n.fromBytes(U);if(!n.isValid(H))throw new Error("bad point: is not on curve, wrong x");let L=w(H),N;try{N=n.sqrt(L)}catch(se){let ie=se instanceof Error?": "+se.message:"";throw new Error("bad point: is not on curve, sqrt error"+ie)}f();let K=n.isOdd(N);return(P&1)===1!==K&&(N=n.neg(N)),{x:H,y:N}}else if(A===S&&P===4){let H=n.BYTES,L=n.fromBytes(U.subarray(0,H)),N=n.fromBytes(U.subarray(H,H*2));if(!m(L,N))throw new Error("bad point: is not on curve");return{x:L,y:N}}else throw new Error(`bad point: got length ${A}, expected compressed=${v} or uncompressed=${S}`)}s(d,"pointFromBytes");let y=t.toBytes||p,h=t.fromBytes||d;function w(D){let v=n.sqr(D),S=n.mul(v,D);return n.add(n.add(S,n.mul(D,i.a)),i.b)}s(w,"weierstrassEquation");function m(D,v){let S=n.sqr(v),A=w(D);return n.eql(S,A)}if(s(m,"isValidXY"),!m(i.Gx,i.Gy))throw new Error("bad curve params: generator point");let x=n.mul(n.pow(i.a,Ur),Rs),E=n.mul(n.sqr(i.b),BigInt(27));if(n.is0(n.add(x,E)))throw new Error("bad curve params: a or b");function _(D,v,S=!1){if(!n.isValid(v)||S&&n.is0(v))throw new Error(`bad point coordinate ${D}`);return v}s(_,"acoord");function C(D){if(!(D instanceof B))throw new Error("ProjectivePoint expected")}s(C,"aprjpoint");function M(D){if(!u||!u.basises)throw new Error("no endo");return mu(D,u.basises,o.ORDER)}s(M,"splitEndoScalarN");let q=(0,G.memoized)((D,v)=>{let{X:S,Y:A,Z:P}=D;if(n.eql(P,n.ONE))return{x:S,y:A};let U=D.is0();v==null&&(v=U?n.ONE:n.inv(P));let H=n.mul(S,v),L=n.mul(A,v),N=n.mul(P,v);if(U)return{x:n.ZERO,y:n.ZERO};if(!n.eql(N,n.ONE))throw new Error("invZ was invalid");return{x:H,y:L}}),W=(0,G.memoized)(D=>{if(D.is0()){if(t.allowInfinityPoint&&!n.is0(D.Y))return;throw new Error("bad point: ZERO")}let{x:v,y:S}=D.toAffine();if(!n.isValid(v)||!n.isValid(S))throw new Error("bad point: x or y not field elements");if(!m(v,S))throw new Error("bad point: equation left != right");if(!D.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function k(D,v,S,A,P){return S=new B(n.mul(S.X,D),S.Y,S.Z),v=(0,Mt.negateCt)(A,v),S=(0,Mt.negateCt)(P,S),v.add(S)}s(k,"finishEndo");class B{static{s(this,"Point")}constructor(v,S,A){this.X=_("x",v),this.Y=_("y",S,!0),this.Z=_("z",A),Object.freeze(this)}static CURVE(){return i}static fromAffine(v){let{x:S,y:A}=v||{};if(!v||!n.isValid(S)||!n.isValid(A))throw new Error("invalid affine point");if(v instanceof B)throw new Error("projective point not allowed");return n.is0(S)&&n.is0(A)?B.ZERO:new B(S,A,n.ONE)}static fromBytes(v){let S=B.fromAffine(h((0,G._abytes2)(v,void 0,"point")));return S.assertValidity(),S}static fromHex(v){return B.fromBytes((0,G.ensureBytes)("pointHex",v))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(v=8,S=!0){return R.createCache(this,v),S||this.multiply(Ur),this}assertValidity(){W(this)}hasEvenY(){let{y:v}=this.toAffine();if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(v)}equals(v){C(v);let{X:S,Y:A,Z:P}=this,{X:U,Y:H,Z:L}=v,N=n.eql(n.mul(S,L),n.mul(U,P)),K=n.eql(n.mul(A,L),n.mul(H,P));return N&&K}negate(){return new B(this.X,n.neg(this.Y),this.Z)}double(){let{a:v,b:S}=i,A=n.mul(S,Ur),{X:P,Y:U,Z:H}=this,L=n.ZERO,N=n.ZERO,K=n.ZERO,z=n.mul(P,P),se=n.mul(U,U),ie=n.mul(H,H),J=n.mul(P,U);return J=n.add(J,J),K=n.mul(P,H),K=n.add(K,K),L=n.mul(v,K),N=n.mul(A,ie),N=n.add(L,N),L=n.sub(se,N),N=n.add(se,N),N=n.mul(L,N),L=n.mul(J,L),K=n.mul(A,K),ie=n.mul(v,ie),J=n.sub(z,ie),J=n.mul(v,J),J=n.add(J,K),K=n.add(z,z),z=n.add(K,z),z=n.add(z,ie),z=n.mul(z,J),N=n.add(N,z),ie=n.mul(U,H),ie=n.add(ie,ie),z=n.mul(ie,J),L=n.sub(L,z),K=n.mul(ie,se),K=n.add(K,K),K=n.add(K,K),new B(L,N,K)}add(v){C(v);let{X:S,Y:A,Z:P}=this,{X:U,Y:H,Z:L}=v,N=n.ZERO,K=n.ZERO,z=n.ZERO,se=i.a,ie=n.mul(i.b,Ur),J=n.mul(S,U),ue=n.mul(A,H),he=n.mul(P,L),be=n.add(S,A),fe=n.add(U,H);be=n.mul(be,fe),fe=n.add(J,ue),be=n.sub(be,fe),fe=n.add(S,P);let Ie=n.add(U,L);return fe=n.mul(fe,Ie),Ie=n.add(J,he),fe=n.sub(fe,Ie),Ie=n.add(A,P),N=n.add(H,L),Ie=n.mul(Ie,N),N=n.add(ue,he),Ie=n.sub(Ie,N),z=n.mul(se,fe),N=n.mul(ie,he),z=n.add(N,z),N=n.sub(ue,z),z=n.add(ue,z),K=n.mul(N,z),ue=n.add(J,J),ue=n.add(ue,J),he=n.mul(se,he),fe=n.mul(ie,fe),ue=n.add(ue,he),he=n.sub(J,he),he=n.mul(se,he),fe=n.add(fe,he),J=n.mul(ue,fe),K=n.add(K,J),J=n.mul(Ie,fe),N=n.mul(be,N),N=n.sub(N,J),J=n.mul(be,ue),z=n.mul(Ie,z),z=n.add(z,J),new B(N,K,z)}subtract(v){return this.add(v.negate())}is0(){return this.equals(B.ZERO)}multiply(v){let{endo:S}=t;if(!o.isValidNot0(v))throw new Error("invalid scalar: out of range");let A,P,U=s(H=>R.cached(this,H,L=>(0,Mt.normalizeZ)(B,L)),"mul");if(S){let{k1neg:H,k1:L,k2neg:N,k2:K}=M(v),{p:z,f:se}=U(L),{p:ie,f:J}=U(K);P=se.add(J),A=k(S.beta,z,ie,H,N)}else{let{p:H,f:L}=U(v);A=H,P=L}return(0,Mt.normalizeZ)(B,[A,P])[0]}multiplyUnsafe(v){let{endo:S}=t,A=this;if(!o.isValid(v))throw new Error("invalid scalar: out of range");if(v===ft||A.is0())return B.ZERO;if(v===Oe)return A;if(R.hasCache(this))return this.multiply(v);if(S){let{k1neg:P,k1:U,k2neg:H,k2:L}=M(v),{p1:N,p2:K}=(0,Mt.mulEndoUnsafe)(B,A,U,L);return k(S.beta,N,K,P,H)}else return R.unsafe(A,v)}multiplyAndAddUnsafe(v,S,A){let P=this.multiplyUnsafe(S).add(v.multiplyUnsafe(A));return P.is0()?void 0:P}toAffine(v){return q(this,v)}isTorsionFree(){let{isTorsionFree:v}=t;return a===Oe?!0:v?v(B,this):R.unsafe(this,c).is0()}clearCofactor(){let{clearCofactor:v}=t;return a===Oe?this:v?v(B,this):this.multiplyUnsafe(a)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}toBytes(v=!0){return(0,G._abool2)(v,"isCompressed"),this.assertValidity(),y(B,this,v)}toHex(v=!0){return(0,G.bytesToHex)(this.toBytes(v))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(v=!0){return this.toBytes(v)}_setWindowSize(v){this.precompute(v)}static normalizeZ(v){return(0,Mt.normalizeZ)(B,v)}static msm(v,S){return(0,Mt.pippenger)(B,o,v,S)}static fromPrivateKey(v){return B.BASE.multiply(er(o,v))}}B.BASE=new B(i.Gx,i.Gy,n.ONE),B.ZERO=new B(n.ZERO,n.ONE,n.ZERO),B.Fp=n,B.Fn=o;let O=o.BITS,R=new Mt.wNAF(B,t.endo?Math.ceil(O/2):O);return B.BASE.precompute(8),B}s(Ds,"weierstrassN");function gu(e){return Uint8Array.of(e?2:3)}s(gu,"pprefix");function bu(e,t){let r=e.ORDER,n=ft;for(let h=r-Oe;h%vt===ft;h/=vt)n+=Oe;let o=n,i=vt<<o-Oe-Oe,a=i*vt,c=(r-Oe)/a,u=(c-Oe)/vt,l=a-Oe,f=i,p=e.pow(t,c),d=e.pow(t,(c+Oe)/vt),y=s((h,w)=>{let m=p,x=e.pow(w,l),E=e.sqr(x);E=e.mul(E,w);let _=e.mul(h,E);_=e.pow(_,u),_=e.mul(_,x),x=e.mul(_,w),E=e.mul(_,h);let C=e.mul(E,x);_=e.pow(C,f);let M=e.eql(_,e.ONE);x=e.mul(E,d),_=e.mul(C,m),E=e.cmov(x,E,M),C=e.cmov(_,C,M);for(let q=o;q>Oe;q--){let W=q-vt;W=vt<<W-Oe;let k=e.pow(C,W),B=e.eql(k,e.ONE);x=e.mul(E,m),m=e.mul(m,m),k=e.mul(C,m),E=e.cmov(x,E,B),C=e.cmov(k,C,B)}return{isValid:M,value:E}},"sqrtRatio");if(e.ORDER%Rs===Ur){let h=(e.ORDER-Ur)/Rs,w=e.sqrt(e.neg(t));y=s((m,x)=>{let E=e.sqr(x),_=e.mul(m,x);E=e.mul(E,_);let C=e.pow(E,h);C=e.mul(C,_);let M=e.mul(C,w),q=e.mul(e.sqr(C),x),W=e.eql(q,m),k=e.cmov(M,C,W);return{isValid:W,value:k}},"sqrtRatio")}return y}s(bu,"SWUFpSqrtRatio");function kh(e,t){(0,Rr.validateField)(e);let{A:r,B:n,Z:o}=t;if(!e.isValid(r)||!e.isValid(n)||!e.isValid(o))throw new Error("mapToCurveSimpleSWU: invalid opts");let i=bu(e,o);if(!e.isOdd)throw new Error("Field does not have .isOdd()");return a=>{let c,u,l,f,p,d,y,h;c=e.sqr(a),c=e.mul(c,o),u=e.sqr(c),u=e.add(u,c),l=e.add(u,e.ONE),l=e.mul(l,n),f=e.cmov(o,e.neg(u),!e.eql(u,e.ZERO)),f=e.mul(f,r),u=e.sqr(l),d=e.sqr(f),p=e.mul(d,r),u=e.add(u,p),u=e.mul(u,l),d=e.mul(d,f),p=e.mul(d,n),u=e.add(u,p),y=e.mul(c,l);let{isValid:w,value:m}=i(u,d);h=e.mul(c,a),h=e.mul(h,m),y=e.cmov(y,l,w),h=e.cmov(h,m,w);let x=e.isOdd(a)===e.isOdd(h);h=e.cmov(e.neg(h),h,x);let E=(0,Rr.FpInvertBatch)(e,[f],!0)[0];return y=e.mul(y,E),{x:y,y:h}}}s(kh,"mapToCurveSimpleSWU");function wu(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}s(wu,"getWLengths");function xu(e,t={}){let{Fn:r}=e,n=t.randomBytes||G.randomBytes,o=Object.assign(wu(e.Fp,r),{seed:(0,Rr.getMinHashLength)(r.ORDER)});function i(y){try{return!!er(r,y)}catch{return!1}}s(i,"isValidSecretKey");function a(y,h){let{publicKey:w,publicKeyUncompressed:m}=o;try{let x=y.length;return h===!0&&x!==w||h===!1&&x!==m?!1:!!e.fromBytes(y)}catch{return!1}}s(a,"isValidPublicKey");function c(y=n(o.seed)){return(0,Rr.mapHashToField)((0,G._abytes2)(y,o.seed,"seed"),r.ORDER)}s(c,"randomSecretKey");function u(y,h=!0){return e.BASE.multiply(er(r,y)).toBytes(h)}s(u,"getPublicKey");function l(y){let h=c(y);return{secretKey:h,publicKey:u(h)}}s(l,"keygen");function f(y){if(typeof y=="bigint")return!1;if(y instanceof e)return!0;let{secretKey:h,publicKey:w,publicKeyUncompressed:m}=o;if(r.allowedLengths||h===w)return;let x=(0,G.ensureBytes)("key",y).length;return x===w||x===m}s(f,"isProbPub");function p(y,h,w=!0){if(f(y)===!0)throw new Error("first arg must be private key");if(f(h)===!1)throw new Error("second arg must be public key");let m=er(r,y);return e.fromHex(h).multiply(m).toBytes(w)}return s(p,"getSharedSecret"),Object.freeze({getPublicKey:u,getSharedSecret:p,keygen:l,Point:e,utils:{isValidSecretKey:i,isValidPublicKey:a,randomSecretKey:c,isValidPrivateKey:i,randomPrivateKey:c,normPrivateKeyToScalar:s(y=>er(r,y),"normPrivateKeyToScalar"),precompute(y=8,h=e.BASE){return h.precompute(y,!1)}},lengths:o})}s(xu,"ecdh");function Eu(e,t,r={}){(0,qh.ahash)(t),(0,G._validateObject)(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});let n=r.randomBytes||G.randomBytes,o=r.hmac||((S,...A)=>(0,Kh.hmac)(t,S,(0,G.concatBytes)(...A))),{Fp:i,Fn:a}=e,{ORDER:c,BITS:u}=a,{keygen:l,getPublicKey:f,getSharedSecret:p,utils:d,lengths:y}=xu(e,r),h={prehash:!1,lowS:typeof r.lowS=="boolean"?r.lowS:!1,format:void 0,extraEntropy:!1},w="compact";function m(S){let A=c>>Oe;return S>A}s(m,"isBiggerThanHalfOrder");function x(S,A){if(!a.isValidNot0(A))throw new Error(`invalid signature ${S}: out of range 1..Point.Fn.ORDER`);return A}s(x,"validateRS");function E(S,A){Us(A);let P=y.signature,U=A==="compact"?P:A==="recovered"?P+1:void 0;return(0,G._abytes2)(S,U,`${A} signature`)}s(E,"validateSigLength");class _{static{s(this,"Signature")}constructor(A,P,U){this.r=x("r",A),this.s=x("s",P),U!=null&&(this.recovery=U),Object.freeze(this)}static fromBytes(A,P=w){E(A,P);let U;if(P==="der"){let{r:K,s:z}=ge.DER.toSig((0,G._abytes2)(A));return new _(K,z)}P==="recovered"&&(U=A[0],P="compact",A=A.subarray(1));let H=a.BYTES,L=A.subarray(0,H),N=A.subarray(H,H*2);return new _(a.fromBytes(L),a.fromBytes(N),U)}static fromHex(A,P){return this.fromBytes((0,G.hexToBytes)(A),P)}addRecoveryBit(A){return new _(this.r,this.s,A)}recoverPublicKey(A){let P=i.ORDER,{r:U,s:H,recovery:L}=this;if(L==null||![0,1,2,3].includes(L))throw new Error("recovery id invalid");if(c*vt<P&&L>1)throw new Error("recovery id is ambiguous for h>1 curve");let K=L===2||L===3?U+c:U;if(!i.isValid(K))throw new Error("recovery id 2 or 3 invalid");let z=i.toBytes(K),se=e.fromBytes((0,G.concatBytes)(gu((L&1)===0),z)),ie=a.inv(K),J=M((0,G.ensureBytes)("msgHash",A)),ue=a.create(-J*ie),he=a.create(H*ie),be=e.BASE.multiplyUnsafe(ue).add(se.multiplyUnsafe(he));if(be.is0())throw new Error("point at infinify");return be.assertValidity(),be}hasHighS(){return m(this.s)}toBytes(A=w){if(Us(A),A==="der")return(0,G.hexToBytes)(ge.DER.hexFromSig(this));let P=a.toBytes(this.r),U=a.toBytes(this.s);if(A==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return(0,G.concatBytes)(Uint8Array.of(this.recovery),P,U)}return(0,G.concatBytes)(P,U)}toHex(A){return(0,G.bytesToHex)(this.toBytes(A))}assertValidity(){}static fromCompact(A){return _.fromBytes((0,G.ensureBytes)("sig",A),"compact")}static fromDER(A){return _.fromBytes((0,G.ensureBytes)("sig",A),"der")}normalizeS(){return this.hasHighS()?new _(this.r,a.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return(0,G.bytesToHex)(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return(0,G.bytesToHex)(this.toBytes("compact"))}}let C=r.bits2int||s(function(A){if(A.length>8192)throw new Error("input is too large");let P=(0,G.bytesToNumberBE)(A),U=A.length*8-u;return U>0?P>>BigInt(U):P},"bits2int_def"),M=r.bits2int_modN||s(function(A){return a.create(C(A))},"bits2int_modN_def"),q=(0,G.bitMask)(u);function W(S){return(0,G.aInRange)("num < 2^"+u,S,ft,q),a.toBytes(S)}s(W,"int2octets");function k(S,A){return(0,G._abytes2)(S,void 0,"message"),A?(0,G._abytes2)(t(S),void 0,"prehashed message"):S}s(k,"validateMsgAndHash");function B(S,A,P){if(["recovered","canonical"].some(ue=>ue in P))throw new Error("sign() legacy options not supported");let{lowS:U,prehash:H,extraEntropy:L}=Ps(P,h);S=k(S,H);let N=M(S),K=er(a,A),z=[W(K),W(N)];if(L!=null&&L!==!1){let ue=L===!0?n(y.secretKey):L;z.push((0,G.ensureBytes)("extraEntropy",ue))}let se=(0,G.concatBytes)(...z),ie=N;function J(ue){let he=C(ue);if(!a.isValidNot0(he))return;let be=a.inv(he),fe=e.BASE.multiply(he).toAffine(),Ie=a.create(fe.x);if(Ie===ft)return;let yr=a.create(be*a.create(ie+Ie*K));if(yr===ft)return;let $r=(fe.x===Ie?0:2)|Number(fe.y&Oe),Zr=yr;return U&&m(yr)&&(Zr=a.neg(yr),$r^=1),new _(Ie,Zr,$r)}return s(J,"k2sig"),{seed:se,k2sig:J}}s(B,"prepSig");function O(S,A,P={}){S=(0,G.ensureBytes)("message",S);let{seed:U,k2sig:H}=B(S,A,P);return(0,G.createHmacDrbg)(t.outputLen,a.BYTES,o)(U,H)}s(O,"sign");function R(S){let A,P=typeof S=="string"||(0,G.isBytes)(S),U=!P&&S!==null&&typeof S=="object"&&typeof S.r=="bigint"&&typeof S.s=="bigint";if(!P&&!U)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(U)A=new _(S.r,S.s);else if(P){try{A=_.fromBytes((0,G.ensureBytes)("sig",S),"der")}catch(H){if(!(H instanceof ge.DER.Err))throw H}if(!A)try{A=_.fromBytes((0,G.ensureBytes)("sig",S),"compact")}catch{return!1}}return A||!1}s(R,"tryParsingSig");function D(S,A,P,U={}){let{lowS:H,prehash:L,format:N}=Ps(U,h);if(P=(0,G.ensureBytes)("publicKey",P),A=k((0,G.ensureBytes)("message",A),L),"strict"in U)throw new Error("options.strict was renamed to lowS");let K=N===void 0?R(S):_.fromBytes((0,G.ensureBytes)("sig",S),N);if(K===!1)return!1;try{let z=e.fromBytes(P);if(H&&K.hasHighS())return!1;let{r:se,s:ie}=K,J=M(A),ue=a.inv(ie),he=a.create(J*ue),be=a.create(se*ue),fe=e.BASE.multiplyUnsafe(he).add(z.multiplyUnsafe(be));return fe.is0()?!1:a.create(fe.x)===se}catch{return!1}}s(D,"verify");function v(S,A,P={}){let{prehash:U}=Ps(P,h);return A=k(A,U),_.fromBytes(S,"recovered").recoverPublicKey(A).toBytes()}return s(v,"recoverPublicKey"),Object.freeze({keygen:l,getPublicKey:f,getSharedSecret:p,utils:d,lengths:y,Point:e,sign:O,verify:D,recoverPublicKey:v,Signature:_,hash:t})}s(Eu,"ecdsa");function Vh(e){let{CURVE:t,curveOpts:r}=vu(e),n=Ds(t,r);return jh(e,n)}s(Vh,"weierstrassPoints");function vu(e){let t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},r=e.Fp,n=e.allowedPrivateKeyLengths?Array.from(new Set(e.allowedPrivateKeyLengths.map(a=>Math.ceil(a/2)))):void 0,o=(0,Rr.Field)(t.n,{BITS:e.nBitLength,allowedLengths:n,modFromBytes:e.wrapPrivateKey}),i={Fp:r,Fn:o,allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes};return{CURVE:t,curveOpts:i}}s(vu,"_weierstrass_legacy_opts_to_new");function Fh(e){let{CURVE:t,curveOpts:r}=vu(e),n={hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN};return{CURVE:t,curveOpts:r,hash:e.hash,ecdsaOpts:n}}s(Fh,"_ecdsa_legacy_opts_to_new");function Su(e,t,r){function n(o){let i=e.sqr(o),a=e.mul(i,o);return e.add(e.add(a,e.mul(o,t)),r)}return s(n,"weierstrassEquation"),n}s(Su,"_legacyHelperEquat");function jh(e,t){let{Fp:r,Fn:n}=t;function o(a){return(0,G.inRange)(a,Oe,n.ORDER)}s(o,"isWithinCurveOrder");let i=Su(r,e.a,e.b);return Object.assign({},{CURVE:e,Point:t,ProjectivePoint:t,normPrivateKeyToScalar:s(a=>er(n,a),"normPrivateKeyToScalar"),weierstrassEquation:i,isWithinCurveOrder:o})}s(jh,"_weierstrass_new_output_to_legacy");function zh(e,t){let r=t.Point;return Object.assign({},t,{ProjectivePoint:r,CURVE:Object.assign({},e,(0,Rr.nLength)(r.Fn.ORDER,r.Fn.BITS))})}s(zh,"_ecdsa_new_output_to_legacy");function Wh(e){let{CURVE:t,curveOpts:r,hash:n,ecdsaOpts:o}=Fh(e),i=Ds(t,r),a=Eu(i,n,o);return zh(e,a)}s(Wh,"weierstrass")});var _u=ne(to=>{"use strict";g();b();Object.defineProperty(to,"__esModule",{value:!0});to.getHash=$h;to.createCurve=Zh;var Gh=Ns();function $h(e){return{hash:e}}s($h,"getHash");function Zh(e,t){let r=s(n=>(0,Gh.weierstrass)({...e,hash:n}),"create");return{...r(t),create:r}}s(Zh,"createCurve")});var Ru=ne(Pe=>{"use strict";g();b();Object.defineProperty(Pe,"__esModule",{value:!0});Pe.encodeToCurve=Pe.hashToCurve=Pe.secp256k1_hasher=Pe.schnorr=Pe.secp256k1=void 0;var ro=Vn(),Iu=mt(),Yh=_u(),Tu=Ss(),Fe=Qt(),Lu=Ns(),Je=Nt(),Dr={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},Qh={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},Xh=BigInt(0),Au=BigInt(1),Hs=BigInt(2);function Jh(e){let t=Dr.p,r=BigInt(3),n=BigInt(6),o=BigInt(11),i=BigInt(22),a=BigInt(23),c=BigInt(44),u=BigInt(88),l=e*e*e%t,f=l*l*e%t,p=(0,Fe.pow2)(f,r,t)*f%t,d=(0,Fe.pow2)(p,r,t)*f%t,y=(0,Fe.pow2)(d,Hs,t)*l%t,h=(0,Fe.pow2)(y,o,t)*y%t,w=(0,Fe.pow2)(h,i,t)*h%t,m=(0,Fe.pow2)(w,c,t)*w%t,x=(0,Fe.pow2)(m,u,t)*m%t,E=(0,Fe.pow2)(x,c,t)*w%t,_=(0,Fe.pow2)(E,r,t)*f%t,C=(0,Fe.pow2)(_,a,t)*h%t,M=(0,Fe.pow2)(C,n,t)*l%t,q=(0,Fe.pow2)(M,Hs,t);if(!Kt.eql(Kt.sqr(q),e))throw new Error("Cannot find square root");return q}s(Jh,"sqrtMod");var Kt=(0,Fe.Field)(Dr.p,{sqrt:Jh});Pe.secp256k1=(0,Yh.createCurve)({...Dr,Fp:Kt,lowS:!0,endo:Qh},ro.sha256);var Bu={};function no(e,...t){let r=Bu[e];if(r===void 0){let n=(0,ro.sha256)((0,Je.utf8ToBytes)(e));r=(0,Je.concatBytes)(n,n),Bu[e]=r}return(0,ro.sha256)((0,Je.concatBytes)(r,...t))}s(no,"taggedHash");var Ks=s(e=>e.toBytes(!0).slice(1),"pointToBytes"),Nr=Pe.secp256k1.Point,qs=s(e=>e%Hs===Xh,"hasEven");function Ms(e){let{Fn:t,BASE:r}=Nr,n=(0,Lu._normFnElement)(t,e),o=r.multiply(n);return{scalar:qs(o.y)?n:t.neg(n),bytes:Ks(o)}}s(Ms,"schnorrGetExtPubKey");function Ou(e){let t=Kt;if(!t.isValidNot0(e))throw new Error("invalid x: Fail if x \u2265 p");let r=t.create(e*e),n=t.create(r*e+BigInt(7)),o=t.sqrt(n);qs(o)||(o=t.neg(o));let i=Nr.fromAffine({x:e,y:o});return i.assertValidity(),i}s(Ou,"lift_x");var fn=Je.bytesToNumberBE;function Pu(...e){return Nr.Fn.create(fn(no("BIP0340/challenge",...e)))}s(Pu,"challenge");function Cu(e){return Ms(e).bytes}s(Cu,"schnorrGetPublicKey");function ep(e,t,r=(0,Iu.randomBytes)(32)){let{Fn:n}=Nr,o=(0,Je.ensureBytes)("message",e),{bytes:i,scalar:a}=Ms(t),c=(0,Je.ensureBytes)("auxRand",r,32),u=n.toBytes(a^fn(no("BIP0340/aux",c))),l=no("BIP0340/nonce",u,i,o),{bytes:f,scalar:p}=Ms(l),d=Pu(f,i,o),y=new Uint8Array(64);if(y.set(f,0),y.set(n.toBytes(n.create(p+d*a)),32),!Uu(y,o,i))throw new Error("sign: Invalid signature produced");return y}s(ep,"schnorrSign");function Uu(e,t,r){let{Fn:n,BASE:o}=Nr,i=(0,Je.ensureBytes)("signature",e,64),a=(0,Je.ensureBytes)("message",t),c=(0,Je.ensureBytes)("publicKey",r,32);try{let u=Ou(fn(c)),l=fn(i.subarray(0,32));if(!(0,Je.inRange)(l,Au,Dr.p))return!1;let f=fn(i.subarray(32,64));if(!(0,Je.inRange)(f,Au,Dr.n))return!1;let p=Pu(n.toBytes(l),Ks(u),a),d=o.multiplyUnsafe(f).add(u.multiplyUnsafe(n.neg(p))),{x:y,y:h}=d.toAffine();return!(d.is0()||!qs(h)||y!==l)}catch{return!1}}s(Uu,"schnorrVerify");Pe.schnorr=(()=>{let r=s((o=(0,Iu.randomBytes)(48))=>(0,Fe.mapHashToField)(o,Dr.n),"randomSecretKey");Pe.secp256k1.utils.randomSecretKey;function n(o){let i=r(o);return{secretKey:i,publicKey:Cu(i)}}return s(n,"keygen"),{keygen:n,getPublicKey:Cu,sign:ep,verify:Uu,Point:Nr,utils:{randomSecretKey:r,randomPrivateKey:r,taggedHash:no,lift_x:Ou,pointToBytes:Ks,numberToBytesBE:Je.numberToBytesBE,bytesToNumberBE:Je.bytesToNumberBE,mod:Fe.mod},lengths:{secretKey:32,publicKey:32,publicKeyHasPrefix:!1,signature:32*2,seed:48}}})();var tp=(0,Tu.isogenyMap)(Kt,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(e=>e.map(t=>BigInt(t)))),rp=(0,Lu.mapToCurveSimpleSWU)(Kt,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:Kt.create(BigInt("-11"))});Pe.secp256k1_hasher=(0,Tu.createHasher)(Pe.secp256k1.Point,e=>{let{x:t,y:r}=rp(Kt.create(e[0]));return tp(t,r)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:Kt.ORDER,m:1,k:128,expand:"xmd",hash:ro.sha256});Pe.hashToCurve=Pe.secp256k1_hasher.hashToCurve;Pe.encodeToCurve=Pe.secp256k1_hasher.encodeToCurve});var ks=ne(fr=>{"use strict";g();b();Object.defineProperty(fr,"__esModule",{value:!0});fr.decodeHex=fr.remove0x=void 0;var np=Xe(),op=s(function(e){return e.startsWith("0x")||e.startsWith("0X")?e.slice(2):e},"remove0x");fr.remove0x=op;var sp=s(function(e){return(0,np.hexToBytes)((0,fr.remove0x)(e))},"decodeHex");fr.decodeHex=sp});var Hu=ne(je=>{"use strict";g();b();Object.defineProperty(je,"__esModule",{value:!0});je.hexToPublicKey=je.convertPublicKeyFormat=je.getSharedPoint=je.getPublicKey=je.isValidPrivateKey=je.getValidSecret=void 0;var ip=es(),Du=pu(),ap=Ru(),dn=en(),Nu=Pn(),cp=ks(),up=s(function(e){var t;do t=(0,ip.randomBytes)(Nu.SECRET_KEY_LENGTH);while(!(0,je.isValidPrivateKey)(t,e));return t},"getValidSecret");je.getValidSecret=up;var lp=s(function(e,t){return hn(t||(0,dn.ellipticCurve)(),function(r){return r.utils.isValidPrivateKey(e)},function(){return!0},function(){return!0})},"isValidPrivateKey");je.isValidPrivateKey=lp;var fp=s(function(e,t){return hn(t||(0,dn.ellipticCurve)(),function(r){return r.getPublicKey(e)},function(r){return r.getPublicKey(e)},function(r){return r.getPublicKey(e)})},"getPublicKey");je.getPublicKey=fp;var dp=s(function(e,t,r,n){return hn(n||(0,dn.ellipticCurve)(),function(o){return o.getSharedSecret(e,t,r)},function(o){return o.getSharedSecret(e,t)},function(o){return mp(o,e,t)})},"getSharedPoint");je.getSharedPoint=dp;var hp=s(function(e,t,r){return hn(r||(0,dn.ellipticCurve)(),function(n){return n.getSharedSecret(BigInt(1),e,t)},function(){return e},function(){return e})},"convertPublicKeyFormat");je.convertPublicKeyFormat=hp;var pp=s(function(e,t){var r=(0,cp.decodeHex)(e);return hn(t||(0,dn.ellipticCurve)(),function(){return yp(r)},function(){return r},function(){return r})},"hexToPublicKey");je.hexToPublicKey=pp;function hn(e,t,r,n){if(e==="secp256k1")return t(ap.secp256k1);if(e==="x25519")return r(Du.x25519);if(e==="ed25519")return n(Du.ed25519);throw new Error("Not implemented")}s(hn,"_exec");var yp=s(function(e){if(e.length===Nu.ETH_PUBLIC_KEY_SIZE){var t=new Uint8Array(1+e.length);return t.set([4]),t.set(e,1),t}return e},"compatEthPublicKey"),mp=s(function(e,t,r){var n=e.utils.getExtendedPublicKey(t).scalar,o=e.ExtendedPoint.fromHex(r).multiply(n);return o.toRawBytes()},"getSharedPointOnEd25519")});var Vu=ne(Mr=>{"use strict";g();b();Object.defineProperty(Mr,"__esModule",{value:!0});Mr.hkdf=void 0;Mr.extract=qu;Mr.expand=ku;var Ku=Os(),Hr=mt();function qu(e,t,r){return(0,Hr.ahash)(e),r===void 0&&(r=new Uint8Array(e.outputLen)),(0,Ku.hmac)(e,(0,Hr.toBytes)(r),(0,Hr.toBytes)(t))}s(qu,"extract");var Vs=Uint8Array.from([0]),Mu=Uint8Array.of();function ku(e,t,r,n=32){(0,Hr.ahash)(e),(0,Hr.anumber)(n);let o=e.outputLen;if(n>255*o)throw new Error("Length should be <= 255*HashLen");let i=Math.ceil(n/o);r===void 0&&(r=Mu);let a=new Uint8Array(i*o),c=Ku.hmac.create(e,t),u=c._cloneInto(),l=new Uint8Array(c.outputLen);for(let f=0;f<i;f++)Vs[0]=f+1,u.update(f===0?Mu:l).update(r).update(Vs).digestInto(l),a.set(l,o*f),c._cloneInto(u);return c.destroy(),u.destroy(),(0,Hr.clean)(l,Vs),a.slice(0,n)}s(ku,"expand");var gp=s((e,t,r,n,o)=>ku(e,qu(e,t,r),n,o),"hkdf");Mr.hkdf=gp});var Fu=ne(dr=>{"use strict";g();b();Object.defineProperty(dr,"__esModule",{value:!0});dr.getSharedKey=dr.deriveKey=void 0;var bp=Xe(),wp=Vu(),xp=Vn(),Ep=s(function(e,t,r){return(0,wp.hkdf)(xp.sha256,e,t,r,32)},"deriveKey");dr.deriveKey=Ep;var vp=s(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,dr.deriveKey)(bp.concatBytes.apply(void 0,e))},"getSharedKey");dr.getSharedKey=vp});var Wu=ne(hr=>{"use strict";g();b();Object.defineProperty(hr,"__esModule",{value:!0});hr.polyval=hr.ghash=void 0;hr._toGHASHKey=ju;var Ee=Xe(),qt=16,js=new Uint8Array(16),St=(0,Ee.u32)(js),Sp=225,_p=s((e,t,r,n)=>{let o=n&1;return{s3:r<<31|n>>>1,s2:t<<31|r>>>1,s1:e<<31|t>>>1,s0:e>>>1^Sp<<24&-(o&1)}},"mul2"),tt=s(e=>(e>>>0&255)<<24|(e>>>8&255)<<16|(e>>>16&255)<<8|e>>>24&255|0,"swapLE");function ju(e){e.reverse();let t=e[15]&1,r=0;for(let n=0;n<e.length;n++){let o=e[n];e[n]=o>>>1|r,r=(o&1)<<7}return e[0]^=-t&225,e}s(ju,"_toGHASHKey");var Ap=s(e=>e>64*1024?8:e>1024?4:2,"estimateWindow"),oo=class{static{s(this,"GHASH")}constructor(t,r){this.blockLen=qt,this.outputLen=qt,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,t=(0,Ee.toBytes)(t),(0,Ee.abytes)(t,16);let n=(0,Ee.createView)(t),o=n.getUint32(0,!1),i=n.getUint32(4,!1),a=n.getUint32(8,!1),c=n.getUint32(12,!1),u=[];for(let h=0;h<128;h++)u.push({s0:tt(o),s1:tt(i),s2:tt(a),s3:tt(c)}),{s0:o,s1:i,s2:a,s3:c}=_p(o,i,a,c);let l=Ap(r||1024);if(![1,2,4,8].includes(l))throw new Error("ghash: invalid window size, expected 2, 4 or 8");this.W=l;let p=128/l,d=this.windowSize=2**l,y=[];for(let h=0;h<p;h++)for(let w=0;w<d;w++){let m=0,x=0,E=0,_=0;for(let C=0;C<l;C++){if(!(w>>>l-C-1&1))continue;let{s0:q,s1:W,s2:k,s3:B}=u[l*h+C];m^=q,x^=W,E^=k,_^=B}y.push({s0:m,s1:x,s2:E,s3:_})}this.t=y}_updateBlock(t,r,n,o){t^=this.s0,r^=this.s1,n^=this.s2,o^=this.s3;let{W:i,t:a,windowSize:c}=this,u=0,l=0,f=0,p=0,d=(1<<i)-1,y=0;for(let h of[t,r,n,o])for(let w=0;w<4;w++){let m=h>>>8*w&255;for(let x=8/i-1;x>=0;x--){let E=m>>>i*x&d,{s0:_,s1:C,s2:M,s3:q}=a[y*c+E];u^=_,l^=C,f^=M,p^=q,y+=1}}this.s0=u,this.s1=l,this.s2=f,this.s3=p}update(t){(0,Ee.aexists)(this),t=(0,Ee.toBytes)(t),(0,Ee.abytes)(t);let r=(0,Ee.u32)(t),n=Math.floor(t.length/qt),o=t.length%qt;for(let i=0;i<n;i++)this._updateBlock(r[i*4+0],r[i*4+1],r[i*4+2],r[i*4+3]);return o&&(js.set(t.subarray(n*qt)),this._updateBlock(St[0],St[1],St[2],St[3]),(0,Ee.clean)(St)),this}destroy(){let{t}=this;for(let r of t)r.s0=0,r.s1=0,r.s2=0,r.s3=0}digestInto(t){(0,Ee.aexists)(this),(0,Ee.aoutput)(t,this),this.finished=!0;let{s0:r,s1:n,s2:o,s3:i}=this,a=(0,Ee.u32)(t);return a[0]=r,a[1]=n,a[2]=o,a[3]=i,t}digest(){let t=new Uint8Array(qt);return this.digestInto(t),this.destroy(),t}},Fs=class extends oo{static{s(this,"Polyval")}constructor(t,r){t=(0,Ee.toBytes)(t),(0,Ee.abytes)(t);let n=ju((0,Ee.copyBytes)(t));super(n,r),(0,Ee.clean)(n)}update(t){t=(0,Ee.toBytes)(t),(0,Ee.aexists)(this);let r=(0,Ee.u32)(t),n=t.length%qt,o=Math.floor(t.length/qt);for(let i=0;i<o;i++)this._updateBlock(tt(r[i*4+3]),tt(r[i*4+2]),tt(r[i*4+1]),tt(r[i*4+0]));return n&&(js.set(t.subarray(o*qt)),this._updateBlock(tt(St[3]),tt(St[2]),tt(St[1]),tt(St[0])),(0,Ee.clean)(St)),this}digestInto(t){(0,Ee.aexists)(this),(0,Ee.aoutput)(t,this),this.finished=!0;let{s0:r,s1:n,s2:o,s3:i}=this,a=(0,Ee.u32)(t);return a[0]=r,a[1]=n,a[2]=o,a[3]=i,t.reverse()}};function zu(e){let t=s((n,o)=>e(o,n.length).update((0,Ee.toBytes)(n)).digest(),"hashC"),r=e(new Uint8Array(16),0);return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=(n,o)=>e(n,o),t}s(zu,"wrapConstructorWithKey");hr.ghash=zu((e,t)=>new oo(e,t));hr.polyval=zu((e,t)=>new Fs(e,t))});var il=ne(ve=>{"use strict";g();b();Object.defineProperty(ve,"__esModule",{value:!0});ve.unsafe=ve.aeskwp=ve.aeskw=ve.siv=ve.gcmsiv=ve.gcm=ve.cfb=ve.cbc=ve.ecb=ve.ctr=void 0;var Ws=Wu(),T=Xe(),Qe=16,$s=4,so=new Uint8Array(Qe),Bp=283;function Zs(e){return e<<1^Bp&-(e>>7)}s(Zs,"mul2");function Kr(e,t){let r=0;for(;t>0;t>>=1)r^=e&-(t&1),e=Zs(e);return r}s(Kr,"mul");var Gs=(()=>{let e=new Uint8Array(256);for(let r=0,n=1;r<256;r++,n^=Zs(n))e[r]=n;let t=new Uint8Array(256);t[0]=99;for(let r=0;r<255;r++){let n=e[255-r];n|=n<<8,t[e[r]]=(n^n>>4^n>>5^n>>6^n>>7^99)&255}return(0,T.clean)(e),t})(),Cp=Gs.map((e,t)=>Gs.indexOf(t)),Ip=s(e=>e<<24|e>>>8,"rotr32_8"),zs=s(e=>e<<8|e>>>24,"rotl32_8"),ao=s(e=>e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255,"byteSwap");function Zu(e,t){if(e.length!==256)throw new Error("Wrong sbox length");let r=new Uint32Array(256).map((l,f)=>t(e[f])),n=r.map(zs),o=n.map(zs),i=o.map(zs),a=new Uint32Array(256*256),c=new Uint32Array(256*256),u=new Uint16Array(256*256);for(let l=0;l<256;l++)for(let f=0;f<256;f++){let p=l*256+f;a[p]=r[l]^n[f],c[p]=o[l]^i[f],u[p]=e[l]<<8|e[f]}return{sbox:e,sbox2:u,T0:r,T1:n,T2:o,T3:i,T01:a,T23:c}}s(Zu,"genTtable");var Ys=Zu(Gs,e=>Kr(e,3)<<24|e<<16|e<<8|Kr(e,2)),Yu=Zu(Cp,e=>Kr(e,11)<<24|Kr(e,13)<<16|Kr(e,9)<<8|Kr(e,14)),Tp=(()=>{let e=new Uint8Array(16);for(let t=0,r=1;t<16;t++,r=Zs(r))e[t]=r;return e})();function At(e){(0,T.abytes)(e);let t=e.length;if(![16,24,32].includes(t))throw new Error("aes: invalid key size, should be 16, 24 or 32, got "+t);let{sbox2:r}=Ys,n=[];(0,T.isAligned32)(e)||n.push(e=(0,T.copyBytes)(e));let o=(0,T.u32)(e),i=o.length,a=s(u=>_t(r,u,u,u,u),"subByte"),c=new Uint32Array(t+28);c.set(o);for(let u=i;u<c.length;u++){let l=c[u-1];u%i===0?l=a(Ip(l))^Tp[u/i-1]:i>6&&u%i===4&&(l=a(l)),c[u]=c[u-i]^l}return(0,T.clean)(...n),c}s(At,"expandKeyLE");function uo(e){let t=At(e),r=t.slice(),n=t.length,{sbox2:o}=Ys,{T0:i,T1:a,T2:c,T3:u}=Yu;for(let l=0;l<n;l+=4)for(let f=0;f<4;f++)r[l+f]=t[n-l-4+f];(0,T.clean)(t);for(let l=4;l<n-4;l++){let f=r[l],p=_t(o,f,f,f,f);r[l]=i[p&255]^a[p>>>8&255]^c[p>>>16&255]^u[p>>>24]}return r}s(uo,"expandKeyDecLE");function tr(e,t,r,n,o,i){return e[r<<8&65280|n>>>8&255]^t[o>>>8&65280|i>>>24&255]}s(tr,"apply0123");function _t(e,t,r,n,o){return e[t&255|r&65280]|e[n>>>16&255|o>>>16&65280]<<16}s(_t,"applySbox");function ze(e,t,r,n,o){let{sbox2:i,T01:a,T23:c}=Ys,u=0;t^=e[u++],r^=e[u++],n^=e[u++],o^=e[u++];let l=e.length/4-2;for(let h=0;h<l;h++){let w=e[u++]^tr(a,c,t,r,n,o),m=e[u++]^tr(a,c,r,n,o,t),x=e[u++]^tr(a,c,n,o,t,r),E=e[u++]^tr(a,c,o,t,r,n);t=w,r=m,n=x,o=E}let f=e[u++]^_t(i,t,r,n,o),p=e[u++]^_t(i,r,n,o,t),d=e[u++]^_t(i,n,o,t,r),y=e[u++]^_t(i,o,t,r,n);return{s0:f,s1:p,s2:d,s3:y}}s(ze,"encrypt");function pn(e,t,r,n,o){let{sbox2:i,T01:a,T23:c}=Yu,u=0;t^=e[u++],r^=e[u++],n^=e[u++],o^=e[u++];let l=e.length/4-2;for(let h=0;h<l;h++){let w=e[u++]^tr(a,c,t,o,n,r),m=e[u++]^tr(a,c,r,t,o,n),x=e[u++]^tr(a,c,n,r,t,o),E=e[u++]^tr(a,c,o,n,r,t);t=w,r=m,n=x,o=E}let f=e[u++]^_t(i,t,o,n,r),p=e[u++]^_t(i,r,t,o,n),d=e[u++]^_t(i,n,r,t,o),y=e[u++]^_t(i,o,n,r,t);return{s0:f,s1:p,s2:d,s3:y}}s(pn,"decrypt");function Qu(e,t,r,n){(0,T.abytes)(t,Qe),(0,T.abytes)(r);let o=r.length;n=(0,T.getOutput)(o,n),(0,T.complexOverlapBytes)(r,n);let i=t,a=(0,T.u32)(i),{s0:c,s1:u,s2:l,s3:f}=ze(e,a[0],a[1],a[2],a[3]),p=(0,T.u32)(r),d=(0,T.u32)(n);for(let h=0;h+4<=p.length;h+=4){d[h+0]=p[h+0]^c,d[h+1]=p[h+1]^u,d[h+2]=p[h+2]^l,d[h+3]=p[h+3]^f;let w=1;for(let m=i.length-1;m>=0;m--)w=w+(i[m]&255)|0,i[m]=w&255,w>>>=8;({s0:c,s1:u,s2:l,s3:f}=ze(e,a[0],a[1],a[2],a[3]))}let y=Qe*Math.floor(p.length/$s);if(y<o){let h=new Uint32Array([c,u,l,f]),w=(0,T.u8)(h);for(let m=y,x=0;m<o;m++,x++)n[m]=r[m]^w[x];(0,T.clean)(h)}return n}s(Qu,"ctrCounter");function qr(e,t,r,n,o){(0,T.abytes)(r,Qe),(0,T.abytes)(n),o=(0,T.getOutput)(n.length,o);let i=r,a=(0,T.u32)(i),c=(0,T.createView)(i),u=(0,T.u32)(n),l=(0,T.u32)(o),f=t?0:12,p=n.length,d=c.getUint32(f,t),{s0:y,s1:h,s2:w,s3:m}=ze(e,a[0],a[1],a[2],a[3]);for(let E=0;E+4<=u.length;E+=4)l[E+0]=u[E+0]^y,l[E+1]=u[E+1]^h,l[E+2]=u[E+2]^w,l[E+3]=u[E+3]^m,d=d+1>>>0,c.setUint32(f,d,t),{s0:y,s1:h,s2:w,s3:m}=ze(e,a[0],a[1],a[2],a[3]);let x=Qe*Math.floor(u.length/$s);if(x<p){let E=new Uint32Array([y,h,w,m]),_=(0,T.u8)(E);for(let C=x,M=0;C<p;C++,M++)o[C]=n[C]^_[M];(0,T.clean)(E)}return o}s(qr,"ctr32");ve.ctr=(0,T.wrapCipher)({blockSize:16,nonceLength:16},s(function(t,r){function n(o,i){if((0,T.abytes)(o),i!==void 0&&((0,T.abytes)(i),!(0,T.isAligned32)(i)))throw new Error("unaligned destination");let a=At(t),c=(0,T.copyBytes)(r),u=[a,c];(0,T.isAligned32)(o)||u.push(o=(0,T.copyBytes)(o));let l=Qu(a,c,o,i);return(0,T.clean)(...u),l}return s(n,"processCtr"),{encrypt:s((o,i)=>n(o,i),"encrypt"),decrypt:s((o,i)=>n(o,i),"decrypt")}},"aesctr"));function Xu(e){if((0,T.abytes)(e),e.length%Qe!==0)throw new Error("aes-(cbc/ecb).decrypt ciphertext should consist of blocks with size "+Qe)}s(Xu,"validateBlockDecrypt");function Ju(e,t,r){(0,T.abytes)(e);let n=e.length,o=n%Qe;if(!t&&o!==0)throw new Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");(0,T.isAligned32)(e)||(e=(0,T.copyBytes)(e));let i=(0,T.u32)(e);if(t){let c=Qe-o;c||(c=Qe),n=n+c}r=(0,T.getOutput)(n,r),(0,T.complexOverlapBytes)(e,r);let a=(0,T.u32)(r);return{b:i,o:a,out:r}}s(Ju,"validateBlockEncrypt");function el(e,t){if(!t)return e;let r=e.length;if(!r)throw new Error("aes/pcks5: empty ciphertext not allowed");let n=e[r-1];if(n<=0||n>16)throw new Error("aes/pcks5: wrong padding");let o=e.subarray(0,-n);for(let i=0;i<n;i++)if(e[r-i-1]!==n)throw new Error("aes/pcks5: wrong padding");return o}s(el,"validatePCKS");function tl(e){let t=new Uint8Array(16),r=(0,T.u32)(t);t.set(e);let n=Qe-e.length;for(let o=Qe-n;o<Qe;o++)t[o]=n;return r}s(tl,"padPCKS");ve.ecb=(0,T.wrapCipher)({blockSize:16},s(function(t,r={}){let n=!r.disablePadding;return{encrypt(o,i){let{b:a,o:c,out:u}=Ju(o,n,i),l=At(t),f=0;for(;f+4<=a.length;){let{s0:p,s1:d,s2:y,s3:h}=ze(l,a[f+0],a[f+1],a[f+2],a[f+3]);c[f++]=p,c[f++]=d,c[f++]=y,c[f++]=h}if(n){let p=tl(o.subarray(f*4)),{s0:d,s1:y,s2:h,s3:w}=ze(l,p[0],p[1],p[2],p[3]);c[f++]=d,c[f++]=y,c[f++]=h,c[f++]=w}return(0,T.clean)(l),u},decrypt(o,i){Xu(o);let a=uo(t);i=(0,T.getOutput)(o.length,i);let c=[a];(0,T.isAligned32)(o)||c.push(o=(0,T.copyBytes)(o)),(0,T.complexOverlapBytes)(o,i);let u=(0,T.u32)(o),l=(0,T.u32)(i);for(let f=0;f+4<=u.length;){let{s0:p,s1:d,s2:y,s3:h}=pn(a,u[f+0],u[f+1],u[f+2],u[f+3]);l[f++]=p,l[f++]=d,l[f++]=y,l[f++]=h}return(0,T.clean)(...c),el(i,n)}}},"aesecb"));ve.cbc=(0,T.wrapCipher)({blockSize:16,nonceLength:16},s(function(t,r,n={}){let o=!n.disablePadding;return{encrypt(i,a){let c=At(t),{b:u,o:l,out:f}=Ju(i,o,a),p=r,d=[c];(0,T.isAligned32)(p)||d.push(p=(0,T.copyBytes)(p));let y=(0,T.u32)(p),h=y[0],w=y[1],m=y[2],x=y[3],E=0;for(;E+4<=u.length;)h^=u[E+0],w^=u[E+1],m^=u[E+2],x^=u[E+3],{s0:h,s1:w,s2:m,s3:x}=ze(c,h,w,m,x),l[E++]=h,l[E++]=w,l[E++]=m,l[E++]=x;if(o){let _=tl(i.subarray(E*4));h^=_[0],w^=_[1],m^=_[2],x^=_[3],{s0:h,s1:w,s2:m,s3:x}=ze(c,h,w,m,x),l[E++]=h,l[E++]=w,l[E++]=m,l[E++]=x}return(0,T.clean)(...d),f},decrypt(i,a){Xu(i);let c=uo(t),u=r,l=[c];(0,T.isAligned32)(u)||l.push(u=(0,T.copyBytes)(u));let f=(0,T.u32)(u);a=(0,T.getOutput)(i.length,a),(0,T.isAligned32)(i)||l.push(i=(0,T.copyBytes)(i)),(0,T.complexOverlapBytes)(i,a);let p=(0,T.u32)(i),d=(0,T.u32)(a),y=f[0],h=f[1],w=f[2],m=f[3];for(let x=0;x+4<=p.length;){let E=y,_=h,C=w,M=m;y=p[x+0],h=p[x+1],w=p[x+2],m=p[x+3];let{s0:q,s1:W,s2:k,s3:B}=pn(c,y,h,w,m);d[x++]=q^E,d[x++]=W^_,d[x++]=k^C,d[x++]=B^M}return(0,T.clean)(...l),el(a,o)}}},"aescbc"));ve.cfb=(0,T.wrapCipher)({blockSize:16,nonceLength:16},s(function(t,r){function n(o,i,a){(0,T.abytes)(o);let c=o.length;if(a=(0,T.getOutput)(c,a),(0,T.overlapBytes)(o,a))throw new Error("overlapping src and dst not supported.");let u=At(t),l=r,f=[u];(0,T.isAligned32)(l)||f.push(l=(0,T.copyBytes)(l)),(0,T.isAligned32)(o)||f.push(o=(0,T.copyBytes)(o));let p=(0,T.u32)(o),d=(0,T.u32)(a),y=i?d:p,h=(0,T.u32)(l),w=h[0],m=h[1],x=h[2],E=h[3];for(let C=0;C+4<=p.length;){let{s0:M,s1:q,s2:W,s3:k}=ze(u,w,m,x,E);d[C+0]=p[C+0]^M,d[C+1]=p[C+1]^q,d[C+2]=p[C+2]^W,d[C+3]=p[C+3]^k,w=y[C++],m=y[C++],x=y[C++],E=y[C++]}let _=Qe*Math.floor(p.length/$s);if(_<c){({s0:w,s1:m,s2:x,s3:E}=ze(u,w,m,x,E));let C=(0,T.u8)(new Uint32Array([w,m,x,E]));for(let M=_,q=0;M<c;M++,q++)a[M]=o[M]^C[q];(0,T.clean)(C)}return(0,T.clean)(...f),a}return s(n,"processCfb"),{encrypt:s((o,i)=>n(o,!0,i),"encrypt"),decrypt:s((o,i)=>n(o,!1,i),"decrypt")}},"aescfb"));function rl(e,t,r,n,o){let i=o?o.length:0,a=e.create(r,n.length+i);o&&a.update(o);let c=(0,T.u64Lengths)(8*n.length,8*i,t);a.update(n),a.update(c);let u=a.digest();return(0,T.clean)(c),u}s(rl,"computeTag");ve.gcm=(0,T.wrapCipher)({blockSize:16,nonceLength:12,tagLength:16,varSizeNonce:!0},s(function(t,r,n){if(r.length<8)throw new Error("aes/gcm: invalid nonce length");let o=16;function i(c,u,l){let f=rl(Ws.ghash,!1,c,l,n);for(let p=0;p<u.length;p++)f[p]^=u[p];return f}s(i,"_computeTag");function a(){let c=At(t),u=so.slice(),l=so.slice();if(qr(c,!1,l,l,u),r.length===12)l.set(r);else{let p=so.slice(),d=(0,T.createView)(p);(0,T.setBigUint64)(d,8,BigInt(r.length*8),!1);let y=Ws.ghash.create(u).update(r).update(p);y.digestInto(l),y.destroy()}let f=qr(c,!1,l,so);return{xk:c,authKey:u,counter:l,tagMask:f}}return s(a,"deriveKeys"),{encrypt(c){let{xk:u,authKey:l,counter:f,tagMask:p}=a(),d=new Uint8Array(c.length+o),y=[u,l,f,p];(0,T.isAligned32)(c)||y.push(c=(0,T.copyBytes)(c)),qr(u,!1,f,c,d.subarray(0,c.length));let h=i(l,p,d.subarray(0,d.length-o));return y.push(h),d.set(h,c.length),(0,T.clean)(...y),d},decrypt(c){let{xk:u,authKey:l,counter:f,tagMask:p}=a(),d=[u,l,p,f];(0,T.isAligned32)(c)||d.push(c=(0,T.copyBytes)(c));let y=c.subarray(0,-o),h=c.subarray(-o),w=i(l,p,y);if(d.push(w),!(0,T.equalBytes)(w,h))throw new Error("aes/gcm: invalid ghash tag");let m=qr(u,!1,f,y);return(0,T.clean)(...d),m}}},"aesgcm"));var io=s((e,t,r)=>n=>{if(!Number.isSafeInteger(n)||t>n||n>r){let o="["+t+".."+r+"]";throw new Error(""+e+": expected value in range "+o+", got "+n)}},"limit");ve.gcmsiv=(0,T.wrapCipher)({blockSize:16,nonceLength:12,tagLength:16,varSizeNonce:!0},s(function(t,r,n){let i=io("AAD",0,68719476736),a=io("plaintext",0,2**36),c=io("nonce",12,12),u=io("ciphertext",16,2**36+16);(0,T.abytes)(t,16,24,32),c(r.length),n!==void 0&&i(n.length);function l(){let d=At(t),y=new Uint8Array(t.length),h=new Uint8Array(16),w=[d,y],m=r;(0,T.isAligned32)(m)||w.push(m=(0,T.copyBytes)(m));let x=(0,T.u32)(m),E=0,_=x[0],C=x[1],M=x[2],q=0;for(let k of[h,y].map(T.u32)){let B=(0,T.u32)(k);for(let O=0;O<B.length;O+=2){let{s0:R,s1:D}=ze(d,E,_,C,M);B[O+0]=R,B[O+1]=D,E=++q}}let W={authKey:h,encKey:At(y)};return(0,T.clean)(...w),W}s(l,"deriveKeys");function f(d,y,h){let w=rl(Ws.polyval,!0,y,h,n);for(let M=0;M<12;M++)w[M]^=r[M];w[15]&=127;let m=(0,T.u32)(w),x=m[0],E=m[1],_=m[2],C=m[3];return{s0:x,s1:E,s2:_,s3:C}=ze(d,x,E,_,C),m[0]=x,m[1]=E,m[2]=_,m[3]=C,w}s(f,"_computeTag");function p(d,y,h){let w=(0,T.copyBytes)(y);w[15]|=128;let m=qr(d,!0,w,h);return(0,T.clean)(w),m}return s(p,"processSiv"),{encrypt(d){a(d.length);let{encKey:y,authKey:h}=l(),w=f(y,h,d),m=[y,h,w];(0,T.isAligned32)(d)||m.push(d=(0,T.copyBytes)(d));let x=new Uint8Array(d.length+16);return x.set(w,d.length),x.set(p(y,w,d)),(0,T.clean)(...m),x},decrypt(d){u(d.length);let y=d.subarray(-16),{encKey:h,authKey:w}=l(),m=[h,w];(0,T.isAligned32)(d)||m.push(d=(0,T.copyBytes)(d));let x=p(h,y,d.subarray(0,-16)),E=f(h,w,x);if(m.push(E),!(0,T.equalBytes)(y,E))throw(0,T.clean)(...m),new Error("invalid polyval tag");return(0,T.clean)(...m),x}}},"aessiv"));ve.siv=ve.gcmsiv;function nl(e){return e instanceof Uint32Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint32Array"}s(nl,"isBytes32");function ol(e,t){if((0,T.abytes)(t,16),!nl(e))throw new Error("_encryptBlock accepts result of expandKeyLE");let r=(0,T.u32)(t),{s0:n,s1:o,s2:i,s3:a}=ze(e,r[0],r[1],r[2],r[3]);return r[0]=n,r[1]=o,r[2]=i,r[3]=a,t}s(ol,"encryptBlock");function sl(e,t){if((0,T.abytes)(t,16),!nl(e))throw new Error("_decryptBlock accepts result of expandKeyLE");let r=(0,T.u32)(t),{s0:n,s1:o,s2:i,s3:a}=pn(e,r[0],r[1],r[2],r[3]);return r[0]=n,r[1]=o,r[2]=i,r[3]=a,t}s(sl,"decryptBlock");var co={encrypt(e,t){if(t.length>=2**32)throw new Error("plaintext should be less than 4gb");let r=At(e);if(t.length===16)ol(r,t);else{let n=(0,T.u32)(t),o=n[0],i=n[1];for(let a=0,c=1;a<6;a++)for(let u=2;u<n.length;u+=2,c++){let{s0:l,s1:f,s2:p,s3:d}=ze(r,o,i,n[u],n[u+1]);o=l,i=f^ao(c),n[u]=p,n[u+1]=d}n[0]=o,n[1]=i}r.fill(0)},decrypt(e,t){if(t.length-8>=2**32)throw new Error("ciphertext should be less than 4gb");let r=uo(e),n=t.length/8-1;if(n===1)sl(r,t);else{let o=(0,T.u32)(t),i=o[0],a=o[1];for(let c=0,u=n*6;c<6;c++)for(let l=n*2;l>=1;l-=2,u--){a^=ao(u);let{s0:f,s1:p,s2:d,s3:y}=pn(r,i,a,o[l],o[l+1]);i=f,a=p,o[l]=d,o[l+1]=y}o[0]=i,o[1]=a}r.fill(0)}},Gu=new Uint8Array(8).fill(166);ve.aeskw=(0,T.wrapCipher)({blockSize:8},e=>({encrypt(t){if(!t.length||t.length%8!==0)throw new Error("invalid plaintext length");if(t.length===8)throw new Error("8-byte keys not allowed in AESKW, use AESKWP instead");let r=(0,T.concatBytes)(Gu,t);return co.encrypt(e,r),r},decrypt(t){if(t.length%8!==0||t.length<3*8)throw new Error("invalid ciphertext length");let r=(0,T.copyBytes)(t);if(co.decrypt(e,r),!(0,T.equalBytes)(r.subarray(0,8),Gu))throw new Error("integrity check failed");return r.subarray(0,8).fill(0),r.subarray(8)}}));var $u=2790873510;ve.aeskwp=(0,T.wrapCipher)({blockSize:8},e=>({encrypt(t){if(!t.length)throw new Error("invalid plaintext length");let r=Math.ceil(t.length/8)*8,n=new Uint8Array(8+r);n.set(t,8);let o=(0,T.u32)(n);return o[0]=$u,o[1]=ao(t.length),co.encrypt(e,n),n},decrypt(t){if(t.length<16)throw new Error("invalid ciphertext length");let r=(0,T.copyBytes)(t),n=(0,T.u32)(r);co.decrypt(e,r);let o=ao(n[1])>>>0,i=Math.ceil(o/8)*8;if(n[0]!==$u||r.length-8!==i)throw new Error("integrity check failed");for(let a=o;a<i;a++)if(r[8+a]!==0)throw new Error("integrity check failed");return r.subarray(0,8).fill(0),r.subarray(8,8+o)}}));ve.unsafe={expandKeyLE:At,expandKeyDecLE:uo,encrypt:ze,decrypt:pn,encryptBlock:ol,decryptBlock:sl,ctrCounter:Qu,ctr32:qr}});var cl=ne(kr=>{"use strict";g();b();Object.defineProperty(kr,"__esModule",{value:!0});kr.aes256cbc=kr.aes256gcm=void 0;var al=il(),Lp=s(function(e,t,r){return(0,al.gcm)(e,t,r)},"aes256gcm");kr.aes256gcm=Lp;var Op=s(function(e,t,r){return(0,al.cbc)(e,t)},"aes256cbc");kr.aes256cbc=Op});var dl=ne(fo=>{"use strict";g();b();Object.defineProperty(fo,"__esModule",{value:!0});fo.rotl=Np;fo.createCipher=Kp;var Ae=Xe(),ll=s(e=>Uint8Array.from(e.split("").map(t=>t.charCodeAt(0))),"_utf8ToBytes"),Pp=ll("expand 16-byte k"),Up=ll("expand 32-byte k"),Rp=(0,Ae.u32)(Pp),Dp=(0,Ae.u32)(Up);function Np(e,t){return e<<t|e>>>32-t}s(Np,"rotl");function Qs(e){return e.byteOffset%4===0}s(Qs,"isAligned32");var lo=64,Hp=16,fl=2**32-1,ul=new Uint32Array;function Mp(e,t,r,n,o,i,a,c){let u=o.length,l=new Uint8Array(lo),f=(0,Ae.u32)(l),p=Qs(o)&&Qs(i),d=p?(0,Ae.u32)(o):ul,y=p?(0,Ae.u32)(i):ul;for(let h=0;h<u;a++){if(e(t,r,n,f,a,c),a>=fl)throw new Error("arx: counter overflow");let w=Math.min(lo,u-h);if(p&&w===lo){let m=h/4;if(h%4!==0)throw new Error("arx: invalid block position");for(let x=0,E;x<Hp;x++)E=m+x,y[E]=d[E]^f[x];h+=lo;continue}for(let m=0,x;m<w;m++)x=h+m,i[x]=o[x]^l[m];h+=w}}s(Mp,"runCipher");function Kp(e,t){let{allowShortKeys:r,extendNonceFn:n,counterLength:o,counterRight:i,rounds:a}=(0,Ae.checkOpts)({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return(0,Ae.anumber)(o),(0,Ae.anumber)(a),(0,Ae.abool)(i),(0,Ae.abool)(r),(c,u,l,f,p=0)=>{(0,Ae.abytes)(c),(0,Ae.abytes)(u),(0,Ae.abytes)(l);let d=l.length;if(f===void 0&&(f=new Uint8Array(d)),(0,Ae.abytes)(f),(0,Ae.anumber)(p),p<0||p>=fl)throw new Error("arx: counter overflow");if(f.length<d)throw new Error(`arx: output (${f.length}) is shorter than data (${d})`);let y=[],h=c.length,w,m;if(h===32)y.push(w=(0,Ae.copyBytes)(c)),m=Dp;else if(h===16&&r)w=new Uint8Array(32),w.set(c),w.set(c,16),m=Rp,y.push(w);else throw new Error(`arx: invalid 32-byte key, got length=${h}`);Qs(u)||y.push(u=(0,Ae.copyBytes)(u));let x=(0,Ae.u32)(w);if(n){if(u.length!==24)throw new Error("arx: extended nonce must be 24 bytes");n(m,x,(0,Ae.u32)(u.subarray(0,16)),x),u=u.subarray(16)}let E=16-o;if(E!==u.length)throw new Error(`arx: nonce must be ${E} or 16 bytes`);if(E!==12){let C=new Uint8Array(12);C.set(u,i?0:12-u.length),u=C,y.push(u)}let _=(0,Ae.u32)(u);return Mp(e,m,x,_,l,f,p,a),(0,Ae.clean)(...y),f}}s(Kp,"createCipher")});var pl=ne(yn=>{"use strict";g();b();Object.defineProperty(yn,"__esModule",{value:!0});yn.poly1305=void 0;yn.wrapConstructorWithKey=hl;var Bt=Xe(),Ue=s((e,t)=>e[t++]&255|(e[t++]&255)<<8,"u8to16"),Xs=class{static{s(this,"Poly1305")}constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,t=(0,Bt.toBytes)(t),(0,Bt.abytes)(t,32);let r=Ue(t,0),n=Ue(t,2),o=Ue(t,4),i=Ue(t,6),a=Ue(t,8),c=Ue(t,10),u=Ue(t,12),l=Ue(t,14);this.r[0]=r&8191,this.r[1]=(r>>>13|n<<3)&8191,this.r[2]=(n>>>10|o<<6)&7939,this.r[3]=(o>>>7|i<<9)&8191,this.r[4]=(i>>>4|a<<12)&255,this.r[5]=a>>>1&8190,this.r[6]=(a>>>14|c<<2)&8191,this.r[7]=(c>>>11|u<<5)&8065,this.r[8]=(u>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let f=0;f<8;f++)this.pad[f]=Ue(t,16+2*f)}process(t,r,n=!1){let o=n?0:2048,{h:i,r:a}=this,c=a[0],u=a[1],l=a[2],f=a[3],p=a[4],d=a[5],y=a[6],h=a[7],w=a[8],m=a[9],x=Ue(t,r+0),E=Ue(t,r+2),_=Ue(t,r+4),C=Ue(t,r+6),M=Ue(t,r+8),q=Ue(t,r+10),W=Ue(t,r+12),k=Ue(t,r+14),B=i[0]+(x&8191),O=i[1]+((x>>>13|E<<3)&8191),R=i[2]+((E>>>10|_<<6)&8191),D=i[3]+((_>>>7|C<<9)&8191),v=i[4]+((C>>>4|M<<12)&8191),S=i[5]+(M>>>1&8191),A=i[6]+((M>>>14|q<<2)&8191),P=i[7]+((q>>>11|W<<5)&8191),U=i[8]+((W>>>8|k<<8)&8191),H=i[9]+(k>>>5|o),L=0,N=L+B*c+O*(5*m)+R*(5*w)+D*(5*h)+v*(5*y);L=N>>>13,N&=8191,N+=S*(5*d)+A*(5*p)+P*(5*f)+U*(5*l)+H*(5*u),L+=N>>>13,N&=8191;let K=L+B*u+O*c+R*(5*m)+D*(5*w)+v*(5*h);L=K>>>13,K&=8191,K+=S*(5*y)+A*(5*d)+P*(5*p)+U*(5*f)+H*(5*l),L+=K>>>13,K&=8191;let z=L+B*l+O*u+R*c+D*(5*m)+v*(5*w);L=z>>>13,z&=8191,z+=S*(5*h)+A*(5*y)+P*(5*d)+U*(5*p)+H*(5*f),L+=z>>>13,z&=8191;let se=L+B*f+O*l+R*u+D*c+v*(5*m);L=se>>>13,se&=8191,se+=S*(5*w)+A*(5*h)+P*(5*y)+U*(5*d)+H*(5*p),L+=se>>>13,se&=8191;let ie=L+B*p+O*f+R*l+D*u+v*c;L=ie>>>13,ie&=8191,ie+=S*(5*m)+A*(5*w)+P*(5*h)+U*(5*y)+H*(5*d),L+=ie>>>13,ie&=8191;let J=L+B*d+O*p+R*f+D*l+v*u;L=J>>>13,J&=8191,J+=S*c+A*(5*m)+P*(5*w)+U*(5*h)+H*(5*y),L+=J>>>13,J&=8191;let ue=L+B*y+O*d+R*p+D*f+v*l;L=ue>>>13,ue&=8191,ue+=S*u+A*c+P*(5*m)+U*(5*w)+H*(5*h),L+=ue>>>13,ue&=8191;let he=L+B*h+O*y+R*d+D*p+v*f;L=he>>>13,he&=8191,he+=S*l+A*u+P*c+U*(5*m)+H*(5*w),L+=he>>>13,he&=8191;let be=L+B*w+O*h+R*y+D*d+v*p;L=be>>>13,be&=8191,be+=S*f+A*l+P*u+U*c+H*(5*m),L+=be>>>13,be&=8191;let fe=L+B*m+O*w+R*h+D*y+v*d;L=fe>>>13,fe&=8191,fe+=S*p+A*f+P*l+U*u+H*c,L+=fe>>>13,fe&=8191,L=(L<<2)+L|0,L=L+N|0,N=L&8191,L=L>>>13,K+=L,i[0]=N,i[1]=K,i[2]=z,i[3]=se,i[4]=ie,i[5]=J,i[6]=ue,i[7]=he,i[8]=be,i[9]=fe}finalize(){let{h:t,pad:r}=this,n=new Uint16Array(10),o=t[1]>>>13;t[1]&=8191;for(let c=2;c<10;c++)t[c]+=o,o=t[c]>>>13,t[c]&=8191;t[0]+=o*5,o=t[0]>>>13,t[0]&=8191,t[1]+=o,o=t[1]>>>13,t[1]&=8191,t[2]+=o,n[0]=t[0]+5,o=n[0]>>>13,n[0]&=8191;for(let c=1;c<10;c++)n[c]=t[c]+o,o=n[c]>>>13,n[c]&=8191;n[9]-=8192;let i=(o^1)-1;for(let c=0;c<10;c++)n[c]&=i;i=~i;for(let c=0;c<10;c++)t[c]=t[c]&i|n[c];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let a=t[0]+r[0];t[0]=a&65535;for(let c=1;c<8;c++)a=(t[c]+r[c]|0)+(a>>>16)|0,t[c]=a&65535;(0,Bt.clean)(n)}update(t){(0,Bt.aexists)(this),t=(0,Bt.toBytes)(t),(0,Bt.abytes)(t);let{buffer:r,blockLen:n}=this,o=t.length;for(let i=0;i<o;){let a=Math.min(n-this.pos,o-i);if(a===n){for(;n<=o-i;i+=n)this.process(t,i);continue}r.set(t.subarray(i,i+a),this.pos),this.pos+=a,i+=a,this.pos===n&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){(0,Bt.clean)(this.h,this.r,this.buffer,this.pad)}digestInto(t){(0,Bt.aexists)(this),(0,Bt.aoutput)(t,this),this.finished=!0;let{buffer:r,h:n}=this,{pos:o}=this;if(o){for(r[o++]=1;o<16;o++)r[o]=0;this.process(r,0,!0)}this.finalize();let i=0;for(let a=0;a<8;a++)t[i++]=n[a]>>>0,t[i++]=n[a]>>>8;return t}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}};function hl(e){let t=s((n,o)=>e(o).update((0,Bt.toBytes)(n)).digest(),"hashC"),r=e(new Uint8Array(32));return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=n=>e(n),t}s(hl,"wrapConstructorWithKey");yn.poly1305=hl(e=>new Xs(e))});var bl=ne(Se=>{"use strict";g();b();Object.defineProperty(Se,"__esModule",{value:!0});Se.xchacha20poly1305=Se.chacha20poly1305=Se._poly1305_aead=Se.chacha12=Se.chacha8=Se.xchacha20=Se.chacha20=Se.chacha20orig=void 0;Se.hchacha=gl;var j=dl(),qp=pl(),kt=Xe();function mn(e,t,r,n,o,i=20){let a=e[0],c=e[1],u=e[2],l=e[3],f=t[0],p=t[1],d=t[2],y=t[3],h=t[4],w=t[5],m=t[6],x=t[7],E=o,_=r[0],C=r[1],M=r[2],q=a,W=c,k=u,B=l,O=f,R=p,D=d,v=y,S=h,A=w,P=m,U=x,H=E,L=_,N=C,K=M;for(let se=0;se<i;se+=2)q=q+O|0,H=(0,j.rotl)(H^q,16),S=S+H|0,O=(0,j.rotl)(O^S,12),q=q+O|0,H=(0,j.rotl)(H^q,8),S=S+H|0,O=(0,j.rotl)(O^S,7),W=W+R|0,L=(0,j.rotl)(L^W,16),A=A+L|0,R=(0,j.rotl)(R^A,12),W=W+R|0,L=(0,j.rotl)(L^W,8),A=A+L|0,R=(0,j.rotl)(R^A,7),k=k+D|0,N=(0,j.rotl)(N^k,16),P=P+N|0,D=(0,j.rotl)(D^P,12),k=k+D|0,N=(0,j.rotl)(N^k,8),P=P+N|0,D=(0,j.rotl)(D^P,7),B=B+v|0,K=(0,j.rotl)(K^B,16),U=U+K|0,v=(0,j.rotl)(v^U,12),B=B+v|0,K=(0,j.rotl)(K^B,8),U=U+K|0,v=(0,j.rotl)(v^U,7),q=q+R|0,K=(0,j.rotl)(K^q,16),P=P+K|0,R=(0,j.rotl)(R^P,12),q=q+R|0,K=(0,j.rotl)(K^q,8),P=P+K|0,R=(0,j.rotl)(R^P,7),W=W+D|0,H=(0,j.rotl)(H^W,16),U=U+H|0,D=(0,j.rotl)(D^U,12),W=W+D|0,H=(0,j.rotl)(H^W,8),U=U+H|0,D=(0,j.rotl)(D^U,7),k=k+v|0,L=(0,j.rotl)(L^k,16),S=S+L|0,v=(0,j.rotl)(v^S,12),k=k+v|0,L=(0,j.rotl)(L^k,8),S=S+L|0,v=(0,j.rotl)(v^S,7),B=B+O|0,N=(0,j.rotl)(N^B,16),A=A+N|0,O=(0,j.rotl)(O^A,12),B=B+O|0,N=(0,j.rotl)(N^B,8),A=A+N|0,O=(0,j.rotl)(O^A,7);let z=0;n[z++]=a+q|0,n[z++]=c+W|0,n[z++]=u+k|0,n[z++]=l+B|0,n[z++]=f+O|0,n[z++]=p+R|0,n[z++]=d+D|0,n[z++]=y+v|0,n[z++]=h+S|0,n[z++]=w+A|0,n[z++]=m+P|0,n[z++]=x+U|0,n[z++]=E+H|0,n[z++]=_+L|0,n[z++]=C+N|0,n[z++]=M+K|0}s(mn,"chachaCore");function gl(e,t,r,n){let o=e[0],i=e[1],a=e[2],c=e[3],u=t[0],l=t[1],f=t[2],p=t[3],d=t[4],y=t[5],h=t[6],w=t[7],m=r[0],x=r[1],E=r[2],_=r[3];for(let M=0;M<20;M+=2)o=o+u|0,m=(0,j.rotl)(m^o,16),d=d+m|0,u=(0,j.rotl)(u^d,12),o=o+u|0,m=(0,j.rotl)(m^o,8),d=d+m|0,u=(0,j.rotl)(u^d,7),i=i+l|0,x=(0,j.rotl)(x^i,16),y=y+x|0,l=(0,j.rotl)(l^y,12),i=i+l|0,x=(0,j.rotl)(x^i,8),y=y+x|0,l=(0,j.rotl)(l^y,7),a=a+f|0,E=(0,j.rotl)(E^a,16),h=h+E|0,f=(0,j.rotl)(f^h,12),a=a+f|0,E=(0,j.rotl)(E^a,8),h=h+E|0,f=(0,j.rotl)(f^h,7),c=c+p|0,_=(0,j.rotl)(_^c,16),w=w+_|0,p=(0,j.rotl)(p^w,12),c=c+p|0,_=(0,j.rotl)(_^c,8),w=w+_|0,p=(0,j.rotl)(p^w,7),o=o+l|0,_=(0,j.rotl)(_^o,16),h=h+_|0,l=(0,j.rotl)(l^h,12),o=o+l|0,_=(0,j.rotl)(_^o,8),h=h+_|0,l=(0,j.rotl)(l^h,7),i=i+f|0,m=(0,j.rotl)(m^i,16),w=w+m|0,f=(0,j.rotl)(f^w,12),i=i+f|0,m=(0,j.rotl)(m^i,8),w=w+m|0,f=(0,j.rotl)(f^w,7),a=a+p|0,x=(0,j.rotl)(x^a,16),d=d+x|0,p=(0,j.rotl)(p^d,12),a=a+p|0,x=(0,j.rotl)(x^a,8),d=d+x|0,p=(0,j.rotl)(p^d,7),c=c+u|0,E=(0,j.rotl)(E^c,16),y=y+E|0,u=(0,j.rotl)(u^y,12),c=c+u|0,E=(0,j.rotl)(E^c,8),y=y+E|0,u=(0,j.rotl)(u^y,7);let C=0;n[C++]=o,n[C++]=i,n[C++]=a,n[C++]=c,n[C++]=m,n[C++]=x,n[C++]=E,n[C++]=_}s(gl,"hchacha");Se.chacha20orig=(0,j.createCipher)(mn,{counterRight:!1,counterLength:8,allowShortKeys:!0});Se.chacha20=(0,j.createCipher)(mn,{counterRight:!1,counterLength:4,allowShortKeys:!1});Se.xchacha20=(0,j.createCipher)(mn,{counterRight:!1,counterLength:8,extendNonceFn:gl,allowShortKeys:!1});Se.chacha8=(0,j.createCipher)(mn,{counterRight:!1,counterLength:4,rounds:8});Se.chacha12=(0,j.createCipher)(mn,{counterRight:!1,counterLength:4,rounds:12});var kp=new Uint8Array(16),yl=s((e,t)=>{e.update(t);let r=t.length%16;r&&e.update(kp.subarray(r))},"updatePadded"),Vp=new Uint8Array(32);function ml(e,t,r,n,o){let i=e(t,r,Vp),a=qp.poly1305.create(i);o&&yl(a,o),yl(a,n);let c=(0,kt.u64Lengths)(n.length,o?o.length:0,!0);a.update(c);let u=a.digest();return(0,kt.clean)(i,c),u}s(ml,"computeTag");var Fp=s(e=>(t,r,n)=>({encrypt(i,a){let c=i.length;a=(0,kt.getOutput)(c+16,a,!1),a.set(i);let u=a.subarray(0,-16);e(t,r,u,u,1);let l=ml(e,t,r,u,n);return a.set(l,c),(0,kt.clean)(l),a},decrypt(i,a){a=(0,kt.getOutput)(i.length-16,a,!1);let c=i.subarray(0,-16),u=i.subarray(-16),l=ml(e,t,r,c,n);if(!(0,kt.equalBytes)(u,l))throw new Error("invalid tag");return a.set(i.subarray(0,-16)),e(t,r,a,a,1),(0,kt.clean)(l),a}}),"_poly1305_aead");Se._poly1305_aead=Fp;Se.chacha20poly1305=(0,kt.wrapCipher)({blockSize:64,nonceLength:12,tagLength:16},(0,Se._poly1305_aead)(Se.chacha20));Se.xchacha20poly1305=(0,kt.wrapCipher)({blockSize:64,nonceLength:24,tagLength:16},(0,Se._poly1305_aead)(Se.xchacha20))});var xl=ne(Vr=>{"use strict";g();b();Object.defineProperty(Vr,"__esModule",{value:!0});Vr.chacha20=Vr.xchacha20=void 0;var wl=bl(),jp=s(function(e,t,r){return(0,wl.xchacha20poly1305)(e,t,r)},"xchacha20");Vr.xchacha20=jp;var zp=s(function(e,t,r){return(0,wl.chacha20poly1305)(e,t,r)},"chacha20");Vr.chacha20=zp});var _l=ne(rt=>{"use strict";g();b();Object.defineProperty(rt,"__esModule",{value:!0});rt.aesDecrypt=rt.aesEncrypt=rt.symDecrypt=rt.symEncrypt=void 0;var ei=Xe(),Wp=es(),El=cl(),Gp=xl(),vl=en(),Js=Pn(),$p=s(function(e,t,r){return Sl(Yp,e,t,r)},"symEncrypt");rt.symEncrypt=$p;var Zp=s(function(e,t,r){return Sl(Qp,e,t,r)},"symDecrypt");rt.symDecrypt=Zp;rt.aesEncrypt=rt.symEncrypt;rt.aesDecrypt=rt.symDecrypt;function Sl(e,t,r,n){var o=(0,vl.symmetricAlgorithm)();if(o==="aes-256-gcm")return e(El.aes256gcm,t,r,(0,vl.symmetricNonceLength)(),Js.AEAD_TAG_LENGTH,n);if(o==="xchacha20")return e(Gp.xchacha20,t,r,Js.XCHACHA20_NONCE_LENGTH,Js.AEAD_TAG_LENGTH,n);if(o==="aes-256-cbc")return e(El.aes256cbc,t,r,16,0);throw new Error("Not implemented")}s(Sl,"_exec");function Yp(e,t,r,n,o,i){var a=(0,Wp.randomBytes)(n),c=e(t,a,i),u=c.encrypt(r);if(o===0)return(0,ei.concatBytes)(a,u);var l=u.length-o,f=u.subarray(0,l),p=u.subarray(l);return(0,ei.concatBytes)(a,p,f)}s(Yp,"_encrypt");function Qp(e,t,r,n,o,i){var a=r.subarray(0,n),c=e(t,Uint8Array.from(a),i),u=r.subarray(n);if(o===0)return c.decrypt(u);var l=u.subarray(0,o),f=u.subarray(o);return c.decrypt((0,ei.concatBytes)(f,l))}s(Qp,"_decrypt")});var po=ne(Ct=>{"use strict";g();b();var Xp=Ct&&Ct.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:s(function(){return t[r]},"get")}),Object.defineProperty(e,n,o)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),ho=Ct&&Ct.__exportStar||function(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&Xp(t,e,r)};Object.defineProperty(Ct,"__esModule",{value:!0});ho(Hu(),Ct);ho(Fu(),Ct);ho(ks(),Ct);ho(_l(),Ct)});var ti=ne(mo=>{"use strict";g();b();Object.defineProperty(mo,"__esModule",{value:!0});mo.PublicKey=void 0;var Al=Xe(),yo=po(),Jp=function(){function e(t,r){var n=(0,yo.convertPublicKeyFormat)(t,!0,r),o=(0,yo.convertPublicKeyFormat)(t,!1,r);this.data=n,this.dataUncompressed=n.length!==o.length?o:null}return s(e,"PublicKey"),e.fromHex=function(t,r){return new e((0,yo.hexToPublicKey)(t,r),r)},Object.defineProperty(e.prototype,"_uncompressed",{get:s(function(){return this.dataUncompressed!==null?this.dataUncompressed:this.data},"get"),enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uncompressed",{get:s(function(){return Buffer.from(this._uncompressed)},"get"),enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"compressed",{get:s(function(){return Buffer.from(this.data)},"get"),enumerable:!1,configurable:!0}),e.prototype.toBytes=function(t){return t===void 0&&(t=!0),t?this.data:this._uncompressed},e.prototype.toHex=function(t){return t===void 0&&(t=!0),(0,Al.bytesToHex)(this.toBytes(t))},e.prototype.decapsulate=function(t,r){r===void 0&&(r=!1);var n=this.toBytes(r),o=t.multiply(this,r);return(0,yo.getSharedKey)(n,o)},e.prototype.equals=function(t){return(0,Al.equalBytes)(this.data,t.data)},e}();mo.PublicKey=Jp});var Cl=ne(go=>{"use strict";g();b();Object.defineProperty(go,"__esModule",{value:!0});go.PrivateKey=void 0;var Bl=Xe(),Fr=po(),ey=ti(),ty=function(){function e(t,r){if(this.curve=r,t===void 0)this.data=(0,Fr.getValidSecret)(r);else if((0,Fr.isValidPrivateKey)(t,r))this.data=t;else throw new Error("Invalid private key");this.publicKey=new ey.PublicKey((0,Fr.getPublicKey)(this.data,r),r)}return s(e,"PrivateKey"),e.fromHex=function(t,r){return new e((0,Fr.decodeHex)(t),r)},Object.defineProperty(e.prototype,"secret",{get:s(function(){return Buffer.from(this.data)},"get"),enumerable:!1,configurable:!0}),e.prototype.toHex=function(){return(0,Bl.bytesToHex)(this.data)},e.prototype.encapsulate=function(t,r){r===void 0&&(r=!1);var n=this.publicKey.toBytes(r),o=this.multiply(t,r);return(0,Fr.getSharedKey)(n,o)},e.prototype.multiply=function(t,r){return r===void 0&&(r=!1),(0,Fr.getSharedPoint)(this.data,t.toBytes(!0),r,this.curve)},e.prototype.equals=function(t){return(0,Bl.equalBytes)(this.data,t.data)},e}();go.PrivateKey=ty});var ri=ne(jr=>{"use strict";g();b();Object.defineProperty(jr,"__esModule",{value:!0});jr.PublicKey=jr.PrivateKey=void 0;var ry=Cl();Object.defineProperty(jr,"PrivateKey",{enumerable:!0,get:s(function(){return ry.PrivateKey},"get")});var ny=ti();Object.defineProperty(jr,"PublicKey",{enumerable:!0,get:s(function(){return ny.PublicKey},"get")})});var Tl=ne(nt=>{"use strict";g();b();Object.defineProperty(nt,"__esModule",{value:!0});nt.utils=nt.PublicKey=nt.PrivateKey=nt.ECIES_CONFIG=void 0;nt.encrypt=sy;nt.decrypt=ay;var oy=Xe(),zr=en(),Wr=ri(),Vt=po();function sy(e,t){return Buffer.from(iy(e,t))}s(sy,"encrypt");function iy(e,t){var r=(0,zr.ellipticCurve)(),n=new Wr.PrivateKey(void 0,r),o=e instanceof Uint8Array?new Wr.PublicKey(e,r):Wr.PublicKey.fromHex(e,r),i=n.encapsulate(o,(0,zr.isHkdfKeyCompressed)()),a=n.publicKey.toBytes((0,zr.isEphemeralKeyCompressed)()),c=(0,Vt.symEncrypt)(i,t);return(0,oy.concatBytes)(a,c)}s(iy,"_encrypt");function ay(e,t){return Buffer.from(cy(e,t))}s(ay,"decrypt");function cy(e,t){var r=(0,zr.ellipticCurve)(),n=e instanceof Uint8Array?new Wr.PrivateKey(e,r):Wr.PrivateKey.fromHex(e,r),o=(0,zr.ephemeralKeySize)(),i=new Wr.PublicKey(t.subarray(0,o),r),a=t.subarray(o),c=i.decapsulate(n,(0,zr.isHkdfKeyCompressed)());return(0,Vt.symDecrypt)(c,a)}s(cy,"_decrypt");var uy=en();Object.defineProperty(nt,"ECIES_CONFIG",{enumerable:!0,get:s(function(){return uy.ECIES_CONFIG},"get")});var Il=ri();Object.defineProperty(nt,"PrivateKey",{enumerable:!0,get:s(function(){return Il.PrivateKey},"get")});Object.defineProperty(nt,"PublicKey",{enumerable:!0,get:s(function(){return Il.PublicKey},"get")});nt.utils={aesEncrypt:Vt.aesEncrypt,aesDecrypt:Vt.aesDecrypt,symEncrypt:Vt.symEncrypt,symDecrypt:Vt.symDecrypt,decodeHex:Vt.decodeHex,getValidSecret:Vt.getValidSecret,remove0x:Vt.remove0x}});g();b();g();b();g();b();var $e={};var Pi={...$e,defaultExplorer:"arbiscan",getExplorerUrl:s(function(e){let t;switch(e){case _o.Sepolia:t="sepolia.";break;case _o.Mainnet:default:t=""}return{arbiscan:s((r,n)=>{let o=Array.isArray(n)?n.join("/"):n,i={transaction:"tx",address:"address",token:"token",nft:"nft"}[r];return`https://${t}arbiscan.io/${i}/${o}`},"arbiscan")}},"getExplorerUrl")};g();b();var Ui={...$e,defaultExplorer:"basescan",getExplorerUrl:s(function(e){let t;switch(e){case So.Sepolia:t="sepolia.";break;case So.Mainnet:default:t=""}return{basescan:s((r,n)=>{let o=Array.isArray(n)?n.join("/"):n,i={transaction:"tx",address:"address",token:"token",nft:"nft"}[r];return`https://${t}basescan.org/${i}/${o}`},"basescan")}},"getExplorerUrl")};g();b();var Ri={getExplorerUrl:s(function(){return{mempool:s((e,t)=>`https://mempool.space/${{transaction:"tx",address:"address"}[e]}/${t}`,"mempool")}},"getExplorerUrl"),defaultExplorer:"mempool"};g();b();var Di={...$e,getExplorerUrl(e){let t;switch(e){case Eo.Sepolia:t="sepolia.";break;case Eo.Mainnet:default:t=""}return{etherscan:s((r,n)=>{let o=Array.isArray(n)?n.join("/"):n,i={transaction:"tx",address:"address",token:"token",nft:"nft"}[r];return`https://${t}etherscan.io/${i}/${o}`},"etherscan")}},defaultExplorer:"etherscan"};g();b();var Ni={...$e,defaultExplorer:"hyperliquid",getExplorerUrl:s(function(e){let t;switch(e){case Co.Testnet:t="app.hyperliquid-testnet.xyz";break;case Co.Mainnet:default:t="app.hyperliquid.xyz"}return{hyperliquid:s((r,n)=>{let o=Array.isArray(n)?n.join("/"):n,i={transaction:"tx",address:"address"}[r];return`https://${t}/explorer/${i}/${o}`},"hyperliquid")}},"getExplorerUrl")};g();b();var Hi={...$e,defaultExplorer:"hyperevmscan",getExplorerUrl:s(function(e){return{hyperevmscan:s((t,r)=>{let n=Array.isArray(r)?r.join("/"):r;return`https://hyperevmscan.io/${{transaction:"tx",address:"address"}[t]}/${n}`},"hyperevmscan")}},"getExplorerUrl"),betaTagOverride:"Lite"};g();b();var Mi={...$e,getExplorerUrl:s(function(e){let t;switch(e){case Ao.Testnet:t="testnet.monadvision.com";break;case Ao.Mainnet:t="monadvision.com";break}return{monadexplorer:s((r,n)=>{let o=Array.isArray(n)?n.join("/"):n,i={transaction:"tx",address:"address",token:"token",nft:"nft"}[r];return`https://${t}/${i}/${o}`},"monadexplorer")}},"getExplorerUrl"),defaultExplorer:"monadexplorer",betaTagOverride:"Beta"};g();b();var Ki={...$e,getExplorerUrl:s(function(e){let t;switch(e){case vo.Amoy:t="amoy.";break;case vo.Mainnet:default:t=""}return{polygonscan:s((r,n)=>{let o=Array.isArray(n)?n.join("/"):n,i={transaction:"tx",address:"address",token:"token",nft:"nft"}[r];return`https://${t}polygonscan.com/${i}/${o}`},"polygonscan")}},"getExplorerUrl"),defaultExplorer:"polygonscan"};g();b();var qi={getExplorerUrl:s(function(e){let t;switch(e){case br.Devnet:t="devnet";break;case br.Testnet:t="testnet";break;case br.Mainnet:t="mainnet-beta";break;case br.Localnet:t="mainnet-beta";break}let r="";return["devnet","testnet"].includes(t)&&(r=`?cluster=${t}`),{"solana-beach":s((n,o)=>`https://solanabeach.io/${n}/${o}${r}`,"solana-beach"),solscan:s((n,o)=>`https://solscan.io/${{transaction:"tx",address:"account"}[n]}/${o}${r}`,"solscan"),"solana-explorer":s((n,o)=>`https://explorer.solana.com/${n}/${o}${r}`,"solana-explorer"),"solana-fm":s((n,o)=>{let i={"mainnet-beta":"mainnet-qn1",testnet:"testnet-solana",devnet:"devnet-solana",localhost:"localhost"}[t];return`https://solana.fm/${{transaction:"tx",address:"address"}[n]}/${o}?cluster=${i}`},"solana-fm"),xray:s((n,o)=>`https://xray.helius.xyz/${{transaction:"tx",address:"token"}[n]}/${o}${r}`,"xray"),orb:s((n,o)=>`https://orb.helius.dev/${{transaction:"tx",address:"address"}[n]}/${o}${r}`,"orb")}},"getExplorerUrl"),defaultExplorer:"orb"};g();b();var ki={getExplorerUrl:s(function(e){return{suiscan:s((t,r)=>{let n;switch(e){case Yr.Testnet:n="testnet";break;case Yr.Mainnet:n="mainnet";break}let o={transaction:"tx",address:"account",token:"coin",nft:"object"}[t];return`https://suiscan.xyz/${n}/${o}/${r}`},"suiscan"),suivision:s((t,r)=>{let n;switch(e){case Yr.Testnet:n="testnet.";break;case Yr.Mainnet:n="";break}let o={transaction:"txblock",address:"account",token:"coin",nft:"object"}[t];return`https://${n}suivision.xyz/${o}/${r}`},"suivision")}},"getExplorerUrl"),defaultExplorer:"suivision"};var Fl=new yi({[it.Solana]:qi,[it.Ethereum]:Di,[it.Polygon]:Ki,[it.Monad]:Mi,[it.Base]:Ui,[it.Arbitrum]:Pi,[it.Bitcoin]:Ri,[it.Sui]:ki,[it.Hypercore]:Ni,[it.Hyperevm]:Hi}),Ft=pi(Fl);g();b();g();b();g();b();g();b();var vr=[{value:"en",displayValue:"English",isLocale:!1},{value:"es",displayValue:"Espa\xF1ol",isLocale:!1},{value:"de",displayValue:"Deutsch",isLocale:!1},{value:"fr",displayValue:"Fran\xE7ais",isLocale:!1},{value:"it",displayValue:"Italiano",isLocale:!1},{value:"zh-CN",displayValue:"\u4E2D\u6587(\u7B80\u4F53)",isLocale:!0},{value:"zh-TW",displayValue:"\u4E2D\u6587(\u7E41\u9AD4)",isLocale:!0},{value:"bn",displayValue:"\u09AC\u09BE\u0982\u09B2\u09BE",isLocale:!1},{value:"ja",displayValue:"\u65E5\u672C",isLocale:!1},{value:"ko",displayValue:"\uD55C\uAD6D\uC5B4",isLocale:!1},{value:"ru",displayValue:"P\u0443\u0441\u0441\u043A\u0438\u0439",isLocale:!1},{value:"hi",displayValue:"\u0939\u093F\u0902\u0926\u0940",isLocale:!1},{value:"id",displayValue:"Indonesia",isLocale:!1},{value:"ms",displayValue:"Melayu",isLocale:!1},{value:"th",displayValue:"\u0E44\u0E17\u0E22",isLocale:!1},{value:"vi",displayValue:"Ti\u1EBFng Vi\u1EC7t",isLocale:!1},{value:"pt",displayValue:"Portugu\xEAs",isLocale:!1},{value:"tr",displayValue:"T\xFCrk\xE7e",isLocale:!1},{value:"fil",displayValue:"Filipino",isLocale:!1},{value:"my",displayValue:"\u1019\u103C\u1014\u103A\u1019\u102C\u1018\u102C\u101E\u102C",isLocale:!1},{value:"am",displayValue:"\u12A0\u121B\u122D\u129B",isLocale:!1},{value:"ar",displayValue:"\u0627\u0644\u0639\u0631\u0628\u064A\u0629",isLocale:!1},{value:"gu",displayValue:"\u0A97\u0AC1\u0A9C\u0AB0\u0ABE\u0AA4\u0AC0",isLocale:!1},{value:"ha",displayValue:"Hausa",isLocale:!1},{value:"ig",displayValue:"\xC1s\u1EE5\u0300s\u1EE5\u0301 \xCCgb\xF2",isLocale:!1},{value:"pa",displayValue:"\u0A2A\u0A70\u0A1C\u0A3E\u0A2C\u0A40",isLocale:!1},{value:"sw",displayValue:"Kiswahili",isLocale:!1},{value:"ta",displayValue:"\u0BA4\u0BAE\u0BBF\u0BB4\u0BCD",isLocale:!1},{value:"te",displayValue:"\u0C24\u0C46\u0C32\u0C41\u0C17\u0C41",isLocale:!1},{value:"yo",displayValue:"\xC8d\xE8 Yor\xF9b\xE1",isLocale:!1}];g();b();var Vi=s(()=>{let e=[];return vr.forEach(t=>{e.push(t.value),t.isLocale&&e.push(t.value.substr(0,2))}),[...new Set(e)]},"generateSupportedLanguageValues"),Sn=s((e,t)=>e.substr(0,3)==="fil"?t==="fil":e.substr(0,2)==="zh"?e==="zh-TW"?t==="zh-TW":t==="zh-CN":t===e.substr(0,2),"languageMatches"),Fi=s(e=>vr.find(t=>Sn(e,t.value))?.displayValue,"languageDisplayValue"),ji=s(e=>vr.find(t=>Sn(e,t.value))?.value,"getSupportedLanguageValue");var lg=15,_n={version:1,addresses:[]},An={version:1,addresses:[]},zi=20,jl=s(()=>{let e={};return Me.getAllNetworkIDs().forEach(t=>{let r=Ft.get(t).defaultExplorer;r&&(e[t]=r)}),e},"getDefaultExplorers"),Oo={version:1,explorers:jl()},Wi={orb:"Orb","solana-beach":"Solana Beach",solscan:"Solscan","solana-explorer":"Solana Explorer","solana-fm":"Solana FM",xray:"XRAY",etherscan:"Etherscan",basescan:"Basescan",arbiscan:"Arbiscan",polygonscan:"Polygonscan",mempool:"Mempool",suivision:"SuiVision",suiscan:"Suiscan",monadexplorer:"Monad Explorer",hyperliquid:"Hyperliquid Explorer",hyperevmscan:"HyperEVMScan"},Gi={version:1,apps:{}};var zl={default:"",light:"1f3fb",medium_light:"1f3fc",medium:"1f3fd",medium_dark:"1f3fe",dark:"1f3ff"},fg={"":"","1f3fb":"\u{1F3FB}","1f3fc":"\u{1F3FC}","1f3fd":"\u{1F3FD}","1f3fe":"\u{1F3FE}","1f3ff":"\u{1F3FF}"},dg={version:1,skinTone:zl.default},$i=di,Zi=!0,Yi=vn({minutes:15}),Sr=7200;g();b();var _e;(function(e){e.ApiEnvironment="apiEnvironment",e.EmojiSkinTone="emojiSkinTone",e.IsAnalyticsOptedOut="isAnalyticsOptedOut",e.SolanaActionsEnabled="solanaActionsEnabled",e.ShowWalletShortcuts="showWalletShortcuts",e.SelectedCurrency="selectedCurrency",e.SavedAddresses="savedAddresses",e.RecentAddressesBrowser="recentAddresses",e.RecentAddressesMobile="recentAddressesV2"})(_e||(_e={}));g();b();var Bn=s(({networkID:e,endpoint:t,param:r,explorerType:n})=>{let i=Ft.get(e).getExplorerUrl(e)[n??Ft.get(e).defaultExplorer];return i?i(t,r):""},"generateExplorerUrl"),Qi=s(e=>{if(!e)return;let{explorers:t}=e,r={};return Me.getAllNetworkIDs().forEach(o=>{let i=Me.getNetworkName(o),a=t[o];r[i]=a}),{...e,explorers:r}},"formatExplorers");g();b();g();b();var Wl=s(e=>{switch(e){case xr.PrivateKey:return wr.t("removeAccountWarningPrivateKey");case xr.Seed:return wr.t("removeAccountWarningSeed");case xr.Ledger:return wr.t("removeAccountWarningLedger");case xr.SeedVault:return wr.t("removeAccountWarningSeedVault");case xr.ReadOnly:return wr.t("removeAccountWarningReadOnly")}},"getAccountRemovalWarning");g();b();var Gl=s((e,t)=>e.filter(n=>typeof n.title=="string"&&Xi(t,n.title)||Xi(t,n.tags?.join(" "))),"filterSearchSettings"),Xi=s((e,t)=>{if(t===void 0)return!1;let r=e.toLowerCase();return t.toLowerCase().split(" ").map(n=>n.startsWith(r)||r.startsWith(n)&&t.toLowerCase().includes(r)).includes(!0)},"filterByWordPrefix");g();b();async function $l(e){for(let t of e){let r=await t.get(vi.NetworkSetting);if(r)return r.setting}return Si().setting}s($l,"getNetworkSetting");g();b();g();b();g();b();var Zl="currency",Yl="currencyExchangeRates",Cn={currencyExchangeRates:s(()=>[Zl,Yl,bn],"currencyExchangeRates")};var Ql=s(e=>e.queryKey[1]===Cn.currencyExchangeRates()[1]&&e.queryKey[2]===bn,"currencyShouldDehydrateQueryPredicate");g();b();g();b();var Xl="/currency_exchange/v1/rates",Ji=s(async()=>{let e=await mr.api().get(`${Xl}?from=USD&currencies=${Object.keys(Lt).join(",")}`);if(!gr(e))throw new Error("Failed to fetch exchange rates");return await e.data},"getCurrencyExchangeRates");var Jl=vn({hours:2}),c1=s(e=>oe({queryKey:Cn.currencyExchangeRates(),queryFn:Ji,enabled:!!e,staleTime:Jl,select(t){return e?t?.rates[e]:1}}),"useCurrencyExchangeRates");g();b();var ef=s(()=>{try{let e=bi.getMultivariateAssignment("auto-confirm-session-duration"),t=Number(e);if(!isNaN(t)&&t>0)return t}catch{}return Sr},"getMaxSessionDuration");g();b();g();b();var Re="@phantom/settings",ee={appPermissions(e,...t){return[`${Re}:app-permissions`,e,...t]},emojiSkinTone(){return[`${Re}:emoji-skin-tone`]},isAnalyticsOptedOut(){return[`${Re}:is-analytics-opted-out`]},solanaActionsEnabled(){return[`${Re}:solana-actions-enabled`]},showWalletShortcuts(){return[`${Re}:show-wallet-shortcuts`]},preferredExplorers(){return[`${Re}:preferred-explorers`]},recentAddresses(){return[`${Re}:recent-addresses`]},savedAddresses(){return[`${Re}:saved-addresses`]},trustedApps(){return[`${Re}:trusted-apps`]},metaMaskOverride(){return[`${Re}:metamask-override`]},autoConfirm(e,t){return[Re,"auto-confirm",e,t]},allAutoConfirm(e){return[Re,"auto-confirm",e]},allAutoConfirmOnAllAccounts(){return[Re,"auto-confirm"]},autoConfirmLocalhost(){return[Re,"auto-confirm","auto-confirm-localhost:v1"]},webViewDebugging(){return[`${Re}:enable-webview-debugging:v1`]},selectedCurrency(){return[`${Re}:selected-currency`]}};var Po=V.enum(["ALWAYS_ASK","USE_PHANTOM","USE_METAMASK"]),ea="metaMaskOverride";async function ta(e){let t=await e.get(ea),r=Po.safeParse(t);return r.success?r.data:Po.enum.ALWAYS_ASK}s(ta,"getMetaMaskOverrideSetting");function tf(){let e=pe();return oe({queryKey:ee.metaMaskOverride(),refetchOnMount:"always",async queryFn(){return ta(e)}})}s(tf,"useMultiChainMetaMaskOverrideSetting");function rf(){let e=pe(),t=le(),r=et();return ae({async mutationFn(n){await ra(e,n),r.capture("metamaskOverrideSettingsChanged",{data:{setting:n}})},async onSuccess(){await t.invalidateQueries({queryKey:ee.metaMaskOverride()})}})}s(rf,"useSetMultiChainMetaMaskOverrideSetting");async function ra(e,t){await e.set(ea,t)}s(ra,"setMetaMaskOverrideSetting");g();b();var nf=s(async e=>{if(!xo)return;let t=await e.get(_e.ApiEnvironment);t&&gn(t)},"loadAPIEnvironment"),of=s(()=>{let e=pe();return oe({queryKey:["settings:apiEnvironment"],queryFn:s(async()=>{let t=await e.get(_e.ApiEnvironment);return t?(gn(t),t):null},"queryFn"),enabled:xo})},"useAPIEnvironment"),sf=s(()=>{let e=pe(),t=Bi(),r=le();return ae({mutationFn:s(async n=>{await e.set(_e.ApiEnvironment,n),gn(n),await af(t,r),await cf(r)},"mutationFn")})},"useSetApiEnvironment");async function af(e,t){await e.logOut(),await Promise.all([_i(t),Ti(t)]),await Promise.all([Ai(t),Li(t)])}s(af,"invalidateAuth");async function cf(e){await e.invalidateQueries({queryKey:["settings:apiEnvironment"]})}s(cf,"invalidateAPIEnvironment");g();b();function uf(e){return _r(t=>{let r=t.explorers[e]??Ft.get(e).defaultExplorer;return Wi[r]})}s(uf,"usePreferredExplorerNameForNetworkId");function lf(e,t){return _r(r=>{let n=r.explorers[e];return Bn({networkID:e,endpoint:"address",explorerType:n,param:t})})}s(lf,"useAddressPreferredExplorerUrl");function ff(e){return _r(t=>{if(!e)return"";let r=e.networkID,n=t.explorers[r];return Bn({networkID:r,endpoint:"transaction",explorerType:n,param:e.id})})}s(ff,"useTransactionPreferredExplorerUrl");function _r(e){let t=Ke(),r=ee.preferredExplorers();return oe({queryKey:r,queryFn:s(async()=>{let o=await t.get(me.UserExplorerPreferenceV2);return o?{version:o.version,explorers:{...Oo.explorers,...o.explorers}}:Oo},"queryFn"),select:e})}s(_r,"usePreferredExplorers");function df(){let e=Ke(),t=le();return ae({mutationFn:s(async({preferredExplorers:o})=>{await e.set(me.UserExplorerPreferenceV2,o)},"mutationFn"),onSuccess:s(()=>{t.invalidateQueries({queryKey:ee.preferredExplorers()})},"onSuccess")})}s(df,"useSetPreferredExplorers");g();b();var na=s(async(e,t)=>{let r=await e.get(_e.SolanaActionsEnabled);return r===null?t??!1:r},"checkSolanaActionsEnabled");function hf(e=!1){let t=pe(),r=ee.solanaActionsEnabled();return oe({queryKey:r,queryFn:s(async()=>na(t,e),"queryFn")})}s(hf,"useSolanaActionsEnabled");function pf(){let e=pe(),t=le();return ae({mutationFn:s(async({enabled:o})=>{await e.set(_e.SolanaActionsEnabled,o)},"mutationFn"),onSuccess:s(()=>{t.invalidateQueries({queryKey:ee.solanaActionsEnabled()})},"onSuccess")})}s(pf,"useSetSolanaActionsEnabled");g();b();var la=ot(rr());g();b();function oa(){let{isReady:e,value:t}=Lo(),r=Ke(),n=ee.recentAddresses();return oe({enabled:e,queryKey:n,queryFn:s(async()=>{let i=await r.get(me.UserRecentAddresses);if(!t)throw new Error(To);let a=t.enabledChainIDs;return i?ia(i,a):_n},"queryFn")})}s(oa,"useRecentAddresses");function sa(){let{isReady:e,value:t}=Lo(),r=Ke(),n=ee.savedAddresses();return oe({enabled:e,queryKey:n,queryFn:s(async()=>{let i=await r.get(me.UserSavedAddresses);if(!t)throw new Error(To);let a=t.enabledChainIDs;return i?ia(i,a):An},"queryFn")})}s(sa,"useSavedAddresses");var ia=s((e,t)=>({...e,addresses:e.addresses.filter(r=>t.includes(Me.getChainID(r.chainID)))}),"filterAddressesByChain");function Ob(){return(e,t)=>{if(t==null)return e;if(e==null)return t;let r=e.addresses,n=t.addresses,o=new Map;r.forEach(a=>{o.set(a.address,a)}),n.forEach(a=>{o.set(a.address,a)});let i=Array.from(o.values());return{...e,addresses:i}}}s(Ob,"syncedAddressBookResolver");g();b();function aa(){let e=Ke(),t=le();return ae({mutationFn:s(async({recentAddresses:o})=>{await e.set(me.UserRecentAddresses,o)},"mutationFn"),onSuccess:s(()=>{t.invalidateQueries({queryKey:ee.recentAddresses()})},"onSuccess")})}s(aa,"useSetRecentAddresses");function ca(){let e=Ke(),t=le();return ae({mutationFn:s(async({savedAddresses:o})=>{await e.set(me.UserSavedAddresses,o)},"mutationFn"),onSuccess:s(()=>{t.invalidateQueries({queryKey:ee.savedAddresses()})},"onSuccess")})}s(ca,"useSetSavedAddresses");var yf=s(()=>{let{data:e=[]}=Ii(),{data:t=_n}=oa(),{data:r=An}=sa(),{mutate:n}=aa(),{mutate:o}=ca();return(0,la.useMemo)(()=>({recentAddresses:t,savedAddresses:r,addRecentAddress:s(({address:i,chainID:a,timestamp:c=Date.now()})=>bf(e,t,r,n,{address:i,chainID:a,timestamp:c}),"addRecentAddress"),addSavedAddress:s(i=>wf(e,t,r,n,o,i),"addSavedAddress"),editSavedAddress:s((i,a)=>xf(r,o,i,a),"editSavedAddress"),getExistingAccount:s(i=>gf(e,i),"getExistingAccount"),getSavedAddressLabel:s((i,a)=>ua(r.addresses,i,a),"getSavedAddressLabel"),getKnownAddressLabel:s((i,a)=>ua([r.addresses,mf(e)].flat(),i,a),"getKnownAddressLabel"),isExistingAccountAddress:s(i=>Uo(e,i),"isExistingAccountAddress"),isRecentAddress:s((i,a)=>fa(t,i,a),"isRecentAddress"),isSavedAddress:s((i,a)=>Ro(r,i,a),"isSavedAddress"),removeRecentAddress:s(i=>da(t,n,i),"removeRecentAddress"),removeSavedAddress:s(i=>Ef(r,o,i),"removeSavedAddress")}),[e,t,r,n,o])},"useAddressBook"),mf=s(e=>{let t=[];for(let r of e)t.push(...r.addresses.map(({address:n,networkID:o})=>({address:n,chainID:o,label:r.name})));return t},"getWalletAddresses"),gf=s((e,t)=>e[pa(e,t)],"getExistingAccount"),Uo=s((e,t)=>pa(e,t)>-1,"isExistingAccountAddress"),fa=s((e,t,r)=>Ar(e.addresses,{address:t,chainID:r})>-1,"isRecentAddress"),Ro=s((e,t,r)=>Ar(e.addresses,{address:t,chainID:r})>-1,"isSavedAddress"),bf=s((e,t,r,n,{address:o,chainID:i,timestamp:a=Date.now()})=>{if(Uo(e,o)||Ro(r,o,i)||fa(t,o,i))return;t.addresses.unshift({address:o,chainID:i,timestamp:a});let{addresses:c}=t;return t.addresses=c.slice(0,zi),n({recentAddresses:t}),t},"addRecentAddress"),wf=s((e,t,r,n,o,i)=>{let{address:a,chainID:c}=i;if(Uo(e,a)||Ro(r,a,c))return;da(t,n,{address:a,chainID:c,timestamp:0});let u={...r,addresses:[...r.addresses,i]};return o({savedAddresses:u}),u},"addSavedAddress"),xf=s((e,t,r,n)=>{let o=Ar(e.addresses,r);if(o<0)return;let i=[...e.addresses];i[o]=n;let a={...e,addresses:i};return t({savedAddresses:a}),a},"editSavedAddress"),da=s((e,t,r)=>{let n=Ar(e.addresses,r);if(n<0)return;let o=[...e.addresses];o.splice(n,1);let i={...e,addresses:o};return t({recentAddresses:i}),i},"removeRecentAddress"),Ef=s((e,t,r)=>{let n=Ar(e.addresses,r);if(n<0)return;let o=[...e.addresses];o.splice(n,1);let i={...e,addresses:o};return t({savedAddresses:i}),i},"removeSavedAddress"),ua=s((e,t,r)=>{let n=Ar(e,{address:t,chainID:r});if(!(n<0))return e[n].label},"getAddressLabel"),ha=s((e,t,r)=>Me.isEVMNetworkID(r)?e.toLowerCase()===t.toLowerCase():e===t,"compareAddresses"),pa=s((e,t)=>e.findIndex(r=>r.addresses.find(n=>ha(n.address,t,n.networkID))),"getAccountIndex"),Ar=s((e,t)=>e.findIndex(r=>{let n=t.chainID===r.chainID,o=ha(t.address,r.address,t.chainID);return n&&o}),"getEntryIndex");g();b();g();b();var ya=vf;function vf(e){var t,r,n;if(e){if(Array.isArray(e)){for(t=[],r=e.length,n=0;n<r;n++){var o=e[n];o!=null&&t.push(o)}return t}if(typeof e=="object"){t={};var i=Object.keys(e);for(r=i.length,n=0;n<r;n++){var a=i[n],c=e[a];c!=null&&(t[a]=c)}return t}}}s(vf,"flush");var wa=ot(Do());g();b();var Sf=V.object({chainType:V.union([V.literal("bip122_p2wpkh"),V.literal("bip122_p2tr")]),chainName:V.literal("bitcoin"),networkId:V.union([V.literal("128"),V.literal("239")])}),_f=V.object({chainType:V.literal("eip155"),chainName:V.literal("ethereum"),networkId:V.union([V.literal("1"),V.literal("5"),V.literal("11155111")])}),Af=V.object({chainType:V.literal("eip155"),chainName:V.literal("polygon"),networkId:V.union([V.literal("137"),V.literal("80002")])}),Bf=V.object({chainType:V.literal("eip155"),chainName:V.literal("base"),networkId:V.union([V.literal("8453"),V.literal("84532")])}),Cf=V.object({chainType:V.literal("eip155"),chainName:V.literal("arbitrum"),networkId:V.union([V.literal("42161"),V.literal("421614")])}),If=V.object({chainType:V.literal("eip155"),chainName:V.literal("hyperevm"),networkId:V.union([V.literal("999"),V.literal("998")])}),Tf=V.object({chainType:V.literal("eip155"),chainName:V.literal("monad"),networkId:V.union([V.literal("143"),V.literal("10143"),V.literal("41454")])}),ga=V.object({chainType:V.literal("solana"),chainName:V.literal("solana"),networkId:V.union([V.literal("mainnet"),V.literal("testnet"),V.literal("devnet"),V.literal("localnet")])}),Lf=V.object({chainType:V.literal("sui"),chainName:V.literal("sui"),networkId:V.union([V.literal("mainnet"),V.literal("testnet")])}),ba=V.union([Sf,_f,Bf,Cf,If,Tf,Af,ga,Lf]);var No=s(()=>["t","y","1","true","yes"].some(e=>I.DISABLE_ANALYTICS?.toLowerCase()===e)??!1,"isAnalyticsDisabled");function Ho(e){if(!e)return;let t=e.data??{},r=e.data?.asset??{};try{t=JSON.parse(JSON.stringify(t)),r=JSON.parse(JSON.stringify(r))}catch(o){wa.default.error("Failed to parse analytics payload",o);return}let n={...t,...e.action?{action:e.action}:{},...r&&typeof r=="object"?r:{},...e.type?{type:e.type}:{}};if("chainID"in n&&!("chainType"in n)&&!("chainName"in n)&&!("networkId"in n)){let o=wn.safeParse(n.chainID);o.success&&Object.assign(n,xa(o.data))}return ya(n)}s(Ho,"parseAnalyticsPayload");function xa(e){let t=Me.getChainDefinition(e);return ba.parse({chainType:t.addressTypes[0],chainName:t.id,networkId:t.networks[e].value.toString()})}s(xa,"chainFromNetworkID");g();b();g();b();var Mo=I.RUDDERSTACK_DATAPLANE??I.VITE_RUDDERSTACK_DATAPLANE??"https://data.phantom.app",Of=I.RUDDERSTACK_KEY_EXT,Pf=I.RUDDERSTACK_KEY_WEB,Uf=I.RUDDERSTACK_KEY_PORTAL;g();b();function Xr(e,{action:t,data:r}){let n={action:t,data:r};return e.capture("actionApprovedByUser",n)}s(Xr,"actionApprovedByUser");function Jr(e,{action:t,data:r}){let n={action:t,data:{...r,chainId:r.chainId??r.networkId}};return e.capture("actionDeniedByUser",n)}s(Jr,"actionDeniedByUser");function Ko(e,{action:t,data:r}){let n={type:"transaction",data:{...r,chainId:r.chainId??r.networkId},action:t};return(!n.data.ids||n.data.ids.length===0)&&Ge.captureError(new Error("No ids found in transactionSubmitted payload"),We.Provider),e.capture("transactionSubmitted",n)}s(Ko,"transactionSubmitted");function Rf(e,{action:t,data:r}){let n={data:{...r,chainId:r.chainId??r.networkId},action:t};return e.capture("transactionStatus",n)}s(Rf,"transactionStatus");function qo(e,t){let r={type:"message",data:{...t,chainId:t.chainId??t.networkId}};return e.capture("transactionSubmitted",r)}s(qo,"messageSigned");var Ot=class{static{s(this,"SequenceAnalytics")}analytics;action;constructor(t,r){this.analytics=t,this.action=r}approved=s(t=>{Xr(this.analytics,{action:this.action,data:{...t,chainId:t.chainId??t.networkId}})},"approved");denied=s(async t=>{Jr(this.analytics,{action:this.action,data:{...t,chainId:t.chainId??t.networkId}})},"denied");submittedTransaction=s(async(t,r)=>{Ko(this.analytics,{action:this.action,data:{...r,ids:r.ids??[t],chainId:r.chainId??r.networkId}})},"submittedTransaction");signedMessage=s(async t=>{qo(this.analytics,{...t,chainId:t.chainId??t.networkId})},"signedMessage");transactionStatus=s(async(t,r)=>{r.ids||(r.ids=[t]),Rf(this.analytics,{action:this.action,data:{...r,chainId:r.chainId??r.networkId}})},"transactionStatus")};async function Ea(e,t,r){let{origin:n}=t;switch(e.method){case"eth_sendTransaction":{let[o]=e.params,i=st(o.chainId);return i?.chainType!=="eip155"?{success:!1,error:`Unsupported Ethereum chain ID (${o.chainId}) for method "${e.method}"`}:{success:!0,data:{...i,origin:n,method:e.method,gas:o.gas,maxFeePerGas:o.maxFeePerGas,maxPriorityFeePerGas:o.maxPriorityFeePerGas,ids:r}}}case"sol_signTransaction":{let o=st(t.chainId);return o?.chainType!=="solana"?{success:!1,error:`Unsupported Solana chain ID (${t.chainId}) for method "${e.method}"`}:{success:!0,data:{...o,origin:n,method:"signTransaction",ids:r}}}case"sol_signAndSendTransaction":{let o=st(t.chainId);return o?.chainType!=="solana"?{success:!1,error:`Unsupported Solana chain ID (${t.chainId}) for method "${e.method}"`}:{success:!0,data:{...o,origin:n,method:"signAndSendTransaction",ids:r}}}case"sol_signAndSendAllTransactions":{let o=st(t.chainId);return o?.chainType!=="solana"?{success:!1,error:`Unsupported Solana chain ID (${t.chainId}) for method "${e.method}"`}:{success:!0,data:{...o,origin:n,method:"signAndSendAllTransactions",ids:r}}}case"sol_signAllTransactions":{let o=st(t.chainId);return o?.chainType!=="solana"?{success:!1,error:`Unsupported Solana chain ID (${t.chainId}) for method "${e.method}"`}:{success:!0,data:{...o,origin:n,method:"signAllTransactions",ids:r}}}}}s(Ea,"transactionSignatureEventPayloadFromRpcRequest");async function va(e,t){let{origin:r}=t;switch(e.method){case"eth_sign":case"personal_sign":{let n=t.chainId,o=st(n);return o?.chainType!=="eip155"?{success:!1,error:`Unsupported Ethereum chain ID (${n}) for method "${e.method}"`}:{success:!0,data:{...o,method:e.method,origin:r}}}case"eth_signTypedData":{let[n]=e.params,o=t.chainId;for(let a of n)if(a.name==="chainId"){o=a.value;break}let i=st(o);return i?.chainType!=="eip155"?{success:!1,error:`Unsupported Ethereum chain ID (${o}) for method "${e.method}"`}:{success:!0,data:{...i,method:e.method,origin:r}}}case"eth_signTypedData_v3":{let[n,o]=e.params,i=o.domain.chainId??t.chainId,a=st(i);return a?.chainType!=="eip155"?{success:!1,error:`Unsupported Ethereum chain ID (${i}) for method "${e.method}"`}:{success:!0,data:{...a,method:e.method,origin:r}}}case"eth_signTypedData_v4":{let[n,o]=e.params,i=t.chainId;(typeof o.domain.chainId=="string"||typeof o.domain.chainId=="number")&&(i=o.domain.chainId);let a=st(i);return a?.chainType!=="eip155"?{success:!1,error:`Unsupported Ethereum chain ID (${i}) for method "${e.method}"`}:{success:!0,data:{...a,method:e.method,origin:r}}}case"sol_signIn":case"sol_signMessage":{let n=t.chainId,o=st(n);return o?.chainType!=="solana"?{success:!1,error:`Unsupported Solana chain ID (${n}) for method "${e.method}"`}:{success:!0,data:{...o,method:e.method==="sol_signIn"?"signIn":"signMessage",origin:r}}}}}s(va,"messageSignatureEventPayloadFromRpcRequest");g();b();g();b();var Pt=ot(Do());var jt="[Analytics Log]",Tn=class{static{s(this,"MockAnalytics")}storage;constructor(t){this.storage=t}async capture(t,r){Pt.default.debug(jt,"Capture Event:",t,Ho(r))}async addUserProperties(t){Pt.default.debug(jt,"User Properties:",JSON.stringify(t))}async identify(t,r){Pt.default.debug(jt,"Identify, id:",t," traits:",r)}async getDeviceId(){return"mock-device-id"}setDeviceId(t){Pt.default.debug(jt,`SetDeviceId: ${t}`)}async getAnonymousId(){return"mock-anonymous-id"}async setAnalyticsOptedOut(t){Pt.default.debug(jt,`SetAnalyticsOptedOut: ${t}`)}async setDisplayLanguage(t){Pt.default.debug(jt,`SetDisplayLanguage: ${t}`)}screen(t,r){Pt.default.debug(jt,`Screen: ${t}`,r)}page(t,r,n,o){Pt.default.debug(jt,`Page: ${t}`,r,n,o)}rudderClient};var Sa=s(()=>Mo,"getRudderstackDataplane"),Df=s(({storage:e,rudderStackKey:t,createAnalytics:r})=>{if(!t)throw new Error("RUDDERSTACK_KEY_[*] env variables required.");let n=Sa();if(!n)throw new Error("[*]_RUDDERSTACK_DATAPLANE env variables required.");return No()?new Tn(e):r(t,n)},"initAnalytics");g();b();g();b();var Nf="burn",_a=s(e=>new Ot(e,Nf),"createBurnAnalytics");g();b();var Hf="send",Aa=s(e=>new Ot(e,Hf),"createSendAnalytics");var ko={};kl(ko,{action:()=>Ln,createDappAnalytics:()=>Mf,userApprovedAction:()=>Kf,userDeniedAction:()=>qf});g();b();var Ln="dapp",Mf=s(e=>new Ot(e,Ln),"createDappAnalytics");async function Kf(e,t){return await Xr(e,{action:Ln,data:{...t,chainId:t.networkId}})}s(Kf,"userApprovedAction");async function qf(e,t){return await Jr(e,{action:Ln,data:{...t,chainId:t.networkId}})}s(qf,"userDeniedAction");var kf=s(e=>({send:Aa(e),burn:_a(e)}),"createSequenceAnalytics");g();b();async function zt(){}s(zt,"noOp");var Vf=s(()=>({capture:zt,addUserProperties:zt,identify:zt,getDeviceId:s(async()=>"","getDeviceId"),setDeviceId:zt,setAnalyticsOptedOut:zt,setDisplayLanguage:zt,screen:zt,page:zt,rudderClient:{}}),"createNoOpAnalytics");g();b();var Br=ot(rr(),1);function Ba(e,t=100){let[r,n]=(0,Br.useState)(e),o=(0,Br.useRef)(null);return(0,Br.useEffect)(()=>(o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{n(e)},t),()=>{o.current&&clearTimeout(o.current)}),[n,e,t]),r}s(Ba,"useDebouncedState");g();b();g();b();async function Wt(e){return await e.get(Fo)??Gi}s(Wt,"getTrustedApps");function Vo(){let e=pe();return oe({queryKey:ee.trustedApps(),refetchOnMount:"always",async queryFn(){return await Wt(e)}})}s(Vo,"useTrustedApps");async function Gt(e,t){await e.set(Fo,t)}s(Gt,"setTrustedApps");function Ff(){let e=pe(),t=le();return ae({async mutationFn({trustedApps:r}){await Gt(e,r)},async onSuccess(){await t.invalidateQueries({queryKey:ee.trustedApps()})}})}s(Ff,"useSetTrustedApps");var Fo=me.UserTrustedApps;g();b();function jf(){let e=Ke(),t=ee.emojiSkinTone();return oe({queryKey:t,queryFn:s(async()=>await e.get(_e.EmojiSkinTone),"queryFn")})}s(jf,"useEmojiSkinTone");function zf(){let e=Ke(),t=le();return ae({mutationFn:s(async({skinTone:o})=>{await e.set(_e.EmojiSkinTone,{version:1,skinTone:o})},"mutationFn"),onSuccess:s(()=>{t.invalidateQueries({queryKey:ee.emojiSkinTone()})},"onSuccess")})}s(zf,"useSetEmojiSkinTone");g();b();var Ca=s(async e=>await e.get(_e.IsAnalyticsOptedOut)??$i,"checkIsAnalyticsOptedOut");function jo(){let e=Ke(),t=ee.isAnalyticsOptedOut();return oe({queryKey:t,queryFn:s(async()=>Ca(e),"queryFn")})}s(jo,"useIsAnalyticsOptedOut");function Wf(){let e=Ke(),t=et(),r=le();return ae({mutationFn:s(async({isAnalyticsOptedOut:i})=>{await e.set(_e.IsAnalyticsOptedOut,i),await t.setAnalyticsOptedOut(i)},"mutationFn"),onSuccess:s(()=>{r.invalidateQueries({queryKey:ee.isAnalyticsOptedOut()})},"onSuccess")})}s(Wf,"useSetIsAnalyticsOptedOut");g();b();var Gf=ot(rr());var $f=s(()=>{let e=pe(),t=s(async()=>!!await e.get(me.BalanceHiddenStatus),"queryFn"),{data:r}=oe({queryKey:[me.BalanceHiddenStatus],queryFn:t});return r??!1},"useIsBalanceHidden"),Zf=s(()=>{let e=pe(),t=le(),r=s(async o=>await e.set(me.BalanceHiddenStatus,o),"mutationFn"),{mutateAsync:n}=ae({mutationFn:r,onMutate:s(async o=>{await t.cancelQueries({queryKey:[me.BalanceHiddenStatus]});let i=t.getQueryData([me.BalanceHiddenStatus]);return t.setQueryData([me.BalanceHiddenStatus],o),{previousIsBalanceHidden:i}},"onMutate"),onError:s((o,i,a)=>{t.setQueryData([me.BalanceHiddenStatus],a?.previousIsBalanceHidden)},"onError"),onSuccess:s(()=>{t.invalidateQueries({queryKey:[me.BalanceHiddenStatus]})},"onSuccess")});return n},"useSetIsBalanceHidden");g();b();var Yf=s(()=>{let e=pe(),t=s(async()=>await e.get(me.LockTimerMs)??Yi,"queryFn");return oe({queryKey:[me.LockTimerMs],queryFn:t})},"useLockTimer"),Qf=s(()=>{let e=pe(),t=le();return ae({mutationFn:s(async({lockTimeInMs:n})=>(Ge.addBreadcrumb(We.Account,`Lock timer updated to ${n}ms`,dt.Debug),await e.set(me.LockTimerMs,n)),"mutationFn"),onSuccess:s(()=>{t.invalidateQueries({queryKey:[me.LockTimerMs]})},"onSuccess")})},"useSetLockTimer");g();b();function Xf(){let e=pe(),t=ee.showWalletShortcuts();return oe({queryKey:t,queryFn:s(async()=>{let n=await e.get(_e.ShowWalletShortcuts);return n!=null?n==="true":Zi},"queryFn")})}s(Xf,"useShowWalletShortcutsSettings");function Jf(){let e=pe(),t=le();return ae({mutationFn:s(async({showWalletShortcuts:o})=>{await e.set(_e.ShowWalletShortcuts,o?"true":"false")},"mutationFn"),onSuccess:s(()=>{t.invalidateQueries({queryKey:ee.showWalletShortcuts()})},"onSuccess")})}s(Jf,"useSetShowWalletShortcutsSettings");g();b();g();b();g();b();var ed=["localhost","127.0.0.1"];function Ia(e){try{let t=e.trim();if(!t||t.startsWith("//"))return!1;let r=decodeURIComponent(t),o=/^[a-zA-Z][a-zA-Z0-9+.-]*:\/\//.test(r)?r:`http://${r}`,i=new URL(o);if(i.protocol!=="http:"&&i.protocol!=="https:")return!1;let a=i.hostname.toLowerCase();return ed.some(c=>a===c.toLowerCase())}catch{return!1}}s(Ia,"isLocalhost");g();b();var zo=s(()=>{let e=gi("auto-confirm-session-duration");return typeof e=="number"&&e>0?e:Sr},"useMaxSessionDuration");var Ta=s((e=7200)=>({networks:{},maxSessionDuration:e}),"createDefaultSettings"),td=V.object({networks:V.record(wn,V.boolean()),sessionStartTime:V.number().optional(),maxSessionDuration:V.number().positive()}),rd=V.record(V.string(),td);function La(e){let{sessionStartTime:t=0,maxSessionDuration:r=Sr,networks:n={}}=e??{};return Object.values(n).some(i=>i===!0)&&t>Date.now()-r*1e3}s(La,"isAutoConfirmSessionActive");async function nd(e,t){let n={...await Wt(e)};for(let o of Object.keys(n.apps[t]))n.apps[t][o].autoConfirm&&delete n.apps[t][o].autoConfirm;await Gt(e,n)}s(nd,"endAllAutoConfirmForAccountIdentifier");async function Wo(e){let r={...await Wt(e)};for(let n of Object.keys(r.apps))for(let o of Object.keys(r.apps[n]))Ia(o)&&r.apps[n][o].autoConfirm&&delete r.apps[n][o].autoConfirm;await Gt(e,r)}s(Wo,"endAllAutoConfirmForLocalhostDomains");async function Go(e,t,r,n=7200){let o=r.replace(/\/$/,""),i=await Wt(e),a=i?.apps?.[t]?.[o]??{},c=a?.autoConfirm??Ta(n);if(a?.autoConfirm){let u=Object.values(c.networks).some(f=>f===!0);La(a?.autoConfirm)===!1&&u&&(c=await id(a.autoConfirm),c=c??Ta(n))}return a.autoConfirm=c,await Gt(e,i),a.autoConfirm}s(Go,"getAutoConfirmSettingsForDomain");async function Oa(e,t,r,n,o=7200){let i=r.replace(/\/$/,"");await Go(e,t,i,o);let a=await Wt(e);a.apps[t]&&a.apps[t][i]&&(a.apps[t][i].autoConfirm=n),await Gt(e,a)}s(Oa,"setAutoConfirmSettingsForDomain");function od(e,t){let r=pe(),n=le(),o=t.replace(/\/$/,""),i=zo();return{set:ae({async mutationFn(a){await Oa(r,e,o,a,i)},async onSuccess(){await n.invalidateQueries({queryKey:ee.trustedApps()}),await n.invalidateQueries({queryKey:ee.allAutoConfirm(e)})}}),remove:ae({async mutationFn(){let a=await Wt(r);a.apps[e][t]?.autoConfirm&&delete a.apps[e][t].autoConfirm,await Gt(r,a)},async onSuccess(){await n.invalidateQueries({queryKey:ee.autoConfirm(e,t)})}}),get:oe({queryKey:ee.autoConfirm(e,t),refetchOnMount:"always",async queryFn(){return await Go(r,e,t,i)}})}}s(od,"useAutoConfirmSettings");function sd(e){let t=pe(),r=le();return{removeAll:ae({async mutationFn(){return await nd(t,e)},async onSuccess(){await r.invalidateQueries({queryKey:ee.trustedApps()}),await r.resetQueries({queryKey:ee.allAutoConfirm(e)})}})}}s(sd,"useAllAutoConfirmSettings");function id(e){if(!e?.networks)return e;for(let t of Object.keys(e?.networks))e.networks[t]=!1;return e}s(id,"markSessionExpired");var ad=V.boolean(),Pa="autoConfirmLocalhost";async function Ua(e){let t=await e.get(Pa),r=ad.safeParse(t);return r.success?r.data:!1}s(Ua,"getAutoConfirmLocalhost");function cd(){let e=pe();return oe({queryKey:ee.autoConfirmLocalhost(),refetchOnMount:"always",async queryFn(){return Ua(e)}})}s(cd,"useAutoConfirmLocalhost");function ud(){let e=pe(),t=le();return ae({async mutationFn(r){await ld(e,r),r===!1&&(await Wo(e),await t.invalidateQueries({queryKey:ee.allAutoConfirmOnAllAccounts()}))},async onSuccess(){await t.invalidateQueries({queryKey:ee.autoConfirmLocalhost()}),await t.invalidateQueries({queryKey:["auto-confirm"]})}})}s(ud,"useSetAutoConfirmLocalhost");async function ld(e,t){await e.set(Pa,t)}s(ld,"setAutoConfirmLocalhost");g();b();var Ra=ot(rr());var fd=s(()=>{let{data:e,isFetching:t}=Vo(),{data:r,isFetching:n}=jo(),{data:o,isFetching:i}=_r(),a=t||n||i;return(0,Ra.useMemo)(()=>({data:{"Analytics Opt Out":r,"Preferred Explorers":Qi(o),"Trusted Apps":e},isFetching:a}),[r,a,o,e])},"useSettingsExport");g();b();g();b();g();b();g();b();var Ha=ot(Vl());g();b();g();b();var Da=Oi.getInstance();g();b();var On=new It.PublicKey("L2TExMFKdjpN9kozasaurPirfHy9P8sbXoAN1qA3S95"),dd="https://node-proxy.phantom.app";async function Na(e,t="mainnet"){let r=pd(t),n=new It.Connection(r,{commitment:"confirmed",confirmTransactionInitialTimeout:5e3});for(let o=0;o<=255;o++){let[i,a]=hd(e,o);try{if(await n.getAccountInfo(i))continue;return{memoryAccount:i.toBase58(),memoryId:o,memoryBump:a}}catch{return{memoryAccount:i.toBase58(),memoryId:o,memoryBump:a}}}throw new Error("All 256 memory PDAs are already initialized for this wallet")}s(Na,"findAvailableMemoryPda");function hd(e,t){if(t<0||t>255)throw new Error("memoryId must be between 0 and 255");return It.PublicKey.findProgramAddressSync([Buffer.from("memory"),e.toBuffer(),Buffer.from([t])],On)}s(hd,"findMemoryPda");function pd(e="mainnet"){return`${dd}/v1/chain/solana/network/${e}`}s(pd,"getPhantomSolanaRpcUrl");var yd={ethereumMessage:!0,ethereumTx:!0,ethereumTypedData:!0,rawPayload:!0,solanaTx:!0,utf8Message:!0},md="457ad40e-ecca-4b47-a845-8e1efc6b61b3",gd="2b4308d3-e072-4f31-b890-4bd14ed6e546",bd={[md]:["HK4ai9cQNxF9Btu2aUXNiqGLKF88p3ep2cVEtYo7uK4m","5sfw7sNCmg5cm8naGX13uWD2gepKCQV1C18LWZAqCgRx","H51qLFCVJXtXHPv55W59L1ZHix9kY9eGPYGdFYCbv486","HFEvn5mqk5g138ZVWz2NU6hsFMYumAsrpqJpTvsiEyr8","ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL","TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA","11111111111111111111111111111111","ComputeBudget111111111111111111111111111111",On.toBase58()],[gd]:["HK4ai9cQNxF9Btu2aUXNiqGLKF88p3ep2cVEtYo7uK4m","5sfw7sNCmg5cm8naGX13uWD2gepKCQV1C18LWZAqCgRx","H51qLFCVJXtXHPv55W59L1ZHix9kY9eGPYGdFYCbv486","HFEvn5mqk5g138ZVWz2NU6hsFMYumAsrpqJpTvsiEyr8","ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL","TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA","11111111111111111111111111111111","ComputeBudget111111111111111111111111111111",On.toBase58()]};async function Cr(e){let t=null;e.usdCentsLimitPerDay&&(t=await wd({kms:e.kms,userOrganizationId:e.userOrganizationId,walletId:e.walletId,usdCentsLimitPerDay:e.usdCentsLimitPerDay,appId:e.appId}));let r=bd[e.appId];return{type:"CEL",preset:"DAPP_CONNECTION_USER",walletId:e.walletId,usdLimit:t,allowedMethods:yd,solanaProgramAllowlist:r??null}}s(Cr,"getPolicy");async function wd(e){try{Ge.addBreadcrumb(We.PhantomConnect,"Deriving memory account for spending limits",dt.Info,{walletId:e.walletId});let t=await xd(e);return Ge.addBreadcrumb(We.PhantomConnect,"Derived memory account for spending limits",dt.Info,t),{usdCentsLimitPerDay:e.usdCentsLimitPerDay,memoryAccount:t.memoryAccount,memoryId:t.memoryId,memoryBump:t.memoryBump}}catch(t){let r=t instanceof Error?t.message:String(t);return Ge.captureError(t instanceof Error?t:new Error(r),We.PhantomConnect),Ge.addBreadcrumb(We.PhantomConnect,"Failed to derive memory account, continuing without spending limits",dt.Error),null}}s(wd,"_getSpendingLimit");async function xd(e){try{let r=(await e.kms.getOrganization({organizationId:e.userOrganizationId})).result.users.map(n=>{if(n.traits?.appId!==e.appId||!("policy"in n))return null;let o=En.safeParse(n.policy);return o.success?o.data:null}).find(n=>n!==null);if(!r?.usdLimit)throw new Error("No existing spending limit policy found");return{memoryAccount:r.usdLimit.memoryAccount,memoryId:r.usdLimit.memoryId,memoryBump:r.usdLimit.memoryBump}}catch{let t=await Ed({kms:e.kms,userOrganizationId:e.userOrganizationId,walletId:e.walletId});return await Na(t)}}s(xd,"_getOrFindAvailableMemoryAccountPda");async function Ed(e){let t=null;try{let o=(await ht(Da)).filter(i=>i.addressFormat==="Solana");t=await e.kms.getAccounts({organizationId:e.userOrganizationId,walletId:e.walletId,accounts:o})}catch(n){let o=n instanceof Error?n.message:String(n);throw new Error(`Failed to get accounts: ${o}`)}let r=t?.result.find(n=>n.addressFormat==="Solana");if(!r)throw new Error("No Solana address found");return new It.PublicKey(r.address)}s(Ed,"_getSolanaAccount");async function Ma({kms:e,userOrganizationId:t,publicKey:r,expiresInMs:n,appId:o,walletId:i,usdCentsLimitPerDay:a}){let c=r.slice(0,8),u=r.slice(-8);try{let l=await Cr({kms:e,userOrganizationId:t,appId:o,usdCentsLimitPerDay:a,walletId:i}),f="preset"in l?l.preset:"CUSTOM";Ge.addBreadcrumb(We.PhantomConnect,"Starting addUserToOrganization",dt.Info,{organizationId:t,publicKeyPreview:c,appId:o,expiresInMs:n,policyType:f,usdCentsLimitPerDay:a});let p=`user_${c}${Date.now()}${u}`,d=xn(Ha.default.decode(r)),y={username:p,traits:{appId:o},authenticators:[{authenticatorKind:"keypair",publicKey:d,algorithm:"Ed25519",authenticatorName:`auth_${c}`}],expiresInMs:n,policy:l},h=await e.addUserToOrganization({organizationId:t,user:y,replaceExpirable:!0}),w=h.result.users.filter(x=>x.traits?.appId===o&&x.username!==p);for(let x of w)await e.updateUserInOrganization({organizationId:t,username:x.username,newPolicy:l});Ge.addBreadcrumb(We.PhantomConnect,"Successfully added user to organization",dt.Info,{organizationId:t,publicKeyPreview:c,appId:o,policyType:f,usdCentsLimitPerDay:a});let m=h.getByPublicKey(r);if(!m)throw new Error("User was added to organization but could not be found in the response");return{userOrganization:h.result,user:m}}catch(l){let f=l instanceof Error?l.message:String(l);throw Ge.captureError(l instanceof Error?l:new Error(f),We.PhantomConnect),Ge.addBreadcrumb(We.PhantomConnect,"Failed to add user to organization",dt.Error,{organizationId:t,publicKeyPreview:c,appId:o,error:f}),new Error(`Failed to add user to current user's organization: ${f}`)}}s(Ma,"addUserToCurrentUserOrganization");g();b();g();b();var at="vault";g();b();var Gr=ot(Tl());function ly(e,t){return Gr.ECIES_CONFIG.ellipticCurve="x25519",Gr.ECIES_CONFIG.symmetricAlgorithm="aes-256-gcm",Gr.ECIES_CONFIG.symmetricNonceLength=16,(0,Gr.encrypt)(e,t)}s(ly,"encryptWithPublicKey");async function ni(e,t,r,n,o=at){try{let a=(await e.initWalletImport({organizationId:n})).result,c=await t.fetchAllSeedMetas();if(c.length<1)throw new Error("No seed available in vault for migration");let l=c[0].identifier,f=await t.exportEntropy(l),h=(await f.foldAsync(Ci)).mnemonic.toString().split(" ").length;if(h!==12&&h!==24)throw new Error(`Invalid mnemonic length: expected 12 or 24 words, got ${h} words`);let w=await ht(r);if(w.length===0)throw new Error("No valid accounts found for migration");let m=await f.foldAsync(async E=>{let _=hi(a.publicKey),C=await ly(_,new Uint8Array(E));return xn(Buffer.from(C))}),x=await e.completeImportWallet({organizationId:n,importEnvelope:a,encryptedSecret:m,walletName:"Migrated Juicebox Wallet",accounts:w,mnemonicLength:h,tags:[o]});return{organizationId:n,walletId:x.result.walletId,walletName:x.result.walletName,accounts:x.result.accounts}}catch(i){throw i instanceof Error?new Error(`Failed to migrate Juicebox wallet: ${i.message}`):new Error(`Failed to migrate Juicebox wallet: ${String(i)}`)}}s(ni,"migrateJuiceboxWallet");async function oi(e,t,r,n=at){let o=await ht(r),{result:{organizationId:i}}=await e.getOrCreatePhantomOrganization();try{let{result:a}=await e.getWalletWithTag({organizationId:i,tag:n,accounts:o});if(!a)throw new Error("Result not returned from KMS");return{organizationId:i,isNewlyCreated:!1,isSeedless:!0,...a}}catch(a){if(Er(a))return{...await ni(e,t,r,i,n),isNewlyCreated:!0,isSeedless:!0};throw a}}s(oi,"getOrMigrateJuiceboxWallet");g();b();async function Ll(e,t,r,n=at){let o=await ht(r),a=(await t.fetchAllSeedlessMetas()).length>0,{result:{organizationId:c}}=await e.getOrCreatePhantomOrganization();try{let{result:u}=await e.getWalletWithTag({organizationId:c,tag:n,accounts:o});if(!u)throw new Error("Result not returned from KMS");return{organizationId:c,needsCreation:!1,isSeedless:a,wallet:u}}catch(u){if(Er(u))return{organizationId:c,needsCreation:!0,isSeedless:a,wallet:void 0};throw u}}s(Ll,"getKMSWalletStatus");g();b();g();b();async function Ol(e,t,r=at){let n=await ht(t),{result:{organizationId:o}}=await e.getOrCreatePhantomOrganization();try{let{result:i}=await e.getWalletWithTag({organizationId:o,tag:r,accounts:n});if(!i)throw new Error("Result not returned from KMS");return{organizationId:o,...i,isNewlyCreated:!1,isSeedless:!1}}catch(i){if(Er(i)){let{result:{walletId:a,walletName:c,accounts:u}}=await e.getOrCreateWalletWithTag({organizationId:o,walletName:"Phantom Wallet",tag:r,mnemonicLength:24,accounts:n});return{organizationId:o,walletId:a,walletName:c,accounts:u,isNewlyCreated:!0,isSeedless:!1}}throw i}}s(Ol,"getOrCreateDerivedWalletFromSeedphrase");async function Pl(e,t,r){return(await t.fetchAllSeedlessMetas()).length>0?oi(e,t,r,at):Ol(e,r,at)}s(Pl,"retrieveKMSWallet");g();b();var si="vault";g();b();function Ul(e){try{let t=new URL(e),r=t.protocol,n=t.hostname.toLowerCase(),o=t.port;return{origin:r==="https:"&&(o===""||o==="443")?`https://${n}`:r==="http:"&&(o===""||o==="80")?`http://${n}`:`${r}//${n}${o?`:${o}`:""}`,host:n,protocol:r}}catch{return{host:e.toLowerCase()}}}s(Ul,"normalizeOrigin");function Rl(e,t){let r;try{r=new URL(e)}catch{return!1}let n=Ul(e);return t.some(o=>{let i=Ul(o);return i.origin?i.origin===n.origin:i.host?i.host===r.hostname.toLowerCase():!1})}s(Rl,"isOriginWhitelisted");async function fy(e){try{let t=await mr.api().get(`/v1/wallets/whitelist/${e}`);return gr(t)?await t.data:null}catch{return null}}s(fy,"fetchWhitelist");async function dy(e,t){let r=await fy(e);return r?r.enabled?Rl(t,r.domains??[])?{allowed:!0}:{allowed:!1,reason:"origin_not_whitelisted"}:{allowed:!1,reason:"whitelist_disabled"}:{allowed:!1,reason:"missing_or_inaccessible_whitelist"}}s(dy,"validateAppOrigin");var ii=ot(rr());var Dl={staleTime:1/0,gcTime:1/0,refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,retry:!1,retryOnMount:!1},hy="@phantom/kms",py={getPhantomOrganization:s(e=>[`${hy}:getPhantomOrganization`,fi(),e],"getPhantomOrganization")};function bo(e){return{queryKey:py.getPhantomOrganization(e.accountIdentifier),queryFn:s(async()=>await e.kms.getPhantomOrganization({}),"queryFn"),...Dl}}s(bo,"getPhantomOrganizationQueryOptions");function yy(e){let r=Qr().getKMSInstance(),n=bo({accountIdentifier:e,kms:r}),{data:o}=oe(n),i=(0,ii.useMemo)(()=>o?gy(o):[],[o]),a=ee.appPermissions(e,...i);return oe({queryKey:a,queryFn:s(async()=>{if(!o)throw new Error("Phantom organization not found");if(i.length===0)return[];let c=`/portal/v1/apps/metadata?ids=${i.join(",")}`,u=await mr.api().get(c);if(!gr(u))throw new Error("Failed to fetch metadata for apps");return u.data.map(l=>{let f=o.result.users.filter(y=>y.traits?.appId===l.id),p=Math.min(...f.map(y=>y.createdAtMs??0)),d=Math.max(...f.map(y=>y.expiresAtMs??0));return{appId:l.id,title:l.name,imageUrl:l.iconUrl??"",origin:l.url??l.name,expiresAtMs:d,createdAtMs:p}})},"queryFn"),...Dl})}s(yy,"useGetAppPermissions");function my(e){let t=et(),r=le(),o=Qr().getKMSInstance(),i=bo({accountIdentifier:e,kms:o}),{data:a}=oe(i);return ae({mutationFn:s(async c=>{if(!a)throw new Error("Phantom organization not found");let u=a.result.users.filter(f=>f.traits?.appId===c);if(u.length===0)return;let l=a.result.organizationId;for(let f of u){let p=f.username;await o.deleteUserFromOrganization({organizationId:l,username:p}),t.capture("userDeletedFromOrganization",{data:{appId:c,organizationId:l,username:p}})}},"mutationFn"),onSettled:s(()=>r.invalidateQueries({queryKey:i.queryKey}),"onSettled")})}s(my,"useRevokeAppPermissions");function gy(e){return e.result.users.map(t=>t.traits?.appId).filter(t=>t!==void 0).filter((t,r,n)=>n.indexOf(t)===r).sort()}s(gy,"_getUniqueAppIds");function by(e,t){let n=Qr().getKMSInstance(),o=bo({accountIdentifier:e,kms:n}),{data:i,...a}=oe(o);return{data:(0,ii.useMemo)(()=>{let u=i?.result.users.filter(l=>l.traits?.appId===t)??[];return Nl(u)},[i?.result.users,t]),...a}}s(by,"useGetSpendingLimit");function wy(e){let t=et(),r=le(),o=Qr().getKMSInstance(),i=bo({accountIdentifier:e,kms:o}),a=mi("spending_limits_cumulative"),{data:c}=oe({...i,enabled:a});return ae({mutationFn:s(async({appId:u,newUsdCentsLimitPerDay:l})=>{if(!c)throw new Error("Phantom organization not found");let f=c.result.users.filter(h=>h.traits?.appId===u);if(f.length===0)return;let p=await o.getWalletWithTag({organizationId:c.result.organizationId,tag:si}),d=await Cr({kms:o,userOrganizationId:c.result.organizationId,appId:u,usdCentsLimitPerDay:l,walletId:p.result.walletId}),y=c.result.organizationId;for(let h of f){let w=h.username;await o.updateUserInOrganization({organizationId:y,username:w,newPolicy:d,addTraits:void 0,removeTraits:void 0}),t.capture("userUpdatedInOrganization",{data:{appId:u,organizationId:y,username:w,usdCentsLimitPerDay:l}})}},"mutationFn"),onSettled:s(()=>r.invalidateQueries({queryKey:i.queryKey}),"onSettled")})}s(wy,"useUpdateSpendingLimit");function Nl(e){let t=e.map(n=>"policy"in n?n.policy:void 0).filter(Boolean);if(t.length===0)return null;let r=t.map(n=>{let o=En.safeParse(n);return o.success?o.data.usdLimit?.usdCentsLimitPerDay??null:null}).filter(n=>n!==null);return r.length===0?null:Math.min(...r)}s(Nl,"getLowestSpendingLimit");g();b();var pr=ot(rr());var xy=s(({isTestnetMode:e,enabledAddressTypes:t,enableAddressTypes:r,disableAddressTypes:n})=>{let{t:o}=Ei(),i=(0,pr.useMemo)(()=>Me.getAddressTypes(e?Bo.Testnet:Bo.Mainnet).sort(Ml),[e]),a=(0,pr.useMemo)(()=>i.filter(p=>t.includes(p)).sort(Ml),[i,t]),c=(0,pr.useCallback)(p=>{let d=Me.getChainIDs(p);for(let y of d)if(Me[y].addressTypes.filter(m=>t.includes(m)).length<=1)return!1;return!0},[t]),u=et(),l=(0,pr.useCallback)((p,d)=>{d?c(p)&&(n({addressTypes:[p]}),u.capture("settingsPreferredBitcoinAddressToggledOffByUser",{data:{toggle:{addressType:p}}})):(r({addressTypes:[p]}),u.capture("settingsPreferredBitcoinAddressToggledOnByUser",{data:{toggle:{addressType:p}}}))},[u,c,n,r]),f=(0,pr.useMemo)(()=>({[Tt.BitcoinNativeSegwit]:{title:Io.getDisplayName(Tt.BitcoinNativeSegwit),subtitle:o("settingsPreferredBitcoinAddressNativeSegwitExplainer")},[Tt.BitcoinTaproot]:{title:Io.getDisplayName(Tt.BitcoinTaproot),subtitle:o("settingsPreferredBitcoinAddressTaprootExplainer")}}),[o]);return{availableBitcoinAddressTypes:i,enabledBitcoinAddressTypes:a,canDisableAddressType:c,handleAddressTypeEnablementChange:l,PREFERRED_BTC_ADDRESS_CONTENT:f}},"usePreferredAddressTypes"),Hl=[Tt.BitcoinNativeSegwit,Tt.BitcoinTaproot,Tt.BitcoinNestedSegwit,Tt.BitcoinLegacy],Ml=s((e,t)=>Hl.indexOf(e)-Hl.indexOf(t),"addressTypeSorter");g();b();var Ey=Lt.USD.value,ai=s(()=>{let{value:e}=wi(_e.SelectedCurrency);return{data:e??Ey}},"useSelectedCurrency"),ci=s(()=>xi(_e.SelectedCurrency),"useSetSelectedCurrency");g();b();var wo=ot(rr());var Kl=[Lt.USD,Lt.EUR],vy=s(({beforeSelectCurrency:e=s(()=>Promise.resolve(),"beforeSelectCurrency"),goBack:t})=>{let r=et(),{data:n}=ai(),{run:o}=ci(),[i,a]=(0,wo.useState)(""),c=Ba(i,200);return{currencyRows:(0,wo.useMemo)(()=>Object.values(Lt).sort((l,f)=>{let p=Kl.indexOf(l),d=Kl.indexOf(f),y=p!==-1,h=d!==-1;return y&&h?p-d:y&&!h?-1:!y&&h?1:l.name.localeCompare(f.name)}).filter(l=>[l.name,l.symbol,l.abbreviation].some(p=>p.toLowerCase().includes(c.toLowerCase()))).map(l=>{let f=n===l.value,p=s(()=>{l.value!==n&&e(l).then(()=>{r.capture("settingsCurrencyUpdatedByUser",{data:{newCurrency:l.value,oldCurrency:n}}),o(l.value),t()})},"onPress");return{key:`currency-${l.value}`,topLeft:`${l.abbreviation} - ${l.name} (${l.symbol})`,type:"radio",active:f,onPress:p}}),[r,c,t,n,o,e]),searchQuery:i,setSearchQuery:a}},"useCurrencyList");g();b();var ql="enableSolanaCopyTransaction";function Sy(){let e=le(),t=pe(),r=["settings","solana","enableCopyTransaction"],n=s(async()=>!!await t.get(ql),"queryFn"),i=ae({mutationFn:s(async c=>{await t.set(ql,c)},"mutationFn"),onSuccess:s(()=>{e.invalidateQueries({queryKey:r})},"onSuccess")}),a=oe({queryKey:r,queryFn:n});return{data:a.data,isLoading:a.isPending,mutate:i.mutate}}s(Sy,"useEnableSolanaCopyTransaction");var _y=Sy;export{vr as a,Vi as b,Sn as c,Fi as d,ji as e,Ft as f,lg as g,Wi as h,zl as i,fg as j,dg as k,Zi as l,Yi as m,_e as n,Bn as o,Wl as p,Gl as q,$l as r,Ql as s,c1 as t,ef as u,Ia as v,zo as w,ee as x,Wt as y,Vo as z,Gt as A,Ff as B,Fo as C,La as D,Go as E,Oa as F,od as G,sd as H,Ob as I,Po as J,ta as K,tf as L,rf as M,ra as N,nf as O,of as P,sf as Q,jf as R,zf as S,Ca as T,jo as U,Wf as V,$f as W,Zf as X,Yf as Y,Qf as Z,uf as _,lf as $,ff as aa,_r as ba,df as ca,Xf as da,Jf as ea,na as fa,hf as ga,pf as ha,Ua as ia,cd as ja,ud as ka,yf as la,fd as ma,Of as na,Ko as oa,qo as pa,Ot as qa,Ea as ra,va as sa,Ho as ta,xa as ua,Df as va,ko as wa,kf as xa,Vf as ya,Ma as za,Ll as Aa,Pl as Ba,dy as Ca,yy as Da,my as Ea,by as Fa,wy as Ga,xy as Ha,ai as Ia,Ba as Ja,vy as Ka,_y as La};
/*! Bundled license information:

@noble/ciphers/utils.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)

@noble/hashes/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/abstract/montgomery.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
//# sourceMappingURL=chunk-RKMQYZSN.js.map
