(function(define){var __define;"function"==typeof define&&define.amd&&(__define=define,define=null);
!function(){function e(e){return e&&e.__esModule?e.default:e}function t(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},r={},o={},a=n.parcelRequirea886;null==a&&((a=function(e){if(e in r)return r[e].exports;if(e in o){var t=o[e];delete o[e];var n={id:e,exports:{}};return r[e]=n,t.call(n.exports,n,n.exports),n.exports}var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){o[e]=t},n.parcelRequirea886=a),a.register("cwHVg",(function(n,r){t(n.exports,"useRootGroupEffect",(function(){return S}),(function(e){return S=e})),t(n.exports,"useCaptureOpen",(function(){return k}),(function(e){return k=e}));var o,u=a("cuInp"),s=a("1vgyn"),c=a("yrqZm"),i=a("57m2V"),f=a("226dB"),p=a("hYuzo"),l=a("a9P2W"),g=a("8fnAG"),d=a("865pP"),h=a("bMiEi"),v=a("1GEm5"),y=a("53yns"),x=a("lx1eT"),b=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function u(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,s)}c((r=r.apply(e,t||[])).next())}))},w=(o={},u.defineProperty(o,"client-platform","extension"),u.defineProperty(o,"client-version",x.getManifestVersion()),o),S=function(t){var n=u.slicedToArray(d.useFeatureFlags(["root-group-extension-v2"]),1)[0];!function(t){var n=v.useStoreStorageValue(f.StorageKeys.RootHashes).mutateAsync,r=v.useClearStorageValue(f.StorageKeys.RootHashes).mutateAsync,o=c.useCallback((function(){return b(void 0,void 0,void 0,e(s).mark((function o(){var a,u,c,f,p;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.getMnemonic();case 3:if(a=e.sent,t&&a){e.next=7;break}return r(),e.abrupt("return");case 7:e.t0=a.type,e.next="bip39"===e.t0?10:"deprecated"===e.t0?16:22;break;case 10:return u=a.value.getEntropy(),c=l.genRootHash(u),u.fill(0),e.next=15,n([c]);case 15:return e.abrupt("break",22);case 16:return f=i.mnemonicToEntropy(a.value),p=l.genRootHash(f),f.fill(0),e.next=21,n([p]);case 21:return e.abrupt("break",22);case 22:e.next=27;break;case 24:e.prev=24,e.t1=e.catch(0),r();case 27:case"end":return e.stop()}}),o,null,[[0,24]])})))}),[t,n,r]);c.useEffect((function(){o()}),[o])}(n),function(t){var n=v.useFetchStorageValue(f.StorageKeys.RootHashes),r=n.data,o=n.isSuccess,a=v.useStoreStorageValue(f.StorageKeys.RootGroup).mutateAsync,u=v.useClearStorageValue(f.StorageKeys.RootGroup).mutateAsync,i=c.useCallback((function(){return b(void 0,void 0,void 0,e(s).mark((function n(){var c,i;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o){e.next=2;break}return e.abrupt("return");case 2:if(e.prev=2,c=null!=r?r:[],t&&c.length){e.next=7;break}return u(),e.abrupt("return");case 7:return e.next=9,p.fetchRootGroup(c,w);case 9:return i=e.sent.rootGroup,e.next=12,a(i);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),u();case 17:case"end":return e.stop()}}),n,null,[[2,14]])})))}),[o,r,t,a,u]);c.useEffect((function(){i()}),[i])}(n),function(e){var t=v.useFetchStorageValue(f.StorageKeys.RootGroup),n=t.data,r=t.isSuccess,o=v.useFetchStorageValue(f.StorageKeys.IsAnalyticsOptedOut),a=o.data,u=o.isSuccess,s=r&&u,i=c.useCallback((function(){if(s){var t="";!a&&e&&(t=null!=n?n:""),t&&h.analytics.assignGroup("rootGroup",t)}}),[a,e,s,n]);c.useEffect((function(){i()}),[i])}(n),c.useEffect((function(){return null==t?void 0:t()}),[])},k=function(t,n){var r=c.useCallback((function(){return b(void 0,void 0,void 0,e(s).mark((function r(){var o,a,u;return e(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.getStorageValue(f.StorageKeys.IsAnalyticsOptedOut);case 2:return o=e.sent,e.next=5,g.getStorageValue(f.StorageKeys.RootGroup);case 5:a=e.sent,u="",o||(u=null!=a?a:""),u&&h.analytics.assignGroup("rootGroup",u),h.analytics.capture(t,n);case 10:case"end":return e.stop()}}),r)})))}),[t,n]);c.useEffect((function(){r()}),[r])}})),a.register("hYuzo",(function(n,r){t(n.exports,"fetchRootGroup",(function(){return l}),(function(e){return l=e}));var o=a("cuInp"),u=a("1vgyn"),s=a("6CCmb"),c=a("9Qkis"),i=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function u(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,s)}c((r=r.apply(e,t||[])).next())}))},f="fb25ad6d-1a0d-4238-a329-2394017625ef",p={Accept:"application/json","Content-Type":"application/json","root-group-api-key":f},l=function(t,n){return i(void 0,void 0,void 0,e(u).mark((function r(){var a,i;return e(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f.length){e.next=2;break}throw new Error("Must have Root Group API key before fetching.");case 2:if(t.length){e.next=4;break}throw new Error("Must send at least 1 root hash.");case 4:return e.next=6,fetch("".concat("".concat(s.getAPIEnvironment(),"/root_group/v1")),{method:"POST",headers:n?Object.assign(Object.assign({},n),p):p,body:JSON.stringify(o.defineProperty({},"root_hashes",t))});case 6:return a=e.sent,e.next=9,a.json();case 9:if(i=e.sent,200===a.status){e.next=14;break}if(!c.isErrorResponse(i)){e.next=13;break}throw new Error(i.message);case 13:throw new Error("Unable to fetch root group with root hashes: ".concat(t.toString()));case 14:if(!(r=i)||"string"!=typeof r.root_group){e.next=16;break}return e.abrupt("return",{rootGroup:i.root_group});case 16:throw new Error("Invalid root group response: ".concat(null==i?void 0:i.toString()));case 17:case"end":return e.stop()}var r}),r)})))}})),a.register("9Qkis",(function(e,n){t(e.exports,"isErrorResponse",(function(){return r}));var r=function(e){return!!e&&"string"==typeof e.message}})),a.register("a9P2W",(function(e,n){t(e.exports,"genRootHash",(function(){return u}));var r=a("dBiie"),o=new Set([16,20,24,28,32]);function u(e){if(!o.has(e.length))throw Error("Incorrect data length for RootHash:".concat(e.length));return r.sha256(r.sha256(e)).slice(2,34)}}))}();define=__define;})(window.define);