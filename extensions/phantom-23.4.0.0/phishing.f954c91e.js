(function(define){var __define;"function"==typeof define&&define.amd&&(__define=define,define=null);
function e(e){return e&&e.__esModule?e.default:e}function t(e,t,n,i){Object.defineProperty(e,t,{get:n,set:i,enumerable:!0,configurable:!0})}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i={},o={},r=n.parcelRequirea886;null==r&&((r=function(e){if(e in i)return i[e].exports;if(e in o){var t=o[e];delete o[e];var n={id:e,exports:{}};return i[e]=n,t.call(n.exports,n,n.exports),n.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){o[e]=t},n.parcelRequirea886=r),r.register("k4FrZ",(function(e,t){!function(){var n;try{n="undefined"!=typeof Intl&&void 0!==Intl.Collator?Intl.Collator("generic",{sensitivity:"base"}):null}catch(e){console.log("Collator could not be initialized and wouldn't be used")}var i=r("5D9li"),o=[],l=[],a={get:function(e,t,r){if(r&&n&&r.useCollator){var a,s,c,u,d,f,h=e.length,p=t.length;if(0===h)return p;if(0===p)return h;for(c=0;c<p;++c)o[c]=c,l[c]=t.charCodeAt(c);for(o[p]=p,c=0;c<h;++c){for(s=c+1,u=0;u<p;++u)a=s,f=0===n.compare(e.charAt(c),String.fromCharCode(l[u])),(s=o[u]+(f?0:1))>(d=a+1)&&(s=d),s>(d=o[u+1]+1)&&(s=d),o[u]=a;o[u]=s}return s}return i.distance(e,t)}};"undefined"!=typeof define&&null!==define&&define.amd?define((function(){return a})):null!==e&&e.exports===t?e.exports=a:"undefined"!=typeof self&&"function"==typeof self.postMessage&&"function"==typeof self.importScripts?self.Levenshtein=a:"undefined"!=typeof window&&null!==window&&(window.Levenshtein=a)}()})),r.register("5D9li",(function(e,t){const n=new Uint32Array(65536),i=(e,t)=>{if(e.length>t.length){const n=t;t=e,e=n}return 0===e.length?t.length:e.length<=32?((e,t)=>{const i=e.length,o=t.length,r=1<<i-1;let l=-1,a=0,s=i,c=i;for(;c--;)n[e.charCodeAt(c)]|=1<<c;for(c=0;c<o;c++){let e=n[t.charCodeAt(c)];const i=e|a;e|=(e&l)+l^l,a|=~(e|l),l&=e,a&r&&s++,l&r&&s--,a=a<<1|1,l=l<<1|~(i|a),a&=i}for(c=i;c--;)n[e.charCodeAt(c)]=0;return s})(e,t):((e,t)=>{const i=e.length,o=t.length,r=[],l=[],a=Math.ceil(i/32),s=Math.ceil(o/32);let c=o;for(let e=0;e<a;e++)l[e]=-1,r[e]=0;let u=0;for(;u<s-1;u++){let a=0,s=-1;const d=32*u,f=Math.min(32,o)+d;for(let e=d;e<f;e++)n[t.charCodeAt(e)]|=1<<e;c=o;for(let t=0;t<i;t++){const i=n[e.charCodeAt(t)],o=l[t/32|0]>>>t&1,c=r[t/32|0]>>>t&1,u=i|a,d=((i|c)&s)+s^s|i|c;let f=a|~(d|s),h=s&d;f>>>31^o&&(l[t/32|0]^=1<<t),h>>>31^c&&(r[t/32|0]^=1<<t),f=f<<1|o,h=h<<1|c,s=h|~(u|f),a=f&u}for(let e=d;e<f;e++)n[t.charCodeAt(e)]=0}let d=0,f=-1;const h=32*u,p=Math.min(32,o-h)+h;for(let e=h;e<p;e++)n[t.charCodeAt(e)]|=1<<e;c=o;for(let t=0;t<i;t++){const i=n[e.charCodeAt(t)],a=l[t/32|0]>>>t&1,s=r[t/32|0]>>>t&1,u=i|d,h=((i|s)&f)+f^f|i|s;let p=d|~(h|f),g=f&h;c+=p>>>o-1&1,c-=g>>>o-1&1,p>>>31^a&&(l[t/32|0]^=1<<t),g>>>31^s&&(r[t/32|0]^=1<<t),p=p<<1|a,g=g<<1|s,f=g|~(u|p),d=p&u}for(let e=h;e<p;e++)n[t.charCodeAt(e)]=0;return c})(e,t)};e.exports={closest:(e,t)=>{let n=1/0,o=0;for(let r=0;r<t.length;r++){const l=i(e,t[r]);l<n&&(n=l,o=r)}return t[o]},distance:i}}));var l=r("lDSNw"),a=r("ef4Zh");r("1KK14");var s=r("au6zr"),c=r("4yY1D"),u=r("kBpKb"),d={};t(d,"BlocklistOrigin",(function(){return V}),(function(e){return V=e}));var f,h,p=r("lMzyG"),g=r("1uUV4"),m=(l=r("lDSNw"),r("NQvFB")),y={};t(y,"removeSubdomainFromDomain",(function(){return C}),(function(e){return C=e})),t(y,"detectPhishing",(function(){return L}),(function(e){return L=e})),t(y,"getNFTBlocklist",(function(){return T}),(function(e){return T=e}));var w,b=JSON.parse('{"name":"@phantom-labs/blocklist","version":"0.13.0","main":"index.js","types":"index.d.ts","repository":"git@github.com:phantom-labs/blocklist.git","author":"Jordan Leigh <AlwaysBCoding@gmail.com>","license":"MIT","scripts":{"build":"node build.js"},"dependencies":{"js-yaml":"^4.1.0","sha3":"^2.1.4"}}').version;w=JSON.parse('{"blocklist":["phantomweb.app","aurory.app","solvision.io","staratlas.art","starsatlas.com","sollet.cc","raydlum.io","aurorynft.com","sneks.gg","solletweb.io","i-sollet.com","fancyfrenchienft.art","solanawebwallet.online","phahtom.com","server-syncwallet.com","staratias.app","raydium.network","grapesnetwork.me","staratias.art","soistarter.org","audius-nft.top","aurory.me","degenapes.app","phantom-app.online","phantomwallet.net","dapps-node.com","phantom-app.link","solanaoutage.com","walletconnectdapps.net","staratlas.cx","web-phantom.app","0120tt.com"],"whitelist":[],"fuzzylist":[],"contentHash":"830ea1c9a833213eabc17990adf053081f503b1203ca9a2c711db7199e657293"}');f=()=>b,h=()=>w;g=r("1uUV4");var v=r("k4FrZ"),k=(m=r("NQvFB"),r("6R6dI")),S=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function l(e){try{s(i.next(e))}catch(e){r(e)}}function a(e){try{s(i.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,a)}s((i=i.apply(e,t||[])).next())}))};const x=6e5;class O{check(t){if(!t)return{type:"all",result:!1};const n=C(t),i=z(n);if(U(i,this.whitelist)){const e=new URL(t).hostname;return N(z(e),this.blocklist)?{type:"blocklist",result:!0,source:e,isSubdomainDomainWhitelisted:!0}:{type:"whitelist",result:!1,source:e,isSubdomainDomainWhitelisted:!0}}if(N(i,this.whitelist))return{type:"whitelist",result:!1,source:n,isSubdomainDomainWhitelisted:!1};if(N(i,this.blocklist))return{type:"blocklist",result:!0,source:n,isSubdomainDomainWhitelisted:!1};if(this.tolerance>0){let t=I(i);t=t.replace("www.","");const o=this.fuzzylist.find((n=>{const i=I(n);return e(v).get(t,i)<=this.tolerance}));if(o){return{type:"fuzzy",result:!0,match:B(o),source:n,isSubdomainDomainWhitelisted:!1}}}return{type:"all",result:!1,source:n}}constructor(e,t,n,i){this.blocklist=D(e),this.whitelist=D(t),this.fuzzylist=D(n),this.tolerance=i||3}}const C=e=>{const t=new URL(e).hostname.split(".");return t.slice(0).slice(-(4===t.length?3:2)).join(".")},D=e=>e.map(z),z=e=>e.split(".").reverse(),B=e=>e.slice().reverse().join("."),I=e=>e.slice(1).reverse().join("."),N=(e,t)=>t.some((t=>!(t.length>e.length)&&t.every(((t,n)=>e[n]===t)))),U=(e,t)=>t.some((t=>t[0]===e[0]&&t[1]===e[1]&&"*"===t[2])),L=e=>S(void 0,void 0,void 0,(function*(){const t=h(),n=yield(0,k.getStorageValue)(g.StorageKeys.CachedBlocklistDiff),i=JSON.parse(`${n}`);if(i&&i.expiresAt&&i.expiresAt>Date.now()){return new O(t.blocklist.concat(i.blocklist),t.whitelist.concat(i.whitelist),t.fuzzylist.concat(i.fuzzylist)).check(e)}{const n=new Headers,o=f();i&&n.append("lastContentHash",`${i.contentHash}`),o&&n.append("localBlocklistVersion",`${o}`);const r=yield fetch(m.PHANTOM_BLOCKLIST_URL,{headers:n});if(200===r.status){const n=yield r.json();n.expiresAt=Date.now()+x,(0,k.setStorageValue)(g.StorageKeys.CachedBlocklistDiff,JSON.stringify(n));return new O(t.blocklist.concat(n.blocklist),t.whitelist.concat(n.whitelist),t.fuzzylist.concat(n.fuzzylist)).check(e)}if(304===r.status){i.expiresAt=Date.now()+x,(0,k.setStorageValue)(g.StorageKeys.CachedBlocklistDiff,JSON.stringify(i));return new O(t.blocklist.concat(i.blocklist),t.whitelist.concat(i.whitelist),t.fuzzylist.concat(i.fuzzylist)).check(e)}return{result:!1,type:"error"}}})),T=()=>S(void 0,void 0,void 0,(function*(){const e=yield(0,k.getStorageValue)(g.StorageKeys.CachedBlocklistDiff),t=JSON.parse(`${e}`);return t&&t.nftBlocklist?t.nftBlocklist:[]}));k=r("6R6dI");var A=r("cZIbv"),E=r("aanFI"),K=r("kn91D"),M=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function l(e){try{s(i.next(e))}catch(e){r(e)}}function a(e){try{s(i.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,a)}s((i=i.apply(e,t||[])).next())}))};const _="#eb3742",R=A.default.div`
  position: fixed;
  top: 0;
  left: 0;
  height: 100%;
  width: 100%;
  background-color: #fae5e6;
`,P=A.default.div`
  position: absolute;
  width: 760px;
  height: 603px;
  left: calc(50% - 760px / 2 + 0.5px);
  top: calc(50% - 603px / 2);
  border: 2px solid ${_};
  box-sizing: border-box;
  border-radius: 6px;
  display: flex;
  flex-direction: column;
  padding-left: 20px;
  padding-right: 20px;
`,F=A.default.div`
  display: flex;
  justify-content: center;
  align-items: center;
  margin-top: 50px;
`,J=A.default.a`
  text-decoration: underline;
  color: ${_};
`,V=({origin:t,subdomain:n})=>{const{t:i}=(0,p.useTranslation)(),o=t?(0,y.removeSubdomainFromDomain)(t):"",r=new URL(null!=t?t:"").hostname,a="true"===n?r:o;return e(l).createElement(R,null,e(l).createElement(P,null,e(l).createElement(F,null,e(l).createElement(E.IconPhantomPhishingDetected,null)),e(l).createElement(K.Text,{size:30,color:_,weight:"600"},i("blocklistOriginDomainIsBlocked",{domainName:a||i("blocklistOriginThisDomain")})),e(l).createElement(K.Text,{color:_},i("blocklistOriginSiteIsMalicious")),e(l).createElement(K.Text,{color:_},e(l).createElement(p.Trans,{i18nKey:"blocklistOriginCommunityDatabaseInterpolated"},"This site has been flagged as part of a",e(l).createElement(J,{href:m.PHANTOM_BLOCKLIST_GITHUB_URL,rel:"noopener",target:"_blank"},"community-maintained database"),"of known phishing websites and scams. If you believe the site has been flagged in error,",e(l).createElement(J,{href:m.PHANTOM_BLOCKLIST_GITHUB_URL,rel:"noopener",target:"_blank"},"please file an issue"),".")),a?e(l).createElement(K.Text,{color:_,onClick:()=>M(void 0,void 0,void 0,(function*(){if("true"===n){const e=yield(0,k.getStorageValue)(g.StorageKeys.UserWhitelistSubdomains);let t=JSON.parse(`${e}`);t?t.push(r):t=[r],t=[...new Set(t)],(0,k.setStorageValue)(g.StorageKeys.UserWhitelistSubdomains,JSON.stringify(t))}else{const e=yield(0,k.getStorageValue)(g.StorageKeys.UserWhitelistedOrigins);let t=JSON.parse(`${e}`);t?t.push(o):t=[o],t=[...new Set(t)],(0,k.setStorageValue)(g.StorageKeys.UserWhitelistedOrigins,JSON.stringify(t))}window.location.href=t})),hoverUnderline:!0},i("blocklistOriginIgnoreWarning",{domainName:t})):e(l).createElement(e(l).Fragment,null)))};var W=r("h5kyv"),j=r("1wI6a");s.fileLogger.init({provider:j.FileLoggerProvider}),c.telemetry.init(),c.telemetry.setUser({id:W.analytics.getDeviceId()});const H=()=>{let e;try{e=new URLSearchParams(window.location.search).get("origin")||"",new URL(e)}catch(t){e=""}return e},$=()=>new URLSearchParams(window.location.search).get("subdomain")||"",Z=()=>{const t=(0,l.useMemo)(H,[]),n=(0,l.useMemo)($,[]);return e(l).createElement(u.ErrorBoundary,null,e(l).createElement(d.BlocklistOrigin,{origin:t,subdomain:n}))};(0,a.render)(e(l).createElement(Z,null),document.getElementById("root"));
//# sourceMappingURL=phishing.f954c91e.js.map
define=__define;})(window.define);